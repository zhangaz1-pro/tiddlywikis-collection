<!doctype html>
<!-- The following comment is called a MOTW comment and is necessary for the TiddlyIE Internet Explorer extension -->
<!-- saved from url=(0021)http://tiddlywiki.com -->
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />		<!-- Force IE standards mode for Intranet and HTA - should be the first meta -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="application-name" content="TiddlyWiki" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.1.7" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="format-detection" content="telephone=no" />
<meta name="copyright" content="TiddlyWiki created by Jeremy Ruston, (jeremy [at] jermolene [dot] com)

Copyright © Jeremy Ruston 2004-2007
Copyright © UnaMesa Association 2007-2014

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of the UnaMesa Association nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
" />
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<title>Plato's Republic — A personal wiki for study of Plato's Republic</title>
<!--~~ This is a Tiddlywiki file. The points of interest in the file are marked with this pattern ~~--><!--~~ Raw markup ~~-->

</head>
<body class="tc-body">
<!--~~ Static styles ~~-->
<div id="styleArea">
<style data-tiddler-title="$:/boot/boot.css" data-tiddler-type="text/css" type="text/css">/*
Basic styles used before we boot up the parsing engine
*/

/*
Error message and password prompt
*/

.tc-password-wrapper, .tc-error-form {
    font-family: sans-serif;
	z-index: 20000;
	position: fixed;
	text-align: center;
	width: 200px;
	top: 4em;
    left: 50%;
    margin-left: -144px; /* - width/2 - paddingHorz/2 - border */
	padding: 16px 16px 16px 16px;
	border-radius: 8px;
}

.tc-error-form {
	color: #fff;
	text-shadow: 0 1px 0 rgba(0, 0, 0, 0.5);
	background-color: rgb(255, 75, 75);
	border: 8px solid rgb(255, 0, 0);
	width: 480px;
    margin-left: -244px; /* - width/2 - paddingHorz/2 - border */
}

.tc-error-form div {
	padding-bottom: 1em;
}

.tc-error-prompt {
	color: #000;
	text-shadow: none;
}

.tc-password-wrapper {
	color: #000;
	text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);
	background-color: rgb(197, 235, 183);
	border: 8px solid rgb(164, 197, 152);
}

.tc-password-wrapper form {
	text-align: left;
}

.tc-password-wrapper h1 {
	font-size: 16px;
	line-height: 20px;
	padding-bottom: 16px;
}

.tc-password-wrapper input {
	width: 100%;
}
</style>
</div>
<!--~~ Static content for Google and browsers without JavaScript ~~-->
<noscript>
<div id="splashArea">

<p>This <a class='tc-tiddlylink-external' href='http://tiddlywiki.com' target='_blank'>TiddlyWiki</a> contains the following tiddlers:</p><p><ul>

<li>$:/core</li>

<li>$:/DefaultTiddlers</li>

<li>$:/Import</li>

<li>$:/isEncrypted</li>

<li>$:/SiteSubtitle</li>

<li>$:/SiteTitle</li>

<li>$:/state/tab/sidebar--1835078512</li>

<li>$:/StoryList</li>

<li>$:/temp/info-plugin</li>

<li>$:/temp/NewTagName</li>

<li>$:/themes/tiddlywiki/snowwhite</li>

<li>$:/themes/tiddlywiki/vanilla</li>

<li>Book I (Jowett translation)</li>

<li>Book II (Jowett translation)</li>

<li>Book III (Jowett translation)</li>

<li>Book IV (Jowett translation)</li>

<li>Book IX (Jowett translation)</li>

<li>Book List</li>

<li>Book V (Jowett translation)</li>

<li>Book VI (Jowett translation)</li>

<li>Book VII (Jowett translation)</li>

<li>Book VIII (Jowett translation)</li>

<li>Book X (Jowett translation)</li>

<li>Help</li>

<li>Introduction and Analysis by Benjamin Jowett</li>

<li>Plato's Republic</li>

</ul>
</p>



</div>
</noscript>
<!--~~ Ordinary tiddlers ~~-->

<div id="storeArea" style="display:none;">
<div author="JeremyRuston" core-version="&gt;=5.0.0" dependents="" description="TiddlyWiki5 core plugin" list="readme" plugin-priority="0" plugin-type="plugin" title="$:/core" type="application/json" version="5.1.7">
<pre>{
    &quot;tiddlers&quot;: {
        &quot;$:/Acknowledgements&quot;: {
            &quot;title&quot;: &quot;$:/Acknowledgements&quot;,
            &quot;type&quot;: &quot;text/vnd.tiddlywiki&quot;,
            &quot;text&quot;: &quot;TiddlyWiki incorporates code from these fine OpenSource projects:\n\n* [[The Stanford Javascript Crypto Library|http://bitwiseshiftleft.github.io/sjcl/]]\n* [[The Jasmine JavaScript Test Framework|http://pivotal.github.io/jasmine/]]\n* [[Normalize.css by Nicolas Gallagher|http://necolas.github.io/normalize.css/]]\n\nAnd media from these projects:\n\n* World flag icons from [[Wikipedia|http://commons.wikimedia.org/wiki/Category:SVG_flags_by_country]]\n&quot;
        },
        &quot;$:/core/copyright.txt&quot;: {
            &quot;title&quot;: &quot;$:/core/copyright.txt&quot;,
            &quot;type&quot;: &quot;text/plain&quot;,
            &quot;text&quot;: &quot;TiddlyWiki created by Jeremy Ruston, (jeremy [at] jermolene [dot] com)\n\nCopyright © Jeremy Ruston 2004-2007\nCopyright © UnaMesa Association 2007-2014\n\nRedistribution and use in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\nRedistributions of source code must retain the above copyright notice, this\nlist of conditions and the following disclaimer.\n\nRedistributions in binary form must reproduce the above copyright notice, this\nlist of conditions and the following disclaimer in the documentation and/or other\nmaterials provided with the distribution.\n\nNeither the name of the UnaMesa Association nor the names of its contributors may be\nused to endorse or promote products derived from this software without specific\nprior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND ANY\nEXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\nOF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT\nSHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,\nINCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED\nTO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR\nBUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\nCONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN\nANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH\nDAMAGE.\n&quot;
        },
        &quot;$:/core/icon&quot;: {
            &quot;title&quot;: &quot;$:/core/icon&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M64,0 L118.5596,32 L118.5596,96 L64,128 L9.44039956,96 L9.44039956,32 L64,0 Z M85.1274062,95.4080042 C81.5494069,95.3047989 79.9756384,95.3136745 78.1534289,92.2560668 L76.733228,92.2975844 C75.0801573,92.2226776 75.7690718,92.256631 74.6662332,92.2006037 C72.822332,92.1273894 73.1177105,90.3396383 72.7933215,89.3950941 C72.2744094,86.1888106 73.4800004,82.9659571 73.4419681,79.7590415 C73.428503,78.6206623 71.8498363,74.5912119 71.2858469,73.150598 C69.5178104,73.490271 67.7401827,73.5550323 65.9465048,73.6462337 C61.8120677,73.6358996 57.7056703,73.1192806 53.628962,72.4632293 C52.8345141,75.8119659 50.473106,80.4990751 52.4249964,83.9024219 C54.794228,87.4227874 56.45684,88.3980868 59.0339286,88.6103485 C61.6109895,88.8224384 62.1929077,91.7913467 61.5694236,92.8517379 C61.0175661,93.5845847 60.0476425,93.7176093 59.2235739,93.8951553 L57.5752147,93.9742093 C56.2780933,93.9296822 55.1187057,93.5723203 53.9629071,93.0211763 C52.0327307,91.9217335 50.0392154,89.6360411 48.5580719,87.9950695 C48.9028934,88.6503604 49.1085703,89.9296134 48.7958122,90.5249222 C47.9200982,91.7907825 44.1326257,91.7830485 42.3980986,90.996433 C40.4277043,90.1030197 35.6664658,83.8299171 34.9303347,79.1316435 C36.8887135,75.3525836 39.7416856,72.0607931 41.1850909,67.9459622 C38.038852,65.8974525 36.3537697,62.5626501 36.5725198,58.7851619 L36.6514762,58.3478913 C33.5557196,58.9392548 35.1611076,58.7192345 31.8308843,58.9762949 C21.2252017,58.9431831 11.8983553,51.6054609 17.1501626,40.2013394 C17.4916881,39.5260388 17.8165752,38.9120742 18.3955298,39.205288 C18.8602051,39.440565 18.793457,40.3843583 18.5597268,41.4309776 C15.5577203,55.057365 30.2297484,55.161659 39.2489049,52.6401668 C40.1440491,52.3898612 41.9243599,50.7040626 43.1576153,50.1452033 C45.1734825,49.231769 47.3615008,48.8611654 49.5329344,48.5941256 C54.9337165,47.9661653 61.4247946,50.8693254 64.7228943,50.9641212 C68.0210328,51.0589131 72.7127563,50.1582941 75.5928121,50.3479196 C77.6825379,50.4454833 79.734518,50.8303777 81.7507717,51.3786556 C83.0558682,44.8897102 83.1481363,40.1071855 86.2420439,39 C88.0578592,39.2926449 89.4570618,41.8175853 90.4927503,43.1666676 C92.6062592,43.0809984 94.6134653,43.6270518 96.6091885,44.233091 C100.222332,43.7098824 103.254293,41.6394732 106.445091,40.0288813 C103.211767,42.7223157 102.77315,47.1042714 103.142605,51.1564486 C103.280001,53.2591496 102.697713,55.5420684 101.977868,57.6949551 C100.630795,61.2025356 98.0292951,64.8997754 95.009908,64.7101481 C93.868464,64.673306 93.2053722,64.0138 92.3570101,63.3096933 C92.1924386,64.7358711 91.5456263,66.0084523 90.9221089,67.2697748 C89.4822206,70.066388 85.7194927,71.2987762 82.2354164,74.2849828 C78.7515768,77.2712347 83.3502408,87.9363951 84.4652464,89.8796277 C85.5800708,91.8230453 88.6922789,92.5339992 87.484639,94.28798 C87.1151913,94.8672415 86.5502884,95.0744181 85.9465544,95.2991347 L85.1274062,95.4080042 Z M45.0303574,86.5575217 L45.5828655,86.699414 C46.277142,86.4290005 47.6727292,86.8469317 48.4130246,87.0512628 C47.0498362,85.7357167 44.9960929,83.8038623 43.5164417,82.5859671 C43.0307739,81.1115156 43.2380006,79.6278431 43.3424927,78.122648 L43.3634516,77.9981264 C42.7802099,79.2030731 42.040056,80.3743566 41.6422405,81.6426885 C41.176708,83.3537773 43.7112632,85.1999538 44.6940603,86.2580263 L45.0303574,86.5575217 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/advanced-search-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/advanced-search-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-advanced-search-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M74.5651535,87.9848361 C66.9581537,93.0488876 57.8237115,96 48,96 C21.490332,96 0,74.509668 0,48 C0,21.490332 21.490332,0 48,0 C74.509668,0 96,21.490332 96,48 C96,57.8541369 93.0305793,67.0147285 87.9377231,74.6357895 L122.284919,108.982985 C125.978897,112.676963 125.973757,118.65366 122.284271,122.343146 C118.593975,126.033442 112.613238,126.032921 108.92411,122.343793 L74.5651535,87.9848361 Z M48,80 C65.673112,80 80,65.673112 80,48 C80,30.326888 65.673112,16 48,16 C30.326888,16 16,30.326888 16,48 C16,65.673112 30.326888,80 48,80 Z\&quot;&gt;&lt;/path&gt;\n        &lt;circle cx=\&quot;48\&quot; cy=\&quot;48\&quot; r=\&quot;8\&quot;&gt;&lt;/circle&gt;\n        &lt;circle cx=\&quot;28\&quot; cy=\&quot;48\&quot; r=\&quot;8\&quot;&gt;&lt;/circle&gt;\n        &lt;circle cx=\&quot;68\&quot; cy=\&quot;48\&quot; r=\&quot;8\&quot;&gt;&lt;/circle&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/blank&quot;: {
            &quot;title&quot;: &quot;$:/core/images/blank&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-blank tc-image-button\&quot; viewBox=\&quot;63 152 64 64\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/cancel-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/cancel-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-cancel-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n\t&lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n\t    &lt;path d=\&quot;M64,76.3137085 L47.0294734,93.2842351 C43.9038742,96.4098343 38.8399231,96.4084656 35.7157288,93.2842712 C32.5978915,90.166434 32.5915506,85.0947409 35.7157649,81.9705266 L52.6862915,65 L35.7157649,48.0294734 C32.5901657,44.9038742 32.5915344,39.8399231 35.7157288,36.7157288 C38.833566,33.5978915 43.9052591,33.5915506 47.0294734,36.7157649 L64,53.6862915 L80.9705266,36.7157649 C84.0961258,33.5901657 89.1600769,33.5915344 92.2842712,36.7157288 C95.4021085,39.833566 95.4084494,44.9052591 92.2842351,48.0294734 L75.3137085,65 L92.2842351,81.9705266 C95.4098343,85.0961258 95.4084656,90.1600769 92.2842712,93.2842712 C89.166434,96.4021085 84.0947409,96.4084494 80.9705266,93.2842351 L64,76.3137085 Z M64,129 C99.346224,129 128,100.346224 128,65 C128,29.653776 99.346224,1 64,1 C28.653776,1 1.13686838e-13,29.653776 1.13686838e-13,65 C1.13686838e-13,100.346224 28.653776,129 64,129 Z M64,113 C90.509668,113 112,91.509668 112,65 C112,38.490332 90.509668,17 64,17 C37.490332,17 16,38.490332 16,65 C16,91.509668 37.490332,113 64,113 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/chevron-down&quot;: {
            &quot;title&quot;: &quot;$:/core/images/chevron-down&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-chevron-down tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n\t&lt;g fill-rule=\&quot;evenodd\&quot; transform=\&quot;translate(64.000000, 40.500000) rotate(-270.000000) translate(-64.000000, -40.500000) translate(-22.500000, -26.500000)\&quot;&gt;\n        &lt;path d=\&quot;M112.743107,112.12741 C111.310627,113.561013 109.331747,114.449239 107.145951,114.449239 L27.9777917,114.449239 C23.6126002,114.449239 20.0618714,110.904826 20.0618714,106.532572 C20.0618714,102.169214 23.6059497,98.6159054 27.9777917,98.6159054 L99.2285381,98.6159054 L99.2285381,27.365159 C99.2285381,22.9999675 102.77295,19.4492387 107.145205,19.4492387 C111.508562,19.4492387 115.061871,22.993317 115.061871,27.365159 L115.061871,106.533318 C115.061871,108.71579 114.175869,110.694669 112.743378,112.127981 Z\&quot; transform=\&quot;translate(67.561871, 66.949239) rotate(-45.000000) translate(-67.561871, -66.949239) \&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M151.35638,112.12741 C149.923899,113.561013 147.94502,114.449239 145.759224,114.449239 L66.5910645,114.449239 C62.225873,114.449239 58.6751442,110.904826 58.6751442,106.532572 C58.6751442,102.169214 62.2192225,98.6159054 66.5910645,98.6159054 L137.841811,98.6159054 L137.841811,27.365159 C137.841811,22.9999675 141.386223,19.4492387 145.758478,19.4492387 C150.121835,19.4492387 153.675144,22.993317 153.675144,27.365159 L153.675144,106.533318 C153.675144,108.71579 152.789142,110.694669 151.356651,112.127981 Z\&quot; transform=\&quot;translate(106.175144, 66.949239) rotate(-45.000000) translate(-106.175144, -66.949239) \&quot;&gt;&lt;/path&gt;\n\t&lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/chevron-left&quot;: {
            &quot;title&quot;: &quot;$:/core/images/chevron-left&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-chevron-left tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot; version=\&quot;1.1\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot; transform=\&quot;translate(92.500000, 64.000000) rotate(-180.000000) translate(-92.500000, -64.000000) translate(6.000000, -3.000000)\&quot;&gt;\n        &lt;path d=\&quot;M112.743107,112.12741 C111.310627,113.561013 109.331747,114.449239 107.145951,114.449239 L27.9777917,114.449239 C23.6126002,114.449239 20.0618714,110.904826 20.0618714,106.532572 C20.0618714,102.169214 23.6059497,98.6159054 27.9777917,98.6159054 L99.2285381,98.6159054 L99.2285381,27.365159 C99.2285381,22.9999675 102.77295,19.4492387 107.145205,19.4492387 C111.508562,19.4492387 115.061871,22.993317 115.061871,27.365159 L115.061871,106.533318 C115.061871,108.71579 114.175869,110.694669 112.743378,112.127981 Z\&quot; transform=\&quot;translate(67.561871, 66.949239) rotate(-45.000000) translate(-67.561871, -66.949239) \&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M151.35638,112.12741 C149.923899,113.561013 147.94502,114.449239 145.759224,114.449239 L66.5910645,114.449239 C62.225873,114.449239 58.6751442,110.904826 58.6751442,106.532572 C58.6751442,102.169214 62.2192225,98.6159054 66.5910645,98.6159054 L137.841811,98.6159054 L137.841811,27.365159 C137.841811,22.9999675 141.386223,19.4492387 145.758478,19.4492387 C150.121835,19.4492387 153.675144,22.993317 153.675144,27.365159 L153.675144,106.533318 C153.675144,108.71579 152.789142,110.694669 151.356651,112.127981 Z\&quot; transform=\&quot;translate(106.175144, 66.949239) rotate(-45.000000) translate(-106.175144, -66.949239) \&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/chevron-right&quot;: {
            &quot;title&quot;: &quot;$:/core/images/chevron-right&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-chevron-right tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot; transform=\&quot;translate(-48.000000, -3.000000)\&quot;&gt;\n        &lt;path d=\&quot;M112.743107,112.12741 C111.310627,113.561013 109.331747,114.449239 107.145951,114.449239 L27.9777917,114.449239 C23.6126002,114.449239 20.0618714,110.904826 20.0618714,106.532572 C20.0618714,102.169214 23.6059497,98.6159054 27.9777917,98.6159054 L99.2285381,98.6159054 L99.2285381,27.365159 C99.2285381,22.9999675 102.77295,19.4492387 107.145205,19.4492387 C111.508562,19.4492387 115.061871,22.993317 115.061871,27.365159 L115.061871,106.533318 C115.061871,108.71579 114.175869,110.694669 112.743378,112.127981 Z\&quot; transform=\&quot;translate(67.561871, 66.949239) rotate(-45.000000) translate(-67.561871, -66.949239) \&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M151.35638,112.12741 C149.923899,113.561013 147.94502,114.449239 145.759224,114.449239 L66.5910645,114.449239 C62.225873,114.449239 58.6751442,110.904826 58.6751442,106.532572 C58.6751442,102.169214 62.2192225,98.6159054 66.5910645,98.6159054 L137.841811,98.6159054 L137.841811,27.365159 C137.841811,22.9999675 141.386223,19.4492387 145.758478,19.4492387 C150.121835,19.4492387 153.675144,22.993317 153.675144,27.365159 L153.675144,106.533318 C153.675144,108.71579 152.789142,110.694669 151.356651,112.127981 Z\&quot; transform=\&quot;translate(106.175144, 66.949239) rotate(-45.000000) translate(-106.175144, -66.949239) \&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/chevron-up&quot;: {
            &quot;title&quot;: &quot;$:/core/images/chevron-up&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-chevron-up tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n\t&lt;g fill-rule=\&quot;evenodd\&quot; transform=\&quot;translate(64.000000, 89.500000) rotate(-90.000000) translate(-64.000000, -89.500000) translate(-22.500000, 22.500000)\&quot;&gt;\n        &lt;path d=\&quot;M112.743107,112.12741 C111.310627,113.561013 109.331747,114.449239 107.145951,114.449239 L27.9777917,114.449239 C23.6126002,114.449239 20.0618714,110.904826 20.0618714,106.532572 C20.0618714,102.169214 23.6059497,98.6159054 27.9777917,98.6159054 L99.2285381,98.6159054 L99.2285381,27.365159 C99.2285381,22.9999675 102.77295,19.4492387 107.145205,19.4492387 C111.508562,19.4492387 115.061871,22.993317 115.061871,27.365159 L115.061871,106.533318 C115.061871,108.71579 114.175869,110.694669 112.743378,112.127981 Z\&quot; transform=\&quot;translate(67.561871, 66.949239) rotate(-45.000000) translate(-67.561871, -66.949239) \&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M151.35638,112.12741 C149.923899,113.561013 147.94502,114.449239 145.759224,114.449239 L66.5910645,114.449239 C62.225873,114.449239 58.6751442,110.904826 58.6751442,106.532572 C58.6751442,102.169214 62.2192225,98.6159054 66.5910645,98.6159054 L137.841811,98.6159054 L137.841811,27.365159 C137.841811,22.9999675 141.386223,19.4492387 145.758478,19.4492387 C150.121835,19.4492387 153.675144,22.993317 153.675144,27.365159 L153.675144,106.533318 C153.675144,108.71579 152.789142,110.694669 151.356651,112.127981 Z\&quot; transform=\&quot;translate(106.175144, 66.949239) rotate(-45.000000) translate(-106.175144, -66.949239) \&quot;&gt;&lt;/path&gt;\n\t&lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/clone-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/clone-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-clone-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M32.2650915,96 L32.2650915,120.002359 C32.2650915,124.419334 35.8432884,128 40.2627323,128 L120.002359,128 C124.419334,128 128,124.421803 128,120.002359 L128,40.2627323 C128,35.8457573 124.421803,32.2650915 120.002359,32.2650915 L96,32.2650915 L96,48 L108.858899,48 C110.519357,48 111.853018,49.3405131 111.853018,50.9941198 L111.853018,108.858899 C111.853018,110.519357 110.512505,111.853018 108.858899,111.853018 L50.9941198,111.853018 C49.333661,111.853018 48,110.512505 48,108.858899 L48,96 L32.2650915,96 Z\&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M40,56 L32.0070969,56 C27.5881712,56 24,52.418278 24,48 C24,43.5907123 27.5848994,40 32.0070969,40 L40,40 L40,32.0070969 C40,27.5881712 43.581722,24 48,24 C52.4092877,24 56,27.5848994 56,32.0070969 L56,40 L63.9929031,40 C68.4118288,40 72,43.581722 72,48 C72,52.4092877 68.4151006,56 63.9929031,56 L56,56 L56,63.9929031 C56,68.4118288 52.418278,72 48,72 C43.5907123,72 40,68.4151006 40,63.9929031 L40,56 Z M7.9992458,0 C3.58138434,0 0,3.5881049 0,7.9992458 L0,88.0007542 C0,92.4186157 3.5881049,96 7.9992458,96 L88.0007542,96 C92.4186157,96 96,92.4118951 96,88.0007542 L96,7.9992458 C96,3.58138434 92.4118951,0 88.0007542,0 L7.9992458,0 Z M19.0010118,16 C17.3435988,16 16,17.336731 16,19.0010118 L16,76.9989882 C16,78.6564012 17.336731,80 19.0010118,80 L76.9989882,80 C78.6564012,80 80,78.663269 80,76.9989882 L80,19.0010118 C80,17.3435988 78.663269,16 76.9989882,16 L19.0010118,16 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/close-all-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/close-all-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-close-all-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot; transform=\&quot;translate(-23.000000, -23.000000)\&quot;&gt;\n        &lt;path d=\&quot;M43,131 L22.9976794,131 C18.5827987,131 15,127.418278 15,123 C15,118.590712 18.5806831,115 22.9976794,115 L43,115 L43,94.9976794 C43,90.5827987 46.581722,87 51,87 C55.4092877,87 59,90.5806831 59,94.9976794 L59,115 L79.0023206,115 C83.4172013,115 87,118.581722 87,123 C87,127.409288 83.4193169,131 79.0023206,131 L59,131 L59,151.002321 C59,155.417201 55.418278,159 51,159 C46.5907123,159 43,155.419317 43,151.002321 L43,131 Z\&quot; transform=\&quot;translate(51.000000, 123.000000) rotate(-45.000000) translate(-51.000000, -123.000000) \&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M43,59 L22.9976794,59 C18.5827987,59 15,55.418278 15,51 C15,46.5907123 18.5806831,43 22.9976794,43 L43,43 L43,22.9976794 C43,18.5827987 46.581722,15 51,15 C55.4092877,15 59,18.5806831 59,22.9976794 L59,43 L79.0023206,43 C83.4172013,43 87,46.581722 87,51 C87,55.4092877 83.4193169,59 79.0023206,59 L59,59 L59,79.0023206 C59,83.4172013 55.418278,87 51,87 C46.5907123,87 43,83.4193169 43,79.0023206 L43,59 Z\&quot; transform=\&quot;translate(51.000000, 51.000000) rotate(-45.000000) translate(-51.000000, -51.000000) \&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M115,59 L94.9976794,59 C90.5827987,59 87,55.418278 87,51 C87,46.5907123 90.5806831,43 94.9976794,43 L115,43 L115,22.9976794 C115,18.5827987 118.581722,15 123,15 C127.409288,15 131,18.5806831 131,22.9976794 L131,43 L151.002321,43 C155.417201,43 159,46.581722 159,51 C159,55.4092877 155.419317,59 151.002321,59 L131,59 L131,79.0023206 C131,83.4172013 127.418278,87 123,87 C118.590712,87 115,83.4193169 115,79.0023206 L115,59 Z\&quot; transform=\&quot;translate(123.000000, 51.000000) rotate(-45.000000) translate(-123.000000, -51.000000) \&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M115,131 L94.9976794,131 C90.5827987,131 87,127.418278 87,123 C87,118.590712 90.5806831,115 94.9976794,115 L115,115 L115,94.9976794 C115,90.5827987 118.581722,87 123,87 C127.409288,87 131,90.5806831 131,94.9976794 L131,115 L151.002321,115 C155.417201,115 159,118.581722 159,123 C159,127.409288 155.419317,131 151.002321,131 L131,131 L131,151.002321 C131,155.417201 127.418278,159 123,159 C118.590712,159 115,155.419317 115,151.002321 L115,131 Z\&quot; transform=\&quot;translate(123.000000, 123.000000) rotate(-45.000000) translate(-123.000000, -123.000000) \&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/close-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/close-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-close-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M65.0864256,75.4091629 L14.9727349,125.522854 C11.8515951,128.643993 6.78104858,128.64922 3.65685425,125.525026 C0.539017023,122.407189 0.5336324,117.334539 3.65902635,114.209145 L53.7727171,64.0954544 L3.65902635,13.9817637 C0.537886594,10.8606239 0.532659916,5.79007744 3.65685425,2.6658831 C6.77469148,-0.451954124 11.8473409,-0.457338747 14.9727349,2.66805521 L65.0864256,52.7817459 L115.200116,2.66805521 C118.321256,-0.453084553 123.391803,-0.458311231 126.515997,2.6658831 C129.633834,5.78372033 129.639219,10.8563698 126.513825,13.9817637 L76.4001341,64.0954544 L126.513825,114.209145 C129.634965,117.330285 129.640191,122.400831 126.515997,125.525026 C123.39816,128.642863 118.32551,128.648248 115.200116,125.522854 L65.0864256,75.4091629 L65.0864256,75.4091629 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/close-others-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/close-others-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-close-others-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 127\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M64,128 C99.346224,128 128,99.346224 128,64 C128,28.653776 99.346224,0 64,0 C28.653776,0 0,28.653776 0,64 C0,99.346224 28.653776,128 64,128 Z M64,112 C90.509668,112 112,90.509668 112,64 C112,37.490332 90.509668,16 64,16 C37.490332,16 16,37.490332 16,64 C16,90.509668 37.490332,112 64,112 Z M64,96 C81.673112,96 96,81.673112 96,64 C96,46.326888 81.673112,32 64,32 C46.326888,32 32,46.326888 32,64 C32,81.673112 46.326888,96 64,96 Z M64,80 C72.836556,80 80,72.836556 80,64 C80,55.163444 72.836556,48 64,48 C55.163444,48 48,55.163444 48,64 C48,72.836556 55.163444,80 64,80 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/delete-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/delete-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-delete-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot; transform=\&quot;translate(12.000000, 0.000000)\&quot;&gt;\n        &lt;rect x=\&quot;0\&quot; y=\&quot;11\&quot; width=\&quot;105\&quot; height=\&quot;16\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n        &lt;rect x=\&quot;28\&quot; y=\&quot;0\&quot; width=\&quot;48\&quot; height=\&quot;16\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n        &lt;rect x=\&quot;8\&quot; y=\&quot;16\&quot; width=\&quot;16\&quot; height=\&quot;112\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n        &lt;rect x=\&quot;8\&quot; y=\&quot;112\&quot; width=\&quot;88\&quot; height=\&quot;16\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n        &lt;rect x=\&quot;80\&quot; y=\&quot;16\&quot; width=\&quot;16\&quot; height=\&quot;112\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n        &lt;rect x=\&quot;56\&quot; y=\&quot;16\&quot; width=\&quot;16\&quot; height=\&quot;112\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n        &lt;rect x=\&quot;32\&quot; y=\&quot;16\&quot; width=\&quot;16\&quot; height=\&quot;112\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/done-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/done-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-done-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M3.52445141,76.8322939 C2.07397484,75.3828178 1.17514421,73.3795385 1.17514421,71.1666288 L1.17514421,23.1836596 C1.17514421,18.7531992 4.75686621,15.1751442 9.17514421,15.1751442 C13.5844319,15.1751442 17.1751442,18.7606787 17.1751442,23.1836596 L17.1751442,63.1751442 L119.173716,63.1751442 C123.590457,63.1751442 127.175144,66.7568662 127.175144,71.1751442 C127.175144,75.5844319 123.592783,79.1751442 119.173716,79.1751442 L9.17657227,79.1751442 C6.96796403,79.1751442 4.9674142,78.279521 3.51911285,76.8315312 Z\&quot; id=\&quot;Rectangle-285\&quot; transform=\&quot;translate(64.175144, 47.175144) rotate(-45.000000) translate(-64.175144, -47.175144) \&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/down-arrow&quot;: {
            &quot;title&quot;: &quot;$:/core/images/down-arrow&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-down-arrow tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;path d=\&quot;M109.35638,81.3533152 C107.923899,82.7869182 105.94502,83.6751442 103.759224,83.6751442 L24.5910645,83.6751442 C20.225873,83.6751442 16.6751442,80.1307318 16.6751442,75.7584775 C16.6751442,71.3951199 20.2192225,67.8418109 24.5910645,67.8418109 L95.8418109,67.8418109 L95.8418109,-3.40893546 C95.8418109,-7.77412698 99.3862233,-11.3248558 103.758478,-11.3248558 C108.121835,-11.3248558 111.675144,-7.78077754 111.675144,-3.40893546 L111.675144,75.7592239 C111.675144,77.9416955 110.789142,79.9205745 109.356651,81.3538862 Z\&quot; transform=\&quot;translate(64.175144, 36.175144) rotate(45.000000) translate(-64.175144, -36.175144) \&quot;&gt;&lt;/path&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/download-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/download-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-download-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 129 128\&quot;&gt;&lt;g fill-rule=\&quot;evenodd\&quot;&gt;&lt;path class=\&quot;tc-image-download-button-ring\&quot; d=\&quot;M64,128 C99.346224,128 128,99.346224 128,64 C128,28.653776 99.346224,0 64,0 C28.653776,0 0,28.653776 0,64 C0,99.346224 28.653776,128 64,128 Z M64,112 C90.509668,112 112,90.509668 112,64 C112,37.490332 90.509668,16 64,16 C37.490332,16 16,37.490332 16,64 C16,90.509668 37.490332,112 64,112 Z\&quot;/&gt;&lt;path d=\&quot;M34.3496823,66.4308767 L61.2415823,93.634668 C63.0411536,95.4551107 65.9588502,95.4551107 67.7584215,93.634668 L94.6503215,66.4308767 C96.4498928,64.610434 96.4498928,61.6588981 94.6503215,59.8384554 C93.7861334,58.9642445 92.6140473,58.4731195 91.3919019,58.4731195 L82.9324098,58.4731195 C80.3874318,58.4731195 78.3243078,56.3860674 78.3243078,53.8115729 L78.3243078,38.6615466 C78.3243078,36.0870521 76.2611837,34 73.7162058,34 L55.283798,34 C52.7388201,34 50.675696,36.0870521 50.675696,38.6615466 L50.675696,38.6615466 L50.675696,53.8115729 C50.675696,56.3860674 48.612572,58.4731195 46.0675941,58.4731195 L37.608102,58.4731195 C35.063124,58.4731195 33,60.5601716 33,63.134666 C33,64.3709859 33.4854943,65.5566658 34.3496823,66.4308767 L34.3496823,66.4308767 Z\&quot;/&gt;&lt;/g&gt;&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/edit-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/edit-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-edit-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M116.870058,45.3431458 L108.870058,45.3431458 L108.870058,45.3431458 L108.870058,61.3431458 L116.870058,61.3431458 L116.870058,45.3431458 Z M124.870058,45.3431458 L127.649881,45.3431458 C132.066101,45.3431458 135.656854,48.9248678 135.656854,53.3431458 C135.656854,57.7524334 132.07201,61.3431458 127.649881,61.3431458 L124.870058,61.3431458 L124.870058,45.3431458 Z M100.870058,45.3431458 L15.6638275,45.3431458 C15.5064377,45.3431458 15.3501085,45.3476943 15.1949638,45.3566664 L15.1949638,45.3566664 C15.0628002,45.3477039 14.928279,45.3431458 14.7913977,45.3431458 C6.68160973,45.3431458 -8.34314575,53.3431458 -8.34314575,53.3431458 C-8.34314575,53.3431458 6.85614548,61.3431458 14.7913977,61.3431458 C14.9266533,61.3431458 15.0596543,61.3384973 15.190398,61.3293588 C15.3470529,61.3385075 15.5049057,61.3431458 15.6638275,61.3431458 L100.870058,61.3431458 L100.870058,45.3431458 L100.870058,45.3431458 Z\&quot; transform=\&quot;translate(63.656854, 53.343146) rotate(-45.000000) translate(-63.656854, -53.343146) \&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M35.1714596,124.189544 C41.9594858,123.613403 49.068777,121.917633 58.85987,118.842282 C60.6854386,118.268877 62.4306907,117.705515 65.1957709,116.802278 C81.1962861,111.575575 87.0734839,109.994907 93.9414474,109.655721 C102.29855,109.242993 107.795169,111.785371 111.520478,118.355045 C112.610163,120.276732 115.051363,120.951203 116.97305,119.861518 C118.894737,118.771832 119.569207,116.330633 118.479522,114.408946 C113.146151,105.003414 104.734907,101.112919 93.5468356,101.66546 C85.6716631,102.054388 79.4899908,103.716944 62.7116783,109.197722 C59.9734132,110.092199 58.2519873,110.64787 56.4625698,111.20992 C37.002649,117.322218 25.6914684,118.282267 16.8654804,112.957098 C14.9739614,111.815848 12.5154166,112.424061 11.3741667,114.31558 C10.2329168,116.207099 10.84113,118.665644 12.7326489,119.806894 C19.0655164,123.627836 26.4866335,124.926678 35.1714596,124.189544 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/export-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/export-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-export-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M8.00348646,127.999999 C8.00464867,128 8.00581094,128 8.00697327,128 L119.993027,128 C122.205254,128 124.207939,127.101378 125.657096,125.651198 L125.656838,125.65759 C127.104563,124.210109 128,122.21009 128,119.999949 L128,56.0000511 C128,51.5817449 124.409288,48 120,48 C115.581722,48 112,51.5797863 112,56.0000511 L112,112 L16,112 L16,56.0000511 C16,51.5817449 12.4092877,48 8,48 C3.581722,48 7.10542736e-15,51.5797863 7.10542736e-15,56.0000511 L7.10542736e-15,119.999949 C7.10542736e-15,124.418255 3.59071231,128 8,128 C8.00116233,128 8.0023246,128 8.00348681,127.999999 Z M56.6235633,27.3113724 L47.6580188,36.2769169 C44.5333664,39.4015692 39.4634864,39.4061295 36.339292,36.2819351 C33.2214548,33.1640979 33.2173444,28.0901742 36.3443103,24.9632084 L58.9616908,2.34582788 C60.5248533,0.782665335 62.5748436,0.000361191261 64.624516,2.38225238e-14 L64.6193616,0.00151809229 C66.6695374,0.000796251595 68.7211167,0.781508799 70.2854358,2.34582788 L92.9028163,24.9632084 C96.0274686,28.0878607 96.0320289,33.1577408 92.9078345,36.2819351 C89.7899973,39.3997724 84.7160736,39.4038827 81.5891078,36.2769169 L72.6235633,27.3113724 L72.6235633,88.5669606 C72.6235633,92.9781015 69.0418413,96.5662064 64.6235633,96.5662064 C60.2142756,96.5662064 56.6235633,92.984822 56.6235633,88.5669606 L56.6235633,27.3113724 L56.6235633,27.3113724 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/full-screen-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/full-screen-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-full-screen-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g&gt;\n        &lt;g&gt;\n            &lt;path d=\&quot;M5.29777586e-31,8 C1.59060409e-15,3.581722 3.581722,0 8,0 L40,0 C44.418278,0 48,3.581722 48,8 C48,12.418278 44.418278,16 40,16 L16,16 L16,40 C16,44.418278 12.418278,48 8,48 C3.581722,48 -3.55271368e-15,44.418278 0,40 L3.55271368e-15,8 Z\&quot;&gt;&lt;/path&gt;\n        &lt;/g&gt;\n        &lt;g transform=\&quot;translate(104.000000, 104.000000) rotate(-180.000000) translate(-104.000000, -104.000000) translate(80.000000, 80.000000)\&quot;&gt;\n            &lt;path d=\&quot;M5.29777586e-31,8 C1.59060409e-15,3.581722 3.581722,0 8,0 L40,0 C44.418278,0 48,3.581722 48,8 C48,12.418278 44.418278,16 40,16 L16,16 L16,40 C16,44.418278 12.418278,48 8,48 C3.581722,48 -3.55271368e-15,44.418278 0,40 L3.55271368e-15,8 Z\&quot;&gt;&lt;/path&gt;\n        &lt;/g&gt;\n        &lt;g transform=\&quot;translate(24.000000, 104.000000) rotate(-90.000000) translate(-24.000000, -104.000000) translate(0.000000, 80.000000)\&quot;&gt;\n            &lt;path d=\&quot;M5.29777586e-31,8 C1.59060409e-15,3.581722 3.581722,0 8,0 L40,0 C44.418278,0 48,3.581722 48,8 C48,12.418278 44.418278,16 40,16 L16,16 L16,40 C16,44.418278 12.418278,48 8,48 C3.581722,48 -3.55271368e-15,44.418278 0,40 L3.55271368e-15,8 Z\&quot;&gt;&lt;/path&gt;\n        &lt;/g&gt;\n        &lt;g transform=\&quot;translate(104.000000, 24.000000) rotate(90.000000) translate(-104.000000, -24.000000) translate(80.000000, 0.000000)\&quot;&gt;\n            &lt;path d=\&quot;M5.29777586e-31,8 C1.59060409e-15,3.581722 3.581722,0 8,0 L40,0 C44.418278,0 48,3.581722 48,8 C48,12.418278 44.418278,16 40,16 L16,16 L16,40 C16,44.418278 12.418278,48 8,48 C3.581722,48 -3.55271368e-15,44.418278 0,40 L3.55271368e-15,8 Z\&quot;&gt;&lt;/path&gt;\n        &lt;/g&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/globe&quot;: {
            &quot;title&quot;: &quot;$:/core/images/globe&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-globe tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M72.8111354,37.1275855 C72.8111354,37.9789875 72.8111354,38.8303894 72.8111354,39.6817913 C72.8111354,41.8784743 73.7885604,46.5631866 72.8111354,48.5143758 C71.3445471,51.4420595 68.1617327,52.0543531 66.4170946,54.3812641 C65.2352215,55.9575873 61.7987417,64.9821523 62.7262858,67.3005778 C66.6959269,77.2228204 74.26087,70.4881886 80.6887657,76.594328 C81.5527211,77.415037 83.5758191,78.8666631 83.985137,79.8899578 C87.2742852,88.1128283 76.4086873,94.8989524 87.7419325,106.189751 C88.9872885,107.430443 91.555495,102.372895 91.8205061,101.575869 C92.6726866,99.0129203 98.5458765,96.1267309 100.908882,94.5234439 C102.928056,93.1534443 105.782168,91.8557166 107.236936,89.7775886 C109.507391,86.5342557 108.717505,82.2640435 110.334606,79.0328716 C112.473794,74.7585014 114.163418,69.3979002 116.332726,65.0674086 C120.230862,57.2857361 121.054075,67.1596684 121.400359,67.5059523 C121.757734,67.8633269 122.411167,67.5059523 122.916571,67.5059523 C123.011132,67.5059523 124.364019,67.6048489 124.432783,67.5059523 C125.0832,66.5705216 123.390209,49.5852316 123.114531,48.2089091 C121.710578,41.1996597 116.17083,32.4278331 111.249523,27.7092761 C104.975994,21.6942076 104.160516,11.5121686 92.9912146,12.7547535 C92.7872931,12.7774397 87.906794,22.9027026 85.2136766,26.2672064 C81.486311,30.9237934 82.7434931,22.1144904 78.6876623,22.1144904 C78.6065806,22.1144904 77.5045497,22.0107615 77.4353971,22.1144904 C76.8488637,22.9942905 75.9952305,26.0101404 75.1288269,26.5311533 C74.8635477,26.6906793 73.4071369,26.2924966 73.2826811,26.5311533 C71.0401728,30.8313939 81.5394677,28.7427264 79.075427,34.482926 C76.7225098,39.9642538 72.747373,32.4860199 72.747373,43.0434079\&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M44.4668556,7.01044608 C54.151517,13.1403033 45.1489715,19.2084878 47.1611905,23.2253896 C48.8157833,26.5283781 51.4021933,28.6198851 48.8753629,33.038878 C46.8123257,36.6467763 42.0052989,37.0050492 39.251679,39.7621111 C36.2115749,42.8060154 33.7884281,48.7028116 32.4624592,52.6732691 C30.8452419,57.5158356 47.0088721,59.5388126 44.5246867,63.6811917 C43.1386839,65.9923513 37.7785192,65.1466282 36.0880227,63.8791519 C34.9234453,63.0059918 32.4946425,63.3331166 31.6713597,62.0997342 C29.0575851,58.1839669 29.4107339,54.0758543 28.0457962,49.9707786 C27.1076833,47.1493864 21.732611,47.8501656 20.2022714,49.3776393 C19.6790362,49.8998948 19.8723378,51.1703278 19.8723378,51.8829111 C19.8723378,57.1682405 26.9914913,55.1986414 26.9914913,58.3421973 C26.9914913,72.9792302 30.9191897,64.8771867 38.1313873,69.6793121 C48.1678018,76.3618966 45.9763926,76.981595 53.0777543,84.0829567 C56.7511941,87.7563965 60.8192437,87.7689005 62.503478,93.3767069 C64.1046972,98.7081071 53.1759798,98.7157031 50.786754,100.825053 C49.663965,101.816317 47.9736094,104.970571 46.5680513,105.439676 C44.7757187,106.037867 43.334221,105.93607 41.6242359,107.219093 C39.1967302,109.040481 37.7241465,112.151588 37.6034934,112.030935 C35.4555278,109.88297 34.0848666,96.5511248 33.7147244,93.7726273 C33.1258872,89.3524817 28.1241923,88.2337027 26.7275443,84.7420826 C25.1572737,80.8164061 28.2518481,75.223612 25.599097,70.9819941 C19.0797019,60.557804 13.7775712,56.4811506 10.2493953,44.6896152 C9.3074899,41.5416683 13.5912267,38.1609942 15.1264825,35.8570308 C17.0029359,33.0410312 17.7876232,30.0028946 19.8723378,27.2224065 C22.146793,24.1888519 40.8551166,9.46076832 43.8574051,8.63490613 L44.4668556,7.01044608 Z\&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M64,126 C98.2416545,126 126,98.2416545 126,64 C126,29.7583455 98.2416545,2 64,2 C29.7583455,2 2,29.7583455 2,64 C2,98.2416545 29.7583455,126 64,126 Z M64,120 C94.927946,120 120,94.927946 120,64 C120,33.072054 94.927946,8 64,8 C33.072054,8 8,33.072054 8,64 C8,94.927946 33.072054,120 64,120 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/home-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/home-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-home-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M112.9847,119.501583 C112.99485,119.336814 113,119.170705 113,119.003406 L113,67.56802 C116.137461,70.5156358 121.076014,70.4518569 124.133985,67.3938855 C127.25818,64.2696912 127.260618,59.2068102 124.131541,56.0777326 L70.3963143,2.34250601 C68.8331348,0.779326498 66.7828947,-0.000743167069 64.7337457,1.61675364e-05 C62.691312,-0.00409949529 60.6426632,0.777559815 59.077717,2.34250601 L33,28.420223 L33,28.420223 L33,8.00697327 C33,3.58484404 29.4092877,0 25,0 C20.581722,0 17,3.59075293 17,8.00697327 L17,44.420223 L5.3424904,56.0777326 C2.21694607,59.2032769 2.22220878,64.2760483 5.34004601,67.3938855 C8.46424034,70.5180798 13.5271213,70.5205187 16.6561989,67.3914411 L17,67.04764 L17,119.993027 C17,119.994189 17.0000002,119.995351 17.0000007,119.996514 C17.0000002,119.997675 17,119.998838 17,120 C17,124.418278 20.5881049,128 24.9992458,128 L105.000754,128 C109.418616,128 113,124.409288 113,120 C113,119.832611 112.99485,119.666422 112.9847,119.501583 Z M97,112 L97,51.5736087 L97,51.5736087 L64.7370156,19.3106244 L33,51.04764 L33,112 L97,112 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/import-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/import-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-import-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M105.449437,94.2138951 C105.449437,94.2138951 110.049457,94.1897106 110.049457,99.4026111 C110.049457,104.615512 105.163246,104.615511 105.163246,104.615511 L45.0075072,105.157833 C45.0075072,105.157833 0.367531803,106.289842 0.367532368,66.6449212 C0.367532934,27.0000003 45.0428249,27.0000003 45.0428249,27.0000003 L105.532495,27.0000003 C105.532495,27.0000003 138.996741,25.6734987 138.996741,55.1771866 C138.996741,84.6808745 105.727102,82.8457535 105.727102,82.8457535 L56.1735087,82.8457535 C56.1735087,82.8457535 22.6899229,85.1500223 22.6899229,66.0913753 C22.6899229,47.0327282 56.1735087,49.3383013 56.1735087,49.3383013 L105.727102,49.3383013 C105.727102,49.3383013 111.245209,49.3383024 111.245209,54.8231115 C111.245209,60.3079206 105.727102,60.5074524 105.727102,60.5074524 L56.1735087,60.5074524 C56.1735087,60.5074524 37.48913,60.5074528 37.48913,66.6449195 C37.48913,72.7823862 56.1735087,71.6766023 56.1735087,71.6766023 L105.727102,71.6766029 C105.727102,71.6766029 127.835546,73.1411469 127.835546,55.1771866 C127.835546,35.5304025 105.727102,38.3035317 105.727102,38.3035317 L45.0428249,38.3035317 C45.0428249,38.3035317 11.5287276,38.3035313 11.5287276,66.6449208 C11.5287276,94.9863103 45.0428244,93.9579678 45.0428244,93.9579678 L105.449437,94.2138951 Z\&quot; transform=\&quot;translate(69.367532, 66.000000) rotate(-45.000000) translate(-69.367532, -66.000000) \&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/info-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/info-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-info-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;g transform=\&quot;translate(0.049406, 0.000000)\&quot;&gt;\n            &lt;path d=\&quot;M64,128 C99.346224,128 128,99.346224 128,64 C128,28.653776 99.346224,0 64,0 C28.653776,0 0,28.653776 0,64 C0,99.346224 28.653776,128 64,128 Z M64,112 C90.509668,112 112,90.509668 112,64 C112,37.490332 90.509668,16 64,16 C37.490332,16 16,37.490332 16,64 C16,90.509668 37.490332,112 64,112 Z\&quot;&gt;&lt;/path&gt;\n            &lt;circle cx=\&quot;64\&quot; cy=\&quot;32\&quot; r=\&quot;8\&quot;&gt;&lt;/circle&gt;\n            &lt;rect x=\&quot;56\&quot; y=\&quot;48\&quot; width=\&quot;16\&quot; height=\&quot;56\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n        &lt;/g&gt;\n    &lt;/g&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/locked-padlock&quot;: {
            &quot;title&quot;: &quot;$:/core/images/locked-padlock&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-locked-padlock tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M96.4723753,64 L105,64 L105,96.0097716 C105,113.673909 90.6736461,128 73.001193,128 L55.998807,128 C38.3179793,128 24,113.677487 24,96.0097716 L24,64 L32.0000269,64 C32.0028554,48.2766389 32.3030338,16.2688026 64.1594984,16.2688041 C95.9543927,16.2688056 96.4648869,48.325931 96.4723753,64 Z M80.5749059,64 L48.4413579,64 C48.4426205,47.71306 48.5829272,31.9999996 64.1595001,31.9999996 C79.8437473,31.9999996 81.1369461,48.1359182 80.5749059,64 Z M67.7315279,92.3641717 C70.8232551,91.0923621 73,88.0503841 73,84.5 C73,79.8055796 69.1944204,76 64.5,76 C59.8055796,76 56,79.8055796 56,84.5 C56,87.947435 58.0523387,90.9155206 61.0018621,92.2491029 L55.9067479,115.020857 L72.8008958,115.020857 L67.7315279,92.3641717 L67.7315279,92.3641717 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/menu-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/menu-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-menu-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;rect x=\&quot;0\&quot; y=\&quot;16\&quot; width=\&quot;128\&quot; height=\&quot;16\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n    &lt;rect x=\&quot;0\&quot; y=\&quot;56\&quot; width=\&quot;128\&quot; height=\&quot;16\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n    &lt;rect x=\&quot;0\&quot; y=\&quot;96\&quot; width=\&quot;128\&quot; height=\&quot;16\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/new-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/new-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-new-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M56,72 L8.00697327,72 C3.59075293,72 0,68.418278 0,64 C0,59.5907123 3.58484404,56 8.00697327,56 L56,56 L56,8.00697327 C56,3.59075293 59.581722,0 64,0 C68.4092877,0 72,3.58484404 72,8.00697327 L72,56 L119.993027,56 C124.409247,56 128,59.581722 128,64 C128,68.4092877 124.415156,72 119.993027,72 L72,72 L72,119.993027 C72,124.409247 68.418278,128 64,128 C59.5907123,128 56,124.415156 56,119.993027 L56,72 L56,72 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/new-here-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/new-here-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-new-here-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n    \t&lt;g transform=\&quot;translate(52.233611, 64.389922) rotate(75.000000) translate(-52.233611, -64.389922) translate(-7.734417, 3.702450)\&quot;&gt;\n\t        &lt;path d=\&quot;M18.9270186,45.959338 L18.9080585,49.6521741 C18.8884833,53.4648378 21.0574548,58.7482162 23.7526408,61.4434022 L78.5671839,116.257945 C81.2617332,118.952495 85.6348701,118.950391 88.3334363,116.251825 L115.863237,88.7220241 C118.555265,86.0299959 118.564544,81.6509578 115.869358,78.9557717 L61.0548144,24.1412286 C58.3602652,21.4466794 53.0787224,19.2788426 49.2595808,19.3006519 L25.9781737,19.4336012 C22.1633003,19.4553862 19.0471195,22.5673232 19.0275223,26.3842526 L18.9871663,34.2443819 C19.0818862,34.255617 19.1779758,34.2665345 19.2754441,34.2771502 C22.6891275,34.6489512 27.0485594,34.2348566 31.513244,33.2285542 C31.7789418,32.8671684 32.075337,32.5211298 32.4024112,32.1940556 C34.8567584,29.7397084 38.3789778,29.0128681 41.4406288,30.0213822 C41.5958829,29.9543375 41.7503946,29.8866669 41.9041198,29.8183808 L42.1110981,30.2733467 C43.1114373,30.6972371 44.0473796,31.3160521 44.8614145,32.1300869 C48.2842088,35.5528813 48.2555691,41.130967 44.7974459,44.5890903 C41.4339531,47.952583 36.0649346,48.0717177 32.6241879,44.9262969 C27.8170558,45.8919233 23.0726921,46.2881596 18.9270186,45.959338 Z\&quot;&gt;&lt;/path&gt;\n\t        &lt;path d=\&quot;M45.4903462,38.8768094 C36.7300141,42.6833154 26.099618,44.7997354 18.1909048,43.9383587 C7.2512621,42.7468685 1.50150083,35.8404432 4.66865776,24.7010202 C7.51507386,14.6896965 15.4908218,6.92103848 24.3842626,4.38423012 C34.1310219,1.60401701 42.4070208,6.15882777 42.4070209,16.3101169 L34.5379395,16.310117 C34.5379394,11.9285862 31.728784,10.3825286 26.5666962,11.8549876 C20.2597508,13.6540114 14.3453742,19.4148216 12.2444303,26.8041943 C10.4963869,32.9523565 12.6250796,35.5092726 19.0530263,36.2093718 C25.5557042,36.9176104 35.0513021,34.9907189 42.7038419,31.5913902 L42.7421786,31.6756595 C44.3874154,31.5384763 47.8846101,37.3706354 45.9274416,38.6772897 L45.9302799,38.6835285 C45.9166992,38.6895612 45.9031139,38.6955897 45.8895238,38.7016142 C45.8389288,38.7327898 45.7849056,38.7611034 45.7273406,38.7863919 C45.6506459,38.8200841 45.571574,38.8501593 45.4903462,38.8768094 Z\&quot;&gt;&lt;/path&gt;\n        &lt;/g&gt;\n        &lt;rect x=\&quot;96\&quot; y=\&quot;80\&quot; width=\&quot;16\&quot; height=\&quot;48\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n        &lt;rect x=\&quot;80\&quot; y=\&quot;96\&quot; width=\&quot;48\&quot; height=\&quot;16\&quot; rx=\&quot;8\&quot;&gt;&lt;/rect&gt;\n    &lt;/g&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/new-journal-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/new-journal-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-new-journal-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M102.545455,112.818182 L102.545455,124.636364 L102.545455,124.636364 L102.545455,124.636364 C102.545455,125.941761 103.630828,127 104.969697,127 L111.030303,127 C112.369172,127 113.454545,125.941761 113.454545,124.636364 L113.454545,112.818182 L125.575758,112.818182 C126.914626,112.818182 128,111.759982 128,110.454545 L128,104.545455 C128,103.240018 126.914626,102.181818 125.575758,102.181818 L113.454545,102.181818 L113.454545,90.3636364 C113.454545,89.0582 112.369172,88 111.030303,88 L104.969697,88 L104.969697,88 C103.630828,88 102.545455,89.0582 102.545455,90.3636364 L102.545455,102.181818 L90.4242424,102.181818 L90.4242424,102.181818 C89.0853705,102.181818 88,103.240018 88,104.545455 L88,110.454545 L88,110.454545 L88,110.454545 C88,111.759982 89.0853705,112.818182 90.4242424,112.818182 L102.545455,112.818182 Z\&quot;&gt;&lt;/path&gt;\n        &lt;g transform=\&quot;translate(59.816987, 64.316987) rotate(30.000000) translate(-59.816987, -64.316987) translate(20.316987, 12.816987)\&quot;&gt;\n            &lt;g transform=\&quot;translate(0.000000, 0.000000)\&quot;&gt;\n                &lt;path d=\&quot;M9.99631148,0 C4.4755011,0 -2.27373675e-13,4.48070044 -2.27373675e-13,9.99759461 L-2.27373675e-13,91.6128884 C-2.27373675e-13,97.1344074 4.46966773,101.610483 9.99631148,101.610483 L68.9318917,101.610483 C74.4527021,101.610483 78.9282032,97.1297826 78.9282032,91.6128884 L78.9282032,9.99759461 C78.9282032,4.47607557 74.4585355,0 68.9318917,0 L9.99631148,0 Z M20.8885263,26 C24.2022348,26 26.8885263,23.3137085 26.8885263,20 C26.8885263,16.6862915 24.2022348,14 20.8885263,14 C17.5748178,14 14.8885263,16.6862915 14.8885263,20 C14.8885263,23.3137085 17.5748178,26 20.8885263,26 Z M57.3033321,25.6783342 C60.6170406,25.6783342 63.3033321,22.9920427 63.3033321,19.6783342 C63.3033321,16.3646258 60.6170406,13.6783342 57.3033321,13.6783342 C53.9896236,13.6783342 51.3033321,16.3646258 51.3033321,19.6783342 C51.3033321,22.9920427 53.9896236,25.6783342 57.3033321,25.6783342 Z\&quot;&gt;&lt;/path&gt;\n                &lt;text font-family=\&quot;Helvetica\&quot; font-size=\&quot;47.1724138\&quot; font-weight=\&quot;bold\&quot; fill=\&quot;#FFFFFF\&quot;&gt;\n                    &lt;tspan x=\&quot;42\&quot; y=\&quot;77.4847912\&quot; text-anchor=\&quot;middle\&quot;&gt;&lt;&lt;now \&quot;DD\&quot;&gt;&gt;&lt;/tspan&gt;\n                &lt;/text&gt;\n            &lt;/g&gt;\n        &lt;/g&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/options-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/options-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-options-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M110.48779,76.0002544 C109.354214,80.4045063 107.611262,84.5641217 105.354171,88.3838625 L105.354171,88.3838625 L112.07833,95.1080219 C115.20107,98.2307613 115.210098,103.299824 112.089164,106.420759 L106.420504,112.089418 C103.301049,115.208874 98.2346851,115.205502 95.1077675,112.078585 L88.3836082,105.354425 C84.5638673,107.611516 80.4042519,109.354468 76,110.488045 L76,110.488045 L76,119.993281 C76,124.409501 72.4220153,128.000254 68.0083475,128.000254 L59.9916525,128.000254 C55.5800761,128.000254 52,124.41541 52,119.993281 L52,110.488045 C47.5957481,109.354468 43.4361327,107.611516 39.6163918,105.354425 L32.8922325,112.078585 C29.7694931,115.201324 24.7004301,115.210353 21.5794957,112.089418 L15.9108363,106.420759 C12.7913807,103.301303 12.7947522,98.2349395 15.9216697,95.1080219 L22.6458291,88.3838625 C20.3887383,84.5641217 18.6457859,80.4045063 17.5122098,76.0002544 L8.00697327,76.0002544 C3.59075293,76.0002544 2.19088375e-16,72.4222697 4.89347582e-16,68.0086019 L9.80228577e-16,59.9919069 C1.25035972e-15,55.5803305 3.58484404,52.0002544 8.00697327,52.0002544 L17.5122098,52.0002544 C18.6457859,47.5960025 20.3887383,43.4363871 22.6458291,39.6166462 L15.9216697,32.8924868 C12.7989304,29.7697475 12.7899019,24.7006845 15.9108363,21.5797501 L21.5794957,15.9110907 C24.6989513,12.7916351 29.7653149,12.7950065 32.8922325,15.9219241 L39.6163918,22.6460835 C43.4361327,20.3889927 47.5957481,18.6460403 52,17.5124642 L52,8.00722764 C52,3.5910073 55.5779847,0.000254375069 59.9916525,0.000254375069 L68.0083475,0.000254375069 C72.4199239,0.000254375069 76,3.58509841 76,8.00722764 L76,17.5124642 C80.4042519,18.6460403 84.5638673,20.3889927 88.3836082,22.6460835 L95.1077675,15.9219241 C98.2305069,12.7991848 103.29957,12.7901562 106.420504,15.9110907 L112.089164,21.5797501 C115.208619,24.6992057 115.205248,29.7655693 112.07833,32.8924868 L105.354171,39.6166462 L105.354171,39.6166462 C107.611262,43.4363871 109.354214,47.5960025 110.48779,52.0002544 L119.993027,52.0002544 C124.409247,52.0002544 128,55.5782391 128,59.9919069 L128,68.0086019 C128,72.4201783 124.415156,76.0002544 119.993027,76.0002544 L110.48779,76.0002544 L110.48779,76.0002544 Z M64,96.0002544 C81.673112,96.0002544 96,81.6733664 96,64.0002544 C96,46.3271424 81.673112,32.0002544 64,32.0002544 C46.326888,32.0002544 32,46.3271424 32,64.0002544 C32,81.6733664 46.326888,96.0002544 64,96.0002544 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/permalink-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/permalink-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-permalink-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M80.4834582,48 L73.0956761,80 L73.0956761,80 L47.5165418,80 L54.9043239,48 L80.4834582,48 Z M84.1773493,32 L89.8007299,7.64246248 C90.7941633,3.33942958 95.0918297,0.64641956 99.3968675,1.64031585 C103.693145,2.63218977 106.385414,6.93288901 105.390651,11.2416793 L100.598215,32 L104.000754,32 C108.411895,32 112,35.581722 112,40 C112,44.4092877 108.418616,48 104.000754,48 L96.9043239,48 L89.5165418,80 L104.000754,80 C108.411895,80 112,83.581722 112,88 C112,92.4092877 108.418616,96 104.000754,96 L85.8226507,96 L80.1992701,120.357538 C79.2058367,124.66057 74.9081703,127.35358 70.6031325,126.359684 C66.3068546,125.36781 63.6145865,121.067111 64.6093491,116.758321 L69.401785,96 L43.8226507,96 L38.1992701,120.357538 C37.2058367,124.66057 32.9081703,127.35358 28.6031325,126.359684 C24.3068546,125.36781 21.6145865,121.067111 22.6093491,116.758321 L27.401785,96 L23.9992458,96 C19.5881049,96 16,92.418278 16,88 C16,83.5907123 19.5813843,80 23.9992458,80 L31.0956761,80 L38.4834582,48 L23.9992458,48 C19.5881049,48 16,44.418278 16,40 C16,35.5907123 19.5813843,32 23.9992458,32 L42.1773493,32 L47.8007299,7.64246248 C48.7941633,3.33942958 53.0918297,0.64641956 57.3968675,1.64031585 C61.6931454,2.63218977 64.3854135,6.93288901 63.3906509,11.2416793 L58.598215,32 L84.1773493,32 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/permaview-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/permaview-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-permaview-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M81.4834582,48 L79.6365127,56 L79.6365127,56 L74.0573784,56 L75.9043239,48 L81.4834582,48 Z M85.1773493,32 L90.8007299,7.64246248 C91.7941633,3.33942958 96.0918297,0.64641956 100.396867,1.64031585 C104.693145,2.63218977 107.385414,6.93288901 106.390651,11.2416793 L101.598215,32 L104.000754,32 C108.411895,32 112,35.581722 112,40 C112,44.4092877 108.418616,48 104.000754,48 L97.9043239,48 L96.0573784,56 L104.000754,56 C108.411895,56 112,59.581722 112,64 C112,68.4092877 108.418616,72 104.000754,72 L92.3634873,72 L90.5165418,80 L104.000754,80 C108.411895,80 112,83.581722 112,88 C112,92.4092877 108.418616,96 104.000754,96 L86.8226507,96 L81.1992701,120.357538 C80.2058367,124.66057 75.9081703,127.35358 71.6031325,126.359684 C67.3068546,125.36781 64.6145865,121.067111 65.6093491,116.758321 L70.401785,96 L64.8226507,96 L59.1992701,120.357538 C58.2058367,124.66057 53.9081703,127.35358 49.6031325,126.359684 C45.3068546,125.36781 42.6145865,121.067111 43.6093491,116.758321 L48.401785,96 L42.8226507,96 L37.1992701,120.357538 C36.2058367,124.66057 31.9081703,127.35358 27.6031325,126.359684 C23.3068546,125.36781 20.6145865,121.067111 21.6093491,116.758321 L26.401785,96 L23.9992458,96 C19.5881049,96 16,92.418278 16,88 C16,83.5907123 19.5813843,80 23.9992458,80 L30.0956761,80 L31.9426216,72 L23.9992458,72 C19.5881049,72 16,68.418278 16,64 C16,59.5907123 19.5813843,56 23.9992458,56 L35.6365127,56 L37.4834582,48 L23.9992458,48 C19.5881049,48 16,44.418278 16,40 C16,35.5907123 19.5813843,32 23.9992458,32 L41.1773493,32 L46.8007299,7.64246248 C47.7941633,3.33942958 52.0918297,0.64641956 56.3968675,1.64031585 C60.6931454,2.63218977 63.3854135,6.93288901 62.3906509,11.2416793 L57.598215,32 L63.1773493,32 L68.8007299,7.64246248 C69.7941633,3.33942958 74.0918297,0.64641956 78.3968675,1.64031585 C82.6931454,2.63218977 85.3854135,6.93288901 84.3906509,11.2416793 L79.598215,32 L85.1773493,32 Z M53.9043239,48 L52.0573784,56 L57.6365127,56 L59.4834582,48 L53.9043239,48 Z M75.9426216,72 L74.0956761,80 L74.0956761,80 L68.5165418,80 L70.3634873,72 L75.9426216,72 L75.9426216,72 Z M48.3634873,72 L46.5165418,80 L52.0956761,80 L53.9426216,72 L48.3634873,72 L48.3634873,72 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/plugin-generic-language&quot;: {
            &quot;title&quot;: &quot;$:/core/images/plugin-generic-language&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M61.2072232,68.1369825 C56.8829239,70.9319564 54.2082892,74.793177 54.2082892,79.0581634 C54.2082892,86.9638335 63.3980995,93.4821994 75.2498076,94.3940006 C77.412197,98.2964184 83.8475284,101.178858 91.5684735,101.403106 C86.4420125,100.27851 82.4506393,97.6624107 80.9477167,94.3948272 C92.8046245,93.4861461 102,86.9662269 102,79.0581634 C102,70.5281905 91.3014611,63.6132813 78.1041446,63.6132813 C71.5054863,63.6132813 65.5315225,65.3420086 61.2072232,68.1369825 Z M74.001066,53.9793443 C69.6767667,56.7743182 63.7028029,58.5030456 57.1041446,58.5030456 C54.4851745,58.5030456 51.9646095,58.2307276 49.6065315,57.7275105 C46.2945155,59.9778212 41.2235699,61.4171743 35.5395922,61.4171743 C35.4545771,61.4171743 35.3696991,61.4168523 35.2849622,61.4162104 C39.404008,60.5235193 42.7961717,58.6691298 44.7630507,56.286533 C37.8379411,53.5817651 33.2082892,48.669413 33.2082892,43.0581634 C33.2082892,34.5281905 43.9068281,27.6132812 57.1041446,27.6132812 C70.3014611,27.6132812 81,34.5281905 81,43.0581634 C81,47.3231498 78.3253653,51.1843704 74.001066,53.9793443 Z M64,0 L118.5596,32 L118.5596,96 L64,128 L9.44039956,96 L9.44039956,32 L64,0 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/plugin-generic-plugin&quot;: {
            &quot;title&quot;: &quot;$:/core/images/plugin-generic-plugin&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M40.3972881,76.4456988 L40.3972881,95.3404069 L54.5170166,95.3404069 L54.5170166,95.3404069 C54.5165526,95.3385183 54.516089,95.3366295 54.515626,95.3347404 C54.6093153,95.3385061 54.7034848,95.3404069 54.7980982,95.3404069 C58.6157051,95.3404069 61.710487,92.245625 61.710487,88.4280181 C61.710487,86.6197822 61.01617,84.9737128 59.8795929,83.7418666 L59.8795929,83.7418666 C59.8949905,83.7341665 59.9104102,83.7265043 59.925852,83.7188798 C58.8840576,82.5086663 58.2542926,80.9336277 58.2542926,79.2114996 C58.2542926,75.3938927 61.3490745,72.2991108 65.1666814,72.2991108 C68.9842884,72.2991108 72.0790703,75.3938927 72.0790703,79.2114996 C72.0790703,81.1954221 71.2432806,82.9841354 69.9045961,84.2447446 L69.9045961,84.2447446 C69.9333407,84.2629251 69.9619885,84.281245 69.9905383,84.2997032 L69.9905383,84.2997032 C69.1314315,85.4516923 68.6228758,86.8804654 68.6228758,88.4280181 C68.6228758,91.8584969 71.1218232,94.7053153 74.3986526,95.2474079 C74.3913315,95.2784624 74.3838688,95.3094624 74.3762652,95.3404069 L95.6963988,95.3404069 L95.6963988,75.5678578 L95.6963988,75.5678578 C95.6466539,75.5808558 95.5967614,75.5934886 95.5467242,75.6057531 C95.5504899,75.5120637 95.5523907,75.4178943 95.5523907,75.3232809 C95.5523907,71.505674 92.4576088,68.4108921 88.6400019,68.4108921 C86.831766,68.4108921 85.1856966,69.105209 83.9538504,70.2417862 L83.9538504,70.2417862 C83.9461503,70.2263886 83.938488,70.2109688 83.9308636,70.1955271 C82.7206501,71.2373215 81.1456115,71.8670865 79.4234834,71.8670865 C75.6058765,71.8670865 72.5110946,68.7723046 72.5110946,64.9546976 C72.5110946,61.1370907 75.6058765,58.0423088 79.4234834,58.0423088 C81.4074059,58.0423088 83.1961192,58.8780985 84.4567284,60.2167829 L84.4567284,60.2167829 C84.4749089,60.1880383 84.4932288,60.1593906 84.511687,60.1308407 L84.511687,60.1308407 C85.6636761,60.9899475 87.0924492,61.4985032 88.6400019,61.4985032 C92.0704807,61.4985032 94.9172991,58.9995558 95.4593917,55.7227265 C95.538755,55.7414363 95.6177614,55.761071 95.6963988,55.7816184 L95.6963988,40.0412962 L74.3762652,40.0412962 L74.3762652,40.0412962 C74.3838688,40.0103516 74.3913315,39.9793517 74.3986526,39.9482971 L74.3986526,39.9482971 C71.1218232,39.4062046 68.6228758,36.5593862 68.6228758,33.1289073 C68.6228758,31.5813547 69.1314315,30.1525815 69.9905383,29.0005925 C69.9619885,28.9821342 69.9333407,28.9638143 69.9045961,28.9456339 C71.2432806,27.6850247 72.0790703,25.8963113 72.0790703,23.9123888 C72.0790703,20.0947819 68.9842884,17 65.1666814,17 C61.3490745,17 58.2542926,20.0947819 58.2542926,23.9123888 C58.2542926,25.6345169 58.8840576,27.2095556 59.925852,28.419769 L59.925852,28.419769 C59.9104102,28.4273935 59.8949905,28.4350558 59.8795929,28.4427558 C61.01617,29.674602 61.710487,31.3206715 61.710487,33.1289073 C61.710487,36.9465143 58.6157051,40.0412962 54.7980982,40.0412962 C54.7034848,40.0412962 54.6093153,40.0393953 54.515626,40.0356296 L54.515626,40.0356296 C54.516089,40.0375187 54.5165526,40.0394075 54.5170166,40.0412962 L40.3972881,40.0412962 L40.3972881,52.887664 L40.3972881,52.887664 C40.4916889,53.3430132 40.5412962,53.8147625 40.5412962,54.2980982 C40.5412962,58.1157051 37.4465143,61.210487 33.6289073,61.210487 C32.0813547,61.210487 30.6525815,60.7019313 29.5005925,59.8428245 C29.4821342,59.8713744 29.4638143,59.9000221 29.4456339,59.9287667 C28.1850247,58.5900823 26.3963113,57.7542926 24.4123888,57.7542926 C20.5947819,57.7542926 17.5,60.8490745 17.5,64.6666814 C17.5,68.4842884 20.5947819,71.5790703 24.4123888,71.5790703 C26.134517,71.5790703 27.7095556,70.9493053 28.919769,69.9075109 L28.919769,69.9075109 C28.9273935,69.9229526 28.9350558,69.9383724 28.9427558,69.95377 C30.174602,68.8171928 31.8206715,68.1228758 33.6289073,68.1228758 C37.4465143,68.1228758 40.5412962,71.2176578 40.5412962,75.0352647 C40.5412962,75.5186004 40.4916889,75.9903496 40.3972881,76.4456988 Z M64,0 L118.5596,32 L118.5596,96 L64,128 L9.44039956,96 L9.44039956,32 L64,0 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/plugin-generic-theme&quot;: {
            &quot;title&quot;: &quot;$:/core/images/plugin-generic-theme&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M27.6619958,98.5383065 C27.5690581,98.5388896 27.4761291,98.539182 27.383212,98.539182 C41.5122315,92.2342259 36.7359182,71.4340774 52.2062903,71.4340772 C52.3396942,72.0325374 52.4778143,72.6764878 52.6543744,73.3309353 C41.7206358,71.5725612 42.70852,93.6013809 27.6619958,98.5383065 Z M27.962646,98.5354078 C44.3675979,98.3221342 60.9448114,89.104528 60.944811,79.6231217 C57.0326028,79.6231217 55.0057081,78.1546059 53.8483468,76.2715831 C46.8437297,73.3160546 41.0335584,95.5643154 27.9626323,98.5354081 Z M60.4476718,66.8723739 C57.4632888,63.6421817 54.9582687,60.7541572 53.4305549,58.7453802 C47.3662923,50.7715364 44.307483,54.9700909 40.8462757,58.7453801 C37.3850684,62.5206692 41.7580858,65.5796149 38.4732643,68.2464352 C35.1884428,70.9132556 35.391237,71.8376623 29.8473278,66.9588778 C24.3034186,62.0800933 23.919977,60.7368279 26.4649349,57.9530299 C29.0098928,55.1692318 31.1369568,59.5524845 36.3357237,54.6053302 C41.5344905,49.6581758 37.1673192,45.2736183 37.1673192,45.2736183 C37.1673192,45.2736183 47.9916921,23.1463023 62.4556497,24.7805686 C76.9196074,26.4148348 56.9839048,22.6644011 52.0250205,40.0179431 C49.9018746,47.4478606 52.4201529,45.6971267 56.4460414,48.8353078 C57.8695188,49.9449088 63.120208,53.6842856 69.3136884,58.3372485 C77.8095419,50.1273311 87.3705002,40.8200581 90.1462007,38.0443577 C94.9225135,33.268045 99.6988262,38.0443577 94.9225134,42.8206705 C92.2168565,45.5263274 83.0052228,54.3768782 74.6585455,62.4104777 C84.7196352,70.2010353 95.1107413,79.0341049 95.1107416,82.5307694 C95.1107421,88.9149413 92.3944614,92.7263341 86.6764506,90.6368273 C83.0906414,89.3264812 73.3126471,80.2536547 65.0234105,71.7029822 C62.8994697,73.7599251 61.2357389,75.3821997 60.3189624,76.2989761 C57.6045976,78.4574835 53.6647127,73.2589589 55.5426497,71.5226634 C56.5140946,70.6244887 58.249291,68.9770292 60.4476718,66.8723739 L60.4476718,66.8723739 Z M64,0 L118.5596,32 L118.5596,96 L64,128 L9.44039956,96 L9.44039956,32 L64,0 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/refresh-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/refresh-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-refresh-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M106.369002,39.4325143 C116.529932,60.3119371 112.939592,86.1974934 95.5979797,103.539105 C73.7286194,125.408466 38.2713806,125.408466 16.4020203,103.539105 C-5.46734008,81.6697449 -5.46734008,46.2125061 16.4020203,24.3431458 C19.5262146,21.2189514 24.5915344,21.2189514 27.7157288,24.3431458 C30.8399231,27.4673401 30.8399231,32.5326599 27.7157288,35.6568542 C12.0947571,51.2778259 12.0947571,76.6044251 27.7157288,92.2253967 C43.3367004,107.846368 68.6632996,107.846368 84.2842712,92.2253967 C97.71993,78.7897379 99.5995262,58.1740623 89.9230597,42.729491 L83.4844861,54.9932839 C81.4307001,58.9052072 76.5945372,60.4115251 72.682614,58.3577391 C68.7706907,56.3039532 67.2643728,51.4677903 69.3181587,47.555867 L84.4354914,18.7613158 C86.4966389,14.8353707 91.3577499,13.3347805 95.273202,15.415792 L124.145886,30.7612457 C128.047354,32.8348248 129.52915,37.6785572 127.455571,41.5800249 C125.381992,45.4814927 120.53826,46.9632892 116.636792,44.8897102 L106.369002,39.4325143 Z M98.1470904,27.0648707 C97.9798954,26.8741582 97.811187,26.6843098 97.6409651,26.4953413 L98.6018187,26.1987327 L98.1470904,27.0648707 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/right-arrow&quot;: {
            &quot;title&quot;: &quot;$:/core/images/right-arrow&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-right-arrow tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;path d=\&quot;M80.3563798,109.353315 C78.9238993,110.786918 76.9450203,111.675144 74.7592239,111.675144 L-4.40893546,111.675144 C-8.77412698,111.675144 -12.3248558,108.130732 -12.3248558,103.758478 C-12.3248558,99.3951199 -8.78077754,95.8418109 -4.40893546,95.8418109 L66.8418109,95.8418109 L66.8418109,24.5910645 C66.8418109,20.225873 70.3862233,16.6751442 74.7584775,16.6751442 C79.1218352,16.6751442 82.6751442,20.2192225 82.6751442,24.5910645 L82.6751442,103.759224 C82.6751442,105.941695 81.7891419,107.920575 80.3566508,109.353886 Z\&quot; transform=\&quot;translate(35.175144, 64.175144) rotate(-45.000000) translate(-35.175144, -64.175144) \&quot;&gt;&lt;/path&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/save-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/save-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-save-button tc-image-button\&quot; viewBox=\&quot;0 0 128 128\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M120.78304,34.329058 C125.424287,43.1924006 128.049406,53.2778608 128.049406,63.9764502 C128.049406,99.3226742 99.3956295,127.97645 64.0494055,127.97645 C28.7031816,127.97645 0.0494055385,99.3226742 0.0494055385,63.9764502 C0.0494055385,28.6302262 28.7031816,-0.0235498012 64.0494055,-0.0235498012 C82.8568763,-0.0235498012 99.769563,8.08898558 111.479045,21.0056358 L114.159581,18.3250998 C117.289194,15.1954866 122.356036,15.1939641 125.480231,18.3181584 C128.598068,21.4359957 128.601317,26.5107804 125.473289,29.6388083 L120.78304,34.329058 Z M108.72451,46.3875877 C110.870571,51.8341374 112.049406,57.767628 112.049406,63.9764502 C112.049406,90.4861182 90.5590735,111.97645 64.0494055,111.97645 C37.5397375,111.97645 16.0494055,90.4861182 16.0494055,63.9764502 C16.0494055,37.4667822 37.5397375,15.9764502 64.0494055,15.9764502 C78.438886,15.9764502 91.3495036,22.308215 100.147097,32.3375836 L58.9411255,73.5435552 L41.975581,56.5780107 C38.8486152,53.4510448 33.7746915,53.4551552 30.6568542,56.5729924 C27.5326599,59.6971868 27.5372202,64.7670668 30.6618725,67.8917192 L53.279253,90.5090997 C54.8435723,92.073419 56.8951519,92.8541315 58.9380216,92.8558261 C60.987971,92.8559239 63.0389578,92.0731398 64.6049211,90.5071765 L108.72451,46.3875877 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/star-filled&quot;: {
            &quot;title&quot;: &quot;$:/core/images/star-filled&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-star-filled tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;nonzero\&quot;&gt;\n        &lt;path d=\&quot;M61.8361286,96.8228569 L99.1627704,124.110219 C101.883827,126.099427 105.541968,123.420868 104.505636,120.198072 L90.2895569,75.9887263 L89.0292911,79.8977279 L126.314504,52.5528988 C129.032541,50.5595011 127.635256,46.2255025 124.273711,46.2229134 L78.1610486,46.1873965 L81.4604673,48.6032923 L67.1773543,4.41589688 C66.1361365,1.19470104 61.6144265,1.19470104 60.5732087,4.41589688 L46.2900957,48.6032923 L49.5895144,46.1873965 L3.47685231,46.2229134 C0.115307373,46.2255025 -1.28197785,50.5595011 1.43605908,52.5528988 L38.7212719,79.8977279 L37.4610061,75.9887263 L23.2449266,120.198072 C22.2085954,123.420868 25.8667356,126.099427 28.5877926,124.110219 L65.9144344,96.8228569 L61.8361286,96.8228569 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/storyview-classic&quot;: {
            &quot;title&quot;: &quot;$:/core/images/storyview-classic&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-storyview-classic tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 129 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M8.00697327,0 C3.58484404,0 0,3.59075293 0,8.00697327 L0,119.993027 C0,124.415156 3.59075293,128 8.00697327,128 L119.993027,128 C124.415156,128 128,124.409247 128,119.993027 L128,8.00697327 C128,3.58484404 124.409247,0 119.993027,0 L8.00697327,0 L8.00697327,0 Z M23.9992458,16 C19.5813843,16 16,19.5776607 16,23.9924054 L16,40.0075946 C16,44.4216782 19.5881049,48 23.9992458,48 L104.000754,48 C108.418616,48 112,44.4223393 112,40.0075946 L112,23.9924054 C112,19.5783218 108.411895,16 104.000754,16 L23.9992458,16 L23.9992458,16 Z M23.9992458,64 C19.5813843,64 16,67.5907123 16,72 C16,76.418278 19.5881049,80 23.9992458,80 L104.000754,80 C108.418616,80 112,76.4092877 112,72 C112,67.581722 108.411895,64 104.000754,64 L23.9992458,64 L23.9992458,64 Z M23.9992458,96 C19.5813843,96 16,99.5907123 16,104 C16,108.418278 19.5881049,112 23.9992458,112 L104.000754,112 C108.418616,112 112,108.409288 112,104 C112,99.581722 108.411895,96 104.000754,96 L23.9992458,96 L23.9992458,96 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/storyview-pop&quot;: {
            &quot;title&quot;: &quot;$:/core/images/storyview-pop&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-storyview-pop tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M8.00697327,0 C3.58484404,0 0,3.59075293 0,8.00697327 L0,119.993027 C0,124.415156 3.59075293,128 8.00697327,128 L119.993027,128 C124.415156,128 128,124.409247 128,119.993027 L128,8.00697327 C128,3.58484404 124.409247,0 119.993027,0 L8.00697327,0 L8.00697327,0 Z M23.9992458,16 C19.5813843,16 16,19.5776607 16,23.9924054 L16,40.0075946 C16,44.4216782 19.5881049,48 23.9992458,48 L104.000754,48 C108.418616,48 112,44.4223393 112,40.0075946 L112,23.9924054 C112,19.5783218 108.411895,16 104.000754,16 L23.9992458,16 L23.9992458,16 Z M16.0098166,56 C11.586117,56 8,59.5776607 8,63.9924054 L8,80.0075946 C8,84.4216782 11.5838751,88 16.0098166,88 L111.990183,88 C116.413883,88 120,84.4223393 120,80.0075946 L120,63.9924054 C120,59.5783218 116.416125,56 111.990183,56 L16.0098166,56 L16.0098166,56 Z M23.9992458,96 C19.5813843,96 16,99.5907123 16,104 C16,108.418278 19.5881049,112 23.9992458,112 L104.000754,112 C108.418616,112 112,108.409288 112,104 C112,99.581722 108.411895,96 104.000754,96 L23.9992458,96 L23.9992458,96 Z M23.9992458,64 C19.5813843,64 16,67.5907123 16,72 C16,76.418278 19.5881049,80 23.9992458,80 L104.000754,80 C108.418616,80 112,76.4092877 112,72 C112,67.581722 108.411895,64 104.000754,64 L23.9992458,64 L23.9992458,64 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/storyview-zoomin&quot;: {
            &quot;title&quot;: &quot;$:/core/images/storyview-zoomin&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-storyview-zoomin tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M8.00697327,0 C3.58484404,0 0,3.59075293 0,8.00697327 L0,119.993027 C0,124.415156 3.59075293,128 8.00697327,128 L119.993027,128 C124.415156,128 128,124.409247 128,119.993027 L128,8.00697327 C128,3.58484404 124.409247,0 119.993027,0 L8.00697327,0 L8.00697327,0 Z M23.9992458,16 C19.5813843,16 16,19.578055 16,24.0085154 L16,71.9914846 C16,76.4144655 19.5881049,80 23.9992458,80 L104.000754,80 C108.418616,80 112,76.421945 112,71.9914846 L112,24.0085154 C112,19.5855345 108.411895,16 104.000754,16 L23.9992458,16 L23.9992458,16 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/tag-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/tag-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-tag-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M18.1643182,47.6600756 L18.1677196,51.7651887 C18.1708869,55.5878829 20.3581578,60.8623899 23.0531352,63.5573673 L84.9021823,125.406414 C87.5996731,128.103905 91.971139,128.096834 94.6717387,125.396234 L125.766905,94.3010679 C128.473612,91.5943612 128.472063,87.2264889 125.777085,84.5315115 L63.9280381,22.6824644 C61.2305472,19.9849735 55.9517395,17.801995 52.1318769,17.8010313 L25.0560441,17.7942007 C21.2311475,17.7932358 18.1421354,20.8872832 18.1452985,24.7049463 L18.1535504,34.6641936 C18.2481119,34.6754562 18.3439134,34.6864294 18.4409623,34.6971263 C22.1702157,35.1081705 26.9295004,34.6530132 31.806204,33.5444844 C32.1342781,33.0700515 32.5094815,32.6184036 32.9318197,32.1960654 C35.6385117,29.4893734 39.5490441,28.718649 42.94592,29.8824694 C43.0432142,29.8394357 43.1402334,29.7961748 43.2369683,29.7526887 L43.3646982,30.0368244 C44.566601,30.5115916 45.6933052,31.2351533 46.6655958,32.2074439 C50.4612154,36.0030635 50.4663097,42.1518845 46.6769742,45.94122 C43.0594074,49.5587868 37.2914155,49.7181264 33.4734256,46.422636 C28.1082519,47.5454734 22.7987486,48.0186448 18.1643182,47.6600756 Z\&quot;&gt;&lt;/path&gt;\n        &lt;path d=\&quot;M47.6333528,39.5324628 L47.6562932,39.5834939 C37.9670934,43.9391617 26.0718874,46.3819521 17.260095,45.4107025 C5.27267473,44.0894301 -1.02778744,36.4307276 2.44271359,24.0779512 C5.56175386,12.9761516 14.3014034,4.36129832 24.0466405,1.54817001 C34.7269254,-1.53487574 43.7955833,3.51606438 43.7955834,14.7730751 L35.1728168,14.7730752 C35.1728167,9.91428944 32.0946059,8.19982862 26.4381034,9.83267419 C19.5270911,11.8276553 13.046247,18.2159574 10.7440788,26.4102121 C8.82861123,33.2280582 11.161186,36.0634845 18.2047888,36.8398415 C25.3302805,37.6252244 35.7353482,35.4884477 44.1208333,31.7188498 L44.1475077,31.7781871 C44.159701,31.7725635 44.1718402,31.7671479 44.1839238,31.7619434 C45.9448098,31.0035157 50.4503245,38.3109156 47.7081571,39.5012767 C47.6834429,39.512005 47.6585061,39.5223987 47.6333528,39.5324628 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/core/images/theme-button&quot;: {
            &quot;title&quot;: &quot;$:/core/images/theme-button&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-theme-button tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 129\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;g transform=\&quot;translate(6.762422, 19.968999)\&quot;&gt;\n            &lt;path d=\&quot;M0.824945506,108.186742 C0.664785639,108.187747 0.504640965,108.188251 0.344516735,108.188251 C24.6927592,97.3230528 16.4618388,61.4785938 43.121606,61.4785936 C43.3514982,62.5099075 43.5895175,63.6196137 43.8937798,64.7474092 C25.0518979,61.7172401 26.754298,99.6790423 0.824939051,108.186742 Z M1.34304326,108.181747 C29.613352,107.814217 58.1805158,91.9297101 58.1805151,75.5906019 C51.4386888,75.5906018 47.9457839,73.0599394 45.9513275,69.8149659 C33.880418,64.7217657 23.8678719,103.061726 1.34301955,108.181748 Z\&quot;&gt;&lt;/path&gt;\n            &lt;path d=\&quot;M48.871084,61.6312522 C45.6348746,64.6233738 52.4243955,73.581882 57.1020034,69.8621716 C65.3329228,61.631253 108.502656,20.4006304 116.733576,12.169711 C124.964495,3.9387916 116.733576,-4.29212771 108.502656,3.9387916 C100.271737,12.1697108 57.4180113,53.7289683 48.871084,61.6312522 Z\&quot;&gt;&lt;/path&gt;\n        &lt;/g&gt;\n        &lt;path d=\&quot;M62.2824054,71.6211067 C57.93733,66.8541323 54.3123948,62.6301561 51.9937779,59.5814279 C41.5433616,45.8402704 36.2721798,53.0755512 30.307554,59.5814276 C24.3429282,66.0873041 31.8788571,71.3587209 26.2181932,75.9543964 C20.5575294,80.5500719 20.9070004,82.1430826 11.3532982,73.7355757 C1.79959591,65.3280689 1.13881905,63.0132479 5.52449152,58.2159872 C9.91016399,53.4187265 13.5756887,60.9722938 22.5346144,52.4469667 C31.4935401,43.9216395 23.9676854,36.3658236 23.9676854,36.3658236 C23.9676854,36.3658236 42.6210998,-1.76571499 67.5465342,1.05058165 C92.4719685,3.8668783 58.1171911,-2.5961653 49.5716499,27.3088291 C45.9128772,40.1126497 50.2525733,37.0956468 57.1903023,42.5036084 C59.4792141,44.2878157 67.5103988,50.0176866 77.2457031,57.2905766 C71.4143155,62.9019825 66.2337717,67.8661661 62.2824054,71.6211067 Z M73.4870997,83.4678852 C87.4278174,97.7290403 103.323635,112.360587 109.285731,114.539289 C119.139459,118.140092 123.820369,111.571999 123.820368,100.570289 C123.820367,94.7414103 107.064445,80.3074425 90.2759123,67.2185217 C83.6390655,73.6178 77.7700759,79.2918373 73.4870997,83.4678852 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/unlocked-padlock&quot;: {
            &quot;title&quot;: &quot;$:/core/images/unlocked-padlock&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-unlocked-padlock tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M48.6266053,64 L105,64 L105,96.0097716 C105,113.673909 90.6736461,128 73.001193,128 L55.998807,128 C38.3179793,128 24,113.677487 24,96.0097716 L24,64 L30.136303,64 C19.6806213,51.3490406 2.77158986,28.2115132 25.8366966,8.85759246 C50.4723026,-11.8141335 71.6711028,13.2108337 81.613302,25.0594855 C91.5555012,36.9081373 78.9368488,47.4964439 69.1559674,34.9513593 C59.375086,22.4062748 47.9893192,10.8049522 35.9485154,20.9083862 C23.9077117,31.0118202 34.192312,43.2685325 44.7624679,55.8655518 C47.229397,58.805523 48.403443,61.5979188 48.6266053,64 Z M67.7315279,92.3641717 C70.8232551,91.0923621 73,88.0503841 73,84.5 C73,79.8055796 69.1944204,76 64.5,76 C59.8055796,76 56,79.8055796 56,84.5 C56,87.947435 58.0523387,90.9155206 61.0018621,92.2491029 L55.9067479,115.020857 L72.8008958,115.020857 L67.7315279,92.3641717 L67.7315279,92.3641717 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/core/images/video&quot;: {
            &quot;title&quot;: &quot;$:/core/images/video&quot;,
            &quot;tags&quot;: &quot;$:/tags/Image&quot;,
            &quot;text&quot;: &quot;&lt;svg class=\&quot;tc-image-video tc-image-button\&quot; width=\&quot;22pt\&quot; height=\&quot;22pt\&quot; viewBox=\&quot;0 0 128 128\&quot;&gt;\n    &lt;g fill-rule=\&quot;evenodd\&quot;&gt;\n        &lt;path d=\&quot;M64,12 C29.0909091,12 8.72727273,14.9166667 5.81818182,17.8333333 C2.90909091,20.75 1.93784382e-15,41.1666667 0,64.5 C1.93784382e-15,87.8333333 2.90909091,108.25 5.81818182,111.166667 C8.72727273,114.083333 29.0909091,117 64,117 C98.9090909,117 119.272727,114.083333 122.181818,111.166667 C125.090909,108.25 128,87.8333333 128,64.5 C128,41.1666667 125.090909,20.75 122.181818,17.8333333 C119.272727,14.9166667 98.9090909,12 64,12 Z M54.9161194,44.6182253 C51.102648,42.0759111 48.0112186,43.7391738 48.0112186,48.3159447 L48.0112186,79.6840553 C48.0112186,84.2685636 51.109784,85.9193316 54.9161194,83.3817747 L77.0838806,68.6032672 C80.897352,66.0609529 80.890216,61.9342897 77.0838806,59.3967328 L54.9161194,44.6182253 Z\&quot;&gt;&lt;/path&gt;\n    &lt;/g&gt;\n&lt;/svg&gt;&quot;
        },
        &quot;$:/language/Buttons/AdvancedSearch/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/AdvancedSearch/Caption&quot;,
            &quot;text&quot;: &quot;advanced search&quot;
        },
        &quot;$:/language/Buttons/AdvancedSearch/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/AdvancedSearch/Hint&quot;,
            &quot;text&quot;: &quot;Advanced search&quot;
        },
        &quot;$:/language/Buttons/Cancel/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Cancel/Caption&quot;,
            &quot;text&quot;: &quot;cancel&quot;
        },
        &quot;$:/language/Buttons/Cancel/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Cancel/Hint&quot;,
            &quot;text&quot;: &quot;Cancel editing this tiddler&quot;
        },
        &quot;$:/language/Buttons/Clone/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Clone/Caption&quot;,
            &quot;text&quot;: &quot;clone&quot;
        },
        &quot;$:/language/Buttons/Clone/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Clone/Hint&quot;,
            &quot;text&quot;: &quot;Clone this tiddler&quot;
        },
        &quot;$:/language/Buttons/Close/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Close/Caption&quot;,
            &quot;text&quot;: &quot;close&quot;
        },
        &quot;$:/language/Buttons/Close/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Close/Hint&quot;,
            &quot;text&quot;: &quot;Close this tiddler&quot;
        },
        &quot;$:/language/Buttons/CloseAll/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/CloseAll/Caption&quot;,
            &quot;text&quot;: &quot;close all&quot;
        },
        &quot;$:/language/Buttons/CloseAll/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/CloseAll/Hint&quot;,
            &quot;text&quot;: &quot;Close all tiddlers&quot;
        },
        &quot;$:/language/Buttons/CloseOthers/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/CloseOthers/Caption&quot;,
            &quot;text&quot;: &quot;close others&quot;
        },
        &quot;$:/language/Buttons/CloseOthers/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/CloseOthers/Hint&quot;,
            &quot;text&quot;: &quot;Close other tiddlers&quot;
        },
        &quot;$:/language/Buttons/ControlPanel/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ControlPanel/Caption&quot;,
            &quot;text&quot;: &quot;control panel&quot;
        },
        &quot;$:/language/Buttons/ControlPanel/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ControlPanel/Hint&quot;,
            &quot;text&quot;: &quot;Open control panel&quot;
        },
        &quot;$:/language/Buttons/Delete/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Delete/Caption&quot;,
            &quot;text&quot;: &quot;delete&quot;
        },
        &quot;$:/language/Buttons/Delete/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Delete/Hint&quot;,
            &quot;text&quot;: &quot;Delete this tiddler&quot;
        },
        &quot;$:/language/Buttons/Edit/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Edit/Caption&quot;,
            &quot;text&quot;: &quot;edit&quot;
        },
        &quot;$:/language/Buttons/Edit/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Edit/Hint&quot;,
            &quot;text&quot;: &quot;Edit this tiddler&quot;
        },
        &quot;$:/language/Buttons/Encryption/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Encryption/Caption&quot;,
            &quot;text&quot;: &quot;encryption&quot;
        },
        &quot;$:/language/Buttons/Encryption/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Encryption/Hint&quot;,
            &quot;text&quot;: &quot;Set or clear a password for saving this wiki&quot;
        },
        &quot;$:/language/Buttons/Encryption/ClearPassword/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Encryption/ClearPassword/Caption&quot;,
            &quot;text&quot;: &quot;clear password&quot;
        },
        &quot;$:/language/Buttons/Encryption/ClearPassword/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Encryption/ClearPassword/Hint&quot;,
            &quot;text&quot;: &quot;Clear the password and save this wiki without encryption&quot;
        },
        &quot;$:/language/Buttons/Encryption/SetPassword/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Encryption/SetPassword/Caption&quot;,
            &quot;text&quot;: &quot;set password&quot;
        },
        &quot;$:/language/Buttons/Encryption/SetPassword/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Encryption/SetPassword/Hint&quot;,
            &quot;text&quot;: &quot;Set a password for saving this wiki with encryption&quot;
        },
        &quot;$:/language/Buttons/ExportPage/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ExportPage/Caption&quot;,
            &quot;text&quot;: &quot;export all&quot;
        },
        &quot;$:/language/Buttons/ExportPage/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ExportPage/Hint&quot;,
            &quot;text&quot;: &quot;Export all tiddlers&quot;
        },
        &quot;$:/language/Buttons/ExportTiddler/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ExportTiddler/Caption&quot;,
            &quot;text&quot;: &quot;export tiddler&quot;
        },
        &quot;$:/language/Buttons/ExportTiddler/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ExportTiddler/Hint&quot;,
            &quot;text&quot;: &quot;Export tiddler&quot;
        },
        &quot;$:/language/Buttons/ExportTiddlers/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ExportTiddlers/Caption&quot;,
            &quot;text&quot;: &quot;export tiddlers&quot;
        },
        &quot;$:/language/Buttons/ExportTiddlers/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ExportTiddlers/Hint&quot;,
            &quot;text&quot;: &quot;Export tiddlers&quot;
        },
        &quot;$:/language/Buttons/FullScreen/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/FullScreen/Caption&quot;,
            &quot;text&quot;: &quot;full-screen&quot;
        },
        &quot;$:/language/Buttons/FullScreen/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/FullScreen/Hint&quot;,
            &quot;text&quot;: &quot;Enter or leave full-screen mode&quot;
        },
        &quot;$:/language/Buttons/Import/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Import/Caption&quot;,
            &quot;text&quot;: &quot;import&quot;
        },
        &quot;$:/language/Buttons/Import/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Import/Hint&quot;,
            &quot;text&quot;: &quot;Import files&quot;
        },
        &quot;$:/language/Buttons/Info/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Info/Caption&quot;,
            &quot;text&quot;: &quot;info&quot;
        },
        &quot;$:/language/Buttons/Info/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Info/Hint&quot;,
            &quot;text&quot;: &quot;Show information for this tiddler&quot;
        },
        &quot;$:/language/Buttons/Home/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Home/Caption&quot;,
            &quot;text&quot;: &quot;home&quot;
        },
        &quot;$:/language/Buttons/Home/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Home/Hint&quot;,
            &quot;text&quot;: &quot;Open the default tiddlers&quot;
        },
        &quot;$:/language/Buttons/Language/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Language/Caption&quot;,
            &quot;text&quot;: &quot;language&quot;
        },
        &quot;$:/language/Buttons/Language/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Language/Hint&quot;,
            &quot;text&quot;: &quot;Choose the user interface language&quot;
        },
        &quot;$:/language/Buttons/More/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/More/Caption&quot;,
            &quot;text&quot;: &quot;more&quot;
        },
        &quot;$:/language/Buttons/More/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/More/Hint&quot;,
            &quot;text&quot;: &quot;More actions&quot;
        },
        &quot;$:/language/Buttons/NewHere/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/NewHere/Caption&quot;,
            &quot;text&quot;: &quot;new here&quot;
        },
        &quot;$:/language/Buttons/NewHere/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/NewHere/Hint&quot;,
            &quot;text&quot;: &quot;Create a new tiddler tagged with this one&quot;
        },
        &quot;$:/language/Buttons/NewJournal/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/NewJournal/Caption&quot;,
            &quot;text&quot;: &quot;new journal&quot;
        },
        &quot;$:/language/Buttons/NewJournal/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/NewJournal/Hint&quot;,
            &quot;text&quot;: &quot;Create a new journal tiddler&quot;
        },
        &quot;$:/language/Buttons/NewJournalHere/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/NewJournalHere/Caption&quot;,
            &quot;text&quot;: &quot;new journal here&quot;
        },
        &quot;$:/language/Buttons/NewJournalHere/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/NewJournalHere/Hint&quot;,
            &quot;text&quot;: &quot;Create a new journal tiddler tagged with this one&quot;
        },
        &quot;$:/language/Buttons/NewTiddler/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/NewTiddler/Caption&quot;,
            &quot;text&quot;: &quot;new tiddler&quot;
        },
        &quot;$:/language/Buttons/NewTiddler/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/NewTiddler/Hint&quot;,
            &quot;text&quot;: &quot;Create a new tiddler&quot;
        },
        &quot;$:/language/Buttons/Permalink/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Permalink/Caption&quot;,
            &quot;text&quot;: &quot;permalink&quot;
        },
        &quot;$:/language/Buttons/Permalink/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Permalink/Hint&quot;,
            &quot;text&quot;: &quot;Set browser address bar to a direct link to this tiddler&quot;
        },
        &quot;$:/language/Buttons/Permaview/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Permaview/Caption&quot;,
            &quot;text&quot;: &quot;permaview&quot;
        },
        &quot;$:/language/Buttons/Permaview/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Permaview/Hint&quot;,
            &quot;text&quot;: &quot;Set browser address bar to a direct link to all the tiddlers in this story&quot;
        },
        &quot;$:/language/Buttons/Refresh/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Refresh/Caption&quot;,
            &quot;text&quot;: &quot;refresh&quot;
        },
        &quot;$:/language/Buttons/Refresh/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Refresh/Hint&quot;,
            &quot;text&quot;: &quot;Perform a full refresh of the wiki&quot;
        },
        &quot;$:/language/Buttons/Save/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Save/Caption&quot;,
            &quot;text&quot;: &quot;save&quot;
        },
        &quot;$:/language/Buttons/Save/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Save/Hint&quot;,
            &quot;text&quot;: &quot;Save this tiddler&quot;
        },
        &quot;$:/language/Buttons/SaveWiki/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/SaveWiki/Caption&quot;,
            &quot;text&quot;: &quot;save changes&quot;
        },
        &quot;$:/language/Buttons/SaveWiki/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/SaveWiki/Hint&quot;,
            &quot;text&quot;: &quot;Save changes&quot;
        },
        &quot;$:/language/Buttons/StoryView/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/StoryView/Caption&quot;,
            &quot;text&quot;: &quot;storyview&quot;
        },
        &quot;$:/language/Buttons/StoryView/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/StoryView/Hint&quot;,
            &quot;text&quot;: &quot;Choose the story visualisation&quot;
        },
        &quot;$:/language/Buttons/HideSideBar/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/HideSideBar/Caption&quot;,
            &quot;text&quot;: &quot;hide sidebar&quot;
        },
        &quot;$:/language/Buttons/HideSideBar/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/HideSideBar/Hint&quot;,
            &quot;text&quot;: &quot;Hide sidebar&quot;
        },
        &quot;$:/language/Buttons/ShowSideBar/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ShowSideBar/Caption&quot;,
            &quot;text&quot;: &quot;show sidebar&quot;
        },
        &quot;$:/language/Buttons/ShowSideBar/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/ShowSideBar/Hint&quot;,
            &quot;text&quot;: &quot;Show sidebar&quot;
        },
        &quot;$:/language/Buttons/TagManager/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/TagManager/Caption&quot;,
            &quot;text&quot;: &quot;tag manager&quot;
        },
        &quot;$:/language/Buttons/TagManager/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/TagManager/Hint&quot;,
            &quot;text&quot;: &quot;Open tag manager&quot;
        },
        &quot;$:/language/Buttons/Theme/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Theme/Caption&quot;,
            &quot;text&quot;: &quot;theme&quot;
        },
        &quot;$:/language/Buttons/Theme/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Buttons/Theme/Hint&quot;,
            &quot;text&quot;: &quot;Choose the display theme&quot;
        },
        &quot;$:/language/ControlPanel/Advanced/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Advanced/Caption&quot;,
            &quot;text&quot;: &quot;Advanced&quot;
        },
        &quot;$:/language/ControlPanel/Advanced/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Advanced/Hint&quot;,
            &quot;text&quot;: &quot;Internal information about this TiddlyWiki&quot;
        },
        &quot;$:/language/ControlPanel/Appearance/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Appearance/Caption&quot;,
            &quot;text&quot;: &quot;Appearance&quot;
        },
        &quot;$:/language/ControlPanel/Appearance/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Appearance/Hint&quot;,
            &quot;text&quot;: &quot;Ways to customise the appearance of your TiddlyWiki.&quot;
        },
        &quot;$:/language/ControlPanel/Basics/AnimDuration/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/AnimDuration/Prompt&quot;,
            &quot;text&quot;: &quot;Animation duration:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/Caption&quot;,
            &quot;text&quot;: &quot;Basics&quot;
        },
        &quot;$:/language/ControlPanel/Basics/DefaultTiddlers/BottomHint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/DefaultTiddlers/BottomHint&quot;,
            &quot;text&quot;: &quot;Use &amp;#91;&amp;#91;double square brackets&amp;#93;&amp;#93; for titles with spaces. Or you can choose to &lt;$button set=\&quot;$:/DefaultTiddlers\&quot; setTo=\&quot;[list[$:/StoryList]]\&quot;&gt;retain story ordering&lt;/$button&gt;&quot;
        },
        &quot;$:/language/ControlPanel/Basics/DefaultTiddlers/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/DefaultTiddlers/Prompt&quot;,
            &quot;text&quot;: &quot;Default tiddlers:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/DefaultTiddlers/TopHint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/DefaultTiddlers/TopHint&quot;,
            &quot;text&quot;: &quot;Choose which tiddlers are displayed at startup:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/Language/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/Language/Prompt&quot;,
            &quot;text&quot;: &quot;Hello! Current language:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/NewJournal/Title/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/NewJournal/Title/Prompt&quot;,
            &quot;text&quot;: &quot;Title of new journal tiddlers&quot;
        },
        &quot;$:/language/ControlPanel/Basics/NewJournal/Tags/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/NewJournal/Tags/Prompt&quot;,
            &quot;text&quot;: &quot;Tags for new journal tiddlers&quot;
        },
        &quot;$:/language/ControlPanel/Basics/OverriddenShadowTiddlers/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/OverriddenShadowTiddlers/Prompt&quot;,
            &quot;text&quot;: &quot;Number of overridden shadow tiddlers:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/ShadowTiddlers/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/ShadowTiddlers/Prompt&quot;,
            &quot;text&quot;: &quot;Number of shadow tiddlers:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/Subtitle/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/Subtitle/Prompt&quot;,
            &quot;text&quot;: &quot;Subtitle:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/SystemTiddlers/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/SystemTiddlers/Prompt&quot;,
            &quot;text&quot;: &quot;Number of system tiddlers:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/Tags/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/Tags/Prompt&quot;,
            &quot;text&quot;: &quot;Number of tags:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/Tiddlers/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/Tiddlers/Prompt&quot;,
            &quot;text&quot;: &quot;Number of tiddlers:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/Title/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/Title/Prompt&quot;,
            &quot;text&quot;: &quot;Title of this ~TiddlyWiki:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/Username/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/Username/Prompt&quot;,
            &quot;text&quot;: &quot;Username for signing edits:&quot;
        },
        &quot;$:/language/ControlPanel/Basics/Version/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Basics/Version/Prompt&quot;,
            &quot;text&quot;: &quot;~TiddlyWiki version:&quot;
        },
        &quot;$:/language/ControlPanel/EditorTypes/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/EditorTypes/Caption&quot;,
            &quot;text&quot;: &quot;Editor Types&quot;
        },
        &quot;$:/language/ControlPanel/EditorTypes/Editor/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/EditorTypes/Editor/Caption&quot;,
            &quot;text&quot;: &quot;Editor&quot;
        },
        &quot;$:/language/ControlPanel/EditorTypes/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/EditorTypes/Hint&quot;,
            &quot;text&quot;: &quot;These tiddlers determine which editor is used to edit specific tiddler types.&quot;
        },
        &quot;$:/language/ControlPanel/EditorTypes/Type/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/EditorTypes/Type/Caption&quot;,
            &quot;text&quot;: &quot;Type&quot;
        },
        &quot;$:/language/ControlPanel/Info/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Info/Caption&quot;,
            &quot;text&quot;: &quot;Info&quot;
        },
        &quot;$:/language/ControlPanel/Info/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Info/Hint&quot;,
            &quot;text&quot;: &quot;Information about this TiddlyWiki&quot;
        },
        &quot;$:/language/ControlPanel/LoadedModules/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/LoadedModules/Caption&quot;,
            &quot;text&quot;: &quot;Loaded Modules&quot;
        },
        &quot;$:/language/ControlPanel/LoadedModules/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/LoadedModules/Hint&quot;,
            &quot;text&quot;: &quot;These are the currently loaded tiddler modules linked to their source tiddlers. Any italicised modules lack a source tiddler, typically because they were setup during the boot process.&quot;
        },
        &quot;$:/language/ControlPanel/Palette/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Palette/Caption&quot;,
            &quot;text&quot;: &quot;Palette&quot;
        },
        &quot;$:/language/ControlPanel/Palette/Editor/Clone/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Palette/Editor/Clone/Caption&quot;,
            &quot;text&quot;: &quot;clone&quot;
        },
        &quot;$:/language/ControlPanel/Palette/Editor/Clone/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Palette/Editor/Clone/Prompt&quot;,
            &quot;text&quot;: &quot;It is recommended that you clone this shadow palette before editing it&quot;
        },
        &quot;$:/language/ControlPanel/Palette/Editor/Prompt/Modified&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Palette/Editor/Prompt/Modified&quot;,
            &quot;text&quot;: &quot;This shadow palette has been modified&quot;
        },
        &quot;$:/language/ControlPanel/Palette/Editor/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Palette/Editor/Prompt&quot;,
            &quot;text&quot;: &quot;Editing&quot;
        },
        &quot;$:/language/ControlPanel/Palette/Editor/Reset/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Palette/Editor/Reset/Caption&quot;,
            &quot;text&quot;: &quot;reset&quot;
        },
        &quot;$:/language/ControlPanel/Palette/HideEditor/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Palette/HideEditor/Caption&quot;,
            &quot;text&quot;: &quot;hide editor&quot;
        },
        &quot;$:/language/ControlPanel/Palette/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Palette/Prompt&quot;,
            &quot;text&quot;: &quot;Current palette:&quot;
        },
        &quot;$:/language/ControlPanel/Palette/ShowEditor/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Palette/ShowEditor/Caption&quot;,
            &quot;text&quot;: &quot;show editor&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Caption&quot;,
            &quot;text&quot;: &quot;Plugins&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Disable/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Disable/Caption&quot;,
            &quot;text&quot;: &quot;disable&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Disable/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Disable/Hint&quot;,
            &quot;text&quot;: &quot;Disable this plugin when reloading page&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Disabled/Status&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Disabled/Status&quot;,
            &quot;text&quot;: &quot;(disabled)&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Empty/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Empty/Hint&quot;,
            &quot;text&quot;: &quot;None&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Enable/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Enable/Caption&quot;,
            &quot;text&quot;: &quot;enable&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Enable/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Enable/Hint&quot;,
            &quot;text&quot;: &quot;Enable this plugin when reloading page&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Language/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Language/Prompt&quot;,
            &quot;text&quot;: &quot;Languages&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Plugin/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Plugin/Prompt&quot;,
            &quot;text&quot;: &quot;Plugins&quot;
        },
        &quot;$:/language/ControlPanel/Plugins/Theme/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Plugins/Theme/Prompt&quot;,
            &quot;text&quot;: &quot;Themes&quot;
        },
        &quot;$:/language/ControlPanel/Saving/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/Caption&quot;,
            &quot;text&quot;: &quot;Saving&quot;
        },
        &quot;$:/language/ControlPanel/Saving/Heading&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/Heading&quot;,
            &quot;text&quot;: &quot;Saving&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/Advanced/Heading&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/Advanced/Heading&quot;,
            &quot;text&quot;: &quot;Advanced Settings&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/BackupDir&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/BackupDir&quot;,
            &quot;text&quot;: &quot;Backup Directory&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/Backups&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/Backups&quot;,
            &quot;text&quot;: &quot;Backups&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/Description&quot;,
            &quot;text&quot;: &quot;These settings are only used when saving to http://tiddlyspot.com or a compatible remote server&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/Filename&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/Filename&quot;,
            &quot;text&quot;: &quot;Upload Filename&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/Heading&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/Heading&quot;,
            &quot;text&quot;: &quot;~TiddlySpot&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/Hint&quot;,
            &quot;text&quot;: &quot;//The server URL defaults to `http://&lt;wikiname&gt;.tiddlyspot.com/store.cgi` and can be changed to use a custom server address//&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/Password&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/Password&quot;,
            &quot;text&quot;: &quot;Password&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/ServerURL&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/ServerURL&quot;,
            &quot;text&quot;: &quot;Server URL&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/UploadDir&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/UploadDir&quot;,
            &quot;text&quot;: &quot;Upload Directory&quot;
        },
        &quot;$:/language/ControlPanel/Saving/TiddlySpot/UserName&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Saving/TiddlySpot/UserName&quot;,
            &quot;text&quot;: &quot;Wiki Name&quot;
        },
        &quot;$:/language/ControlPanel/Settings/AutoSave/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/AutoSave/Caption&quot;,
            &quot;text&quot;: &quot;Autosave&quot;
        },
        &quot;$:/language/ControlPanel/Settings/AutoSave/Disabled/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/AutoSave/Disabled/Description&quot;,
            &quot;text&quot;: &quot;Do not save changes automatically&quot;
        },
        &quot;$:/language/ControlPanel/Settings/AutoSave/Enabled/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/AutoSave/Enabled/Description&quot;,
            &quot;text&quot;: &quot;Save changes automatically&quot;
        },
        &quot;$:/language/ControlPanel/Settings/AutoSave/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/AutoSave/Hint&quot;,
            &quot;text&quot;: &quot;Automatically save changes during editing&quot;
        },
        &quot;$:/language/ControlPanel/Settings/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/Caption&quot;,
            &quot;text&quot;: &quot;Settings&quot;
        },
        &quot;$:/language/ControlPanel/Settings/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/Hint&quot;,
            &quot;text&quot;: &quot;These settings let you customise the behaviour of TiddlyWiki.&quot;
        },
        &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/Caption&quot;,
            &quot;text&quot;: &quot;Navigation Address Bar&quot;
        },
        &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/Hint&quot;,
            &quot;text&quot;: &quot;Behaviour of the browser address bar when navigating to a tiddler:&quot;
        },
        &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/No/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/No/Description&quot;,
            &quot;text&quot;: &quot;Do not update the address bar&quot;
        },
        &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/Permalink/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/Permalink/Description&quot;,
            &quot;text&quot;: &quot;Include the target tiddler&quot;
        },
        &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/Permaview/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/NavigationAddressBar/Permaview/Description&quot;,
            &quot;text&quot;: &quot;Include the target tiddler and the current story sequence&quot;
        },
        &quot;$:/language/ControlPanel/Settings/NavigationHistory/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/NavigationHistory/Caption&quot;,
            &quot;text&quot;: &quot;Navigation History&quot;
        },
        &quot;$:/language/ControlPanel/Settings/NavigationHistory/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/NavigationHistory/Hint&quot;,
            &quot;text&quot;: &quot;Update browser history when navigating to a tiddler:&quot;
        },
        &quot;$:/language/ControlPanel/Settings/NavigationHistory/No/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/NavigationHistory/No/Description&quot;,
            &quot;text&quot;: &quot;Do not update history&quot;
        },
        &quot;$:/language/ControlPanel/Settings/NavigationHistory/Yes/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/NavigationHistory/Yes/Description&quot;,
            &quot;text&quot;: &quot;Update history&quot;
        },
        &quot;$:/language/ControlPanel/Settings/ToolbarButtons/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/ToolbarButtons/Caption&quot;,
            &quot;text&quot;: &quot;Toolbar Buttons&quot;
        },
        &quot;$:/language/ControlPanel/Settings/ToolbarButtons/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/ToolbarButtons/Hint&quot;,
            &quot;text&quot;: &quot;Default toolbar button appearance:&quot;
        },
        &quot;$:/language/ControlPanel/Settings/ToolbarButtons/Icons/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/ToolbarButtons/Icons/Description&quot;,
            &quot;text&quot;: &quot;Include icon&quot;
        },
        &quot;$:/language/ControlPanel/Settings/ToolbarButtons/Text/Description&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Settings/ToolbarButtons/Text/Description&quot;,
            &quot;text&quot;: &quot;Include text&quot;
        },
        &quot;$:/language/ControlPanel/StoryView/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/StoryView/Caption&quot;,
            &quot;text&quot;: &quot;Story View&quot;
        },
        &quot;$:/language/ControlPanel/StoryView/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/StoryView/Prompt&quot;,
            &quot;text&quot;: &quot;Current view:&quot;
        },
        &quot;$:/language/ControlPanel/Theme/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Theme/Caption&quot;,
            &quot;text&quot;: &quot;Theme&quot;
        },
        &quot;$:/language/ControlPanel/Theme/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Theme/Prompt&quot;,
            &quot;text&quot;: &quot;Current theme:&quot;
        },
        &quot;$:/language/ControlPanel/TiddlerFields/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/TiddlerFields/Caption&quot;,
            &quot;text&quot;: &quot;Tiddler Fields&quot;
        },
        &quot;$:/language/ControlPanel/TiddlerFields/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/TiddlerFields/Hint&quot;,
            &quot;text&quot;: &quot;This is the full set of TiddlerFields in use in this wiki (including system tiddlers but excluding shadow tiddlers).&quot;
        },
        &quot;$:/language/ControlPanel/Toolbars/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Toolbars/Caption&quot;,
            &quot;text&quot;: &quot;Toolbars&quot;
        },
        &quot;$:/language/ControlPanel/Toolbars/EditToolbar/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Toolbars/EditToolbar/Caption&quot;,
            &quot;text&quot;: &quot;Edit Toolbar&quot;
        },
        &quot;$:/language/ControlPanel/Toolbars/EditToolbar/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Toolbars/EditToolbar/Hint&quot;,
            &quot;text&quot;: &quot;Choose which buttons are displayed for tiddlers in edit mode&quot;
        },
        &quot;$:/language/ControlPanel/Toolbars/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Toolbars/Hint&quot;,
            &quot;text&quot;: &quot;Select which toolbar buttons are displayed&quot;
        },
        &quot;$:/language/ControlPanel/Toolbars/PageControls/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Toolbars/PageControls/Caption&quot;,
            &quot;text&quot;: &quot;Page Toolbar&quot;
        },
        &quot;$:/language/ControlPanel/Toolbars/PageControls/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Toolbars/PageControls/Hint&quot;,
            &quot;text&quot;: &quot;Choose which buttons are displayed on the main page toolbar  &quot;
        },
        &quot;$:/language/ControlPanel/Toolbars/ViewToolbar/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Toolbars/ViewToolbar/Caption&quot;,
            &quot;text&quot;: &quot;View Toolbar&quot;
        },
        &quot;$:/language/ControlPanel/Toolbars/ViewToolbar/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Toolbars/ViewToolbar/Hint&quot;,
            &quot;text&quot;: &quot;Choose which buttons are displayed for tiddlers in view mode&quot;
        },
        &quot;$:/language/ControlPanel/Tools/Download/Full/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ControlPanel/Tools/Download/Full/Caption&quot;,
            &quot;text&quot;: &quot;Download full wiki&quot;
        },
        &quot;$:/language/Date/DaySuffix/1&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/1&quot;,
            &quot;text&quot;: &quot;st&quot;
        },
        &quot;$:/language/Date/DaySuffix/2&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/2&quot;,
            &quot;text&quot;: &quot;nd&quot;
        },
        &quot;$:/language/Date/DaySuffix/3&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/3&quot;,
            &quot;text&quot;: &quot;rd&quot;
        },
        &quot;$:/language/Date/DaySuffix/4&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/4&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/5&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/5&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/6&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/6&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/7&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/7&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/8&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/8&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/9&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/9&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/10&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/10&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/11&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/11&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/12&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/12&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/13&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/13&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/14&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/14&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/15&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/15&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/16&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/16&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/17&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/17&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/18&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/18&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/19&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/19&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/20&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/20&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/21&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/21&quot;,
            &quot;text&quot;: &quot;st&quot;
        },
        &quot;$:/language/Date/DaySuffix/22&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/22&quot;,
            &quot;text&quot;: &quot;nd&quot;
        },
        &quot;$:/language/Date/DaySuffix/23&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/23&quot;,
            &quot;text&quot;: &quot;rd&quot;
        },
        &quot;$:/language/Date/DaySuffix/24&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/24&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/25&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/25&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/26&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/26&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/27&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/27&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/28&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/28&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/29&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/29&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/30&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/30&quot;,
            &quot;text&quot;: &quot;th&quot;
        },
        &quot;$:/language/Date/DaySuffix/31&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/DaySuffix/31&quot;,
            &quot;text&quot;: &quot;st&quot;
        },
        &quot;$:/language/Date/Long/Day/0&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Day/0&quot;,
            &quot;text&quot;: &quot;Sunday&quot;
        },
        &quot;$:/language/Date/Long/Day/1&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Day/1&quot;,
            &quot;text&quot;: &quot;Monday&quot;
        },
        &quot;$:/language/Date/Long/Day/2&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Day/2&quot;,
            &quot;text&quot;: &quot;Tuesday&quot;
        },
        &quot;$:/language/Date/Long/Day/3&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Day/3&quot;,
            &quot;text&quot;: &quot;Wednesday&quot;
        },
        &quot;$:/language/Date/Long/Day/4&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Day/4&quot;,
            &quot;text&quot;: &quot;Thursday&quot;
        },
        &quot;$:/language/Date/Long/Day/5&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Day/5&quot;,
            &quot;text&quot;: &quot;Friday&quot;
        },
        &quot;$:/language/Date/Long/Day/6&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Day/6&quot;,
            &quot;text&quot;: &quot;Saturday&quot;
        },
        &quot;$:/language/Date/Long/Month/1&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/1&quot;,
            &quot;text&quot;: &quot;January&quot;
        },
        &quot;$:/language/Date/Long/Month/2&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/2&quot;,
            &quot;text&quot;: &quot;February&quot;
        },
        &quot;$:/language/Date/Long/Month/3&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/3&quot;,
            &quot;text&quot;: &quot;March&quot;
        },
        &quot;$:/language/Date/Long/Month/4&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/4&quot;,
            &quot;text&quot;: &quot;April&quot;
        },
        &quot;$:/language/Date/Long/Month/5&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/5&quot;,
            &quot;text&quot;: &quot;May&quot;
        },
        &quot;$:/language/Date/Long/Month/6&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/6&quot;,
            &quot;text&quot;: &quot;June&quot;
        },
        &quot;$:/language/Date/Long/Month/7&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/7&quot;,
            &quot;text&quot;: &quot;July&quot;
        },
        &quot;$:/language/Date/Long/Month/8&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/8&quot;,
            &quot;text&quot;: &quot;August&quot;
        },
        &quot;$:/language/Date/Long/Month/9&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/9&quot;,
            &quot;text&quot;: &quot;September&quot;
        },
        &quot;$:/language/Date/Long/Month/10&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/10&quot;,
            &quot;text&quot;: &quot;October&quot;
        },
        &quot;$:/language/Date/Long/Month/11&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/11&quot;,
            &quot;text&quot;: &quot;November&quot;
        },
        &quot;$:/language/Date/Long/Month/12&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Long/Month/12&quot;,
            &quot;text&quot;: &quot;December&quot;
        },
        &quot;$:/language/Date/Period/am&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Period/am&quot;,
            &quot;text&quot;: &quot;am&quot;
        },
        &quot;$:/language/Date/Period/pm&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Period/pm&quot;,
            &quot;text&quot;: &quot;pm&quot;
        },
        &quot;$:/language/Date/Short/Day/0&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Day/0&quot;,
            &quot;text&quot;: &quot;Sun&quot;
        },
        &quot;$:/language/Date/Short/Day/1&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Day/1&quot;,
            &quot;text&quot;: &quot;Mon&quot;
        },
        &quot;$:/language/Date/Short/Day/2&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Day/2&quot;,
            &quot;text&quot;: &quot;Tue&quot;
        },
        &quot;$:/language/Date/Short/Day/3&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Day/3&quot;,
            &quot;text&quot;: &quot;Wed&quot;
        },
        &quot;$:/language/Date/Short/Day/4&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Day/4&quot;,
            &quot;text&quot;: &quot;Thu&quot;
        },
        &quot;$:/language/Date/Short/Day/5&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Day/5&quot;,
            &quot;text&quot;: &quot;Fri&quot;
        },
        &quot;$:/language/Date/Short/Day/6&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Day/6&quot;,
            &quot;text&quot;: &quot;Sat&quot;
        },
        &quot;$:/language/Date/Short/Month/1&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/1&quot;,
            &quot;text&quot;: &quot;Jan&quot;
        },
        &quot;$:/language/Date/Short/Month/2&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/2&quot;,
            &quot;text&quot;: &quot;Feb&quot;
        },
        &quot;$:/language/Date/Short/Month/3&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/3&quot;,
            &quot;text&quot;: &quot;Mar&quot;
        },
        &quot;$:/language/Date/Short/Month/4&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/4&quot;,
            &quot;text&quot;: &quot;Apr&quot;
        },
        &quot;$:/language/Date/Short/Month/5&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/5&quot;,
            &quot;text&quot;: &quot;May&quot;
        },
        &quot;$:/language/Date/Short/Month/6&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/6&quot;,
            &quot;text&quot;: &quot;Jun&quot;
        },
        &quot;$:/language/Date/Short/Month/7&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/7&quot;,
            &quot;text&quot;: &quot;Jul&quot;
        },
        &quot;$:/language/Date/Short/Month/8&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/8&quot;,
            &quot;text&quot;: &quot;Aug&quot;
        },
        &quot;$:/language/Date/Short/Month/9&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/9&quot;,
            &quot;text&quot;: &quot;Sep&quot;
        },
        &quot;$:/language/Date/Short/Month/10&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/10&quot;,
            &quot;text&quot;: &quot;Oct&quot;
        },
        &quot;$:/language/Date/Short/Month/11&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/11&quot;,
            &quot;text&quot;: &quot;Nov&quot;
        },
        &quot;$:/language/Date/Short/Month/12&quot;: {
            &quot;title&quot;: &quot;$:/language/Date/Short/Month/12&quot;,
            &quot;text&quot;: &quot;Dec&quot;
        },
        &quot;$:/language/RelativeDate/Future/Days&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Future/Days&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; days from now&quot;
        },
        &quot;$:/language/RelativeDate/Future/Hours&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Future/Hours&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; hours from now&quot;
        },
        &quot;$:/language/RelativeDate/Future/Minutes&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Future/Minutes&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; minutes from now&quot;
        },
        &quot;$:/language/RelativeDate/Future/Months&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Future/Months&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; months from now&quot;
        },
        &quot;$:/language/RelativeDate/Future/Second&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Future/Second&quot;,
            &quot;text&quot;: &quot;1 second from now&quot;
        },
        &quot;$:/language/RelativeDate/Future/Seconds&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Future/Seconds&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; seconds from now&quot;
        },
        &quot;$:/language/RelativeDate/Future/Years&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Future/Years&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; years from now&quot;
        },
        &quot;$:/language/RelativeDate/Past/Days&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Past/Days&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; days ago&quot;
        },
        &quot;$:/language/RelativeDate/Past/Hours&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Past/Hours&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; hours ago&quot;
        },
        &quot;$:/language/RelativeDate/Past/Minutes&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Past/Minutes&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; minutes ago&quot;
        },
        &quot;$:/language/RelativeDate/Past/Months&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Past/Months&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; months ago&quot;
        },
        &quot;$:/language/RelativeDate/Past/Second&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Past/Second&quot;,
            &quot;text&quot;: &quot;1 second ago&quot;
        },
        &quot;$:/language/RelativeDate/Past/Seconds&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Past/Seconds&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; seconds ago&quot;
        },
        &quot;$:/language/RelativeDate/Past/Years&quot;: {
            &quot;title&quot;: &quot;$:/language/RelativeDate/Past/Years&quot;,
            &quot;text&quot;: &quot;&lt;&lt;period&gt;&gt; years ago&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/animation&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/animation&quot;,
            &quot;text&quot;: &quot;Animations that may be used with the RevealWidget.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/command&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/command&quot;,
            &quot;text&quot;: &quot;Commands that can be executed under Node.js.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/config&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/config&quot;,
            &quot;text&quot;: &quot;Data to be inserted into `$tw.config`.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/filteroperator&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/filteroperator&quot;,
            &quot;text&quot;: &quot;Individual filter operator methods.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/global&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/global&quot;,
            &quot;text&quot;: &quot;Global data to be inserted into `$tw`.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/isfilteroperator&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/isfilteroperator&quot;,
            &quot;text&quot;: &quot;Operands for the ''is'' filter operator.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/macro&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/macro&quot;,
            &quot;text&quot;: &quot;JavaScript macro definitions.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/parser&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/parser&quot;,
            &quot;text&quot;: &quot;Parsers for different content types.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/saver&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/saver&quot;,
            &quot;text&quot;: &quot;Savers handle different methods for saving files from the browser.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/startup&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/startup&quot;,
            &quot;text&quot;: &quot;Startup functions.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/storyview&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/storyview&quot;,
            &quot;text&quot;: &quot;Story views customise the animation and behaviour of list widgets.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/tiddlerdeserializer&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/tiddlerdeserializer&quot;,
            &quot;text&quot;: &quot;Converts different content types into tiddlers.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/tiddlerfield&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/tiddlerfield&quot;,
            &quot;text&quot;: &quot;Defines the behaviour of an individual tiddler field.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/tiddlermethod&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/tiddlermethod&quot;,
            &quot;text&quot;: &quot;Adds methods to the `$tw.Tiddler` prototype.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/upgrader&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/upgrader&quot;,
            &quot;text&quot;: &quot;Applies upgrade processing to tiddlers during an upgrade/import.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/utils&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/utils&quot;,
            &quot;text&quot;: &quot;Adds methods to `$tw.utils`.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/utils-node&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/utils-node&quot;,
            &quot;text&quot;: &quot;Adds Node.js-specific methods to `$tw.utils`.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/widget&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/widget&quot;,
            &quot;text&quot;: &quot;Widgets encapsulate DOM rendering and refreshing.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/wikimethod&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/wikimethod&quot;,
            &quot;text&quot;: &quot;Adds methods to `$tw.Wiki`.&quot;
        },
        &quot;$:/language/Docs/ModuleTypes/wikirule&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/ModuleTypes/wikirule&quot;,
            &quot;text&quot;: &quot;Individual parser rules for the main WikiText parser.&quot;
        },
        &quot;$:/language/Docs/PaletteColours/alert-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/alert-background&quot;,
            &quot;text&quot;: &quot;Alert background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/alert-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/alert-border&quot;,
            &quot;text&quot;: &quot;Alert border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/alert-highlight&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/alert-highlight&quot;,
            &quot;text&quot;: &quot;Alert highlight&quot;
        },
        &quot;$:/language/Docs/PaletteColours/alert-muted-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/alert-muted-foreground&quot;,
            &quot;text&quot;: &quot;Alert muted foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/background&quot;,
            &quot;text&quot;: &quot;General background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/blockquote-bar&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/blockquote-bar&quot;,
            &quot;text&quot;: &quot;Blockquote bar&quot;
        },
        &quot;$:/language/Docs/PaletteColours/dirty-indicator&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/dirty-indicator&quot;,
            &quot;text&quot;: &quot;Unsaved changes indicator&quot;
        },
        &quot;$:/language/Docs/PaletteColours/code-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/code-background&quot;,
            &quot;text&quot;: &quot;Code background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/code-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/code-border&quot;,
            &quot;text&quot;: &quot;Code border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/code-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/code-foreground&quot;,
            &quot;text&quot;: &quot;Code foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/download-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/download-background&quot;,
            &quot;text&quot;: &quot;Download button background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/download-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/download-foreground&quot;,
            &quot;text&quot;: &quot;Download button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/dragger-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/dragger-background&quot;,
            &quot;text&quot;: &quot;Dragger background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/dragger-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/dragger-foreground&quot;,
            &quot;text&quot;: &quot;Dragger foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/dropdown-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/dropdown-background&quot;,
            &quot;text&quot;: &quot;Dropdown background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/dropdown-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/dropdown-border&quot;,
            &quot;text&quot;: &quot;Dropdown border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/dropdown-tab-background-selected&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/dropdown-tab-background-selected&quot;,
            &quot;text&quot;: &quot;Dropdown tab background for selected tabs&quot;
        },
        &quot;$:/language/Docs/PaletteColours/dropdown-tab-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/dropdown-tab-background&quot;,
            &quot;text&quot;: &quot;Dropdown tab background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/dropzone-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/dropzone-background&quot;,
            &quot;text&quot;: &quot;Dropzone background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/external-link-background-hover&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/external-link-background-hover&quot;,
            &quot;text&quot;: &quot;External link background hover&quot;
        },
        &quot;$:/language/Docs/PaletteColours/external-link-background-visited&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/external-link-background-visited&quot;,
            &quot;text&quot;: &quot;External link background visited&quot;
        },
        &quot;$:/language/Docs/PaletteColours/external-link-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/external-link-background&quot;,
            &quot;text&quot;: &quot;External link background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/external-link-foreground-hover&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/external-link-foreground-hover&quot;,
            &quot;text&quot;: &quot;External link foreground hover&quot;
        },
        &quot;$:/language/Docs/PaletteColours/external-link-foreground-visited&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/external-link-foreground-visited&quot;,
            &quot;text&quot;: &quot;External link foreground visited&quot;
        },
        &quot;$:/language/Docs/PaletteColours/external-link-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/external-link-foreground&quot;,
            &quot;text&quot;: &quot;External link foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/foreground&quot;,
            &quot;text&quot;: &quot;General foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/message-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/message-background&quot;,
            &quot;text&quot;: &quot;Message box background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/message-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/message-border&quot;,
            &quot;text&quot;: &quot;Message box border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/message-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/message-foreground&quot;,
            &quot;text&quot;: &quot;Message box foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/modal-backdrop&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/modal-backdrop&quot;,
            &quot;text&quot;: &quot;Modal backdrop&quot;
        },
        &quot;$:/language/Docs/PaletteColours/modal-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/modal-background&quot;,
            &quot;text&quot;: &quot;Modal background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/modal-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/modal-border&quot;,
            &quot;text&quot;: &quot;Modal border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/modal-footer-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/modal-footer-background&quot;,
            &quot;text&quot;: &quot;Modal footer background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/modal-footer-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/modal-footer-border&quot;,
            &quot;text&quot;: &quot;Modal footer border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/modal-header-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/modal-header-border&quot;,
            &quot;text&quot;: &quot;Modal header border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/muted-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/muted-foreground&quot;,
            &quot;text&quot;: &quot;General muted foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/notification-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/notification-background&quot;,
            &quot;text&quot;: &quot;Notification background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/notification-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/notification-border&quot;,
            &quot;text&quot;: &quot;Notification border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/page-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/page-background&quot;,
            &quot;text&quot;: &quot;Page background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/pre-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/pre-background&quot;,
            &quot;text&quot;: &quot;Preformatted code background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/pre-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/pre-border&quot;,
            &quot;text&quot;: &quot;Preformatted code border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/primary&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/primary&quot;,
            &quot;text&quot;: &quot;General primary&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-button-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-button-foreground&quot;,
            &quot;text&quot;: &quot;Sidebar button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-controls-foreground-hover&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-controls-foreground-hover&quot;,
            &quot;text&quot;: &quot;Sidebar controls foreground hover&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-controls-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-controls-foreground&quot;,
            &quot;text&quot;: &quot;Sidebar controls foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-foreground-shadow&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-foreground-shadow&quot;,
            &quot;text&quot;: &quot;Sidebar foreground shadow&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-foreground&quot;,
            &quot;text&quot;: &quot;Sidebar foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-muted-foreground-hover&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-muted-foreground-hover&quot;,
            &quot;text&quot;: &quot;Sidebar muted foreground hover&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-muted-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-muted-foreground&quot;,
            &quot;text&quot;: &quot;Sidebar muted foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-tab-background-selected&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-tab-background-selected&quot;,
            &quot;text&quot;: &quot;Sidebar tab background for selected tabs&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-tab-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-tab-background&quot;,
            &quot;text&quot;: &quot;Sidebar tab background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-tab-border-selected&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-tab-border-selected&quot;,
            &quot;text&quot;: &quot;Sidebar tab border for selected tabs&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-tab-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-tab-border&quot;,
            &quot;text&quot;: &quot;Sidebar tab border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-tab-divider&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-tab-divider&quot;,
            &quot;text&quot;: &quot;Sidebar tab divider&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-tab-foreground-selected&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-tab-foreground-selected&quot;,
            &quot;text&quot;: &quot;Sidebar tab foreground for selected tabs&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-tab-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-tab-foreground&quot;,
            &quot;text&quot;: &quot;Sidebar tab foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-tiddler-link-foreground-hover&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-tiddler-link-foreground-hover&quot;,
            &quot;text&quot;: &quot;Sidebar tiddler link foreground hover&quot;
        },
        &quot;$:/language/Docs/PaletteColours/sidebar-tiddler-link-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/sidebar-tiddler-link-foreground&quot;,
            &quot;text&quot;: &quot;Sidebar tiddler link foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/static-alert-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/static-alert-foreground&quot;,
            &quot;text&quot;: &quot;Static alert foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tab-background-selected&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tab-background-selected&quot;,
            &quot;text&quot;: &quot;Tab background for selected tabs&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tab-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tab-background&quot;,
            &quot;text&quot;: &quot;Tab background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tab-border-selected&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tab-border-selected&quot;,
            &quot;text&quot;: &quot;Tab border for selected tabs&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tab-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tab-border&quot;,
            &quot;text&quot;: &quot;Tab border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tab-divider&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tab-divider&quot;,
            &quot;text&quot;: &quot;Tab divider&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tab-foreground-selected&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tab-foreground-selected&quot;,
            &quot;text&quot;: &quot;Tab foreground for selected tabs&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tab-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tab-foreground&quot;,
            &quot;text&quot;: &quot;Tab foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/table-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/table-border&quot;,
            &quot;text&quot;: &quot;Table border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/table-footer-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/table-footer-background&quot;,
            &quot;text&quot;: &quot;Table footer background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/table-header-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/table-header-background&quot;,
            &quot;text&quot;: &quot;Table header background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tag-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tag-background&quot;,
            &quot;text&quot;: &quot;Tag background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tag-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tag-foreground&quot;,
            &quot;text&quot;: &quot;Tag foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-background&quot;,
            &quot;text&quot;: &quot;Tiddler background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-border&quot;,
            &quot;text&quot;: &quot;Tiddler border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-controls-foreground-hover&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-controls-foreground-hover&quot;,
            &quot;text&quot;: &quot;Tiddler controls foreground hover&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-controls-foreground-selected&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-controls-foreground-selected&quot;,
            &quot;text&quot;: &quot;Tiddler controls foreground for selected controls&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-controls-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-controls-foreground&quot;,
            &quot;text&quot;: &quot;Tiddler controls foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-editor-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-editor-background&quot;,
            &quot;text&quot;: &quot;Tiddler editor background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-editor-border-image&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-editor-border-image&quot;,
            &quot;text&quot;: &quot;Tiddler editor border image&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-editor-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-editor-border&quot;,
            &quot;text&quot;: &quot;Tiddler editor border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-editor-fields-even&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-editor-fields-even&quot;,
            &quot;text&quot;: &quot;Tiddler editor background for even fields&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-editor-fields-odd&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-editor-fields-odd&quot;,
            &quot;text&quot;: &quot;Tiddler editor background for odd fields&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-info-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-info-background&quot;,
            &quot;text&quot;: &quot;Tiddler info panel background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-info-border&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-info-border&quot;,
            &quot;text&quot;: &quot;Tiddler info panel border&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-info-tab-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-info-tab-background&quot;,
            &quot;text&quot;: &quot;Tiddler info panel tab background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-link-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-link-background&quot;,
            &quot;text&quot;: &quot;Tiddler link background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-link-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-link-foreground&quot;,
            &quot;text&quot;: &quot;Tiddler link foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-subtitle-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-subtitle-foreground&quot;,
            &quot;text&quot;: &quot;Tiddler subtitle foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/tiddler-title-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/tiddler-title-foreground&quot;,
            &quot;text&quot;: &quot;Tiddler title foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/toolbar-new-button&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/toolbar-new-button&quot;,
            &quot;text&quot;: &quot;Toolbar 'new tiddler' button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/toolbar-options-button&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/toolbar-options-button&quot;,
            &quot;text&quot;: &quot;Toolbar 'options' button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/toolbar-save-button&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/toolbar-save-button&quot;,
            &quot;text&quot;: &quot;Toolbar 'save' button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/toolbar-info-button&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/toolbar-info-button&quot;,
            &quot;text&quot;: &quot;Toolbar 'info' button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/toolbar-edit-button&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/toolbar-edit-button&quot;,
            &quot;text&quot;: &quot;Toolbar 'edit' button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/toolbar-close-button&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/toolbar-close-button&quot;,
            &quot;text&quot;: &quot;Toolbar 'close' button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/toolbar-delete-button&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/toolbar-delete-button&quot;,
            &quot;text&quot;: &quot;Toolbar 'delete' button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/toolbar-cancel-button&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/toolbar-cancel-button&quot;,
            &quot;text&quot;: &quot;Toolbar 'cancel' button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/toolbar-done-button&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/toolbar-done-button&quot;,
            &quot;text&quot;: &quot;Toolbar 'done' button foreground&quot;
        },
        &quot;$:/language/Docs/PaletteColours/untagged-background&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/untagged-background&quot;,
            &quot;text&quot;: &quot;Untagged pill background&quot;
        },
        &quot;$:/language/Docs/PaletteColours/very-muted-foreground&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/PaletteColours/very-muted-foreground&quot;,
            &quot;text&quot;: &quot;Very muted foreground&quot;
        },
        &quot;$:/language/EditTemplate/Body/External/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Body/External/Hint&quot;,
            &quot;text&quot;: &quot;This is an external tiddler stored outside of the main TiddlyWiki file. You can edit the tags and fields but cannot directly edit the content itself&quot;
        },
        &quot;$:/language/EditTemplate/Body/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Body/Hint&quot;,
            &quot;text&quot;: &quot;Use [[wiki text|http://tiddlywiki.com/static/WikiText.html]] to add formatting, images, and dynamic features&quot;
        },
        &quot;$:/language/EditTemplate/Body/Placeholder&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Body/Placeholder&quot;,
            &quot;text&quot;: &quot;Type the text for this tiddler&quot;
        },
        &quot;$:/language/EditTemplate/Body/Preview/Button/Hide&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Body/Preview/Button/Hide&quot;,
            &quot;text&quot;: &quot;hide preview&quot;
        },
        &quot;$:/language/EditTemplate/Body/Preview/Button/Show&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Body/Preview/Button/Show&quot;,
            &quot;text&quot;: &quot;show preview&quot;
        },
        &quot;$:/language/EditTemplate/Field/Remove/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Field/Remove/Caption&quot;,
            &quot;text&quot;: &quot;remove field&quot;
        },
        &quot;$:/language/EditTemplate/Field/Remove/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Field/Remove/Hint&quot;,
            &quot;text&quot;: &quot;Remove field&quot;
        },
        &quot;$:/language/EditTemplate/Fields/Add/Button&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Fields/Add/Button&quot;,
            &quot;text&quot;: &quot;add&quot;
        },
        &quot;$:/language/EditTemplate/Fields/Add/Name/Placeholder&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Fields/Add/Name/Placeholder&quot;,
            &quot;text&quot;: &quot;field name&quot;
        },
        &quot;$:/language/EditTemplate/Fields/Add/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Fields/Add/Prompt&quot;,
            &quot;text&quot;: &quot;Add a new field:&quot;
        },
        &quot;$:/language/EditTemplate/Fields/Add/Value/Placeholder&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Fields/Add/Value/Placeholder&quot;,
            &quot;text&quot;: &quot;field value&quot;
        },
        &quot;$:/language/EditTemplate/Shadow/Warning&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Shadow/Warning&quot;,
            &quot;text&quot;: &quot;This is a shadow tiddler. Any changes will override the default version&quot;
        },
        &quot;$:/language/EditTemplate/Shadow/OverriddenWarning&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Shadow/OverriddenWarning&quot;,
            &quot;text&quot;: &quot;This is a modified shadow tiddler. You can revert to the default version by deleting this tiddler&quot;
        },
        &quot;$:/language/EditTemplate/Tags/Add/Button&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Tags/Add/Button&quot;,
            &quot;text&quot;: &quot;add&quot;
        },
        &quot;$:/language/EditTemplate/Tags/Add/Placeholder&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Tags/Add/Placeholder&quot;,
            &quot;text&quot;: &quot;tag name&quot;
        },
        &quot;$:/language/EditTemplate/Tags/Dropdown/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Tags/Dropdown/Caption&quot;,
            &quot;text&quot;: &quot;tag list&quot;
        },
        &quot;$:/language/EditTemplate/Tags/Dropdown/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Tags/Dropdown/Hint&quot;,
            &quot;text&quot;: &quot;Show tag list&quot;
        },
        &quot;$:/language/EditTemplate/Type/Dropdown/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Type/Dropdown/Caption&quot;,
            &quot;text&quot;: &quot;content type list&quot;
        },
        &quot;$:/language/EditTemplate/Type/Dropdown/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Type/Dropdown/Hint&quot;,
            &quot;text&quot;: &quot;Show content type list&quot;
        },
        &quot;$:/language/EditTemplate/Type/Delete/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Type/Delete/Caption&quot;,
            &quot;text&quot;: &quot;delete content type&quot;
        },
        &quot;$:/language/EditTemplate/Type/Delete/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Type/Delete/Hint&quot;,
            &quot;text&quot;: &quot;Delete content type&quot;
        },
        &quot;$:/language/EditTemplate/Type/Placeholder&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Type/Placeholder&quot;,
            &quot;text&quot;: &quot;content type&quot;
        },
        &quot;$:/language/EditTemplate/Type/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/EditTemplate/Type/Prompt&quot;,
            &quot;text&quot;: &quot;Type:&quot;
        },
        &quot;$:/language/Exporters/StaticRiver&quot;: {
            &quot;title&quot;: &quot;$:/language/Exporters/StaticRiver&quot;,
            &quot;text&quot;: &quot;River of tiddlers as static HTML file&quot;
        },
        &quot;$:/language/Exporters/JsonFile&quot;: {
            &quot;title&quot;: &quot;$:/language/Exporters/JsonFile&quot;,
            &quot;text&quot;: &quot;JSON tiddlers file&quot;
        },
        &quot;$:/language/Exporters/CsvFile&quot;: {
            &quot;title&quot;: &quot;$:/language/Exporters/CsvFile&quot;,
            &quot;text&quot;: &quot;CSV tiddlers file&quot;
        },
        &quot;$:/language/Exporters/TidFile&quot;: {
            &quot;title&quot;: &quot;$:/language/Exporters/TidFile&quot;,
            &quot;text&quot;: &quot;Single tiddler \&quot;.tid\&quot; file&quot;
        },
        &quot;$:/language/Docs/Fields/_canonical_uri&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/_canonical_uri&quot;,
            &quot;text&quot;: &quot;The full URI of an external image tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/bag&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/bag&quot;,
            &quot;text&quot;: &quot;The name of the bag from which a tiddler came&quot;
        },
        &quot;$:/language/Docs/Fields/caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/caption&quot;,
            &quot;text&quot;: &quot;The text to be displayed on a tab or button&quot;
        },
        &quot;$:/language/Docs/Fields/color&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/color&quot;,
            &quot;text&quot;: &quot;The CSS color value associated with a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/component&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/component&quot;,
            &quot;text&quot;: &quot;The name of the component responsible for an [[alert tiddler|AlertMechanism]]&quot;
        },
        &quot;$:/language/Docs/Fields/current-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/current-tiddler&quot;,
            &quot;text&quot;: &quot;Used to cache the top tiddler in a [[history list|HistoryMechanism]]&quot;
        },
        &quot;$:/language/Docs/Fields/created&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/created&quot;,
            &quot;text&quot;: &quot;The date a tiddler was created&quot;
        },
        &quot;$:/language/Docs/Fields/creator&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/creator&quot;,
            &quot;text&quot;: &quot;The name of the person who created a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/dependents&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/dependents&quot;,
            &quot;text&quot;: &quot;For a plugin, lists the dependent plugin titles&quot;
        },
        &quot;$:/language/Docs/Fields/description&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/description&quot;,
            &quot;text&quot;: &quot;The descriptive text for a plugin, or a modal dialogue&quot;
        },
        &quot;$:/language/Docs/Fields/draft.of&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/draft.of&quot;,
            &quot;text&quot;: &quot;For draft tiddlers, contains the title of the tiddler of which this is a draft&quot;
        },
        &quot;$:/language/Docs/Fields/draft.title&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/draft.title&quot;,
            &quot;text&quot;: &quot;For draft tiddlers, contains the proposed new title of the tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/footer&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/footer&quot;,
            &quot;text&quot;: &quot;The footer text for a wizard&quot;
        },
        &quot;$:/language/Docs/Fields/hack-to-give-us-something-to-compare-against&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/hack-to-give-us-something-to-compare-against&quot;,
            &quot;text&quot;: &quot;A temporary storage field used in [[$:/core/templates/static.content]]&quot;
        },
        &quot;$:/language/Docs/Fields/icon&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/icon&quot;,
            &quot;text&quot;: &quot;The title of the tiddler containing the icon associated with a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/library&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/library&quot;,
            &quot;text&quot;: &quot;If set to \&quot;yes\&quot; indicates that a tiddler should be saved as a JavaScript library&quot;
        },
        &quot;$:/language/Docs/Fields/list&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/list&quot;,
            &quot;text&quot;: &quot;An ordered list of tiddler titles associated with a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/list-before&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/list-before&quot;,
            &quot;text&quot;: &quot;If set, the title of a tiddler before which this tiddler should be added to the ordered list of tiddler titles, or at the start of the list if this field is present but empty&quot;
        },
        &quot;$:/language/Docs/Fields/list-after&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/list-after&quot;,
            &quot;text&quot;: &quot;If set, the title of the tiddler after which this tiddler should be added to the ordered list of tiddler titles&quot;
        },
        &quot;$:/language/Docs/Fields/modified&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/modified&quot;,
            &quot;text&quot;: &quot;The date and time at which a tiddler was last modified&quot;
        },
        &quot;$:/language/Docs/Fields/modifier&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/modifier&quot;,
            &quot;text&quot;: &quot;The tiddler title associated with the person who last modified a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/name&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/name&quot;,
            &quot;text&quot;: &quot;The human readable name associated with a plugin tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/plugin-priority&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/plugin-priority&quot;,
            &quot;text&quot;: &quot;A numerical value indicating the priority of a plugin tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/plugin-type&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/plugin-type&quot;,
            &quot;text&quot;: &quot;The type of plugin in a plugin tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/revision&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/revision&quot;,
            &quot;text&quot;: &quot;The revision of the tiddler held at the server&quot;
        },
        &quot;$:/language/Docs/Fields/released&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/released&quot;,
            &quot;text&quot;: &quot;Date of a TiddlyWiki release&quot;
        },
        &quot;$:/language/Docs/Fields/source&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/source&quot;,
            &quot;text&quot;: &quot;The source URL associated with a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/subtitle&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/subtitle&quot;,
            &quot;text&quot;: &quot;The subtitle text for a wizard&quot;
        },
        &quot;$:/language/Docs/Fields/tags&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/tags&quot;,
            &quot;text&quot;: &quot;A list of tags associated with a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/text&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/text&quot;,
            &quot;text&quot;: &quot;The body text of a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/title&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/title&quot;,
            &quot;text&quot;: &quot;The unique name of a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/type&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/type&quot;,
            &quot;text&quot;: &quot;The content type of a tiddler&quot;
        },
        &quot;$:/language/Docs/Fields/version&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Fields/version&quot;,
            &quot;text&quot;: &quot;Version information for a plugin&quot;
        },
        &quot;$:/language/Filters/AllTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/AllTiddlers&quot;,
            &quot;text&quot;: &quot;All tiddlers except system tiddlers&quot;
        },
        &quot;$:/language/Filters/RecentSystemTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/RecentSystemTiddlers&quot;,
            &quot;text&quot;: &quot;Recently modified tiddlers, including system tiddlers&quot;
        },
        &quot;$:/language/Filters/RecentTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/RecentTiddlers&quot;,
            &quot;text&quot;: &quot;Recently modified tiddlers&quot;
        },
        &quot;$:/language/Filters/AllTags&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/AllTags&quot;,
            &quot;text&quot;: &quot;All tags except system tags&quot;
        },
        &quot;$:/language/Filters/Missing&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/Missing&quot;,
            &quot;text&quot;: &quot;Missing tiddlers&quot;
        },
        &quot;$:/language/Filters/Drafts&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/Drafts&quot;,
            &quot;text&quot;: &quot;Draft tiddlers&quot;
        },
        &quot;$:/language/Filters/Orphans&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/Orphans&quot;,
            &quot;text&quot;: &quot;Orphan tiddlers&quot;
        },
        &quot;$:/language/Filters/SystemTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/SystemTiddlers&quot;,
            &quot;text&quot;: &quot;System tiddlers&quot;
        },
        &quot;$:/language/Filters/ShadowTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/ShadowTiddlers&quot;,
            &quot;text&quot;: &quot;Shadow tiddlers&quot;
        },
        &quot;$:/language/Filters/OverriddenShadowTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/OverriddenShadowTiddlers&quot;,
            &quot;text&quot;: &quot;Overridden shadow tiddlers&quot;
        },
        &quot;$:/language/Filters/SystemTags&quot;: {
            &quot;title&quot;: &quot;$:/language/Filters/SystemTags&quot;,
            &quot;text&quot;: &quot;System tags&quot;
        },
        &quot;GettingStarted&quot;: {
            &quot;title&quot;: &quot;GettingStarted&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Basics/\nWelcome to ~TiddlyWiki and the ~TiddlyWiki community\n\nBefore you start storing important information in ~TiddlyWiki it is important to make sure that you can reliably save changes. See http://tiddlywiki.com/#GettingStarted for details\n\n!! Set up this ~TiddlyWiki\n\n|&lt;$link to=\&quot;$:/SiteTitle\&quot;&gt;&lt;&lt;lingo Title/Prompt&gt;&gt;&lt;/$link&gt; |&lt;$edit-text tiddler=\&quot;$:/SiteTitle\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;$link to=\&quot;$:/SiteSubtitle\&quot;&gt;&lt;&lt;lingo Subtitle/Prompt&gt;&gt;&lt;/$link&gt; |&lt;$edit-text tiddler=\&quot;$:/SiteSubtitle\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;$link to=\&quot;$:/DefaultTiddlers\&quot;&gt;&lt;&lt;lingo DefaultTiddlers/Prompt&gt;&gt;&lt;/$link&gt; |&lt;&lt;lingo DefaultTiddlers/TopHint&gt;&gt;&lt;br&gt; &lt;$edit-text tag=\&quot;textarea\&quot; tiddler=\&quot;$:/DefaultTiddlers\&quot;/&gt;&lt;br&gt;//&lt;&lt;lingo DefaultTiddlers/BottomHint&gt;&gt;// |\n\nSee the [[control panel|$:/ControlPanel]] for more options.\n&quot;
        },
        &quot;$:/language/Help/build&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/build&quot;,
            &quot;description&quot;: &quot;Automatically run configured commands&quot;,
            &quot;text&quot;: &quot;Build the specified build targets for the current wiki. If no build targets are specified then all available targets will be built.\n\n```\n--build &lt;target&gt; [&lt;target&gt; ...]\n```\n\nBuild targets are defined in the `tiddlywiki.info` file of a wiki folder.\n\n&quot;
        },
        &quot;$:/language/Help/clearpassword&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/clearpassword&quot;,
            &quot;description&quot;: &quot;Clear a password for subsequent crypto operations&quot;,
            &quot;text&quot;: &quot;Clear the password for subsequent crypto operations\n\n```\n--clearpassword\n```\n&quot;
        },
        &quot;$:/language/Help/default&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/default&quot;,
            &quot;text&quot;: &quot;\\define commandTitle()\n$:/language/Help/$(command)$\n\\end\n```\nusage: tiddlywiki [&lt;wikifolder&gt;] [--&lt;command&gt; [&lt;args&gt;...]...]\n```\n\nAvailable commands:\n\n&lt;ul&gt;\n&lt;$list filter=\&quot;[commands[]sort[title]]\&quot; variable=\&quot;command\&quot;&gt;\n&lt;li&gt;&lt;$link to=&lt;&lt;commandTitle&gt;&gt;&gt;&lt;$macrocall $name=\&quot;command\&quot; $type=\&quot;text/plain\&quot; $output=\&quot;text/plain\&quot;/&gt;&lt;/$link&gt;: &lt;$transclude tiddler=&lt;&lt;commandTitle&gt;&gt; field=\&quot;description\&quot;/&gt;&lt;/li&gt;\n&lt;/$list&gt;\n&lt;/ul&gt;\n\nTo get detailed help on a command:\n\n```\ntiddlywiki --help &lt;command&gt;\n```\n&quot;
        },
        &quot;$:/language/Help/editions&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/editions&quot;,
            &quot;description&quot;: &quot;Lists the available editions of TiddlyWiki&quot;,
            &quot;text&quot;: &quot;Lists the names and descriptions of the available editions. You can create a new wiki of a specified edition with the `--init` command.\n\n```\n--editions\n```\n&quot;
        },
        &quot;$:/language/Help/help&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/help&quot;,
            &quot;description&quot;: &quot;Display help for TiddlyWiki commands&quot;,
            &quot;text&quot;: &quot;Displays help text for a command:\n\n```\n--help [&lt;command&gt;]\n```\n\nIf the command name is omitted then a list of available commands is displayed.\n&quot;
        },
        &quot;$:/language/Help/init&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/init&quot;,
            &quot;description&quot;: &quot;Initialise a new wiki folder&quot;,
            &quot;text&quot;: &quot;Initialise an empty [[WikiFolder|WikiFolders]] with a copy of the specified edition.\n\n```\n--init &lt;edition&gt; [&lt;edition&gt; ...]\n```\n\nFor example:\n\n```\ntiddlywiki ./MyWikiFolder --init empty\n```\n\nNote:\n\n* The wiki folder directory will be created if necessary\n* The \&quot;edition\&quot; defaults to ''empty''\n* The init command will fail if the wiki folder is not empty\n* The init command removes any `includeWikis` definitions in the edition's `tiddlywiki.info` file\n* When multiple editions are specified, editions initialised later will overwrite any files shared with earlier editions (so, the final `tiddlywiki.info` file will be copied from the last edition)\n* `--editions` returns a list of available editions\n&quot;
        },
        &quot;$:/language/Help/load&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/load&quot;,
            &quot;description&quot;: &quot;Load tiddlers from a file&quot;,
            &quot;text&quot;: &quot;Load tiddlers from 2.x.x TiddlyWiki files (`.html`), `.tiddler`, `.tid`, `.json` or other files \n\n```\n--load &lt;filepath&gt;\n```\n\nTo load tiddlers from an encrypted TiddlyWiki file you should first specify the password with the PasswordCommand. For example:\n\n```\ntiddlywiki ./MyWiki --password pa55w0rd --load my_encrypted_wiki.html\n```\n\nNote that TiddlyWiki will not load an older version of an already loaded plugin.\n&quot;
        },
        &quot;$:/language/Help/makelibrary&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/makelibrary&quot;,
            &quot;description&quot;: &quot;Construct library plugin required by upgrade process&quot;,
            &quot;text&quot;: &quot;Constructs the `$:/UpgradeLibrary` tiddler for the upgrade process.\n\nThe upgrade library is formatted as an ordinary plugin tiddler with the plugin type `library`. It contains a copy of each of the plugins, themes and language packs available within the TiddlyWiki5 repository.\n\nThis command is intended for internal use; it is only relevant to users constructing a custom upgrade procedure.\n\n```\n--makelibrary &lt;title&gt;\n```\n\nThe title argument defaults to `$:/UpgradeLibrary`.\n&quot;
        },
        &quot;$:/language/Help/notfound&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/notfound&quot;,
            &quot;text&quot;: &quot;No such help item&quot;
        },
        &quot;$:/language/Help/output&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/output&quot;,
            &quot;description&quot;: &quot;Set the base output directory for subsequent commands&quot;,
            &quot;text&quot;: &quot;Sets the base output directory for subsequent commands. The default output directory is the `output` subdirectory of the edition directory.\n\n```\n--output &lt;pathname&gt;\n```\n\nIf the specified pathname is relative then it is resolved relative to the current working directory. For example `--output .` sets the output directory to the current working directory.\n\n&quot;
        },
        &quot;$:/language/Help/password&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/password&quot;,
            &quot;description&quot;: &quot;Set a password for subsequent crypto operations&quot;,
            &quot;text&quot;: &quot;Set a password for subsequent crypto operations\n\n```\n--password &lt;password&gt;\n```\n\n&quot;
        },
        &quot;$:/language/Help/rendertiddler&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/rendertiddler&quot;,
            &quot;description&quot;: &quot;Render an individual tiddler as a specified ContentType&quot;,
            &quot;text&quot;: &quot;Render an individual tiddler as a specified ContentType, defaults to `text/html` and save it to the specified filename:\n\n```\n--rendertiddler &lt;title&gt; &lt;filename&gt; [&lt;type&gt;]\n```\n\nBy default, the filename is resolved relative to the `output` subdirectory of the edition directory. The `--output` command can be used to direct output to a different directory.\n\nAny missing directories in the path to the filename are automatically created.\n&quot;
        },
        &quot;$:/language/Help/rendertiddlers&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/rendertiddlers&quot;,
            &quot;description&quot;: &quot;Render tiddlers matching a filter to a specified ContentType&quot;,
            &quot;text&quot;: &quot;Render a set of tiddlers matching a filter to separate files of a specified ContentType (defaults to `text/html`) and extension (defaults to `.html`).\n\n```\n--rendertiddlers &lt;filter&gt; &lt;template&gt; &lt;pathname&gt; [&lt;type&gt;] [&lt;extension&gt;]\n```\n\nFor example:\n\n```\n--rendertiddlers [!is[system]] $:/core/templates/static.tiddler.html ./static text/plain\n```\n\nBy default, the pathname is resolved relative to the `output` subdirectory of the edition directory. The `--output` command can be used to direct output to a different directory.\n\nAny files in the target directory are deleted. The target directory is recursively created if it is missing.\n&quot;
        },
        &quot;$:/language/Help/savetiddler&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/savetiddler&quot;,
            &quot;description&quot;: &quot;Saves a raw tiddler to a file&quot;,
            &quot;text&quot;: &quot;Saves an individual tiddler in its raw text or binary format to the specified filename. \n\n```\n--savetiddler &lt;title&gt; &lt;filename&gt;\n```\n\nBy default, the filename is resolved relative to the `output` subdirectory of the edition directory. The `--output` command can be used to direct output to a different directory.\n\nAny missing directories in the path to the filename are automatically created.\n&quot;
        },
        &quot;$:/language/Help/savetiddlers&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/savetiddlers&quot;,
            &quot;description&quot;: &quot;Saves a group of raw tiddlers to a directory&quot;,
            &quot;text&quot;: &quot;Saves a group of tiddlers in their raw text or binary format to the specified directory. \n\n```\n--savetiddlers &lt;filter&gt; &lt;pathname&gt;\n```\n\nBy default, the pathname is resolved relative to the `output` subdirectory of the edition directory. The `--output` command can be used to direct output to a different directory.\n\nAny missing directories in the pathname are automatically created.\n&quot;
        },
        &quot;$:/language/Help/server&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/server&quot;,
            &quot;description&quot;: &quot;Provides an HTTP server interface to TiddlyWiki&quot;,
            &quot;text&quot;: &quot;The server built in to TiddlyWiki5 is very simple. Although compatible with TiddlyWeb it doesn't support many of the features needed for robust Internet-facing usage.\n\nAt the root, it serves a rendering of a specified tiddler. Away from the root, it serves individual tiddlers encoded in JSON, and supports the basic HTTP operations for `GET`, `PUT` and `DELETE`.\n\n```\n--server &lt;port&gt; &lt;roottiddler&gt; &lt;rendertype&gt; &lt;servetype&gt; &lt;username&gt; &lt;password&gt; &lt;host&gt; &lt;pathprefix&gt;\n```\n\nThe parameters are:\n\n* ''port'' - port number to serve from (defaults to \&quot;8080\&quot;)\n* ''roottiddler'' - the tiddler to serve at the root (defaults to \&quot;$:/core/save/all\&quot;) \n* ''rendertype'' - the content type to which the root tiddler should be rendered (defaults to \&quot;text/plain\&quot;)\n* ''servetype'' - the content type with which the root tiddler should be served (defaults to \&quot;text/html\&quot;)\n* ''username'' - the default username for signing edits\n* ''password'' - optional password for basic authentication\n* ''host'' - optional hostname to serve from (defaults to \&quot;127.0.0.1\&quot; aka \&quot;localhost\&quot;)\n* ''pathprefix'' - optional prefix for paths\n\nIf the password parameter is specified then the browser will prompt the user for the username and password. Note that the password is transmitted in plain text so this implementation isn't suitable for general use.\n\nFor example:\n\n```\n--server 8080 $:/core/save/all text/plain text/html MyUserName passw0rd\n```\n\nThe username and password can be specified as empty strings if you need to set the hostname or pathprefix and don't want to require a password:\n\n```\n--server 8080 $:/core/save/all text/plain text/html \&quot;\&quot; \&quot;\&quot; 192.168.0.245\n```\n\nTo run multiple TiddlyWiki servers at the same time you'll need to put each one on a different port.\n&quot;
        },
        &quot;$:/language/Help/setfield&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/setfield&quot;,
            &quot;description&quot;: &quot;Prepares external tiddlers for use&quot;,
            &quot;text&quot;: &quot;//Note that this command is experimental and may change or be replaced before being finalised//\n\nSets the specified field of a group of tiddlers to the result of wikifying a template tiddler with the `currentTiddler` variable set to the tiddler.\n\n```\n--setfield &lt;filter&gt; &lt;fieldname&gt; &lt;templatetitle&gt; &lt;rendertype&gt;\n```\n\nThe parameters are:\n\n* ''filter'' - filter identifying the tiddlers to be affected\n* ''fieldname'' - the field to modify (defaults to \&quot;text\&quot;)\n* ''templatetitle'' - the tiddler to wikify into the specified field. If blank or missing then the specified field is deleted\n* ''type'' - the text type to render (defaults to \&quot;text/plain\&quot;; \&quot;text/html\&quot; can be used to include HTML tags)\n\n&quot;
        },
        &quot;$:/language/Help/unpackplugin&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/unpackplugin&quot;,
            &quot;description&quot;: &quot;Unpack the payload tiddlers from a plugin&quot;,
            &quot;text&quot;: &quot;Extract the payload tiddlers from a plugin, creating them as ordinary tiddlers:\n\n```\n--unpackplugin &lt;title&gt;\n```\n&quot;
        },
        &quot;$:/language/Help/verbose&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/verbose&quot;,
            &quot;description&quot;: &quot;Triggers verbose output mode&quot;,
            &quot;text&quot;: &quot;Triggers verbose output, useful for debugging \n\n```\n--verbose\n```\n&quot;
        },
        &quot;$:/language/Help/version&quot;: {
            &quot;title&quot;: &quot;$:/language/Help/version&quot;,
            &quot;description&quot;: &quot;Displays the version number of TiddlyWiki&quot;,
            &quot;text&quot;: &quot;Displays the version number of TiddlyWiki.\n\n```\n--version\n```\n&quot;
        },
        &quot;$:/language/Import/Listing/Cancel/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Listing/Cancel/Caption&quot;,
            &quot;text&quot;: &quot;Cancel&quot;
        },
        &quot;$:/language/Import/Listing/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Listing/Hint&quot;,
            &quot;text&quot;: &quot;These tiddlers are ready to import:&quot;
        },
        &quot;$:/language/Import/Listing/Import/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Listing/Import/Caption&quot;,
            &quot;text&quot;: &quot;Import&quot;
        },
        &quot;$:/language/Import/Listing/Select/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Listing/Select/Caption&quot;,
            &quot;text&quot;: &quot;Select&quot;
        },
        &quot;$:/language/Import/Listing/Status/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Listing/Status/Caption&quot;,
            &quot;text&quot;: &quot;Status&quot;
        },
        &quot;$:/language/Import/Listing/Title/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Listing/Title/Caption&quot;,
            &quot;text&quot;: &quot;Title&quot;
        },
        &quot;$:/language/Import/Upgrader/Plugins/Suppressed/Incompatible&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Upgrader/Plugins/Suppressed/Incompatible&quot;,
            &quot;text&quot;: &quot;Blocked incompatible or obsolete plugin &quot;
        },
        &quot;$:/language/Import/Upgrader/Plugins/Suppressed/Version&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Upgrader/Plugins/Suppressed/Version&quot;,
            &quot;text&quot;: &quot;Blocked plugin (due to incoming &lt;&lt;incoming&gt;&gt;  being older than existing &lt;&lt;existing&gt;&gt;)&quot;
        },
        &quot;$:/language/Import/Upgrader/Plugins/Upgraded&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Upgrader/Plugins/Upgraded&quot;,
            &quot;text&quot;: &quot;Upgraded plugin from &lt;&lt;incoming&gt;&gt; to &lt;&lt;upgraded&gt;&gt;&quot;
        },
        &quot;$:/language/Import/Upgrader/State/Suppressed&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Upgrader/State/Suppressed&quot;,
            &quot;text&quot;: &quot;Blocked temporary state tiddler&quot;
        },
        &quot;$:/language/Import/Upgrader/System/Suppressed&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Upgrader/System/Suppressed&quot;,
            &quot;text&quot;: &quot;Blocked system tiddler&quot;
        },
        &quot;$:/language/Import/Upgrader/ThemeTweaks/Created&quot;: {
            &quot;title&quot;: &quot;$:/language/Import/Upgrader/ThemeTweaks/Created&quot;,
            &quot;text&quot;: &quot;Migrated theme tweak from &lt;$text text=&lt;&lt;from&gt;&gt;/&gt;&quot;
        },
        &quot;$:/language/BinaryWarning/Prompt&quot;: {
            &quot;title&quot;: &quot;$:/language/BinaryWarning/Prompt&quot;,
            &quot;text&quot;: &quot;This tiddler contains binary data&quot;
        },
        &quot;$:/language/ClassicWarning/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/ClassicWarning/Hint&quot;,
            &quot;text&quot;: &quot;This tiddler is written in TiddlyWiki Classic wiki text format, which is not fully compatible with TiddlyWiki version 5. See http://tiddlywiki.com/static/Upgrading.html for more details. &quot;
        },
        &quot;$:/language/ClassicWarning/Upgrade/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/ClassicWarning/Upgrade/Caption&quot;,
            &quot;text&quot;: &quot;upgrade&quot;
        },
        &quot;$:/language/CloseAll/Button&quot;: {
            &quot;title&quot;: &quot;$:/language/CloseAll/Button&quot;,
            &quot;text&quot;: &quot;close all&quot;
        },
        &quot;$:/language/ConfirmCancelTiddler&quot;: {
            &quot;title&quot;: &quot;$:/language/ConfirmCancelTiddler&quot;,
            &quot;text&quot;: &quot;Do you wish to discard changes to the tiddler \&quot;&lt;$text text=&lt;&lt;title&gt;&gt;/&gt;\&quot;?&quot;
        },
        &quot;$:/language/ConfirmDeleteTiddler&quot;: {
            &quot;title&quot;: &quot;$:/language/ConfirmDeleteTiddler&quot;,
            &quot;text&quot;: &quot;Do you wish to delete the tiddler \&quot;&lt;$text text=&lt;&lt;title&gt;&gt;/&gt;\&quot;?&quot;
        },
        &quot;$:/language/ConfirmOverwriteTiddler&quot;: {
            &quot;title&quot;: &quot;$:/language/ConfirmOverwriteTiddler&quot;,
            &quot;text&quot;: &quot;Do you wish to overwrite the tiddler \&quot;&lt;$text text=&lt;&lt;title&gt;&gt;/&gt;\&quot;?&quot;
        },
        &quot;$:/language/ConfirmEditShadowTiddler&quot;: {
            &quot;title&quot;: &quot;$:/language/ConfirmEditShadowTiddler&quot;,
            &quot;text&quot;: &quot;You are about to edit a ShadowTiddler. Any changes will override the default system making future upgrades non-trivial. Are you sure you want to edit \&quot;&lt;$text text=&lt;&lt;title&gt;&gt;/&gt;\&quot;?&quot;
        },
        &quot;$:/language/DefaultNewTiddlerTitle&quot;: {
            &quot;title&quot;: &quot;$:/language/DefaultNewTiddlerTitle&quot;,
            &quot;text&quot;: &quot;New Tiddler&quot;
        },
        &quot;$:/language/DropMessage&quot;: {
            &quot;title&quot;: &quot;$:/language/DropMessage&quot;,
            &quot;text&quot;: &quot;Drop here (or click escape to cancel)&quot;
        },
        &quot;$:/language/Encryption/ConfirmClearPassword&quot;: {
            &quot;title&quot;: &quot;$:/language/Encryption/ConfirmClearPassword&quot;,
            &quot;text&quot;: &quot;Do you wish to clear the password? This will remove the encryption applied when saving this wiki&quot;
        },
        &quot;$:/language/Encryption/PromptSetPassword&quot;: {
            &quot;title&quot;: &quot;$:/language/Encryption/PromptSetPassword&quot;,
            &quot;text&quot;: &quot;Set a new password for this TiddlyWiki&quot;
        },
        &quot;$:/language/InvalidFieldName&quot;: {
            &quot;title&quot;: &quot;$:/language/InvalidFieldName&quot;,
            &quot;text&quot;: &quot;Illegal characters in field name \&quot;&lt;$text text=&lt;&lt;fieldName&gt;&gt;/&gt;\&quot;. Fields can only contain lowercase letters, digits and the characters underscore (`_`), hyphen (`-`) and period (`.`)&quot;
        },
        &quot;$:/language/MissingTiddler/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/MissingTiddler/Hint&quot;,
            &quot;text&quot;: &quot;Missing tiddler \&quot;&lt;$text text=&lt;&lt;currentTiddler&gt;&gt;/&gt;\&quot; - click {{$:/core/images/edit-button}} to create&quot;
        },
        &quot;$:/language/RecentChanges/DateFormat&quot;: {
            &quot;title&quot;: &quot;$:/language/RecentChanges/DateFormat&quot;,
            &quot;text&quot;: &quot;DDth MMM YYYY&quot;
        },
        &quot;$:/language/SystemTiddler/Tooltip&quot;: {
            &quot;title&quot;: &quot;$:/language/SystemTiddler/Tooltip&quot;,
            &quot;text&quot;: &quot;This is a system tiddler&quot;
        },
        &quot;$:/language/TagManager/Colour/Heading&quot;: {
            &quot;title&quot;: &quot;$:/language/TagManager/Colour/Heading&quot;,
            &quot;text&quot;: &quot;Colour&quot;
        },
        &quot;$:/language/TagManager/Icon/Heading&quot;: {
            &quot;title&quot;: &quot;$:/language/TagManager/Icon/Heading&quot;,
            &quot;text&quot;: &quot;Icon&quot;
        },
        &quot;$:/language/TagManager/Info/Heading&quot;: {
            &quot;title&quot;: &quot;$:/language/TagManager/Info/Heading&quot;,
            &quot;text&quot;: &quot;Info&quot;
        },
        &quot;$:/language/TagManager/Tag/Heading&quot;: {
            &quot;title&quot;: &quot;$:/language/TagManager/Tag/Heading&quot;,
            &quot;text&quot;: &quot;Tag&quot;
        },
        &quot;$:/language/UnsavedChangesWarning&quot;: {
            &quot;title&quot;: &quot;$:/language/UnsavedChangesWarning&quot;,
            &quot;text&quot;: &quot;You have unsaved changes in TiddlyWiki&quot;
        },
        &quot;$:/language/Modals/Download&quot;: {
            &quot;title&quot;: &quot;$:/language/Modals/Download&quot;,
            &quot;type&quot;: &quot;text/vnd.tiddlywiki&quot;,
            &quot;subtitle&quot;: &quot;Download changes&quot;,
            &quot;footer&quot;: &quot;&lt;$button message=\&quot;tm-close-tiddler\&quot;&gt;Close&lt;/$button&gt;&quot;,
            &quot;help&quot;: &quot;http://tiddlywiki.com/static/DownloadingChanges.html&quot;,
            &quot;text&quot;: &quot;Your browser only supports manual saving.\n\nTo save your modified wiki, right click on the download link below and select \&quot;Download file\&quot; or \&quot;Save file\&quot;, and then choose the folder and filename.\n\n//You can marginally speed things up by clicking the link with the control key (Windows) or the options/alt key (Mac OS X). You will not be prompted for the folder or filename, but your browser is likely to give it an unrecognisable name -- you may need to rename the file to include an `.html` extension before you can do anything useful with it.//\n\nOn smartphones that do not allow files to be downloaded you can instead bookmark the link, and then sync your bookmarks to a desktop computer from where the wiki can be saved normally.\n&quot;
        },
        &quot;$:/language/Modals/SaveInstructions&quot;: {
            &quot;title&quot;: &quot;$:/language/Modals/SaveInstructions&quot;,
            &quot;type&quot;: &quot;text/vnd.tiddlywiki&quot;,
            &quot;subtitle&quot;: &quot;Save your work&quot;,
            &quot;footer&quot;: &quot;&lt;$button message=\&quot;tm-close-tiddler\&quot;&gt;Close&lt;/$button&gt;&quot;,
            &quot;help&quot;: &quot;http://tiddlywiki.com/static/SavingChanges.html&quot;,
            &quot;text&quot;: &quot;Your changes to this wiki need to be saved as a ~TiddlyWiki HTML file.\n\n!!! Desktop browsers\n\n# Select ''Save As'' from the ''File'' menu\n# Choose a filename and location\n#* Some browsers also require you to explicitly specify the file saving format as ''Webpage, HTML only'' or similar\n# Close this tab\n\n!!! Smartphone browsers\n\n# Create a bookmark to this page\n#* If you've got iCloud or Google Sync set up then the bookmark will automatically sync to your desktop where you can open it and save it as above\n# Close this tab\n\n//If you open the bookmark again in Mobile Safari you will see this message again. If you want to go ahead and use the file, just click the ''close'' button below//\n&quot;
        },
        &quot;$:/config/NewJournal/Title&quot;: {
            &quot;title&quot;: &quot;$:/config/NewJournal/Title&quot;,
            &quot;text&quot;: &quot;DDth MMM YYYY&quot;
        },
        &quot;$:/config/NewJournal/Tags&quot;: {
            &quot;title&quot;: &quot;$:/config/NewJournal/Tags&quot;,
            &quot;text&quot;: &quot;Journal&quot;
        },
        &quot;$:/language/Notifications/Save/Done&quot;: {
            &quot;title&quot;: &quot;$:/language/Notifications/Save/Done&quot;,
            &quot;text&quot;: &quot;Saved wiki&quot;
        },
        &quot;$:/language/Notifications/Save/Starting&quot;: {
            &quot;title&quot;: &quot;$:/language/Notifications/Save/Starting&quot;,
            &quot;text&quot;: &quot;Starting to save wiki&quot;
        },
        &quot;$:/language/Search/DefaultResults/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/DefaultResults/Caption&quot;,
            &quot;text&quot;: &quot;List&quot;
        },
        &quot;$:/language/Search/Filter/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Filter/Caption&quot;,
            &quot;text&quot;: &quot;Filter&quot;
        },
        &quot;$:/language/Search/Filter/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Filter/Hint&quot;,
            &quot;text&quot;: &quot;Search via a [[filter expression|http://tiddlywiki.com/static/Filters.html]]&quot;
        },
        &quot;$:/language/Search/Filter/Matches&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Filter/Matches&quot;,
            &quot;text&quot;: &quot;//&lt;small&gt;&lt;&lt;resultCount&gt;&gt; matches&lt;/small&gt;//&quot;
        },
        &quot;$:/language/Search/Matches&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Matches&quot;,
            &quot;text&quot;: &quot;//&lt;small&gt;&lt;&lt;resultCount&gt;&gt; matches&lt;/small&gt;//&quot;
        },
        &quot;$:/language/Search/Shadows/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Shadows/Caption&quot;,
            &quot;text&quot;: &quot;Shadows&quot;
        },
        &quot;$:/language/Search/Shadows/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Shadows/Hint&quot;,
            &quot;text&quot;: &quot;Search for shadow tiddlers&quot;
        },
        &quot;$:/language/Search/Shadows/Matches&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Shadows/Matches&quot;,
            &quot;text&quot;: &quot;//&lt;small&gt;&lt;&lt;resultCount&gt;&gt; matches&lt;/small&gt;//&quot;
        },
        &quot;$:/language/Search/Standard/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Standard/Caption&quot;,
            &quot;text&quot;: &quot;Standard&quot;
        },
        &quot;$:/language/Search/Standard/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Standard/Hint&quot;,
            &quot;text&quot;: &quot;Search for standard tiddlers&quot;
        },
        &quot;$:/language/Search/Standard/Matches&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/Standard/Matches&quot;,
            &quot;text&quot;: &quot;//&lt;small&gt;&lt;&lt;resultCount&gt;&gt; matches&lt;/small&gt;//&quot;
        },
        &quot;$:/language/Search/System/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/System/Caption&quot;,
            &quot;text&quot;: &quot;System&quot;
        },
        &quot;$:/language/Search/System/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/System/Hint&quot;,
            &quot;text&quot;: &quot;Search for system tiddlers&quot;
        },
        &quot;$:/language/Search/System/Matches&quot;: {
            &quot;title&quot;: &quot;$:/language/Search/System/Matches&quot;,
            &quot;text&quot;: &quot;//&lt;small&gt;&lt;&lt;resultCount&gt;&gt; matches&lt;/small&gt;//&quot;
        },
        &quot;$:/language/SideBar/All/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/All/Caption&quot;,
            &quot;text&quot;: &quot;All&quot;
        },
        &quot;$:/language/SideBar/Contents/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Contents/Caption&quot;,
            &quot;text&quot;: &quot;Contents&quot;
        },
        &quot;$:/language/SideBar/Drafts/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Drafts/Caption&quot;,
            &quot;text&quot;: &quot;Drafts&quot;
        },
        &quot;$:/language/SideBar/Missing/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Missing/Caption&quot;,
            &quot;text&quot;: &quot;Missing&quot;
        },
        &quot;$:/language/SideBar/More/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/More/Caption&quot;,
            &quot;text&quot;: &quot;More&quot;
        },
        &quot;$:/language/SideBar/Open/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Open/Caption&quot;,
            &quot;text&quot;: &quot;Open&quot;
        },
        &quot;$:/language/SideBar/Orphans/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Orphans/Caption&quot;,
            &quot;text&quot;: &quot;Orphans&quot;
        },
        &quot;$:/language/SideBar/Recent/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Recent/Caption&quot;,
            &quot;text&quot;: &quot;Recent&quot;
        },
        &quot;$:/language/SideBar/Shadows/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Shadows/Caption&quot;,
            &quot;text&quot;: &quot;Shadows&quot;
        },
        &quot;$:/language/SideBar/System/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/System/Caption&quot;,
            &quot;text&quot;: &quot;System&quot;
        },
        &quot;$:/language/SideBar/Tags/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Tags/Caption&quot;,
            &quot;text&quot;: &quot;Tags&quot;
        },
        &quot;$:/language/SideBar/Tags/Untagged/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Tags/Untagged/Caption&quot;,
            &quot;text&quot;: &quot;untagged&quot;
        },
        &quot;$:/language/SideBar/Tools/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Tools/Caption&quot;,
            &quot;text&quot;: &quot;Tools&quot;
        },
        &quot;$:/language/SideBar/Types/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/SideBar/Types/Caption&quot;,
            &quot;text&quot;: &quot;Types&quot;
        },
        &quot;$:/SiteSubtitle&quot;: {
            &quot;title&quot;: &quot;$:/SiteSubtitle&quot;,
            &quot;text&quot;: &quot;a non-linear personal web notebook&quot;
        },
        &quot;$:/SiteTitle&quot;: {
            &quot;title&quot;: &quot;$:/SiteTitle&quot;,
            &quot;text&quot;: &quot;My ~TiddlyWiki&quot;
        },
        &quot;$:/language/TiddlerInfo/Advanced/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Advanced/Caption&quot;,
            &quot;text&quot;: &quot;Advanced&quot;
        },
        &quot;$:/language/TiddlerInfo/Advanced/PluginInfo/Empty/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Advanced/PluginInfo/Empty/Hint&quot;,
            &quot;text&quot;: &quot;none&quot;
        },
        &quot;$:/language/TiddlerInfo/Advanced/PluginInfo/Heading&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Advanced/PluginInfo/Heading&quot;,
            &quot;text&quot;: &quot;Plugin Details&quot;
        },
        &quot;$:/language/TiddlerInfo/Advanced/PluginInfo/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Advanced/PluginInfo/Hint&quot;,
            &quot;text&quot;: &quot;This plugin contains the following shadow tiddlers:&quot;
        },
        &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/Heading&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/Heading&quot;,
            &quot;text&quot;: &quot;Shadow Status&quot;
        },
        &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/NotShadow/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/NotShadow/Hint&quot;,
            &quot;text&quot;: &quot;The tiddler &lt;$link to=&lt;&lt;infoTiddler&gt;&gt;&gt;&lt;$text text=&lt;&lt;infoTiddler&gt;&gt;/&gt;&lt;/$link&gt; is not a shadow tiddler&quot;
        },
        &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/Shadow/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/Shadow/Hint&quot;,
            &quot;text&quot;: &quot;The tiddler &lt;$link to=&lt;&lt;infoTiddler&gt;&gt;&gt;&lt;$text text=&lt;&lt;infoTiddler&gt;&gt;/&gt;&lt;/$link&gt; is a shadow tiddler&quot;
        },
        &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/Shadow/Source&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/Shadow/Source&quot;,
            &quot;text&quot;: &quot;It is defined in the plugin &lt;$link to=&lt;&lt;pluginTiddler&gt;&gt;&gt;&lt;$text text=&lt;&lt;pluginTiddler&gt;&gt;/&gt;&lt;/$link&gt;&quot;
        },
        &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/OverriddenShadow/Hint&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Advanced/ShadowInfo/OverriddenShadow/Hint&quot;,
            &quot;text&quot;: &quot;It is overridden by an ordinary tiddler&quot;
        },
        &quot;$:/language/TiddlerInfo/Fields/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Fields/Caption&quot;,
            &quot;text&quot;: &quot;Fields&quot;
        },
        &quot;$:/language/TiddlerInfo/List/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/List/Caption&quot;,
            &quot;text&quot;: &quot;List&quot;
        },
        &quot;$:/language/TiddlerInfo/List/Empty&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/List/Empty&quot;,
            &quot;text&quot;: &quot;This tiddler does not have a list&quot;
        },
        &quot;$:/language/TiddlerInfo/Listed/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Listed/Caption&quot;,
            &quot;text&quot;: &quot;Listed&quot;
        },
        &quot;$:/language/TiddlerInfo/Listed/Empty&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Listed/Empty&quot;,
            &quot;text&quot;: &quot;This tiddler is not listed by any others&quot;
        },
        &quot;$:/language/TiddlerInfo/References/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/References/Caption&quot;,
            &quot;text&quot;: &quot;References&quot;
        },
        &quot;$:/language/TiddlerInfo/References/Empty&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/References/Empty&quot;,
            &quot;text&quot;: &quot;No tiddlers link to this one&quot;
        },
        &quot;$:/language/TiddlerInfo/Tagging/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Tagging/Caption&quot;,
            &quot;text&quot;: &quot;Tagging&quot;
        },
        &quot;$:/language/TiddlerInfo/Tagging/Empty&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Tagging/Empty&quot;,
            &quot;text&quot;: &quot;No tiddlers are tagged with this one&quot;
        },
        &quot;$:/language/TiddlerInfo/Tools/Caption&quot;: {
            &quot;title&quot;: &quot;$:/language/TiddlerInfo/Tools/Caption&quot;,
            &quot;text&quot;: &quot;Tools&quot;
        },
        &quot;$:/language/Docs/Types/application/javascript&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/application/javascript&quot;,
            &quot;description&quot;: &quot;JavaScript code&quot;,
            &quot;name&quot;: &quot;application/javascript&quot;,
            &quot;group&quot;: &quot;Developer&quot;
        },
        &quot;$:/language/Docs/Types/application/json&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/application/json&quot;,
            &quot;description&quot;: &quot;JSON data&quot;,
            &quot;name&quot;: &quot;application/json&quot;,
            &quot;group&quot;: &quot;Developer&quot;
        },
        &quot;$:/language/Docs/Types/application/x-tiddler-dictionary&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/application/x-tiddler-dictionary&quot;,
            &quot;description&quot;: &quot;Data dictionary&quot;,
            &quot;name&quot;: &quot;application/x-tiddler-dictionary&quot;,
            &quot;group&quot;: &quot;Developer&quot;
        },
        &quot;$:/language/Docs/Types/image/gif&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/image/gif&quot;,
            &quot;description&quot;: &quot;GIF image&quot;,
            &quot;name&quot;: &quot;image/gif&quot;,
            &quot;group&quot;: &quot;Image&quot;
        },
        &quot;$:/language/Docs/Types/image/jpeg&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/image/jpeg&quot;,
            &quot;description&quot;: &quot;JPEG image&quot;,
            &quot;name&quot;: &quot;image/jpeg&quot;,
            &quot;group&quot;: &quot;Image&quot;
        },
        &quot;$:/language/Docs/Types/image/png&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/image/png&quot;,
            &quot;description&quot;: &quot;PNG image&quot;,
            &quot;name&quot;: &quot;image/png&quot;,
            &quot;group&quot;: &quot;Image&quot;
        },
        &quot;$:/language/Docs/Types/image/svg+xml&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/image/svg+xml&quot;,
            &quot;description&quot;: &quot;Structured Vector Graphics image&quot;,
            &quot;name&quot;: &quot;image/svg+xml&quot;,
            &quot;group&quot;: &quot;Image&quot;
        },
        &quot;$:/language/Docs/Types/image/x-icon&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/image/x-icon&quot;,
            &quot;description&quot;: &quot;ICO format icon file&quot;,
            &quot;name&quot;: &quot;image/x-icon&quot;,
            &quot;group&quot;: &quot;Image&quot;
        },
        &quot;$:/language/Docs/Types/text/css&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/text/css&quot;,
            &quot;description&quot;: &quot;Static stylesheet&quot;,
            &quot;name&quot;: &quot;text/css&quot;,
            &quot;group&quot;: &quot;Developer&quot;
        },
        &quot;$:/language/Docs/Types/text/html&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/text/html&quot;,
            &quot;description&quot;: &quot;HTML markup&quot;,
            &quot;name&quot;: &quot;text/html&quot;,
            &quot;group&quot;: &quot;Text&quot;
        },
        &quot;$:/language/Docs/Types/text/plain&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/text/plain&quot;,
            &quot;description&quot;: &quot;Plain text&quot;,
            &quot;name&quot;: &quot;text/plain&quot;,
            &quot;group&quot;: &quot;Text&quot;
        },
        &quot;$:/language/Docs/Types/text/vnd.tiddlywiki&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/text/vnd.tiddlywiki&quot;,
            &quot;description&quot;: &quot;TiddlyWiki 5&quot;,
            &quot;name&quot;: &quot;text/vnd.tiddlywiki&quot;,
            &quot;group&quot;: &quot;Text&quot;
        },
        &quot;$:/language/Docs/Types/text/x-tiddlywiki&quot;: {
            &quot;title&quot;: &quot;$:/language/Docs/Types/text/x-tiddlywiki&quot;,
            &quot;description&quot;: &quot;TiddlyWiki Classic&quot;,
            &quot;name&quot;: &quot;text/x-tiddlywiki&quot;,
            &quot;group&quot;: &quot;Text&quot;
        },
        &quot;$:/languages/en-GB/icon&quot;: {
            &quot;title&quot;: &quot;$:/languages/en-GB/icon&quot;,
            &quot;type&quot;: &quot;image/svg+xml&quot;,
            &quot;text&quot;: &quot;&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; viewBox=\&quot;0 0 60 30\&quot; width=\&quot;1200\&quot; height=\&quot;600\&quot;&gt;\n&lt;clipPath id=\&quot;t\&quot;&gt;\n\t&lt;path d=\&quot;M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z\&quot;/&gt;\n&lt;/clipPath&gt;\n&lt;path d=\&quot;M0,0 v30 h60 v-30 z\&quot; fill=\&quot;#00247d\&quot;/&gt;\n&lt;path d=\&quot;M0,0 L60,30 M60,0 L0,30\&quot; stroke=\&quot;#fff\&quot; stroke-width=\&quot;6\&quot;/&gt;\n&lt;path d=\&quot;M0,0 L60,30 M60,0 L0,30\&quot; clip-path=\&quot;url(#t)\&quot; stroke=\&quot;#cf142b\&quot; stroke-width=\&quot;4\&quot;/&gt;\n&lt;path d=\&quot;M30,0 v30 M0,15 h60\&quot; stroke=\&quot;#fff\&quot; stroke-width=\&quot;10\&quot;/&gt;\n&lt;path d=\&quot;M30,0 v30 M0,15 h60\&quot; stroke=\&quot;#cf142b\&quot; stroke-width=\&quot;6\&quot;/&gt;\n&lt;/svg&gt;\n&quot;
        },
        &quot;$:/languages/en-GB&quot;: {
            &quot;title&quot;: &quot;$:/languages/en-GB&quot;,
            &quot;name&quot;: &quot;en-GB&quot;,
            &quot;description&quot;: &quot;English (British)&quot;,
            &quot;author&quot;: &quot;JeremyRuston&quot;,
            &quot;core-version&quot;: &quot;&gt;=5.0.0\&quot;&quot;,
            &quot;text&quot;: &quot;Stub pseudo-plugin for the default language&quot;
        },
        &quot;$:/core/modules/commander.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commander.js\ntype: application/javascript\nmodule-type: global\n\nThe $tw.Commander class is a command interpreter\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nParse a sequence of commands\n\tcommandTokens: an array of command string tokens\n\twiki: reference to the wiki store object\n\tstreams: {output:, error:}, each of which has a write(string) method\n\tcallback: a callback invoked as callback(err) where err is null if there was no error\n*/\nvar Commander = function(commandTokens,callback,wiki,streams) {\n\tvar path = require(\&quot;path\&quot;);\n\tthis.commandTokens = commandTokens;\n\tthis.nextToken = 0;\n\tthis.callback = callback;\n\tthis.wiki = wiki;\n\tthis.streams = streams;\n\tthis.outputPath = path.resolve($tw.boot.wikiPath,$tw.config.wikiOutputSubDir);\n};\n\n/*\nAdd a string of tokens to the command queue\n*/\nCommander.prototype.addCommandTokens = function(commandTokens) {\n\tvar params = commandTokens.slice(0);\n\tparams.unshift(0);\n\tparams.unshift(this.nextToken);\n\tArray.prototype.splice.apply(this.commandTokens,params);\n};\n\n/*\nExecute the sequence of commands and invoke a callback on completion\n*/\nCommander.prototype.execute = function() {\n\tthis.executeNextCommand();\n};\n\n/*\nExecute the next command in the sequence\n*/\nCommander.prototype.executeNextCommand = function() {\n\tvar self = this;\n\t// Invoke the callback if there are no more commands\n\tif(this.nextToken &gt;= this.commandTokens.length) {\n\t\tthis.callback(null);\n\t} else {\n\t\t// Get and check the command token\n\t\tvar commandName = this.commandTokens[this.nextToken++];\n\t\tif(commandName.substr(0,2) !== \&quot;--\&quot;) {\n\t\t\tthis.callback(\&quot;Missing command: \&quot; + commandName);\n\t\t} else {\n\t\t\tcommandName = commandName.substr(2); // Trim off the --\n\t\t\t// Accumulate the parameters to the command\n\t\t\tvar params = [];\n\t\t\twhile(this.nextToken &lt; this.commandTokens.length &amp;&amp; \n\t\t\t\tthis.commandTokens[this.nextToken].substr(0,2) !== \&quot;--\&quot;) {\n\t\t\t\tparams.push(this.commandTokens[this.nextToken++]);\n\t\t\t}\n\t\t\t// Get the command info\n\t\t\tvar command = $tw.commands[commandName],\n\t\t\t\tc,err;\n\t\t\tif(!command) {\n\t\t\t\tthis.callback(\&quot;Unknown command: \&quot; + commandName);\n\t\t\t} else {\n\t\t\t\tif(this.verbose) {\n\t\t\t\t\tthis.streams.output.write(\&quot;Executing command: \&quot; + commandName + \&quot; \&quot; + params.join(\&quot; \&quot;) + \&quot;\\n\&quot;);\n\t\t\t\t}\n\t\t\t\tif(command.info.synchronous) {\n\t\t\t\t\t// Synchronous command\n\t\t\t\t\tc = new command.Command(params,this);\n\t\t\t\t\terr = c.execute();\n\t\t\t\t\tif(err) {\n\t\t\t\t\t\tthis.callback(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.executeNextCommand();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Asynchronous command\n\t\t\t\t\tc = new command.Command(params,this,function(err) {\n\t\t\t\t\t\tif(err) {\n\t\t\t\t\t\t\tself.callback(err);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.executeNextCommand();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\terr = c.execute();\n\t\t\t\t\tif(err) {\n\t\t\t\t\t\tthis.callback(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nCommander.initCommands = function(moduleType) {\n\tmoduleType = moduleType || \&quot;command\&quot;;\n\t$tw.commands = {};\n\t$tw.modules.forEachModuleOfType(moduleType,function(title,module) {\n\t\tvar c = $tw.commands[module.info.name] = {};\n\t\t// Add the methods defined by the module\n\t\tfor(var f in module) {\n\t\t\tif($tw.utils.hop(module,f)) {\n\t\t\t\tc[f] = module[f];\n\t\t\t}\n\t\t}\n\t});\n};\n\nexports.Commander = Commander;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commander.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;global&quot;
        },
        &quot;$:/core/modules/commands/build.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/build.js\ntype: application/javascript\nmodule-type: command\n\nCommand to build a build target\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;build\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander) {\n\tthis.params = params;\n\tthis.commander = commander;\n};\n\nCommand.prototype.execute = function() {\n\t// Get the build targets defined in the wiki\n\tvar buildTargets = $tw.boot.wikiInfo.build;\n\tif(!buildTargets) {\n\t\treturn \&quot;No build targets defined\&quot;;\n\t}\n\t// Loop through each of the specified targets\n\tvar targets;\n\tif(this.params.length &gt; 0) {\n\t\ttargets = this.params;\n\t} else {\n\t\ttargets = Object.keys(buildTargets);\n\t}\n\tfor(var targetIndex=0; targetIndex&lt;targets.length; targetIndex++) {\n\t\tvar target = targets[targetIndex],\n\t\t\tcommands = buildTargets[target];\n\t\tif(!commands) {\n\t\t\treturn \&quot;Build target '\&quot; + target + \&quot;' not found\&quot;;\n\t\t}\n\t\t// Add the commands to the queue\n\t\tthis.commander.addCommandTokens(commands);\n\t}\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/build.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/clearpassword.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/clearpassword.js\ntype: application/javascript\nmodule-type: command\n\nClear password for crypto operations\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;clearpassword\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\t$tw.crypto.setPassword(null);\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/clearpassword.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/editions.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/editions.js\ntype: application/javascript\nmodule-type: command\n\nCommand to list the available editions\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;editions\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander) {\n\tthis.params = params;\n\tthis.commander = commander;\n};\n\nCommand.prototype.execute = function() {\n\tvar fs = require(\&quot;fs\&quot;),\n\t\tpath = require(\&quot;path\&quot;),\n\t\tself = this;\n\t// Enumerate the edition paths\n\tvar editionPaths = $tw.getLibraryItemSearchPaths($tw.config.editionsPath,$tw.config.editionsEnvVar),\n\t\teditions = {};\n\tfor(var editionIndex=0; editionIndex&lt;editionPaths.length; editionIndex++) {\n\t\tvar editionPath = editionPaths[editionIndex];\n\t\t// Enumerate the folders\n\t\tvar entries = fs.readdirSync(editionPath);\n\t\tfor(var entryIndex=0; entryIndex&lt;entries.length; entryIndex++) {\n\t\t\tvar entry = entries[entryIndex];\n\t\t\t// Check if directories have a valid tiddlywiki.info\n\t\t\tif(!editions[entry] &amp;&amp; $tw.utils.isDirectory(path.resolve(editionPath,entry))) {\n\t\t\t\tvar info;\n\t\t\t\ttry {\n\t\t\t\t\tinfo = JSON.parse(fs.readFileSync(path.resolve(editionPath,entry,\&quot;tiddlywiki.info\&quot;),\&quot;utf8\&quot;));\n\t\t\t\t} catch(ex) {\n\t\t\t\t}\n\t\t\t\tif(info) {\n\t\t\t\t\teditions[entry] = info.description || \&quot;\&quot;;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Output the list\n\tthis.commander.streams.output.write(\&quot;Available editions:\\n\\n\&quot;);\n\t$tw.utils.each(editions,function(description,name) {\n\t\tself.commander.streams.output.write(\&quot;    \&quot; + name + \&quot;: \&quot; + description + \&quot;\\n\&quot;);\n\t});\n\tthis.commander.streams.output.write(\&quot;\\n\&quot;);\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/editions.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/help.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/help.js\ntype: application/javascript\nmodule-type: command\n\nHelp command\n\n\\*/\n(function(){\n\n/*jshint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;help\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander) {\n\tthis.params = params;\n\tthis.commander = commander;\n};\n\nCommand.prototype.execute = function() {\n\tvar subhelp = this.params[0] || \&quot;default\&quot;,\n\t\thelpBase = \&quot;$:/language/Help/\&quot;,\n\t\ttext;\n\tif(!this.commander.wiki.getTiddler(helpBase + subhelp)) {\n\t\tsubhelp = \&quot;notfound\&quot;;\n\t}\n\t// Wikify the help as formatted text (ie block elements generate newlines)\n\ttext = this.commander.wiki.renderTiddler(\&quot;text/plain-formatted\&quot;,helpBase + subhelp);\n\t// Remove any leading linebreaks\n\ttext = text.replace(/^(\\r?\\n)*/g,\&quot;\&quot;);\n\tthis.commander.streams.output.write(text);\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/help.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/init.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/init.js\ntype: application/javascript\nmodule-type: command\n\nCommand to initialise an empty wiki folder\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;init\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander) {\n\tthis.params = params;\n\tthis.commander = commander;\n};\n\nCommand.prototype.execute = function() {\n\tvar fs = require(\&quot;fs\&quot;),\n\t\tpath = require(\&quot;path\&quot;);\n\t// Check that we don't already have a valid wiki folder\n\tif($tw.boot.wikiTiddlersPath || ($tw.utils.isDirectory($tw.boot.wikiPath) &amp;&amp; !$tw.utils.isDirectoryEmpty($tw.boot.wikiPath))) {\n\t\treturn \&quot;Wiki folder is not empty\&quot;;\n\t}\n\t// Loop through each of the specified editions\n\tvar editions = this.params.length &gt; 0 ? this.params : [\&quot;empty\&quot;];\n\tfor(var editionIndex=0; editionIndex&lt;editions.length; editionIndex++) {\n\t\tvar editionName = editions[editionIndex];\n\t\t// Check the edition exists\n\t\tvar editionPath = $tw.findLibraryItem(editionName,$tw.getLibraryItemSearchPaths($tw.config.editionsPath,$tw.config.editionsEnvVar));\n\t\tif(!$tw.utils.isDirectory(editionPath)) {\n\t\t\treturn \&quot;Edition '\&quot; + editionName + \&quot;' not found\&quot;;\n\t\t}\n\t\t// Copy the edition content\n\t\tvar err = $tw.utils.copyDirectory(editionPath,$tw.boot.wikiPath);\n\t\tif(!err) {\n\t\t\tthis.commander.streams.output.write(\&quot;Copied edition '\&quot; + editionName + \&quot;' to \&quot; + $tw.boot.wikiPath + \&quot;\\n\&quot;);\n\t\t} else {\n\t\t\treturn err;\n\t\t}\n\t}\n\t// Tweak the tiddlywiki.info to remove any included wikis\n\tvar packagePath = $tw.boot.wikiPath + \&quot;/tiddlywiki.info\&quot;,\n\t\tpackageJson = JSON.parse(fs.readFileSync(packagePath));\n\tdelete packageJson.includeWikis;\n\tfs.writeFileSync(packagePath,JSON.stringify(packageJson,null,$tw.config.preferences.jsonSpaces));\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/init.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/load.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/load.js\ntype: application/javascript\nmodule-type: command\n\nCommand to load tiddlers from a file\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;load\&quot;,\n\tsynchronous: false\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tvar self = this,\n\t\tfs = require(\&quot;fs\&quot;),\n\t\tpath = require(\&quot;path\&quot;);\n\tif(this.params.length &lt; 1) {\n\t\treturn \&quot;Missing filename\&quot;;\n\t}\n\tvar ext = path.extname(self.params[0]);\n\tfs.readFile(this.params[0],$tw.utils.getTypeEncoding(ext),function(err,data) {\n\t\tif (err) {\n\t\t\tself.callback(err);\n\t\t} else {\n\t\t\tvar fields = {title: self.params[0]},\n\t\t\t\ttype = path.extname(self.params[0]);\n\t\t\tvar tiddlers = self.commander.wiki.deserializeTiddlers(type,data,fields);\n\t\t\tif(!tiddlers) {\n\t\t\t\tself.callback(\&quot;No tiddlers found in file \\\&quot;\&quot; + self.params[0] + \&quot;\\\&quot;\&quot;);\n\t\t\t} else {\n\t\t\t\tfor(var t=0; t&lt;tiddlers.length; t++) {\n\t\t\t\t\tself.commander.wiki.importTiddler(new $tw.Tiddler(tiddlers[t]));\n\t\t\t\t}\n\t\t\t\tself.callback(null);\t\n\t\t\t}\n\t\t}\n\t});\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/load.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/makelibrary.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/makelibrary.js\ntype: application/javascript\nmodule-type: command\n\nCommand to pack all of the plugins in the library into a plugin tiddler of type \&quot;library\&quot;\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;makelibrary\&quot;,\n\tsynchronous: true\n};\n\nvar UPGRADE_LIBRARY_TITLE = \&quot;$:/UpgradeLibrary\&quot;;\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tvar wiki = this.commander.wiki,\n\t\tfs = require(\&quot;fs\&quot;),\n\t\tpath = require(\&quot;path\&quot;),\n\t\tupgradeLibraryTitle = this.params[0] || UPGRADE_LIBRARY_TITLE,\n\t\ttiddlers = {};\n\t// Collect up the library plugins\n\tvar collectPlugins = function(folder) {\n\t\t\tvar pluginFolders = fs.readdirSync(folder);\n\t\t\tfor(var p=0; p&lt;pluginFolders.length; p++) {\n\t\t\t\tif(!$tw.boot.excludeRegExp.test(pluginFolders[p])) {\n\t\t\t\t\tpluginFields = $tw.loadPluginFolder(path.resolve(folder,\&quot;./\&quot; + pluginFolders[p]));\n\t\t\t\t\tif(pluginFields &amp;&amp; pluginFields.title) {\n\t\t\t\t\t\ttiddlers[pluginFields.title] = pluginFields;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcollectPublisherPlugins = function(folder) {\n\t\t\tvar publisherFolders = fs.readdirSync(folder);\n\t\t\tfor(var t=0; t&lt;publisherFolders.length; t++) {\n\t\t\t\tif(!$tw.boot.excludeRegExp.test(publisherFolders[t])) {\n\t\t\t\t\tcollectPlugins(path.resolve(folder,\&quot;./\&quot; + publisherFolders[t]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\tcollectPublisherPlugins(path.resolve($tw.boot.corePath,$tw.config.pluginsPath));\n\tcollectPublisherPlugins(path.resolve($tw.boot.corePath,$tw.config.themesPath));\n\tcollectPlugins(path.resolve($tw.boot.corePath,$tw.config.languagesPath));\n\t// Save the upgrade library tiddler\n\tvar pluginFields = {\n\t\ttitle: upgradeLibraryTitle,\n\t\ttype: \&quot;application/json\&quot;,\n\t\t\&quot;plugin-type\&quot;: \&quot;library\&quot;,\n\t\t\&quot;text\&quot;: JSON.stringify({tiddlers: tiddlers},null,$tw.config.preferences.jsonSpaces)\n\t};\n\twiki.addTiddler(new $tw.Tiddler(pluginFields));\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/makelibrary.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/output.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/output.js\ntype: application/javascript\nmodule-type: command\n\nCommand to set the default output location (defaults to current working directory)\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;output\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tvar fs = require(\&quot;fs\&quot;),\n\t\tpath = require(\&quot;path\&quot;);\n\tif(this.params.length &lt; 1) {\n\t\treturn \&quot;Missing output path\&quot;;\n\t}\n\tthis.commander.outputPath = path.resolve(process.cwd(),this.params[0]);\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/output.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/password.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/password.js\ntype: application/javascript\nmodule-type: command\n\nSave password for crypto operations\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;password\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tif(this.params.length &lt; 1) {\n\t\treturn \&quot;Missing password\&quot;;\n\t}\n\t$tw.crypto.setPassword(this.params[0]);\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/password.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/rendertiddler.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/rendertiddler.js\ntype: application/javascript\nmodule-type: command\n\nCommand to render a tiddler and save it to a file\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;rendertiddler\&quot;,\n\tsynchronous: false\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tif(this.params.length &lt; 2) {\n\t\treturn \&quot;Missing filename\&quot;;\n\t}\n\tvar self = this,\n\t\tfs = require(\&quot;fs\&quot;),\n\t\tpath = require(\&quot;path\&quot;),\n\t\ttitle = this.params[0],\n\t\tfilename = path.resolve(this.commander.outputPath,this.params[1]),\n\t\ttype = this.params[2] || \&quot;text/html\&quot;;\n\t$tw.utils.createFileDirectories(filename);\n\tfs.writeFile(filename,this.commander.wiki.renderTiddler(type,title),\&quot;utf8\&quot;,function(err) {\n\t\tself.callback(err);\n\t});\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/rendertiddler.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/rendertiddlers.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/rendertiddlers.js\ntype: application/javascript\nmodule-type: command\n\nCommand to render several tiddlers to a folder of files\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;);\n\nexports.info = {\n\tname: \&quot;rendertiddlers\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tif(this.params.length &lt; 2) {\n\t\treturn \&quot;Missing filename\&quot;;\n\t}\n\tvar self = this,\n\t\tfs = require(\&quot;fs\&quot;),\n\t\tpath = require(\&quot;path\&quot;),\n\t\twiki = this.commander.wiki,\n\t\tfilter = this.params[0],\n\t\ttemplate = this.params[1],\n\t\tpathname = path.resolve(this.commander.outputPath,this.params[2]),\n\t\ttype = this.params[3] || \&quot;text/html\&quot;,\n\t\textension = this.params[4] || \&quot;.html\&quot;,\n\t\ttiddlers = wiki.filterTiddlers(filter);\n\t$tw.utils.deleteDirectory(pathname);\n\t$tw.utils.createDirectory(pathname);\n\t$tw.utils.each(tiddlers,function(title) {\n\t\tvar parser = wiki.parseTiddler(template),\n\t\t\twidgetNode = wiki.makeWidget(parser,{variables: {currentTiddler: title}});\n\t\tvar container = $tw.fakeDocument.createElement(\&quot;div\&quot;);\n\t\twidgetNode.render(container,null);\n\t\tvar text = type === \&quot;text/html\&quot; ? container.innerHTML : container.textContent;\n\t\tfs.writeFileSync(path.resolve(pathname,encodeURIComponent(title) + extension),text,\&quot;utf8\&quot;);\n\t});\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/rendertiddlers.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/savetiddler.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/savetiddler.js\ntype: application/javascript\nmodule-type: command\n\nCommand to save the content of a tiddler to a file\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;savetiddler\&quot;,\n\tsynchronous: false\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tif(this.params.length &lt; 2) {\n\t\treturn \&quot;Missing filename\&quot;;\n\t}\n\tvar self = this,\n\t\tfs = require(\&quot;fs\&quot;),\n\t\tpath = require(\&quot;path\&quot;),\n\t\ttitle = this.params[0],\n\t\tfilename = path.resolve(this.commander.outputPath,this.params[1]),\n\t\ttiddler = this.commander.wiki.getTiddler(title),\n\t\ttype = tiddler.fields.type || \&quot;text/vnd.tiddlywiki\&quot;,\n\t\tcontentTypeInfo = $tw.config.contentTypeInfo[type] || {encoding: \&quot;utf8\&quot;};\n\t$tw.utils.createFileDirectories(filename);\n\tfs.writeFile(filename,tiddler.fields.text,contentTypeInfo.encoding,function(err) {\n\t\tself.callback(err);\n\t});\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/savetiddler.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/savetiddlers.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/savetiddlers.js\ntype: application/javascript\nmodule-type: command\n\nCommand to save several tiddlers to a folder of files\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;);\n\nexports.info = {\n\tname: \&quot;savetiddlers\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tif(this.params.length &lt; 1) {\n\t\treturn \&quot;Missing filename\&quot;;\n\t}\n\tvar self = this,\n\t\tfs = require(\&quot;fs\&quot;),\n\t\tpath = require(\&quot;path\&quot;),\n\t\twiki = this.commander.wiki,\n\t\tfilter = this.params[0],\n\t\tpathname = path.resolve(this.commander.outputPath,this.params[1]),\n\t\ttiddlers = wiki.filterTiddlers(filter);\n\t$tw.utils.deleteDirectory(pathname);\n\t$tw.utils.createDirectory(pathname);\n\t$tw.utils.each(tiddlers,function(title) {\n\t\tvar tiddler = self.commander.wiki.getTiddler(title),\n\t\t\ttype = tiddler.fields.type || \&quot;text/vnd.tiddlywiki\&quot;,\n\t\t\tcontentTypeInfo = $tw.config.contentTypeInfo[type] || {encoding: \&quot;utf8\&quot;},\n\t\t\tfilename = path.resolve(pathname,encodeURIComponent(title));\n\t\tfs.writeFileSync(filename,tiddler.fields.text,contentTypeInfo.encoding);\n\t});\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/savetiddlers.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/server.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/server.js\ntype: application/javascript\nmodule-type: command\n\nServe tiddlers over http\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nif(!$tw.browser) {\n\tvar util = require(\&quot;util\&quot;),\n\t\tfs = require(\&quot;fs\&quot;),\n\t\turl = require(\&quot;url\&quot;),\n\t\tpath = require(\&quot;path\&quot;),\n\t\thttp = require(\&quot;http\&quot;);\n}\n\nexports.info = {\n\tname: \&quot;server\&quot;,\n\tsynchronous: true\n};\n\n/*\nA simple HTTP server with regexp-based routes\n*/\nfunction SimpleServer(options) {\n\tthis.routes = options.routes || [];\n\tthis.wiki = options.wiki;\n\tthis.variables = options.variables || {};\n}\n\nSimpleServer.prototype.set = function(obj) {\n\tvar self = this;\n\t$tw.utils.each(obj,function(value,name) {\n\t\tself.variables[name] = value;\n\t});\n};\n\nSimpleServer.prototype.get = function(name) {\n\treturn this.variables[name];\n};\n\nSimpleServer.prototype.addRoute = function(route) {\n\tthis.routes.push(route);\n};\n\nSimpleServer.prototype.findMatchingRoute = function(request,state) {\n\tvar pathprefix = this.get(\&quot;pathprefix\&quot;) || \&quot;\&quot;;\n\tfor(var t=0; t&lt;this.routes.length; t++) {\n\t\tvar potentialRoute = this.routes[t],\n\t\t\tpathRegExp = potentialRoute.path,\n\t\t\tpathname = state.urlInfo.pathname,\n\t\t\tmatch;\n\t\tif(pathprefix) {\n\t\t\tif(pathname.substr(0,pathprefix.length) === pathprefix) {\n\t\t\t\tpathname = pathname.substr(pathprefix.length);\n\t\t\t\tmatch = potentialRoute.path.exec(pathname);\n\t\t\t} else {\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t} else {\n\t\t\tmatch = potentialRoute.path.exec(pathname);\n\t\t}\n\t\tif(match &amp;&amp; request.method === potentialRoute.method) {\n\t\t\tstate.params = [];\n\t\t\tfor(var p=1; p&lt;match.length; p++) {\n\t\t\t\tstate.params.push(match[p]);\n\t\t\t}\n\t\t\treturn potentialRoute;\n\t\t}\n\t}\n\treturn null;\n};\n\nSimpleServer.prototype.checkCredentials = function(request,incomingUsername,incomingPassword) {\n\tvar header = request.headers.authorization || \&quot;\&quot;,\n\t\ttoken = header.split(/\\s+/).pop() || \&quot;\&quot;,\n\t\tauth = $tw.utils.base64Decode(token),\n\t\tparts = auth.split(/:/),\n\t\tusername = parts[0],\n\t\tpassword = parts[1];\n\tif(incomingUsername === username &amp;&amp; incomingPassword === password) {\n\t\treturn \&quot;ALLOWED\&quot;;\n\t} else {\n\t\treturn \&quot;DENIED\&quot;;\n\t}\n};\n\nSimpleServer.prototype.listen = function(port,host) {\n\tvar self = this;\n\thttp.createServer(function(request,response) {\n\t\t// Compose the state object\n\t\tvar state = {};\n\t\tstate.wiki = self.wiki;\n\t\tstate.server = self;\n\t\tstate.urlInfo = url.parse(request.url);\n\t\t// Find the route that matches this path\n\t\tvar route = self.findMatchingRoute(request,state);\n\t\t// Check for the username and password if we've got one\n\t\tvar username = self.get(\&quot;username\&quot;),\n\t\t\tpassword = self.get(\&quot;password\&quot;);\n\t\tif(username &amp;&amp; password) {\n\t\t\t// Check they match\n\t\t\tif(self.checkCredentials(request,username,password) !== \&quot;ALLOWED\&quot;) {\n\t\t\t\tvar servername = state.wiki.getTiddlerText(\&quot;$:/SiteTitle\&quot;) || \&quot;TiddlyWiki5\&quot;;\n\t\t\t\tresponse.writeHead(401,\&quot;Authentication required\&quot;,{\n\t\t\t\t\t\&quot;WWW-Authenticate\&quot;: 'Basic realm=\&quot;Please provide your username and password to login to ' + servername + '\&quot;'\n\t\t\t\t});\n\t\t\t\tresponse.end();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t// Return a 404 if we didn't find a route\n\t\tif(!route) {\n\t\t\tresponse.writeHead(404);\n\t\t\tresponse.end();\n\t\t\treturn;\n\t\t}\n\t\t// Set the encoding for the incoming request\n\t\t// TODO: Presumably this would need tweaking if we supported PUTting binary tiddlers\n\t\trequest.setEncoding(\&quot;utf8\&quot;);\n\t\t// Dispatch the appropriate method\n\t\tswitch(request.method) {\n\t\t\tcase \&quot;GET\&quot;: // Intentional fall-through\n\t\t\tcase \&quot;DELETE\&quot;:\n\t\t\t\troute.handler(request,response,state);\n\t\t\t\tbreak;\n\t\t\tcase \&quot;PUT\&quot;:\n\t\t\t\tvar data = \&quot;\&quot;;\n\t\t\t\trequest.on(\&quot;data\&quot;,function(chunk) {\n\t\t\t\t\tdata += chunk.toString();\n\t\t\t\t});\n\t\t\t\trequest.on(\&quot;end\&quot;,function() {\n\t\t\t\t\tstate.data = data;\n\t\t\t\t\troute.handler(request,response,state);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t}\n\t}).listen(port,host);\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n\t// Set up server\n\tthis.server = new SimpleServer({\n\t\twiki: this.commander.wiki\n\t});\n\t// Add route handlers\n\tthis.server.addRoute({\n\t\tmethod: \&quot;PUT\&quot;,\n\t\tpath: /^\\/recipes\\/default\\/tiddlers\\/(.+)$/,\n\t\thandler: function(request,response,state) {\n\t\t\tvar title = decodeURIComponent(state.params[0]),\n\t\t\t\tfields = JSON.parse(state.data);\n\t\t\t// Pull up any subfields in the `fields` object\n\t\t\tif(fields.fields) {\n\t\t\t\t$tw.utils.each(fields.fields,function(field,name) {\n\t\t\t\t\tfields[name] = field;\n\t\t\t\t});\n\t\t\t\tdelete fields.fields;\n\t\t\t}\n\t\t\t// Remove any revision field\n\t\t\tif(fields.revision) {\n\t\t\t\tdelete fields.revision;\n\t\t\t}\n\t\t\tstate.wiki.addTiddler(new $tw.Tiddler(state.wiki.getCreationFields(),fields,{title: title}));\n\t\t\tvar changeCount = state.wiki.getChangeCount(title).toString();\n\t\t\tresponse.writeHead(204, \&quot;OK\&quot;,{\n\t\t\t\tEtag: \&quot;\\\&quot;default/\&quot; + encodeURIComponent(title) + \&quot;/\&quot; + changeCount + \&quot;:\\\&quot;\&quot;,\n\t\t\t\t\&quot;Content-Type\&quot;: \&quot;text/plain\&quot;\n\t\t\t});\n\t\t\tresponse.end();\n\t\t}\n\t});\n\tthis.server.addRoute({\n\t\tmethod: \&quot;DELETE\&quot;,\n\t\tpath: /^\\/bags\\/default\\/tiddlers\\/(.+)$/,\n\t\thandler: function(request,response,state) {\n\t\t\tvar title = decodeURIComponent(state.params[0]);\n\t\t\tstate.wiki.deleteTiddler(title);\n\t\t\tresponse.writeHead(204, \&quot;OK\&quot;, {\n\t\t\t\t\&quot;Content-Type\&quot;: \&quot;text/plain\&quot;\n\t\t\t});\n\t\t\tresponse.end();\n\t\t}\n\t});\n\tthis.server.addRoute({\n\t\tmethod: \&quot;GET\&quot;,\n\t\tpath: /^\\/$/,\n\t\thandler: function(request,response,state) {\n\t\t\tresponse.writeHead(200, {\&quot;Content-Type\&quot;: state.server.get(\&quot;serveType\&quot;)});\n\t\t\tvar text = state.wiki.renderTiddler(state.server.get(\&quot;renderType\&quot;),state.server.get(\&quot;rootTiddler\&quot;));\n\t\t\tresponse.end(text,\&quot;utf8\&quot;);\n\t\t}\n\t});\n\tthis.server.addRoute({\n\t\tmethod: \&quot;GET\&quot;,\n\t\tpath: /^\\/status$/,\n\t\thandler: function(request,response,state) {\n\t\t\tresponse.writeHead(200, {\&quot;Content-Type\&quot;: \&quot;application/json\&quot;});\n\t\t\tvar text = JSON.stringify({\n\t\t\t\tusername: state.server.get(\&quot;username\&quot;),\n\t\t\t\tspace: {\n\t\t\t\t\trecipe: \&quot;default\&quot;\n\t\t\t\t},\n\t\t\t\ttiddlywiki_version: $tw.version\n\t\t\t});\n\t\t\tresponse.end(text,\&quot;utf8\&quot;);\n\t\t}\n\t});\n\tthis.server.addRoute({\n\t\tmethod: \&quot;GET\&quot;,\n\t\tpath: /^\\/favicon.ico$/,\n\t\thandler: function(request,response,state) {\n\t\t\tresponse.writeHead(200, {\&quot;Content-Type\&quot;: \&quot;image/x-icon\&quot;});\n\t\t\tvar buffer = state.wiki.getTiddlerText(\&quot;$:/favicon.ico\&quot;,\&quot;\&quot;);\n\t\t\tresponse.end(buffer,\&quot;base64\&quot;);\n\t\t}\n\t});\n\tthis.server.addRoute({\n\t\tmethod: \&quot;GET\&quot;,\n\t\tpath: /^\\/recipes\\/default\\/tiddlers.json$/,\n\t\thandler: function(request,response,state) {\n\t\t\tresponse.writeHead(200, {\&quot;Content-Type\&quot;: \&quot;application/json\&quot;});\n\t\t\tvar tiddlers = [];\n\t\t\tstate.wiki.forEachTiddler({sortField: \&quot;title\&quot;},function(title,tiddler) {\n\t\t\t\tvar tiddlerFields = {};\n\t\t\t\t$tw.utils.each(tiddler.fields,function(field,name) {\n\t\t\t\t\tif(name !== \&quot;text\&quot;) {\n\t\t\t\t\t\ttiddlerFields[name] = tiddler.getFieldString(name);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\ttiddlerFields.revision = state.wiki.getChangeCount(title);\n\t\t\t\ttiddlerFields.type = tiddlerFields.type || \&quot;text/vnd.tiddlywiki\&quot;;\n\t\t\t\ttiddlers.push(tiddlerFields);\n\t\t\t});\n\t\t\tvar text = JSON.stringify(tiddlers);\n\t\t\tresponse.end(text,\&quot;utf8\&quot;);\n\t\t}\n\t});\n\tthis.server.addRoute({\n\t\tmethod: \&quot;GET\&quot;,\n\t\tpath: /^\\/recipes\\/default\\/tiddlers\\/(.+)$/,\n\t\thandler: function(request,response,state) {\n\t\t\tvar title = decodeURIComponent(state.params[0]),\n\t\t\t\ttiddler = state.wiki.getTiddler(title),\n\t\t\t\ttiddlerFields = {},\n\t\t\t\tknownFields = [\n\t\t\t\t\t\&quot;bag\&quot;, \&quot;created\&quot;, \&quot;creator\&quot;, \&quot;modified\&quot;, \&quot;modifier\&quot;, \&quot;permissions\&quot;, \&quot;recipe\&quot;, \&quot;revision\&quot;, \&quot;tags\&quot;, \&quot;text\&quot;, \&quot;title\&quot;, \&quot;type\&quot;, \&quot;uri\&quot;\n\t\t\t\t];\n\t\t\tif(tiddler) {\n\t\t\t\t$tw.utils.each(tiddler.fields,function(field,name) {\n\t\t\t\t\tvar value = tiddler.getFieldString(name);\n\t\t\t\t\tif(knownFields.indexOf(name) !== -1) {\n\t\t\t\t\t\ttiddlerFields[name] = value;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttiddlerFields.fields = tiddlerFields.fields || {};\n\t\t\t\t\t\ttiddlerFields.fields[name] = value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\ttiddlerFields.revision = state.wiki.getChangeCount(title);\n\t\t\t\ttiddlerFields.type = tiddlerFields.type || \&quot;text/vnd.tiddlywiki\&quot;;\n\t\t\t\tresponse.writeHead(200, {\&quot;Content-Type\&quot;: \&quot;application/json\&quot;});\n\t\t\t\tresponse.end(JSON.stringify(tiddlerFields),\&quot;utf8\&quot;);\n\t\t\t} else {\n\t\t\t\tresponse.writeHead(404);\n\t\t\t\tresponse.end();\n\t\t\t}\n\t\t}\n\t});\n};\n\nCommand.prototype.execute = function() {\n\tif(!$tw.boot.wikiTiddlersPath) {\n\t\t$tw.utils.warning(\&quot;Warning: Wiki folder '\&quot; + $tw.boot.wikiPath + \&quot;' does not exist or is missing a tiddlywiki.info file\&quot;);\n\t}\n\tvar port = this.params[0] || \&quot;8080\&quot;,\n\t\trootTiddler = this.params[1] || \&quot;$:/core/save/all\&quot;,\n\t\trenderType = this.params[2] || \&quot;text/plain\&quot;,\n\t\tserveType = this.params[3] || \&quot;text/html\&quot;,\n\t\tusername = this.params[4],\n\t\tpassword = this.params[5],\n\t\thost = this.params[6] || \&quot;127.0.0.1\&quot;,\n\t\tpathprefix = this.params[7];\n\tthis.server.set({\n\t\trootTiddler: rootTiddler,\n\t\trenderType: renderType,\n\t\tserveType: serveType,\n\t\tusername: username,\n\t\tpassword: password,\n\t\tpathprefix: pathprefix\n\t});\n\tthis.server.listen(port,host);\n\tconsole.log(\&quot;Serving on \&quot; + host + \&quot;:\&quot; + port);\n\tconsole.log(\&quot;(press ctrl-C to exit)\&quot;);\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/server.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/setfield.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/setfield.js\ntype: application/javascript\nmodule-type: command\n\nCommand to modify selected tiddlers to set a field to the text of a template tiddler that has been wikified with the selected tiddler as the current tiddler.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;);\n\nexports.info = {\n\tname: \&quot;setfield\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tif(this.params.length &lt; 4) {\n\t\treturn \&quot;Missing parameters\&quot;;\n\t}\n\tvar self = this,\n\t\twiki = this.commander.wiki,\n\t\tfilter = this.params[0],\n\t\tfieldname = this.params[1] || \&quot;text\&quot;,\n\t\ttemplatetitle = this.params[2],\n\t\trendertype = this.params[3] || \&quot;text/plain\&quot;,\n\t\ttiddlers = wiki.filterTiddlers(filter);\n\t$tw.utils.each(tiddlers,function(title) {\n\t\tvar parser = wiki.parseTiddler(templatetitle),\n\t\t\tnewFields = {},\n\t\t\ttiddler = wiki.getTiddler(title);\n\t\tif(parser) {\n\t\t\tvar widgetNode = wiki.makeWidget(parser,{variables: {currentTiddler: title}});\n\t\t\tvar container = $tw.fakeDocument.createElement(\&quot;div\&quot;);\n\t\t\twidgetNode.render(container,null);\n\t\t\tnewFields[fieldname] = rendertype === \&quot;text/html\&quot; ? container.innerHTML : container.textContent;\n\t\t} else {\n\t\t\tnewFields[fieldname] = undefined;\n\t\t}\n\t\twiki.addTiddler(new $tw.Tiddler(tiddler,newFields));\n\t});\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/setfield.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/unpackplugin.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/unpackplugin.js\ntype: application/javascript\nmodule-type: command\n\nCommand to extract the shadow tiddlers from within a plugin\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;unpackplugin\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander,callback) {\n\tthis.params = params;\n\tthis.commander = commander;\n\tthis.callback = callback;\n};\n\nCommand.prototype.execute = function() {\n\tif(this.params.length &lt; 1) {\n\t\treturn \&quot;Missing plugin name\&quot;;\n\t}\n\tvar self = this,\n\t\ttitle = this.params[0],\n\t\tpluginData = this.commander.wiki.getTiddlerData(title);\n\tif(!pluginData) {\n\t\treturn \&quot;Plugin '\&quot; + title + \&quot;' not found\&quot;;\n\t}\n\t$tw.utils.each(pluginData.tiddlers,function(tiddler) {\n\t\tself.commander.wiki.addTiddler(new $tw.Tiddler(tiddler));\n\t});\n\treturn null;\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/unpackplugin.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/verbose.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/verbose.js\ntype: application/javascript\nmodule-type: command\n\nVerbose command\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;verbose\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander) {\n\tthis.params = params;\n\tthis.commander = commander;\n};\n\nCommand.prototype.execute = function() {\n\tthis.commander.verbose = true;\n\t// Output the boot message log\n\tthis.commander.streams.output.write(\&quot;Boot log:\\n  \&quot; + $tw.boot.logMessages.join(\&quot;\\n  \&quot;) + \&quot;\\n\&quot;);\n\treturn null; // No error\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/verbose.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/commands/version.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/commands/version.js\ntype: application/javascript\nmodule-type: command\n\nVersion command\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.info = {\n\tname: \&quot;version\&quot;,\n\tsynchronous: true\n};\n\nvar Command = function(params,commander) {\n\tthis.params = params;\n\tthis.commander = commander;\n};\n\nCommand.prototype.execute = function() {\n\tthis.commander.streams.output.write($tw.version + \&quot;\\n\&quot;);\n\treturn null; // No error\n};\n\nexports.Command = Command;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/commands/version.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;command&quot;
        },
        &quot;$:/core/modules/config.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/config.js\ntype: application/javascript\nmodule-type: config\n\nCore configuration constants\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.preferences = {};\n\nexports.preferences.notificationDuration = 3 * 1000;\nexports.preferences.jsonSpaces = 4;\n\nexports.textPrimitives = {\n\tupperLetter: \&quot;[A-Z\\u00c0-\\u00d6\\u00d8-\\u00de\\u0150\\u0170]\&quot;,\n\tlowerLetter: \&quot;[a-z\\u00df-\\u00f6\\u00f8-\\u00ff\\u0151\\u0171]\&quot;,\n\tanyLetter:   \&quot;[A-Za-z0-9\\u00c0-\\u00d6\\u00d8-\\u00de\\u00df-\\u00f6\\u00f8-\\u00ff\\u0150\\u0170\\u0151\\u0171]\&quot;,\n\tblockPrefixLetters:\t\&quot;[A-Za-z0-9-_\\u00c0-\\u00d6\\u00d8-\\u00de\\u00df-\\u00f6\\u00f8-\\u00ff\\u0150\\u0170\\u0151\\u0171]\&quot;\n};\n\nexports.textPrimitives.unWikiLink = \&quot;~\&quot;;\nexports.textPrimitives.wikiLink = exports.textPrimitives.upperLetter + \&quot;+\&quot; +\n\texports.textPrimitives.lowerLetter + \&quot;+\&quot; +\n\texports.textPrimitives.upperLetter +\n\texports.textPrimitives.anyLetter + \&quot;*\&quot;;\n\nexports.htmlEntities = {quot:34, amp:38, apos:39, lt:60, gt:62, nbsp:160, iexcl:161, cent:162, pound:163, curren:164, yen:165, brvbar:166, sect:167, uml:168, copy:169, ordf:170, laquo:171, not:172, shy:173, reg:174, macr:175, deg:176, plusmn:177, sup2:178, sup3:179, acute:180, micro:181, para:182, middot:183, cedil:184, sup1:185, ordm:186, raquo:187, frac14:188, frac12:189, frac34:190, iquest:191, Agrave:192, Aacute:193, Acirc:194, Atilde:195, Auml:196, Aring:197, AElig:198, Ccedil:199, Egrave:200, Eacute:201, Ecirc:202, Euml:203, Igrave:204, Iacute:205, Icirc:206, Iuml:207, ETH:208, Ntilde:209, Ograve:210, Oacute:211, Ocirc:212, Otilde:213, Ouml:214, times:215, Oslash:216, Ugrave:217, Uacute:218, Ucirc:219, Uuml:220, Yacute:221, THORN:222, szlig:223, agrave:224, aacute:225, acirc:226, atilde:227, auml:228, aring:229, aelig:230, ccedil:231, egrave:232, eacute:233, ecirc:234, euml:235, igrave:236, iacute:237, icirc:238, iuml:239, eth:240, ntilde:241, ograve:242, oacute:243, ocirc:244, otilde:245, ouml:246, divide:247, oslash:248, ugrave:249, uacute:250, ucirc:251, uuml:252, yacute:253, thorn:254, yuml:255, OElig:338, oelig:339, Scaron:352, scaron:353, Yuml:376, fnof:402, circ:710, tilde:732, Alpha:913, Beta:914, Gamma:915, Delta:916, Epsilon:917, Zeta:918, Eta:919, Theta:920, Iota:921, Kappa:922, Lambda:923, Mu:924, Nu:925, Xi:926, Omicron:927, Pi:928, Rho:929, Sigma:931, Tau:932, Upsilon:933, Phi:934, Chi:935, Psi:936, Omega:937, alpha:945, beta:946, gamma:947, delta:948, epsilon:949, zeta:950, eta:951, theta:952, iota:953, kappa:954, lambda:955, mu:956, nu:957, xi:958, omicron:959, pi:960, rho:961, sigmaf:962, sigma:963, tau:964, upsilon:965, phi:966, chi:967, psi:968, omega:969, thetasym:977, upsih:978, piv:982, ensp:8194, emsp:8195, thinsp:8201, zwnj:8204, zwj:8205, lrm:8206, rlm:8207, ndash:8211, mdash:8212, lsquo:8216, rsquo:8217, sbquo:8218, ldquo:8220, rdquo:8221, bdquo:8222, dagger:8224, Dagger:8225, bull:8226, hellip:8230, permil:8240, prime:8242, Prime:8243, lsaquo:8249, rsaquo:8250, oline:8254, frasl:8260, euro:8364, image:8465, weierp:8472, real:8476, trade:8482, alefsym:8501, larr:8592, uarr:8593, rarr:8594, darr:8595, harr:8596, crarr:8629, lArr:8656, uArr:8657, rArr:8658, dArr:8659, hArr:8660, forall:8704, part:8706, exist:8707, empty:8709, nabla:8711, isin:8712, notin:8713, ni:8715, prod:8719, sum:8721, minus:8722, lowast:8727, radic:8730, prop:8733, infin:8734, ang:8736, and:8743, or:8744, cap:8745, cup:8746, int:8747, there4:8756, sim:8764, cong:8773, asymp:8776, ne:8800, equiv:8801, le:8804, ge:8805, sub:8834, sup:8835, nsub:8836, sube:8838, supe:8839, oplus:8853, otimes:8855, perp:8869, sdot:8901, lceil:8968, rceil:8969, lfloor:8970, rfloor:8971, lang:9001, rang:9002, loz:9674, spades:9824, clubs:9827, hearts:9829, diams:9830 };\n\nexports.htmlVoidElements = \&quot;area,base,br,col,command,embed,hr,img,input,keygen,link,meta,param,source,track,wbr\&quot;.split(\&quot;,\&quot;);\n\nexports.htmlBlockElements = \&quot;address,article,aside,audio,blockquote,canvas,dd,div,dl,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,hr,li,noscript,ol,output,p,pre,section,table,tfoot,ul,video\&quot;.split(\&quot;,\&quot;);\n\nexports.htmlUnsafeElements = \&quot;script\&quot;.split(\&quot;,\&quot;);\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/config.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;config&quot;
        },
        &quot;$:/core/modules/deserializers.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/deserializers.js\ntype: application/javascript\nmodule-type: tiddlerdeserializer\n\nFunctions to deserialise tiddlers from a block of text\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nUtility function to parse an old-style tiddler DIV in a *.tid file. It looks like this:\n\n&lt;div title=\&quot;Title\&quot; creator=\&quot;JoeBloggs\&quot; modifier=\&quot;JoeBloggs\&quot; created=\&quot;201102111106\&quot; modified=\&quot;201102111310\&quot; tags=\&quot;myTag [[my long tag]]\&quot;&gt;\n&lt;pre&gt;The text of the tiddler (without the expected HTML encoding).\n&lt;/pre&gt;\n&lt;/div&gt;\n\nNote that the field attributes are HTML encoded, but that the body of the &lt;PRE&gt; tag is not encoded.\n\nWhen these tiddler DIVs are encountered within a TiddlyWiki HTML file then the body is encoded in the usual way.\n*/\nvar parseTiddlerDiv = function(text /* [,fields] */) {\n\t// Slot together the default results\n\tvar result = {};\n\tif(arguments.length &gt; 1) {\n\t\tfor(var f=1; f&lt;arguments.length; f++) {\n\t\t\tvar fields = arguments[f];\n\t\t\tfor(var t in fields) {\n\t\t\t\tresult[t] = fields[t];\t\t\n\t\t\t}\n\t\t}\n\t}\n\t// Parse the DIV body\n\tvar startRegExp = /^\\s*&lt;div\\s+([^&gt;]*)&gt;(\\s*&lt;pre&gt;)?/gi,\n\t\tendRegExp,\n\t\tmatch = startRegExp.exec(text);\n\tif(match) {\n\t\t// Old-style DIVs don't have the &lt;pre&gt; tag\n\t\tif(match[2]) {\n\t\t\tendRegExp = /&lt;\\/pre&gt;\\s*&lt;\\/div&gt;\\s*$/gi;\n\t\t} else {\n\t\t\tendRegExp = /&lt;\\/div&gt;\\s*$/gi;\n\t\t}\n\t\tvar endMatch = endRegExp.exec(text);\n\t\tif(endMatch) {\n\t\t\t// Extract the text\n\t\t\tresult.text = text.substring(match.index + match[0].length,endMatch.index);\n\t\t\t// Process the attributes\n\t\t\tvar attrRegExp = /\\s*([^=\\s]+)\\s*=\\s*(?:\&quot;([^\&quot;]*)\&quot;|'([^']*)')/gi,\n\t\t\t\tattrMatch;\n\t\t\tdo {\n\t\t\t\tattrMatch = attrRegExp.exec(match[1]);\n\t\t\t\tif(attrMatch) {\n\t\t\t\t\tvar name = attrMatch[1];\n\t\t\t\t\tvar value = attrMatch[2] !== undefined ? attrMatch[2] : attrMatch[3];\n\t\t\t\t\tresult[name] = value;\n\t\t\t\t}\n\t\t\t} while(attrMatch);\n\t\t\treturn result;\n\t\t}\n\t}\n\treturn undefined;\n};\n\nexports[\&quot;application/x-tiddler-html-div\&quot;] = function(text,fields) {\n\treturn [parseTiddlerDiv(text,fields)];\n};\n\nexports[\&quot;application/json\&quot;] = function(text,fields) {\n\tvar incoming = JSON.parse(text),\n\t\tresults = [];\n\tif($tw.utils.isArray(incoming)) {\n\t\tfor(var t=0; t&lt;incoming.length; t++) {\n\t\t\tvar incomingFields = incoming[t],\n\t\t\t\tfields = {};\n\t\t\tfor(var f in incomingFields) {\n\t\t\t\tif(typeof incomingFields[f] === \&quot;string\&quot;) {\n\t\t\t\t\tfields[f] = incomingFields[f];\n\t\t\t\t}\n\t\t\t}\n\t\t\tresults.push(fields);\n\t\t}\n\t}\n\treturn results;\n};\n\n/*\nParse an HTML file into tiddlers. There are three possibilities:\n# A TiddlyWiki classic HTML file containing `text/x-tiddlywiki` tiddlers\n# A TiddlyWiki5 HTML file containing `text/vnd.tiddlywiki` tiddlers\n# An ordinary HTML file\n*/\nexports[\&quot;text/html\&quot;] = function(text,fields) {\n\t// Check if we've got a store area\n\tvar storeAreaMarkerRegExp = /&lt;div id=[\&quot;']?storeArea['\&quot;]?( style=[\&quot;']?display:none;[\&quot;']?)?&gt;/gi,\n\t\tmatch = storeAreaMarkerRegExp.exec(text);\n\tif(match) {\n\t\t// If so, it's either a classic TiddlyWiki file or an unencrypted TW5 file\n\t\t// First read the normal tiddlers\n\t\tvar results = deserializeTiddlyWikiFile(text,storeAreaMarkerRegExp.lastIndex,!!match[1],fields);\n\t\t// Then any system tiddlers\n\t\tvar systemAreaMarkerRegExp = /&lt;div id=[\&quot;']?systemArea['\&quot;]?( style=[\&quot;']?display:none;[\&quot;']?)?&gt;/gi,\n\t\t\tsysMatch = systemAreaMarkerRegExp.exec(text);\n\t\tif(sysMatch) {\n\t\t\tresults.push.apply(results,deserializeTiddlyWikiFile(text,systemAreaMarkerRegExp.lastIndex,!!sysMatch[1],fields));\n\t\t}\n\t\treturn results;\n\t} else {\n\t\t// Check whether we've got an encrypted file\n\t\tvar encryptedStoreArea = $tw.utils.extractEncryptedStoreArea(text);\n\t\tif(encryptedStoreArea) {\n\t\t\t// If so, attempt to decrypt it using the current password\n\t\t\treturn $tw.utils.decryptStoreArea(encryptedStoreArea);\n\t\t} else {\n\t\t\t// It's not a TiddlyWiki so we'll return the entire HTML file as a tiddler\n\t\t\treturn deserializeHtmlFile(text,fields);\n\t\t}\n\t}\n};\n\nfunction deserializeHtmlFile(text,fields) {\n\tvar result = {};\n\t$tw.utils.each(fields,function(value,name) {\n\t\tresult[name] = value;\n\t});\n\tresult.text = text;\n\tresult.type = \&quot;text/html\&quot;;\n\treturn [result];\n}\n\nfunction deserializeTiddlyWikiFile(text,storeAreaEnd,isTiddlyWiki5,fields) {\n\tvar results = [],\n\t\tendOfDivRegExp = /(&lt;\\/div&gt;\\s*)/gi,\n\t\tstartPos = storeAreaEnd,\n\t\tdefaultType = isTiddlyWiki5 ? undefined : \&quot;text/x-tiddlywiki\&quot;;\n\tendOfDivRegExp.lastIndex = startPos;\n\tvar match = endOfDivRegExp.exec(text);\n\twhile(match) {\n\t\tvar endPos = endOfDivRegExp.lastIndex,\n\t\t\ttiddlerFields = parseTiddlerDiv(text.substring(startPos,endPos),fields,{type: defaultType});\n\t\tif(!tiddlerFields) {\n\t\t\tbreak;\n\t\t}\n\t\t$tw.utils.each(tiddlerFields,function(value,name) {\n\t\t\tif(typeof value === \&quot;string\&quot;) {\n\t\t\t\ttiddlerFields[name] = $tw.utils.htmlDecode(value);\n\t\t\t}\n\t\t});\n\t\tif(tiddlerFields.text !== null) {\n\t\t\tresults.push(tiddlerFields);\n\t\t}\n\t\tstartPos = endPos;\n\t\tmatch = endOfDivRegExp.exec(text);\n\t}\n\treturn results;\n}\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/deserializers.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;tiddlerdeserializer&quot;
        },
        &quot;$:/core/modules/filters/addprefix.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/addprefix.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for adding a prefix to each title in the list. This is\nespecially useful in contexts where only a filter expression is allowed\nand macro substitution isn't available.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.addprefix = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(operator.operand + title);\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/addprefix.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/addsuffix.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/addsuffix.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for adding a suffix to each title in the list. This is\nespecially useful in contexts where only a filter expression is allowed\nand macro substitution isn't available.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.addsuffix = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(title + operator.operand);\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/addsuffix.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/after.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/after.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator returning the tiddler from the current list that is after the tiddler named in the operand.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.after = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(title);\n\t});\n\tvar index = results.indexOf(operator.operand);\n\tif(index === -1 || index &gt; (results.length - 2)) {\n\t\treturn [];\n\t} else {\n\t\treturn [results[index + 1]];\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/after.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/all/current.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/all/current.js\ntype: application/javascript\nmodule-type: allfilteroperator\n\nFilter function for [all[current]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.current = function(source,prefix,options) {\n\tvar currTiddlerTitle = options.widget &amp;&amp; options.widget.getVariable(\&quot;currentTiddler\&quot;);\n\tif(currTiddlerTitle) {\n\t\treturn [currTiddlerTitle];\n\t} else {\n\t\treturn [];\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/all/current.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;allfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/all/missing.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/all/missing.js\ntype: application/javascript\nmodule-type: allfilteroperator\n\nFilter function for [all[missing]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.missing = function(source,prefix,options) {\n\treturn options.wiki.getMissingTitles();\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/all/missing.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;allfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/all/orphans.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/all/orphans.js\ntype: application/javascript\nmodule-type: allfilteroperator\n\nFilter function for [all[orphans]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.orphans = function(source,prefix,options) {\n\treturn options.wiki.getOrphanTitles();\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/all/orphans.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;allfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/all/shadows.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/all/shadows.js\ntype: application/javascript\nmodule-type: allfilteroperator\n\nFilter function for [all[shadows]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.shadows = function(source,prefix,options) {\n\treturn options.wiki.allShadowTitles();\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/all/shadows.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;allfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/all/tiddlers.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/all/tiddlers.js\ntype: application/javascript\nmodule-type: allfilteroperator\n\nFilter function for [all[tiddlers]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.tiddlers = function(source,prefix,options) {\n\treturn options.wiki.allTitles();\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/all/tiddlers.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;allfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/all.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/all.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for selecting tiddlers\n\n[all[shadows+tiddlers]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar allFilterOperators;\n\nfunction getAllFilterOperators() {\n\tif(!allFilterOperators) {\n\t\tallFilterOperators = {};\n\t\t$tw.modules.applyMethods(\&quot;allfilteroperator\&quot;,allFilterOperators);\n\t}\n\treturn allFilterOperators;\n}\n\n/*\nExport our filter function\n*/\nexports.all = function(source,operator,options) {\n\t// Get our suboperators\n\tvar allFilterOperators = getAllFilterOperators();\n\t// Cycle through the suboperators accumulating their results\n\tvar results = [],\n\t\tsubops = operator.operand.split(\&quot;+\&quot;);\n\t// Check for common optimisations\n\tif(subops.length === 1 &amp;&amp; subops[0] === \&quot;\&quot;) {\n\t\treturn source;\n\t} else if(subops.length === 1 &amp;&amp; subops[0] === \&quot;tiddlers\&quot;) {\n\t\treturn options.wiki.each;\n\t} else if(subops.length === 1 &amp;&amp; subops[0] === \&quot;shadows\&quot;) {\n\t\treturn options.wiki.eachShadow;\n\t} else if(subops.length === 2 &amp;&amp; subops[0] === \&quot;tiddlers\&quot; &amp;&amp; subops[1] === \&quot;shadows\&quot;) {\n\t\treturn options.wiki.eachTiddlerPlusShadows;\n\t} else if(subops.length === 2 &amp;&amp; subops[0] === \&quot;shadows\&quot; &amp;&amp; subops[1] === \&quot;tiddlers\&quot;) {\n\t\treturn options.wiki.eachShadowPlusTiddlers;\n\t}\n\t// Do it the hard way\n\tfor(var t=0; t&lt;subops.length; t++) {\n\t\tvar subop = allFilterOperators[subops[t]];\n\t\tif(subop) {\n\t\t\t$tw.utils.pushTop(results,subop(source,operator.prefix,options));\n\t\t}\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/all.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/backlinks.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/backlinks.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning all the backlinks from a tiddler\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.backlinks = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\t$tw.utils.pushTop(results,options.wiki.getTiddlerBacklinks(title));\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/backlinks.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/before.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/before.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator returning the tiddler from the current list that is before the tiddler named in the operand.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.before = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(title);\n\t});\n\tvar index = results.indexOf(operator.operand);\n\tif(index &lt;= 0) {\n\t\treturn [];\n\t} else {\n\t\treturn [results[index - 1]];\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/before.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/commands.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/commands.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning the names of the commands available in this wiki\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.commands = function(source,operator,options) {\n\tvar results = [];\n\t$tw.utils.each($tw.commands,function(commandInfo,name) {\n\t\tresults.push(name);\n\t});\n\tresults.sort();\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/commands.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/each.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/each.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator that selects one tiddler for each unique value of the specified field\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.each = function(source,operator,options) {\n\tvar results = [],\n\t\tvalues = {};\n\tsource(function(tiddler,title) {\n\t\tif(tiddler) {\n\t\t\tvar value;\n\t\t\tif((operator.operand === \&quot;\&quot;) || (operator.operand === \&quot;title\&quot;)) {\n\t\t\t\tvalue = title;\n\t\t\t} else {\n\t\t\t\tvalue = tiddler.getFieldString(operator.operand);\n\t\t\t}\n\t\t\tif(!$tw.utils.hop(values,value)) {\n\t\t\t\tvalues[value] = true;\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/each.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/eachday.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/eachday.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator that selects one tiddler for each unique day covered by the specified date field\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.eachday = function(source,operator,options) {\n\tvar results = [],\n\t\tvalues = [];\n\t// Function to convert a date/time to a date integer\n\tvar toDate = function(value) {\n\t\tvalue = (new Date(value)).setHours(0,0,0,0);\n\t\treturn value+0;\n\t};\n\tsource(function(tiddler,title) {\n\t\tif(tiddler &amp;&amp; tiddler.fields[operator.operand]) {\n\t\t\tvar value = toDate(tiddler.fields[operator.operand]);\n\t\t\tif(values.indexOf(value) === -1) {\n\t\t\t\tvalues.push(value);\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/eachday.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/field.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/field.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for comparing fields for equality\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.field = function(source,operator,options) {\n\tvar results = [],\n\t\tfieldname = (operator.suffix || operator.operator || \&quot;title\&quot;).toLowerCase();\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tif(operator.regexp) {\n\t\t\tsource(function(tiddler,title) {\n\t\t\t\tif(tiddler) {\n\t\t\t\t\tvar text = tiddler.getFieldString(fieldname);\n\t\t\t\t\tif(text !== null &amp;&amp; !operator.regexp.exec(text)) {\n\t\t\t\t\t\tresults.push(title);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresults.push(title);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tsource(function(tiddler,title) {\n\t\t\t\tif(tiddler) {\n\t\t\t\t\tvar text = tiddler.getFieldString(fieldname);\n\t\t\t\t\tif(text !== null &amp;&amp; text !== operator.operand) {\n\t\t\t\t\t\tresults.push(title);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresults.push(title);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t} else {\n\t\tif(operator.regexp) {\n\t\t\tsource(function(tiddler,title) {\n\t\t\t\tif(tiddler) {\n\t\t\t\t\tvar text = tiddler.getFieldString(fieldname);\n\t\t\t\t\tif(text !== null &amp;&amp; !!operator.regexp.exec(text)) {\n\t\t\t\t\t\tresults.push(title);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tsource(function(tiddler,title) {\n\t\t\t\tif(tiddler) {\n\t\t\t\t\tvar text = tiddler.getFieldString(fieldname);\n\t\t\t\t\tif(text !== null &amp;&amp; text === operator.operand) {\n\t\t\t\t\t\tresults.push(title);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/field.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/fields.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/fields.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning the names of the fields on the selected tiddlers\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.fields = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tif(tiddler) {\n\t\t\tfor(var fieldName in tiddler.fields) {\n\t\t\t\t$tw.utils.pushTop(results,fieldName);\n\t\t\t}\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/fields.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/get.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/get.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for replacing tiddler titles by the value of the field specified in the operand.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.get = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tif(tiddler) {\n\t\t\tvar value = tiddler.getFieldString(operator.operand);\n\t\t\tif(value) {\n\t\t\t\tresults.push(value);\n\t\t\t}\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/get.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/has.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/has.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for checking if a tiddler has the specified field\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.has = function(source,operator,options) {\n\tvar results = [];\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(!tiddler || (tiddler &amp;&amp; (!$tw.utils.hop(tiddler.fields,operator.operand) || tiddler.fields[operator.operand] === \&quot;\&quot;))) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(tiddler &amp;&amp; $tw.utils.hop(tiddler.fields,operator.operand) &amp;&amp; tiddler.fields[operator.operand] !== \&quot;\&quot;) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/has.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/indexes.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/indexes.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning the indexes of a data tiddler\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.indexes = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tvar data = options.wiki.getTiddlerData(title);\n\t\tif(data) {\n\t\t\t$tw.utils.pushTop(results,Object.keys(data));\n\t\t}\n\t});\n\tresults.sort();\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/indexes.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/is/current.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/is/current.js\ntype: application/javascript\nmodule-type: isfilteroperator\n\nFilter function for [is[current]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.current = function(source,prefix,options) {\n\tvar results = [],\n\t\tcurrTiddlerTitle = options.widget &amp;&amp; options.widget.getVariable(\&quot;currentTiddler\&quot;);\n\tif(prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(title !== currTiddlerTitle) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(title === currTiddlerTitle) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/is/current.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;isfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/is/image.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/is/image.js\ntype: application/javascript\nmodule-type: isfilteroperator\n\nFilter function for [is[image]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.image = function(source,prefix,options) {\n\tvar results = [];\n\tif(prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(!options.wiki.isImageTiddler(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(options.wiki.isImageTiddler(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/is/image.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;isfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/is/missing.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/is/missing.js\ntype: application/javascript\nmodule-type: isfilteroperator\n\nFilter function for [is[missing]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.missing = function(source,prefix,options) {\n\tvar results = [];\n\tif(prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(options.wiki.tiddlerExists(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(!options.wiki.tiddlerExists(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/is/missing.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;isfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/is/orphan.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/is/orphan.js\ntype: application/javascript\nmodule-type: isfilteroperator\n\nFilter function for [is[orphan]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.orphan = function(source,prefix,options) {\n\tvar results = [],\n\t\torphanTitles = options.wiki.getOrphanTitles();\n\tif(prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(orphanTitles.indexOf(title) === -1) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(orphanTitles.indexOf(title) !== -1) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/is/orphan.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;isfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/is/shadow.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/is/shadow.js\ntype: application/javascript\nmodule-type: isfilteroperator\n\nFilter function for [is[shadow]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.shadow = function(source,prefix,options) {\n\tvar results = [];\n\tif(prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(!options.wiki.isShadowTiddler(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(options.wiki.isShadowTiddler(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/is/shadow.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;isfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/is/system.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/is/system.js\ntype: application/javascript\nmodule-type: isfilteroperator\n\nFilter function for [is[system]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.system = function(source,prefix,options) {\n\tvar results = [];\n\tif(prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(!options.wiki.isSystemTiddler(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(options.wiki.isSystemTiddler(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/is/system.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;isfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/is/tag.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/is/tag.js\ntype: application/javascript\nmodule-type: isfilteroperator\n\nFilter function for [is[tag]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.tag = function(source,prefix,options) {\n\tvar results = [],\n\t\ttagMap = options.wiki.getTagMap();\n\tif(prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(!$tw.utils.hop(tagMap,title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif($tw.utils.hop(tagMap,title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/is/tag.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;isfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/is/tiddler.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/is/tiddler.js\ntype: application/javascript\nmodule-type: isfilteroperator\n\nFilter function for [is[tiddler]]\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.tiddler = function(source,prefix,options) {\n\tvar results = [];\n\tif(prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(!options.wiki.tiddlerExists(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(options.wiki.tiddlerExists(title)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/is/tiddler.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;isfilteroperator&quot;
        },
        &quot;$:/core/modules/filters/is.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/is.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for checking tiddler properties\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar isFilterOperators;\n\nfunction getIsFilterOperators() {\n\tif(!isFilterOperators) {\n\t\tisFilterOperators = {};\n\t\t$tw.modules.applyMethods(\&quot;isfilteroperator\&quot;,isFilterOperators);\n\t}\n\treturn isFilterOperators;\n}\n\n/*\nExport our filter function\n*/\nexports.is = function(source,operator,options) {\n\t// Dispatch to the correct isfilteroperator\n\tvar isFilterOperators = getIsFilterOperators();\n\tvar isFilterOperator = isFilterOperators[operator.operand];\n\tif(isFilterOperator) {\n\t\treturn isFilterOperator(source,operator.prefix,options);\n\t} else {\n\t\treturn [\&quot;Filter Error: Unknown operand for the 'is' filter operator\&quot;];\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/is.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/limit.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/limit.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for chopping the results to a specified maximum number of entries\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.limit = function(source,operator,options) {\n\tvar results = [];\n\t// Convert to an array\n\tsource(function(tiddler,title) {\n\t\tresults.push(title);\n\t});\n\t// Slice the array if necessary\n\tvar limit = Math.min(results.length,parseInt(operator.operand,10));\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tresults = results.slice(-limit);\n\t} else {\n\t\tresults = results.slice(0,limit);\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/limit.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/links.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/links.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning all the links from a tiddler\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.links = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\t$tw.utils.pushTop(results,options.wiki.getTiddlerLinks(title));\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/links.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/list.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/list.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator returning the tiddlers whose title is listed in the operand tiddler\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.list = function(source,operator,options) {\n\tvar results = [],\n\t\ttr = $tw.utils.parseTextReference(operator.operand),\n\t\tcurrTiddlerTitle = options.widget &amp;&amp; options.widget.getVariable(\&quot;currentTiddler\&quot;),\n\t\tlist = options.wiki.getTiddlerList(tr.title || currTiddlerTitle,tr.field,tr.index);\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(list.indexOf(title) === -1) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tresults = list;\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/list.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/listed.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/listed.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator returning all tiddlers that have the selected tiddlers in a list\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.listed = function(source,operator,options) {\n\tvar field = operator.operand || \&quot;list\&quot;,\n\t\tresults = [];\n\tsource(function(tiddler,title) {\n\t\t$tw.utils.pushTop(results,options.wiki.findListingsOfTiddler(title,field));\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/listed.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/listops.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/listops.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operators for manipulating the current selection list\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nReverse list\n*/\nexports.reverse = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tresults.unshift(title);\n\t});\n\treturn results;\n};\n\n/*\nFirst entry/entries in list\n*/\nexports.first = function(source,operator,options) {\n\tvar count = parseInt(operator.operand) || 1,\n\t\tresults = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(title);\n\t});\n\treturn results.slice(0,count);\n};\n\n/*\nLast entry/entries in list\n*/\nexports.last = function(source,operator,options) {\n\tvar count = parseInt(operator.operand) || 1,\n\t\tresults = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(title);\n\t});\n\treturn results.slice(-count);\n};\n\n/*\nAll but the first entry/entries of the list\n*/\nexports.rest = function(source,operator,options) {\n\tvar count = parseInt(operator.operand) || 1,\n\t\tresults = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(title);\n\t});\n\treturn results.slice(count);\n};\nexports.butfirst = exports.rest;\nexports.bf = exports.rest;\n\n/*\nAll but the last entry/entries of the list\n*/\nexports.butlast = function(source,operator,options) {\n\tvar count = parseInt(operator.operand) || 1,\n\t\tresults = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(title);\n\t});\n\treturn results.slice(0,-count);\n};\nexports.bl = exports.butlast;\n\n/*\nThe nth member of the list\n*/\nexports.nth = function(source,operator,options) {\n\tvar count = parseInt(operator.operand) || 1,\n\t\tresults = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(title);\n\t});\n\treturn results.slice(count - 1,count);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/listops.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/modules.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/modules.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning the titles of the modules of a given type in this wiki\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.modules = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\t$tw.utils.each($tw.modules.types[title],function(moduleInfo,moduleName) {\n\t\t\tresults.push(moduleName);\n\t\t});\n\t});\n\tresults.sort();\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/modules.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/moduletypes.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/moduletypes.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning the names of the module types in this wiki\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.moduletypes = function(source,operator,options) {\n\tvar results = [];\n\t$tw.utils.each($tw.modules.types,function(moduleInfo,type) {\n\t\tresults.push(type);\n\t});\n\tresults.sort();\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/moduletypes.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/next.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/next.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator returning the tiddler whose title occurs next in the list supplied in the operand tiddler\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.next = function(source,operator,options) {\n\tvar results = [],\n\t\tlist = options.wiki.getTiddlerList(operator.operand);\n\tsource(function(tiddler,title) {\n\t\tvar match = list.indexOf(title);\n\t\t// increment match and then test if result is in range\n\t\tmatch++;\n\t\tif(match &gt; 0 &amp;&amp; match &lt; list.length) {\n\t\t\tresults.push(list[match]);\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/next.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/plugintiddlers.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/plugintiddlers.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning the titles of the shadow tiddlers within a plugin\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.plugintiddlers = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tvar pluginInfo = options.wiki.getPluginInfo(title) || options.wiki.getTiddlerData(title,{tiddlers:[]});\n\t\tif(pluginInfo &amp;&amp; pluginInfo.tiddlers) {\n\t\t\t$tw.utils.each(pluginInfo.tiddlers,function(fields,title) {\n\t\t\t\tresults.push(title);\n\t\t\t});\n\t\t}\n\t});\n\tresults.sort();\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/plugintiddlers.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/prefix.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/prefix.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for checking if a title starts with a prefix\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.prefix = function(source,operator,options) {\n\tvar results = [];\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(title.substr(0,operator.operand.length) !== operator.operand) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(title.substr(0,operator.operand.length) === operator.operand) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/prefix.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/previous.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/previous.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator returning the tiddler whose title occurs immediately prior in the list supplied in the operand tiddler\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.previous = function(source,operator,options) {\n\tvar results = [],\n\t\tlist = options.wiki.getTiddlerList(operator.operand);\n\tsource(function(tiddler,title) {\n\t\tvar match = list.indexOf(title);\n\t\t// increment match and then test if result is in range\n\t\tmatch--;\n\t\tif(match &gt;= 0) {\n\t\t\tresults.push(list[match]);\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/previous.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/regexp.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/regexp.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for regexp matching\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.regexp = function(source,operator,options) {\n\tvar results = [],\n\t\tfieldname = (operator.suffix || \&quot;title\&quot;).toLowerCase(),\n\t\tregexpString, regexp, flags = \&quot;\&quot;, match,\n\t\tgetFieldString = function(tiddler,title) {\n\t\t\tif(tiddler) {\n\t\t\t\treturn tiddler.getFieldString(fieldname);\n\t\t\t} else if(fieldname === \&quot;title\&quot;) {\n\t\t\t\treturn title;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t};\n\t// Process flags and construct regexp\n\tregexpString = operator.operand;\n\tmatch = /^\\(\\?([gim]+)\\)/.exec(regexpString);\n\tif(match) {\n\t\tflags = match[1];\n\t\tregexpString = regexpString.substr(match[0].length);\n\t} else {\n\t\tmatch = /\\(\\?([gim]+)\\)$/.exec(regexpString);\n\t\tif(match) {\n\t\t\tflags = match[1];\n\t\t\tregexpString = regexpString.substr(0,regexpString.length - match[0].length);\n\t\t}\n\t}\n\tregexp = new RegExp(regexpString,flags);\n\t// Process the incoming tiddlers\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tvar text = getFieldString(tiddler,title);\n\t\t\tif(text !== null) {\n\t\t\t\tif(!regexp.exec(text)) {\n\t\t\t\t\tresults.push(title);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tvar text = getFieldString(tiddler,title);\n\t\t\tif(text !== null) {\n\t\t\t\tif(!!regexp.exec(text)) {\n\t\t\t\t\tresults.push(title);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/regexp.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/removeprefix.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/removeprefix.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for removing a prefix from each title in the list. Titles that do not start with the prefix are removed.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.removeprefix = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tif(title.substr(0,operator.operand.length) === operator.operand) {\n\t\t\tresults.push(title.substr(operator.operand.length));\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/removeprefix.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/removesuffix.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/removesuffix.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for removing a suffix from each title in the list. Titles that do not end with the suffix are removed.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.removesuffix = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tif(title.substr(-operator.operand.length) === operator.operand) {\n\t\t\tresults.push(title.substr(0,title.length - operator.operand.length));\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/removesuffix.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/sameday.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/sameday.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator that selects tiddlers with a modified date field on the same day as the provided value.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.sameday = function(source,operator,options) {\n\tvar results = [],\n\t\tfieldName = operator.suffix || \&quot;modified\&quot;,\n\t\ttargetDate = (new Date($tw.utils.parseDate(operator.operand))).setHours(0,0,0,0);\n\t// Function to convert a date/time to a date integer\n\tvar isSameDay = function(dateField) {\n\t\t\treturn (new Date(dateField)).setHours(0,0,0,0) === targetDate;\n\t\t};\n\tsource(function(tiddler,title) {\n\t\tif(tiddler &amp;&amp; tiddler.fields[fieldName]) {\n\t\t\tif(isSameDay(tiddler.fields[fieldName])) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/sameday.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/search.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/search.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for searching for the text in the operand tiddler\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.search = function(source,operator,options) {\n\tvar invert = operator.prefix === \&quot;!\&quot;;\n\tif(operator.suffix) {\n\t\treturn options.wiki.search(operator.operand,{\n\t\t\tsource: source,\n\t\t\tinvert: invert,\n\t\t\tfield: operator.suffix\n\t\t});\n\t} else {\n\t\treturn options.wiki.search(operator.operand,{\n\t\t\tsource: source,\n\t\t\tinvert: invert\n\t\t});\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/search.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/shadowsource.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/shadowsource.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning the source plugins for shadow tiddlers\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.shadowsource = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tvar source = options.wiki.getShadowSource(title);\n\t\tif(source) {\n\t\t\t$tw.utils.pushTop(results,source);\n\t\t}\n\t});\n\tresults.sort();\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/shadowsource.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/sort.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/sort.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for sorting\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.sort = function(source,operator,options) {\n\tvar results = prepare_results(source);\n\toptions.wiki.sortTiddlers(results,operator.operand || \&quot;title\&quot;,operator.prefix === \&quot;!\&quot;,false,false);\n\treturn results;\n};\n\nexports.nsort = function(source,operator,options) {\n\tvar results = prepare_results(source);\n\toptions.wiki.sortTiddlers(results,operator.operand || \&quot;title\&quot;,operator.prefix === \&quot;!\&quot;,false,true);\n\treturn results;\n};\n\nexports.sortcs = function(source,operator,options) {\n\tvar results = prepare_results(source);\n\toptions.wiki.sortTiddlers(results,operator.operand || \&quot;title\&quot;,operator.prefix === \&quot;!\&quot;,true,false);\n\treturn results;\n};\n\nexports.nsortcs = function(source,operator,options) {\n\tvar results = prepare_results(source);\n\toptions.wiki.sortTiddlers(results,operator.operand || \&quot;title\&quot;,operator.prefix === \&quot;!\&quot;,true,true);\n\treturn results;\n};\n\nvar prepare_results = function (source) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tresults.push(title);\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/sort.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/splitbefore.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/splitbefore.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator that splits each result on the first occurance of the specified separator and returns the unique values.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.splitbefore = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tvar parts = title.split(operator.operand);\n\t\tif(parts.length === 1) {\n\t\t\t$tw.utils.pushTop(results,parts[0]);\n\t\t} else {\n\t\t\t$tw.utils.pushTop(results,parts[0] + operator.operand);\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/splitbefore.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/storyviews.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/storyviews.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for returning the names of the story views in this wiki\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.storyviews = function(source,operator,options) {\n\tvar results = [],\n\t\tstoryviews = {};\n\t$tw.modules.applyMethods(\&quot;storyview\&quot;,storyviews);\n\t$tw.utils.each(storyviews,function(info,name) {\n\t\tresults.push(name);\n\t});\n\tresults.sort();\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/storyviews.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/suffix.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/suffix.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for checking if a title ends with a suffix\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.suffix = function(source,operator,options) {\n\tvar results = [];\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(title.substr(-operator.operand.length) !== operator.operand) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(title.substr(-operator.operand.length) === operator.operand) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/suffix.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/tag.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/tag.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for checking for the presence of a tag\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.tag = function(source,operator,options) {\n\tvar results = [];\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(tiddler &amp;&amp; !tiddler.hasTag(operator.operand)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(tiddler &amp;&amp; tiddler.hasTag(operator.operand)) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t\tresults = options.wiki.sortByList(results,operator.operand);\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/tag.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/tagging.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/tagging.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator returning all tiddlers that are tagged with the selected tiddlers\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.tagging = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\t$tw.utils.pushTop(results,options.wiki.getTiddlersWithTag(title));\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/tagging.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/tags.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/tags.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator returning all the tags of the selected tiddlers\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.tags = function(source,operator,options) {\n\tvar results = [];\n\tsource(function(tiddler,title) {\n\t\tif(tiddler &amp;&amp; tiddler.fields.tags) {\n\t\t\t$tw.utils.pushTop(results,tiddler.fields.tags);\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/tags.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/title.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/title.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator for comparing title fields for equality\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.title = function(source,operator,options) {\n\tvar results = [];\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(tiddler &amp;&amp; tiddler.fields.title !== operator.operand) {\n\t\t\t\tresults.push(title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tresults.push(operator.operand);\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/title.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters/untagged.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters/untagged.js\ntype: application/javascript\nmodule-type: filteroperator\n\nFilter operator returning all the selected tiddlers that are untagged\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nExport our filter function\n*/\nexports.untagged = function(source,operator,options) {\n\tvar results = [];\n\tif(operator.prefix === \&quot;!\&quot;) {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(tiddler &amp;&amp; $tw.utils.isArray(tiddler.fields.tags) &amp;&amp; tiddler.fields.tags.length &gt; 0) {\n\t\t\t\t$tw.utils.pushTop(results,title);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tsource(function(tiddler,title) {\n\t\t\tif(!tiddler || !tiddler.hasField(\&quot;tags\&quot;) || ($tw.utils.isArray(tiddler.fields.tags) &amp;&amp; tiddler.fields.tags.length === 0)) {\n\t\t\t\t$tw.utils.pushTop(results,title);\n\t\t\t}\n\t\t});\n\t}\n\treturn results;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters/untagged.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;filteroperator&quot;
        },
        &quot;$:/core/modules/filters.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/filters.js\ntype: application/javascript\nmodule-type: wikimethod\n\nAdds tiddler filtering methods to the $tw.Wiki object.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nParses an operation within a filter string\n\tresults: Array of array of operator nodes into which results should be inserted\n\tfilterString: filter string\n\tp: start position within the string\nReturns the new start position, after the parsed operation\n*/\nfunction parseFilterOperation(operators,filterString,p) {\n\tvar operator, operand, bracketPos, curlyBracketPos;\n\t// Skip the starting square bracket\n\tif(filterString.charAt(p++) !== \&quot;[\&quot;) {\n\t\tthrow \&quot;Missing [ in filter expression\&quot;;\n\t}\n\t// Process each operator in turn\n\tdo {\n\t\toperator = {};\n\t\t// Check for an operator prefix\n\t\tif(filterString.charAt(p) === \&quot;!\&quot;) {\n\t\t\toperator.prefix = filterString.charAt(p++);\n\t\t}\n\t\t// Get the operator name\n\t\tvar nextBracketPos = filterString.substring(p).search(/[\\[\\{&lt;\\/]/);\n\t\tif(nextBracketPos === -1) {\n\t\t\tthrow \&quot;Missing [ in filter expression\&quot;;\n\t\t}\n\t\tnextBracketPos += p;\n\t\tvar bracket = filterString.charAt(nextBracketPos);\n\t\toperator.operator = filterString.substring(p,nextBracketPos);\n\t\t\n\t\t// Any suffix?\n\t\tvar colon = operator.operator.indexOf(':');\n\t\tif(colon &gt; -1) {\n\t\t\toperator.suffix = operator.operator.substring(colon + 1);\n\t\t\toperator.operator = operator.operator.substring(0,colon) || \&quot;field\&quot;;\n\t\t}\n\t\t// Empty operator means: title\n\t\telse if(operator.operator === \&quot;\&quot;) {\n\t\t\toperator.operator = \&quot;title\&quot;;\n\t\t}\n\n\t\tp = nextBracketPos + 1;\n\t\tswitch (bracket) {\n\t\t\tcase \&quot;{\&quot;: // Curly brackets\n\t\t\t\toperator.indirect = true;\n\t\t\t\tnextBracketPos = filterString.indexOf(\&quot;}\&quot;,p);\n\t\t\t\tbreak;\n\t\t\tcase \&quot;[\&quot;: // Square brackets\n\t\t\t\tnextBracketPos = filterString.indexOf(\&quot;]\&quot;,p);\n\t\t\t\tbreak;\n\t\t\tcase \&quot;&lt;\&quot;: // Angle brackets\n\t\t\t\toperator.variable = true;\n\t\t\t\tnextBracketPos = filterString.indexOf(\&quot;&gt;\&quot;,p);\n\t\t\t\tbreak;\n\t\t\tcase \&quot;/\&quot;: // regexp brackets\n\t\t\t\tvar rex = /^((?:[^\\\\\\/]*|\\\\.)*)\\/(?:\\(([mygi]+)\\))?/g,\n\t\t\t\t\trexMatch = rex.exec(filterString.substring(p));\n\t\t\t\tif(rexMatch) {\n\t\t\t\t\toperator.regexp = new RegExp(rexMatch[1], rexMatch[2]);\n// DEPRECATION WARNING\nconsole.log(\&quot;WARNING: Filter\&quot;,operator.operator,\&quot;has a deprecated regexp operand\&quot;,operator.regexp);\n\t\t\t\t\tnextBracketPos = p + rex.lastIndex - 1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthrow \&quot;Unterminated regular expression in filter expression\&quot;;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\tif(nextBracketPos === -1) {\n\t\t\tthrow \&quot;Missing closing bracket in filter expression\&quot;;\n\t\t}\n\t\tif(!operator.regexp) {\n\t\t\toperator.operand = filterString.substring(p,nextBracketPos);\n\t\t}\n\t\tp = nextBracketPos + 1;\n\t\t\t\n\t\t// Push this operator\n\t\toperators.push(operator);\n\t} while(filterString.charAt(p) !== \&quot;]\&quot;);\n\t// Skip the ending square bracket\n\tif(filterString.charAt(p++) !== \&quot;]\&quot;) {\n\t\tthrow \&quot;Missing ] in filter expression\&quot;;\n\t}\n\t// Return the parsing position\n\treturn p;\n}\n\n/*\nParse a filter string\n*/\nexports.parseFilter = function(filterString) {\n\tfilterString = filterString || \&quot;\&quot;;\n\tvar results = [], // Array of arrays of operator nodes {operator:,operand:}\n\t\tp = 0, // Current position in the filter string\n\t\tmatch;\n\tvar whitespaceRegExp = /(\\s+)/mg,\n\t\toperandRegExp = /((?:\\+|\\-)?)(?:(\\[)|(\&quot;(?:[^\&quot;])*\&quot;)|('(?:[^'])*')|([^\\s\\[\\]]+))/mg;\n\twhile(p &lt; filterString.length) {\n\t\t// Skip any whitespace\n\t\twhitespaceRegExp.lastIndex = p;\n\t\tmatch = whitespaceRegExp.exec(filterString);\n\t\tif(match &amp;&amp; match.index === p) {\n\t\t\tp = p + match[0].length;\n\t\t}\n\t\t// Match the start of the operation\n\t\tif(p &lt; filterString.length) {\n\t\t\toperandRegExp.lastIndex = p;\n\t\t\tmatch = operandRegExp.exec(filterString);\n\t\t\tif(!match || match.index !== p) {\n\t\t\t\tthrow \&quot;Syntax error in filter expression\&quot;;\n\t\t\t}\n\t\t\tvar operation = {\n\t\t\t\tprefix: \&quot;\&quot;,\n\t\t\t\toperators: []\n\t\t\t};\n\t\t\tif(match[1]) {\n\t\t\t\toperation.prefix = match[1];\n\t\t\t\tp++;\n\t\t\t}\n\t\t\tif(match[2]) { // Opening square bracket\n\t\t\t\tp = parseFilterOperation(operation.operators,filterString,p);\n\t\t\t} else {\n\t\t\t\tp = match.index + match[0].length;\n\t\t\t}\n\t\t\tif(match[3] || match[4] || match[5]) { // Double quoted string, single quoted string or unquoted title\n\t\t\t\toperation.operators.push(\n\t\t\t\t\t{operator: \&quot;title\&quot;, operand: match[3] || match[4] || match[5]}\n\t\t\t\t);\n\t\t\t}\n\t\t\tresults.push(operation);\n\t\t}\n\t}\n\treturn results;\n};\n\nexports.getFilterOperators = function() {\n\tif(!this.filterOperators) {\n\t\t$tw.Wiki.prototype.filterOperators = {};\n\t\t$tw.modules.applyMethods(\&quot;filteroperator\&quot;,this.filterOperators);\n\t}\n\treturn this.filterOperators;\n};\n\nexports.filterTiddlers = function(filterString,widget,source) {\n\tvar fn = this.compileFilter(filterString);\n\treturn fn.call(this,source,widget);\n};\n\n/*\nCompile a filter into a function with the signature fn(source,widget) where:\nsource: an iterator function for the source tiddlers, called source(iterator), where iterator is called as iterator(tiddler,title)\nwidget: an optional widget node for retrieving the current tiddler etc.\n*/\nexports.compileFilter = function(filterString) {\n\tvar filterParseTree;\n\ttry {\n\t\tfilterParseTree = this.parseFilter(filterString);\n\t} catch(e) {\n\t\treturn function(source,widget) {\n\t\t\treturn [\&quot;Filter error: \&quot; + e];\n\t\t};\n\t}\n\t// Get the hashmap of filter operator functions\n\tvar filterOperators = this.getFilterOperators();\n\t// Assemble array of functions, one for each operation\n\tvar operationFunctions = [];\n\t// Step through the operations\n\tvar self = this;\n\t$tw.utils.each(filterParseTree,function(operation) {\n\t\t// Create a function for the chain of operators in the operation\n\t\tvar operationSubFunction = function(source,widget) {\n\t\t\tvar accumulator = source,\n\t\t\t\tresults = [],\n\t\t\t\tcurrTiddlerTitle = widget &amp;&amp; widget.getVariable(\&quot;currentTiddler\&quot;);\n\t\t\t$tw.utils.each(operation.operators,function(operator) {\n\t\t\t\tvar operand = operator.operand,\n\t\t\t\t\toperatorFunction;\n\t\t\t\tif(!operator.operator) {\n\t\t\t\t\toperatorFunction = filterOperators.title;\n\t\t\t\t} else if(!filterOperators[operator.operator]) {\n\t\t\t\t\toperatorFunction = filterOperators.field;\n\t\t\t\t} else {\n\t\t\t\t\toperatorFunction = filterOperators[operator.operator];\n\t\t\t\t}\n\t\t\t\tif(operator.indirect) {\n\t\t\t\t\toperand = self.getTextReference(operator.operand,\&quot;\&quot;,currTiddlerTitle);\n\t\t\t\t}\n\t\t\t\tif(operator.variable) {\n\t\t\t\t\toperand = widget.getVariable(operator.operand,{defaultValue: \&quot;\&quot;});\n\t\t\t\t}\n\t\t\t\tresults = operatorFunction(accumulator,{\n\t\t\t\t\t\t\toperator: operator.operator,\n\t\t\t\t\t\t\toperand: operand,\n\t\t\t\t\t\t\tprefix: operator.prefix,\n\t\t\t\t\t\t\tsuffix: operator.suffix,\n\t\t\t\t\t\t\tregexp: operator.regexp\n\t\t\t\t\t\t},{\n\t\t\t\t\t\t\twiki: self,\n\t\t\t\t\t\t\twidget: widget\n\t\t\t\t\t\t});\n\t\t\t\tif($tw.utils.isArray(results)) {\n\t\t\t\t\taccumulator = self.makeTiddlerIterator(results);\n\t\t\t\t} else {\n\t\t\t\t\taccumulator = results;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif($tw.utils.isArray(results)) {\n\t\t\t\treturn results;\n\t\t\t} else {\n\t\t\t\tvar resultArray = [];\n\t\t\t\tresults(function(tiddler,title) {\n\t\t\t\t\tresultArray.push(title);\n\t\t\t\t});\n\t\t\t\treturn resultArray;\n\t\t\t}\n\t\t};\n\t\t// Wrap the operator functions in a wrapper function that depends on the prefix\n\t\toperationFunctions.push((function() {\n\t\t\tswitch(operation.prefix || \&quot;\&quot;) {\n\t\t\t\tcase \&quot;\&quot;: // No prefix means that the operation is unioned into the result\n\t\t\t\t\treturn function(results,source,widget) {\n\t\t\t\t\t\t$tw.utils.pushTop(results,operationSubFunction(source,widget));\n\t\t\t\t\t};\n\t\t\t\tcase \&quot;-\&quot;: // The results of this operation are removed from the main result\n\t\t\t\t\treturn function(results,source,widget) {\n\t\t\t\t\t\t$tw.utils.removeArrayEntries(results,operationSubFunction(source,widget));\n\t\t\t\t\t};\n\t\t\t\tcase \&quot;+\&quot;: // This operation is applied to the main results so far\n\t\t\t\t\treturn function(results,source,widget) {\n\t\t\t\t\t\t// This replaces all the elements of the array, but keeps the actual array so that references to it are preserved\n\t\t\t\t\t\tsource = self.makeTiddlerIterator(results);\n\t\t\t\t\t\tresults.splice(0,results.length);\n\t\t\t\t\t\t$tw.utils.pushTop(results,operationSubFunction(source,widget));\n\t\t\t\t\t};\n\t\t\t}\n\t\t})());\n\t});\n\t// Return a function that applies the operations to a source iterator of tiddler titles\n\treturn $tw.perf.measure(\&quot;filter\&quot;,function filterFunction(source,widget) {\n\t\tif(!source) {\n\t\t\tsource = self.each;\n\t\t} else if(typeof source === \&quot;object\&quot;) { // Array or hashmap\n\t\t\tsource = self.makeTiddlerIterator(source);\n\t\t}\n\t\tvar results = [];\n\t\t$tw.utils.each(operationFunctions,function(operationFunction) {\n\t\t\toperationFunction(results,source,widget);\n\t\t});\n\t\treturn results;\n\t});\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/filters.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikimethod&quot;
        },
        &quot;$:/core/modules/info/platform.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/info/platform.js\ntype: application/javascript\nmodule-type: info\n\nInitialise basic platform $:/info/ tiddlers\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.getInfoTiddlerFields = function() {\n\tvar mapBoolean = function(value) {return value ? \&quot;yes\&quot; : \&quot;no\&quot;;},\n\t\tinfoTiddlerFields = [];\n\t// Basics\n\tinfoTiddlerFields.push({title: \&quot;$:/info/browser\&quot;, text: mapBoolean(!!$tw.browser)});\n\tinfoTiddlerFields.push({title: \&quot;$:/info/node\&quot;, text: mapBoolean(!!$tw.node)});\n\treturn infoTiddlerFields;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/info/platform.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;info&quot;
        },
        &quot;$:/core/modules/language.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/language.js\ntype: application/javascript\nmodule-type: global\n\nThe $tw.Language() manages translateable strings\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nCreate an instance of the language manager. Options include:\nwiki: wiki from which to retrieve translation tiddlers\n*/\nfunction Language(options) {\n\toptions = options || \&quot;\&quot;;\n\tthis.wiki = options.wiki || $tw.wiki;\n}\n\n/*\nReturn a single translateable string. The title is automatically prefixed with \&quot;$:/language/\&quot;\nOptions include:\nvariables: optional hashmap of variables to supply to the language wikification\n*/\nLanguage.prototype.getString = function(title,options) {\n\toptions = options || {};\n\ttitle = \&quot;$:/language/\&quot; + title;\n\treturn this.wiki.renderTiddler(\&quot;text/plain\&quot;,title,{variables: options.variables});\n};\n\nexports.Language = Language;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/language.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;global&quot;
        },
        &quot;$:/core/modules/macros/changecount.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/macros/changecount.js\ntype: application/javascript\nmodule-type: macro\n\nMacro to return the changecount for the current tiddler\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInformation about this macro\n*/\n\nexports.name = \&quot;changecount\&quot;;\n\nexports.params = [];\n\n/*\nRun the macro\n*/\nexports.run = function() {\n\treturn this.wiki.getChangeCount(this.getVariable(\&quot;currentTiddler\&quot;)) + \&quot;\&quot;;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/macros/changecount.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;macro&quot;
        },
        &quot;$:/core/modules/macros/contrastcolour.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/macros/contrastcolour.js\ntype: application/javascript\nmodule-type: macro\n\nMacro to choose which of two colours has the highest contrast with a base colour\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInformation about this macro\n*/\n\nexports.name = \&quot;contrastcolour\&quot;;\n\nexports.params = [\n\t{name: \&quot;target\&quot;},\n\t{name: \&quot;fallbackTarget\&quot;},\n\t{name: \&quot;colourA\&quot;},\n\t{name: \&quot;colourB\&quot;}\n];\n\n/*\nRun the macro\n*/\nexports.run = function(target,fallbackTarget,colourA,colourB) {\n\tvar rgbTarget = $tw.utils.parseCSSColor(target) || $tw.utils.parseCSSColor(fallbackTarget);\n\tif(!rgbTarget) {\n\t\treturn colourA;\n\t}\n\t// Colour brightness formula derived from http://www.w3.org/WAI/ER/WD-AERT/#color-contrast\n\tvar rgbColourA = $tw.utils.parseCSSColor(colourA),\n\t\trgbColourB = $tw.utils.parseCSSColor(colourB),\n\t\tbrightnessTarget = rgbTarget[0] * 0.299 + rgbTarget[1] * 0.587 + rgbTarget[2] * 0.114,\n\t\tbrightnessA = rgbColourA[0] * 0.299 + rgbColourA[1] * 0.587 + rgbColourA[2] * 0.114,\n\t\tbrightnessB = rgbColourB[0] * 0.299 + rgbColourB[1] * 0.587 + rgbColourB[2] * 0.114;\n\treturn Math.abs(brightnessTarget - brightnessA) &gt; Math.abs(brightnessTarget - brightnessB) ? colourA : colourB;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/macros/contrastcolour.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;macro&quot;
        },
        &quot;$:/core/modules/macros/csvtiddlers.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/macros/csvtiddlers.js\ntype: application/javascript\nmodule-type: macro\n\nMacro to output tiddlers matching a filter to CSV\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInformation about this macro\n*/\n\nexports.name = \&quot;csvtiddlers\&quot;;\n\nexports.params = [\n\t{name: \&quot;filter\&quot;},\n\t{name: \&quot;format\&quot;},\n];\n\n/*\nRun the macro\n*/\nexports.run = function(filter,format) {\n\tvar self = this,\n\t\ttiddlers = this.wiki.filterTiddlers(filter),\n\t\ttiddler,\n\t\tfields = [],\n\t\tt,f;\n\t// Collect all the fields\n\tfor(t=0;t&lt;tiddlers.length; t++) {\n\t\ttiddler = this.wiki.getTiddler(tiddlers[t]);\n\t\tfor(f in tiddler.fields) {\n\t\t\tif(fields.indexOf(f) === -1) {\n\t\t\t\tfields.push(f);\n\t\t\t}\n\t\t}\n\t}\n\t// Sort the fields and bring the standard ones to the front\n\tfields.sort();\n\t\&quot;title text modified modifier created creator\&quot;.split(\&quot; \&quot;).reverse().forEach(function(value,index) {\n\t\tvar p = fields.indexOf(value);\n\t\tif(p !== -1) {\n\t\t\tfields.splice(p,1);\n\t\t\tfields.unshift(value)\n\t\t}\n\t});\n\t// Output the column headings\n\tvar output = [], row = [];\n\tfields.forEach(function(value) {\n\t\trow.push(quoteAndEscape(value))\n\t});\n\toutput.push(row.join(\&quot;,\&quot;));\n\t// Output each tiddler\n\tfor(var t=0;t&lt;tiddlers.length; t++) {\n\t\trow = [];\n\t\ttiddler = this.wiki.getTiddler(tiddlers[t]);\n\t\t\tfor(f=0; f&lt;fields.length; f++) {\n\t\t\t\trow.push(quoteAndEscape(tiddler ? tiddler.getFieldString(fields[f]) || \&quot;\&quot; : \&quot;\&quot;));\n\t\t\t}\n\t\toutput.push(row.join(\&quot;,\&quot;));\n\t}\n\treturn output.join(\&quot;\\n\&quot;);\n};\n\nfunction quoteAndEscape(value) {\n\treturn \&quot;\\\&quot;\&quot; + value.replace(/\&quot;/mg,\&quot;\\\&quot;\\\&quot;\&quot;) + \&quot;\\\&quot;\&quot;;\n}\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/macros/csvtiddlers.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;macro&quot;
        },
        &quot;$:/core/modules/macros/dumpvariables.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/macros/dumpvariables.js\ntype: application/javascript\nmodule-type: macro\n\nMacro to dump all active variable values\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInformation about this macro\n*/\n\nexports.name = \&quot;dumpvariables\&quot;;\n\nexports.params = [\n];\n\n/*\nRun the macro\n*/\nexports.run = function() {\n\tvar output = [\&quot;|!Variable |!Value |\&quot;],\n\t\tvariables = [], variable;\n\tfor(variable in this.variables) {\n\t\tvariables.push(variable);\n\t}\n\tvariables.sort();\n\tfor(var index=0; index&lt;variables.length; index++) {\n\t\tvar variable = variables[index];\n\t\toutput.push(\&quot;|\&quot; + variable + \&quot; |&lt;input size=50 value=&lt;&lt;\&quot; + variable + \&quot;&gt;&gt;/&gt; |\&quot;)\n\t}\n\treturn output.join(\&quot;\\n\&quot;);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/macros/dumpvariables.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;macro&quot;
        },
        &quot;$:/core/modules/macros/jsontiddlers.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/macros/jsontiddlers.js\ntype: application/javascript\nmodule-type: macro\n\nMacro to output tiddlers matching a filter to JSON\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInformation about this macro\n*/\n\nexports.name = \&quot;jsontiddlers\&quot;;\n\nexports.params = [\n\t{name: \&quot;filter\&quot;}\n];\n\n/*\nRun the macro\n*/\nexports.run = function(filter) {\n\tvar tiddlers = this.wiki.filterTiddlers(filter),\n\t\tdata = [];\n\tfor(var t=0;t&lt;tiddlers.length; t++) {\n\t\tvar tiddler = this.wiki.getTiddler(tiddlers[t]);\n\t\tif(tiddler) {\n\t\t\tvar fields = new Object();\n\t\t\tfor(var field in tiddler.fields) {\n\t\t\t\tfields[field] = tiddler.getFieldString(field);\n\t\t\t}\n\t\t\tdata.push(fields);\n\t\t}\n\t}\n\treturn JSON.stringify(data,null,$tw.config.preferences.jsonSpaces);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/macros/jsontiddlers.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;macro&quot;
        },
        &quot;$:/core/modules/macros/makedatauri.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/macros/makedatauri.js\ntype: application/javascript\nmodule-type: macro\n\nMacro to convert the content of a tiddler to a data URI\n\n&lt;&lt;makedatauri text:\&quot;Text to be converted\&quot; type:\&quot;text/vnd.tiddlywiki\&quot;&gt;&gt;\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInformation about this macro\n*/\n\nexports.name = \&quot;makedatauri\&quot;;\n\nexports.params = [\n\t{name: \&quot;text\&quot;},\n\t{name: \&quot;type\&quot;}\n];\n\n/*\nRun the macro\n*/\nexports.run = function(text,type) {\n\ttype = type || \&quot;text/vnd.tiddlywiki\&quot;;\n\tvar typeInfo = $tw.config.contentTypeInfo[type] || $tw.config.contentTypeInfo[\&quot;text/plain\&quot;],\n\t\tisBase64 = typeInfo.encoding === \&quot;base64\&quot;,\n\t\tparts = [];\n\tparts.push(\&quot;data:\&quot;);\n\tparts.push(type);\n\tparts.push(isBase64 ? \&quot;;base64\&quot; : \&quot;\&quot;);\n\tparts.push(\&quot;,\&quot;);\n\tparts.push(isBase64 ? text : encodeURIComponent(text));\n\treturn parts.join(\&quot;\&quot;);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/macros/makedatauri.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;macro&quot;
        },
        &quot;$:/core/modules/macros/now.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/macros/now.js\ntype: application/javascript\nmodule-type: macro\n\nMacro to return a formatted version of the current time\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInformation about this macro\n*/\n\nexports.name = \&quot;now\&quot;;\n\nexports.params = [\n\t{name: \&quot;format\&quot;}\n];\n\n/*\nRun the macro\n*/\nexports.run = function(format) {\n\treturn $tw.utils.formatDateString(new Date(),format || \&quot;0hh:0mm, DDth MMM YYYY\&quot;);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/macros/now.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;macro&quot;
        },
        &quot;$:/core/modules/macros/qualify.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/macros/qualify.js\ntype: application/javascript\nmodule-type: macro\n\nMacro to qualify a state tiddler title according\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInformation about this macro\n*/\n\nexports.name = \&quot;qualify\&quot;;\n\nexports.params = [\n\t{name: \&quot;title\&quot;}\n];\n\n/*\nRun the macro\n*/\nexports.run = function(title) {\n\treturn title + \&quot;-\&quot; + this.getStateQualifier();\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/macros/qualify.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;macro&quot;
        },
        &quot;$:/core/modules/macros/version.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/macros/version.js\ntype: application/javascript\nmodule-type: macro\n\nMacro to return the TiddlyWiki core version number\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInformation about this macro\n*/\n\nexports.name = \&quot;version\&quot;;\n\nexports.params = [];\n\n/*\nRun the macro\n*/\nexports.run = function() {\n\treturn $tw.version;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/macros/version.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;macro&quot;
        },
        &quot;$:/core/modules/parsers/audioparser.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/audioparser.js\ntype: application/javascript\nmodule-type: parser\n\nThe audio parser parses an audio tiddler into an embeddable HTML element\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar AudioParser = function(type,text,options) {\n\tvar element = {\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\ttag: \&quot;audio\&quot;,\n\t\t\tattributes: {\n\t\t\t\tcontrols: {type: \&quot;string\&quot;, value: \&quot;controls\&quot;}\n\t\t\t}\n\t\t},\n\t\tsrc;\n\tif(options._canonical_uri) {\n\t\telement.attributes.src = {type: \&quot;string\&quot;, value: options._canonical_uri};\n\t} else if(text) {\n\t\telement.attributes.src = {type: \&quot;string\&quot;, value: \&quot;data:\&quot; + type + \&quot;;base64,\&quot; + text};\n\t}\n\tthis.tree = [element];\n};\n\nexports[\&quot;audio/ogg\&quot;] = AudioParser;\nexports[\&quot;audio/mpeg\&quot;] = AudioParser;\nexports[\&quot;audio/mp3\&quot;] = AudioParser;\nexports[\&quot;audio/mp4\&quot;] = AudioParser;\n\n})();\n\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/audioparser.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;parser&quot;
        },
        &quot;$:/core/modules/parsers/csvparser.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/csvparser.js\ntype: application/javascript\nmodule-type: parser\n\nThe CSV text parser processes CSV files into a table wrapped in a scrollable widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar CsvParser = function(type,text,options) {\n\t// Table framework\n\tthis.tree = [{\n\t\t\&quot;type\&quot;: \&quot;scrollable\&quot;, \&quot;children\&quot;: [{\n\t\t\t\&quot;type\&quot;: \&quot;element\&quot;, \&quot;tag\&quot;: \&quot;table\&quot;, \&quot;children\&quot;: [{\n\t\t\t\t\&quot;type\&quot;: \&quot;element\&quot;, \&quot;tag\&quot;: \&quot;tbody\&quot;, \&quot;children\&quot;: []\n\t\t\t}], \&quot;attributes\&quot;: {\n\t\t\t\t\&quot;class\&quot;: {\&quot;type\&quot;: \&quot;string\&quot;, \&quot;value\&quot;: \&quot;tc-csv-table\&quot;}\n\t\t\t}\n\t\t}]\n\t}];\n\t// Split the text into lines\n\tvar lines = text.split(/\\r?\\n/mg),\n\t\ttag = \&quot;th\&quot;;\n\tfor(var line=0; line&lt;lines.length; line++) {\n\t\tvar lineText = lines[line];\n\t\tif(lineText) {\n\t\t\tvar row = {\n\t\t\t\t\t\&quot;type\&quot;: \&quot;element\&quot;, \&quot;tag\&quot;: \&quot;tr\&quot;, \&quot;children\&quot;: []\n\t\t\t\t};\n\t\t\tvar columns = lineText.split(\&quot;,\&quot;);\n\t\t\tfor(var column=0; column&lt;columns.length; column++) {\n\t\t\t\trow.children.push({\n\t\t\t\t\t\t\&quot;type\&quot;: \&quot;element\&quot;, \&quot;tag\&quot;: tag, \&quot;children\&quot;: [{\n\t\t\t\t\t\t\t\&quot;type\&quot;: \&quot;text\&quot;,\n\t\t\t\t\t\t\t\&quot;text\&quot;: columns[column]\n\t\t\t\t\t\t}]\n\t\t\t\t\t});\n\t\t\t}\n\t\t\ttag = \&quot;td\&quot;;\n\t\t\tthis.tree[0].children[0].children[0].children.push(row);\n\t\t}\n\t}\n};\n\nexports[\&quot;text/csv\&quot;] = CsvParser;\n\n})();\n\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/csvparser.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;parser&quot;
        },
        &quot;$:/core/modules/parsers/htmlparser.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/htmlparser.js\ntype: application/javascript\nmodule-type: parser\n\nThe HTML parser displays text as raw HTML\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar HtmlParser = function(type,text,options) {\n\tvar src;\n\tif(options._canonical_uri) {\n\t\tsrc = options._canonical_uri;\n\t} else if(text) {\n\t\tsrc = \&quot;data:text/html;charset=utf-8,\&quot; + encodeURIComponent(text);\n\t}\n\tthis.tree = [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;iframe\&quot;,\n\t\tattributes: {\n\t\t\tsrc: {type: \&quot;string\&quot;, value: src}\n\t\t}\n\t}];\n};\n\nexports[\&quot;text/html\&quot;] = HtmlParser;\n\n})();\n\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/htmlparser.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;parser&quot;
        },
        &quot;$:/core/modules/parsers/imageparser.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/imageparser.js\ntype: application/javascript\nmodule-type: parser\n\nThe image parser parses an image into an embeddable HTML element\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar ImageParser = function(type,text,options) {\n\tvar element = {\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\ttag: \&quot;img\&quot;,\n\t\t\tattributes: {}\n\t\t},\n\t\tsrc;\n\tif(options._canonical_uri) {\n\t\telement.attributes.src = {type: \&quot;string\&quot;, value: options._canonical_uri};\n\t\tif(type === \&quot;application/pdf\&quot; || type === \&quot;.pdf\&quot;) {\n\t\t\telement.tag = \&quot;embed\&quot;;\n\t\t}\n\t} else if(text) {\n\t\tif(type === \&quot;application/pdf\&quot; || type === \&quot;.pdf\&quot;) {\n\t\t\telement.attributes.src = {type: \&quot;string\&quot;, value: \&quot;data:application/pdf;base64,\&quot; + text};\n\t\t\telement.tag = \&quot;embed\&quot;;\n\t\t} else if(type === \&quot;image/svg+xml\&quot; || type === \&quot;.svg\&quot;) {\n\t\t\telement.attributes.src = {type: \&quot;string\&quot;, value: \&quot;data:image/svg+xml,\&quot; + encodeURIComponent(text)};\n\t\t} else {\n\t\t\telement.attributes.src = {type: \&quot;string\&quot;, value: \&quot;data:\&quot; + type + \&quot;;base64,\&quot; + text};\n\t\t}\n\t}\n\tthis.tree = [element];\n};\n\nexports[\&quot;image/svg+xml\&quot;] = ImageParser;\nexports[\&quot;image/jpg\&quot;] = ImageParser;\nexports[\&quot;image/jpeg\&quot;] = ImageParser;\nexports[\&quot;image/png\&quot;] = ImageParser;\nexports[\&quot;image/gif\&quot;] = ImageParser;\nexports[\&quot;application/pdf\&quot;] = ImageParser;\nexports[\&quot;image/x-icon\&quot;] = ImageParser;\n\n})();\n\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/imageparser.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;parser&quot;
        },
        &quot;$:/core/modules/utils/parseutils.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/parseutils.js\ntype: application/javascript\nmodule-type: utils\n\nUtility functions concerned with parsing text into tokens.\n\nMost functions have the following pattern:\n\n* The parameters are:\n** `source`: the source string being parsed\n** `pos`: the current parse position within the string\n** Any further parameters are used to identify the token that is being parsed\n* The return value is:\n** null if the token was not found at the specified position\n** an object representing the token with the following standard fields:\n*** `type`: string indicating the type of the token\n*** `start`: start position of the token in the source string\n*** `end`: end position of the token in the source string\n*** Any further fields required to describe the token\n\nThe exception is `skipWhiteSpace`, which just returns the position after the whitespace.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nLook for a whitespace token. Returns null if not found, otherwise returns {type: \&quot;whitespace\&quot;, start:, end:,}\n*/\nexports.parseWhiteSpace = function(source,pos) {\n\tvar node = {\n\t\ttype: \&quot;whitespace\&quot;,\n\t\tstart: pos\n\t};\n\tvar re = /(\\s)+/g;\n\tre.lastIndex = pos;\n\tvar match = re.exec(source);\n\tif(match &amp;&amp; match.index === pos) {\n\t\tnode.end = pos + match[0].length;\n\t\treturn node;\n\t}\n\treturn null;\n};\n\n/*\nConvenience wrapper for parseWhiteSpace. Returns the position after the whitespace\n*/\nexports.skipWhiteSpace = function(source,pos) {\n\tvar whitespace = $tw.utils.parseWhiteSpace(source,pos);\n\tif(whitespace) {\n\t\treturn whitespace.end;\n\t}\n\treturn pos;\n};\n\n/*\nLook for a given string token. Returns null if not found, otherwise returns {type: \&quot;token\&quot;, value:, start:, end:,}\n*/\nexports.parseTokenString = function(source,pos,token) {\n\tvar match = source.indexOf(token,pos) === pos;\n\tif(match) {\n\t\treturn {\n\t\t\ttype: \&quot;token\&quot;,\n\t\t\tvalue: token,\n\t\t\tstart: pos,\n\t\t\tend: pos + token.length\n\t\t};\n\t}\n\treturn null;\n};\n\n/*\nLook for a token matching a regex. Returns null if not found, otherwise returns {type: \&quot;regexp\&quot;, match:, start:, end:,}\n*/\nexports.parseTokenRegExp = function(source,pos,reToken) {\n\tvar node = {\n\t\ttype: \&quot;regexp\&quot;,\n\t\tstart: pos\n\t};\n\treToken.lastIndex = pos;\n\tnode.match = reToken.exec(source);\n\tif(node.match &amp;&amp; node.match.index === pos) {\n\t\tnode.end = pos + node.match[0].length;\n\t\treturn node;\n\t} else {\n\t\treturn null;\n\t}\n};\n\n/*\nLook for a string literal. Returns null if not found, otherwise returns {type: \&quot;string\&quot;, value:, start:, end:,}\n*/\nexports.parseStringLiteral = function(source,pos) {\n\tvar node = {\n\t\ttype: \&quot;string\&quot;,\n\t\tstart: pos\n\t};\n\tvar reString = /(?:\&quot;\&quot;\&quot;([\\s\\S]*?)\&quot;\&quot;\&quot;|\&quot;([^\&quot;]*)\&quot;)|(?:'([^']*)')/g;\n\treString.lastIndex = pos;\n\tvar match = reString.exec(source);\n\tif(match &amp;&amp; match.index === pos) {\n\t\tnode.value = match[1] !== undefined ? match[1] :(\n\t\t\tmatch[2] !== undefined ? match[2] : match[3] \n\t\t\t\t\t);\n\t\tnode.end = pos + match[0].length;\n\t\treturn node;\n\t} else {\n\t\treturn null;\n\t}\n};\n\n/*\nLook for a macro invocation parameter. Returns null if not found, or {type: \&quot;macro-parameter\&quot;, name:, value:, start:, end:}\n*/\nexports.parseMacroParameter = function(source,pos) {\n\tvar node = {\n\t\ttype: \&quot;macro-parameter\&quot;,\n\t\tstart: pos\n\t};\n\t// Define our regexp\n\tvar reMacroParameter = /(?:([A-Za-z0-9\\-_]+)\\s*:)?(?:\\s*(?:\&quot;\&quot;\&quot;([\\s\\S]*?)\&quot;\&quot;\&quot;|\&quot;([^\&quot;]*)\&quot;|'([^']*)'|\\[\\[([^\\]]*)\\]\\]|([^\\s&gt;\&quot;'=]+)))/g;\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Look for the parameter\n\tvar token = $tw.utils.parseTokenRegExp(source,pos,reMacroParameter);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tpos = token.end;\n\t// Get the parameter details\n\tnode.value = token.match[2] !== undefined ? token.match[2] : (\n\t\t\t\t\ttoken.match[3] !== undefined ? token.match[3] : (\n\t\t\t\t\t\ttoken.match[4] !== undefined ? token.match[4] : (\n\t\t\t\t\t\t\ttoken.match[5] !== undefined ? token.match[5] : (\n\t\t\t\t\t\t\t\ttoken.match[6] !== undefined ? token.match[6] : (\n\t\t\t\t\t\t\t\t\t\&quot;\&quot;\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\tif(token.match[1]) {\n\t\tnode.name = token.match[1];\n\t}\n\t// Update the end position\n\tnode.end = pos;\n\treturn node;\n};\n\n/*\nLook for a macro invocation. Returns null if not found, or {type: \&quot;macrocall\&quot;, name:, parameters:, start:, end:}\n*/\nexports.parseMacroInvocation = function(source,pos) {\n\tvar node = {\n\t\ttype: \&quot;macrocall\&quot;,\n\t\tstart: pos,\n\t\tparams: []\n\t};\n\t// Define our regexps\n\tvar reMacroName = /([^\\s&gt;\&quot;'=]+)/g;\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Look for a double less than sign\n\tvar token = $tw.utils.parseTokenString(source,pos,\&quot;&lt;&lt;\&quot;);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tpos = token.end;\n\t// Get the macro name\n\tvar name = $tw.utils.parseTokenRegExp(source,pos,reMacroName);\n\tif(!name) {\n\t\treturn null;\n\t}\n\tnode.name = name.match[1];\n\tpos = name.end;\n\t// Process parameters\n\tvar parameter = $tw.utils.parseMacroParameter(source,pos);\n\twhile(parameter) {\n\t\tnode.params.push(parameter);\n\t\tpos = parameter.end;\n\t\t// Get the next parameter\n\t\tparameter = $tw.utils.parseMacroParameter(source,pos);\n\t}\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Look for a double greater than sign\n\ttoken = $tw.utils.parseTokenString(source,pos,\&quot;&gt;&gt;\&quot;);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tpos = token.end;\n\t// Update the end position\n\tnode.end = pos;\n\treturn node;\n};\n\n/*\nLook for an HTML attribute definition. Returns null if not found, otherwise returns {type: \&quot;attribute\&quot;, name:, valueType: \&quot;string|indirect|macro\&quot;, value:, start:, end:,}\n*/\nexports.parseAttribute = function(source,pos) {\n\tvar node = {\n\t\tstart: pos\n\t};\n\t// Define our regexps\n\tvar reAttributeName = /([^\\/\\s&gt;\&quot;'=]+)/g,\n\t\treUnquotedAttribute = /([^\\/\\s&lt;&gt;\&quot;'=]+)/g,\n\t\treIndirectValue = /\\{\\{([^\\}]+)\\}\\}/g;\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Get the attribute name\n\tvar name = $tw.utils.parseTokenRegExp(source,pos,reAttributeName);\n\tif(!name) {\n\t\treturn null;\n\t}\n\tnode.name = name.match[1];\n\tpos = name.end;\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Look for an equals sign\n\tvar token = $tw.utils.parseTokenString(source,pos,\&quot;=\&quot;);\n\tif(token) {\n\t\tpos = token.end;\n\t\t// Skip whitespace\n\t\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t\t// Look for a string literal\n\t\tvar stringLiteral = $tw.utils.parseStringLiteral(source,pos);\n\t\tif(stringLiteral) {\n\t\t\tpos = stringLiteral.end;\n\t\t\tnode.type = \&quot;string\&quot;;\n\t\t\tnode.value = stringLiteral.value;\n\t\t} else {\n\t\t\t// Look for an indirect value\n\t\t\tvar indirectValue = $tw.utils.parseTokenRegExp(source,pos,reIndirectValue);\n\t\t\tif(indirectValue) {\n\t\t\t\tpos = indirectValue.end;\n\t\t\t\tnode.type = \&quot;indirect\&quot;;\n\t\t\t\tnode.textReference = indirectValue.match[1];\n\t\t\t} else {\n\t\t\t\t// Look for a unquoted value\n\t\t\t\tvar unquotedValue = $tw.utils.parseTokenRegExp(source,pos,reUnquotedAttribute);\n\t\t\t\tif(unquotedValue) {\n\t\t\t\t\tpos = unquotedValue.end;\n\t\t\t\t\tnode.type = \&quot;string\&quot;;\n\t\t\t\t\tnode.value = unquotedValue.match[1];\n\t\t\t\t} else {\n\t\t\t\t\t// Look for a macro invocation value\n\t\t\t\t\tvar macroInvocation = $tw.utils.parseMacroInvocation(source,pos);\n\t\t\t\t\tif(macroInvocation) {\n\t\t\t\t\t\tpos = macroInvocation.end;\n\t\t\t\t\t\tnode.type = \&quot;macro\&quot;;\n\t\t\t\t\t\tnode.value = macroInvocation;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnode.type = \&quot;string\&quot;;\n\t\t\t\t\t\tnode.value = \&quot;true\&quot;;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tnode.type = \&quot;string\&quot;;\n\t\tnode.value = \&quot;true\&quot;;\n\t}\n\t// Update the end position\n\tnode.end = pos;\n\treturn node;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/parseutils.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/parsers/textparser.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/textparser.js\ntype: application/javascript\nmodule-type: parser\n\nThe plain text parser processes blocks of source text into a degenerate parse tree consisting of a single text node\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar TextParser = function(type,text,options) {\n\tthis.tree = [{\n\t\ttype: \&quot;codeblock\&quot;,\n\t\tattributes: {\n\t\t\tcode: {type: \&quot;string\&quot;, value: text},\n\t\t\tlanguage: {type: \&quot;string\&quot;, value: type}\n\t\t}\n\t}];\n};\n\nexports[\&quot;text/plain\&quot;] = TextParser;\nexports[\&quot;text/x-tiddlywiki\&quot;] = TextParser;\nexports[\&quot;application/javascript\&quot;] = TextParser;\nexports[\&quot;application/json\&quot;] = TextParser;\nexports[\&quot;text/css\&quot;] = TextParser;\nexports[\&quot;application/x-tiddler-dictionary\&quot;] = TextParser;\n\n})();\n\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/textparser.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;parser&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/codeblock.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/codeblock.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text rule for code blocks. For example:\n\n```\n\t```\n\tThis text will not be //wikified//\n\t```\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;codeblock\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match and get language if defined\n\tthis.matchRegExp = /```([\\w-]*)\\r?\\n/mg;\n};\n\nexports.parse = function() {\n\tvar reEnd = /(\\r?\\n```$)/mg;\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\n\t// Look for the end of the block\n\treEnd.lastIndex = this.parser.pos;\n\tvar match = reEnd.exec(this.parser.source),\n\t\ttext;\n\t// Process the block\n\tif(match) {\n\t\ttext = this.parser.source.substring(this.parser.pos,match.index);\n\t\tthis.parser.pos = match.index + match[0].length;\n\t} else {\n\t\ttext = this.parser.source.substr(this.parser.pos);\n\t\tthis.parser.pos = this.parser.sourceLength;\n\t}\n\t// Return the $codeblock widget\n\treturn [{\n\t\t\ttype: \&quot;codeblock\&quot;,\n\t\t\tattributes: {\n\t\t\t\t\tcode: {type: \&quot;string\&quot;, value: text},\n\t\t\t\t\tlanguage: {type: \&quot;string\&quot;, value: this.match[1]}\n\t\t\t}\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/codeblock.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/codeinline.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/codeinline.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for code runs. For example:\n\n```\n\tThis is a `code run`.\n\tThis is another ``code run``\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;codeinline\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /(``?)/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\tvar reEnd = new RegExp(this.match[1], \&quot;mg\&quot;);\n\t// Look for the end marker\n\treEnd.lastIndex = this.parser.pos;\n\tvar match = reEnd.exec(this.parser.source),\n\t\ttext;\n\t// Process the text\n\tif(match) {\n\t\ttext = this.parser.source.substring(this.parser.pos,match.index);\n\t\tthis.parser.pos = match.index + match[0].length;\n\t} else {\n\t\ttext = this.parser.source.substr(this.parser.pos);\n\t\tthis.parser.pos = this.parser.sourceLength;\n\t}\n\treturn [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;code\&quot;,\n\t\tchildren: [{\n\t\t\ttype: \&quot;text\&quot;,\n\t\t\ttext: text\n\t\t}]\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/codeinline.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/commentblock.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/commentblock.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text block rule for HTML comments. For example:\n\n```\n&lt;!-- This is a comment --&gt;\n```\n\nNote that the syntax for comments is simplified to an opening \&quot;&lt;!--\&quot; sequence and a closing \&quot;--&gt;\&quot; sequence -- HTML itself implements a more complex format (see http://ostermiller.org/findhtmlcomment.html)\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;commentblock\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\tthis.matchRegExp = /&lt;!--/mg;\n\tthis.endMatchRegExp = /--&gt;/mg;\n};\n\nexports.findNextMatch = function(startPos) {\n\tthis.matchRegExp.lastIndex = startPos;\n\tthis.match = this.matchRegExp.exec(this.parser.source);\n\tif(this.match) {\n\t\tthis.endMatchRegExp.lastIndex = startPos + this.match[0].length;\n\t\tthis.endMatch = this.endMatchRegExp.exec(this.parser.source);\n\t\tif(this.endMatch) {\n\t\t\treturn this.match.index;\n\t\t}\n\t}\n\treturn undefined;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.endMatchRegExp.lastIndex;\n\t// Don't return any elements\n\treturn [];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/commentblock.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/commentinline.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/commentinline.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for HTML comments. For example:\n\n```\n&lt;!-- This is a comment --&gt;\n```\n\nNote that the syntax for comments is simplified to an opening \&quot;&lt;!--\&quot; sequence and a closing \&quot;--&gt;\&quot; sequence -- HTML itself implements a more complex format (see http://ostermiller.org/findhtmlcomment.html)\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;commentinline\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\tthis.matchRegExp = /&lt;!--/mg;\n\tthis.endMatchRegExp = /--&gt;/mg;\n};\n\nexports.findNextMatch = function(startPos) {\n\tthis.matchRegExp.lastIndex = startPos;\n\tthis.match = this.matchRegExp.exec(this.parser.source);\n\tif(this.match) {\n\t\tthis.endMatchRegExp.lastIndex = startPos + this.match[0].length;\n\t\tthis.endMatch = this.endMatchRegExp.exec(this.parser.source);\n\t\tif(this.endMatch) {\n\t\t\treturn this.match.index;\n\t\t}\n\t}\n\treturn undefined;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.endMatchRegExp.lastIndex;\n\t// Don't return any elements\n\treturn [];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/commentinline.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/dash.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/dash.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for dashes. For example:\n\n```\nThis is an en-dash: --\n\nThis is an em-dash: ---\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;dash\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /-{2,3}(?!-)/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\tvar dash = this.match[0].length === 2 ? \&quot;&amp;ndash;\&quot; : \&quot;&amp;mdash;\&quot;;\n\treturn [{\n\t\ttype: \&quot;entity\&quot;,\n\t\tentity: dash\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/dash.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/bold.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/emphasis/bold.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for emphasis - bold. For example:\n\n```\n\tThis is ''bold'' text\n```\n\nThis wikiparser can be modified using the rules eg:\n\n```\n\\rules except bold \n\\rules only bold \n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;bold\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /''/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\n\t// Parse the run including the terminator\n\tvar tree = this.parser.parseInlineRun(/''/mg,{eatTerminator: true});\n\n\t// Return the classed span\n\treturn [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;strong\&quot;,\n\t\tchildren: tree\n\t}];\n};\n\n})();&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/bold.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/italic.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/emphasis/italic.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for emphasis - italic. For example:\n\n```\n\tThis is //italic// text\n```\n\nThis wikiparser can be modified using the rules eg:\n\n```\n\\rules except italic\n\\rules only italic\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;italic\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /\\/\\//mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\n\t// Parse the run including the terminator\n\tvar tree = this.parser.parseInlineRun(/\\/\\//mg,{eatTerminator: true});\n\n\t// Return the classed span\n\treturn [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;em\&quot;,\n\t\tchildren: tree\n\t}];\n};\n\n})();&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/italic.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/strikethrough.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/emphasis/strikethrough.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for emphasis - strikethrough. For example:\n\n```\n\tThis is ~~strikethrough~~ text\n```\n\nThis wikiparser can be modified using the rules eg:\n\n```\n\\rules except strikethrough \n\\rules only strikethrough \n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;strikethrough\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /~~/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\n\t// Parse the run including the terminator\n\tvar tree = this.parser.parseInlineRun(/~~/mg,{eatTerminator: true});\n\n\t// Return the classed span\n\treturn [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;strike\&quot;,\n\t\tchildren: tree\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/strikethrough.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/subscript.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/emphasis/subscript.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for emphasis - subscript. For example:\n\n```\n\tThis is ,,subscript,, text\n```\n\nThis wikiparser can be modified using the rules eg:\n\n```\n\\rules except subscript \n\\rules only subscript \n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;subscript\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /,,/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\n\t// Parse the run including the terminator\n\tvar tree = this.parser.parseInlineRun(/,,/mg,{eatTerminator: true});\n\n\t// Return the classed span\n\treturn [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;sub\&quot;,\n\t\tchildren: tree\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/subscript.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/superscript.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/emphasis/superscript.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for emphasis - superscript. For example:\n\n```\n\tThis is ^^superscript^^ text\n```\n\nThis wikiparser can be modified using the rules eg:\n\n```\n\\rules except superscript \n\\rules only superscript \n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;superscript\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /\\^\\^/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\n\t// Parse the run including the terminator\n\tvar tree = this.parser.parseInlineRun(/\\^\\^/mg,{eatTerminator: true});\n\n\t// Return the classed span\n\treturn [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;sup\&quot;,\n\t\tchildren: tree\n\t}];\n};\n\n})();&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/superscript.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/underscore.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/emphasis/underscore.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for emphasis - underscore. For example:\n\n```\n\tThis is __underscore__ text\n```\n\nThis wikiparser can be modified using the rules eg:\n\n```\n\\rules except underscore \n\\rules only underscore\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;underscore\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /__/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\n\t// Parse the run including the terminator\n\tvar tree = this.parser.parseInlineRun(/__/mg,{eatTerminator: true});\n\n\t// Return the classed span\n\treturn [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;u\&quot;,\n\t\tchildren: tree\n\t}];\n};\n\n})();&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/emphasis/underscore.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/entity.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/entity.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for HTML entities. For example:\n\n```\n\tThis is a copyright symbol: &amp;copy;\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;entity\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /(&amp;#?[a-zA-Z0-9]{2,8};)/mg;\n};\n\n/*\nParse the most recent match\n*/\nexports.parse = function() {\n\t// Get all the details of the match\n\tvar entityString = this.match[1];\n\t// Move past the macro call\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Return the entity\n\treturn [{type: \&quot;entity\&quot;, entity: this.match[0]}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/entity.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/extlink.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/extlink.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for external links. For example:\n\n```\nAn external link: http://www.tiddlywiki.com/\n\nA suppressed external link: ~http://www.tiddlyspace.com/\n```\n\nExternal links can be suppressed by preceding them with `~`.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;extlink\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /~?(?:file|http|https|mailto|ftp|irc|news|data|skype):[^\\s&lt;&gt;{}\\[\\]`|'\&quot;\\\\^~]+(?:\\/|\\b)/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Create the link unless it is suppressed\n\tif(this.match[0].substr(0,1) === \&quot;~\&quot;) {\n\t\treturn [{type: \&quot;text\&quot;, text: this.match[0].substr(1)}];\n\t} else {\n\t\treturn [{\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\ttag: \&quot;a\&quot;,\n\t\t\tattributes: {\n\t\t\t\thref: {type: \&quot;string\&quot;, value: this.match[0]},\n\t\t\t\t\&quot;class\&quot;: {type: \&quot;string\&quot;, value: \&quot;tc-tiddlylink-external\&quot;},\n\t\t\t\ttarget: {type: \&quot;string\&quot;, value: \&quot;_blank\&quot;}\n\t\t\t},\n\t\t\tchildren: [{\n\t\t\t\ttype: \&quot;text\&quot;, text: this.match[0]\n\t\t\t}]\n\t\t}];\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/extlink.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/filteredtranscludeblock.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/filteredtranscludeblock.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text rule for block-level filtered transclusion. For example:\n\n```\n{{{ [tag[docs]] }}}\n{{{ [tag[docs]] |tooltip}}}\n{{{ [tag[docs]] ||TemplateTitle}}}\n{{{ [tag[docs]] |tooltip||TemplateTitle}}}\n{{{ [tag[docs]] }}width:40;height:50;}.class.class\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;filteredtranscludeblock\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /\\{\\{\\{([^\\|]+?)(?:\\|([^\\|\\{\\}]+))?(?:\\|\\|([^\\|\\{\\}]+))?\\}\\}([^\\}]*)\\}(?:\\.(\\S+))?(?:\\r?\\n|$)/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Get the match details\n\tvar filter = this.match[1],\n\t\ttooltip = this.match[2],\n\t\ttemplate = $tw.utils.trim(this.match[3]),\n\t\tstyle = this.match[4],\n\t\tclasses = this.match[5];\n\t// Return the list widget\n\tvar node = {\n\t\ttype: \&quot;list\&quot;,\n\t\tattributes: {\n\t\t\tfilter: {type: \&quot;string\&quot;, value: filter}\n\t\t},\n\t\tisBlock: true\n\t};\n\tif(tooltip) {\n\t\tnode.attributes.tooltip = {type: \&quot;string\&quot;, value: tooltip};\n\t}\n\tif(template) {\n\t\tnode.attributes.template = {type: \&quot;string\&quot;, value: template};\n\t}\n\tif(style) {\n\t\tnode.attributes.style = {type: \&quot;string\&quot;, value: style};\n\t}\n\tif(classes) {\n\t\tnode.attributes.itemClass = {type: \&quot;string\&quot;, value: classes.split(\&quot;.\&quot;).join(\&quot; \&quot;)};\n\t}\n\treturn [node];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/filteredtranscludeblock.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/filteredtranscludeinline.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/filteredtranscludeinline.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text rule for inline filtered transclusion. For example:\n\n```\n{{{ [tag[docs]] }}}\n{{{ [tag[docs]] |tooltip}}}\n{{{ [tag[docs]] ||TemplateTitle}}}\n{{{ [tag[docs]] |tooltip||TemplateTitle}}}\n{{{ [tag[docs]] }}width:40;height:50;}.class.class\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;filteredtranscludeinline\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /\\{\\{\\{([^\\|]+?)(?:\\|([^\\|\\{\\}]+))?(?:\\|\\|([^\\|\\{\\}]+))?\\}\\}([^\\}]*)\\}(?:\\.(\\S+))?/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Get the match details\n\tvar filter = this.match[1],\n\t\ttooltip = this.match[2],\n\t\ttemplate = $tw.utils.trim(this.match[3]),\n\t\tstyle = this.match[4],\n\t\tclasses = this.match[5];\n\t// Return the list widget\n\tvar node = {\n\t\ttype: \&quot;list\&quot;,\n\t\tattributes: {\n\t\t\tfilter: {type: \&quot;string\&quot;, value: filter}\n\t\t}\n\t};\n\tif(tooltip) {\n\t\tnode.attributes.tooltip = {type: \&quot;string\&quot;, value: tooltip};\n\t}\n\tif(template) {\n\t\tnode.attributes.template = {type: \&quot;string\&quot;, value: template};\n\t}\n\tif(style) {\n\t\tnode.attributes.style = {type: \&quot;string\&quot;, value: style};\n\t}\n\tif(classes) {\n\t\tnode.attributes.itemClass = {type: \&quot;string\&quot;, value: classes.split(\&quot;.\&quot;).join(\&quot; \&quot;)};\n\t}\n\treturn [node];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/filteredtranscludeinline.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/hardlinebreaks.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/hardlinebreaks.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for marking areas with hard line breaks. For example:\n\n```\n\&quot;\&quot;\&quot;\nThis is some text\nThat is set like\nIt is a Poem\nWhen it is\nClearly\nNot\n\&quot;\&quot;\&quot;\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;hardlinebreaks\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /\&quot;\&quot;\&quot;(?:\\r?\\n)?/mg;\n};\n\nexports.parse = function() {\n\tvar reEnd = /(\&quot;\&quot;\&quot;)|(\\r?\\n)/mg,\n\t\ttree = [],\n\t\tmatch;\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\tdo {\n\t\t// Parse the run up to the terminator\n\t\ttree.push.apply(tree,this.parser.parseInlineRun(reEnd,{eatTerminator: false}));\n\t\t// Redo the terminator match\n\t\treEnd.lastIndex = this.parser.pos;\n\t\tmatch = reEnd.exec(this.parser.source);\n\t\tif(match) {\n\t\t\tthis.parser.pos = reEnd.lastIndex;\n\t\t\t// Add a line break if the terminator was a line break\n\t\t\tif(match[2]) {\n\t\t\t\ttree.push({type: \&quot;element\&quot;, tag: \&quot;br\&quot;});\n\t\t\t}\n\t\t}\n\t} while(match &amp;&amp; !match[1]);\n\t// Return the nodes\n\treturn tree;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/hardlinebreaks.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/heading.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/heading.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text block rule for headings\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;heading\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /(!{1,6})/mg;\n};\n\n/*\nParse the most recent match\n*/\nexports.parse = function() {\n\t// Get all the details of the match\n\tvar headingLevel = this.match[1].length;\n\t// Move past the !s\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Parse any classes, whitespace and then the heading itself\n\tvar classes = this.parser.parseClasses();\n\tthis.parser.skipWhitespace({treatNewlinesAsNonWhitespace: true});\n\tvar tree = this.parser.parseInlineRun(/(\\r?\\n)/mg);\n\t// Return the heading\n\treturn [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;h\&quot; + headingLevel, \n\t\tattributes: {\n\t\t\t\&quot;class\&quot;: {type: \&quot;string\&quot;, value: classes.join(\&quot; \&quot;)}\n\t\t},\n\t\tchildren: tree\n\t}];\n};\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/heading.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/horizrule.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/horizrule.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text block rule for rules. For example:\n\n```\n---\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;horizrule\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /-{3,}\\r?(?:\\n|$)/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\treturn [{type: \&quot;element\&quot;, tag: \&quot;hr\&quot;}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/horizrule.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/html.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/html.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki rule for HTML elements and widgets. For example:\n\n{{{\n&lt;aside&gt;\nThis is an HTML5 aside element\n&lt;/aside&gt;\n\n&lt;$slider target=\&quot;MyTiddler\&quot;&gt;\nThis is a widget invocation\n&lt;/$slider&gt;\n\n}}}\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;html\&quot;;\nexports.types = {inline: true, block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n};\n\nexports.findNextMatch = function(startPos) {\n\t// Find the next tag\n\tthis.nextTag = this.findNextTag(this.parser.source,startPos,{\n\t\trequireLineBreak: this.is.block\n\t});\n\treturn this.nextTag ? this.nextTag.start : undefined;\n};\n\n/*\nParse the most recent match\n*/\nexports.parse = function() {\n\t// Retrieve the most recent match so that recursive calls don't overwrite it\n\tvar tag = this.nextTag;\n\tthis.nextTag = null;\n\t// Advance the parser position to past the tag\n\tthis.parser.pos = tag.end;\n\t// Check for an immediately following double linebreak\n\tvar hasLineBreak = !tag.isSelfClosing &amp;&amp; !!$tw.utils.parseTokenRegExp(this.parser.source,this.parser.pos,/([^\\S\\n\\r]*\\r?\\n(?:[^\\S\\n\\r]*\\r?\\n|$))/g);\n\t// Set whether we're in block mode\n\ttag.isBlock = this.is.block || hasLineBreak;\n\t// Parse the body if we need to\n\tif(!tag.isSelfClosing &amp;&amp; $tw.config.htmlVoidElements.indexOf(tag.tag) === -1) {\n\t\t\tvar reEndString = \&quot;&lt;/\&quot; + $tw.utils.escapeRegExp(tag.tag) + \&quot;&gt;\&quot;,\n\t\t\t\treEnd = new RegExp(\&quot;(\&quot; + reEndString + \&quot;)\&quot;,\&quot;mg\&quot;);\n\t\tif(hasLineBreak) {\n\t\t\ttag.children = this.parser.parseBlocks(reEndString);\n\t\t} else {\n\t\t\ttag.children = this.parser.parseInlineRun(reEnd);\n\t\t}\n\t\treEnd.lastIndex = this.parser.pos;\n\t\tvar endMatch = reEnd.exec(this.parser.source);\n\t\tif(endMatch &amp;&amp; endMatch.index === this.parser.pos) {\n\t\t\tthis.parser.pos = endMatch.index + endMatch[0].length;\n\t\t}\n\t}\n\t// Return the tag\n\treturn [tag];\n};\n\n/*\nLook for an HTML tag. Returns null if not found, otherwise returns {type: \&quot;element\&quot;, name:, attributes: [], isSelfClosing:, start:, end:,}\n*/\nexports.parseTag = function(source,pos,options) {\n\toptions = options || {};\n\tvar token,\n\t\tnode = {\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\tstart: pos,\n\t\t\tattributes: {}\n\t\t};\n\t// Define our regexps\n\tvar reTagName = /([a-zA-Z0-9\\-\\$]+)/g;\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Look for a less than sign\n\ttoken = $tw.utils.parseTokenString(source,pos,\&quot;&lt;\&quot;);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tpos = token.end;\n\t// Get the tag name\n\ttoken = $tw.utils.parseTokenRegExp(source,pos,reTagName);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tnode.tag = token.match[1];\n\tif(node.tag.charAt(0) === \&quot;$\&quot;) {\n\t\tnode.type = node.tag.substr(1);\n\t}\n\tpos = token.end;\n\t// Process attributes\n\tvar attribute = $tw.utils.parseAttribute(source,pos);\n\twhile(attribute) {\n\t\tnode.attributes[attribute.name] = attribute;\n\t\tpos = attribute.end;\n\t\t// Get the next attribute\n\t\tattribute = $tw.utils.parseAttribute(source,pos);\n\t}\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Look for a closing slash\n\ttoken = $tw.utils.parseTokenString(source,pos,\&quot;/\&quot;);\n\tif(token) {\n\t\tpos = token.end;\n\t\tnode.isSelfClosing = true;\n\t}\n\t// Look for a greater than sign\n\ttoken = $tw.utils.parseTokenString(source,pos,\&quot;&gt;\&quot;);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tpos = token.end;\n\t// Check for a required line break\n\tif(options.requireLineBreak) {\n\t\ttoken = $tw.utils.parseTokenRegExp(source,pos,/([^\\S\\n\\r]*\\r?\\n(?:[^\\S\\n\\r]*\\r?\\n|$))/g);\n\t\tif(!token) {\n\t\t\treturn null;\n\t\t}\n\t}\n\t// Update the end position\n\tnode.end = pos;\n\treturn node;\n};\n\nexports.findNextTag = function(source,pos,options) {\n\t// A regexp for finding candidate HTML tags\n\tvar reLookahead = /&lt;([a-zA-Z\\-\\$]+)/g;\n\t// Find the next candidate\n\treLookahead.lastIndex = pos;\n\tvar match = reLookahead.exec(source);\n\twhile(match) {\n\t\t// Try to parse the candidate as a tag\n\t\tvar tag = this.parseTag(source,match.index,options);\n\t\t// Return success\n\t\tif(tag &amp;&amp; this.isLegalTag(tag)) {\n\t\t\treturn tag;\n\t\t}\n\t\t// Look for the next match\n\t\treLookahead.lastIndex = match.index + 1;\n\t\tmatch = reLookahead.exec(source);\n\t}\n\t// Failed\n\treturn null;\n};\n\nexports.isLegalTag = function(tag) {\n\t// Widgets are always OK\n\tif(tag.type !== \&quot;element\&quot;) {\n\t\treturn true;\n\t// If it's an HTML tag that starts with a dash then it's not legal\n\t} else if(tag.tag.charAt(0) === \&quot;-\&quot;) {\n\t\treturn false;\n\t} else {\n\t\t// Otherwise it's OK\n\t\treturn true;\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/html.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/image.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/image.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for embedding images. For example:\n\n```\n[img[http://tiddlywiki.com/fractalveg.jpg]]\n[img width=23 height=24 [http://tiddlywiki.com/fractalveg.jpg]]\n[img width={{!!width}} height={{!!height}} [http://tiddlywiki.com/fractalveg.jpg]]\n[img[Description of image|http://tiddlywiki.com/fractalveg.jpg]]\n[img[TiddlerTitle]]\n[img[Description of image|TiddlerTitle]]\n```\n\nGenerates the `&lt;$image&gt;` widget.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;image\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n};\n\nexports.findNextMatch = function(startPos) {\n\t// Find the next tag\n\tthis.nextImage = this.findNextImage(this.parser.source,startPos);\n\treturn this.nextImage ? this.nextImage.start : undefined;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.nextImage.end;\n\tvar node = {\n\t\ttype: \&quot;image\&quot;,\n\t\tattributes: this.nextImage.attributes\n\t};\n\treturn [node];\n};\n\n/*\nFind the next image from the current position\n*/\nexports.findNextImage = function(source,pos) {\n\t// A regexp for finding candidate HTML tags\n\tvar reLookahead = /(\\[img)/g;\n\t// Find the next candidate\n\treLookahead.lastIndex = pos;\n\tvar match = reLookahead.exec(source);\n\twhile(match) {\n\t\t// Try to parse the candidate as a tag\n\t\tvar tag = this.parseImage(source,match.index);\n\t\t// Return success\n\t\tif(tag) {\n\t\t\treturn tag;\n\t\t}\n\t\t// Look for the next match\n\t\treLookahead.lastIndex = match.index + 1;\n\t\tmatch = reLookahead.exec(source);\n\t}\n\t// Failed\n\treturn null;\n};\n\n/*\nLook for an image at the specified position. Returns null if not found, otherwise returns {type: \&quot;image\&quot;, attributes: [], isSelfClosing:, start:, end:,}\n*/\nexports.parseImage = function(source,pos) {\n\tvar token,\n\t\tnode = {\n\t\t\ttype: \&quot;image\&quot;,\n\t\t\tstart: pos,\n\t\t\tattributes: {}\n\t\t};\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Look for the `[img`\n\ttoken = $tw.utils.parseTokenString(source,pos,\&quot;[img\&quot;);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tpos = token.end;\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Process attributes\n\tif(source.charAt(pos) !== \&quot;[\&quot;) {\n\t\tvar attribute = $tw.utils.parseAttribute(source,pos);\n\t\twhile(attribute) {\n\t\t\tnode.attributes[attribute.name] = attribute;\n\t\t\tpos = attribute.end;\n\t\t\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t\t\tif(source.charAt(pos) !== \&quot;[\&quot;) {\n\t\t\t\t// Get the next attribute\n\t\t\t\tattribute = $tw.utils.parseAttribute(source,pos);\n\t\t\t} else {\n\t\t\t\tattribute = null;\n\t\t\t}\n\t\t}\n\t}\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Look for the `[` after the attributes\n\ttoken = $tw.utils.parseTokenString(source,pos,\&quot;[\&quot;);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tpos = token.end;\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Get the source up to the terminating `]]`\n\ttoken = $tw.utils.parseTokenRegExp(source,pos,/(?:([^|\\]]*?)\\|)?([^\\]]+?)\\]\\]/g);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tpos = token.end;\n\tif(token.match[1]) {\n\t\tnode.attributes.tooltip = {type: \&quot;string\&quot;, value: token.match[1].trim()};\n\t}\n\tnode.attributes.source = {type: \&quot;string\&quot;, value: (token.match[2] || \&quot;\&quot;).trim()};\n\t// Update the end position\n\tnode.end = pos;\n\treturn node;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/image.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/list.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/list.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text block rule for lists. For example:\n\n```\n* This is an unordered list\n* It has two items\n\n# This is a numbered list\n## With a subitem\n# And a third item\n\n; This is a term that is being defined\n: This is the definition of that term\n```\n\nNote that lists can be nested arbitrarily:\n\n```\n#** One\n#* Two\n#** Three\n#**** Four\n#**# Five\n#**## Six\n## Seven\n### Eight\n## Nine\n```\n\nA CSS class can be applied to a list item as follows:\n\n```\n* List item one\n*.active List item two has the class `active`\n* List item three\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;list\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /([\\*#;:&gt;]+)/mg;\n};\n\nvar listTypes = {\n\t\&quot;*\&quot;: {listTag: \&quot;ul\&quot;, itemTag: \&quot;li\&quot;},\n\t\&quot;#\&quot;: {listTag: \&quot;ol\&quot;, itemTag: \&quot;li\&quot;},\n\t\&quot;;\&quot;: {listTag: \&quot;dl\&quot;, itemTag: \&quot;dt\&quot;},\n\t\&quot;:\&quot;: {listTag: \&quot;dl\&quot;, itemTag: \&quot;dd\&quot;},\n\t\&quot;&gt;\&quot;: {listTag: \&quot;blockquote\&quot;, itemTag: \&quot;p\&quot;}\n};\n\n/*\nParse the most recent match\n*/\nexports.parse = function() {\n\t// Array of parse tree nodes for the previous row of the list\n\tvar listStack = [];\n\t// Cycle through the items in the list\n\twhile(true) {\n\t\t// Match the list marker\n\t\tvar reMatch = /([\\*#;:&gt;]+)/mg;\n\t\treMatch.lastIndex = this.parser.pos;\n\t\tvar match = reMatch.exec(this.parser.source);\n\t\tif(!match || match.index !== this.parser.pos) {\n\t\t\tbreak;\n\t\t}\n\t\t// Check whether the list type of the top level matches\n\t\tvar listInfo = listTypes[match[0].charAt(0)];\n\t\tif(listStack.length &gt; 0 &amp;&amp; listStack[0].tag !== listInfo.listTag) {\n\t\t\tbreak;\n\t\t}\n\t\t// Move past the list marker\n\t\tthis.parser.pos = match.index + match[0].length;\n\t\t// Walk through the list markers for the current row\n\t\tfor(var t=0; t&lt;match[0].length; t++) {\n\t\t\tlistInfo = listTypes[match[0].charAt(t)];\n\t\t\t// Remove any stacked up element if we can't re-use it because the list type doesn't match\n\t\t\tif(listStack.length &gt; t &amp;&amp; listStack[t].tag !== listInfo.listTag) {\n\t\t\t\tlistStack.splice(t,listStack.length - t);\n\t\t\t}\n\t\t\t// Construct the list element or reuse the previous one at this level\n\t\t\tif(listStack.length &lt;= t) {\n\t\t\t\tvar listElement = {type: \&quot;element\&quot;, tag: listInfo.listTag, children: [\n\t\t\t\t\t{type: \&quot;element\&quot;, tag: listInfo.itemTag, children: []}\n\t\t\t\t]};\n\t\t\t\t// Link this list element into the last child item of the parent list item\n\t\t\t\tif(t) {\n\t\t\t\t\tvar prevListItem = listStack[t-1].children[listStack[t-1].children.length-1];\n\t\t\t\t\tprevListItem.children.push(listElement);\n\t\t\t\t}\n\t\t\t\t// Save this element in the stack\n\t\t\t\tlistStack[t] = listElement;\n\t\t\t} else if(t === (match[0].length - 1)) {\n\t\t\t\tlistStack[t].children.push({type: \&quot;element\&quot;, tag: listInfo.itemTag, children: []});\n\t\t\t}\n\t\t}\n\t\tif(listStack.length &gt; match[0].length) {\n\t\t\tlistStack.splice(match[0].length,listStack.length - match[0].length);\n\t\t}\n\t\t// Process the body of the list item into the last list item\n\t\tvar lastListChildren = listStack[listStack.length-1].children,\n\t\t\tlastListItem = lastListChildren[lastListChildren.length-1],\n\t\t\tclasses = this.parser.parseClasses();\n\t\tthis.parser.skipWhitespace({treatNewlinesAsNonWhitespace: true});\n\t\tvar tree = this.parser.parseInlineRun(/(\\r?\\n)/mg);\n\t\tlastListItem.children.push.apply(lastListItem.children,tree);\n\t\tif(classes.length &gt; 0) {\n\t\t\t$tw.utils.addClassToParseTreeNode(lastListItem,classes.join(\&quot; \&quot;));\n\t\t}\n\t\t// Consume any whitespace following the list item\n\t\tthis.parser.skipWhitespace();\n\t}\n\t// Return the root element of the list\n\treturn [listStack[0]];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/list.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/macrocallblock.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/macrocallblock.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki rule for block macro calls\n\n```\n&lt;&lt;name value value2&gt;&gt;\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;macrocallblock\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /&lt;&lt;([^&gt;\\s]+)(?:\\s*)((?:[^&gt;]|(?:&gt;(?!&gt;)))*?)&gt;&gt;(?:\\r?\\n|$)/mg;\n};\n\n/*\nParse the most recent match\n*/\nexports.parse = function() {\n\t// Get all the details of the match\n\tvar macroName = this.match[1],\n\t\tparamString = this.match[2];\n\t// Move past the macro call\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\tvar params = [],\n\t\treParam = /\\s*(?:([A-Za-z0-9\\-_]+)\\s*:)?(?:\\s*(?:\&quot;\&quot;\&quot;([\\s\\S]*?)\&quot;\&quot;\&quot;|\&quot;([^\&quot;]*)\&quot;|'([^']*)'|\\[\\[([^\\]]*)\\]\\]|([^\&quot;'\\s]+)))/mg,\n\t\tparamMatch = reParam.exec(paramString);\n\twhile(paramMatch) {\n\t\t// Process this parameter\n\t\tvar paramInfo = {\n\t\t\tvalue: paramMatch[2] || paramMatch[3] || paramMatch[4] || paramMatch[5] || paramMatch[6]\n\t\t};\n\t\tif(paramMatch[1]) {\n\t\t\tparamInfo.name = paramMatch[1];\n\t\t}\n\t\tparams.push(paramInfo);\n\t\t// Find the next match\n\t\tparamMatch = reParam.exec(paramString);\n\t}\n\treturn [{\n\t\ttype: \&quot;macrocall\&quot;,\n\t\tname: macroName,\n\t\tparams: params,\n\t\tisBlock: true\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/macrocallblock.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/macrocallinline.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/macrocallinline.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki rule for macro calls\n\n```\n&lt;&lt;name value value2&gt;&gt;\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;macrocallinline\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /&lt;&lt;([^\\s&gt;]+)\\s*([\\s\\S]*?)&gt;&gt;/mg;\n};\n\n/*\nParse the most recent match\n*/\nexports.parse = function() {\n\t// Get all the details of the match\n\tvar macroName = this.match[1],\n\t\tparamString = this.match[2];\n\t// Move past the macro call\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\tvar params = [],\n\t\treParam = /\\s*(?:([A-Za-z0-9\\-_]+)\\s*:)?(?:\\s*(?:\&quot;\&quot;\&quot;([\\s\\S]*?)\&quot;\&quot;\&quot;|\&quot;([^\&quot;]*)\&quot;|'([^']*)'|\\[\\[([^\\]]*)\\]\\]|([^\&quot;'\\s]+)))/mg,\n\t\tparamMatch = reParam.exec(paramString);\n\twhile(paramMatch) {\n\t\t// Process this parameter\n\t\tvar paramInfo = {\n\t\t\tvalue: paramMatch[2] || paramMatch[3] || paramMatch[4] || paramMatch[5]|| paramMatch[6]\n\t\t};\n\t\tif(paramMatch[1]) {\n\t\t\tparamInfo.name = paramMatch[1];\n\t\t}\n\t\tparams.push(paramInfo);\n\t\t// Find the next match\n\t\tparamMatch = reParam.exec(paramString);\n\t}\n\treturn [{\n\t\ttype: \&quot;macrocall\&quot;,\n\t\tname: macroName,\n\t\tparams: params\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/macrocallinline.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/macrodef.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/macrodef.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki pragma rule for macro definitions\n\n```\n\\define name(param:defaultvalue,param2:defaultvalue)\ndefinition text, including $param$ markers\n\\end\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;macrodef\&quot;;\nexports.types = {pragma: true};\n\n/*\nInstantiate parse rule\n*/\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /^\\\\define\\s+([^(\\s]+)\\(\\s*([^)]*)\\)(\\s*\\r?\\n)?/mg;\n};\n\n/*\nParse the most recent match\n*/\nexports.parse = function() {\n\t// Move past the macro name and parameters\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Parse the parameters\n\tvar paramString = this.match[2],\n\t\tparams = [];\n\tif(paramString !== \&quot;\&quot;) {\n\t\tvar reParam = /\\s*([A-Za-z0-9\\-_]+)(?:\\s*:\\s*(?:\&quot;\&quot;\&quot;([\\s\\S]*?)\&quot;\&quot;\&quot;|\&quot;([^\&quot;]*)\&quot;|'([^']*)'|\\[\\[([^\\]]*)\\]\\]|([^\&quot;'\\s]+)))?/mg,\n\t\t\tparamMatch = reParam.exec(paramString);\n\t\twhile(paramMatch) {\n\t\t\t// Save the parameter details\n\t\t\tvar paramInfo = {name: paramMatch[1]},\n\t\t\t\tdefaultValue = paramMatch[2] || paramMatch[3] || paramMatch[4] || paramMatch[5] || paramMatch[6];\n\t\t\tif(defaultValue) {\n\t\t\t\tparamInfo[\&quot;default\&quot;] = defaultValue;\n\t\t\t}\n\t\t\tparams.push(paramInfo);\n\t\t\t// Look for the next parameter\n\t\t\tparamMatch = reParam.exec(paramString);\n\t\t}\n\t}\n\t// Is this a multiline definition?\n\tvar reEnd;\n\tif(this.match[3]) {\n\t\t// If so, the end of the body is marked with \\end\n\t\treEnd = /(\\r?\\n\\\\end[^\\S\\n\\r]*(?:$|\\r?\\n))/mg;\n\t} else {\n\t\t// Otherwise, the end of the definition is marked by the end of the line\n\t\treEnd = /(\\r?\\n)/mg;\n\t\t// Move past any whitespace\n\t\tthis.parser.pos = $tw.utils.skipWhiteSpace(this.parser.source,this.parser.pos);\n\t}\n\t// Find the end of the definition\n\treEnd.lastIndex = this.parser.pos;\n\tvar text,\n\t\tendMatch = reEnd.exec(this.parser.source);\n\tif(endMatch) {\n\t\ttext = this.parser.source.substring(this.parser.pos,endMatch.index);\n\t\tthis.parser.pos = endMatch.index + endMatch[0].length;\n\t} else {\n\t\t// We didn't find the end of the definition, so we'll make it blank\n\t\ttext = \&quot;\&quot;;\n\t}\n\t// Save the macro definition\n\treturn [{\n\t\ttype: \&quot;macrodef\&quot;,\n\t\tname: this.match[1],\n\t\tparams: params,\n\t\ttext: text\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/macrodef.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/prettyextlink.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/prettyextlink.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for external links. For example:\n\n```\n[ext[http://tiddlywiki.com/fractalveg.jpg]]\n[ext[Tooltip|http://tiddlywiki.com/fractalveg.jpg]]\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;prettyextlink\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n};\n\nexports.findNextMatch = function(startPos) {\n\t// Find the next tag\n\tthis.nextLink = this.findNextLink(this.parser.source,startPos);\n\treturn this.nextLink ? this.nextLink.start : undefined;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.nextLink.end;\n\treturn [this.nextLink];\n};\n\n/*\nFind the next link from the current position\n*/\nexports.findNextLink = function(source,pos) {\n\t// A regexp for finding candidate links\n\tvar reLookahead = /(\\[ext\\[)/g;\n\t// Find the next candidate\n\treLookahead.lastIndex = pos;\n\tvar match = reLookahead.exec(source);\n\twhile(match) {\n\t\t// Try to parse the candidate as a link\n\t\tvar link = this.parseLink(source,match.index);\n\t\t// Return success\n\t\tif(link) {\n\t\t\treturn link;\n\t\t}\n\t\t// Look for the next match\n\t\treLookahead.lastIndex = match.index + 1;\n\t\tmatch = reLookahead.exec(source);\n\t}\n\t// Failed\n\treturn null;\n};\n\n/*\nLook for an link at the specified position. Returns null if not found, otherwise returns {type: \&quot;element\&quot;, tag: \&quot;a\&quot;, attributes: [], isSelfClosing:, start:, end:,}\n*/\nexports.parseLink = function(source,pos) {\n\tvar token,\n\t\ttextNode = {\n\t\t\ttype: \&quot;text\&quot;\n\t\t},\n\t\tnode = {\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\ttag: \&quot;a\&quot;,\n\t\t\tstart: pos,\n\t\t\tattributes: {\n\t\t\t\t\&quot;class\&quot;: {type: \&quot;string\&quot;, value: \&quot;tc-tiddlylink-external\&quot;},\n\t\t\t},\n\t\t\tchildren: [textNode]\n\t\t};\n\t// Skip whitespace\n\tpos = $tw.utils.skipWhiteSpace(source,pos);\n\t// Look for the `[ext[`\n\ttoken = $tw.utils.parseTokenString(source,pos,\&quot;[ext[\&quot;);\n\tif(!token) {\n\t\treturn null;\n\t}\n\tpos = token.end;\n\t// Look ahead for the terminating `]]`\n\tvar closePos = source.indexOf(\&quot;]]\&quot;,pos);\n\tif(closePos === -1) {\n\t\treturn null;\n\t}\n\t// Look for a `|` separating the tooltip\n\tvar splitPos = source.indexOf(\&quot;|\&quot;,pos);\n\tif(splitPos === -1 || splitPos &gt; closePos) {\n\t\tsplitPos = null;\n\t}\n\t// Pull out the tooltip and URL\n\tvar tooltip, URL;\n\tif(splitPos) {\n\t\tURL = source.substring(splitPos + 1,closePos).trim();\n\t\ttextNode.text = source.substring(pos,splitPos).trim();\n\t} else {\n\t\tURL = source.substring(pos,closePos).trim();\n\t\ttextNode.text = URL;\n\t}\n\tnode.attributes.href = {type: \&quot;string\&quot;, value: URL};\n\tnode.attributes.target = {type: \&quot;string\&quot;, value: \&quot;_blank\&quot;};\n\t// Update the end position\n\tnode.end = closePos + 2;\n\treturn node;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/prettyextlink.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/prettylink.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/prettylink.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for pretty links. For example:\n\n```\n[[Introduction]]\n\n[[Link description|TiddlerTitle]]\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;prettylink\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /\\[\\[(.*?)(?:\\|(.*?))?\\]\\]/mg;\n};\n\nvar isLinkExternal = function(to) {\n\tvar externalRegExp = /(?:file|http|https|mailto|ftp|irc|news|data|skype):[^\\s&lt;&gt;{}\\[\\]`|'\&quot;\\\\^~]+(?:\\/|\\b)/i;\n\treturn externalRegExp.test(to);\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Process the link\n\tvar text = this.match[1],\n\t\tlink = this.match[2] || text;\n\tif(isLinkExternal(link)) {\n\t\treturn [{\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\ttag: \&quot;a\&quot;,\n\t\t\tattributes: {\n\t\t\t\thref: {type: \&quot;string\&quot;, value: link},\n\t\t\t\t\&quot;class\&quot;: {type: \&quot;string\&quot;, value: \&quot;tc-tiddlylink-external\&quot;},\n\t\t\t\ttarget: {type: \&quot;string\&quot;, value: \&quot;_blank\&quot;}\n\t\t\t},\n\t\t\tchildren: [{\n\t\t\t\ttype: \&quot;text\&quot;, text: text\n\t\t\t}]\n\t\t}];\n\t} else {\n\t\treturn [{\n\t\t\ttype: \&quot;link\&quot;,\n\t\t\tattributes: {\n\t\t\t\tto: {type: \&quot;string\&quot;, value: link}\n\t\t\t},\n\t\t\tchildren: [{\n\t\t\t\ttype: \&quot;text\&quot;, text: text\n\t\t\t}]\n\t\t}];\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/prettylink.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/quoteblock.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/quoteblock.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text rule for quote blocks. For example:\n\n```\n\t&lt;&lt;&lt;.optionalClass(es) optional cited from\n\ta quote\n\t&lt;&lt;&lt;\n\t\n\t&lt;&lt;&lt;.optionalClass(es)\n\ta quote\n\t&lt;&lt;&lt; optional cited from\n```\n\nQuotes can be quoted by putting more &lt;s\n\n```\n\t&lt;&lt;&lt;\n\tQuote Level 1\n\t\n\t&lt;&lt;&lt;&lt;\n\tQuoteLevel 2\n\t&lt;&lt;&lt;&lt;\n\t\n\t&lt;&lt;&lt;\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;quoteblock\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /(&lt;&lt;&lt;+)/mg;\n};\n\nexports.parse = function() {\n\tvar classes = [\&quot;tc-quote\&quot;];\n\t// Get all the details of the match\n\tvar reEndString = \&quot;^\&quot; + this.match[1] + \&quot;(?!&lt;)\&quot;;\n\t// Move past the &lt;s\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t\n\t// Parse any classes, whitespace and then the optional cite itself\n\tclasses.push.apply(classes, this.parser.parseClasses());\n\tthis.parser.skipWhitespace({treatNewlinesAsNonWhitespace: true});\n\tvar cite = this.parser.parseInlineRun(/(\\r?\\n)/mg);\n\t// before handling the cite, parse the body of the quote\n\tvar tree= this.parser.parseBlocks(reEndString);\n\t// If we got a cite, put it before the text\n\tif(cite.length &gt; 0) {\n\t\ttree.unshift({\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\ttag: \&quot;cite\&quot;,\n\t\t\tchildren: cite\n\t\t});\n\t}\n\t// Parse any optional cite\n\tthis.parser.skipWhitespace({treatNewlinesAsNonWhitespace: true});\n\tcite = this.parser.parseInlineRun(/(\\r?\\n)/mg);\n\t// If we got a cite, push it\n\tif(cite.length &gt; 0) {\n\t\ttree.push({\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\ttag: \&quot;cite\&quot;,\n\t\t\tchildren: cite\n\t\t});\n\t}\n\t// Return the blockquote element\n\treturn [{\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;blockquote\&quot;,\n\t\tattributes: {\n\t\t\tclass: { type: \&quot;string\&quot;, value: classes.join(\&quot; \&quot;) },\n\t\t},\n\t\tchildren: tree\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/quoteblock.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/rules.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/rules.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki pragma rule for rules specifications\n\n```\n\\rules except ruleone ruletwo rulethree\n\\rules only ruleone ruletwo rulethree\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;rules\&quot;;\nexports.types = {pragma: true};\n\n/*\nInstantiate parse rule\n*/\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /^\\\\rules[^\\S\\n]/mg;\n};\n\n/*\nParse the most recent match\n*/\nexports.parse = function() {\n\t// Move past the pragma invocation\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Parse whitespace delimited tokens terminated by a line break\n\tvar reMatch = /[^\\S\\n]*(\\S+)|(\\r?\\n)/mg,\n\t\ttokens = [];\n\treMatch.lastIndex = this.parser.pos;\n\tvar match = reMatch.exec(this.parser.source);\n\twhile(match &amp;&amp; match.index === this.parser.pos) {\n\t\tthis.parser.pos = reMatch.lastIndex;\n\t\t// Exit if we've got the line break\n\t\tif(match[2]) {\n\t\t\tbreak;\n\t\t}\n\t\t// Process the token\n\t\tif(match[1]) {\n\t\t\ttokens.push(match[1]);\n\t\t}\n\t\t// Match the next token\n\t\tmatch = reMatch.exec(this.parser.source);\n\t}\n\t// Process the tokens\n\tif(tokens.length &gt; 0) {\n\t\tthis.parser.amendRules(tokens[0],tokens.slice(1));\n\t}\n\t// No parse tree nodes to return\n\treturn [];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/rules.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/styleblock.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/styleblock.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text block rule for assigning styles and classes to paragraphs and other blocks. For example:\n\n```\n@@.myClass\n@@background-color:red;\nThis paragraph will have the CSS class `myClass`.\n\n* The `&lt;ul&gt;` around this list will also have the class `myClass`\n* List item 2\n\n@@\n```\n\nNote that classes and styles can be mixed subject to the rule that styles must precede classes. For example\n\n```\n@@.myFirstClass.mySecondClass\n@@width:100px;.myThirdClass\nThis is a paragraph\n@@\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;styleblock\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /@@((?:[^\\.\\r\\n\\s:]+:[^\\r\\n;]+;)+)?(?:\\.([^\\r\\n\\s]+))?\\r?\\n/mg;\n};\n\nexports.parse = function() {\n\tvar reEndString = \&quot;^@@(?:\\\\r?\\\\n)?\&quot;;\n\tvar classes = [], styles = [];\n\tdo {\n\t\t// Get the class and style\n\t\tif(this.match[1]) {\n\t\t\tstyles.push(this.match[1]);\n\t\t}\n\t\tif(this.match[2]) {\n\t\t\tclasses.push(this.match[2].split(\&quot;.\&quot;).join(\&quot; \&quot;));\n\t\t}\n\t\t// Move past the match\n\t\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t\t// Look for another line of classes and styles\n\t\tthis.match = this.matchRegExp.exec(this.parser.source);\n\t} while(this.match &amp;&amp; this.match.index === this.parser.pos);\n\t// Parse the body\n\tvar tree = this.parser.parseBlocks(reEndString);\n\tfor(var t=0; t&lt;tree.length; t++) {\n\t\tif(classes.length &gt; 0) {\n\t\t\t$tw.utils.addClassToParseTreeNode(tree[t],classes.join(\&quot; \&quot;));\n\t\t}\n\t\tif(styles.length &gt; 0) {\n\t\t\t$tw.utils.addAttributeToParseTreeNode(tree[t],\&quot;style\&quot;,styles.join(\&quot;\&quot;));\n\t\t}\n\t}\n\treturn tree;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/styleblock.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/styleinline.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/styleinline.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for assigning styles and classes to inline runs. For example:\n\n```\n@@.myClass This is some text with a class@@\n@@background-color:red;This is some text with a background colour@@\n@@width:100px;.myClass This is some text with a class and a width@@\n```\n\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;styleinline\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /@@((?:[^\\.\\r\\n\\s:]+:[^\\r\\n;]+;)+)?(\\.(?:[^\\r\\n\\s]+)\\s+)?/mg;\n};\n\nexports.parse = function() {\n\tvar reEnd = /@@/g;\n\t// Get the styles and class\n\tvar stylesString = this.match[1],\n\t\tclassString = this.match[2] ? this.match[2].split(\&quot;.\&quot;).join(\&quot; \&quot;) : undefined;\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Parse the run up to the terminator\n\tvar tree = this.parser.parseInlineRun(reEnd,{eatTerminator: true});\n\t// Return the classed span\n\tvar node = {\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;span\&quot;,\n\t\tattributes: {\n\t\t\t\&quot;class\&quot;: {type: \&quot;string\&quot;, value: \&quot;tc-inline-style\&quot;}\n\t\t},\n\t\tchildren: tree\n\t};\n\tif(classString) {\n\t\t$tw.utils.addClassToParseTreeNode(node,classString);\n\t}\n\tif(stylesString) {\n\t\t$tw.utils.addAttributeToParseTreeNode(node,\&quot;style\&quot;,stylesString);\n\t}\n\treturn [node];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/styleinline.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/table.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/table.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text block rule for tables.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;table\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /^\\|(?:[^\\n]*)\\|(?:[fhck]?)\\r?(?:\\n|$)/mg;\n};\n\nvar processRow = function(prevColumns) {\n\tvar cellRegExp = /(?:\\|([^\\n\\|]*)\\|)|(\\|[fhck]?\\r?(?:\\n|$))/mg,\n\t\tcellTermRegExp = /((?:\\x20*)\\|)/mg,\n\t\ttree = [],\n\t\tcol = 0,\n\t\tcolSpanCount = 1,\n\t\tprevCell,\n\t\tvAlign;\n\t// Match a single cell\n\tcellRegExp.lastIndex = this.parser.pos;\n\tvar cellMatch = cellRegExp.exec(this.parser.source);\n\twhile(cellMatch &amp;&amp; cellMatch.index === this.parser.pos) {\n\t\tif(cellMatch[1] === \&quot;~\&quot;) {\n\t\t\t// Rowspan\n\t\t\tvar last = prevColumns[col];\n\t\t\tif(last) {\n\t\t\t\tlast.rowSpanCount++;\n\t\t\t\t$tw.utils.addAttributeToParseTreeNode(last.element,\&quot;rowspan\&quot;,last.rowSpanCount);\n\t\t\t\tvAlign = $tw.utils.getAttributeValueFromParseTreeNode(last.element,\&quot;valign\&quot;,\&quot;center\&quot;);\n\t\t\t\t$tw.utils.addAttributeToParseTreeNode(last.element,\&quot;valign\&quot;,vAlign);\n\t\t\t\tif(colSpanCount &gt; 1) {\n\t\t\t\t\t$tw.utils.addAttributeToParseTreeNode(last.element,\&quot;colspan\&quot;,colSpanCount);\n\t\t\t\t\tcolSpanCount = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Move to just before the `|` terminating the cell\n\t\t\tthis.parser.pos = cellRegExp.lastIndex - 1;\n\t\t} else if(cellMatch[1] === \&quot;&gt;\&quot;) {\n\t\t\t// Colspan\n\t\t\tcolSpanCount++;\n\t\t\t// Move to just before the `|` terminating the cell\n\t\t\tthis.parser.pos = cellRegExp.lastIndex - 1;\n\t\t} else if(cellMatch[1] === \&quot;&lt;\&quot; &amp;&amp; prevCell) {\n\t\t\tcolSpanCount = 1 + $tw.utils.getAttributeValueFromParseTreeNode(prevCell,\&quot;colspan\&quot;,1);\n\t\t\t$tw.utils.addAttributeToParseTreeNode(prevCell,\&quot;colspan\&quot;,colSpanCount);\n\t\t\tcolSpanCount = 1;\n\t\t\t// Move to just before the `|` terminating the cell\n\t\t\tthis.parser.pos = cellRegExp.lastIndex - 1;\n\t\t} else if(cellMatch[2]) {\n\t\t\t// End of row\n\t\t\tif(prevCell &amp;&amp; colSpanCount &gt; 1) {\n\t\t\t\tif(prevCell.attributes &amp;&amp; prevCell.attributes &amp;&amp; prevCell.attributes.colspan) {\n\t\t\t\t\t\tcolSpanCount += prevCell.attributes.colspan.value;\n\t\t\t\t} else {\n\t\t\t\t\tcolSpanCount -= 1;\n\t\t\t\t}\n\t\t\t\t$tw.utils.addAttributeToParseTreeNode(prevCell,\&quot;colspan\&quot;,colSpanCount);\n\t\t\t}\n\t\t\tthis.parser.pos = cellRegExp.lastIndex - 1;\n\t\t\tbreak;\n\t\t} else {\n\t\t\t// For ordinary cells, step beyond the opening `|`\n\t\t\tthis.parser.pos++;\n\t\t\t// Look for a space at the start of the cell\n\t\t\tvar spaceLeft = false;\n\t\t\tvAlign = null;\n\t\t\tif(this.parser.source.substr(this.parser.pos).search(/^\\^([^\\^]|\\^\\^)/) === 0) {\n\t\t\t\tvAlign = \&quot;top\&quot;;\n\t\t\t} else if(this.parser.source.substr(this.parser.pos).search(/^,([^,]|,,)/) === 0) {\n\t\t\t\tvAlign = \&quot;bottom\&quot;;\n\t\t\t}\n\t\t\tif(vAlign) {\n\t\t\t\tthis.parser.pos++;\n\t\t\t}\n\t\t\tvar chr = this.parser.source.substr(this.parser.pos,1);\n\t\t\twhile(chr === \&quot; \&quot;) {\n\t\t\t\tspaceLeft = true;\n\t\t\t\tthis.parser.pos++;\n\t\t\t\tchr = this.parser.source.substr(this.parser.pos,1);\n\t\t\t}\n\t\t\t// Check whether this is a heading cell\n\t\t\tvar cell;\n\t\t\tif(chr === \&quot;!\&quot;) {\n\t\t\t\tthis.parser.pos++;\n\t\t\t\tcell = {type: \&quot;element\&quot;, tag: \&quot;th\&quot;, children: []};\n\t\t\t} else {\n\t\t\t\tcell = {type: \&quot;element\&quot;, tag: \&quot;td\&quot;, children: []};\n\t\t\t}\n\t\t\ttree.push(cell);\n\t\t\t// Record information about this cell\n\t\t\tprevCell = cell;\n\t\t\tprevColumns[col] = {rowSpanCount:1,element:cell};\n\t\t\t// Check for a colspan\n\t\t\tif(colSpanCount &gt; 1) {\n\t\t\t\t$tw.utils.addAttributeToParseTreeNode(cell,\&quot;colspan\&quot;,colSpanCount);\n\t\t\t\tcolSpanCount = 1;\n\t\t\t}\n\t\t\t// Parse the cell\n\t\t\tcell.children = this.parser.parseInlineRun(cellTermRegExp,{eatTerminator: true});\n\t\t\t// Set the alignment for the cell\n\t\t\tif(vAlign) {\n\t\t\t\t$tw.utils.addAttributeToParseTreeNode(cell,\&quot;valign\&quot;,vAlign);\n\t\t\t}\n\t\t\tif(this.parser.source.substr(this.parser.pos - 2,1) === \&quot; \&quot;) { // spaceRight\n\t\t\t\t$tw.utils.addAttributeToParseTreeNode(cell,\&quot;align\&quot;,spaceLeft ? \&quot;center\&quot; : \&quot;left\&quot;);\n\t\t\t} else if(spaceLeft) {\n\t\t\t\t$tw.utils.addAttributeToParseTreeNode(cell,\&quot;align\&quot;,\&quot;right\&quot;);\n\t\t\t}\n\t\t\t// Move back to the closing `|`\n\t\t\tthis.parser.pos--;\n\t\t}\n\t\tcol++;\n\t\tcellRegExp.lastIndex = this.parser.pos;\n\t\tcellMatch = cellRegExp.exec(this.parser.source);\n\t}\n\treturn tree;\n};\n\nexports.parse = function() {\n\tvar rowContainerTypes = {\&quot;c\&quot;:\&quot;caption\&quot;, \&quot;h\&quot;:\&quot;thead\&quot;, \&quot;\&quot;:\&quot;tbody\&quot;, \&quot;f\&quot;:\&quot;tfoot\&quot;},\n\t\ttable = {type: \&quot;element\&quot;, tag: \&quot;table\&quot;, children: []},\n\t\trowRegExp = /^\\|([^\\n]*)\\|([fhck]?)\\r?(?:\\n|$)/mg,\n\t\trowTermRegExp = /(\\|(?:[fhck]?)\\r?(?:\\n|$))/mg,\n\t\tprevColumns = [],\n\t\tcurrRowType,\n\t\trowContainer,\n\t\trowCount = 0;\n\t// Match the row\n\trowRegExp.lastIndex = this.parser.pos;\n\tvar rowMatch = rowRegExp.exec(this.parser.source);\n\twhile(rowMatch &amp;&amp; rowMatch.index === this.parser.pos) {\n\t\tvar rowType = rowMatch[2];\n\t\t// Check if it is a class assignment\n\t\tif(rowType === \&quot;k\&quot;) {\n\t\t\t$tw.utils.addClassToParseTreeNode(table,rowMatch[1]);\n\t\t\tthis.parser.pos = rowMatch.index + rowMatch[0].length;\n\t\t} else {\n\t\t\t// Otherwise, create a new row if this one is of a different type\n\t\t\tif(rowType !== currRowType) {\n\t\t\t\trowContainer = {type: \&quot;element\&quot;, tag: rowContainerTypes[rowType], children: []};\n\t\t\t\ttable.children.push(rowContainer);\n\t\t\t\tcurrRowType = rowType;\n\t\t\t}\n\t\t\t// Is this a caption row?\n\t\t\tif(currRowType === \&quot;c\&quot;) {\n\t\t\t\t// If so, move past the opening `|` of the row\n\t\t\t\tthis.parser.pos++;\n\t\t\t\t// Move the caption to the first row if it isn't already\n\t\t\t\tif(table.children.length !== 1) {\n\t\t\t\t\ttable.children.pop(); // Take rowContainer out of the children array\n\t\t\t\t\ttable.children.splice(0,0,rowContainer); // Insert it at the bottom\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t// Set the alignment - TODO: figure out why TW did this\n//\t\t\t\trowContainer.attributes.align = rowCount === 0 ? \&quot;top\&quot; : \&quot;bottom\&quot;;\n\t\t\t\t// Parse the caption\n\t\t\t\trowContainer.children = this.parser.parseInlineRun(rowTermRegExp,{eatTerminator: true});\n\t\t\t} else {\n\t\t\t\t// Create the row\n\t\t\t\tvar theRow = {type: \&quot;element\&quot;, tag: \&quot;tr\&quot;, children: []};\n\t\t\t\t$tw.utils.addClassToParseTreeNode(theRow,rowCount%2 ? \&quot;oddRow\&quot; : \&quot;evenRow\&quot;);\n\t\t\t\trowContainer.children.push(theRow);\n\t\t\t\t// Process the row\n\t\t\t\ttheRow.children = processRow.call(this,prevColumns);\n\t\t\t\tthis.parser.pos = rowMatch.index + rowMatch[0].length;\n\t\t\t\t// Increment the row count\n\t\t\t\trowCount++;\n\t\t\t}\n\t\t}\n\t\trowMatch = rowRegExp.exec(this.parser.source);\n\t}\n\treturn [table];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/table.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/transcludeblock.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/transcludeblock.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text rule for block-level transclusion. For example:\n\n```\n{{MyTiddler}}\n{{MyTiddler||TemplateTitle}}\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;transcludeblock\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /\\{\\{([^\\{\\}\\|]*)(?:\\|\\|([^\\|\\{\\}]+))?\\}\\}(?:\\r?\\n|$)/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Get the match details\n\tvar template = $tw.utils.trim(this.match[2]),\n\t\ttextRef = $tw.utils.trim(this.match[1]);\n\t// Prepare the transclude widget\n\tvar transcludeNode = {\n\t\t\ttype: \&quot;transclude\&quot;,\n\t\t\tattributes: {},\n\t\t\tisBlock: true\n\t\t};\n\t// Prepare the tiddler widget\n\tvar tr, targetTitle, targetField, targetIndex, tiddlerNode;\n\tif(textRef) {\n\t\ttr = $tw.utils.parseTextReference(textRef);\n\t\ttargetTitle = tr.title;\n\t\ttargetField = tr.field;\n\t\ttargetIndex = tr.index;\n\t\ttiddlerNode = {\n\t\t\ttype: \&quot;tiddler\&quot;,\n\t\t\tattributes: {\n\t\t\t\ttiddler: {type: \&quot;string\&quot;, value: targetTitle}\n\t\t\t},\n\t\t\tisBlock: true,\n\t\t\tchildren: [transcludeNode]\n\t\t};\n\t}\n\tif(template) {\n\t\ttranscludeNode.attributes.tiddler = {type: \&quot;string\&quot;, value: template};\n\t\tif(textRef) {\n\t\t\treturn [tiddlerNode];\n\t\t} else {\n\t\t\treturn [transcludeNode];\n\t\t}\n\t} else {\n\t\tif(textRef) {\n\t\t\ttranscludeNode.attributes.tiddler = {type: \&quot;string\&quot;, value: targetTitle};\n\t\t\tif(targetField) {\n\t\t\t\ttranscludeNode.attributes.field = {type: \&quot;string\&quot;, value: targetField};\n\t\t\t}\n\t\t\tif(targetIndex) {\n\t\t\t\ttranscludeNode.attributes.index = {type: \&quot;string\&quot;, value: targetIndex};\n\t\t\t}\n\t\t\treturn [tiddlerNode];\n\t\t} else {\n\t\t\treturn [transcludeNode];\n\t\t}\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/transcludeblock.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/transcludeinline.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/transcludeinline.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text rule for inline-level transclusion. For example:\n\n```\n{{MyTiddler}}\n{{MyTiddler||TemplateTitle}}\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;transcludeinline\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /\\{\\{([^\\{\\}\\|]*)(?:\\|\\|([^\\|\\{\\}]+))?\\}\\}/mg;\n};\n\nexports.parse = function() {\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Get the match details\n\tvar template = $tw.utils.trim(this.match[2]),\n\t\ttextRef = $tw.utils.trim(this.match[1]);\n\t// Prepare the transclude widget\n\tvar transcludeNode = {\n\t\t\ttype: \&quot;transclude\&quot;,\n\t\t\tattributes: {}\n\t\t};\n\t// Prepare the tiddler widget\n\tvar tr, targetTitle, targetField, targetIndex, tiddlerNode;\n\tif(textRef) {\n\t\ttr = $tw.utils.parseTextReference(textRef);\n\t\ttargetTitle = tr.title;\n\t\ttargetField = tr.field;\n\t\ttargetIndex = tr.index;\n\t\ttiddlerNode = {\n\t\t\ttype: \&quot;tiddler\&quot;,\n\t\t\tattributes: {\n\t\t\t\ttiddler: {type: \&quot;string\&quot;, value: targetTitle}\n\t\t\t},\n\t\t\tchildren: [transcludeNode]\n\t\t};\n\t}\n\tif(template) {\n\t\ttranscludeNode.attributes.tiddler = {type: \&quot;string\&quot;, value: template};\n\t\tif(textRef) {\n\t\t\treturn [tiddlerNode];\n\t\t} else {\n\t\t\treturn [transcludeNode];\n\t\t}\n\t} else {\n\t\tif(textRef) {\n\t\t\ttranscludeNode.attributes.tiddler = {type: \&quot;string\&quot;, value: targetTitle};\n\t\t\tif(targetField) {\n\t\t\t\ttranscludeNode.attributes.field = {type: \&quot;string\&quot;, value: targetField};\n\t\t\t}\n\t\t\tif(targetIndex) {\n\t\t\t\ttranscludeNode.attributes.index = {type: \&quot;string\&quot;, value: targetIndex};\n\t\t\t}\n\t\t\treturn [tiddlerNode];\n\t\t} else {\n\t\t\treturn [transcludeNode];\n\t\t}\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/transcludeinline.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/typedblock.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/typedblock.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text rule for typed blocks. For example:\n\n```\n$$$.js\nThis will be rendered as JavaScript\n$$$\n\n$$$.svg\n&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; width=\&quot;150\&quot; height=\&quot;100\&quot;&gt;\n  &lt;circle cx=\&quot;100\&quot; cy=\&quot;50\&quot; r=\&quot;40\&quot; stroke=\&quot;black\&quot; stroke-width=\&quot;2\&quot; fill=\&quot;red\&quot; /&gt;\n&lt;/svg&gt;\n$$$\n\n$$$text/vnd.tiddlywiki&gt;text/html\nThis will be rendered as an //HTML representation// of WikiText\n$$$\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;);\n\nexports.name = \&quot;typedblock\&quot;;\nexports.types = {block: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = /\\$\\$\\$([^ &gt;\\r\\n]*)(?: *&gt; *([^ \\r\\n]+))?\\r?\\n/mg;\n};\n\nexports.parse = function() {\n\tvar reEnd = /\\r?\\n\\$\\$\\$\\r?(?:\\n|$)/mg;\n\t// Save the type\n\tvar parseType = this.match[1],\n\t\trenderType = this.match[2];\n\t// Move past the match\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// Look for the end of the block\n\treEnd.lastIndex = this.parser.pos;\n\tvar match = reEnd.exec(this.parser.source),\n\t\ttext;\n\t// Process the block\n\tif(match) {\n\t\ttext = this.parser.source.substring(this.parser.pos,match.index);\n\t\tthis.parser.pos = match.index + match[0].length;\n\t} else {\n\t\ttext = this.parser.source.substr(this.parser.pos);\n\t\tthis.parser.pos = this.parser.sourceLength;\n\t}\n\t// Parse the block according to the specified type\n\tvar parser = this.parser.wiki.parseText(parseType,text,{defaultType: \&quot;text/plain\&quot;});\n\t// If there's no render type, just return the parse tree\n\tif(!renderType) {\n\t\treturn parser.tree;\n\t} else {\n\t\t// Otherwise, render to the rendertype and return in a &lt;PRE&gt; tag\n\t\tvar widgetNode = this.parser.wiki.makeWidget(parser),\n\t\t\tcontainer = $tw.fakeDocument.createElement(\&quot;div\&quot;);\n\t\twidgetNode.render(container,null);\n\t\ttext = renderType === \&quot;text/html\&quot; ? container.innerHTML : container.textContent;\n\t\treturn [{\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\ttag: \&quot;pre\&quot;,\n\t\t\tchildren: [{\n\t\t\t\ttype: \&quot;text\&quot;,\n\t\t\t\ttext: text\n\t\t\t}]\n\t\t}];\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/typedblock.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/wikilink.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/wikilink.js\ntype: application/javascript\nmodule-type: wikirule\n\nWiki text inline rule for wiki links. For example:\n\n```\nAWikiLink\nAnotherLink\n~SuppressedLink\n```\n\nPrecede a camel case word with `~` to prevent it from being recognised as a link.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.name = \&quot;wikilink\&quot;;\nexports.types = {inline: true};\n\nexports.init = function(parser) {\n\tthis.parser = parser;\n\t// Regexp to match\n\tthis.matchRegExp = new RegExp($tw.config.textPrimitives.unWikiLink + \&quot;?\&quot; + $tw.config.textPrimitives.wikiLink,\&quot;mg\&quot;);\n};\n\n/*\nParse the most recent match\n*/\nexports.parse = function() {\n\t// Get the details of the match\n\tvar linkText = this.match[0];\n\t// Move past the macro call\n\tthis.parser.pos = this.matchRegExp.lastIndex;\n\t// If the link starts with the unwikilink character then just output it as plain text\n\tif(linkText.substr(0,1) === $tw.config.textPrimitives.unWikiLink) {\n\t\treturn [{type: \&quot;text\&quot;, text: linkText.substr(1)}];\n\t}\n\t// If the link has been preceded with a blocked letter then don't treat it as a link\n\tif(this.match.index &gt; 0) {\n\t\tvar preRegExp = new RegExp($tw.config.textPrimitives.blockPrefixLetters,\&quot;mg\&quot;);\n\t\tpreRegExp.lastIndex = this.match.index-1;\n\t\tvar preMatch = preRegExp.exec(this.parser.source);\n\t\tif(preMatch &amp;&amp; preMatch.index === this.match.index-1) {\n\t\t\treturn [{type: \&quot;text\&quot;, text: linkText}];\n\t\t}\n\t}\n\treturn [{\n\t\ttype: \&quot;link\&quot;,\n\t\tattributes: {\n\t\t\tto: {type: \&quot;string\&quot;, value: linkText}\n\t\t},\n\t\tchildren: [{\n\t\t\ttype: \&quot;text\&quot;,\n\t\t\ttext: linkText\n\t\t}]\n\t}];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/wikilink.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikirule&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/wikiparser.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/wikiparser.js\ntype: application/javascript\nmodule-type: parser\n\nThe wiki text parser processes blocks of source text into a parse tree.\n\nThe parse tree is made up of nested arrays of these JavaScript objects:\n\n\t{type: \&quot;element\&quot;, tag: &lt;string&gt;, attributes: {}, children: []} - an HTML element\n\t{type: \&quot;text\&quot;, text: &lt;string&gt;} - a text node\n\t{type: \&quot;entity\&quot;, value: &lt;string&gt;} - an entity\n\t{type: \&quot;raw\&quot;, html: &lt;string&gt;} - raw HTML\n\nAttributes are stored as hashmaps of the following objects:\n\n\t{type: \&quot;string\&quot;, value: &lt;string&gt;} - literal string\n\t{type: \&quot;indirect\&quot;, textReference: &lt;textReference&gt;} - indirect through a text reference\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar WikiParser = function(type,text,options) {\n\tthis.wiki = options.wiki;\n\t// Initialise the classes if we don't have them already\n\tif(!this.pragmaRuleClasses) {\n\t\tWikiParser.prototype.pragmaRuleClasses = $tw.modules.createClassesFromModules(\&quot;wikirule\&quot;,\&quot;pragma\&quot;,$tw.WikiRuleBase);\n\t}\n\tif(!this.blockRuleClasses) {\n\t\tWikiParser.prototype.blockRuleClasses = $tw.modules.createClassesFromModules(\&quot;wikirule\&quot;,\&quot;block\&quot;,$tw.WikiRuleBase);\n\t}\n\tif(!this.inlineRuleClasses) {\n\t\tWikiParser.prototype.inlineRuleClasses = $tw.modules.createClassesFromModules(\&quot;wikirule\&quot;,\&quot;inline\&quot;,$tw.WikiRuleBase);\n\t}\n\t// Save the parse text\n\tthis.type = type || \&quot;text/vnd.tiddlywiki\&quot;;\n\tthis.source = text || \&quot;\&quot;;\n\tthis.sourceLength = this.source.length;\n\t// Set current parse position\n\tthis.pos = 0;\n\t// Instantiate the pragma parse rules\n\tthis.pragmaRules = this.instantiateRules(this.pragmaRuleClasses,\&quot;pragma\&quot;,0);\n\t// Instantiate the parser block and inline rules\n\tthis.blockRules = this.instantiateRules(this.blockRuleClasses,\&quot;block\&quot;,0);\n\tthis.inlineRules = this.instantiateRules(this.inlineRuleClasses,\&quot;inline\&quot;,0);\n\t// Parse any pragmas\n\tthis.tree = this.parsePragmas();\n\t// Parse the text into inline runs or blocks\n\tif(options.parseAsInline) {\n\t\tthis.tree.push.apply(this.tree,this.parseInlineRun());\n\t} else {\n\t\tthis.tree.push.apply(this.tree,this.parseBlocks());\n\t}\n\t// Return the parse tree\n};\n\n/*\nInstantiate an array of parse rules\n*/\nWikiParser.prototype.instantiateRules = function(classes,type,startPos) {\n\tvar rulesInfo = [],\n\t\tself = this;\n\t$tw.utils.each(classes,function(RuleClass) {\n\t\t// Instantiate the rule\n\t\tvar rule = new RuleClass(self);\n\t\trule.is = {};\n\t\trule.is[type] = true;\n\t\trule.init(self);\n\t\tvar matchIndex = rule.findNextMatch(startPos);\n\t\tif(matchIndex !== undefined) {\n\t\t\trulesInfo.push({\n\t\t\t\trule: rule,\n\t\t\t\tmatchIndex: matchIndex\n\t\t\t});\n\t\t}\n\t});\n\treturn rulesInfo;\n};\n\n/*\nSkip any whitespace at the current position. Options are:\n\ttreatNewlinesAsNonWhitespace: true if newlines are NOT to be treated as whitespace\n*/\nWikiParser.prototype.skipWhitespace = function(options) {\n\toptions = options || {};\n\tvar whitespaceRegExp = options.treatNewlinesAsNonWhitespace ? /([^\\S\\n]+)/mg : /(\\s+)/mg;\n\twhitespaceRegExp.lastIndex = this.pos;\n\tvar whitespaceMatch = whitespaceRegExp.exec(this.source);\n\tif(whitespaceMatch &amp;&amp; whitespaceMatch.index === this.pos) {\n\t\tthis.pos = whitespaceRegExp.lastIndex;\n\t}\n};\n\n/*\nGet the next match out of an array of parse rule instances\n*/\nWikiParser.prototype.findNextMatch = function(rules,startPos) {\n\t// Find the best matching rule by finding the closest match position\n\tvar matchingRule,\n\t\tmatchingRulePos = this.sourceLength;\n\t// Step through each rule\n\tfor(var t=0; t&lt;rules.length; t++) {\n\t\tvar ruleInfo = rules[t];\n\t\t// Ask the rule to get the next match if we've moved past the current one\n\t\tif(ruleInfo.matchIndex !== undefined  &amp;&amp; ruleInfo.matchIndex &lt; startPos) {\n\t\t\truleInfo.matchIndex = ruleInfo.rule.findNextMatch(startPos);\n\t\t}\n\t\t// Adopt this match if it's closer than the current best match\n\t\tif(ruleInfo.matchIndex !== undefined &amp;&amp; ruleInfo.matchIndex &lt;= matchingRulePos) {\n\t\t\tmatchingRule = ruleInfo;\n\t\t\tmatchingRulePos = ruleInfo.matchIndex;\n\t\t}\n\t}\n\treturn matchingRule;\n};\n\n/*\nParse any pragmas at the beginning of a block of parse text\n*/\nWikiParser.prototype.parsePragmas = function() {\n\tvar tree = [];\n\twhile(true) {\n\t\t// Skip whitespace\n\t\tthis.skipWhitespace();\n\t\t// Check for the end of the text\n\t\tif(this.pos &gt;= this.sourceLength) {\n\t\t\tbreak;\n\t\t}\n\t\t// Check if we've arrived at a pragma rule match\n\t\tvar nextMatch = this.findNextMatch(this.pragmaRules,this.pos);\n\t\t// If not, just exit\n\t\tif(!nextMatch || nextMatch.matchIndex !== this.pos) {\n\t\t\tbreak;\n\t\t}\n\t\t// Process the pragma rule\n\t\ttree.push.apply(tree,nextMatch.rule.parse());\n\t}\n\treturn tree;\n};\n\n/*\nParse a block from the current position\n\tterminatorRegExpString: optional regular expression string that identifies the end of plain paragraphs. Must not include capturing parenthesis\n*/\nWikiParser.prototype.parseBlock = function(terminatorRegExpString) {\n\tvar terminatorRegExp = terminatorRegExpString ? new RegExp(\&quot;(\&quot; + terminatorRegExpString + \&quot;|\\\\r?\\\\n\\\\r?\\\\n)\&quot;,\&quot;mg\&quot;) : /(\\r?\\n\\r?\\n)/mg;\n\tthis.skipWhitespace();\n\tif(this.pos &gt;= this.sourceLength) {\n\t\treturn [];\n\t}\n\t// Look for a block rule that applies at the current position\n\tvar nextMatch = this.findNextMatch(this.blockRules,this.pos);\n\tif(nextMatch &amp;&amp; nextMatch.matchIndex === this.pos) {\n\t\treturn nextMatch.rule.parse();\n\t}\n\t// Treat it as a paragraph if we didn't find a block rule\n\treturn [{type: \&quot;element\&quot;, tag: \&quot;p\&quot;, children: this.parseInlineRun(terminatorRegExp)}];\n};\n\n/*\nParse a series of blocks of text until a terminating regexp is encountered or the end of the text\n\tterminatorRegExpString: terminating regular expression\n*/\nWikiParser.prototype.parseBlocks = function(terminatorRegExpString) {\n\tif(terminatorRegExpString) {\n\t\treturn this.parseBlocksTerminated(terminatorRegExpString);\n\t} else {\n\t\treturn this.parseBlocksUnterminated();\n\t}\n};\n\n/*\nParse a block from the current position to the end of the text\n*/\nWikiParser.prototype.parseBlocksUnterminated = function() {\n\tvar tree = [];\n\twhile(this.pos &lt; this.sourceLength) {\n\t\ttree.push.apply(tree,this.parseBlock());\n\t}\n\treturn tree;\n};\n\n/*\nParse blocks of text until a terminating regexp is encountered\n*/\nWikiParser.prototype.parseBlocksTerminated = function(terminatorRegExpString) {\n\tvar terminatorRegExp = new RegExp(\&quot;(\&quot; + terminatorRegExpString + \&quot;)\&quot;,\&quot;mg\&quot;),\n\t\ttree = [];\n\t// Skip any whitespace\n\tthis.skipWhitespace();\n\t//  Check if we've got the end marker\n\tterminatorRegExp.lastIndex = this.pos;\n\tvar match = terminatorRegExp.exec(this.source);\n\t// Parse the text into blocks\n\twhile(this.pos &lt; this.sourceLength &amp;&amp; !(match &amp;&amp; match.index === this.pos)) {\n\t\tvar blocks = this.parseBlock(terminatorRegExpString);\n\t\ttree.push.apply(tree,blocks);\n\t\t// Skip any whitespace\n\t\tthis.skipWhitespace();\n\t\t//  Check if we've got the end marker\n\t\tterminatorRegExp.lastIndex = this.pos;\n\t\tmatch = terminatorRegExp.exec(this.source);\n\t}\n\tif(match &amp;&amp; match.index === this.pos) {\n\t\tthis.pos = match.index + match[0].length;\n\t}\n\treturn tree;\n};\n\n/*\nParse a run of text at the current position\n\tterminatorRegExp: a regexp at which to stop the run\n\toptions: see below\nOptions available:\n\teatTerminator: move the parse position past any encountered terminator (default false)\n*/\nWikiParser.prototype.parseInlineRun = function(terminatorRegExp,options) {\n\tif(terminatorRegExp) {\n\t\treturn this.parseInlineRunTerminated(terminatorRegExp,options);\n\t} else {\n\t\treturn this.parseInlineRunUnterminated(options);\n\t}\n};\n\nWikiParser.prototype.parseInlineRunUnterminated = function(options) {\n\tvar tree = [];\n\t// Find the next occurrence of an inline rule\n\tvar nextMatch = this.findNextMatch(this.inlineRules,this.pos);\n\t// Loop around the matches until we've reached the end of the text\n\twhile(this.pos &lt; this.sourceLength &amp;&amp; nextMatch) {\n\t\t// Process the text preceding the run rule\n\t\tif(nextMatch.matchIndex &gt; this.pos) {\n\t\t\ttree.push({type: \&quot;text\&quot;, text: this.source.substring(this.pos,nextMatch.matchIndex)});\n\t\t\tthis.pos = nextMatch.matchIndex;\n\t\t}\n\t\t// Process the run rule\n\t\ttree.push.apply(tree,nextMatch.rule.parse());\n\t\t// Look for the next run rule\n\t\tnextMatch = this.findNextMatch(this.inlineRules,this.pos);\n\t}\n\t// Process the remaining text\n\tif(this.pos &lt; this.sourceLength) {\n\t\ttree.push({type: \&quot;text\&quot;, text: this.source.substr(this.pos)});\n\t}\n\tthis.pos = this.sourceLength;\n\treturn tree;\n};\n\nWikiParser.prototype.parseInlineRunTerminated = function(terminatorRegExp,options) {\n\toptions = options || {};\n\tvar tree = [];\n\t// Find the next occurrence of the terminator\n\tterminatorRegExp.lastIndex = this.pos;\n\tvar terminatorMatch = terminatorRegExp.exec(this.source);\n\t// Find the next occurrence of a inlinerule\n\tvar inlineRuleMatch = this.findNextMatch(this.inlineRules,this.pos);\n\t// Loop around until we've reached the end of the text\n\twhile(this.pos &lt; this.sourceLength &amp;&amp; (terminatorMatch || inlineRuleMatch)) {\n\t\t// Return if we've found the terminator, and it precedes any inline rule match\n\t\tif(terminatorMatch) {\n\t\t\tif(!inlineRuleMatch || inlineRuleMatch.matchIndex &gt;= terminatorMatch.index) {\n\t\t\t\tif(terminatorMatch.index &gt; this.pos) {\n\t\t\t\t\ttree.push({type: \&quot;text\&quot;, text: this.source.substring(this.pos,terminatorMatch.index)});\n\t\t\t\t}\n\t\t\t\tthis.pos = terminatorMatch.index;\n\t\t\t\tif(options.eatTerminator) {\n\t\t\t\t\tthis.pos += terminatorMatch[0].length;\n\t\t\t\t}\n\t\t\t\treturn tree;\n\t\t\t}\n\t\t}\n\t\t// Process any inline rule, along with the text preceding it\n\t\tif(inlineRuleMatch) {\n\t\t\t// Preceding text\n\t\t\tif(inlineRuleMatch.matchIndex &gt; this.pos) {\n\t\t\t\ttree.push({type: \&quot;text\&quot;, text: this.source.substring(this.pos,inlineRuleMatch.matchIndex)});\n\t\t\t\tthis.pos = inlineRuleMatch.matchIndex;\n\t\t\t}\n\t\t\t// Process the inline rule\n\t\t\ttree.push.apply(tree,inlineRuleMatch.rule.parse());\n\t\t\t// Look for the next inline rule\n\t\t\tinlineRuleMatch = this.findNextMatch(this.inlineRules,this.pos);\n\t\t\t// Look for the next terminator match\n\t\t\tterminatorRegExp.lastIndex = this.pos;\n\t\t\tterminatorMatch = terminatorRegExp.exec(this.source);\n\t\t}\n\t}\n\t// Process the remaining text\n\tif(this.pos &lt; this.sourceLength) {\n\t\ttree.push({type: \&quot;text\&quot;, text: this.source.substr(this.pos)});\n\t}\n\tthis.pos = this.sourceLength;\n\treturn tree;\n};\n\n/*\nParse zero or more class specifiers `.classname`\n*/\nWikiParser.prototype.parseClasses = function() {\n\tvar classRegExp = /\\.([^\\s\\.]+)/mg,\n\t\tclassNames = [];\n\tclassRegExp.lastIndex = this.pos;\n\tvar match = classRegExp.exec(this.source);\n\twhile(match &amp;&amp; match.index === this.pos) {\n\t\tthis.pos = match.index + match[0].length;\n\t\tclassNames.push(match[1]);\n\t\tmatch = classRegExp.exec(this.source);\n\t}\n\treturn classNames;\n};\n\n/*\nAmend the rules used by this instance of the parser\n\ttype: `only` keeps just the named rules, `except` keeps all but the named rules\n\tnames: array of rule names\n*/\nWikiParser.prototype.amendRules = function(type,names) {\n\tnames = names || [];\n\t// Define the filter function\n\tvar keepFilter;\n\tif(type === \&quot;only\&quot;) {\n\t\tkeepFilter = function(name) {\n\t\t\treturn names.indexOf(name) !== -1;\n\t\t};\n\t} else if(type === \&quot;except\&quot;) {\n\t\tkeepFilter = function(name) {\n\t\t\treturn names.indexOf(name) === -1;\n\t\t};\n\t} else {\n\t\treturn;\n\t}\n\t// Define a function to process each of our rule arrays\n\tvar processRuleArray = function(ruleArray) {\n\t\tfor(var t=ruleArray.length-1; t&gt;=0; t--) {\n\t\t\tif(!keepFilter(ruleArray[t].rule.name)) {\n\t\t\t\truleArray.splice(t,1);\n\t\t\t}\n\t\t}\n\t};\n\t// Process each rule array\n\tprocessRuleArray(this.pragmaRules);\n\tprocessRuleArray(this.blockRules);\n\tprocessRuleArray(this.inlineRules);\n};\n\nexports[\&quot;text/vnd.tiddlywiki\&quot;] = WikiParser;\n\n})();\n\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/wikiparser.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;parser&quot;
        },
        &quot;$:/core/modules/parsers/wikiparser/rules/wikirulebase.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/parsers/wikiparser/rules/wikirulebase.js\ntype: application/javascript\nmodule-type: global\n\nBase class for wiki parser rules\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nThis constructor is always overridden with a blank constructor, and so shouldn't be used\n*/\nvar WikiRuleBase = function() {\n};\n\n/*\nTo be overridden by individual rules\n*/\nWikiRuleBase.prototype.init = function(parser) {\n\tthis.parser = parser;\n};\n\n/*\nDefault implementation of findNextMatch uses RegExp matching\n*/\nWikiRuleBase.prototype.findNextMatch = function(startPos) {\n\tthis.matchRegExp.lastIndex = startPos;\n\tthis.match = this.matchRegExp.exec(this.parser.source);\n\treturn this.match ? this.match.index : undefined;\n};\n\nexports.WikiRuleBase = WikiRuleBase;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/parsers/wikiparser/rules/wikirulebase.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;global&quot;
        },
        &quot;$:/core/modules/pluginswitcher.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/pluginswitcher.js\ntype: application/javascript\nmodule-type: global\n\nManages switching plugins for themes and languages.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\noptions:\nwiki: wiki store to be used\npluginType: type of plugin to be switched\ncontrollerTitle: title of tiddler used to control switching of this resource\ndefaultPlugins: array of default plugins to be used if nominated plugin isn't found\n*/\nfunction PluginSwitcher(options) {\n\tthis.wiki = options.wiki;\n\tthis.pluginType = options.pluginType;\n\tthis.controllerTitle = options.controllerTitle;\n\tthis.defaultPlugins = options.defaultPlugins || [];\n\t// Switch to the current plugin\n\tthis.switchPlugins();\n\t// Listen for changes to the selected plugin\n\tvar self = this;\n\tthis.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\tif($tw.utils.hop(changes,self.controllerTitle)) {\n\t\t\tself.switchPlugins();\n\t\t}\n\t});\n}\n\nPluginSwitcher.prototype.switchPlugins = function() {\n\t// Get the name of the current theme\n\tvar selectedPluginTitle = this.wiki.getTiddlerText(this.controllerTitle);\n\t// If it doesn't exist, then fallback to one of the default themes\n\tvar index = 0;\n\twhile(!this.wiki.getTiddler(selectedPluginTitle) &amp;&amp; index &lt; this.defaultPlugins.length) {\n\t\tselectedPluginTitle = this.defaultPlugins[index++];\n\t}\n\t// Accumulate the titles of the plugins that we need to load\n\tvar plugins = [],\n\t\tself = this,\n\t\taccumulatePlugin = function(title) {\n\t\t\tvar tiddler = self.wiki.getTiddler(title);\n\t\t\tif(tiddler &amp;&amp; tiddler.isPlugin() &amp;&amp; plugins.indexOf(title) === -1) {\n\t\t\t\tplugins.push(title);\n\t\t\t\tvar pluginInfo = JSON.parse(self.wiki.getTiddlerText(title)),\n\t\t\t\t\tdependents = $tw.utils.parseStringArray(tiddler.fields.dependents || \&quot;\&quot;);\n\t\t\t\t$tw.utils.each(dependents,function(title) {\n\t\t\t\t\taccumulatePlugin(title);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\taccumulatePlugin(selectedPluginTitle);\n\t// Unregister any existing theme tiddlers\n\tvar unregisteredTiddlers = $tw.wiki.unregisterPluginTiddlers(this.pluginType);\n\t// Register any new theme tiddlers\n\tvar registeredTiddlers = $tw.wiki.registerPluginTiddlers(this.pluginType,plugins);\n\t// Unpack the current theme tiddlers\n\t$tw.wiki.unpackPluginTiddlers();\n};\n\nexports.PluginSwitcher = PluginSwitcher;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/pluginswitcher.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;global&quot;
        },
        &quot;$:/core/modules/saver-handler.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/saver-handler.js\ntype: application/javascript\nmodule-type: global\n\nThe saver handler tracks changes to the store and handles saving the entire wiki via saver modules.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInstantiate the saver handler with the following options:\nwiki: wiki to be synced\ndirtyTracking: true if dirty tracking should be performed\n*/\nfunction SaverHandler(options) {\n\tvar self = this;\n\tthis.wiki = options.wiki;\n\tthis.dirtyTracking = options.dirtyTracking;\n\tthis.pendingAutoSave = false;\n\t// Make a logger\n\tthis.logger = new $tw.utils.Logger(\&quot;saver-handler\&quot;);\n\t// Initialise our savers\n\tif($tw.browser) {\n\t\tthis.initSavers();\n\t}\n\t// Only do dirty tracking if required\n\tif($tw.browser &amp;&amp; this.dirtyTracking) {\n\t\t// Compile the dirty tiddler filter\n\t\tthis.filterFn = this.wiki.compileFilter(this.wiki.getTiddlerText(this.titleSyncFilter));\n\t\t// Count of changes that have not yet been saved\n\t\tthis.numChanges = 0;\n\t\t// Listen out for changes to tiddlers\n\t\tthis.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\t\t// Filter the changes so that we only count changes to tiddlers that we care about\n\t\t\tvar filteredChanges = self.filterFn.call(self.wiki,function(callback) {\n\t\t\t\t$tw.utils.each(changes,function(change,title) {\n\t\t\t\t\tvar tiddler = self.wiki.getTiddler(title);\n\t\t\t\t\tcallback(tiddler,title);\n\t\t\t\t});\n\t\t\t});\n\t\t\t// Adjust the number of changes\n\t\t\tself.numChanges += filteredChanges.length;\n\t\t\tself.updateDirtyStatus();\n\t\t\t// Do any autosave if one is pending and there's no more change events\n\t\t\tif(self.pendingAutoSave &amp;&amp; self.wiki.getSizeOfTiddlerEventQueue() === 0) {\n\t\t\t\t// Check if we're dirty\n\t\t\t\tif(self.numChanges &gt; 0) {\n\t\t\t\t\tself.saveWiki({\n\t\t\t\t\t\tmethod: \&quot;autosave\&quot;,\n\t\t\t\t\t\tdownloadType: \&quot;text/plain\&quot;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tself.pendingAutoSave = false;\n\t\t\t}\n\t\t});\n\t\t// Listen for the autosave event\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-auto-save-wiki\&quot;,function(event) {\n\t\t\t// Do the autosave unless there are outstanding tiddler change events\n\t\t\tif(self.wiki.getSizeOfTiddlerEventQueue() === 0) {\n\t\t\t\t// Check if we're dirty\n\t\t\t\tif(self.numChanges &gt; 0) {\n\t\t\t\t\tself.saveWiki({\n\t\t\t\t\t\tmethod: \&quot;autosave\&quot;,\n\t\t\t\t\t\tdownloadType: \&quot;text/plain\&quot;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Otherwise put ourselves in the \&quot;pending autosave\&quot; state and wait for the change event before we do the autosave\n\t\t\t\tself.pendingAutoSave = true;\n\t\t\t}\n\t\t});\n\t\t// Set up our beforeunload handler\n\t\twindow.addEventListener(\&quot;beforeunload\&quot;,function(event) {\n\t\t\tvar confirmationMessage;\n\t\t\tif(self.isDirty()) {\n\t\t\t\tconfirmationMessage = $tw.language.getString(\&quot;UnsavedChangesWarning\&quot;);\n\t\t\t\tevent.returnValue = confirmationMessage; // Gecko\n\t\t\t}\n\t\t\treturn confirmationMessage;\n\t\t});\n\t}\n\t// Install the save action handlers\n\tif($tw.browser) {\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-save-wiki\&quot;,function(event) {\n\t\t\tself.saveWiki({\n\t\t\t\ttemplate: event.param,\n\t\t\t\tdownloadType: \&quot;text/plain\&quot;,\n\t\t\t\tvariables: event.paramObject\n\t\t\t});\n\t\t});\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-download-file\&quot;,function(event) {\n\t\t\tself.saveWiki({\n\t\t\t\tmethod: \&quot;download\&quot;,\n\t\t\t\ttemplate: event.param,\n\t\t\t\tdownloadType: \&quot;text/plain\&quot;,\n\t\t\t\tvariables: event.paramObject\n\t\t\t});\n\t\t});\n\t}\n}\n\nSaverHandler.prototype.titleSyncFilter = \&quot;$:/config/SaverFilter\&quot;;\nSaverHandler.prototype.titleAutoSave = \&quot;$:/config/AutoSave\&quot;;\nSaverHandler.prototype.titleSavedNotification = \&quot;$:/language/Notifications/Save/Done\&quot;;\n\n/*\nSelect the appropriate saver modules and set them up\n*/\nSaverHandler.prototype.initSavers = function(moduleType) {\n\tmoduleType = moduleType || \&quot;saver\&quot;;\n\t// Instantiate the available savers\n\tthis.savers = [];\n\tvar self = this;\n\t$tw.modules.forEachModuleOfType(moduleType,function(title,module) {\n\t\tif(module.canSave(self)) {\n\t\t\tself.savers.push(module.create(self.wiki));\n\t\t}\n\t});\n\t// Sort the savers into priority order\n\tthis.savers.sort(function(a,b) {\n\t\tif(a.info.priority &lt; b.info.priority) {\n\t\t\treturn -1;\n\t\t} else {\n\t\t\tif(a.info.priority &gt; b.info.priority) {\n\t\t\t\treturn +1;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t});\n};\n\n/*\nSave the wiki contents. Options are:\n\tmethod: \&quot;save\&quot;, \&quot;autosave\&quot; or \&quot;download\&quot;\n\ttemplate: the tiddler containing the template to save\n\tdownloadType: the content type for the saved file\n*/\nSaverHandler.prototype.saveWiki = function(options) {\n\toptions = options || {};\n\tvar self = this,\n\t\tmethod = options.method || \&quot;save\&quot;,\n\t\tvariables = options.variables || {},\n\t\ttemplate = options.template || \&quot;$:/core/save/all\&quot;,\n\t\tdownloadType = options.downloadType || \&quot;text/plain\&quot;,\n\t\ttext = this.wiki.renderTiddler(downloadType,template,options),\n\t\tcallback = function(err) {\n\t\t\tif(err) {\n\t\t\t\talert(\&quot;Error while saving:\\n\\n\&quot; + err);\n\t\t\t} else {\n\t\t\t\t// Clear the task queue if we're saving (rather than downloading)\n\t\t\t\tif(method !== \&quot;download\&quot;) {\n\t\t\t\t\tself.numChanges = 0;\n\t\t\t\t\tself.updateDirtyStatus();\n\t\t\t\t}\n\t\t\t\t$tw.notifier.display(self.titleSavedNotification);\n\t\t\t\tif(options.callback) {\n\t\t\t\t\toptions.callback();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t// Ignore autosave if disabled\n\tif(method === \&quot;autosave\&quot; &amp;&amp; this.wiki.getTiddlerText(this.titleAutoSave,\&quot;yes\&quot;) !== \&quot;yes\&quot;) {\n\t\treturn false;\n\t}\n\t// Call the highest priority saver that supports this method\n\tfor(var t=this.savers.length-1; t&gt;=0; t--) {\n\t\tvar saver = this.savers[t];\n\t\tif(saver.info.capabilities.indexOf(method) !== -1 &amp;&amp; saver.save(text,method,callback,{variables: {filename: variables.filename}})) {\n\t\t\tthis.logger.log(\&quot;Saving wiki with method\&quot;,method,\&quot;through saver\&quot;,saver.info.name);\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\n/*\nChecks whether the wiki is dirty (ie the window shouldn't be closed)\n*/\nSaverHandler.prototype.isDirty = function() {\n\treturn this.numChanges &gt; 0;\n};\n\n/*\nUpdate the document body with the class \&quot;tc-dirty\&quot; if the wiki has unsaved/unsynced changes\n*/\nSaverHandler.prototype.updateDirtyStatus = function() {\n\tif($tw.browser) {\n\t\t$tw.utils.toggleClass(document.body,\&quot;tc-dirty\&quot;,this.isDirty());\n\t}\n};\n\nexports.SaverHandler = SaverHandler;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/saver-handler.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;global&quot;
        },
        &quot;$:/core/modules/savers/andtidwiki.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/savers/andtidwiki.js\ntype: application/javascript\nmodule-type: saver\n\nHandles saving changes via the AndTidWiki Android app\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false, netscape: false, Components: false */\n\&quot;use strict\&quot;;\n\nvar AndTidWiki = function(wiki) {\n};\n\nAndTidWiki.prototype.save = function(text,method,callback) {\n\t// Get the pathname of this document\n\tvar pathname = decodeURIComponent(document.location.toString().split(\&quot;#\&quot;)[0]);\n\t// Strip the file://\n\tif(pathname.indexOf(\&quot;file://\&quot;) === 0) {\n\t\tpathname = pathname.substr(7);\n\t}\n\t// Strip any query or location part\n\tvar p = pathname.indexOf(\&quot;?\&quot;);\n\tif(p !== -1) {\n\t\tpathname = pathname.substr(0,p);\n\t}\n\tp = pathname.indexOf(\&quot;#\&quot;);\n\tif(p !== -1) {\n\t\tpathname = pathname.substr(0,p);\n\t}\n\t// Save the file\n\twindow.twi.saveFile(pathname,text);\n\t// Call the callback\n\tcallback(null);\n\treturn true;\n};\n\n/*\nInformation about this saver\n*/\nAndTidWiki.prototype.info = {\n\tname: \&quot;andtidwiki\&quot;,\n\tpriority: 1600,\n\tcapabilities: [\&quot;save\&quot;, \&quot;autosave\&quot;]\n};\n\n/*\nStatic method that returns true if this saver is capable of working\n*/\nexports.canSave = function(wiki) {\n\treturn !!window.twi &amp;&amp; !!window.twi.saveFile;\n};\n\n/*\nCreate an instance of this saver\n*/\nexports.create = function(wiki) {\n\treturn new AndTidWiki(wiki);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/savers/andtidwiki.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;saver&quot;
        },
        &quot;$:/core/modules/savers/download.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/savers/download.js\ntype: application/javascript\nmodule-type: saver\n\nHandles saving changes via HTML5's download APIs\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nSelect the appropriate saver module and set it up\n*/\nvar DownloadSaver = function(wiki) {\n};\n\nDownloadSaver.prototype.save = function(text,method,callback,options) {\n\toptions = options || {};\n\t// Get the current filename\n\tvar filename = options.variables.filename;\n\tif(!filename) {\n\t\tvar p = document.location.pathname.lastIndexOf(\&quot;/\&quot;);\n\t\tif(p !== -1) {\n\t\t\tfilename = document.location.pathname.substr(p+1);\n\t\t}\n\t}\n\tif(!filename) {\n\t\tfilename = \&quot;tiddlywiki.html\&quot;;\n\t}\n\t// Set up the link\n\tvar link = document.createElement(\&quot;a\&quot;);\n\tlink.setAttribute(\&quot;target\&quot;,\&quot;_blank\&quot;);\n\tif(Blob !== undefined) {\n\t\tvar blob = new Blob([text], {type: \&quot;text/html\&quot;});\n\t\tlink.setAttribute(\&quot;href\&quot;, URL.createObjectURL(blob));\n\t} else {\n\t\tlink.setAttribute(\&quot;href\&quot;,\&quot;data:text/html,\&quot; + encodeURIComponent(text));\n\t}\n\tlink.setAttribute(\&quot;download\&quot;,filename);\n\tdocument.body.appendChild(link);\n\tlink.click();\n\tdocument.body.removeChild(link);\n\t// Callback that we succeeded\n\tcallback(null);\n\treturn true;\n};\n\n/*\nInformation about this saver\n*/\nDownloadSaver.prototype.info = {\n\tname: \&quot;download\&quot;,\n\tpriority: 100,\n\tcapabilities: [\&quot;save\&quot;, \&quot;download\&quot;]\n};\n\n/*\nStatic method that returns true if this saver is capable of working\n*/\nexports.canSave = function(wiki) {\n\treturn document.createElement(\&quot;a\&quot;).download !== undefined;\n};\n\n/*\nCreate an instance of this saver\n*/\nexports.create = function(wiki) {\n\treturn new DownloadSaver(wiki);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/savers/download.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;saver&quot;
        },
        &quot;$:/core/modules/savers/fsosaver.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/savers/fsosaver.js\ntype: application/javascript\nmodule-type: saver\n\nHandles saving changes via MS FileSystemObject ActiveXObject\n\nNote: Since TiddlyWiki's markup contains the MOTW, the FileSystemObject normally won't be available. \nHowever, if the wiki is loaded as an .HTA file (Windows HTML Applications) then the FSO can be used.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nSelect the appropriate saver module and set it up\n*/\nvar FSOSaver = function(wiki) {\n};\n\nFSOSaver.prototype.save = function(text,method,callback) {\n\t// Get the pathname of this document\n\tvar pathname = unescape(document.location.pathname);\n\t// Test for a Windows path of the form /x:\\blah...\n\tif(/^\\/[A-Z]\\:\\\\[^\\\\]+/i.test(pathname)) {\t// ie: ^/[a-z]:/[^/]+\n\t\t// Remove the leading slash\n\t\tpathname = pathname.substr(1);\n\t} else if(document.location.hostname !== \&quot;\&quot; &amp;&amp; /^\\/\\\\[^\\\\]+\\\\[^\\\\]+/i.test(pathname)) {\t// test for \\\\server\\share\\blah... - ^/[^/]+/[^/]+\n\t\t// Remove the leading slash\n\t\tpathname = pathname.substr(1);\n\t\t// reconstruct UNC path\n\t\tpathname = \&quot;\\\\\\\\\&quot; + document.location.hostname + pathname;\n\t} else {\n\t\treturn false;\n\t}\n\t// Save the file (as UTF-16)\n\tvar fso = new ActiveXObject(\&quot;Scripting.FileSystemObject\&quot;);\n\tvar file = fso.OpenTextFile(pathname,2,-1,-1);\n\tfile.Write(text);\n\tfile.Close();\n\t// Callback that we succeeded\n\tcallback(null);\n\treturn true;\n};\n\n/*\nInformation about this saver\n*/\nFSOSaver.prototype.info = {\n\tname: \&quot;FSOSaver\&quot;,\n\tpriority: 120,\n\tcapabilities: [\&quot;save\&quot;, \&quot;autosave\&quot;]\n};\n\n/*\nStatic method that returns true if this saver is capable of working\n*/\nexports.canSave = function(wiki) {\n\ttry {\n\t\treturn (window.location.protocol === \&quot;file:\&quot;) &amp;&amp; !!(new ActiveXObject(\&quot;Scripting.FileSystemObject\&quot;));\n\t} catch(e) { return false; }\n};\n\n/*\nCreate an instance of this saver\n*/\nexports.create = function(wiki) {\n\treturn new FSOSaver(wiki);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/savers/fsosaver.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;saver&quot;
        },
        &quot;$:/core/modules/savers/manualdownload.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/savers/manualdownload.js\ntype: application/javascript\nmodule-type: saver\n\nHandles saving changes via HTML5's download APIs\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Title of the tiddler containing the download message\nvar downloadInstructionsTitle = \&quot;$:/language/Modals/Download\&quot;;\n\n/*\nSelect the appropriate saver module and set it up\n*/\nvar ManualDownloadSaver = function(wiki) {\n};\n\nManualDownloadSaver.prototype.save = function(text,method,callback) {\n\t$tw.modal.display(downloadInstructionsTitle,{\n\t\tdownloadLink: \&quot;data:text/html,\&quot; + encodeURIComponent(text)\n\t});\n\t// Callback that we succeeded\n\tcallback(null);\n\treturn true;\n};\n\n/*\nInformation about this saver\n*/\nManualDownloadSaver.prototype.info = {\n\tname: \&quot;manualdownload\&quot;,\n\tpriority: 0,\n\tcapabilities: [\&quot;save\&quot;, \&quot;download\&quot;]\n};\n\n/*\nStatic method that returns true if this saver is capable of working\n*/\nexports.canSave = function(wiki) {\n\treturn true;\n};\n\n/*\nCreate an instance of this saver\n*/\nexports.create = function(wiki) {\n\treturn new ManualDownloadSaver(wiki);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/savers/manualdownload.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;saver&quot;
        },
        &quot;$:/core/modules/savers/msdownload.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/savers/msdownload.js\ntype: application/javascript\nmodule-type: saver\n\nHandles saving changes via window.navigator.msSaveBlob()\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nSelect the appropriate saver module and set it up\n*/\nvar MsDownloadSaver = function(wiki) {\n};\n\nMsDownloadSaver.prototype.save = function(text,method,callback) {\n\t// Get the current filename\n\tvar filename = \&quot;tiddlywiki.html\&quot;,\n\t\tp = document.location.pathname.lastIndexOf(\&quot;/\&quot;);\n\tif(p !== -1) {\n\t\tfilename = document.location.pathname.substr(p+1);\n\t}\n\t// Set up the link\n\tvar blob = new Blob([text], {type: \&quot;text/html\&quot;});\n\twindow.navigator.msSaveBlob(blob,filename);\n\t// Callback that we succeeded\n\tcallback(null);\n\treturn true;\n};\n\n/*\nInformation about this saver\n*/\nMsDownloadSaver.prototype.info = {\n\tname: \&quot;msdownload\&quot;,\n\tpriority: 110,\n\tcapabilities: [\&quot;save\&quot;, \&quot;download\&quot;]\n};\n\n/*\nStatic method that returns true if this saver is capable of working\n*/\nexports.canSave = function(wiki) {\n\treturn !!window.navigator.msSaveBlob;\n};\n\n/*\nCreate an instance of this saver\n*/\nexports.create = function(wiki) {\n\treturn new MsDownloadSaver(wiki);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/savers/msdownload.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;saver&quot;
        },
        &quot;$:/core/modules/savers/tiddlyfox.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/savers/tiddlyfox.js\ntype: application/javascript\nmodule-type: saver\n\nHandles saving changes via the TiddlyFox file extension\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false, netscape: false, Components: false */\n\&quot;use strict\&quot;;\n\nvar TiddlyFoxSaver = function(wiki) {\n};\n\nTiddlyFoxSaver.prototype.save = function(text,method,callback) {\n\tvar messageBox = document.getElementById(\&quot;tiddlyfox-message-box\&quot;);\n\tif(messageBox) {\n\t\t// Get the pathname of this document\n\t\tvar pathname = document.location.toString().split(\&quot;#\&quot;)[0];\n\t\t// Replace file://localhost/ with file:///\n\t\tif(pathname.indexOf(\&quot;file://localhost/\&quot;) === 0) {\n\t\t\tpathname = \&quot;file://\&quot; + pathname.substr(16);\n\t\t}\n\t\t// Windows path file:///x:/blah/blah --&gt; x:\\blah\\blah\n\t\tif(/^file\\:\\/\\/\\/[A-Z]\\:\\//i.test(pathname)) {\n\t\t\t// Remove the leading slash and convert slashes to backslashes\n\t\t\tpathname = pathname.substr(8).replace(/\\//g,\&quot;\\\\\&quot;);\n\t\t// Firefox Windows network path file://///server/share/blah/blah --&gt; //server/share/blah/blah\n\t\t} else if(pathname.indexOf(\&quot;file://///\&quot;) === 0) {\n\t\t\tpathname = \&quot;\\\\\\\\\&quot; + unescape(pathname.substr(10)).replace(/\\//g,\&quot;\\\\\&quot;);\n\t\t// Mac/Unix local path file:///path/path --&gt; /path/path\n\t\t} else if(pathname.indexOf(\&quot;file:///\&quot;) === 0) {\n\t\t\tpathname = unescape(pathname.substr(7));\n\t\t// Mac/Unix local path file:/path/path --&gt; /path/path\n\t\t} else if(pathname.indexOf(\&quot;file:/\&quot;) === 0) {\n\t\t\tpathname = unescape(pathname.substr(5));\n\t\t// Otherwise Windows networth path file://server/share/path/path --&gt; \\\\server\\share\\path\\path\n\t\t} else {\n\t\t\tpathname = \&quot;\\\\\\\\\&quot; + unescape(pathname.substr(7)).replace(new RegExp(\&quot;/\&quot;,\&quot;g\&quot;),\&quot;\\\\\&quot;);\n\t\t}\n\t\t// Create the message element and put it in the message box\n\t\tvar message = document.createElement(\&quot;div\&quot;);\n\t\tmessage.setAttribute(\&quot;data-tiddlyfox-path\&quot;,decodeURIComponent(pathname));\n\t\tmessage.setAttribute(\&quot;data-tiddlyfox-content\&quot;,text);\n\t\tmessageBox.appendChild(message);\n\t\t// Add an event handler for when the file has been saved\n\t\tmessage.addEventListener(\&quot;tiddlyfox-have-saved-file\&quot;,function(event) {\n\t\t\tcallback(null);\n\t\t}, false);\n\t\t// Create and dispatch the custom event to the extension\n\t\tvar event = document.createEvent(\&quot;Events\&quot;);\n\t\tevent.initEvent(\&quot;tiddlyfox-save-file\&quot;,true,false);\n\t\tmessage.dispatchEvent(event);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n};\n\n/*\nInformation about this saver\n*/\nTiddlyFoxSaver.prototype.info = {\n\tname: \&quot;tiddlyfox\&quot;,\n\tpriority: 1500,\n\tcapabilities: [\&quot;save\&quot;, \&quot;autosave\&quot;]\n};\n\n/*\nStatic method that returns true if this saver is capable of working\n*/\nexports.canSave = function(wiki) {\n\treturn (window.location.protocol === \&quot;file:\&quot;);\n};\n\n/*\nCreate an instance of this saver\n*/\nexports.create = function(wiki) {\n\treturn new TiddlyFoxSaver(wiki);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/savers/tiddlyfox.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;saver&quot;
        },
        &quot;$:/core/modules/savers/tiddlyie.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/savers/tiddlyie.js\ntype: application/javascript\nmodule-type: saver\n\nHandles saving changes via Internet Explorer BHO extenion (TiddlyIE)\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nSelect the appropriate saver module and set it up\n*/\nvar TiddlyIESaver = function(wiki) {\n};\n\nTiddlyIESaver.prototype.save = function(text,method,callback) {\n\t// Check existence of TiddlyIE BHO extension (note: only works after document is complete)\n\tif(typeof(window.TiddlyIE) != \&quot;undefined\&quot;) {\n\t\t// Get the pathname of this document\n\t\tvar pathname = unescape(document.location.pathname);\n\t\t// Test for a Windows path of the form /x:/blah...\n\t\tif(/^\\/[A-Z]\\:\\/[^\\/]+/i.test(pathname)) {\t// ie: ^/[a-z]:/[^/]+ (is this better?: ^/[a-z]:/[^/]+(/[^/]+)*\\.[^/]+ )\n\t\t\t// Remove the leading slash\n\t\t\tpathname = pathname.substr(1);\n\t\t\t// Convert slashes to backslashes\n\t\t\tpathname = pathname.replace(/\\//g,\&quot;\\\\\&quot;);\n\t\t} else if(document.hostname !== \&quot;\&quot; &amp;&amp; /^\\/[^\\/]+\\/[^\\/]+/i.test(pathname)) {\t// test for \\\\server\\share\\blah... - ^/[^/]+/[^/]+\n\t\t\t// Convert slashes to backslashes\n\t\t\tpathname = pathname.replace(/\\//g,\&quot;\\\\\&quot;);\n\t\t\t// reconstruct UNC path\n\t\t\tpathname = \&quot;\\\\\\\\\&quot; + document.location.hostname + pathname;\n\t\t} else return false;\n\t\t// Prompt the user to save the file\n\t\twindow.TiddlyIE.save(pathname, text);\n\t\t// Callback that we succeeded\n\t\tcallback(null);\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n};\n\n/*\nInformation about this saver\n*/\nTiddlyIESaver.prototype.info = {\n\tname: \&quot;tiddlyiesaver\&quot;,\n\tpriority: 1500,\n\tcapabilities: [\&quot;save\&quot;]\n};\n\n/*\nStatic method that returns true if this saver is capable of working\n*/\nexports.canSave = function(wiki) {\n\treturn (window.location.protocol === \&quot;file:\&quot;);\n};\n\n/*\nCreate an instance of this saver\n*/\nexports.create = function(wiki) {\n\treturn new TiddlyIESaver(wiki);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/savers/tiddlyie.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;saver&quot;
        },
        &quot;$:/core/modules/savers/twedit.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/savers/twedit.js\ntype: application/javascript\nmodule-type: saver\n\nHandles saving changes via the TWEdit iOS app\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false, netscape: false, Components: false */\n\&quot;use strict\&quot;;\n\nvar TWEditSaver = function(wiki) {\n};\n\nTWEditSaver.prototype.save = function(text,method,callback) {\n\t// Bail if we're not running under TWEdit\n\tif(typeof DeviceInfo !== \&quot;object\&quot;) {\n\t\treturn false;\n\t}\n\t// Get the pathname of this document\n\tvar pathname = decodeURIComponent(document.location.pathname);\n\t// Strip any query or location part\n\tvar p = pathname.indexOf(\&quot;?\&quot;);\n\tif(p !== -1) {\n\t\tpathname = pathname.substr(0,p);\n\t}\n\tp = pathname.indexOf(\&quot;#\&quot;);\n\tif(p !== -1) {\n\t\tpathname = pathname.substr(0,p);\n\t}\n\t// Remove the leading \&quot;/Documents\&quot; from path\n\tvar prefix = \&quot;/Documents\&quot;;\n\tif(pathname.indexOf(prefix) === 0) {\n\t\tpathname = pathname.substr(prefix.length);\n\t}\n\t// Error handler\n\tvar errorHandler = function(event) {\n\t\t// Error\n\t\tcallback(\&quot;Error saving to TWEdit: \&quot; + event.target.error.code);\n\t};\n\t// Get the file system\n\twindow.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(fileSystem) {\n\t\t// Now we've got the filesystem, get the fileEntry\n\t\tfileSystem.root.getFile(pathname, {create: true}, function(fileEntry) {\n\t\t\t// Now we've got the fileEntry, create the writer\n\t\t\tfileEntry.createWriter(function(writer) {\n\t\t\t\twriter.onerror = errorHandler;\n\t\t\t\twriter.onwrite = function() {\n\t\t\t\t\tcallback(null);\n\t\t\t\t};\n\t\t\t\twriter.position = 0;\n\t\t\t\twriter.write(text);\n\t\t\t},errorHandler);\n\t\t}, errorHandler);\n\t}, errorHandler);\n\treturn true;\n};\n\n/*\nInformation about this saver\n*/\nTWEditSaver.prototype.info = {\n\tname: \&quot;twedit\&quot;,\n\tpriority: 1600,\n\tcapabilities: [\&quot;save\&quot;, \&quot;autosave\&quot;]\n};\n\n/*\nStatic method that returns true if this saver is capable of working\n*/\nexports.canSave = function(wiki) {\n\treturn true;\n};\n\n/*\nCreate an instance of this saver\n*/\nexports.create = function(wiki) {\n\treturn new TWEditSaver(wiki);\n};\n\n/////////////////////////// Hack\n// HACK: This ensures that TWEdit recognises us as a TiddlyWiki document\nif($tw.browser) {\n\twindow.version = {title: \&quot;TiddlyWiki\&quot;};\n}\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/savers/twedit.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;saver&quot;
        },
        &quot;$:/core/modules/savers/upload.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/savers/upload.js\ntype: application/javascript\nmodule-type: saver\n\nHandles saving changes via upload to a server.\n\nDesigned to be compatible with BidiX's UploadPlugin at http://tiddlywiki.bidix.info/#UploadPlugin\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nSelect the appropriate saver module and set it up\n*/\nvar UploadSaver = function(wiki) {\n\tthis.wiki = wiki;\n};\n\nUploadSaver.prototype.save = function(text,method,callback) {\n\t// Get the various parameters we need\n\tvar backupDir = this.wiki.getTextReference(\&quot;$:/UploadBackupDir\&quot;) || \&quot;.\&quot;,\n\t\tusername = this.wiki.getTextReference(\&quot;$:/UploadName\&quot;),\n\t\tpassword = $tw.utils.getPassword(\&quot;upload\&quot;),\n\t\tuploadDir = this.wiki.getTextReference(\&quot;$:/UploadDir\&quot;) || \&quot;.\&quot;,\n\t\tuploadFilename = this.wiki.getTextReference(\&quot;$:/UploadFilename\&quot;) || \&quot;index.html\&quot;,\n\t\turl = this.wiki.getTextReference(\&quot;$:/UploadURL\&quot;);\n\t// Bail out if we don't have the bits we need\n\tif(!username || username.toString().trim() === \&quot;\&quot; || !password || password.toString().trim() === \&quot;\&quot;) {\n\t\treturn false;\n\t}\n\t// Construct the url if not provided\n\tif(!url) {\n\t\turl = \&quot;http://\&quot; + username + \&quot;.tiddlyspot.com/store.cgi\&quot;;\n\t}\n\t// Assemble the header\n\tvar boundary = \&quot;---------------------------\&quot; + \&quot;AaB03x\&quot;;\t\n\tvar uploadFormName = \&quot;UploadPlugin\&quot;;\n\tvar head = [];\n\thead.push(\&quot;--\&quot; + boundary + \&quot;\\r\\nContent-disposition: form-data; name=\\\&quot;UploadPlugin\\\&quot;\\r\\n\&quot;);\n\thead.push(\&quot;backupDir=\&quot; + backupDir + \&quot;;user=\&quot; + username + \&quot;;password=\&quot; + password + \&quot;;uploaddir=\&quot; + uploadDir + \&quot;;;\&quot;); \n\thead.push(\&quot;\\r\\n\&quot; + \&quot;--\&quot; + boundary);\n\thead.push(\&quot;Content-disposition: form-data; name=\\\&quot;userfile\\\&quot;; filename=\\\&quot;\&quot; + uploadFilename + \&quot;\\\&quot;\&quot;);\n\thead.push(\&quot;Content-Type: text/html;charset=UTF-8\&quot;);\n\thead.push(\&quot;Content-Length: \&quot; + text.length + \&quot;\\r\\n\&quot;);\n\thead.push(\&quot;\&quot;);\n\t// Assemble the tail and the data itself\n\tvar tail = \&quot;\\r\\n--\&quot; + boundary + \&quot;--\\r\\n\&quot;,\n\t\tdata = head.join(\&quot;\\r\\n\&quot;) + text + tail;\n\t// Do the HTTP post\n\tvar http = new XMLHttpRequest();\n\thttp.open(\&quot;POST\&quot;,url,true,username,password);\n\thttp.setRequestHeader(\&quot;Content-Type\&quot;,\&quot;multipart/form-data; ;charset=UTF-8; boundary=\&quot; + boundary);\n\thttp.onreadystatechange = function() {\n\t\tif(http.readyState == 4 &amp;&amp; http.status == 200) {\n\t\t\tif(http.responseText.substr(0,4) === \&quot;0 - \&quot;) {\n\t\t\t\tcallback(null);\n\t\t\t} else {\n\t\t\t\tcallback(http.responseText);\n\t\t\t}\n\t\t}\n\t};\n\ttry {\n\t\thttp.send(data);\n\t} catch(ex) {\n\t\treturn callback(\&quot;Error:\&quot; + ex);\n\t}\n\t$tw.notifier.display(\&quot;$:/language/Notifications/Save/Starting\&quot;);\n\treturn true;\n};\n\n/*\nInformation about this saver\n*/\nUploadSaver.prototype.info = {\n\tname: \&quot;upload\&quot;,\n\tpriority: 2000,\n\tcapabilities: [\&quot;save\&quot;, \&quot;autosave\&quot;]\n};\n\n/*\nStatic method that returns true if this saver is capable of working\n*/\nexports.canSave = function(wiki) {\n\treturn true;\n};\n\n/*\nCreate an instance of this saver\n*/\nexports.create = function(wiki) {\n\treturn new UploadSaver(wiki);\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/savers/upload.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;saver&quot;
        },
        &quot;$:/core/modules/startup/commands.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/startup/commands.js\ntype: application/javascript\nmodule-type: startup\n\nCommand processing\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Export name and synchronous status\nexports.name = \&quot;commands\&quot;;\nexports.platforms = [\&quot;node\&quot;];\nexports.after = [\&quot;story\&quot;];\nexports.synchronous = false;\n\nexports.startup = function(callback) {\n\t// On the server, start a commander with the command line arguments\n\tvar commander = new $tw.Commander(\n\t\t$tw.boot.argv,\n\t\tfunction(err) {\n\t\t\tif(err) {\n\t\t\t\treturn $tw.utils.error(\&quot;Error: \&quot; + err);\n\t\t\t}\n\t\t\tcallback();\n\t\t},\n\t\t$tw.wiki,\n\t\t{output: process.stdout, error: process.stderr}\n\t);\n\tcommander.execute();\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/startup/commands.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;startup&quot;
        },
        &quot;$:/core/modules/startup/favicon.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/startup/favicon.js\ntype: application/javascript\nmodule-type: startup\n\nFavicon handling\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Export name and synchronous status\nexports.name = \&quot;favicon\&quot;;\nexports.platforms = [\&quot;browser\&quot;];\nexports.after = [\&quot;startup\&quot;];\nexports.synchronous = true;\n\t\t\n// Favicon tiddler\nvar FAVICON_TITLE = \&quot;$:/favicon.ico\&quot;;\n\nexports.startup = function() {\n\t// Set up the favicon\n\tsetFavicon();\n\t// Reset the favicon when the tiddler changes\n\t$tw.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\tif($tw.utils.hop(changes,FAVICON_TITLE)) {\n\t\t\tsetFavicon();\n\t\t}\n\t});\n};\n\nfunction setFavicon() {\n\tvar tiddler = $tw.wiki.getTiddler(FAVICON_TITLE);\n\tif(tiddler) {\n\t\tvar faviconLink = document.getElementById(\&quot;faviconLink\&quot;);\n\t\tfaviconLink.setAttribute(\&quot;href\&quot;,\&quot;data:\&quot; + tiddler.fields.type + \&quot;;base64,\&quot; + tiddler.fields.text);\n\t}\n}\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/startup/favicon.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;startup&quot;
        },
        &quot;$:/core/modules/startup/info.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/startup/info.js\ntype: application/javascript\nmodule-type: startup\n\nInitialise $:/info tiddlers via $:/temp/info-plugin pseudo-plugin\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Export name and synchronous status\nexports.name = \&quot;info\&quot;;\nexports.before = [\&quot;startup\&quot;];\nexports.after = [\&quot;load-modules\&quot;];\nexports.synchronous = true;\n\nexports.startup = function() {\n\t// Collect up the info tiddlers\n\tvar infoTiddlerFields = {};\n\t// Give each info module a chance to fill in as many info tiddlers as they want\n\t$tw.modules.forEachModuleOfType(\&quot;info\&quot;,function(title,moduleExports) {\n\t\tif(moduleExports &amp;&amp; moduleExports.getInfoTiddlerFields) {\n\t\t\tvar tiddlerFieldsArray = moduleExports.getInfoTiddlerFields(infoTiddlerFields);\n\t\t\t$tw.utils.each(tiddlerFieldsArray,function(fields) {\n\t\t\t\tif(fields) {\n\t\t\t\t\tinfoTiddlerFields[fields.title] = fields;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\t// Bake the info tiddlers into a plugin\n\tvar fields = {\n\t\ttitle: \&quot;$:/temp/info-plugin\&quot;,\n\t\ttype: \&quot;application/json\&quot;,\n\t\t\&quot;plugin-type\&quot;: \&quot;info\&quot;,\n\t\ttext: JSON.stringify({tiddlers: infoTiddlerFields},null,$tw.config.preferences.jsonSpaces)\n\t};\n\t$tw.wiki.addTiddler(new $tw.Tiddler(fields));\n\t$tw.wiki.readPluginInfo();\n\t$tw.wiki.registerPluginTiddlers(\&quot;info\&quot;);\n\t$tw.wiki.unpackPluginTiddlers();\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/startup/info.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;startup&quot;
        },
        &quot;$:/core/modules/startup/load-modules.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/startup/load-modules.js\ntype: application/javascript\nmodule-type: startup\n\nLoad core modules\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Export name and synchronous status\nexports.name = \&quot;load-modules\&quot;;\nexports.synchronous = true;\n\nexports.startup = function() {\n\t// Load modules\n\t$tw.modules.applyMethods(\&quot;utils\&quot;,$tw.utils);\n\tif($tw.node) {\n\t\t$tw.modules.applyMethods(\&quot;utils-node\&quot;,$tw.utils);\n\t}\n\t$tw.modules.applyMethods(\&quot;global\&quot;,$tw);\n\t$tw.modules.applyMethods(\&quot;config\&quot;,$tw.config);\n\t$tw.Tiddler.fieldModules = $tw.modules.getModulesByTypeAsHashmap(\&quot;tiddlerfield\&quot;);\n\t$tw.modules.applyMethods(\&quot;tiddlermethod\&quot;,$tw.Tiddler.prototype);\n\t$tw.modules.applyMethods(\&quot;wikimethod\&quot;,$tw.Wiki.prototype);\n\t$tw.modules.applyMethods(\&quot;tiddlerdeserializer\&quot;,$tw.Wiki.tiddlerDeserializerModules);\n\t$tw.macros = $tw.modules.getModulesByTypeAsHashmap(\&quot;macro\&quot;);\n\t$tw.wiki.initParsers();\n\t$tw.Commander.initCommands();\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/startup/load-modules.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;startup&quot;
        },
        &quot;$:/core/modules/startup/password.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/startup/password.js\ntype: application/javascript\nmodule-type: startup\n\nPassword handling\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Export name and synchronous status\nexports.name = \&quot;password\&quot;;\nexports.platforms = [\&quot;browser\&quot;];\nexports.after = [\&quot;startup\&quot;];\nexports.synchronous = true;\n\nexports.startup = function() {\n\t$tw.rootWidget.addEventListener(\&quot;tm-set-password\&quot;,function(event) {\n\t\t$tw.passwordPrompt.createPrompt({\n\t\t\tserviceName: $tw.language.getString(\&quot;Encryption/PromptSetPassword\&quot;),\n\t\t\tnoUserName: true,\n\t\t\tsubmitText: \&quot;Set password\&quot;,\n\t\t\tcanCancel: true,\n\t\t\trepeatPassword: true,\n\t\t\tcallback: function(data) {\n\t\t\t\tif(data) {\n\t\t\t\t\t$tw.crypto.setPassword(data.password);\n\t\t\t\t}\n\t\t\t\treturn true; // Get rid of the password prompt\n\t\t\t}\n\t\t});\n\t});\n\t$tw.rootWidget.addEventListener(\&quot;tm-clear-password\&quot;,function(event) {\n\t\tif($tw.browser) {\n\t\t\tif(!confirm($tw.language.getString(\&quot;Encryption/ConfirmClearPassword\&quot;))) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t$tw.crypto.setPassword(null);\n\t});\n\t// Ensure that $:/isEncrypted is maintained properly\n\t$tw.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\tif($tw.utils.hop(changes,\&quot;$:/isEncrypted\&quot;)) {\n\t\t\t$tw.crypto.updateCryptoStateTiddler();\n\t\t}\n\t});\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/startup/password.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;startup&quot;
        },
        &quot;$:/core/modules/startup/render.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/startup/render.js\ntype: application/javascript\nmodule-type: startup\n\nTitle, stylesheet and page rendering\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Export name and synchronous status\nexports.name = \&quot;render\&quot;;\nexports.platforms = [\&quot;browser\&quot;];\nexports.after = [\&quot;story\&quot;];\nexports.synchronous = true;\n\n// Default story and history lists\nvar PAGE_TITLE_TITLE = \&quot;$:/core/wiki/title\&quot;;\nvar PAGE_STYLESHEET_TITLE = \&quot;$:/core/ui/PageStylesheet\&quot;;\nvar PAGE_TEMPLATE_TITLE = \&quot;$:/core/ui/PageTemplate\&quot;;\n\n// Time (in ms) that we defer refreshing changes to draft tiddlers\nvar DRAFT_TIDDLER_TIMEOUT = 400;\n\nexports.startup = function() {\n\t// Set up the title\n\t$tw.titleWidgetNode = $tw.wiki.makeTranscludeWidget(PAGE_TITLE_TITLE,{document: $tw.fakeDocument, parseAsInline: true});\n\t$tw.titleContainer = $tw.fakeDocument.createElement(\&quot;div\&quot;);\n\t$tw.titleWidgetNode.render($tw.titleContainer,null);\n\tdocument.title = $tw.titleContainer.textContent;\n\t$tw.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\tif($tw.titleWidgetNode.refresh(changes,$tw.titleContainer,null)) {\n\t\t\tdocument.title = $tw.titleContainer.textContent;\n\t\t}\n\t});\n\t// Set up the styles\n\t$tw.styleWidgetNode = $tw.wiki.makeTranscludeWidget(PAGE_STYLESHEET_TITLE,{document: $tw.fakeDocument});\n\t$tw.styleContainer = $tw.fakeDocument.createElement(\&quot;style\&quot;);\n\t$tw.styleWidgetNode.render($tw.styleContainer,null);\n\t$tw.styleElement = document.createElement(\&quot;style\&quot;);\n\t$tw.styleElement.innerHTML = $tw.styleContainer.textContent;\n\tdocument.head.insertBefore($tw.styleElement,document.head.firstChild);\n\t$tw.wiki.addEventListener(\&quot;change\&quot;,$tw.perf.report(\&quot;styleRefresh\&quot;,function(changes) {\n\t\tif($tw.styleWidgetNode.refresh(changes,$tw.styleContainer,null)) {\n\t\t\t$tw.styleElement.innerHTML = $tw.styleContainer.textContent;\n\t\t}\n\t}));\n\t// Display the $:/core/ui/PageTemplate tiddler to kick off the display\n\t$tw.perf.report(\&quot;mainRender\&quot;,function() {\n\t\t$tw.pageWidgetNode = $tw.wiki.makeTranscludeWidget(PAGE_TEMPLATE_TITLE,{document: document, parentWidget: $tw.rootWidget});\n\t\t$tw.pageContainer = document.createElement(\&quot;div\&quot;);\n\t\t$tw.utils.addClass($tw.pageContainer,\&quot;tc-page-container-wrapper\&quot;);\n\t\tdocument.body.insertBefore($tw.pageContainer,document.body.firstChild);\n\t\t$tw.pageWidgetNode.render($tw.pageContainer,null);\n\t})();\n\t// Prepare refresh mechanism\n\tvar deferredChanges = Object.create(null),\n\t\ttimerId;\n\tfunction refresh() {\n\t\t// Process the refresh\n\t\t$tw.pageWidgetNode.refresh(deferredChanges,$tw.pageContainer,null);\n\t\tdeferredChanges = Object.create(null);\n\t}\n\t// Add the change event handler\n\t$tw.wiki.addEventListener(\&quot;change\&quot;,$tw.perf.report(\&quot;mainRefresh\&quot;,function(changes) {\n\t\t// Check if only drafts have changed\n\t\tvar onlyDraftsHaveChanged = true;\n\t\tfor(var title in changes) {\n\t\t\tvar tiddler = $tw.wiki.getTiddler(title);\n\t\t\tif(!tiddler || !tiddler.hasField(\&quot;draft.of\&quot;)) {\n\t\t\t\tonlyDraftsHaveChanged = false;\n\t\t\t}\n\t\t}\n\t\t// Defer the change if only drafts have changed\n\t\tif(timerId) {\n\t\t\tclearTimeout(timerId);\n\t\t}\n\t\ttimerId = null;\n\t\tif(onlyDraftsHaveChanged) {\n\t\t\ttimerId = setTimeout(refresh,DRAFT_TIDDLER_TIMEOUT);\n\t\t\t$tw.utils.extend(deferredChanges,changes);\n\t\t} else {\n\t\t\t$tw.utils.extend(deferredChanges,changes);\n\t\t\trefresh();\n\t\t}\n\t}));\n\t// Fix up the link between the root widget and the page container\n\t$tw.rootWidget.domNodes = [$tw.pageContainer];\n\t$tw.rootWidget.children = [$tw.pageWidgetNode];\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/startup/render.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;startup&quot;
        },
        &quot;$:/core/modules/startup/rootwidget.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/startup/rootwidget.js\ntype: application/javascript\nmodule-type: startup\n\nSetup the root widget and the core root widget handlers\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Export name and synchronous status\nexports.name = \&quot;rootwidget\&quot;;\nexports.platforms = [\&quot;browser\&quot;];\nexports.after = [\&quot;startup\&quot;];\nexports.before = [\&quot;story\&quot;];\nexports.synchronous = true;\n\nexports.startup = function() {\n\t// Install the modal message mechanism\n\t$tw.modal = new $tw.utils.Modal($tw.wiki);\n\t$tw.rootWidget.addEventListener(\&quot;tm-modal\&quot;,function(event) {\n\t\t$tw.modal.display(event.param,{variables: event.paramObject});\n\t});\n\t// Install the notification  mechanism\n\t$tw.notifier = new $tw.utils.Notifier($tw.wiki);\n\t$tw.rootWidget.addEventListener(\&quot;tm-notify\&quot;,function(event) {\n\t\t$tw.notifier.display(event.param);\n\t});\n\t// Install the scroller\n\t$tw.pageScroller = new $tw.utils.PageScroller();\n\t$tw.rootWidget.addEventListener(\&quot;tm-scroll\&quot;,function(event) {\n\t\t$tw.pageScroller.handleEvent(event);\n\t});\n\tvar fullscreen = $tw.utils.getFullScreenApis();\n\tif(fullscreen) {\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-full-screen\&quot;,function(event) {\n\t\t\tif(document[fullscreen._fullscreenElement]) {\n\t\t\t\tdocument[fullscreen._exitFullscreen]();\n\t\t\t} else {\n\t\t\t\tdocument.documentElement[fullscreen._requestFullscreen](Element.ALLOW_KEYBOARD_INPUT);\n\t\t\t}\n\t\t});\n\t}\n\t// If we're being viewed on a data: URI then give instructions for how to save\n\tif(document.location.protocol === \&quot;data:\&quot;) {\n\t\t$tw.rootWidget.dispatchEvent({\n\t\t\ttype: \&quot;tm-modal\&quot;,\n\t\t\tparam: \&quot;$:/language/Modals/SaveInstructions\&quot;\n\t\t});\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/startup/rootwidget.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;startup&quot;
        },
        &quot;$:/core/modules/startup.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/startup.js\ntype: application/javascript\nmodule-type: startup\n\nMiscellaneous startup logic for both the client and server.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Export name and synchronous status\nexports.name = \&quot;startup\&quot;;\nexports.after = [\&quot;load-modules\&quot;];\nexports.synchronous = true;\n\n// Set to `true` to enable performance instrumentation\nvar PERFORMANCE_INSTRUMENTATION = false;\n\nvar widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;);\n\nexports.startup = function() {\n\tvar modules,n,m,f;\n\tif($tw.browser) {\n\t\t$tw.browser.isIE = (/msie|trident/i.test(navigator.userAgent));\n\t}\n\t$tw.version = $tw.utils.extractVersionInfo();\n\t// Set up the performance framework\n\t$tw.perf = new $tw.Performance(PERFORMANCE_INSTRUMENTATION);\n\t// Kick off the language manager and switcher\n\t$tw.language = new $tw.Language();\n\t$tw.languageSwitcher = new $tw.PluginSwitcher({\n\t\twiki: $tw.wiki,\n\t\tpluginType: \&quot;language\&quot;,\n\t\tcontrollerTitle: \&quot;$:/language\&quot;,\n\t\tdefaultPlugins: [\n\t\t\t\&quot;$:/languages/en-US\&quot;\n\t\t]\n\t});\n\t// Kick off the theme manager\n\t$tw.themeManager = new $tw.PluginSwitcher({\n\t\twiki: $tw.wiki,\n\t\tpluginType: \&quot;theme\&quot;,\n\t\tcontrollerTitle: \&quot;$:/theme\&quot;,\n\t\tdefaultPlugins: [\n\t\t\t\&quot;$:/themes/tiddlywiki/snowwhite\&quot;,\n\t\t\t\&quot;$:/themes/tiddlywiki/vanilla\&quot;\n\t\t]\n\t});\n\t// Clear outstanding tiddler store change events to avoid an unnecessary refresh cycle at startup\n\t$tw.wiki.clearTiddlerEventQueue();\n\t// Create a root widget for attaching event handlers. By using it as the parentWidget for another widget tree, one can reuse the event handlers\n\tif($tw.browser) {\n\t\t$tw.rootWidget = new widget.widget({\n\t\t\ttype: \&quot;widget\&quot;,\n\t\t\tchildren: []\n\t\t},{\n\t\t\twiki: $tw.wiki,\n\t\t\tdocument: document\n\t\t});\n\t}\n\t// Find a working syncadaptor\n\t$tw.syncadaptor = undefined;\n\t$tw.modules.forEachModuleOfType(\&quot;syncadaptor\&quot;,function(title,module) {\n\t\tif(!$tw.syncadaptor &amp;&amp; module.adaptorClass) {\n\t\t\t$tw.syncadaptor = new module.adaptorClass({wiki: $tw.wiki});\n\t\t}\n\t});\n\t// Set up the syncer object if we've got a syncadaptor\n\tif($tw.syncadaptor) {\n\t\t$tw.syncer = new $tw.Syncer({wiki: $tw.wiki, syncadaptor: $tw.syncadaptor});\n\t} \n\t// Setup the saver handler\n\t$tw.saverHandler = new $tw.SaverHandler({wiki: $tw.wiki, dirtyTracking: !$tw.syncadaptor});\n\t// Host-specific startup\n\tif($tw.browser) {\n\t\t// Install the popup manager\n\t\t$tw.popup = new $tw.utils.Popup();\n\t\t// Install the animator\n\t\t$tw.anim = new $tw.utils.Animator();\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/startup.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;startup&quot;
        },
        &quot;$:/core/modules/startup/story.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/startup/story.js\ntype: application/javascript\nmodule-type: startup\n\nLoad core modules\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Export name and synchronous status\nexports.name = \&quot;story\&quot;;\nexports.after = [\&quot;startup\&quot;];\nexports.synchronous = true;\n\n// Default story and history lists\nvar DEFAULT_STORY_TITLE = \&quot;$:/StoryList\&quot;;\nvar DEFAULT_HISTORY_TITLE = \&quot;$:/HistoryList\&quot;;\n\n// Default tiddlers\nvar DEFAULT_TIDDLERS_TITLE = \&quot;$:/DefaultTiddlers\&quot;;\n\n// Config\nvar CONFIG_UPDATE_ADDRESS_BAR = \&quot;$:/config/Navigation/UpdateAddressBar\&quot;; // Can be \&quot;no\&quot;, \&quot;permalink\&quot;, \&quot;permaview\&quot;\nvar CONFIG_UPDATE_HISTORY = \&quot;$:/config/Navigation/UpdateHistory\&quot;; // Can be \&quot;yes\&quot; or \&quot;no\&quot;\n\nexports.startup = function() {\n\t// Open startup tiddlers\n\topenStartupTiddlers();\n\tif($tw.browser) {\n\t\t// Set up location hash update\n\t\t$tw.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\t\tif($tw.utils.hop(changes,DEFAULT_STORY_TITLE) || $tw.utils.hop(changes,DEFAULT_HISTORY_TITLE)) {\n\t\t\t\tupdateLocationHash({\n\t\t\t\t\tupdateAddressBar: $tw.wiki.getTiddlerText(CONFIG_UPDATE_ADDRESS_BAR,\&quot;permaview\&quot;).trim(),\n\t\t\t\t\tupdateHistory: $tw.wiki.getTiddlerText(CONFIG_UPDATE_HISTORY,\&quot;no\&quot;).trim()\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t// Listen for changes to the browser location hash\n\t\twindow.addEventListener(\&quot;hashchange\&quot;,function() {\n\t\t\tvar hash = $tw.utils.getLocationHash();\n\t\t\tif(hash !== $tw.locationHash) {\n\t\t\t\t$tw.locationHash = hash;\n\t\t\t\topenStartupTiddlers({defaultToCurrentStory: true});\n\t\t\t}\n\t\t},false);\n\t\t// Listen for the tm-browser-refresh message\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-browser-refresh\&quot;,function(event) {\n\t\t\twindow.location.reload(true);\n\t\t});\n\t\t// Listen for the tm-home message\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-home\&quot;,function(event) {\n\t\t\twindow.location.hash = \&quot;\&quot;;\n\t\t\tvar storyFilter = $tw.wiki.getTiddlerText(DEFAULT_TIDDLERS_TITLE),\n\t\t\t\tstoryList = $tw.wiki.filterTiddlers(storyFilter);\n\t\t\t//invoke any hooks that might change the default story list\n\t\t\tstoryList = $tw.hooks.invokeHook(\&quot;th-opening-default-tiddlers-list\&quot;,storyList);\n\t\t\t$tw.wiki.addTiddler({title: DEFAULT_STORY_TITLE, text: \&quot;\&quot;, list: storyList},$tw.wiki.getModificationFields());\n\t\t\tif(storyList[0]) {\n\t\t\t\t$tw.wiki.addToHistory(storyList[0]);\t\t\t\t\n\t\t\t}\n\t\t});\n\t\t// Listen for the tm-permalink message\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-permalink\&quot;,function(event) {\n\t\t\tupdateLocationHash({\n\t\t\t\tupdateAddressBar: \&quot;permalink\&quot;,\n\t\t\t\tupdateHistory: $tw.wiki.getTiddlerText(CONFIG_UPDATE_HISTORY,\&quot;no\&quot;).trim(),\n\t\t\t\ttargetTiddler: event.param || event.tiddlerTitle\n\t\t\t});\n\t\t});\n\t\t// Listen for the tm-permaview message\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-permaview\&quot;,function(event) {\n\t\t\tupdateLocationHash({\n\t\t\t\tupdateAddressBar: \&quot;permaview\&quot;,\n\t\t\t\tupdateHistory: $tw.wiki.getTiddlerText(CONFIG_UPDATE_HISTORY,\&quot;no\&quot;).trim(),\n\t\t\t\ttargetTiddler: event.param || event.tiddlerTitle\n\t\t\t});\n\t\t});\n\t}\n};\n\n/*\nProcess the location hash to open the specified tiddlers. Options:\ndefaultToCurrentStory: If true, the current story is retained as the default, instead of opening the default tiddlers\n*/\nfunction openStartupTiddlers(options) {\n\toptions = options || {};\n\t// Work out the target tiddler and the story filter. \&quot;null\&quot; means \&quot;unspecified\&quot;\n\tvar target = null,\n\t\tstoryFilter = null;\n\tif($tw.locationHash.length &gt; 1) {\n\t\tvar hash = $tw.locationHash.substr(1),\n\t\t\tsplit = hash.indexOf(\&quot;:\&quot;);\n\t\tif(split === -1) {\n\t\t\ttarget = decodeURIComponent(hash.trim());\n\t\t} else {\n\t\t\ttarget = decodeURIComponent(hash.substr(0,split).trim());\n\t\t\tstoryFilter = decodeURIComponent(hash.substr(split + 1).trim());\n\t\t}\n\t}\n\t// If the story wasn't specified use the current tiddlers or a blank story\n\tif(storyFilter === null) {\n\t\tif(options.defaultToCurrentStory) {\n\t\t\tvar currStoryList = $tw.wiki.getTiddlerList(DEFAULT_STORY_TITLE);\n\t\t\tstoryFilter = $tw.utils.stringifyList(currStoryList);\n\t\t} else {\n\t\t\tif(target &amp;&amp; target !== \&quot;\&quot;) {\n\t\t\t\tstoryFilter = \&quot;\&quot;;\n\t\t\t} else {\n\t\t\t\tstoryFilter = $tw.wiki.getTiddlerText(DEFAULT_TIDDLERS_TITLE);\n\t\t\t}\n\t\t}\n\t}\n\t// Process the story filter to get the story list\n\tvar storyList = $tw.wiki.filterTiddlers(storyFilter);\n\t//invoke any hooks that might change the default story list\n\tstoryList = $tw.hooks.invokeHook(\&quot;th-opening-default-tiddlers-list\&quot;,storyList);\n\t// If the target tiddler isn't included then splice it in at the top\n\tif(target &amp;&amp; storyList.indexOf(target) === -1) {\n\t\tstoryList.unshift(target);\n\t}\n\t// Save the story list\n\t$tw.wiki.addTiddler({title: DEFAULT_STORY_TITLE, text: \&quot;\&quot;, list: storyList},$tw.wiki.getModificationFields());\n\t// If a target tiddler was specified add it to the history stack\n\tif(target &amp;&amp; target !== \&quot;\&quot;) {\n\t\t// The target tiddler doesn't need double square brackets, but we'll silently remove them if they're present\n\t\tif(target.indexOf(\&quot;[[\&quot;) === 0 &amp;&amp; target.substr(-2) === \&quot;]]\&quot;) {\n\t\t\ttarget = target.substr(2,target.length - 4);\n\t\t}\n\t\t$tw.wiki.addToHistory(target);\n\t} else if(storyList.length &gt; 0) {\n\t\t$tw.wiki.addToHistory(storyList[0]);\n\t}\n}\n\n/*\noptions: See below\noptions.updateAddressBar: \&quot;permalink\&quot;, \&quot;permaview\&quot; or \&quot;no\&quot; (defaults to \&quot;permaview\&quot;)\noptions.updateHistory: \&quot;yes\&quot; or \&quot;no\&quot; (defaults to \&quot;no\&quot;)\noptions.targetTiddler: optional title of target tiddler for permalink\n*/\nfunction updateLocationHash(options) {\n\tif(options.updateAddressBar !== \&quot;no\&quot;) {\n\t\t// Get the story and the history stack\n\t\tvar storyList = $tw.wiki.getTiddlerList(DEFAULT_STORY_TITLE),\n\t\t\thistoryList = $tw.wiki.getTiddlerData(DEFAULT_HISTORY_TITLE,[]),\n\t\t\ttargetTiddler = \&quot;\&quot;;\n\t\tif(options.targetTiddler) {\n\t\t\ttargetTiddler = options.targetTiddler;\n\t\t} else {\n\t\t\t// The target tiddler is the one at the top of the stack\n\t\t\tif(historyList.length &gt; 0) {\n\t\t\t\ttargetTiddler = historyList[historyList.length-1].title;\n\t\t\t}\n\t\t\t// Blank the target tiddler if it isn't present in the story\n\t\t\tif(storyList.indexOf(targetTiddler) === -1) {\n\t\t\t\ttargetTiddler = \&quot;\&quot;;\n\t\t\t}\n\t\t}\n\t\t// Assemble the location hash\n\t\tif(options.updateAddressBar === \&quot;permalink\&quot;) {\n\t\t\t$tw.locationHash = \&quot;#\&quot; + encodeURIComponent(targetTiddler);\n\t\t} else {\n\t\t\t$tw.locationHash = \&quot;#\&quot; + encodeURIComponent(targetTiddler) + \&quot;:\&quot; + encodeURIComponent($tw.utils.stringifyList(storyList));\n\t\t}\n\t\t// Only change the location hash if we must, thus avoiding unnecessary onhashchange events\n\t\tif($tw.utils.getLocationHash() !== $tw.locationHash) {\n\t\t\tif(options.updateHistory === \&quot;yes\&quot;) {\n\t\t\t\t// Assign the location hash so that history is updated\n\t\t\t\twindow.location.hash = $tw.locationHash;\n\t\t\t} else {\n\t\t\t\t// We use replace so that browser history isn't affected\n\t\t\t\twindow.location.replace(window.location.toString().split(\&quot;#\&quot;)[0] + $tw.locationHash);\n\t\t\t}\n\t\t}\n\t}\n}\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/startup/story.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;startup&quot;
        },
        &quot;$:/core/modules/storyviews/classic.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/storyviews/classic.js\ntype: application/javascript\nmodule-type: storyview\n\nViews the story as a linear sequence\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar easing = \&quot;cubic-bezier(0.645, 0.045, 0.355, 1)\&quot;; // From http://easings.net/#easeInOutCubic\n\nvar ClassicStoryView = function(listWidget) {\n\tthis.listWidget = listWidget;\n};\n\nClassicStoryView.prototype.navigateTo = function(historyInfo) {\n\tvar listElementIndex = this.listWidget.findListItem(0,historyInfo.title);\n\tif(listElementIndex === undefined) {\n\t\treturn;\n\t}\n\tvar listItemWidget = this.listWidget.children[listElementIndex],\n\t\ttargetElement = listItemWidget.findFirstDomNode();\n\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\tif(!(targetElement instanceof Element)) {\n\t\treturn;\n\t}\n\t// Scroll the node into view\n\tthis.listWidget.dispatchEvent({type: \&quot;tm-scroll\&quot;, target: targetElement});\n};\n\nClassicStoryView.prototype.insert = function(widget) {\n\tvar targetElement = widget.findFirstDomNode(),\n\t\tduration = $tw.utils.getAnimationDuration();\n\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\tif(!(targetElement instanceof Element)) {\n\t\treturn;\n\t}\n\t// Get the current height of the tiddler\n\tvar computedStyle = window.getComputedStyle(targetElement),\n\t\tcurrMarginBottom = parseInt(computedStyle.marginBottom,10),\n\t\tcurrMarginTop = parseInt(computedStyle.marginTop,10),\n\t\tcurrHeight = targetElement.offsetHeight + currMarginTop;\n\t// Reset the margin once the transition is over\n\tsetTimeout(function() {\n\t\t$tw.utils.setStyle(targetElement,[\n\t\t\t{transition: \&quot;none\&quot;},\n\t\t\t{marginBottom: \&quot;\&quot;}\n\t\t]);\n\t},duration);\n\t// Set up the initial position of the element\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transition: \&quot;none\&quot;},\n\t\t{marginBottom: (-currHeight) + \&quot;px\&quot;},\n\t\t{opacity: \&quot;0.0\&quot;}\n\t]);\n\t$tw.utils.forceLayout(targetElement);\n\t// Transition to the final position\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transition: \&quot;opacity \&quot; + duration + \&quot;ms \&quot; + easing + \&quot;, \&quot; +\n\t\t\t\t\t\&quot;margin-bottom \&quot; + duration + \&quot;ms \&quot; + easing},\n\t\t{marginBottom: currMarginBottom + \&quot;px\&quot;},\n\t\t{opacity: \&quot;1.0\&quot;}\n\t]);\n};\n\nClassicStoryView.prototype.remove = function(widget) {\n\tvar targetElement = widget.findFirstDomNode(),\n\t\tduration = $tw.utils.getAnimationDuration(),\n\t\tremoveElement = function() {\n\t\t\twidget.removeChildDomNodes();\n\t\t};\n\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\tif(!(targetElement instanceof Element)) {\n\t\tremoveElement();\n\t\treturn;\n\t}\n\t// Get the current height of the tiddler\n\tvar currWidth = targetElement.offsetWidth,\n\t\tcomputedStyle = window.getComputedStyle(targetElement),\n\t\tcurrMarginBottom = parseInt(computedStyle.marginBottom,10),\n\t\tcurrMarginTop = parseInt(computedStyle.marginTop,10),\n\t\tcurrHeight = targetElement.offsetHeight + currMarginTop;\n\t// Remove the dom nodes of the widget at the end of the transition\n\tsetTimeout(removeElement,duration);\n\t// Animate the closure\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transition: \&quot;none\&quot;},\n\t\t{transform: \&quot;translateX(0px)\&quot;},\n\t\t{marginBottom:  currMarginBottom + \&quot;px\&quot;},\n\t\t{opacity: \&quot;1.0\&quot;}\n\t]);\n\t$tw.utils.forceLayout(targetElement);\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transition: $tw.utils.roundTripPropertyName(\&quot;transform\&quot;) + \&quot; \&quot; + duration + \&quot;ms \&quot; + easing + \&quot;, \&quot; +\n\t\t\t\t\t\&quot;opacity \&quot; + duration + \&quot;ms \&quot; + easing + \&quot;, \&quot; +\n\t\t\t\t\t\&quot;margin-bottom \&quot; + duration + \&quot;ms \&quot; + easing},\n\t\t{transform: \&quot;translateX(-\&quot; + currWidth + \&quot;px)\&quot;},\n\t\t{marginBottom: (-currHeight) + \&quot;px\&quot;},\n\t\t{opacity: \&quot;0.0\&quot;}\n\t]);\n};\n\nexports.classic = ClassicStoryView;\n\n})();&quot;,
            &quot;title&quot;: &quot;$:/core/modules/storyviews/classic.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;storyview&quot;
        },
        &quot;$:/core/modules/storyviews/pop.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/storyviews/pop.js\ntype: application/javascript\nmodule-type: storyview\n\nAnimates list insertions and removals\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar PopStoryView = function(listWidget) {\n\tthis.listWidget = listWidget;\n};\n\nPopStoryView.prototype.navigateTo = function(historyInfo) {\n\tvar listElementIndex = this.listWidget.findListItem(0,historyInfo.title);\n\tif(listElementIndex === undefined) {\n\t\treturn;\n\t}\n\tvar listItemWidget = this.listWidget.children[listElementIndex],\n\t\ttargetElement = listItemWidget.findFirstDomNode();\n\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\tif(!(targetElement instanceof Element)) {\n\t\treturn;\n\t}\n\t// Scroll the node into view\n\tthis.listWidget.dispatchEvent({type: \&quot;tm-scroll\&quot;, target: targetElement});\n};\n\nPopStoryView.prototype.insert = function(widget) {\n\tvar targetElement = widget.findFirstDomNode(),\n\t\tduration = $tw.utils.getAnimationDuration();\n\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\tif(!(targetElement instanceof Element)) {\n\t\treturn;\n\t}\n\t// Reset once the transition is over\n\tsetTimeout(function() {\n\t\t$tw.utils.setStyle(targetElement,[\n\t\t\t{transition: \&quot;none\&quot;},\n\t\t\t{transform: \&quot;none\&quot;}\n\t\t]);\n\t},duration);\n\t// Set up the initial position of the element\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transition: \&quot;none\&quot;},\n\t\t{transform: \&quot;scale(2)\&quot;},\n\t\t{opacity: \&quot;0.0\&quot;}\n\t]);\n\t$tw.utils.forceLayout(targetElement);\n\t// Transition to the final position\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transition: $tw.utils.roundTripPropertyName(\&quot;transform\&quot;) + \&quot; \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;opacity \&quot; + duration + \&quot;ms ease-in-out\&quot;},\n\t\t{transform: \&quot;scale(1)\&quot;},\n\t\t{opacity: \&quot;1.0\&quot;}\n\t]);\n};\n\nPopStoryView.prototype.remove = function(widget) {\n\tvar targetElement = widget.findFirstDomNode(),\n\t\tduration = $tw.utils.getAnimationDuration(),\n\t\tremoveElement = function() {\n\t\t\tif(targetElement.parentNode) {\n\t\t\t\twidget.removeChildDomNodes();\n\t\t\t}\n\t\t};\n\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\tif(!(targetElement instanceof Element)) {\n\t\tremoveElement();\n\t\treturn;\n\t}\n\t// Remove the element at the end of the transition\n\tsetTimeout(removeElement,duration);\n\t// Animate the closure\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transition: \&quot;none\&quot;},\n\t\t{transform: \&quot;scale(1)\&quot;},\n\t\t{opacity: \&quot;1.0\&quot;}\n\t]);\n\t$tw.utils.forceLayout(targetElement);\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transition: $tw.utils.roundTripPropertyName(\&quot;transform\&quot;) + \&quot; \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;opacity \&quot; + duration + \&quot;ms ease-in-out\&quot;},\n\t\t{transform: \&quot;scale(0.1)\&quot;},\n\t\t{opacity: \&quot;0.0\&quot;}\n\t]);\n};\n\nexports.pop = PopStoryView;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/storyviews/pop.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;storyview&quot;
        },
        &quot;$:/core/modules/storyviews/zoomin.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/storyviews/zoomin.js\ntype: application/javascript\nmodule-type: storyview\n\nZooms between individual tiddlers\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar easing = \&quot;cubic-bezier(0.645, 0.045, 0.355, 1)\&quot;; // From http://easings.net/#easeInOutCubic\n\nvar ZoominListView = function(listWidget) {\n\tvar self = this;\n\tthis.listWidget = listWidget;\n\t// Get the index of the tiddler that is at the top of the history\n\tvar history = this.listWidget.wiki.getTiddlerData(this.listWidget.historyTitle,[]),\n\t\ttargetTiddler;\n\tif(history.length &gt; 0) {\n\t\ttargetTiddler = history[history.length-1].title;\n\t}\n\t// Make all the tiddlers position absolute, and hide all but the top (or first) one\n\t$tw.utils.each(this.listWidget.children,function(itemWidget,index) {\n\t\tvar domNode = itemWidget.findFirstDomNode();\n\t\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\t\tif(!(domNode instanceof Element)) {\n\t\t\treturn;\n\t\t}\n\t\tif(targetTiddler !== itemWidget.parseTreeNode.itemTitle || (!targetTiddler &amp;&amp; index)) {\n\t\t\tdomNode.style.display = \&quot;none\&quot;;\n\t\t} else {\n\t\t\tself.currentTiddlerDomNode = domNode;\n\t\t}\n\t\t$tw.utils.addClass(domNode,\&quot;tc-storyview-zoomin-tiddler\&quot;);\n\t});\n};\n\nZoominListView.prototype.navigateTo = function(historyInfo) {\n\tvar duration = $tw.utils.getAnimationDuration(),\n\t\tlistElementIndex = this.listWidget.findListItem(0,historyInfo.title);\n\tif(listElementIndex === undefined) {\n\t\treturn;\n\t}\n\tvar listItemWidget = this.listWidget.children[listElementIndex],\n\t\ttargetElement = listItemWidget.findFirstDomNode();\n\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\tif(!(targetElement instanceof Element)) {\n\t\treturn;\n\t}\n\t// Make the new tiddler be position absolute and visible so that we can measure it\n\t$tw.utils.addClass(targetElement,\&quot;tc-storyview-zoomin-tiddler\&quot;);\n\t$tw.utils.setStyle(targetElement,[\n\t\t{display: \&quot;block\&quot;},\n\t\t{transformOrigin: \&quot;0 0\&quot;},\n\t\t{transform: \&quot;translateX(0px) translateY(0px) scale(1)\&quot;},\n\t\t{transition: \&quot;none\&quot;},\n\t\t{opacity: \&quot;0.0\&quot;}\n\t]);\n\t// Get the position of the source node, or use the centre of the window as the source position\n\tvar sourceBounds = historyInfo.fromPageRect || {\n\t\t\tleft: window.innerWidth/2 - 2,\n\t\t\ttop: window.innerHeight/2 - 2,\n\t\t\twidth: window.innerWidth/8,\n\t\t\theight: window.innerHeight/8\n\t\t};\n\t// Try to find the title node in the target tiddler\n\tvar titleDomNode = findTitleDomNode(listItemWidget) || listItemWidget.findFirstDomNode(),\n\t\tzoomBounds = titleDomNode.getBoundingClientRect();\n\t// Compute the transform for the target tiddler to make the title lie over the source rectange\n\tvar targetBounds = targetElement.getBoundingClientRect(),\n\t\tscale = sourceBounds.width / zoomBounds.width,\n\t\tx = sourceBounds.left - targetBounds.left - (zoomBounds.left - targetBounds.left) * scale,\n\t\ty = sourceBounds.top - targetBounds.top - (zoomBounds.top - targetBounds.top) * scale;\n\t// Transform the target tiddler to its starting position\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transform: \&quot;translateX(\&quot; + x + \&quot;px) translateY(\&quot; + y + \&quot;px) scale(\&quot; + scale + \&quot;)\&quot;}\n\t]);\n\t// Force layout\n\t$tw.utils.forceLayout(targetElement);\n\t// Apply the ending transitions with a timeout to ensure that the previously applied transformations are applied first\n\tvar self = this,\n\t\tprevCurrentTiddler = this.currentTiddlerDomNode;\n\tthis.currentTiddlerDomNode = targetElement;\n\t// Transform the target tiddler to its natural size\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transition: $tw.utils.roundTripPropertyName(\&quot;transform\&quot;) + \&quot; \&quot; + duration + \&quot;ms \&quot; + easing + \&quot;, opacity \&quot; + duration + \&quot;ms \&quot; + easing},\n\t\t{opacity: \&quot;1.0\&quot;},\n\t\t{transform: \&quot;translateX(0px) translateY(0px) scale(1)\&quot;},\n\t\t{zIndex: \&quot;500\&quot;},\n\t]);\n\t// Transform the previous tiddler out of the way and then hide it\n\tif(prevCurrentTiddler &amp;&amp; prevCurrentTiddler !== targetElement) {\n\t\tscale = zoomBounds.width / sourceBounds.width;\n\t\tx =  zoomBounds.left - targetBounds.left - (sourceBounds.left - targetBounds.left) * scale;\n\t\ty =  zoomBounds.top - targetBounds.top - (sourceBounds.top - targetBounds.top) * scale;\n\t\t$tw.utils.setStyle(prevCurrentTiddler,[\n\t\t\t{transition: $tw.utils.roundTripPropertyName(\&quot;transform\&quot;) + \&quot; \&quot; + duration + \&quot;ms \&quot; + easing + \&quot;, opacity \&quot; + duration + \&quot;ms \&quot; + easing},\n\t\t\t{opacity: \&quot;0.0\&quot;},\n\t\t\t{transformOrigin: \&quot;0 0\&quot;},\n\t\t\t{transform: \&quot;translateX(\&quot; + x + \&quot;px) translateY(\&quot; + y + \&quot;px) scale(\&quot; + scale + \&quot;)\&quot;},\n\t\t\t{zIndex: \&quot;0\&quot;}\n\t\t]);\n\t\t// Hide the tiddler when the transition has finished\n\t\tsetTimeout(function() {\n\t\t\tif(self.currentTiddlerDomNode !== prevCurrentTiddler) {\n\t\t\t\tprevCurrentTiddler.style.display = \&quot;none\&quot;;\n\t\t\t}\n\t\t},duration);\n\t}\n\t// Scroll the target into view\n//\t$tw.pageScroller.scrollIntoView(targetElement);\n};\n\n/*\nFind the first child DOM node of a widget that has the class \&quot;tc-title\&quot;\n*/\nfunction findTitleDomNode(widget,targetClass) {\n\ttargetClass = targetClass || \&quot;tc-title\&quot;;\n\tvar domNode = widget.findFirstDomNode();\n\tif(domNode &amp;&amp; domNode.querySelector) {\n\t\treturn domNode.querySelector(\&quot;.\&quot; + targetClass);\n\t}\n\treturn null;\n}\n\nZoominListView.prototype.insert = function(widget) {\n\tvar targetElement = widget.findFirstDomNode();\n\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\tif(!(targetElement instanceof Element)) {\n\t\treturn;\n\t}\n\t// Make the newly inserted node position absolute and hidden\n\t$tw.utils.addClass(targetElement,\&quot;tc-storyview-zoomin-tiddler\&quot;);\n\t$tw.utils.setStyle(targetElement,[\n\t\t{display: \&quot;none\&quot;}\n\t]);\n};\n\nZoominListView.prototype.remove = function(widget) {\n\tvar targetElement = widget.findFirstDomNode(),\n\t\tduration = $tw.utils.getAnimationDuration(),\n\t\tremoveElement = function() {\n\t\t\twidget.removeChildDomNodes();\n\t\t};\n\t// Abandon if the list entry isn't a DOM element (it might be a text node)\n\tif(!(targetElement instanceof Element)) {\n\t\tremoveElement();\n\t\treturn;\n\t}\n\t// Set up the tiddler that is being closed\n\t$tw.utils.addClass(targetElement,\&quot;tc-storyview-zoomin-tiddler\&quot;);\n\t$tw.utils.setStyle(targetElement,[\n\t\t{display: \&quot;block\&quot;},\n\t\t{transformOrigin: \&quot;50% 50%\&quot;},\n\t\t{transform: \&quot;translateX(0px) translateY(0px) scale(1)\&quot;},\n\t\t{transition: \&quot;none\&quot;},\n\t\t{zIndex: \&quot;0\&quot;}\n\t]);\n\t// We'll move back to the previous or next element in the story\n\tvar toWidget = widget.previousSibling();\n\tif(!toWidget) {\n\t\ttoWidget = widget.nextSibling();\n\t}\n\tvar toWidgetDomNode = toWidget &amp;&amp; toWidget.findFirstDomNode();\n\t// Set up the tiddler we're moving back in\n\tif(toWidgetDomNode) {\n\t\t$tw.utils.addClass(toWidgetDomNode,\&quot;tc-storyview-zoomin-tiddler\&quot;);\n\t\t$tw.utils.setStyle(toWidgetDomNode,[\n\t\t\t{display: \&quot;block\&quot;},\n\t\t\t{transformOrigin: \&quot;50% 50%\&quot;},\n\t\t\t{transform: \&quot;translateX(0px) translateY(0px) scale(10)\&quot;},\n\t\t\t{transition: $tw.utils.roundTripPropertyName(\&quot;transform\&quot;) + \&quot; \&quot; + duration + \&quot;ms \&quot; + easing + \&quot;, opacity \&quot; + duration + \&quot;ms \&quot; + easing},\n\t\t\t{opacity: \&quot;0\&quot;},\n\t\t\t{zIndex: \&quot;500\&quot;}\n\t\t]);\n\t\tthis.currentTiddlerDomNode = toWidgetDomNode;\n\t}\n\t// Animate them both\n\t// Force layout\n\t$tw.utils.forceLayout(this.listWidget.parentDomNode);\n\t// First, the tiddler we're closing\n\t$tw.utils.setStyle(targetElement,[\n\t\t{transformOrigin: \&quot;50% 50%\&quot;},\n\t\t{transform: \&quot;translateX(0px) translateY(0px) scale(0.1)\&quot;},\n\t\t{transition: $tw.utils.roundTripPropertyName(\&quot;transform\&quot;) + \&quot; \&quot; + duration + \&quot;ms \&quot; + easing + \&quot;, opacity \&quot; + duration + \&quot;ms \&quot; + easing},\n\t\t{opacity: \&quot;0\&quot;},\n\t\t{zIndex: \&quot;0\&quot;}\n\t]);\n\tsetTimeout(removeElement,duration);\n\t// Now the tiddler we're going back to\n\tif(toWidgetDomNode) {\n\t\t$tw.utils.setStyle(toWidgetDomNode,[\n\t\t\t{transform: \&quot;translateX(0px) translateY(0px) scale(1)\&quot;},\n\t\t\t{opacity: \&quot;1\&quot;}\n\t\t]);\n\t}\n\treturn true; // Indicate that we'll delete the DOM node\n};\n\nexports.zoomin = ZoominListView;\n\n})();&quot;,
            &quot;title&quot;: &quot;$:/core/modules/storyviews/zoomin.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;storyview&quot;
        },
        &quot;$:/core/modules/syncer.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/syncer.js\ntype: application/javascript\nmodule-type: global\n\nThe syncer tracks changes to the store. If a syncadaptor is used then individual tiddlers are synchronised through it. If there is no syncadaptor then the entire wiki is saved via saver modules.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nInstantiate the syncer with the following options:\nsyncadaptor: reference to syncadaptor to be used\nwiki: wiki to be synced\n*/\nfunction Syncer(options) {\n\tvar self = this;\n\tthis.wiki = options.wiki;\n\tthis.syncadaptor = options.syncadaptor;\n\t// Make a logger\n\tthis.logger = new $tw.utils.Logger(\&quot;syncer\&quot; + ($tw.browser ? \&quot;-browser\&quot; : \&quot;\&quot;) + ($tw.node ? \&quot;-server\&quot; : \&quot;\&quot;));\n\t// Compile the dirty tiddler filter\n\tthis.filterFn = this.wiki.compileFilter(this.wiki.getTiddlerText(this.titleSyncFilter));\n\t// Record information for known tiddlers\n\tthis.readTiddlerInfo();\n\t// Tasks are {type: \&quot;load\&quot;/\&quot;save\&quot;/\&quot;delete\&quot;, title:, queueTime:, lastModificationTime:}\n\tthis.taskQueue = {}; // Hashmap of tasks yet to be performed\n\tthis.taskInProgress = {}; // Hash of tasks in progress\n\tthis.taskTimerId = null; // Timer for task dispatch\n\tthis.pollTimerId = null; // Timer for polling server\n\t// Listen out for changes to tiddlers\n\tthis.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\tself.syncToServer(changes);\n\t});\n\t// Browser event handlers\n\tif($tw.browser) {\n\t\t// Set up our beforeunload handler\n\t\twindow.addEventListener(\&quot;beforeunload\&quot;,function(event) {\n\t\t\tvar confirmationMessage;\n\t\t\tif(self.isDirty()) {\n\t\t\t\tconfirmationMessage = $tw.language.getString(\&quot;UnsavedChangesWarning\&quot;);\n\t\t\t\tevent.returnValue = confirmationMessage; // Gecko\n\t\t\t}\n\t\t\treturn confirmationMessage;\n\t\t});\n\t\t// Listen out for login/logout/refresh events in the browser\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-login\&quot;,function() {\n\t\t\tself.handleLoginEvent();\n\t\t});\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-logout\&quot;,function() {\n\t\t\tself.handleLogoutEvent();\n\t\t});\n\t\t$tw.rootWidget.addEventListener(\&quot;tm-server-refresh\&quot;,function() {\n\t\t\tself.handleRefreshEvent();\n\t\t});\n\t}\n\t// Listen out for lazyLoad events\n\tthis.wiki.addEventListener(\&quot;lazyLoad\&quot;,function(title) {\n\t\tself.handleLazyLoadEvent(title);\n\t});\n\t// Get the login status\n\tthis.getStatus(function(err,isLoggedIn) {\n\t\t// Do a sync from the server\n\t\tself.syncFromServer();\n\t});\n}\n\n/*\nConstants\n*/\nSyncer.prototype.titleIsLoggedIn = \&quot;$:/status/IsLoggedIn\&quot;;\nSyncer.prototype.titleUserName = \&quot;$:/status/UserName\&quot;;\nSyncer.prototype.titleSyncFilter = \&quot;$:/config/SyncFilter\&quot;;\nSyncer.prototype.titleSavedNotification = \&quot;$:/language/Notifications/Save/Done\&quot;;\nSyncer.prototype.taskTimerInterval = 1 * 1000; // Interval for sync timer\nSyncer.prototype.throttleInterval = 1 * 1000; // Defer saving tiddlers if they've changed in the last 1s...\nSyncer.prototype.fallbackInterval = 10 * 1000; // Unless the task is older than 10s\nSyncer.prototype.pollTimerInterval = 60 * 1000; // Interval for polling for changes from the adaptor\n\n\n/*\nRead (or re-read) the latest tiddler info from the store\n*/\nSyncer.prototype.readTiddlerInfo = function() {\n\t// Hashmap by title of {revision:,changeCount:,adaptorInfo:}\n\tthis.tiddlerInfo = {};\n\t// Record information for known tiddlers\n\tvar self = this,\n\t\ttiddlers = this.filterFn.call(this.wiki);\n\t$tw.utils.each(tiddlers,function(title) {\n\t\tvar tiddler = self.wiki.getTiddler(title);\n\t\tself.tiddlerInfo[title] = {\n\t\t\trevision: tiddler.fields.revision,\n\t\t\tadaptorInfo: self.syncadaptor &amp;&amp; self.syncadaptor.getTiddlerInfo(tiddler),\n\t\t\tchangeCount: self.wiki.getChangeCount(title)\n\t\t};\n\t});\n};\n\n/*\nChecks whether the wiki is dirty (ie the window shouldn't be closed)\n*/\nSyncer.prototype.isDirty = function() {\n\treturn (this.numTasksInQueue() &gt; 0) || (this.numTasksInProgress() &gt; 0);\n};\n\n/*\nUpdate the document body with the class \&quot;tc-dirty\&quot; if the wiki has unsaved/unsynced changes\n*/\nSyncer.prototype.updateDirtyStatus = function() {\n\tif($tw.browser) {\n\t\t$tw.utils.toggleClass(document.body,\&quot;tc-dirty\&quot;,this.isDirty());\n\t}\n};\n\n/*\nSave an incoming tiddler in the store, and updates the associated tiddlerInfo\n*/\nSyncer.prototype.storeTiddler = function(tiddlerFields) {\n\t// Save the tiddler\n\tvar tiddler = new $tw.Tiddler(this.wiki.getTiddler(tiddlerFields.title),tiddlerFields);\n\tthis.wiki.addTiddler(tiddler);\n\t// Save the tiddler revision and changeCount details\n\tthis.tiddlerInfo[tiddlerFields.title] = {\n\t\trevision: tiddlerFields.revision,\n\t\tadaptorInfo: this.syncadaptor.getTiddlerInfo(tiddler),\n\t\tchangeCount: this.wiki.getChangeCount(tiddlerFields.title)\n\t};\n};\n\nSyncer.prototype.getStatus = function(callback) {\n\tvar self = this;\n\t// Check if the adaptor supports getStatus()\n\tif(this.syncadaptor &amp;&amp; this.syncadaptor.getStatus) {\n\t\t// Mark us as not logged in\n\t\tthis.wiki.addTiddler({title: this.titleIsLoggedIn,text: \&quot;no\&quot;});\n\t\t// Get login status\n\t\tthis.syncadaptor.getStatus(function(err,isLoggedIn,username) {\n\t\t\tif(err) {\n\t\t\t\tself.logger.alert(err);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Set the various status tiddlers\n\t\t\tself.wiki.addTiddler({title: self.titleIsLoggedIn,text: isLoggedIn ? \&quot;yes\&quot; : \&quot;no\&quot;});\n\t\t\tif(isLoggedIn) {\n\t\t\t\tself.wiki.addTiddler({title: self.titleUserName,text: username || \&quot;\&quot;});\n\t\t\t} else {\n\t\t\t\tself.wiki.deleteTiddler(self.titleUserName);\n\t\t\t}\n\t\t\t// Invoke the callback\n\t\t\tif(callback) {\n\t\t\t\tcallback(err,isLoggedIn,username);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tcallback(null,true,\&quot;UNAUTHENTICATED\&quot;);\n\t}\n};\n\n/*\nSynchronise from the server by reading the skinny tiddler list and queuing up loads for any tiddlers that we don't already have up to date\n*/\nSyncer.prototype.syncFromServer = function() {\n\tif(this.syncadaptor &amp;&amp; this.syncadaptor.getSkinnyTiddlers) {\n\t\tthis.logger.log(\&quot;Retrieving skinny tiddler list\&quot;);\n\t\tvar self = this;\n\t\tif(this.pollTimerId) {\n\t\t\tclearTimeout(this.pollTimerId);\n\t\t\tthis.pollTimerId = null;\n\t\t}\n\t\tthis.syncadaptor.getSkinnyTiddlers(function(err,tiddlers) {\n\t\t\t// Trigger the next sync\n\t\t\tself.pollTimerId = setTimeout(function() {\n\t\t\t\tself.pollTimerId = null;\n\t\t\t\tself.syncFromServer.call(self);\n\t\t\t},self.pollTimerInterval);\n\t\t\t// Check for errors\n\t\t\tif(err) {\n\t\t\t\tself.logger.alert(\&quot;Error retrieving skinny tiddler list:\&quot;,err);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Process each incoming tiddler\n\t\t\tfor(var t=0; t&lt;tiddlers.length; t++) {\n\t\t\t\t// Get the incoming tiddler fields, and the existing tiddler\n\t\t\t\tvar tiddlerFields = tiddlers[t],\n\t\t\t\t\tincomingRevision = tiddlerFields.revision + \&quot;\&quot;,\n\t\t\t\t\ttiddler = self.wiki.getTiddler(tiddlerFields.title),\n\t\t\t\t\ttiddlerInfo = self.tiddlerInfo[tiddlerFields.title],\n\t\t\t\t\tcurrRevision = tiddlerInfo ? tiddlerInfo.revision : null;\n\t\t\t\t// Ignore the incoming tiddler if it's the same as the revision we've already got\n\t\t\t\tif(currRevision !== incomingRevision) {\n\t\t\t\t\t// Do a full load if we've already got a fat version of the tiddler\n\t\t\t\t\tif(tiddler &amp;&amp; tiddler.fields.text !== undefined) {\n\t\t\t\t\t\t// Do a full load of this tiddler\n\t\t\t\t\t\tself.enqueueSyncTask({\n\t\t\t\t\t\t\ttype: \&quot;load\&quot;,\n\t\t\t\t\t\t\ttitle: tiddlerFields.title\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Load the skinny version of the tiddler\n\t\t\t\t\t\tself.storeTiddler(tiddlerFields);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n\n/*\nSynchronise a set of changes to the server\n*/\nSyncer.prototype.syncToServer = function(changes) {\n\tvar self = this,\n\t\tnow = Date.now(),\n\t\tfilteredChanges = this.filterFn.call(this.wiki,function(callback) {\n\t\t\t$tw.utils.each(changes,function(change,title) {\n\t\t\t\tvar tiddler = self.wiki.getTiddler(title);\n\t\t\t\tcallback(tiddler,title);\n\t\t\t});\n\t\t});\n\t$tw.utils.each(changes,function(change,title,object) {\n\t\t// Process the change if it is a deletion of a tiddler we're already syncing, or is on the filtered change list\n\t\tif((change.deleted &amp;&amp; $tw.utils.hop(self.tiddlerInfo,title)) || filteredChanges.indexOf(title) !== -1) {\n\t\t\t// Queue a task to sync this tiddler\n\t\t\tself.enqueueSyncTask({\n\t\t\t\ttype: change.deleted ? \&quot;delete\&quot; : \&quot;save\&quot;,\n\t\t\t\ttitle: title\n\t\t\t});\n\t\t}\n\t});\n};\n\n/*\nLazily load a skinny tiddler if we can\n*/\nSyncer.prototype.handleLazyLoadEvent = function(title) {\n\t// Queue up a sync task to load this tiddler\n\tthis.enqueueSyncTask({\n\t\ttype: \&quot;load\&quot;,\n\t\ttitle: title\n\t});\n};\n\n/*\nDispay a password prompt and allow the user to login\n*/\nSyncer.prototype.handleLoginEvent = function() {\n\tvar self = this;\n\tthis.getStatus(function(err,isLoggedIn,username) {\n\t\tif(!isLoggedIn) {\n\t\t\t$tw.passwordPrompt.createPrompt({\n\t\t\t\tserviceName: \&quot;Login to TiddlySpace\&quot;,\n\t\t\t\tcallback: function(data) {\n\t\t\t\t\tself.login(data.username,data.password,function(err,isLoggedIn) {\n\t\t\t\t\t\tself.syncFromServer();\n\t\t\t\t\t});\n\t\t\t\t\treturn true; // Get rid of the password prompt\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n};\n\n/*\nAttempt to login to TiddlyWeb.\n\tusername: username\n\tpassword: password\n\tcallback: invoked with arguments (err,isLoggedIn)\n*/\nSyncer.prototype.login = function(username,password,callback) {\n\tthis.logger.log(\&quot;Attempting to login as\&quot;,username);\n\tvar self = this;\n\tif(this.syncadaptor.login) {\n\t\tthis.syncadaptor.login(username,password,function(err) {\n\t\t\tif(err) {\n\t\t\t\treturn callback(err);\n\t\t\t}\n\t\t\tself.getStatus(function(err,isLoggedIn,username) {\n\t\t\t\tif(callback) {\n\t\t\t\t\tcallback(null,isLoggedIn);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t} else {\n\t\tcallback(null,true);\n\t}\n};\n\n/*\nAttempt to log out of TiddlyWeb\n*/\nSyncer.prototype.handleLogoutEvent = function() {\n\tthis.logger.log(\&quot;Attempting to logout\&quot;);\n\tvar self = this;\n\tif(this.syncadaptor.logout) {\n\t\tthis.syncadaptor.logout(function(err) {\n\t\t\tif(err) {\n\t\t\t\tself.logger.alert(err);\n\t\t\t} else {\n\t\t\t\tself.getStatus();\n\t\t\t}\n\t\t});\n\t}\n};\n\n/*\nImmediately refresh from the server\n*/\nSyncer.prototype.handleRefreshEvent = function() {\n\tthis.syncFromServer();\n};\n\n/*\nQueue up a sync task. If there is already a pending task for the tiddler, just update the last modification time\n*/\nSyncer.prototype.enqueueSyncTask = function(task) {\n\tvar self = this,\n\t\tnow = Date.now();\n\t// Set the timestamps on this task\n\ttask.queueTime = now;\n\ttask.lastModificationTime = now;\n\t// Fill in some tiddlerInfo if the tiddler is one we haven't seen before\n\tif(!$tw.utils.hop(this.tiddlerInfo,task.title)) {\n\t\tthis.tiddlerInfo[task.title] = {\n\t\t\trevision: null,\n\t\t\tadaptorInfo: {},\n\t\t\tchangeCount: -1\n\t\t};\n\t}\n\t// Bail if this is a save and the tiddler is already at the changeCount that the server has\n\tif(task.type === \&quot;save\&quot; &amp;&amp; this.wiki.getChangeCount(task.title) &lt;= this.tiddlerInfo[task.title].changeCount) {\n\t\treturn;\n\t}\n\t// Check if this tiddler is already in the queue\n\tif($tw.utils.hop(this.taskQueue,task.title)) {\n\t\t// this.logger.log(\&quot;Re-queueing up sync task with type:\&quot;,task.type,\&quot;title:\&quot;,task.title);\n\t\tvar existingTask = this.taskQueue[task.title];\n\t\t// If so, just update the last modification time\n\t\texistingTask.lastModificationTime = task.lastModificationTime;\n\t\t// If the new task is a save then we upgrade the existing task to a save. Thus a pending load is turned into a save if the tiddler changes locally in the meantime. But a pending save is not modified to become a load\n\t\tif(task.type === \&quot;save\&quot; || task.type === \&quot;delete\&quot;) {\n\t\t\texistingTask.type = task.type;\n\t\t}\n\t} else {\n\t\t// this.logger.log(\&quot;Queuing up sync task with type:\&quot;,task.type,\&quot;title:\&quot;,task.title);\n\t\t// If it is not in the queue, insert it\n\t\tthis.taskQueue[task.title] = task;\n\t\tthis.updateDirtyStatus();\n\t}\n\t// Process the queue\n\t$tw.utils.nextTick(function() {self.processTaskQueue.call(self);});\n};\n\n/*\nReturn the number of tasks in progress\n*/\nSyncer.prototype.numTasksInProgress = function() {\n\treturn $tw.utils.count(this.taskInProgress);\n};\n\n/*\nReturn the number of tasks in the queue\n*/\nSyncer.prototype.numTasksInQueue = function() {\n\treturn $tw.utils.count(this.taskQueue);\n};\n\n/*\nTrigger a timeout if one isn't already outstanding\n*/\nSyncer.prototype.triggerTimeout = function() {\n\tvar self = this;\n\tif(!this.taskTimerId) {\n\t\tthis.taskTimerId = setTimeout(function() {\n\t\t\tself.taskTimerId = null;\n\t\t\tself.processTaskQueue.call(self);\n\t\t},self.taskTimerInterval);\n\t}\n};\n\n/*\nProcess the task queue, performing the next task if appropriate\n*/\nSyncer.prototype.processTaskQueue = function() {\n\tvar self = this;\n\t// Only process a task if we're not already performing a task. If we are already performing a task then we'll dispatch the next one when it completes\n\tif(this.numTasksInProgress() === 0) {\n\t\t// Choose the next task to perform\n\t\tvar task = this.chooseNextTask();\n\t\t// Perform the task if we had one\n\t\tif(task) {\n\t\t\t// Remove the task from the queue and add it to the in progress list\n\t\t\tdelete this.taskQueue[task.title];\n\t\t\tthis.taskInProgress[task.title] = task;\n\t\t\tthis.updateDirtyStatus();\n\t\t\t// Dispatch the task\n\t\t\tthis.dispatchTask(task,function(err) {\n\t\t\t\tif(err) {\n\t\t\t\t\tself.logger.alert(\&quot;Sync error while processing '\&quot; + task.title + \&quot;':\\n\&quot; + err);\n\t\t\t\t}\n\t\t\t\t// Mark that this task is no longer in progress\n\t\t\t\tdelete self.taskInProgress[task.title];\n\t\t\t\tself.updateDirtyStatus();\n\t\t\t\t// Process the next task\n\t\t\t\tself.processTaskQueue.call(self);\n\t\t\t});\n\t\t} else {\n\t\t\t// Make sure we've set a time if there wasn't a task to perform, but we've still got tasks in the queue\n\t\t\tif(this.numTasksInQueue() &gt; 0) {\n\t\t\t\tthis.triggerTimeout();\n\t\t\t}\n\t\t}\n\t}\n};\n\n/*\nChoose the next applicable task\n*/\nSyncer.prototype.chooseNextTask = function() {\n\tvar self = this,\n\t\tcandidateTask = null,\n\t\tnow = Date.now();\n\t// Select the best candidate task\n\t$tw.utils.each(this.taskQueue,function(task,title) {\n\t\t// Exclude the task if there's one of the same name in progress\n\t\tif($tw.utils.hop(self.taskInProgress,title)) {\n\t\t\treturn;\n\t\t}\n\t\t// Exclude the task if it is a save and the tiddler has been modified recently, but not hit the fallback time\n\t\tif(task.type === \&quot;save\&quot; &amp;&amp; (now - task.lastModificationTime) &lt; self.throttleInterval &amp;&amp;\n\t\t\t(now - task.queueTime) &lt; self.fallbackInterval) {\n\t\t\treturn;\n\t\t}\n\t\t// Exclude the task if it is newer than the current best candidate\n\t\tif(candidateTask &amp;&amp; candidateTask.queueTime &lt; task.queueTime) {\n\t\t\treturn;\n\t\t}\n\t\t// Now this is our best candidate\n\t\tcandidateTask = task;\n\t});\n\treturn candidateTask;\n};\n\n/*\nDispatch a task and invoke the callback\n*/\nSyncer.prototype.dispatchTask = function(task,callback) {\n\tvar self = this;\n\tif(task.type === \&quot;save\&quot;) {\n\t\tvar changeCount = this.wiki.getChangeCount(task.title),\n\t\t\ttiddler = this.wiki.getTiddler(task.title);\n\t\tthis.logger.log(\&quot;Dispatching 'save' task:\&quot;,task.title);\n\t\tif(tiddler) {\n\t\t\tthis.syncadaptor.saveTiddler(tiddler,function(err,adaptorInfo,revision) {\n\t\t\t\tif(err) {\n\t\t\t\t\treturn callback(err);\n\t\t\t\t}\n\t\t\t\t// Adjust the info stored about this tiddler\n\t\t\t\tself.tiddlerInfo[task.title] = {\n\t\t\t\t\tchangeCount: changeCount,\n\t\t\t\t\tadaptorInfo: adaptorInfo,\n\t\t\t\t\trevision: revision\n\t\t\t\t};\n\t\t\t\t// Invoke the callback\n\t\t\t\tcallback(null);\n\t\t\t},{\n\t\t\t\ttiddlerInfo: self.tiddlerInfo[task.title]\n\t\t\t});\n\t\t} else {\n\t\t\tthis.logger.log(\&quot; Not Dispatching 'save' task:\&quot;,task.title,\&quot;tiddler does not exist\&quot;);\n\t\t\treturn callback(null);\n\t\t}\n\t} else if(task.type === \&quot;load\&quot;) {\n\t\t// Load the tiddler\n\t\tthis.logger.log(\&quot;Dispatching 'load' task:\&quot;,task.title);\n\t\tthis.syncadaptor.loadTiddler(task.title,function(err,tiddlerFields) {\n\t\t\tif(err) {\n\t\t\t\treturn callback(err);\n\t\t\t}\n\t\t\t// Store the tiddler\n\t\t\tif(tiddlerFields) {\n\t\t\t\tself.storeTiddler(tiddlerFields);\n\t\t\t}\n\t\t\t// Invoke the callback\n\t\t\tcallback(null);\n\t\t});\n\t} else if(task.type === \&quot;delete\&quot;) {\n\t\t// Delete the tiddler\n\t\tthis.logger.log(\&quot;Dispatching 'delete' task:\&quot;,task.title);\n\t\tthis.syncadaptor.deleteTiddler(task.title,function(err) {\n\t\t\tif(err) {\n\t\t\t\treturn callback(err);\n\t\t\t}\n\t\t\tdelete self.tiddlerInfo[task.title];\n\t\t\t// Invoke the callback\n\t\t\tcallback(null);\n\t\t},{\n\t\t\ttiddlerInfo: self.tiddlerInfo[task.title]\n\t\t});\n\t}\n};\n\nexports.Syncer = Syncer;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/syncer.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;global&quot;
        },
        &quot;$:/core/modules/tiddler.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/tiddler.js\ntype: application/javascript\nmodule-type: tiddlermethod\n\nExtension methods for the $tw.Tiddler object (constructor and methods required at boot time are in boot/boot.js)\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.hasTag = function(tag) {\n\treturn this.fields.tags &amp;&amp; this.fields.tags.indexOf(tag) !== -1;\n};\n\nexports.isPlugin = function() {\n\treturn this.fields.type === \&quot;application/json\&quot; &amp;&amp; this.hasField(\&quot;plugin-type\&quot;);\n};\n\nexports.isDraft = function() {\n\treturn this.hasField(\&quot;draft.of\&quot;);\n};\n\nexports.getFieldString = function(field) {\n\tvar value = this.fields[field];\n\t// Check for a missing field\n\tif(value === undefined || value === null) {\n\t\treturn \&quot;\&quot;;\n\t}\n\t// Parse the field with the associated module (if any)\n\tvar fieldModule = $tw.Tiddler.fieldModules[field];\n\tif(fieldModule &amp;&amp; fieldModule.stringify) {\n\t\treturn fieldModule.stringify.call(this,value);\n\t} else {\n\t\treturn value.toString();\n\t}\n};\n\n/*\nGet all the fields as a name:value block. Options:\n\texclude: an array of field names to exclude\n*/\nexports.getFieldStringBlock = function(options) {\n\toptions = options || {};\n\tvar exclude = options.exclude || [];\n\tvar fields = [];\n\tfor(var field in this.fields) {\n\t\tif($tw.utils.hop(this.fields,field)) {\n\t\t\tif(exclude.indexOf(field) === -1) {\n\t\t\t\tfields.push(field + \&quot;: \&quot; + this.getFieldString(field));\n\t\t\t}\n\t\t}\n\t}\n\treturn fields.join(\&quot;\\n\&quot;);\n};\n\n/*\nCompare two tiddlers for equality\ntiddler: the tiddler to compare\nexcludeFields: array of field names to exclude from the comparison\n*/\nexports.isEqual = function(tiddler,excludeFields) {\n\tif(!(tiddler instanceof $tw.Tiddler)) {\n\t\treturn false;\n\t}\n\texcludeFields = excludeFields || [];\n\tvar self = this,\n\t\tdifferences = []; // Fields that have differences\n\t// Add to the differences array\n\tfunction addDifference(fieldName) {\n\t\t// Check for this field being excluded\n\t\tif(excludeFields.indexOf(fieldName) === -1) {\n\t\t\t// Save the field as a difference\n\t\t\t$tw.utils.pushTop(differences,fieldName);\n\t\t}\n\t}\n\t// Returns true if the two values of this field are equal\n\tfunction isFieldValueEqual(fieldName) {\n\t\tvar valueA = self.fields[fieldName],\n\t\t\tvalueB = tiddler.fields[fieldName];\n\t\t// Check for identical string values\n\t\tif(typeof(valueA) === \&quot;string\&quot; &amp;&amp; typeof(valueB) === \&quot;string\&quot; &amp;&amp; valueA === valueB) {\n\t\t\treturn true;\n\t\t}\n\t\t// Check for identical array values\n\t\tif($tw.utils.isArray(valueA) &amp;&amp; $tw.utils.isArray(valueB) &amp;&amp; $tw.utils.isArrayEqual(valueA,valueB)) {\n\t\t\treturn true;\n\t\t}\n\t\t// Otherwise the fields must be different\n\t\treturn false;\n\t}\n\t// Compare our fields\n\tfor(var fieldName in this.fields) {\n\t\tif(!isFieldValueEqual(fieldName)) {\n\t\t\taddDifference(fieldName);\n\t\t}\n\t}\n\t// There's a difference for every field in the other tiddler that we don't have\n\tfor(fieldName in tiddler.fields) {\n\t\tif(!(fieldName in this.fields)) {\n\t\t\taddDifference(fieldName);\n\t\t}\n\t}\n\t// Return whether there were any differences\n\treturn differences.length === 0;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/tiddler.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;tiddlermethod&quot;
        },
        &quot;$:/core/modules/upgraders/plugins.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/upgraders/plugins.js\ntype: application/javascript\nmodule-type: upgrader\n\nUpgrader module that checks that plugins are newer than any already installed version\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar UPGRADE_LIBRARY_TITLE = \&quot;$:/UpgradeLibrary\&quot;;\n\nvar BLOCKED_PLUGINS = {\n\t\&quot;$:/plugins/tiddlywiki/fullscreen\&quot;: {\n\t\tversions: [\&quot;*\&quot;]\n\t}\n};\n\nexports.upgrade = function(wiki,titles,tiddlers) {\n\tvar self = this,\n\t\tmessages = {},\n\t\tupgradeLibrary,\n\t\tgetLibraryTiddler = function(title) {\n\t\t\tif(!upgradeLibrary) {\n\t\t\t\tupgradeLibrary = wiki.getTiddlerData(UPGRADE_LIBRARY_TITLE,{});\n\t\t\t\tupgradeLibrary.tiddlers = upgradeLibrary.tiddlers || {};\n\t\t\t}\n\t\t\treturn upgradeLibrary.tiddlers[title];\n\t\t};\n\n\t// Go through all the incoming tiddlers\n\t$tw.utils.each(titles,function(title) {\n\t\tvar incomingTiddler = tiddlers[title];\n\t\t// Check if we're dealing with a plugin\n\t\tif(incomingTiddler &amp;&amp; incomingTiddler[\&quot;plugin-type\&quot;] &amp;&amp; incomingTiddler.version) {\n\t\t\t// Upgrade the incoming plugin if we've got a newer version in the upgrade library\n\t\t\tvar libraryTiddler = getLibraryTiddler(title);\n\t\t\tif(libraryTiddler &amp;&amp; libraryTiddler[\&quot;plugin-type\&quot;] &amp;&amp; libraryTiddler.version) {\n\t\t\t\tif($tw.utils.checkVersions(libraryTiddler.version,incomingTiddler.version)) {\n\t\t\t\t\ttiddlers[title] = libraryTiddler;\n\t\t\t\t\tmessages[title] = $tw.language.getString(\&quot;Import/Upgrader/Plugins/Upgraded\&quot;,{variables: {incoming: incomingTiddler.version, upgraded: libraryTiddler.version}});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Suppress the incoming plugin if it is older than the currently installed one\n\t\t\tvar existingTiddler = wiki.getTiddler(title);\n\t\t\tif(existingTiddler &amp;&amp; existingTiddler.hasField(\&quot;plugin-type\&quot;) &amp;&amp; existingTiddler.hasField(\&quot;version\&quot;)) {\n\t\t\t\t// Reject the incoming plugin by blanking all its fields\n\t\t\t\tif($tw.utils.checkVersions(existingTiddler.fields.version,incomingTiddler.version)) {\n\t\t\t\t\ttiddlers[title] = Object.create(null);\n\t\t\t\t\tmessages[title] = $tw.language.getString(\&quot;Import/Upgrader/Plugins/Suppressed/Version\&quot;,{variables: {incoming: incomingTiddler.version, existing: existingTiddler.fields.version}});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(incomingTiddler &amp;&amp; incomingTiddler[\&quot;plugin-type\&quot;]) {\n\t\t\t// Check whether the plugin is on the blocked list\n\t\t\tvar blockInfo = BLOCKED_PLUGINS[title];\n\t\t\tif(blockInfo) {\n\t\t\t\tif(blockInfo.versions.indexOf(\&quot;*\&quot;) !== -1 || (incomingTiddler.version &amp;&amp; blockInfo.versions.indexOf(incomingTiddler.version) !== -1)) {\n\t\t\t\t\ttiddlers[title] = Object.create(null);\n\t\t\t\t\tmessages[title] = $tw.language.getString(\&quot;Import/Upgrader/Plugins/Suppressed/Incompatible\&quot;);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\treturn messages;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/upgraders/plugins.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;upgrader&quot;
        },
        &quot;$:/core/modules/upgraders/system.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/upgraders/system.js\ntype: application/javascript\nmodule-type: upgrader\n\nUpgrader module that suppresses certain system tiddlers that shouldn't be imported\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar DONT_IMPORT_LIST = [\&quot;$:/StoryList\&quot;,\&quot;$:/HistoryList\&quot;],\n\tDONT_IMPORT_PREFIX_LIST = [\&quot;$:/temp/\&quot;,\&quot;$:/state/\&quot;];\n\nexports.upgrade = function(wiki,titles,tiddlers) {\n\tvar self = this,\n\t\tmessages = {};\n\t// Check for tiddlers on our list\n\t$tw.utils.each(titles,function(title) {\n\t\tif(DONT_IMPORT_LIST.indexOf(title) !== -1) {\n\t\t\ttiddlers[title] = Object.create(null);\n\t\t\tmessages[title] = $tw.language.getString(\&quot;Import/Upgrader/System/Suppressed\&quot;);\n\t\t} else {\n\t\t\tfor(var t=0; t&lt;DONT_IMPORT_PREFIX_LIST.length; t++) {\n\t\t\t\tvar prefix = DONT_IMPORT_PREFIX_LIST[t];\n\t\t\t\tif(title.substr(0,prefix.length) === prefix) {\n\t\t\t\t\ttiddlers[title] = Object.create(null);\n\t\t\t\t\tmessages[title] = $tw.language.getString(\&quot;Import/Upgrader/State/Suppressed\&quot;);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\treturn messages;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/upgraders/system.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;upgrader&quot;
        },
        &quot;$:/core/modules/upgraders/themetweaks.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/upgraders/themetweaks.js\ntype: application/javascript\nmodule-type: upgrader\n\nUpgrader module that handles the change in theme tweak storage introduced in 5.0.14-beta.\n\nPreviously, theme tweaks were stored in two data tiddlers:\n\n* $:/themes/tiddlywiki/vanilla/metrics\n* $:/themes/tiddlywiki/vanilla/settings\n\nNow, each tweak is stored in its own separate tiddler.\n\nThis upgrader copies any values from the old format to the new. The old data tiddlers are not deleted in case they have been used to store additional indexes.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar MAPPINGS = {\n\t\&quot;$:/themes/tiddlywiki/vanilla/metrics\&quot;: {\n\t\t\&quot;fontsize\&quot;: \&quot;$:/themes/tiddlywiki/vanilla/metrics/fontsize\&quot;,\n\t\t\&quot;lineheight\&quot;: \&quot;$:/themes/tiddlywiki/vanilla/metrics/lineheight\&quot;,\n\t\t\&quot;storyleft\&quot;: \&quot;$:/themes/tiddlywiki/vanilla/metrics/storyleft\&quot;,\n\t\t\&quot;storytop\&quot;: \&quot;$:/themes/tiddlywiki/vanilla/metrics/storytop\&quot;,\n\t\t\&quot;storyright\&quot;: \&quot;$:/themes/tiddlywiki/vanilla/metrics/storyright\&quot;,\n\t\t\&quot;storywidth\&quot;: \&quot;$:/themes/tiddlywiki/vanilla/metrics/storywidth\&quot;,\n\t\t\&quot;tiddlerwidth\&quot;: \&quot;$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth\&quot;\n\t},\n\t\&quot;$:/themes/tiddlywiki/vanilla/settings\&quot;: {\n\t\t\&quot;fontfamily\&quot;: \&quot;$:/themes/tiddlywiki/vanilla/settings/fontfamily\&quot;\n\t}\n};\n\nexports.upgrade = function(wiki,titles,tiddlers) {\n\tvar self = this,\n\t\tmessages = {};\n\t// Check for tiddlers on our list\n\t$tw.utils.each(titles,function(title) {\n\t\tvar mapping = MAPPINGS[title];\n\t\tif(mapping) {\n\t\t\tvar tiddler = new $tw.Tiddler(tiddlers[title]),\n\t\t\t\ttiddlerData = wiki.getTiddlerData(tiddler,{});\n\t\t\tfor(var index in mapping) {\n\t\t\t\tvar mappedTitle = mapping[index];\n\t\t\t\tif(!tiddlers[mappedTitle] || tiddlers[mappedTitle].title !== mappedTitle) {\n\t\t\t\t\ttiddlers[mappedTitle] = {\n\t\t\t\t\t\ttitle: mappedTitle,\n\t\t\t\t\t\ttext: tiddlerData[index]\n\t\t\t\t\t};\n\t\t\t\t\tmessages[mappedTitle] = $tw.language.getString(\&quot;Import/Upgrader/ThemeTweaks/Created\&quot;,{variables: {\n\t\t\t\t\t\tfrom: title + \&quot;##\&quot; + index\n\t\t\t\t\t}});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\treturn messages;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/upgraders/themetweaks.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;upgrader&quot;
        },
        &quot;$:/core/modules/utils/crypto.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/crypto.js\ntype: application/javascript\nmodule-type: utils\n\nUtility functions related to crypto.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nLook for an encrypted store area in the text of a TiddlyWiki file\n*/\nexports.extractEncryptedStoreArea = function(text) {\n\tvar encryptedStoreAreaStartMarker = \&quot;&lt;pre id=\\\&quot;encryptedStoreArea\\\&quot; type=\\\&quot;text/plain\\\&quot; style=\\\&quot;display:none;\\\&quot;&gt;\&quot;,\n\t\tencryptedStoreAreaStart = text.indexOf(encryptedStoreAreaStartMarker);\n\tif(encryptedStoreAreaStart !== -1) {\n\t\tvar encryptedStoreAreaEnd = text.indexOf(\&quot;&lt;/pre&gt;\&quot;,encryptedStoreAreaStart);\n\t\tif(encryptedStoreAreaEnd !== -1) {\n\t\t\treturn $tw.utils.htmlDecode(text.substring(encryptedStoreAreaStart + encryptedStoreAreaStartMarker.length,encryptedStoreAreaEnd-1));\n\t\t}\n\t}\n\treturn null;\n};\n\n/*\nAttempt to extract the tiddlers from an encrypted store area using the current password. If the password is not provided then the password in the password store will be used\n*/\nexports.decryptStoreArea = function(encryptedStoreArea,password) {\n\tvar decryptedText = $tw.crypto.decrypt(encryptedStoreArea,password);\n\tif(decryptedText) {\n\t\tvar json = JSON.parse(decryptedText),\n\t\t\ttiddlers = [];\n\t\tfor(var title in json) {\n\t\t\tif(title !== \&quot;$:/isEncrypted\&quot;) {\n\t\t\t\ttiddlers.push(json[title]);\n\t\t\t}\n\t\t}\n\t\treturn tiddlers;\n\t} else {\n\t\treturn null;\n\t}\n};\n\n\n/*\nAttempt to extract the tiddlers from an encrypted store area using the current password. If that fails, the user is prompted for a password.\nencryptedStoreArea: text of the TiddlyWiki encrypted store area\ncallback: function(tiddlers) called with the array of decrypted tiddlers\n\nThe following configuration settings are supported:\n\n$tw.config.usePasswordVault: causes any password entered by the user to also be put into the system password vault\n*/\nexports.decryptStoreAreaInteractive = function(encryptedStoreArea,callback,options) {\n\t// Try to decrypt with the current password\n\tvar tiddlers = $tw.utils.decryptStoreArea(encryptedStoreArea);\n\tif(tiddlers) {\n\t\tcallback(tiddlers);\n\t} else {\n\t\t// Prompt for a new password and keep trying\n\t\t$tw.passwordPrompt.createPrompt({\n\t\t\tserviceName: \&quot;Enter a password to decrypt the imported TiddlyWiki\&quot;,\n\t\t\tnoUserName: true,\n\t\t\tcanCancel: true,\n\t\t\tsubmitText: \&quot;Decrypt\&quot;,\n\t\t\tcallback: function(data) {\n\t\t\t\t// Exit if the user cancelled\n\t\t\t\tif(!data) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// Attempt to decrypt the tiddlers\n\t\t\t\tvar tiddlers = $tw.utils.decryptStoreArea(encryptedStoreArea,data.password);\n\t\t\t\tif(tiddlers) {\n\t\t\t\t\tif($tw.config.usePasswordVault) {\n\t\t\t\t\t\t$tw.crypto.setPassword(data.password);\n\t\t\t\t\t}\n\t\t\t\t\tcallback(tiddlers);\n\t\t\t\t\t// Exit and remove the password prompt\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\t// We didn't decrypt everything, so continue to prompt for password\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/crypto.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom/animations/slide.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom/animations/slide.js\ntype: application/javascript\nmodule-type: animation\n\nA simple slide animation that varies the height of the element\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nfunction slideOpen(domNode,options) {\n\toptions = options || {};\n\tvar duration = options.duration || $tw.utils.getAnimationDuration();\n\t// Get the current height of the domNode\n\tvar computedStyle = window.getComputedStyle(domNode),\n\t\tcurrMarginBottom = parseInt(computedStyle.marginBottom,10),\n\t\tcurrMarginTop = parseInt(computedStyle.marginTop,10),\n\t\tcurrPaddingBottom = parseInt(computedStyle.paddingBottom,10),\n\t\tcurrPaddingTop = parseInt(computedStyle.paddingTop,10),\n\t\tcurrHeight = domNode.offsetHeight;\n\t// Reset the margin once the transition is over\n\tsetTimeout(function() {\n\t\t$tw.utils.setStyle(domNode,[\n\t\t\t{transition: \&quot;none\&quot;},\n\t\t\t{marginBottom: \&quot;\&quot;},\n\t\t\t{marginTop: \&quot;\&quot;},\n\t\t\t{paddingBottom: \&quot;\&quot;},\n\t\t\t{paddingTop: \&quot;\&quot;},\n\t\t\t{height: \&quot;auto\&quot;},\n\t\t\t{opacity: \&quot;\&quot;}\n\t\t]);\n\t\tif(options.callback) {\n\t\t\toptions.callback();\n\t\t}\n\t},duration);\n\t// Set up the initial position of the element\n\t$tw.utils.setStyle(domNode,[\n\t\t{transition: \&quot;none\&quot;},\n\t\t{marginTop: \&quot;0px\&quot;},\n\t\t{marginBottom: \&quot;0px\&quot;},\n\t\t{paddingTop: \&quot;0px\&quot;},\n\t\t{paddingBottom: \&quot;0px\&quot;},\n\t\t{height: \&quot;0px\&quot;},\n\t\t{opacity: \&quot;0\&quot;}\n\t]);\n\t$tw.utils.forceLayout(domNode);\n\t// Transition to the final position\n\t$tw.utils.setStyle(domNode,[\n\t\t{transition: \&quot;margin-top \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;margin-bottom \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;padding-top \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;padding-bottom \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;height \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;opacity \&quot; + duration + \&quot;ms ease-in-out\&quot;},\n\t\t{marginBottom: currMarginBottom + \&quot;px\&quot;},\n\t\t{marginTop: currMarginTop + \&quot;px\&quot;},\n\t\t{paddingBottom: currPaddingBottom + \&quot;px\&quot;},\n\t\t{paddingTop: currPaddingTop + \&quot;px\&quot;},\n\t\t{height: currHeight + \&quot;px\&quot;},\n\t\t{opacity: \&quot;1\&quot;}\n\t]);\n}\n\nfunction slideClosed(domNode,options) {\n\toptions = options || {};\n\tvar duration = options.duration || $tw.utils.getAnimationDuration(),\n\t\tcurrHeight = domNode.offsetHeight;\n\t// Clear the properties we've set when the animation is over\n\tsetTimeout(function() {\n\t\t$tw.utils.setStyle(domNode,[\n\t\t\t{transition: \&quot;none\&quot;},\n\t\t\t{marginBottom: \&quot;\&quot;},\n\t\t\t{marginTop: \&quot;\&quot;},\n\t\t\t{paddingBottom: \&quot;\&quot;},\n\t\t\t{paddingTop: \&quot;\&quot;},\n\t\t\t{height: \&quot;auto\&quot;},\n\t\t\t{opacity: \&quot;\&quot;}\n\t\t]);\n\t\tif(options.callback) {\n\t\t\toptions.callback();\n\t\t}\n\t},duration);\n\t// Set up the initial position of the element\n\t$tw.utils.setStyle(domNode,[\n\t\t{height: currHeight + \&quot;px\&quot;},\n\t\t{opacity: \&quot;1\&quot;}\n\t]);\n\t$tw.utils.forceLayout(domNode);\n\t// Transition to the final position\n\t$tw.utils.setStyle(domNode,[\n\t\t{transition: \&quot;margin-top \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;margin-bottom \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;padding-top \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;padding-bottom \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;height \&quot; + duration + \&quot;ms ease-in-out, \&quot; +\n\t\t\t\t\t\&quot;opacity \&quot; + duration + \&quot;ms ease-in-out\&quot;},\n\t\t{marginTop: \&quot;0px\&quot;},\n\t\t{marginBottom: \&quot;0px\&quot;},\n\t\t{paddingTop: \&quot;0px\&quot;},\n\t\t{paddingBottom: \&quot;0px\&quot;},\n\t\t{height: \&quot;0px\&quot;},\n\t\t{opacity: \&quot;0\&quot;}\n\t]);\n}\n\nexports.slide = {\n\topen: slideOpen,\n\tclose: slideClosed\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/animations/slide.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;animation&quot;
        },
        &quot;$:/core/modules/utils/dom/animator.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom/animator.js\ntype: application/javascript\nmodule-type: utils\n\nOrchestrates animations and transitions\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nfunction Animator() {\n\t// Get the registered animation modules\n\tthis.animations = {};\n\t$tw.modules.applyMethods(\&quot;animation\&quot;,this.animations);\n}\n\nAnimator.prototype.perform = function(type,domNode,options) {\n\toptions = options || {};\n\t// Find an animation that can handle this type\n\tvar chosenAnimation;\n\t$tw.utils.each(this.animations,function(animation,name) {\n\t\tif($tw.utils.hop(animation,type)) {\n\t\t\tchosenAnimation = animation[type];\n\t\t}\n\t});\n\tif(!chosenAnimation) {\n\t\tchosenAnimation = function(domNode,options) {\n\t\t\tif(options.callback) {\n\t\t\t\toptions.callback();\n\t\t\t}\n\t\t};\n\t}\n\t// Call the animation\n\tchosenAnimation(domNode,options);\n};\n\nexports.Animator = Animator;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/animator.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom/browser.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom/browser.js\ntype: application/javascript\nmodule-type: utils\n\nBrowser feature detection\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nSet style properties of an element\n\telement: dom node\n\tstyles: ordered array of {name: value} pairs\n*/\nexports.setStyle = function(element,styles) {\n\tif(element.nodeType === 1) { // Element.ELEMENT_NODE\n\t\tfor(var t=0; t&lt;styles.length; t++) {\n\t\t\tfor(var styleName in styles[t]) {\n\t\t\t\telement.style[$tw.utils.convertStyleNameToPropertyName(styleName)] = styles[t][styleName];\n\t\t\t}\n\t\t}\n\t}\n};\n\n/*\nConverts a standard CSS property name into the local browser-specific equivalent. For example:\n\t\&quot;background-color\&quot; --&gt; \&quot;backgroundColor\&quot;\n\t\&quot;transition\&quot; --&gt; \&quot;webkitTransition\&quot;\n*/\n\nvar styleNameCache = {}; // We'll cache the style name conversions\n\nexports.convertStyleNameToPropertyName = function(styleName) {\n\t// Return from the cache if we can\n\tif(styleNameCache[styleName]) {\n\t\treturn styleNameCache[styleName];\n\t}\n\t// Convert it by first removing any hyphens\n\tvar propertyName = $tw.utils.unHyphenateCss(styleName);\n\t// Then check if it needs a prefix\n\tif(document.body.style[propertyName] === undefined) {\n\t\tvar prefixes = [\&quot;O\&quot;,\&quot;MS\&quot;,\&quot;Moz\&quot;,\&quot;webkit\&quot;];\n\t\tfor(var t=0; t&lt;prefixes.length; t++) {\n\t\t\tvar prefixedName = prefixes[t] + propertyName.substr(0,1).toUpperCase() + propertyName.substr(1);\n\t\t\tif(document.body.style[prefixedName] !== undefined) {\n\t\t\t\tpropertyName = prefixedName;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\t// Put it in the cache too\n\tstyleNameCache[styleName] = propertyName;\n\treturn propertyName;\n};\n\n/*\nConverts a JS format CSS property name back into the dashed form used in CSS declarations. For example:\n\t\&quot;backgroundColor\&quot; --&gt; \&quot;background-color\&quot;\n\t\&quot;webkitTransform\&quot; --&gt; \&quot;-webkit-transform\&quot;\n*/\nexports.convertPropertyNameToStyleName = function(propertyName) {\n\t// Rehyphenate the name\n\tvar styleName = $tw.utils.hyphenateCss(propertyName);\n\t// If there's a webkit prefix, add a dash (other browsers have uppercase prefixes, and so get the dash automatically)\n\tif(styleName.indexOf(\&quot;webkit\&quot;) === 0) {\n\t\tstyleName = \&quot;-\&quot; + styleName;\n\t} else if(styleName.indexOf(\&quot;-m-s\&quot;) === 0) {\n\t\tstyleName = \&quot;-ms\&quot; + styleName.substr(4);\n\t}\n\treturn styleName;\n};\n\n/*\nRound trip a stylename to a property name and back again. For example:\n\t\&quot;transform\&quot; --&gt; \&quot;webkitTransform\&quot; --&gt; \&quot;-webkit-transform\&quot;\n*/\nexports.roundTripPropertyName = function(propertyName) {\n\treturn $tw.utils.convertPropertyNameToStyleName($tw.utils.convertStyleNameToPropertyName(propertyName));\n};\n\n/*\nConverts a standard event name into the local browser specific equivalent. For example:\n\t\&quot;animationEnd\&quot; --&gt; \&quot;webkitAnimationEnd\&quot;\n*/\n\nvar eventNameCache = {}; // We'll cache the conversions\n\nvar eventNameMappings = {\n\t\&quot;transitionEnd\&quot;: {\n\t\tcorrespondingCssProperty: \&quot;transition\&quot;,\n\t\tmappings: {\n\t\t\ttransition: \&quot;transitionend\&quot;,\n\t\t\tOTransition: \&quot;oTransitionEnd\&quot;,\n\t\t\tMSTransition: \&quot;msTransitionEnd\&quot;,\n\t\t\tMozTransition: \&quot;transitionend\&quot;,\n\t\t\twebkitTransition: \&quot;webkitTransitionEnd\&quot;\n\t\t}\n\t},\n\t\&quot;animationEnd\&quot;: {\n\t\tcorrespondingCssProperty: \&quot;animation\&quot;,\n\t\tmappings: {\n\t\t\tanimation: \&quot;animationend\&quot;,\n\t\t\tOAnimation: \&quot;oAnimationEnd\&quot;,\n\t\t\tMSAnimation: \&quot;msAnimationEnd\&quot;,\n\t\t\tMozAnimation: \&quot;animationend\&quot;,\n\t\t\twebkitAnimation: \&quot;webkitAnimationEnd\&quot;\n\t\t}\n\t}\n};\n\nexports.convertEventName = function(eventName) {\n\tif(eventNameCache[eventName]) {\n\t\treturn eventNameCache[eventName];\n\t}\n\tvar newEventName = eventName,\n\t\tmappings = eventNameMappings[eventName];\n\tif(mappings) {\n\t\tvar convertedProperty = $tw.utils.convertStyleNameToPropertyName(mappings.correspondingCssProperty);\n\t\tif(mappings.mappings[convertedProperty]) {\n\t\t\tnewEventName = mappings.mappings[convertedProperty];\n\t\t}\n\t}\n\t// Put it in the cache too\n\teventNameCache[eventName] = newEventName;\n\treturn newEventName;\n};\n\n/*\nReturn the names of the fullscreen APIs\n*/\nexports.getFullScreenApis = function() {\n\tvar d = document,\n\t\tdb = d.body,\n\t\tresult = {\n\t\t\&quot;_requestFullscreen\&quot;: db.webkitRequestFullscreen !== undefined ? \&quot;webkitRequestFullscreen\&quot; :\n\t\t\t\t\t\t\tdb.mozRequestFullScreen !== undefined ? \&quot;mozRequestFullScreen\&quot; :\n\t\t\t\t\t\t\tdb.msRequestFullscreen !== undefined ? \&quot;msRequestFullscreen\&quot; :\n\t\t\t\t\t\t\tdb.requestFullscreen !== undefined ? \&quot;requestFullscreen\&quot; : \&quot;\&quot;,\n\t\t\&quot;_exitFullscreen\&quot;: d.webkitExitFullscreen !== undefined ? \&quot;webkitExitFullscreen\&quot; :\n\t\t\t\t\t\t\td.mozCancelFullScreen !== undefined ? \&quot;mozCancelFullScreen\&quot; :\n\t\t\t\t\t\t\td.msExitFullscreen !== undefined ? \&quot;msExitFullscreen\&quot; :\n\t\t\t\t\t\t\td.exitFullscreen !== undefined ? \&quot;exitFullscreen\&quot; : \&quot;\&quot;,\n\t\t\&quot;_fullscreenElement\&quot;: d.webkitFullscreenElement !== undefined ? \&quot;webkitFullscreenElement\&quot; :\n\t\t\t\t\t\t\td.mozFullScreenElement !== undefined ? \&quot;mozFullScreenElement\&quot; :\n\t\t\t\t\t\t\td.msFullscreenElement !== undefined ? \&quot;msFullscreenElement\&quot; :\n\t\t\t\t\t\t\td.fullscreenElement !== undefined ? \&quot;fullscreenElement\&quot; : \&quot;\&quot;\n\t};\n\tif(!result._requestFullscreen || !result._exitFullscreen || !result._fullscreenElement) {\n\t\treturn null;\n\t} else {\n\t\treturn result;\n\t}\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/browser.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom/csscolorparser.js&quot;: {
            &quot;text&quot;: &quot;// (c) Dean McNamee &lt;dean@gmail.com&gt;, 2012.\n//\n// https://github.com/deanm/css-color-parser-js\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \&quot;Software\&quot;), to\n// deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n// sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \&quot;AS IS\&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n// FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n// IN THE SOFTWARE.\n\n// http://www.w3.org/TR/css3-color/\nvar kCSSColorTable = {\n  \&quot;transparent\&quot;: [0,0,0,0], \&quot;aliceblue\&quot;: [240,248,255,1],\n  \&quot;antiquewhite\&quot;: [250,235,215,1], \&quot;aqua\&quot;: [0,255,255,1],\n  \&quot;aquamarine\&quot;: [127,255,212,1], \&quot;azure\&quot;: [240,255,255,1],\n  \&quot;beige\&quot;: [245,245,220,1], \&quot;bisque\&quot;: [255,228,196,1],\n  \&quot;black\&quot;: [0,0,0,1], \&quot;blanchedalmond\&quot;: [255,235,205,1],\n  \&quot;blue\&quot;: [0,0,255,1], \&quot;blueviolet\&quot;: [138,43,226,1],\n  \&quot;brown\&quot;: [165,42,42,1], \&quot;burlywood\&quot;: [222,184,135,1],\n  \&quot;cadetblue\&quot;: [95,158,160,1], \&quot;chartreuse\&quot;: [127,255,0,1],\n  \&quot;chocolate\&quot;: [210,105,30,1], \&quot;coral\&quot;: [255,127,80,1],\n  \&quot;cornflowerblue\&quot;: [100,149,237,1], \&quot;cornsilk\&quot;: [255,248,220,1],\n  \&quot;crimson\&quot;: [220,20,60,1], \&quot;cyan\&quot;: [0,255,255,1],\n  \&quot;darkblue\&quot;: [0,0,139,1], \&quot;darkcyan\&quot;: [0,139,139,1],\n  \&quot;darkgoldenrod\&quot;: [184,134,11,1], \&quot;darkgray\&quot;: [169,169,169,1],\n  \&quot;darkgreen\&quot;: [0,100,0,1], \&quot;darkgrey\&quot;: [169,169,169,1],\n  \&quot;darkkhaki\&quot;: [189,183,107,1], \&quot;darkmagenta\&quot;: [139,0,139,1],\n  \&quot;darkolivegreen\&quot;: [85,107,47,1], \&quot;darkorange\&quot;: [255,140,0,1],\n  \&quot;darkorchid\&quot;: [153,50,204,1], \&quot;darkred\&quot;: [139,0,0,1],\n  \&quot;darksalmon\&quot;: [233,150,122,1], \&quot;darkseagreen\&quot;: [143,188,143,1],\n  \&quot;darkslateblue\&quot;: [72,61,139,1], \&quot;darkslategray\&quot;: [47,79,79,1],\n  \&quot;darkslategrey\&quot;: [47,79,79,1], \&quot;darkturquoise\&quot;: [0,206,209,1],\n  \&quot;darkviolet\&quot;: [148,0,211,1], \&quot;deeppink\&quot;: [255,20,147,1],\n  \&quot;deepskyblue\&quot;: [0,191,255,1], \&quot;dimgray\&quot;: [105,105,105,1],\n  \&quot;dimgrey\&quot;: [105,105,105,1], \&quot;dodgerblue\&quot;: [30,144,255,1],\n  \&quot;firebrick\&quot;: [178,34,34,1], \&quot;floralwhite\&quot;: [255,250,240,1],\n  \&quot;forestgreen\&quot;: [34,139,34,1], \&quot;fuchsia\&quot;: [255,0,255,1],\n  \&quot;gainsboro\&quot;: [220,220,220,1], \&quot;ghostwhite\&quot;: [248,248,255,1],\n  \&quot;gold\&quot;: [255,215,0,1], \&quot;goldenrod\&quot;: [218,165,32,1],\n  \&quot;gray\&quot;: [128,128,128,1], \&quot;green\&quot;: [0,128,0,1],\n  \&quot;greenyellow\&quot;: [173,255,47,1], \&quot;grey\&quot;: [128,128,128,1],\n  \&quot;honeydew\&quot;: [240,255,240,1], \&quot;hotpink\&quot;: [255,105,180,1],\n  \&quot;indianred\&quot;: [205,92,92,1], \&quot;indigo\&quot;: [75,0,130,1],\n  \&quot;ivory\&quot;: [255,255,240,1], \&quot;khaki\&quot;: [240,230,140,1],\n  \&quot;lavender\&quot;: [230,230,250,1], \&quot;lavenderblush\&quot;: [255,240,245,1],\n  \&quot;lawngreen\&quot;: [124,252,0,1], \&quot;lemonchiffon\&quot;: [255,250,205,1],\n  \&quot;lightblue\&quot;: [173,216,230,1], \&quot;lightcoral\&quot;: [240,128,128,1],\n  \&quot;lightcyan\&quot;: [224,255,255,1], \&quot;lightgoldenrodyellow\&quot;: [250,250,210,1],\n  \&quot;lightgray\&quot;: [211,211,211,1], \&quot;lightgreen\&quot;: [144,238,144,1],\n  \&quot;lightgrey\&quot;: [211,211,211,1], \&quot;lightpink\&quot;: [255,182,193,1],\n  \&quot;lightsalmon\&quot;: [255,160,122,1], \&quot;lightseagreen\&quot;: [32,178,170,1],\n  \&quot;lightskyblue\&quot;: [135,206,250,1], \&quot;lightslategray\&quot;: [119,136,153,1],\n  \&quot;lightslategrey\&quot;: [119,136,153,1], \&quot;lightsteelblue\&quot;: [176,196,222,1],\n  \&quot;lightyellow\&quot;: [255,255,224,1], \&quot;lime\&quot;: [0,255,0,1],\n  \&quot;limegreen\&quot;: [50,205,50,1], \&quot;linen\&quot;: [250,240,230,1],\n  \&quot;magenta\&quot;: [255,0,255,1], \&quot;maroon\&quot;: [128,0,0,1],\n  \&quot;mediumaquamarine\&quot;: [102,205,170,1], \&quot;mediumblue\&quot;: [0,0,205,1],\n  \&quot;mediumorchid\&quot;: [186,85,211,1], \&quot;mediumpurple\&quot;: [147,112,219,1],\n  \&quot;mediumseagreen\&quot;: [60,179,113,1], \&quot;mediumslateblue\&quot;: [123,104,238,1],\n  \&quot;mediumspringgreen\&quot;: [0,250,154,1], \&quot;mediumturquoise\&quot;: [72,209,204,1],\n  \&quot;mediumvioletred\&quot;: [199,21,133,1], \&quot;midnightblue\&quot;: [25,25,112,1],\n  \&quot;mintcream\&quot;: [245,255,250,1], \&quot;mistyrose\&quot;: [255,228,225,1],\n  \&quot;moccasin\&quot;: [255,228,181,1], \&quot;navajowhite\&quot;: [255,222,173,1],\n  \&quot;navy\&quot;: [0,0,128,1], \&quot;oldlace\&quot;: [253,245,230,1],\n  \&quot;olive\&quot;: [128,128,0,1], \&quot;olivedrab\&quot;: [107,142,35,1],\n  \&quot;orange\&quot;: [255,165,0,1], \&quot;orangered\&quot;: [255,69,0,1],\n  \&quot;orchid\&quot;: [218,112,214,1], \&quot;palegoldenrod\&quot;: [238,232,170,1],\n  \&quot;palegreen\&quot;: [152,251,152,1], \&quot;paleturquoise\&quot;: [175,238,238,1],\n  \&quot;palevioletred\&quot;: [219,112,147,1], \&quot;papayawhip\&quot;: [255,239,213,1],\n  \&quot;peachpuff\&quot;: [255,218,185,1], \&quot;peru\&quot;: [205,133,63,1],\n  \&quot;pink\&quot;: [255,192,203,1], \&quot;plum\&quot;: [221,160,221,1],\n  \&quot;powderblue\&quot;: [176,224,230,1], \&quot;purple\&quot;: [128,0,128,1],\n  \&quot;red\&quot;: [255,0,0,1], \&quot;rosybrown\&quot;: [188,143,143,1],\n  \&quot;royalblue\&quot;: [65,105,225,1], \&quot;saddlebrown\&quot;: [139,69,19,1],\n  \&quot;salmon\&quot;: [250,128,114,1], \&quot;sandybrown\&quot;: [244,164,96,1],\n  \&quot;seagreen\&quot;: [46,139,87,1], \&quot;seashell\&quot;: [255,245,238,1],\n  \&quot;sienna\&quot;: [160,82,45,1], \&quot;silver\&quot;: [192,192,192,1],\n  \&quot;skyblue\&quot;: [135,206,235,1], \&quot;slateblue\&quot;: [106,90,205,1],\n  \&quot;slategray\&quot;: [112,128,144,1], \&quot;slategrey\&quot;: [112,128,144,1],\n  \&quot;snow\&quot;: [255,250,250,1], \&quot;springgreen\&quot;: [0,255,127,1],\n  \&quot;steelblue\&quot;: [70,130,180,1], \&quot;tan\&quot;: [210,180,140,1],\n  \&quot;teal\&quot;: [0,128,128,1], \&quot;thistle\&quot;: [216,191,216,1],\n  \&quot;tomato\&quot;: [255,99,71,1], \&quot;turquoise\&quot;: [64,224,208,1],\n  \&quot;violet\&quot;: [238,130,238,1], \&quot;wheat\&quot;: [245,222,179,1],\n  \&quot;white\&quot;: [255,255,255,1], \&quot;whitesmoke\&quot;: [245,245,245,1],\n  \&quot;yellow\&quot;: [255,255,0,1], \&quot;yellowgreen\&quot;: [154,205,50,1]}\n\nfunction clamp_css_byte(i) {  // Clamp to integer 0 .. 255.\n  i = Math.round(i);  // Seems to be what Chrome does (vs truncation).\n  return i &lt; 0 ? 0 : i &gt; 255 ? 255 : i;\n}\n\nfunction clamp_css_float(f) {  // Clamp to float 0.0 .. 1.0.\n  return f &lt; 0 ? 0 : f &gt; 1 ? 1 : f;\n}\n\nfunction parse_css_int(str) {  // int or percentage.\n  if (str[str.length - 1] === '%')\n    return clamp_css_byte(parseFloat(str) / 100 * 255);\n  return clamp_css_byte(parseInt(str));\n}\n\nfunction parse_css_float(str) {  // float or percentage.\n  if (str[str.length - 1] === '%')\n    return clamp_css_float(parseFloat(str) / 100);\n  return clamp_css_float(parseFloat(str));\n}\n\nfunction css_hue_to_rgb(m1, m2, h) {\n  if (h &lt; 0) h += 1;\n  else if (h &gt; 1) h -= 1;\n\n  if (h * 6 &lt; 1) return m1 + (m2 - m1) * h * 6;\n  if (h * 2 &lt; 1) return m2;\n  if (h * 3 &lt; 2) return m1 + (m2 - m1) * (2/3 - h) * 6;\n  return m1;\n}\n\nfunction parseCSSColor(css_str) {\n  // Remove all whitespace, not compliant, but should just be more accepting.\n  var str = css_str.replace(/ /g, '').toLowerCase();\n\n  // Color keywords (and transparent) lookup.\n  if (str in kCSSColorTable) return kCSSColorTable[str].slice();  // dup.\n\n  // #abc and #abc123 syntax.\n  if (str[0] === '#') {\n    if (str.length === 4) {\n      var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\n      if (!(iv &gt;= 0 &amp;&amp; iv &lt;= 0xfff)) return null;  // Covers NaN.\n      return [((iv &amp; 0xf00) &gt;&gt; 4) | ((iv &amp; 0xf00) &gt;&gt; 8),\n              (iv &amp; 0xf0) | ((iv &amp; 0xf0) &gt;&gt; 4),\n              (iv &amp; 0xf) | ((iv &amp; 0xf) &lt;&lt; 4),\n              1];\n    } else if (str.length === 7) {\n      var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\n      if (!(iv &gt;= 0 &amp;&amp; iv &lt;= 0xffffff)) return null;  // Covers NaN.\n      return [(iv &amp; 0xff0000) &gt;&gt; 16,\n              (iv &amp; 0xff00) &gt;&gt; 8,\n              iv &amp; 0xff,\n              1];\n    }\n\n    return null;\n  }\n\n  var op = str.indexOf('('), ep = str.indexOf(')');\n  if (op !== -1 &amp;&amp; ep + 1 === str.length) {\n    var fname = str.substr(0, op);\n    var params = str.substr(op+1, ep-(op+1)).split(',');\n    var alpha = 1;  // To allow case fallthrough.\n    switch (fname) {\n      case 'rgba':\n        if (params.length !== 4) return null;\n        alpha = parse_css_float(params.pop());\n        // Fall through.\n      case 'rgb':\n        if (params.length !== 3) return null;\n        return [parse_css_int(params[0]),\n                parse_css_int(params[1]),\n                parse_css_int(params[2]),\n                alpha];\n      case 'hsla':\n        if (params.length !== 4) return null;\n        alpha = parse_css_float(params.pop());\n        // Fall through.\n      case 'hsl':\n        if (params.length !== 3) return null;\n        var h = (((parseFloat(params[0]) % 360) + 360) % 360) / 360;  // 0 .. 1\n        // NOTE(deanm): According to the CSS spec s/l should only be\n        // percentages, but we don't bother and let float or percentage.\n        var s = parse_css_float(params[1]);\n        var l = parse_css_float(params[2]);\n        var m2 = l &lt;= 0.5 ? l * (s + 1) : l + s - l * s;\n        var m1 = l * 2 - m2;\n        return [clamp_css_byte(css_hue_to_rgb(m1, m2, h+1/3) * 255),\n                clamp_css_byte(css_hue_to_rgb(m1, m2, h) * 255),\n                clamp_css_byte(css_hue_to_rgb(m1, m2, h-1/3) * 255),\n                alpha];\n      default:\n        return null;\n    }\n  }\n\n  return null;\n}\n\ntry { exports.parseCSSColor = parseCSSColor } catch(e) { }\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/csscolorparser.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom.js\ntype: application/javascript\nmodule-type: utils\n\nVarious static DOM-related utility functions.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nDetermines whether element 'a' contains element 'b'\nCode thanks to John Resig, http://ejohn.org/blog/comparing-document-position/\n*/\nexports.domContains = function(a,b) {\n\treturn a.contains ?\n\t\ta !== b &amp;&amp; a.contains(b) :\n\t\t!!(a.compareDocumentPosition(b) &amp; 16);\n};\n\nexports.removeChildren = function(node) {\n\twhile(node.hasChildNodes()) {\n\t\tnode.removeChild(node.firstChild);\n\t}\n};\n\nexports.hasClass = function(el,className) {\n\treturn el &amp;&amp; el.className &amp;&amp; el.className.toString().split(\&quot; \&quot;).indexOf(className) !== -1;\n};\n\nexports.addClass = function(el,className) {\n\tvar c = el.className.split(\&quot; \&quot;);\n\tif(c.indexOf(className) === -1) {\n\t\tc.push(className);\n\t}\n\tel.className = c.join(\&quot; \&quot;);\n};\n\nexports.removeClass = function(el,className) {\n\tvar c = el.className.split(\&quot; \&quot;),\n\t\tp = c.indexOf(className);\n\tif(p !== -1) {\n\t\tc.splice(p,1);\n\t\tel.className = c.join(\&quot; \&quot;);\n\t}\n};\n\nexports.toggleClass = function(el,className,status) {\n\tif(status === undefined) {\n\t\tstatus = !exports.hasClass(el,className);\n\t}\n\tif(status) {\n\t\texports.addClass(el,className);\n\t} else {\n\t\texports.removeClass(el,className);\n\t}\n};\n\n/*\nGet the scroll position of the viewport\nReturns:\n\t{\n\t\tx: horizontal scroll position in pixels,\n\t\ty: vertical scroll position in pixels\n\t}\n*/\nexports.getScrollPosition = function() {\n\tif(\&quot;scrollX\&quot; in window) {\n\t\treturn {x: window.scrollX, y: window.scrollY};\n\t} else {\n\t\treturn {x: document.documentElement.scrollLeft, y: document.documentElement.scrollTop};\n\t}\n};\n\n/*\nGets the bounding rectangle of an element in absolute page coordinates\n*/\nexports.getBoundingPageRect = function(element) {\n\tvar scrollPos = $tw.utils.getScrollPosition(),\n\t\tclientRect = element.getBoundingClientRect();\n\treturn {\n\t\tleft: clientRect.left + scrollPos.x,\n\t\twidth: clientRect.width,\n\t\tright: clientRect.right + scrollPos.x,\n\t\ttop: clientRect.top + scrollPos.y,\n\t\theight: clientRect.height,\n\t\tbottom: clientRect.bottom + scrollPos.y\n\t};\n};\n\n/*\nSaves a named password in the browser\n*/\nexports.savePassword = function(name,password) {\n\ttry {\n\t\tif(window.localStorage) {\n\t\t\tlocalStorage.setItem(\&quot;tw5-password-\&quot; + name,password);\n\t\t}\n\t} catch(e) {\n\t}\n};\n\n/*\nRetrieve a named password from the browser\n*/\nexports.getPassword = function(name) {\n\ttry {\n\t\treturn window.localStorage ? localStorage.getItem(\&quot;tw5-password-\&quot; + name) : \&quot;\&quot;;\n\t} catch(e) {\n\t\treturn \&quot;\&quot;;\n\t}\n};\n\n/*\nForce layout of a dom node and its descendents\n*/\nexports.forceLayout = function(element) {\n\tvar dummy = element.offsetWidth;\n};\n\n/*\nPulse an element for debugging purposes\n*/\nexports.pulseElement = function(element) {\n\t// Event handler to remove the class at the end\n\telement.addEventListener($tw.browser.animationEnd,function handler(event) {\n\t\telement.removeEventListener($tw.browser.animationEnd,handler,false);\n\t\t$tw.utils.removeClass(element,\&quot;pulse\&quot;);\n\t},false);\n\t// Apply the pulse class\n\t$tw.utils.removeClass(element,\&quot;pulse\&quot;);\n\t$tw.utils.forceLayout(element);\n\t$tw.utils.addClass(element,\&quot;pulse\&quot;);\n};\n\n/*\nAttach specified event handlers to a DOM node\ndomNode: where to attach the event handlers\nevents: array of event handlers to be added (see below)\nEach entry in the events array is an object with these properties:\nhandlerFunction: optional event handler function\nhandlerObject: optional event handler object\nhandlerMethod: optionally specifies object handler method name (defaults to `handleEvent`)\n*/\nexports.addEventListeners = function(domNode,events) {\n\t$tw.utils.each(events,function(eventInfo) {\n\t\tvar handler;\n\t\tif(eventInfo.handlerFunction) {\n\t\t\thandler = eventInfo.handlerFunction;\n\t\t} else if(eventInfo.handlerObject) {\n\t\t\tif(eventInfo.handlerMethod) {\n\t\t\t\thandler = function(event) {\n\t\t\t\t\teventInfo.handlerObject[eventInfo.handlerMethod].call(eventInfo.handlerObject,event);\n\t\t\t\t};\t\n\t\t\t} else {\n\t\t\t\thandler = eventInfo.handlerObject;\n\t\t\t}\n\t\t}\n\t\tdomNode.addEventListener(eventInfo.name,handler,false);\n\t});\n};\n\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom/http.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom/http.js\ntype: application/javascript\nmodule-type: utils\n\nBrowser HTTP support\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nA quick and dirty HTTP function; to be refactored later. Options are:\n\turl: URL to retrieve\n\ttype: GET, PUT, POST etc\n\tcallback: function invoked with (err,data)\n*/\nexports.httpRequest = function(options) {\n\tvar type = options.type || \&quot;GET\&quot;,\n\t\theaders = options.headers || {accept: \&quot;application/json\&quot;},\n\t\trequest = new XMLHttpRequest(),\n\t\tdata = \&quot;\&quot;,\n\t\tf,results;\n\t// Massage the data hashmap into a string\n\tif(options.data) {\n\t\tif(typeof options.data === \&quot;string\&quot;) { // Already a string\n\t\t\tdata = options.data;\n\t\t} else { // A hashmap of strings\n\t\t\tresults = [];\n\t\t\t$tw.utils.each(options.data,function(dataItem,dataItemTitle) {\n\t\t\t\tresults.push(dataItemTitle + \&quot;=\&quot; + encodeURIComponent(dataItem));\n\t\t\t});\n\t\t\tdata = results.join(\&quot;&amp;\&quot;);\n\t\t}\n\t}\n\t// Set up the state change handler\n\trequest.onreadystatechange = function() {\n\t\tif(this.readyState === 4) {\n\t\t\tif(this.status === 200 || this.status === 201 || this.status === 204) {\n\t\t\t\t// Success!\n\t\t\t\toptions.callback(null,this.responseText,this);\n\t\t\t\treturn;\n\t\t\t}\n\t\t// Something went wrong\n\t\toptions.callback(\&quot;XMLHttpRequest error code: \&quot; + this.status);\n\t\t}\n\t};\n\t// Make the request\n\trequest.open(type,options.url,true);\n\tif(headers) {\n\t\t$tw.utils.each(headers,function(header,headerTitle,object) {\n\t\t\trequest.setRequestHeader(headerTitle,header);\n\t\t});\n\t}\n\tif(data &amp;&amp; !$tw.utils.hop(headers,\&quot;Content-type\&quot;)) {\n\t\trequest.setRequestHeader(\&quot;Content-type\&quot;,\&quot;application/x-www-form-urlencoded; charset=UTF-8\&quot;);\n\t}\n\trequest.send(data);\n\treturn request;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/http.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom/keyboard.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom/keyboard.js\ntype: application/javascript\nmodule-type: utils\n\nKeyboard utilities\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar namedKeys = {\n\t\&quot;backspace\&quot;: 8,\n\t\&quot;tab\&quot;: 9,\n\t\&quot;enter\&quot;: 13,\n\t\&quot;escape\&quot;: 27\n};\n\n/*\nParses a key descriptor into the structure:\n{\n\tkeyCode: numeric keycode\n\tshiftKey: boolean\n\taltKey: boolean\n\tctrlKey: boolean\n}\nKey descriptors have the following format:\n\tctrl+enter\n\tctrl+shift+alt+A\n*/\nexports.parseKeyDescriptor = function(keyDescriptor) {\n\tvar components = keyDescriptor.split(\&quot;+\&quot;),\n\t\tinfo = {\n\t\t\tkeyCode: 0,\n\t\t\tshiftKey: false,\n\t\t\taltKey: false,\n\t\t\tctrlKey: false\n\t\t};\n\tfor(var t=0; t&lt;components.length; t++) {\n\t\tvar s = components[t].toLowerCase();\n\t\t// Look for modifier keys\n\t\tif(s === \&quot;ctrl\&quot;) {\n\t\t\tinfo.ctrlKey = true;\n\t\t} else if(s === \&quot;shift\&quot;) {\n\t\t\tinfo.shiftKey = true;\n\t\t} else if(s === \&quot;alt\&quot;) {\n\t\t\tinfo.altKey = true;\n\t\t} else if(s === \&quot;meta\&quot;) {\n\t\t\tinfo.metaKey = true;\n\t\t}\n\t\t// Replace named keys with their code\n\t\tif(namedKeys[s]) {\n\t\t\tinfo.keyCode = namedKeys[s];\n\t\t}\n\t}\n\treturn info;\n};\n\nexports.checkKeyDescriptor = function(event,keyInfo) {\n\tvar metaKeyStatus = !!keyInfo.metaKey; // Using a temporary variable to keep JSHint happy\n\treturn event.keyCode === keyInfo.keyCode &amp;&amp; \n\t\t\tevent.shiftKey === keyInfo.shiftKey &amp;&amp; \n\t\t\tevent.altKey === keyInfo.altKey &amp;&amp; \n\t\t\tevent.ctrlKey === keyInfo.ctrlKey &amp;&amp; \n\t\t\tevent.metaKey === metaKeyStatus;\t\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/keyboard.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom/modal.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom/modal.js\ntype: application/javascript\nmodule-type: utils\n\nModal message mechanism\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;);\n\nvar Modal = function(wiki) {\n\tthis.wiki = wiki;\n\tthis.modalCount = 0;\n};\n\n/*\nDisplay a modal dialogue\n\ttitle: Title of tiddler to display\n\toptions: see below\nOptions include:\n\tdownloadLink: Text of a big download link to include\n*/\nModal.prototype.display = function(title,options) {\n\toptions = options || {};\n\tvar self = this,\n\t\tduration = $tw.utils.getAnimationDuration(),\n\t\ttiddler = this.wiki.getTiddler(title);\n\t// Don't do anything if the tiddler doesn't exist\n\tif(!tiddler) {\n\t\treturn;\n\t}\n\t// Create the variables\n\tvar variables = $tw.utils.extend({currentTiddler: title},options.variables);\n\t// Create the wrapper divs\n\tvar wrapper = document.createElement(\&quot;div\&quot;),\n\t\tmodalBackdrop = document.createElement(\&quot;div\&quot;),\n\t\tmodalWrapper = document.createElement(\&quot;div\&quot;),\n\t\tmodalHeader = document.createElement(\&quot;div\&quot;),\n\t\theaderTitle = document.createElement(\&quot;h3\&quot;),\n\t\tmodalBody = document.createElement(\&quot;div\&quot;),\n\t\tmodalLink = document.createElement(\&quot;a\&quot;),\n\t\tmodalFooter = document.createElement(\&quot;div\&quot;),\n\t\tmodalFooterHelp = document.createElement(\&quot;span\&quot;),\n\t\tmodalFooterButtons = document.createElement(\&quot;span\&quot;);\n\t// Up the modal count and adjust the body class\n\tthis.modalCount++;\n\tthis.adjustPageClass();\n\t// Add classes\n\t$tw.utils.addClass(wrapper,\&quot;tc-modal-wrapper\&quot;);\n\t$tw.utils.addClass(modalBackdrop,\&quot;tc-modal-backdrop\&quot;);\n\t$tw.utils.addClass(modalWrapper,\&quot;tc-modal\&quot;);\n\t$tw.utils.addClass(modalHeader,\&quot;tc-modal-header\&quot;);\n\t$tw.utils.addClass(modalBody,\&quot;tc-modal-body\&quot;);\n\t$tw.utils.addClass(modalFooter,\&quot;tc-modal-footer\&quot;);\n\t// Join them together\n\twrapper.appendChild(modalBackdrop);\n\twrapper.appendChild(modalWrapper);\n\tmodalHeader.appendChild(headerTitle);\n\tmodalWrapper.appendChild(modalHeader);\n\tmodalWrapper.appendChild(modalBody);\n\tmodalFooter.appendChild(modalFooterHelp);\n\tmodalFooter.appendChild(modalFooterButtons);\n\tmodalWrapper.appendChild(modalFooter);\n\t// Render the title of the message\n\tvar headerWidgetNode = this.wiki.makeTranscludeWidget(title,{\n\t\tfield: \&quot;subtitle\&quot;,\n\t\tchildren: [{\n\t\t\ttype: \&quot;text\&quot;,\n\t\t\tattributes: {\n\t\t\t\ttext: {\n\t\t\t\t\ttype: \&quot;string\&quot;,\n\t\t\t\t\tvalue: title\n\t\t}}}],\n\t\tparentWidget: $tw.rootWidget,\n\t\tdocument: document,\n\t\tvariables: variables\n\t});\n\theaderWidgetNode.render(headerTitle,null);\n\tthis.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\theaderWidgetNode.refresh(changes,modalHeader,null);\n\t});\n\t// Render the body of the message\n\tvar bodyWidgetNode = this.wiki.makeTranscludeWidget(title,{\n\t\tparentWidget: $tw.rootWidget,\n\t\tdocument: document,\n\t\tvariables: variables\n\t});\n\tbodyWidgetNode.render(modalBody,null);\n\tthis.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\tbodyWidgetNode.refresh(changes,modalBody,null);\n\t});\n\t// Setup the link if present\n\tif(options.downloadLink) {\n\t\tmodalLink.href = options.downloadLink;\n\t\tmodalLink.appendChild(document.createTextNode(\&quot;Right-click to save changes\&quot;));\n\t\tmodalBody.appendChild(modalLink);\n\t}\n\t// Render the footer of the message\n\tif(tiddler &amp;&amp; tiddler.fields &amp;&amp; tiddler.fields.help) {\n\t\tvar link = document.createElement(\&quot;a\&quot;);\n\t\tlink.setAttribute(\&quot;href\&quot;,tiddler.fields.help);\n\t\tlink.setAttribute(\&quot;target\&quot;,\&quot;_blank\&quot;);\n\t\tlink.appendChild(document.createTextNode(\&quot;Help\&quot;));\n\t\tmodalFooterHelp.appendChild(link);\n\t\tmodalFooterHelp.style.float = \&quot;left\&quot;;\n\t}\n\tvar footerWidgetNode = this.wiki.makeTranscludeWidget(title,{\n\t\tfield: \&quot;footer\&quot;,\n\t\tchildren: [{\n\t\t\ttype: \&quot;button\&quot;,\n\t\t\tattributes: {\n\t\t\t\tmessage: {\n\t\t\t\t\ttype: \&quot;string\&quot;,\n\t\t\t\t\tvalue: \&quot;tm-close-tiddler\&quot;\n\t\t\t\t}\n\t\t\t},\n\t\t\tchildren: [{\n\t\t\t\ttype: \&quot;text\&quot;,\n\t\t\t\tattributes: {\n\t\t\t\t\ttext: {\n\t\t\t\t\t\ttype: \&quot;string\&quot;,\n\t\t\t\t\t\tvalue: \&quot;Close\&quot;\n\t\t\t}}}\n\t\t]}],\n\t\tparentWidget: $tw.rootWidget,\n\t\tdocument: document,\n\t\tvariables: variables\n\t});\n\tfooterWidgetNode.render(modalFooterButtons,null);\n\tthis.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\tfooterWidgetNode.refresh(changes,modalFooterButtons,null);\n\t});\n\t// Add the close event handler\n\tvar closeHandler = function(event) {\n\t\t// Decrease the modal count and adjust the body class\n\t\tself.modalCount--;\n\t\tself.adjustPageClass();\n\t\t// Force layout and animate the modal message away\n\t\t$tw.utils.forceLayout(modalBackdrop);\n\t\t$tw.utils.forceLayout(modalWrapper);\n\t\t$tw.utils.setStyle(modalBackdrop,[\n\t\t\t{opacity: \&quot;0\&quot;}\n\t\t]);\n\t\t$tw.utils.setStyle(modalWrapper,[\n\t\t\t{transform: \&quot;translateY(\&quot; + window.innerHeight + \&quot;px)\&quot;}\n\t\t]);\n\t\t// Set up an event for the transition end\n\t\twindow.setTimeout(function() {\n\t\t\tif(wrapper.parentNode) {\n\t\t\t\t// Remove the modal message from the DOM\n\t\t\t\tdocument.body.removeChild(wrapper);\n\t\t\t}\n\t\t},duration);\n\t\t// Don't let anyone else handle the tm-close-tiddler message\n\t\treturn false;\n\t};\n\theaderWidgetNode.addEventListener(\&quot;tm-close-tiddler\&quot;,closeHandler,false);\n\tbodyWidgetNode.addEventListener(\&quot;tm-close-tiddler\&quot;,closeHandler,false);\n\tfooterWidgetNode.addEventListener(\&quot;tm-close-tiddler\&quot;,closeHandler,false);\n\t// Set the initial styles for the message\n\t$tw.utils.setStyle(modalBackdrop,[\n\t\t{opacity: \&quot;0\&quot;}\n\t]);\n\t$tw.utils.setStyle(modalWrapper,[\n\t\t{transformOrigin: \&quot;0% 0%\&quot;},\n\t\t{transform: \&quot;translateY(\&quot; + (-window.innerHeight) + \&quot;px)\&quot;}\n\t]);\n\t// Put the message into the document\n\tdocument.body.appendChild(wrapper);\n\t// Set up animation for the styles\n\t$tw.utils.setStyle(modalBackdrop,[\n\t\t{transition: \&quot;opacity \&quot; + duration + \&quot;ms ease-out\&quot;}\n\t]);\n\t$tw.utils.setStyle(modalWrapper,[\n\t\t{transition: $tw.utils.roundTripPropertyName(\&quot;transform\&quot;) + \&quot; \&quot; + duration + \&quot;ms ease-in-out\&quot;}\n\t]);\n\t// Force layout\n\t$tw.utils.forceLayout(modalBackdrop);\n\t$tw.utils.forceLayout(modalWrapper);\n\t// Set final animated styles\n\t$tw.utils.setStyle(modalBackdrop,[\n\t\t{opacity: \&quot;0.7\&quot;}\n\t]);\n\t$tw.utils.setStyle(modalWrapper,[\n\t\t{transform: \&quot;translateY(0px)\&quot;}\n\t]);\n};\n\nModal.prototype.adjustPageClass = function() {\n\tif($tw.pageContainer) {\n\t\t$tw.utils.toggleClass($tw.pageContainer,\&quot;tc-modal-displayed\&quot;,this.modalCount &gt; 0);\n\t}\n};\n\nexports.Modal = Modal;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/modal.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom/notifier.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom/notifier.js\ntype: application/javascript\nmodule-type: utils\n\nNotifier mechanism\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;);\n\nvar Notifier = function(wiki) {\n\tthis.wiki = wiki;\n};\n\n/*\nDisplay a notification\n\ttitle: Title of tiddler containing the notification text\n\toptions: see below\nOptions include:\n*/\nNotifier.prototype.display = function(title,options) {\n\toptions = options || {};\n\t// Create the wrapper divs\n\tvar notification = document.createElement(\&quot;div\&quot;),\n\t\ttiddler = this.wiki.getTiddler(title),\n\t\tduration = $tw.utils.getAnimationDuration();\n\t// Don't do anything if the tiddler doesn't exist\n\tif(!tiddler) {\n\t\treturn;\n\t}\n\t// Add classes\n\t$tw.utils.addClass(notification,\&quot;tc-notification\&quot;);\n\t// Render the body of the notification\n\tvar widgetNode = this.wiki.makeTranscludeWidget(title,{parentWidget: $tw.rootWidget, document: document});\n\twidgetNode.render(notification,null);\n\tthis.wiki.addEventListener(\&quot;change\&quot;,function(changes) {\n\t\twidgetNode.refresh(changes,notification,null);\n\t});\n\t// Set the initial styles for the notification\n\t$tw.utils.setStyle(notification,[\n\t\t{opacity: \&quot;0\&quot;},\n\t\t{transformOrigin: \&quot;0% 0%\&quot;},\n\t\t{transform: \&quot;translateY(\&quot; + (-window.innerHeight) + \&quot;px)\&quot;},\n\t\t{transition: \&quot;opacity \&quot; + duration + \&quot;ms ease-out, \&quot; + $tw.utils.roundTripPropertyName(\&quot;transform\&quot;) + \&quot; \&quot; + duration + \&quot;ms ease-in-out\&quot;}\n\t]);\n\t// Add the notification to the DOM\n\tdocument.body.appendChild(notification);\n\t// Force layout\n\t$tw.utils.forceLayout(notification);\n\t// Set final animated styles\n\t$tw.utils.setStyle(notification,[\n\t\t{opacity: \&quot;1.0\&quot;},\n\t\t{transform: \&quot;translateY(0px)\&quot;}\n\t]);\n\t// Set a timer to remove the notification\n\twindow.setTimeout(function() {\n\t\t// Force layout and animate the notification away\n\t\t$tw.utils.forceLayout(notification);\n\t\t$tw.utils.setStyle(notification,[\n\t\t\t{opacity: \&quot;0.0\&quot;},\n\t\t\t{transform: \&quot;translateX(\&quot; + (notification.offsetWidth) + \&quot;px)\&quot;}\n\t\t]);\n\t\t// Remove the modal message from the DOM once the transition ends\n\t\tsetTimeout(function() {\n\t\t\tif(notification.parentNode) {\n\t\t\t\tdocument.body.removeChild(notification);\n\t\t\t}\n\t\t},duration);\n\t},$tw.config.preferences.notificationDuration);\n};\n\nexports.Notifier = Notifier;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/notifier.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom/popup.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom/popup.js\ntype: application/javascript\nmodule-type: utils\n\nModule that creates a $tw.utils.Popup object prototype that manages popups in the browser\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nCreates a Popup object with these options:\n\trootElement: the DOM element to which the popup zapper should be attached\n*/\nvar Popup = function(options) {\n\toptions = options || {};\n\tthis.rootElement = options.rootElement || document.documentElement;\n\tthis.popups = []; // Array of {title:,wiki:,domNode:} objects\n};\n\n/*\nTrigger a popup open or closed. Parameters are in a hashmap:\n\ttitle: title of the tiddler where the popup details are stored\n\tdomNode: dom node to which the popup will be positioned\n\twiki: wiki\n\tforce: if specified, forces the popup state to true or false (instead of toggling it)\n*/\nPopup.prototype.triggerPopup = function(options) {\n\t// Check if this popup is already active\n\tvar index = -1;\n\tfor(var t=0; t&lt;this.popups.length; t++) {\n\t\tif(this.popups[t].title === options.title) {\n\t\t\tindex = t;\n\t\t}\n\t}\n\t// Compute the new state\n\tvar state = index === -1;\n\tif(options.force !== undefined) {\n\t\tstate = options.force;\n\t}\n\t// Show or cancel the popup according to the new state\n\tif(state) {\n\t\tthis.show(options);\n\t} else {\n\t\tthis.cancel(index);\n\t}\n};\n\nPopup.prototype.handleEvent = function(event) {\n\tif(event.type === \&quot;click\&quot;) {\n\t\t// Find out what was clicked on\n\t\tvar info = this.popupInfo(event.target),\n\t\t\tcancelLevel = info.popupLevel - 1;\n\t\t// Don't remove the level that was clicked on if we clicked on a handle\n\t\tif(info.isHandle) {\n\t\t\tcancelLevel++;\n\t\t}\n\t\t// Cancel\n\t\tthis.cancel(cancelLevel);\n\t}\n};\n\n/*\nFind the popup level containing a DOM node. Returns:\npopupLevel: count of the number of nested popups containing the specified element\nisHandle: true if the specified element is within a popup handle\n*/\nPopup.prototype.popupInfo = function(domNode) {\n\tvar isHandle = false,\n\t\tpopupCount = 0,\n\t\tnode = domNode;\n\t// First check ancestors to see if we're within a popup handle\n\twhile(node) {\n\t\tif($tw.utils.hasClass(node,\&quot;tc-popup-handle\&quot;)) {\n\t\t\tisHandle = true;\n\t\t\tpopupCount++;\n\t\t}\n\t\tif($tw.utils.hasClass(node,\&quot;tc-popup-keep\&quot;)) {\n\t\t\tisHandle = true;\n\t\t}\n\t\tnode = node.parentNode;\n\t}\n\t// Then count the number of ancestor popups\n\tnode = domNode;\n\twhile(node) {\n\t\tif($tw.utils.hasClass(node,\&quot;tc-popup\&quot;)) {\n\t\t\tpopupCount++;\n\t\t}\n\t\tnode = node.parentNode;\n\t}\n\tvar info = {\n\t\tpopupLevel: popupCount,\n\t\tisHandle: isHandle\n\t};\n\treturn info;\n};\n\n/*\nDisplay a popup by adding it to the stack\n*/\nPopup.prototype.show = function(options) {\n\t// Find out what was clicked on\n\tvar info = this.popupInfo(options.domNode);\n\t// Cancel any higher level popups\n\tthis.cancel(info.popupLevel);\n\t// Store the popup details\n\tthis.popups.push({\n\t\ttitle: options.title,\n\t\twiki: options.wiki,\n\t\tdomNode: options.domNode\n\t});\n\t// Set the state tiddler\n\toptions.wiki.setTextReference(options.title,\n\t\t\t\&quot;(\&quot; + options.domNode.offsetLeft + \&quot;,\&quot; + options.domNode.offsetTop + \&quot;,\&quot; + \n\t\t\t\toptions.domNode.offsetWidth + \&quot;,\&quot; + options.domNode.offsetHeight + \&quot;)\&quot;);\n\t// Add the click handler if we have any popups\n\tif(this.popups.length &gt; 0) {\n\t\tthis.rootElement.addEventListener(\&quot;click\&quot;,this,true);\t\t\n\t}\n};\n\n/*\nCancel all popups at or above a specified level or DOM node\nlevel: popup level to cancel (0 cancels all popups)\n*/\nPopup.prototype.cancel = function(level) {\n\tvar numPopups = this.popups.length;\n\tlevel = Math.max(0,Math.min(level,numPopups));\n\tfor(var t=level; t&lt;numPopups; t++) {\n\t\tvar popup = this.popups.pop();\n\t\tif(popup.title) {\n\t\t\tpopup.wiki.deleteTiddler(popup.title);\n\t\t}\n\t}\n\tif(this.popups.length === 0) {\n\t\tthis.rootElement.removeEventListener(\&quot;click\&quot;,this,false);\n\t}\n};\n\n/*\nReturns true if the specified title and text identifies an active popup\n*/\nPopup.prototype.readPopupState = function(text) {\n\tvar popupLocationRegExp = /^\\((-?[0-9\\.E]+),(-?[0-9\\.E]+),(-?[0-9\\.E]+),(-?[0-9\\.E]+)\\)$/;\n\treturn popupLocationRegExp.test(text);\n};\n\nexports.Popup = Popup;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/popup.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/dom/scroller.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/dom/scroller.js\ntype: application/javascript\nmodule-type: utils\n\nModule that creates a $tw.utils.Scroller object prototype that manages scrolling in the browser\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nEvent handler for when the `tm-scroll` event hits the document body\n*/\nvar PageScroller = function() {\n\tthis.idRequestFrame = null;\n\tthis.requestAnimationFrame = window.requestAnimationFrame ||\n\t\twindow.webkitRequestAnimationFrame ||\n\t\twindow.mozRequestAnimationFrame ||\n\t\tfunction(callback) {\n\t\t\treturn window.setTimeout(callback, 1000/60);\n\t\t};\n\tthis.cancelAnimationFrame = window.cancelAnimationFrame ||\n\t\twindow.webkitCancelAnimationFrame ||\n\t\twindow.webkitCancelRequestAnimationFrame ||\n\t\twindow.mozCancelAnimationFrame ||\n\t\twindow.mozCancelRequestAnimationFrame ||\n\t\tfunction(id) {\n\t\t\twindow.clearTimeout(id);\n\t\t};\n};\n\nPageScroller.prototype.cancelScroll = function() {\n\tif(this.idRequestFrame) {\n\t\tthis.cancelAnimationFrame.call(window,this.idRequestFrame);\n\t\tthis.idRequestFrame = null;\n\t}\n};\n\n/*\nHandle an event\n*/\nPageScroller.prototype.handleEvent = function(event) {\n\tif(event.type === \&quot;tm-scroll\&quot;) {\n\t\treturn this.scrollIntoView(event.target);\n\t}\n\treturn true;\n};\n\n/*\nHandle a scroll event hitting the page document\n*/\nPageScroller.prototype.scrollIntoView = function(element) {\n\tvar duration = $tw.utils.getAnimationDuration();\n\t// Now get ready to scroll the body\n\tthis.cancelScroll();\n\tthis.startTime = Date.now();\n\tvar scrollPosition = $tw.utils.getScrollPosition();\n\t// Get the client bounds of the element and adjust by the scroll position\n\tvar clientBounds = element.getBoundingClientRect(),\n\t\tbounds = {\n\t\t\tleft: clientBounds.left + scrollPosition.x,\n\t\t\ttop: clientBounds.top + scrollPosition.y,\n\t\t\twidth: clientBounds.width,\n\t\t\theight: clientBounds.height\n\t\t};\n\t// We'll consider the horizontal and vertical scroll directions separately via this function\n\tvar getEndPos = function(targetPos,targetSize,currentPos,currentSize) {\n\t\t\t// If the target is above/left of the current view, then scroll to it's top/left\n\t\t\tif(targetPos &lt;= currentPos) {\n\t\t\t\treturn targetPos;\n\t\t\t// If the target is smaller than the window and the scroll position is too far up, then scroll till the target is at the bottom of the window\n\t\t\t} else if(targetSize &lt; currentSize &amp;&amp; currentPos &lt; (targetPos + targetSize - currentSize)) {\n\t\t\t\treturn targetPos + targetSize - currentSize;\n\t\t\t// If the target is big, then just scroll to the top\n\t\t\t} else if(currentPos &lt; targetPos) {\n\t\t\t\treturn targetPos;\n\t\t\t// Otherwise, stay where we are\n\t\t\t} else {\n\t\t\t\treturn currentPos;\n\t\t\t}\n\t\t},\n\t\tendX = getEndPos(bounds.left,bounds.width,scrollPosition.x,window.innerWidth),\n\t\tendY = getEndPos(bounds.top,bounds.height,scrollPosition.y,window.innerHeight);\n\t// Only scroll if necessary\n\tif(endX !== scrollPosition.x || endY !== scrollPosition.y) {\n\t\tvar self = this,\n\t\t\tdrawFrame;\n\t\tdrawFrame = function () {\n\t\t\tvar t;\n\t\t\tif(duration &lt;= 0) {\n\t\t\t\tt = 1;\n\t\t\t} else {\n\t\t\t\tt = ((Date.now()) - self.startTime) / duration;\t\n\t\t\t}\n\t\t\tif(t &gt;= 1) {\n\t\t\t\tself.cancelScroll();\n\t\t\t\tt = 1;\n\t\t\t}\n\t\t\tt = $tw.utils.slowInSlowOut(t);\n\t\t\twindow.scrollTo(scrollPosition.x + (endX - scrollPosition.x) * t,scrollPosition.y + (endY - scrollPosition.y) * t);\n\t\t\tif(t &lt; 1) {\n\t\t\t\tself.idRequestFrame = self.requestAnimationFrame.call(window,drawFrame);\n\t\t\t}\n\t\t};\n\t\tdrawFrame();\n\t}\n};\n\nexports.PageScroller = PageScroller;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/dom/scroller.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/fakedom.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/fakedom.js\ntype: application/javascript\nmodule-type: global\n\nA barebones implementation of DOM interfaces needed by the rendering mechanism.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Sequence number used to enable us to track objects for testing\nvar sequenceNumber = null;\n\nvar bumpSequenceNumber = function(object) {\n\tif(sequenceNumber !== null) {\n\t\tobject.sequenceNumber = sequenceNumber++;\n\t}\n};\n\nvar TW_TextNode = function(text) {\n\tbumpSequenceNumber(this);\n\tthis.textContent = text;\n};\n\nObject.defineProperty(TW_TextNode.prototype, \&quot;formattedTextContent\&quot;, {\n\tget: function() {\n\t\treturn this.textContent.replace(/(\\r?\\n)/g,\&quot;\&quot;);\n\t}\n});\n\nvar TW_Element = function(tag,namespace) {\n\tbumpSequenceNumber(this);\n\tthis.isTiddlyWikiFakeDom = true;\n\tthis.tag = tag;\n\tthis.attributes = {};\n\tthis.isRaw = false;\n\tthis.children = [];\n\tthis.style = {};\n\tthis.namespaceURI = namespace || \&quot;http://www.w3.org/1999/xhtml\&quot;;\n};\n\nTW_Element.prototype.setAttribute = function(name,value) {\n\tif(this.isRaw) {\n\t\tthrow \&quot;Cannot setAttribute on a raw TW_Element\&quot;;\n\t}\n\tthis.attributes[name] = value;\n};\n\nTW_Element.prototype.setAttributeNS = function(namespace,name,value) {\n\tthis.setAttribute(name,value);\n};\n\nTW_Element.prototype.removeAttribute = function(name) {\n\tif(this.isRaw) {\n\t\tthrow \&quot;Cannot removeAttribute on a raw TW_Element\&quot;;\n\t}\n\tif($tw.utils.hop(this.attributes,name)) {\n\t\tdelete this.attributes[name];\n\t}\n};\n\nTW_Element.prototype.appendChild = function(node) {\n\tthis.children.push(node);\n\tnode.parentNode = this;\n};\n\nTW_Element.prototype.insertBefore = function(node,nextSibling) {\n\tif(nextSibling) {\n\t\tvar p = this.children.indexOf(nextSibling);\n\t\tif(p !== -1) {\n\t\t\tthis.children.splice(p,0,node);\n\t\t\tnode.parentNode = this;\n\t\t} else {\n\t\t\tthis.appendChild(node);\n\t\t}\n\t} else {\n\t\tthis.appendChild(node);\n\t}\n};\n\nTW_Element.prototype.removeChild = function(node) {\n\tvar p = this.children.indexOf(node);\n\tif(p !== -1) {\n\t\tthis.children.splice(p,1);\n\t}\n};\n\nTW_Element.prototype.hasChildNodes = function() {\n\treturn !!this.children.length;\n};\n\nObject.defineProperty(TW_Element.prototype, \&quot;firstChild\&quot;, {\n\tget: function() {\n\t\treturn this.children[0];\n\t}\n});\n\nTW_Element.prototype.addEventListener = function(type,listener,useCapture) {\n\t// Do nothing\n};\n\nObject.defineProperty(TW_Element.prototype, \&quot;className\&quot;, {\n\tget: function() {\n\t\treturn this.attributes[\&quot;class\&quot;] || \&quot;\&quot;;\n\t},\n\tset: function(value) {\n\t\tthis.attributes[\&quot;class\&quot;] = value;\n\t}\n});\n\nObject.defineProperty(TW_Element.prototype, \&quot;value\&quot;, {\n\tget: function() {\n\t\treturn this.attributes.value || \&quot;\&quot;;\n\t},\n\tset: function(value) {\n\t\tthis.attributes.value = value;\n\t}\n});\n\nObject.defineProperty(TW_Element.prototype, \&quot;outerHTML\&quot;, {\n\tget: function() {\n\t\tvar output = [],attr,a,v;\n\t\toutput.push(\&quot;&lt;\&quot;,this.tag);\n\t\tif(this.attributes) {\n\t\t\tattr = [];\n\t\t\tfor(a in this.attributes) {\n\t\t\t\tattr.push(a);\n\t\t\t}\n\t\t\tattr.sort();\n\t\t\tfor(a=0; a&lt;attr.length; a++) {\n\t\t\t\tv = this.attributes[attr[a]];\n\t\t\t\tif(v !== undefined) {\n\t\t\t\t\toutput.push(\&quot; \&quot;,attr[a],\&quot;='\&quot;,$tw.utils.htmlEncode(v),\&quot;'\&quot;);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(this.style) {\n\t\t\tvar style = [];\n\t\t\tfor(var s in this.style) {\n\t\t\t\tstyle.push(s + \&quot;:\&quot; + this.style[s] + \&quot;;\&quot;);\n\t\t\t}\n\t\t\tif(style.length &gt; 0) {\n\t\t\t\toutput.push(\&quot; style='\&quot;,style.join(\&quot;\&quot;),\&quot;'\&quot;)\n\t\t\t}\n\t\t}\n\t\toutput.push(\&quot;&gt;\&quot;);\n\t\tif($tw.config.htmlVoidElements.indexOf(this.tag) === -1) {\n\t\t\toutput.push(this.innerHTML);\n\t\t\toutput.push(\&quot;&lt;/\&quot;,this.tag,\&quot;&gt;\&quot;);\n\t\t}\n\t\treturn output.join(\&quot;\&quot;);\n\t}\n});\n\nObject.defineProperty(TW_Element.prototype, \&quot;innerHTML\&quot;, {\n\tget: function() {\n\t\tif(this.isRaw) {\n\t\t\treturn this.rawHTML;\n\t\t} else {\n\t\t\tvar b = [];\n\t\t\t$tw.utils.each(this.children,function(node) {\n\t\t\t\tif(node instanceof TW_Element) {\n\t\t\t\t\tb.push(node.outerHTML);\n\t\t\t\t} else if(node instanceof TW_TextNode) {\n\t\t\t\t\tb.push($tw.utils.htmlEncode(node.textContent));\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn b.join(\&quot;\&quot;);\n\t\t}\n\t},\n\tset: function(value) {\n\t\tthis.isRaw = true;\n\t\tthis.rawHTML = value;\n\t}\n});\n\nObject.defineProperty(TW_Element.prototype, \&quot;textContent\&quot;, {\n\tget: function() {\n\t\tif(this.isRaw) {\n\t\t\tthrow \&quot;Cannot get textContent on a raw TW_Element\&quot;;\n\t\t} else {\n\t\t\tvar b = [];\n\t\t\t$tw.utils.each(this.children,function(node) {\n\t\t\t\tb.push(node.textContent);\n\t\t\t});\n\t\t\treturn b.join(\&quot;\&quot;);\n\t\t}\n\t},\n\tset: function(value) {\n\t\tthis.children = [new TW_TextNode(value)];\n\t}\n});\n\nObject.defineProperty(TW_Element.prototype, \&quot;formattedTextContent\&quot;, {\n\tget: function() {\n\t\tif(this.isRaw) {\n\t\t\tthrow \&quot;Cannot get formattedTextContent on a raw TW_Element\&quot;;\n\t\t} else {\n\t\t\tvar b = [],\n\t\t\t\tisBlock = $tw.config.htmlBlockElements.indexOf(this.tag) !== -1;\n\t\t\tif(isBlock) {\n\t\t\t\tb.push(\&quot;\\n\&quot;);\n\t\t\t}\n\t\t\tif(this.tag === \&quot;li\&quot;) {\n\t\t\t\tb.push(\&quot;* \&quot;);\n\t\t\t}\n\t\t\t$tw.utils.each(this.children,function(node) {\n\t\t\t\tb.push(node.formattedTextContent);\n\t\t\t});\n\t\t\tif(isBlock) {\n\t\t\t\tb.push(\&quot;\\n\&quot;);\n\t\t\t}\n\t\t\treturn b.join(\&quot;\&quot;);\n\t\t}\n\t}\n});\n\nvar document = {\n\tsetSequenceNumber: function(value) {\n\t\tsequenceNumber = value;\n\t},\n\tcreateElementNS: function(namespace,tag) {\n\t\treturn new TW_Element(tag,namespace);\n\t},\n\tcreateElement: function(tag) {\n\t\treturn new TW_Element(tag);\n\t},\n\tcreateTextNode: function(text) {\n\t\treturn new TW_TextNode(text);\n\t},\n\tcompatMode: \&quot;CSS1Compat\&quot;, // For KaTeX to know that we're not a browser in quirks mode\n\tisTiddlyWikiFakeDom: true\n};\n\nexports.fakeDocument = document;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/fakedom.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;global&quot;
        },
        &quot;$:/core/modules/utils/filesystem.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/filesystem.js\ntype: application/javascript\nmodule-type: utils-node\n\nFile system utilities\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar fs = require(\&quot;fs\&quot;),\n\tpath = require(\&quot;path\&quot;);\n\n/*\nRecursively (and synchronously) copy a directory and all its content\n*/\nexports.copyDirectory = function(srcPath,dstPath) {\n\t// Remove any trailing path separators\n\tsrcPath = $tw.utils.removeTrailingSeparator(srcPath);\n\tdstPath = $tw.utils.removeTrailingSeparator(dstPath);\n\t// Create the destination directory\n\tvar err = $tw.utils.createDirectory(dstPath);\n\tif(err) {\n\t\treturn err;\n\t}\n\t// Function to copy a folder full of files\n\tvar copy = function(srcPath,dstPath) {\n\t\tvar srcStats = fs.lstatSync(srcPath),\n\t\t\tdstExists = fs.existsSync(dstPath);\n\t\tif(srcStats.isFile()) {\n\t\t\t$tw.utils.copyFile(srcPath,dstPath);\n\t\t} else if(srcStats.isDirectory()) {\n\t\t\tvar items = fs.readdirSync(srcPath);\n\t\t\tfor(var t=0; t&lt;items.length; t++) {\n\t\t\t\tvar item = items[t],\n\t\t\t\t\terr = copy(srcPath + path.sep + item,dstPath + path.sep + item);\n\t\t\t\tif(err) {\n\t\t\t\t\treturn err;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tcopy(srcPath,dstPath);\n\treturn null;\n};\n\n/*\nCopy a file\n*/\nvar FILE_BUFFER_LENGTH = 64 * 1024,\n\tfileBuffer;\n\nexports.copyFile = function(srcPath,dstPath) {\n\t// Create buffer if required\n\tif(!fileBuffer) {\n\t\tfileBuffer = new Buffer(FILE_BUFFER_LENGTH);\n\t}\n\t// Create any directories in the destination\n\t$tw.utils.createDirectory(path.dirname(dstPath));\n\t// Copy the file\n\tvar srcFile = fs.openSync(srcPath,\&quot;r\&quot;),\n\t\tdstFile = fs.openSync(dstPath,\&quot;w\&quot;),\n\t\tbytesRead = 1,\n\t\tpos = 0;\n\twhile (bytesRead &gt; 0) {\n\t\tbytesRead = fs.readSync(srcFile,fileBuffer,0,FILE_BUFFER_LENGTH,pos);\n\t\tfs.writeSync(dstFile,fileBuffer,0,bytesRead);\n\t\tpos += bytesRead;\n\t}\n\tfs.closeSync(srcFile);\n\tfs.closeSync(dstFile);\n\treturn null;\n};\n\n/*\nRemove trailing path separator\n*/\nexports.removeTrailingSeparator = function(dirPath) {\n\tvar len = dirPath.length;\n\tif(dirPath.charAt(len-1) === path.sep) {\n\t\tdirPath = dirPath.substr(0,len-1);\n\t}\n\treturn dirPath;\n};\n\n/*\nRecursively create a directory\n*/\nexports.createDirectory = function(dirPath) {\n\tif(dirPath.substr(dirPath.length-1,1) !== path.sep) {\n\t\tdirPath = dirPath + path.sep;\n\t}\n\tvar pos = 1;\n\tpos = dirPath.indexOf(path.sep,pos);\n\twhile(pos !== -1) {\n\t\tvar subDirPath = dirPath.substr(0,pos);\n\t\tif(!$tw.utils.isDirectory(subDirPath)) {\n\t\t\ttry {\n\t\t\t\tfs.mkdirSync(subDirPath);\n\t\t\t} catch(e) {\n\t\t\t\treturn \&quot;Error creating directory '\&quot; + subDirPath + \&quot;'\&quot;;\n\t\t\t}\n\t\t}\n\t\tpos = dirPath.indexOf(path.sep,pos + 1);\n\t}\n\treturn null;\n};\n\n/*\nRecursively create directories needed to contain a specified file\n*/\nexports.createFileDirectories = function(filePath) {\n\treturn $tw.utils.createDirectory(path.dirname(filePath));\n};\n\n/*\nRecursively delete a directory\n*/\nexports.deleteDirectory = function(dirPath) {\n\tif(fs.existsSync(dirPath)) {\n\t\tvar entries = fs.readdirSync(dirPath);\n\t\tfor(var entryIndex=0; entryIndex&lt;entries.length; entryIndex++) {\n\t\t\tvar currPath = dirPath + path.sep + entries[entryIndex];\n\t\t\tif(fs.lstatSync(currPath).isDirectory()) {\n\t\t\t\t$tw.utils.deleteDirectory(currPath);\n\t\t\t} else {\n\t\t\t\tfs.unlinkSync(currPath);\n\t\t\t}\n\t\t}\n\tfs.rmdirSync(dirPath);\n\t}\n\treturn null;\n};\n\n/*\nCheck if a path identifies a directory\n*/\nexports.isDirectory = function(dirPath) {\n\treturn fs.existsSync(dirPath) &amp;&amp; fs.statSync(dirPath).isDirectory();\n};\n\n/*\nCheck if a path identifies a directory that is empty\n*/\nexports.isDirectoryEmpty = function(dirPath) {\n\tif(!$tw.utils.isDirectory(dirPath)) {\n\t\treturn false;\n\t}\n\tvar files = fs.readdirSync(dirPath),\n\t\tempty = true;\n\t$tw.utils.each(files,function(file,index) {\n\t\tif(file.charAt(0) !== \&quot;.\&quot;) {\n\t\t\tempty = false;\n\t\t}\n\t});\n\treturn empty;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/filesystem.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils-node&quot;
        },
        &quot;$:/core/modules/utils/logger.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/logger.js\ntype: application/javascript\nmodule-type: utils\n\nA basic logging implementation\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar ALERT_TAG = \&quot;$:/tags/Alert\&quot;;\n\n/*\nMake a new logger\n*/\nfunction Logger(componentName) {\n\tthis.componentName = componentName || \&quot;\&quot;;\n}\n\n/*\nLog a message\n*/\nLogger.prototype.log = function(/* args */) {\n\tif(console !== undefined &amp;&amp; console.log !== undefined) {\n\t\treturn Function.apply.call(console.log, console, [this.componentName + \&quot;:\&quot;].concat(Array.prototype.slice.call(arguments,0)));\n\t}\n};\n\n/*\nAlert a message\n*/\nLogger.prototype.alert = function(/* args */) {\n\t// Prepare the text of the alert\n\tvar text = Array.prototype.join.call(arguments,\&quot; \&quot;);\n\t// Check if there is an existing alert with the same text and the same component\n\tvar existingAlerts = $tw.wiki.getTiddlersWithTag(ALERT_TAG),\n\t\talertFields,\n\t\texistingCount,\n\t\tself = this;\n\t$tw.utils.each(existingAlerts,function(title) {\n\t\tvar tiddler = $tw.wiki.getTiddler(title);\n\t\tif(tiddler.fields.text === text &amp;&amp; tiddler.fields.component === self.componentName &amp;&amp; tiddler.fields.modified &amp;&amp; (!alertFields || tiddler.fields.modified &lt; alertFields.modified)) {\n\t\t\t\talertFields = $tw.utils.extend({},tiddler.fields);\n\t\t}\n\t});\n\tif(alertFields) {\n\t\texistingCount = alertFields.count || 1;\n\t} else {\n\t\talertFields = {\n\t\t\ttitle: $tw.wiki.generateNewTitle(\&quot;$:/temp/alerts/alert\&quot;,{prefix: \&quot;\&quot;}),\n\t\t\ttext: text,\n\t\t\ttags: [ALERT_TAG],\n\t\t\tcomponent: this.componentName\n\t\t};\n\t\texistingCount = 0;\n\t}\n\talertFields.modified = new Date();\n\tif(++existingCount &gt; 1) {\n\t\talertFields.count = existingCount;\n\t} else {\n\t\talertFields.count = undefined;\n\t}\n\t$tw.wiki.addTiddler(new $tw.Tiddler(alertFields));\n\t// Log it too\n\tthis.log.apply(this,Array.prototype.slice.call(arguments,0));\n};\n\nexports.Logger = Logger;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/logger.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/parsetree.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/parsetree.js\ntype: application/javascript\nmodule-type: utils\n\nParse tree utility functions.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nexports.addAttributeToParseTreeNode = function(node,name,value) {\n\tnode.attributes = node.attributes || {};\n\tnode.attributes[name] = {type: \&quot;string\&quot;, value: value};\n};\n\nexports.getAttributeValueFromParseTreeNode = function(node,name,defaultValue) {\n\tif(node.attributes &amp;&amp; node.attributes[name] &amp;&amp; node.attributes[name].value !== undefined) {\n\t\treturn node.attributes[name].value;\n\t}\n\treturn defaultValue;\n};\n\nexports.addClassToParseTreeNode = function(node,classString) {\n\tvar classes = [];\n\tnode.attributes = node.attributes || {};\n\tnode.attributes[\&quot;class\&quot;] = node.attributes[\&quot;class\&quot;] || {type: \&quot;string\&quot;, value: \&quot;\&quot;};\n\tif(node.attributes[\&quot;class\&quot;].type === \&quot;string\&quot;) {\n\t\tif(node.attributes[\&quot;class\&quot;].value !== \&quot;\&quot;) {\n\t\t\tclasses = node.attributes[\&quot;class\&quot;].value.split(\&quot; \&quot;);\n\t\t}\n\t\tif(classString !== \&quot;\&quot;) {\n\t\t\t$tw.utils.pushTop(classes,classString.split(\&quot; \&quot;));\n\t\t}\n\t\tnode.attributes[\&quot;class\&quot;].value = classes.join(\&quot; \&quot;);\n\t}\n};\n\nexports.addStyleToParseTreeNode = function(node,name,value) {\n\t\tnode.attributes = node.attributes || {};\n\t\tnode.attributes.style = node.attributes.style || {type: \&quot;string\&quot;, value: \&quot;\&quot;};\n\t\tif(node.attributes.style.type === \&quot;string\&quot;) {\n\t\t\tnode.attributes.style.value += name + \&quot;:\&quot; + value + \&quot;;\&quot;;\n\t\t}\n};\n\nexports.findParseTreeNode = function(nodeArray,search) {\n\tfor(var t=0; t&lt;nodeArray.length; t++) {\n\t\tif(nodeArray[t].type === search.type &amp;&amp; nodeArray[t].tag === search.tag) {\n\t\t\treturn nodeArray[t];\n\t\t}\n\t}\n\treturn undefined;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/parsetree.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/performance.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/performance.js\ntype: application/javascript\nmodule-type: global\n\nPerformance measurement.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nfunction Performance(enabled) {\n\tthis.enabled = !!enabled;\n\tthis.measures = {}; // Hashmap of current values of measurements\n\tthis.logger = new $tw.utils.Logger(\&quot;performance\&quot;);\n}\n\n/*\nWrap performance reporting around a top level function\n*/\nPerformance.prototype.report = function(name,fn) {\n\tvar self = this;\n\tif(this.enabled) {\n\t\treturn function() {\n\t\t\tself.measures = {};\n\t\t\tvar startTime = $tw.utils.timer(),\n\t\t\t\tresult = fn.apply(this,arguments);\n\t\t\tself.logger.log(name + \&quot;: \&quot; + $tw.utils.timer(startTime) + \&quot;ms\&quot;);\n\t\t\tfor(var m in self.measures) {\n\t\t\t\tself.logger.log(\&quot;+\&quot; + m + \&quot;: \&quot; + self.measures[m] + \&quot;ms\&quot;);\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\t} else {\n\t\treturn fn;\n\t}\n};\n\n/*\nWrap performance measurements around a subfunction\n*/\nPerformance.prototype.measure = function(name,fn) {\n\tvar self = this;\n\tif(this.enabled) {\n\t\treturn function() {\n\t\t\tvar startTime = $tw.utils.timer(),\n\t\t\t\tresult = fn.apply(this,arguments),\n\t\t\t\tvalue = self.measures[name] || 0;\n\t\t\tself.measures[name] = value + $tw.utils.timer(startTime);\n\t\t\treturn result;\n\t\t};\n\t} else {\n\t\treturn fn;\n\t}\n};\n\nexports.Performance = Performance;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/performance.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;global&quot;
        },
        &quot;$:/core/modules/utils/pluginmaker.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/pluginmaker.js\ntype: application/javascript\nmodule-type: utils\n\nA quick and dirty way to pack up plugins within the browser.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nRepack a plugin, and then delete any non-shadow payload tiddlers\n*/\nexports.repackPlugin = function(title,additionalTiddlers,excludeTiddlers) {\n\tadditionalTiddlers = additionalTiddlers || [];\n\texcludeTiddlers = excludeTiddlers || [];\n\t// Get the plugin tiddler\n\tvar pluginTiddler = $tw.wiki.getTiddler(title);\n\tif(!pluginTiddler) {\n\t\tthrow \&quot;No such tiddler as \&quot; + title;\n\t}\n\t// Extract the JSON\n\tvar jsonPluginTiddler;\n\ttry {\n\t\tjsonPluginTiddler = JSON.parse(pluginTiddler.fields.text);\n\t} catch(e) {\n\t\tthrow \&quot;Cannot parse plugin tiddler \&quot; + title + \&quot;\\nError: \&quot; + e;\n\t}\n\t// Get the list of tiddlers\n\tvar tiddlers = Object.keys(jsonPluginTiddler.tiddlers);\n\t// Add the additional tiddlers\n\t$tw.utils.pushTop(tiddlers,additionalTiddlers);\n\t// Remove any excluded tiddlers\n\tfor(var t=tiddlers.length-1; t&gt;=0; t--) {\n\t\tif(excludeTiddlers.indexOf(tiddlers[t]) !== -1) {\n\t\t\ttiddlers.splice(t,1);\n\t\t}\n\t}\n\t// Pack up the tiddlers into a block of JSON\n\tvar plugins = {};\n\t$tw.utils.each(tiddlers,function(title) {\n\t\tvar tiddler = $tw.wiki.getTiddler(title),\n\t\t\tfields = {};\n\t\t$tw.utils.each(tiddler.fields,function (value,name) {\n\t\t\tfields[name] = tiddler.getFieldString(name);\n\t\t});\n\t\tplugins[title] = fields;\n\t});\n\t// Retrieve and bump the version number\n\tvar pluginVersion = $tw.utils.parseVersion(pluginTiddler.getFieldString(\&quot;version\&quot;) || \&quot;0.0.0\&quot;) || {\n\t\t\tmajor: \&quot;0\&quot;,\n\t\t\tminor: \&quot;0\&quot;,\n\t\t\tpatch: \&quot;0\&quot;\n\t\t};\n\tpluginVersion.patch++;\n\tvar version = pluginVersion.major + \&quot;.\&quot; + pluginVersion.minor + \&quot;.\&quot; + pluginVersion.patch;\n\tif(pluginVersion.prerelease) {\n\t\tversion += \&quot;-\&quot; + pluginVersion.prerelease;\n\t}\n\tif(pluginVersion.build) {\n\t\tversion += \&quot;+\&quot; + pluginVersion.build;\n\t}\n\t// Save the tiddler\n\t$tw.wiki.addTiddler(new $tw.Tiddler(pluginTiddler,{text: JSON.stringify({tiddlers: plugins},null,4), version: version}));\n\t// Delete any non-shadow constituent tiddlers\n\t$tw.utils.each(tiddlers,function(title) {\n\t\tif($tw.wiki.tiddlerExists(title)) {\n\t\t\t$tw.wiki.deleteTiddler(title);\n\t\t}\n\t});\n\t// Trigger an autosave\n\t$tw.rootWidget.dispatchEvent({type: \&quot;tm-auto-save-wiki\&quot;});\n\t// Return a heartwarming confirmation\n\treturn \&quot;Plugin \&quot; + title + \&quot; successfully saved\&quot;;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/pluginmaker.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/utils/utils.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/utils/utils.js\ntype: application/javascript\nmodule-type: utils\n\nVarious static utility functions.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nDisplay a warning, in colour if we're on a terminal\n*/\nexports.warning = function(text) {\n\tconsole.log($tw.node ? \&quot;\\x1b[1;33m\&quot; + text + \&quot;\\x1b[0m\&quot; : text);\n}\n\n/*\nTrim whitespace from the start and end of a string\nThanks to Steven Levithan, http://blog.stevenlevithan.com/archives/faster-trim-javascript\n*/\nexports.trim = function(str) {\n\tif(typeof str === \&quot;string\&quot;) {\n\t\treturn str.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n\t} else {\n\t\treturn str;\n\t}\n};\n\n/*\nReturn the number of keys in an object\n*/\nexports.count = function(object) {\n\tvar s = 0;\n\t$tw.utils.each(object,function() {s++;});\n\treturn s;\n};\n\n/*\nCheck if an array is equal by value and by reference.\n*/\nexports.isArrayEqual = function(array1,array2) {\n\tif(array1 === array2) {\n\t\treturn true;\n\t}\n\tarray1 = array1 || [];\n\tarray2 = array2 || [];\n\tif(array1.length !== array2.length) {\n\t\treturn false;\n\t}\n\treturn array1.every(function(value,index) {\n\t\treturn value === array2[index];\n\t});\n};\n\n/*\nPush entries onto an array, removing them first if they already exist in the array\n\tarray: array to modify (assumed to be free of duplicates)\n\tvalue: a single value to push or an array of values to push\n*/\nexports.pushTop = function(array,value) {\n\tvar t,p;\n\tif($tw.utils.isArray(value)) {\n\t\t// Remove any array entries that are duplicated in the new values\n\t\tif(value.length !== 0) {\n\t\t\tif(array.length !== 0) {\n\t\t\t\tif(value.length &lt; array.length) {\n\t\t\t\t\tfor(t=0; t&lt;value.length; t++) {\n\t\t\t\t\t\tp = array.indexOf(value[t]);\n\t\t\t\t\t\tif(p !== -1) {\n\t\t\t\t\t\t\tarray.splice(p,1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor(t=array.length-1; t&gt;=0; t--) {\n\t\t\t\t\t\tp = value.indexOf(array[t]);\n\t\t\t\t\t\tif(p !== -1) {\n\t\t\t\t\t\t\tarray.splice(t,1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Push the values on top of the main array\n\t\t\tarray.push.apply(array,value);\n\t\t}\n\t} else {\n\t\tp = array.indexOf(value);\n\t\tif(p !== -1) {\n\t\t\tarray.splice(p,1);\n\t\t}\n\t\tarray.push(value);\n\t}\n\treturn array;\n};\n\n/*\nRemove entries from an array\n\tarray: array to modify\n\tvalue: a single value to remove, or an array of values to remove\n*/\nexports.removeArrayEntries = function(array,value) {\n\tvar t,p;\n\tif($tw.utils.isArray(value)) {\n\t\tfor(t=0; t&lt;value.length; t++) {\n\t\t\tp = array.indexOf(value[t]);\n\t\t\tif(p !== -1) {\n\t\t\t\tarray.splice(p,1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tp = array.indexOf(value);\n\t\tif(p !== -1) {\n\t\t\tarray.splice(p,1);\n\t\t}\n\t}\n};\n\n/*\nCheck whether any members of a hashmap are present in another hashmap\n*/\nexports.checkDependencies = function(dependencies,changes) {\n\tvar hit = false;\n\t$tw.utils.each(changes,function(change,title) {\n\t\tif($tw.utils.hop(dependencies,title)) {\n\t\t\thit = true;\n\t\t}\n\t});\n\treturn hit;\n};\n\nexports.extend = function(object /* [, src] */) {\n\t$tw.utils.each(Array.prototype.slice.call(arguments, 1), function(source) {\n\t\tif(source) {\n\t\t\tfor(var property in source) {\n\t\t\t\tobject[property] = source[property];\n\t\t\t}\n\t\t}\n\t});\n\treturn object;\n};\n\nexports.deepCopy = function(object) {\n\tvar result,t;\n\tif($tw.utils.isArray(object)) {\n\t\t// Copy arrays\n\t\tresult = object.slice(0);\n\t} else if(typeof object === \&quot;object\&quot;) {\n\t\tresult = {};\n\t\tfor(t in object) {\n\t\t\tif(object[t] !== undefined) {\n\t\t\t\tresult[t] = $tw.utils.deepCopy(object[t]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tresult = object;\n\t}\n\treturn result;\n};\n\nexports.extendDeepCopy = function(object,extendedProperties) {\n\tvar result = $tw.utils.deepCopy(object),t;\n\tfor(t in extendedProperties) {\n\t\tif(extendedProperties[t] !== undefined) {\n\t\t\tresult[t] = $tw.utils.deepCopy(extendedProperties[t]);\n\t\t}\n\t}\n\treturn result;\n};\n\nexports.slowInSlowOut = function(t) {\n\treturn (1 - ((Math.cos(t * Math.PI) + 1) / 2));\n};\n\nexports.formatDateString = function(date,template) {\n\tvar result = \&quot;\&quot;,\n\t\tt = template,\n\t\tmatches = [\n\t\t\t[/^0hh12/, function() {\n\t\t\t\treturn $tw.utils.pad($tw.utils.getHours12(date));\n\t\t\t}],\n\t\t\t[/^wYYYY/, function() {\n\t\t\t\treturn $tw.utils.getYearForWeekNo(date);\n\t\t\t}],\n\t\t\t[/^hh12/, function() {\n\t\t\t\treturn $tw.utils.getHours12(date);\n\t\t\t}],\n\t\t\t[/^DDth/, function() {\n\t\t\t\treturn date.getDate() + $tw.utils.getDaySuffix(date);\n\t\t\t}],\n\t\t\t[/^YYYY/, function() {\n\t\t\t\treturn date.getFullYear();\n\t\t\t}],\n\t\t\t[/^0hh/, function() {\n\t\t\t\treturn $tw.utils.pad(date.getHours());\n\t\t\t}],\n\t\t\t[/^0mm/, function() {\n\t\t\t\treturn $tw.utils.pad(date.getMinutes());\n\t\t\t}],\n\t\t\t[/^0ss/, function() {\n\t\t\t\treturn $tw.utils.pad(date.getSeconds());\n\t\t\t}],\n\t\t\t[/^0DD/, function() {\n\t\t\t\treturn $tw.utils.pad(date.getDate());\n\t\t\t}],\n\t\t\t[/^0MM/, function() {\n\t\t\t\treturn $tw.utils.pad(date.getMonth()+1);\n\t\t\t}],\n\t\t\t[/^0WW/, function() {\n\t\t\t\treturn $tw.utils.pad($tw.utils.getWeek(date));\n\t\t\t}],\n\t\t\t[/^ddd/, function() {\n\t\t\t\treturn $tw.language.getString(\&quot;Date/Short/Day/\&quot; + date.getDay());\n\t\t\t}],\n\t\t\t[/^mmm/, function() {\n\t\t\t\treturn $tw.language.getString(\&quot;Date/Short/Month/\&quot; + (date.getMonth() + 1));\n\t\t\t}],\n\t\t\t[/^DDD/, function() {\n\t\t\t\treturn $tw.language.getString(\&quot;Date/Long/Day/\&quot; + date.getDay());\n\t\t\t}],\n\t\t\t[/^MMM/, function() {\n\t\t\t\treturn $tw.language.getString(\&quot;Date/Long/Month/\&quot; + (date.getMonth() + 1));\n\t\t\t}],\n\t\t\t[/^TZD/, function() {\n\t\t\t\tvar tz = date.getTimezoneOffset(),\n\t\t\t\tatz = Math.abs(tz);\n\t\t\t\treturn (tz &lt; 0 ? '+' : '-') + $tw.utils.pad(Math.floor(atz / 60)) + ':' + $tw.utils.pad(atz % 60);\n\t\t\t}],\n\t\t\t[/^wYY/, function() {\n\t\t\t\treturn $tw.utils.pad($tw.utils.getYearForWeekNo(date) - 2000);\n\t\t\t}],\n\t\t\t[/^[ap]m/, function() {\n\t\t\t\treturn $tw.utils.getAmPm(date).toLowerCase();\n\t\t\t}],\n\t\t\t[/^hh/, function() {\n\t\t\t\treturn date.getHours();\n\t\t\t}],\n\t\t\t[/^mm/, function() {\n\t\t\t\treturn date.getMinutes();\n\t\t\t}],\n\t\t\t[/^ss/, function() {\n\t\t\t\treturn date.getSeconds();\n\t\t\t}],\n\t\t\t[/^[AP]M/, function() {\n\t\t\t\treturn $tw.utils.getAmPm(date).toUpperCase();\n\t\t\t}],\n\t\t\t[/^DD/, function() {\n\t\t\t\treturn date.getDate();\n\t\t\t}],\n\t\t\t[/^MM/, function() {\n\t\t\t\treturn date.getMonth() + 1;\n\t\t\t}],\n\t\t\t[/^WW/, function() {\n\t\t\t\treturn $tw.utils.getWeek(date);\n\t\t\t}],\n\t\t\t[/^YY/, function() {\n\t\t\t\treturn $tw.utils.pad(date.getFullYear() - 2000);\n\t\t\t}]\n\t\t];\n\twhile(t.length){\n\t\tvar matchString = \&quot;\&quot;;\n\t\t$tw.utils.each(matches, function(m) {\n\t\t\tvar match = m[0].exec(t);\n\t\t\tif(match) {\n\t\t\t\tmatchString = m[1].call();\n\t\t\t\tt = t.substr(match[0].length);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tif(matchString) {\n\t\t\tresult += matchString;\n\t\t} else {\n\t\t\tresult += t.charAt(0);\n\t\t\tt = t.substr(1);\n\t\t}\n\t}\n\tresult = result.replace(/\\\\(.)/g,\&quot;$1\&quot;);\n\treturn result;\n};\n\nexports.getAmPm = function(date) {\n\treturn $tw.language.getString(\&quot;Date/Period/\&quot; + (date.getHours() &gt;= 12 ? \&quot;pm\&quot; : \&quot;am\&quot;));\n};\n\nexports.getDaySuffix = function(date) {\n\treturn $tw.language.getString(\&quot;Date/DaySuffix/\&quot; + date.getDate());\n};\n\nexports.getWeek = function(date) {\n\tvar dt = new Date(date.getTime());\n\tvar d = dt.getDay();\n\tif(d === 0) {\n\t\td = 7; // JavaScript Sun=0, ISO Sun=7\n\t}\n\tdt.setTime(dt.getTime() + (4 - d) * 86400000);// shift day to Thurs of same week to calculate weekNo\n\tvar n = Math.floor((dt.getTime()-new Date(dt.getFullYear(),0,1) + 3600000) / 86400000);\n\treturn Math.floor(n / 7) + 1;\n};\n\nexports.getYearForWeekNo = function(date) {\n\tvar dt = new Date(date.getTime());\n\tvar d = dt.getDay();\n\tif(d === 0) {\n\t\td = 7; // JavaScript Sun=0, ISO Sun=7\n\t}\n\tdt.setTime(dt.getTime() + (4 - d) * 86400000);// shift day to Thurs of same week\n\treturn dt.getFullYear();\n};\n\nexports.getHours12 = function(date) {\n\tvar h = date.getHours();\n\treturn h &gt; 12 ? h-12 : ( h &gt; 0 ? h : 12 );\n};\n\n/*\nConvert a date delta in milliseconds into a string representation of \&quot;23 seconds ago\&quot;, \&quot;27 minutes ago\&quot; etc.\n\tdelta: delta in milliseconds\nReturns an object with these members:\n\tdescription: string describing the delta period\n\tupdatePeriod: time in millisecond until the string will be inaccurate\n*/\nexports.getRelativeDate = function(delta) {\n\tvar futurep = false;\n\tif(delta &lt; 0) {\n\t\tdelta = -1 * delta;\n\t\tfuturep = true;\n\t}\n\tvar units = [\n\t\t{name: \&quot;Years\&quot;,   duration:      365 * 24 * 60 * 60 * 1000},\n\t\t{name: \&quot;Months\&quot;,  duration: (365/12) * 24 * 60 * 60 * 1000},\n\t\t{name: \&quot;Days\&quot;,    duration:            24 * 60 * 60 * 1000},\n\t\t{name: \&quot;Hours\&quot;,   duration:                 60 * 60 * 1000},\n\t\t{name: \&quot;Minutes\&quot;, duration:                      60 * 1000},\n\t\t{name: \&quot;Seconds\&quot;, duration:                           1000}\n\t];\n\tfor(var t=0; t&lt;units.length; t++) {\n\t\tvar result = Math.floor(delta / units[t].duration);\n\t\tif(result &gt;= 2) {\n\t\t\treturn {\n\t\t\t\tdelta: delta,\n\t\t\t\tdescription: $tw.language.getString(\n\t\t\t\t\t\&quot;RelativeDate/\&quot; + (futurep ? \&quot;Future\&quot; : \&quot;Past\&quot;) + \&quot;/\&quot; + units[t].name,\n\t\t\t\t\t{variables:\n\t\t\t\t\t\t{period: result.toString()}\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t\tupdatePeriod: units[t].duration\n\t\t\t};\n\t\t}\n\t}\n\treturn {\n\t\tdelta: delta,\n\t\tdescription: $tw.language.getString(\n\t\t\t\&quot;RelativeDate/\&quot; + (futurep ? \&quot;Future\&quot; : \&quot;Past\&quot;) + \&quot;/Second\&quot;,\n\t\t\t{variables:\n\t\t\t\t{period: \&quot;1\&quot;}\n\t\t\t}\n\t\t),\n\t\tupdatePeriod: 1000\n\t};\n};\n\n// Convert &amp; to \&quot;&amp;amp;\&quot;, &lt; to \&quot;&amp;lt;\&quot;, &gt; to \&quot;&amp;gt;\&quot; and \&quot; to \&quot;&amp;quot;\&quot;\nexports.htmlEncode = function(s) {\n\tif(s) {\n\t\treturn s.toString().replace(/&amp;/mg,\&quot;&amp;amp;\&quot;).replace(/&lt;/mg,\&quot;&amp;lt;\&quot;).replace(/&gt;/mg,\&quot;&amp;gt;\&quot;).replace(/\\\&quot;/mg,\&quot;&amp;quot;\&quot;);\n\t} else {\n\t\treturn \&quot;\&quot;;\n\t}\n};\n\n// Converts all HTML entities to their character equivalents\nexports.entityDecode = function(s) {\n\tvar e = s.substr(1,s.length-2); // Strip the &amp; and the ;\n\tif(e.charAt(0) === \&quot;#\&quot;) {\n\t\tif(e.charAt(1) === \&quot;x\&quot; || e.charAt(1) === \&quot;X\&quot;) {\n\t\t\treturn String.fromCharCode(parseInt(e.substr(2),16));\t\n\t\t} else {\n\t\t\treturn String.fromCharCode(parseInt(e.substr(1),10));\n\t\t}\n\t} else {\n\t\tvar c = $tw.config.htmlEntities[e];\n\t\tif(c) {\n\t\t\treturn String.fromCharCode(c);\n\t\t} else {\n\t\t\treturn s; // Couldn't convert it as an entity, just return it raw\n\t\t}\n\t}\n};\n\nexports.unescapeLineBreaks = function(s) {\n\treturn s.replace(/\\\\n/mg,\&quot;\\n\&quot;).replace(/\\\\b/mg,\&quot; \&quot;).replace(/\\\\s/mg,\&quot;\\\\\&quot;).replace(/\\r/mg,\&quot;\&quot;);\n};\n\n/*\n * Returns an escape sequence for given character. Uses \\x for characters &lt;=\n * 0xFF to save space, \\u for the rest.\n *\n * The code needs to be in sync with th code template in the compilation\n * function for \&quot;action\&quot; nodes.\n */\n// Copied from peg.js, thanks to David Majda\nexports.escape = function(ch) {\n\tvar charCode = ch.charCodeAt(0);\n\tif(charCode &lt;= 0xFF) {\n\t\treturn '\\\\x' + $tw.utils.pad(charCode.toString(16).toUpperCase());\n\t} else {\n\t\treturn '\\\\u' + $tw.utils.pad(charCode.toString(16).toUpperCase(),4);\n\t}\n};\n\n// Turns a string into a legal JavaScript string\n// Copied from peg.js, thanks to David Majda\nexports.stringify = function(s) {\n\t/*\n\t* ECMA-262, 5th ed., 7.8.4: All characters may appear literally in a string\n\t* literal except for the closing quote character, backslash, carriage return,\n\t* line separator, paragraph separator, and line feed. Any character may\n\t* appear in the form of an escape sequence.\n\t*\n\t* For portability, we also escape escape all non-ASCII characters.\n\t*/\n\treturn s\n\t\t.replace(/\\\\/g, '\\\\\\\\')            // backslash\n\t\t.replace(/\&quot;/g, '\\\\\&quot;')              // double quote character\n\t\t.replace(/'/g, \&quot;\\\\'\&quot;)              // single quote character\n\t\t.replace(/\\r/g, '\\\\r')             // carriage return\n\t\t.replace(/\\n/g, '\\\\n')             // line feed\n\t\t.replace(/[\\x80-\\uFFFF]/g, exports.escape); // non-ASCII characters\n};\n\n/*\nEscape the RegExp special characters with a preceding backslash\n*/\nexports.escapeRegExp = function(s) {\n    return s.replace(/[\\-\\/\\\\\\^\\$\\*\\+\\?\\.\\(\\)\\|\\[\\]\\{\\}]/g, '\\\\$&amp;');\n};\n\nexports.nextTick = function(fn) {\n/*global window: false */\n\tif(typeof window !== \&quot;undefined\&quot;) {\n\t\t// Apparently it would be faster to use postMessage - http://dbaron.org/log/20100309-faster-timeouts\n\t\twindow.setTimeout(fn,4);\n\t} else {\n\t\tprocess.nextTick(fn);\n\t}\n};\n\n/*\nConvert a hyphenated CSS property name into a camel case one\n*/\nexports.unHyphenateCss = function(propName) {\n\treturn propName.replace(/-([a-z])/gi, function(match0,match1) {\n\t\treturn match1.toUpperCase();\n\t});\n};\n\n/*\nConvert a camelcase CSS property name into a dashed one (\&quot;backgroundColor\&quot; --&gt; \&quot;background-color\&quot;)\n*/\nexports.hyphenateCss = function(propName) {\n\treturn propName.replace(/([A-Z])/g, function(match0,match1) {\n\t\treturn \&quot;-\&quot; + match1.toLowerCase();\n\t});\n};\n\n/*\nParse a text reference of one of these forms:\n* title\n* !!field\n* title!!field\n* title##index\n* etc\nReturns an object with the following fields, all optional:\n* title: tiddler title\n* field: tiddler field name\n* index: JSON property index\n*/\nexports.parseTextReference = function(textRef) {\n\t// Separate out the title, field name and/or JSON indices\n\tvar reTextRef = /(?:(.*?)!!(.+))|(?:(.*?)##(.+))|(.*)/mg,\n\t\tmatch = reTextRef.exec(textRef),\n\t\tresult = {};\n\tif(match &amp;&amp; reTextRef.lastIndex === textRef.length) {\n\t\t// Return the parts\n\t\tif(match[1]) {\n\t\t\tresult.title = match[1];\n\t\t}\n\t\tif(match[2]) {\n\t\t\tresult.field = match[2];\n\t\t}\n\t\tif(match[3]) {\n\t\t\tresult.title = match[3];\n\t\t}\n\t\tif(match[4]) {\n\t\t\tresult.index = match[4];\n\t\t}\n\t\tif(match[5]) {\n\t\t\tresult.title = match[5];\n\t\t}\n\t} else {\n\t\t// If we couldn't parse it\n\t\tresult.title = textRef\n\t}\n\treturn result;\n};\n\n/*\nChecks whether a string is a valid fieldname\n*/\nexports.isValidFieldName = function(name) {\n\tif(!name || typeof name !== \&quot;string\&quot;) {\n\t\treturn false;\n\t}\n\tname = name.toLowerCase().trim();\n\tvar fieldValidatorRegEx = /^[a-z0-9\\-\\._]+$/mg;\n\treturn fieldValidatorRegEx.test(name);\n};\n\n/*\nExtract the version number from the meta tag or from the boot file\n*/\n\n// Browser version\nexports.extractVersionInfo = function() {\n\tif($tw.packageInfo) {\n\t\treturn $tw.packageInfo.version;\n\t} else {\n\t\tvar metatags = document.getElementsByTagName(\&quot;meta\&quot;);\n\t\tfor(var t=0; t&lt;metatags.length; t++) {\n\t\t\tvar m = metatags[t];\n\t\t\tif(m.name === \&quot;tiddlywiki-version\&quot;) {\n\t\t\t\treturn m.content;\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n};\n\n/*\nGet the animation duration in ms\n*/\nexports.getAnimationDuration = function() {\n\treturn parseInt($tw.wiki.getTiddlerText(\&quot;$:/config/AnimationDuration\&quot;,\&quot;400\&quot;),10);\n};\n\n/*\nHash a string to a number\nDerived from http://stackoverflow.com/a/15710692\n*/\nexports.hashString = function(str) {\n\treturn str.split(\&quot;\&quot;).reduce(function(a,b) {\n\t\ta = ((a &lt;&lt; 5) - a) + b.charCodeAt(0);\n\t\treturn a &amp; a;\n\t},0);\n};\n\n/*\nDecode a base64 string\n*/\nexports.base64Decode = function(string64) {\n\tif($tw.browser) {\n\t\t// TODO\n\t\tthrow \&quot;$tw.utils.base64Decode() doesn't work in the browser\&quot;;\n\t} else {\n\t\treturn (new Buffer(string64,\&quot;base64\&quot;)).toString();\n\t}\n};\n\n/*\nConvert a hashmap into a tiddler dictionary format sequence of name:value pairs\n*/\nexports.makeTiddlerDictionary = function(data) {\n\tvar output = [];\n\tfor(var name in data) {\n\t\toutput.push(name + \&quot;: \&quot; + data[name]);\n\t}\n\treturn output.join(\&quot;\\n\&quot;);\n};\n\n/*\nHigh resolution microsecond timer for profiling\n*/\nexports.timer = function(base) {\n\tvar m;\n\tif($tw.node) {\n\t\tvar r = process.hrtime();\t\t\n\t\tm =  r[0] * 1e3 + (r[1] / 1e6);\n\t} else if(window.performance) {\n\t\tm = performance.now();\n\t} else {\n\t\tm = Date.now();\n\t}\n\tif(typeof base !== \&quot;undefined\&quot;) {\n\t\tm = m - base;\n\t}\n\treturn m;\n};\n\n})();&quot;,
            &quot;title&quot;: &quot;$:/core/modules/utils/utils.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;utils&quot;
        },
        &quot;$:/core/modules/widgets/action-deletefield.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/action-deletefield.js\ntype: application/javascript\nmodule-type: widget\n\nAction widget to delete fields of a tiddler.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar DeleteFieldWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nDeleteFieldWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nDeleteFieldWidget.prototype.render = function(parent,nextSibling) {\n\tthis.computeAttributes();\n\tthis.execute();\n};\n\n/*\nCompute the internal state of the widget\n*/\nDeleteFieldWidget.prototype.execute = function() {\n\tthis.actionTiddler = this.getAttribute(\&quot;$tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.actionField = this.getAttribute(\&quot;$field\&quot;);\n};\n\n/*\nRefresh the widget by ensuring our attributes are up to date\n*/\nDeleteFieldWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes[\&quot;$tiddler\&quot;]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t}\n\treturn this.refreshChildren(changedTiddlers);\n};\n\n/*\nInvoke the action associated with this widget\n*/\nDeleteFieldWidget.prototype.invokeAction = function(triggeringWidget,event) {\n\tvar self = this,\n\t\ttiddler = this.wiki.getTiddler(self.actionTiddler),\n\t\tremoveFields = {};\n\tif(this.actionField) {\n\t\tremoveFields[this.actionField] = undefined;\n\t}\n\tif(tiddler) {\n\t\t$tw.utils.each(this.attributes,function(attribute,name) {\n\t\t\tif(name.charAt(0) !== \&quot;$\&quot; &amp;&amp; name !== \&quot;title\&quot;) {\n\t\t\t\tremoveFields[name] = undefined;\n\t\t\t}\n\t\t});\n\t\tthis.wiki.addTiddler(new $tw.Tiddler(tiddler,removeFields));\n\t}\n\treturn true; // Action was invoked\n};\n\nexports[\&quot;action-deletefield\&quot;] = DeleteFieldWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/action-deletefield.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/action-deletetiddler.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/action-deletetiddler.js\ntype: application/javascript\nmodule-type: widget\n\nAction widget to delete a tiddler.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar DeleteTiddlerWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nDeleteTiddlerWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nDeleteTiddlerWidget.prototype.render = function(parent,nextSibling) {\n\tthis.computeAttributes();\n\tthis.execute();\n};\n\n/*\nCompute the internal state of the widget\n*/\nDeleteTiddlerWidget.prototype.execute = function() {\n\tthis.actionFilter = this.getAttribute(\&quot;$filter\&quot;);\n\tthis.actionTiddler = this.getAttribute(\&quot;$tiddler\&quot;);\n};\n\n/*\nRefresh the widget by ensuring our attributes are up to date\n*/\nDeleteTiddlerWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes[\&quot;$filter\&quot;] || changedAttributes[\&quot;$tiddler\&quot;]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t}\n\treturn this.refreshChildren(changedTiddlers);\n};\n\n/*\nInvoke the action associated with this widget\n*/\nDeleteTiddlerWidget.prototype.invokeAction = function(triggeringWidget,event) {\n\tvar tiddlers = [];\n\tif(this.actionFilter) {\n\t\ttiddlers = this.wiki.filterTiddlers(this.actionFilter,this);\n\t}\n\tif(this.actionTiddler) {\n\t\ttiddlers.push(this.actionTiddler);\n\t}\n\tfor(var t=0; t&lt;tiddlers.length; t++) {\n\t\tthis.wiki.deleteTiddler(tiddlers[t]);\n\t}\n\treturn true; // Action was invoked\n};\n\nexports[\&quot;action-deletetiddler\&quot;] = DeleteTiddlerWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/action-deletetiddler.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/action-navigate.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/action-navigate.js\ntype: application/javascript\nmodule-type: widget\n\nAction widget to navigate to a tiddler\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar NavigateWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nNavigateWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nNavigateWidget.prototype.render = function(parent,nextSibling) {\n\tthis.computeAttributes();\n\tthis.execute();\n};\n\n/*\nCompute the internal state of the widget\n*/\nNavigateWidget.prototype.execute = function() {\n\tthis.actionTo = this.getAttribute(\&quot;$to\&quot;);\n\tthis.actionScroll = this.getAttribute(\&quot;$scroll\&quot;);\n};\n\n/*\nRefresh the widget by ensuring our attributes are up to date\n*/\nNavigateWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes[\&quot;$to\&quot;] || changedAttributes[\&quot;$scroll\&quot;]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t}\n\treturn this.refreshChildren(changedTiddlers);\n};\n\n/*\nInvoke the action associated with this widget\n*/\nNavigateWidget.prototype.invokeAction = function(triggeringWidget,event) {\n\tvar bounds = triggeringWidget &amp;&amp; triggeringWidget.getBoundingClientRect &amp;&amp; triggeringWidget.getBoundingClientRect(),\n\t\tsuppressNavigation = event.metaKey || event.ctrlKey || (event.button === 1);\n\tif(this.actionScroll === \&quot;yes\&quot;) {\n\t\tsuppressNavigation = false;\n\t} else if(this.actionScroll === \&quot;no\&quot;) {\n\t\tsuppressNavigation = true;\n\t}\n\tthis.dispatchEvent({\n\t\ttype: \&quot;tm-navigate\&quot;,\n\t\tnavigateTo: this.actionTo === undefined ? this.getVariable(\&quot;currentTiddler\&quot;) : this.actionTo,\n\t\tnavigateFromTitle: this.getVariable(\&quot;storyTiddler\&quot;),\n\t\tnavigateFromNode: triggeringWidget,\n\t\tnavigateFromClientRect: bounds &amp;&amp; { top: bounds.top, left: bounds.left, width: bounds.width, right: bounds.right, bottom: bounds.bottom, height: bounds.height\n\t\t},\n\t\tnavigateSuppressNavigation: suppressNavigation\n\t});\n\treturn true; // Action was invoked\n};\n\nexports[\&quot;action-navigate\&quot;] = NavigateWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/action-navigate.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/action-sendmessage.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/action-sendmessage.js\ntype: application/javascript\nmodule-type: widget\n\nAction widget to send a message\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar SendMessageWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nSendMessageWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nSendMessageWidget.prototype.render = function(parent,nextSibling) {\n\tthis.computeAttributes();\n\tthis.execute();\n};\n\n/*\nCompute the internal state of the widget\n*/\nSendMessageWidget.prototype.execute = function() {\n\tthis.actionMessage = this.getAttribute(\&quot;$message\&quot;);\n\tthis.actionParam = this.getAttribute(\&quot;$param\&quot;);\n};\n\n/*\nRefresh the widget by ensuring our attributes are up to date\n*/\nSendMessageWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes[\&quot;$message\&quot;] || changedAttributes[\&quot;$param\&quot;]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t}\n\treturn this.refreshChildren(changedTiddlers);\n};\n\n/*\nInvoke the action associated with this widget\n*/\nSendMessageWidget.prototype.invokeAction = function(triggeringWidget,event) {\n\t// Get the string parameter\n\tvar param = this.actionParam;\n\t// Assemble the attributes as a hashmap\n\tvar paramObject = Object.create(null);\n\tvar count = 0;\n\t$tw.utils.each(this.attributes,function(attribute,name) {\n\t\tif(name.charAt(0) !== \&quot;$\&quot;) {\n\t\t\tparamObject[name] = attribute;\n\t\t\tcount++;\n\t\t}\n\t});\n\t// Dispatch the message\n\tthis.dispatchEvent({type: this.actionMessage, param: param, paramObject: paramObject, tiddlerTitle: this.getVariable(\&quot;currentTiddler\&quot;)});\n\treturn true; // Action was invoked\n};\n\nexports[\&quot;action-sendmessage\&quot;] = SendMessageWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/action-sendmessage.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/action-setfield.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/action-setfield.js\ntype: application/javascript\nmodule-type: widget\n\nAction widget to set a single field or index on a tiddler.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar SetFieldWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nSetFieldWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nSetFieldWidget.prototype.render = function(parent,nextSibling) {\n\tthis.computeAttributes();\n\tthis.execute();\n};\n\n/*\nCompute the internal state of the widget\n*/\nSetFieldWidget.prototype.execute = function() {\n\tthis.actionTiddler = this.getAttribute(\&quot;$tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.actionField = this.getAttribute(\&quot;$field\&quot;);\n\tthis.actionIndex = this.getAttribute(\&quot;$index\&quot;);\n\tthis.actionValue = this.getAttribute(\&quot;$value\&quot;);\n};\n\n/*\nRefresh the widget by ensuring our attributes are up to date\n*/\nSetFieldWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes[\&quot;$tiddler\&quot;] || changedAttributes[\&quot;$field\&quot;] || changedAttributes[\&quot;$index\&quot;] || changedAttributes[\&quot;$value\&quot;]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t}\n\treturn this.refreshChildren(changedTiddlers);\n};\n\n/*\nInvoke the action associated with this widget\n*/\nSetFieldWidget.prototype.invokeAction = function(triggeringWidget,event) {\n\tvar self = this;\n\tif(typeof this.actionValue === \&quot;string\&quot;) {\n\t\tthis.wiki.setText(this.actionTiddler,this.actionField,this.actionIndex,this.actionValue);\t\t\n\t}\n\t$tw.utils.each(this.attributes,function(attribute,name) {\n\t\tif(name.charAt(0) !== \&quot;$\&quot;) {\n\t\t\tself.wiki.setText(self.actionTiddler,name,undefined,attribute);\n\t\t}\n\t});\n\treturn true; // Action was invoked\n};\n\nexports[\&quot;action-setfield\&quot;] = SetFieldWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/action-setfield.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/browse.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/browse.js\ntype: application/javascript\nmodule-type: widget\n\nBrowse widget for browsing for files to import\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar BrowseWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nBrowseWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nBrowseWidget.prototype.render = function(parent,nextSibling) {\n\tvar self = this;\n\t// Remember parent\n\tthis.parentDomNode = parent;\n\t// Compute attributes and execute state\n\tthis.computeAttributes();\n\tthis.execute();\n\t// Create element\n\tvar domNode = this.document.createElement(\&quot;input\&quot;);\n\tdomNode.setAttribute(\&quot;type\&quot;,\&quot;file\&quot;);\n\tif(this.browseMultiple) {\n\t\tdomNode.setAttribute(\&quot;multiple\&quot;,\&quot;multiple\&quot;);\n\t}\n\tif(this.tooltip) {\n\t\tdomNode.setAttribute(\&quot;title\&quot;,this.tooltip);\n\t}\n\t// Add a click event handler\n\tdomNode.addEventListener(\&quot;change\&quot;,function (event) {\n\t\tif(self.message) {\n\t\t\tself.dispatchEvent({type: self.message, param: event.target.files});\n\t\t} else {\n\t\t\tself.wiki.readFiles(event.target.files,function(tiddlerFieldsArray) {\n\t\t\t\tself.dispatchEvent({type: \&quot;tm-import-tiddlers\&quot;, param: JSON.stringify(tiddlerFieldsArray)});\n\t\t\t});\n\t\t}\n\t\treturn false;\n\t},false);\n\t// Insert element\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.renderChildren(domNode,null);\n\tthis.domNodes.push(domNode);\n};\n\n/*\nCompute the internal state of the widget\n*/\nBrowseWidget.prototype.execute = function() {\n\tthis.browseMultiple = this.getAttribute(\&quot;multiple\&quot;);\n\tthis.message = this.getAttribute(\&quot;message\&quot;);\n\tthis.tooltip = this.getAttribute(\&quot;tooltip\&quot;);\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nBrowseWidget.prototype.refresh = function(changedTiddlers) {\n\treturn false;\n};\n\nexports.browse = BrowseWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/browse.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/button.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/button.js\ntype: application/javascript\nmodule-type: widget\n\nButton widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar ButtonWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nButtonWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nButtonWidget.prototype.render = function(parent,nextSibling) {\n\tvar self = this;\n\t// Remember parent\n\tthis.parentDomNode = parent;\n\t// Compute attributes and execute state\n\tthis.computeAttributes();\n\tthis.execute();\n\t// Create element\n\tvar domNode = this.document.createElement(\&quot;button\&quot;);\n\t// Assign classes\n\tvar classes = this[\&quot;class\&quot;].split(\&quot; \&quot;) || [],\n\t\tisPoppedUp = this.popup &amp;&amp; this.isPoppedUp();\n\tif(this.selectedClass) {\n\t\tif(this.set &amp;&amp; this.setTo &amp;&amp; this.isSelected()) {\n\t\t\t$tw.utils.pushTop(classes,this.selectedClass.split(\&quot; \&quot;));\n\t\t}\n\t\tif(isPoppedUp) {\n\t\t\t$tw.utils.pushTop(classes,this.selectedClass.split(\&quot; \&quot;));\n\t\t}\n\t}\n\tif(isPoppedUp) {\n\t\t$tw.utils.pushTop(classes,\&quot;tc-popup-handle\&quot;);\n\t}\n\tdomNode.className = classes.join(\&quot; \&quot;);\n\t// Assign other attributes\n\tif(this.style) {\n\t\tdomNode.setAttribute(\&quot;style\&quot;,this.style);\n\t}\n\tif(this.tooltip) {\n\t\tdomNode.setAttribute(\&quot;title\&quot;,this.tooltip);\n\t}\n\tif(this[\&quot;aria-label\&quot;]) {\n\t\tdomNode.setAttribute(\&quot;aria-label\&quot;,this[\&quot;aria-label\&quot;]);\n\t}\n\t// Add a click event handler\n\tdomNode.addEventListener(\&quot;click\&quot;,function (event) {\n\t\tvar handled = false;\n\t\tif(self.invokeActions(event)) {\n\t\t\thandled = true;\n\t\t}\n\t\tif(self.to) {\n\t\t\tself.navigateTo(event);\n\t\t\thandled = true;\n\t\t}\n\t\tif(self.message) {\n\t\t\tself.dispatchMessage(event);\n\t\t\thandled = true;\n\t\t}\n\t\tif(self.popup) {\n\t\t\tself.triggerPopup(event);\n\t\t\thandled = true;\n\t\t}\n\t\tif(self.set) {\n\t\t\tself.setTiddler();\n\t\t\thandled = true;\n\t\t}\n\t\tif(handled) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t}\n\t\treturn handled;\n\t},false);\n\t// Insert element\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.renderChildren(domNode,null);\n\tthis.domNodes.push(domNode);\n};\n\nButtonWidget.prototype.getBoundingClientRect = function() {\n\treturn this.domNodes[0].getBoundingClientRect();\n}\n\nButtonWidget.prototype.isSelected = function() {\n\tvar tiddler = this.wiki.getTiddler(this.set);\n\treturn tiddler ? tiddler.fields.text === this.setTo : this.defaultSetValue === this.setTo;\n};\n\nButtonWidget.prototype.isPoppedUp = function() {\n\tvar tiddler = this.wiki.getTiddler(this.popup);\n\tvar result = tiddler &amp;&amp; tiddler.fields.text ? $tw.popup.readPopupState(tiddler.fields.text) : false;\n\treturn result;\n};\n\nButtonWidget.prototype.navigateTo = function(event) {\n\tvar bounds = this.getBoundingClientRect();\n\tthis.dispatchEvent({\n\t\ttype: \&quot;tm-navigate\&quot;,\n\t\tnavigateTo: this.to,\n\t\tnavigateFromTitle: this.getVariable(\&quot;storyTiddler\&quot;),\n\t\tnavigateFromNode: this,\n\t\tnavigateFromClientRect: { top: bounds.top, left: bounds.left, width: bounds.width, right: bounds.right, bottom: bounds.bottom, height: bounds.height\n\t\t},\n\t\tnavigateSuppressNavigation: event.metaKey || event.ctrlKey || (event.button === 1)\n\t});\n};\n\nButtonWidget.prototype.dispatchMessage = function(event) {\n\tthis.dispatchEvent({type: this.message, param: this.param, tiddlerTitle: this.getVariable(\&quot;currentTiddler\&quot;)});\n};\n\nButtonWidget.prototype.triggerPopup = function(event) {\n\t$tw.popup.triggerPopup({\n\t\tdomNode: this.domNodes[0],\n\t\ttitle: this.popup,\n\t\twiki: this.wiki\n\t});\n};\n\nButtonWidget.prototype.setTiddler = function() {\n\tthis.wiki.setTextReference(this.set,this.setTo,this.getVariable(\&quot;currentTiddler\&quot;));\n};\n\n/*\nCompute the internal state of the widget\n*/\nButtonWidget.prototype.execute = function() {\n\t// Get attributes\n\tthis.to = this.getAttribute(\&quot;to\&quot;);\n\tthis.message = this.getAttribute(\&quot;message\&quot;);\n\tthis.param = this.getAttribute(\&quot;param\&quot;);\n\tthis.set = this.getAttribute(\&quot;set\&quot;);\n\tthis.setTo = this.getAttribute(\&quot;setTo\&quot;);\n\tthis.popup = this.getAttribute(\&quot;popup\&quot;);\n\tthis.hover = this.getAttribute(\&quot;hover\&quot;);\n\tthis[\&quot;class\&quot;] = this.getAttribute(\&quot;class\&quot;,\&quot;\&quot;);\n\tthis[\&quot;aria-label\&quot;] = this.getAttribute(\&quot;aria-label\&quot;);\n\tthis.tooltip = this.getAttribute(\&quot;tooltip\&quot;);\n\tthis.style = this.getAttribute(\&quot;style\&quot;);\n\tthis.selectedClass = this.getAttribute(\&quot;selectedClass\&quot;);\n\tthis.defaultSetValue = this.getAttribute(\&quot;default\&quot;);\n\t// Make child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nButtonWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.to || changedAttributes.message || changedAttributes.param || changedAttributes.set || changedAttributes.setTo || changedAttributes.popup || changedAttributes.hover || changedAttributes[\&quot;class\&quot;] || changedAttributes.selectedClass || changedAttributes.style || (this.set &amp;&amp; changedTiddlers[this.set]) || (this.popup &amp;&amp; changedTiddlers[this.popup])) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t}\n\treturn this.refreshChildren(changedTiddlers);\n};\n\nexports.button = ButtonWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/button.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/checkbox.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/checkbox.js\ntype: application/javascript\nmodule-type: widget\n\nCheckbox widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar CheckboxWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nCheckboxWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nCheckboxWidget.prototype.render = function(parent,nextSibling) {\n\t// Save the parent dom node\n\tthis.parentDomNode = parent;\n\t// Compute our attributes\n\tthis.computeAttributes();\n\t// Execute our logic\n\tthis.execute();\n\t// Create our elements\n\tthis.labelDomNode = this.document.createElement(\&quot;label\&quot;);\n\tthis.inputDomNode = this.document.createElement(\&quot;input\&quot;);\n\tthis.inputDomNode.setAttribute(\&quot;type\&quot;,\&quot;checkbox\&quot;);\n\tif(this.getValue()) {\n\t\tthis.inputDomNode.setAttribute(\&quot;checked\&quot;,\&quot;true\&quot;);\n\t}\n\tthis.labelDomNode.appendChild(this.inputDomNode);\n\tthis.spanDomNode = this.document.createElement(\&quot;span\&quot;);\n\tthis.labelDomNode.appendChild(this.spanDomNode);\n\t// Add a click event handler\n\t$tw.utils.addEventListeners(this.inputDomNode,[\n\t\t{name: \&quot;change\&quot;, handlerObject: this, handlerMethod: \&quot;handleChangeEvent\&quot;}\n\t]);\n\t// Insert the label into the DOM and render any children\n\tparent.insertBefore(this.labelDomNode,nextSibling);\n\tthis.renderChildren(this.spanDomNode,null);\n\tthis.domNodes.push(this.labelDomNode);\n};\n\nCheckboxWidget.prototype.getValue = function() {\n\tvar tiddler = this.wiki.getTiddler(this.checkboxTitle);\n\tif(tiddler) {\n\t\tif(this.checkboxTag) {\n\t\t\treturn tiddler.hasTag(this.checkboxTag);\n\t\t}\n\t\tif(this.checkboxField) {\n\t\t\tvar value = tiddler.fields[this.checkboxField] || this.checkboxDefault || \&quot;\&quot;;\n\t\t\tif(value === this.checkboxChecked) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(value === this.checkboxUnchecked) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif(this.checkboxTag) {\n\t\t\treturn false;\n\t\t}\n\t\tif(this.checkboxField) {\n\t\t\tif(this.checkboxDefault === this.checkboxChecked) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(this.checkboxDefault === this.checkboxUnchecked) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n\nCheckboxWidget.prototype.handleChangeEvent = function(event) {\n\tvar checked = this.inputDomNode.checked,\n\t\ttiddler = this.wiki.getTiddler(this.checkboxTitle),\n\t\tfallbackFields = {text: \&quot;\&quot;},\n\t\tnewFields = {title: this.checkboxTitle},\n\t\thasChanged = false;\n\t// Set the tag if specified\n\tif(this.checkboxTag &amp;&amp; (!tiddler || tiddler.hasTag(this.checkboxTag) !== checked)) {\n\t\tnewFields.tags = tiddler ? (tiddler.fields.tags || []).slice(0) : [];\n\t\tvar pos = newFields.tags.indexOf(this.checkboxTag);\n\t\tif(pos !== -1) {\n\t\t\tnewFields.tags.splice(pos,1);\n\t\t}\n\t\tif(checked) {\n\t\t\tnewFields.tags.push(this.checkboxTag);\n\t\t}\n\t\thasChanged = true;\n\t}\n\t// Set the field if specified\n\tif(this.checkboxField) {\n\t\tvar value = checked ? this.checkboxChecked : this.checkboxUnchecked;\n\t\tif(!tiddler || tiddler.fields[this.checkboxField] !== value) {\n\t\t\tnewFields[this.checkboxField] = value;\n\t\t\thasChanged = true;\n\t\t}\n\t}\n\tif(hasChanged) {\n\t\tthis.wiki.addTiddler(new $tw.Tiddler(fallbackFields,tiddler,newFields,this.wiki.getModificationFields()));\n\t}\n};\n\n/*\nCompute the internal state of the widget\n*/\nCheckboxWidget.prototype.execute = function() {\n\t// Get the parameters from the attributes\n\tthis.checkboxTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.checkboxTag = this.getAttribute(\&quot;tag\&quot;);\n\tthis.checkboxField = this.getAttribute(\&quot;field\&quot;);\n\tthis.checkboxChecked = this.getAttribute(\&quot;checked\&quot;);\n\tthis.checkboxUnchecked = this.getAttribute(\&quot;unchecked\&quot;);\n\tthis.checkboxDefault = this.getAttribute(\&quot;default\&quot;);\n\t// Make the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nCheckboxWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.tiddler || changedAttributes.tag || changedAttributes.field || changedAttributes.checked || changedAttributes.unchecked || changedAttributes[\&quot;default\&quot;] || changedAttributes[\&quot;class\&quot;]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\tvar refreshed = false;\n\t\tif(changedTiddlers[this.checkboxTitle]) {\n\t\t\tthis.inputDomNode.checked = this.getValue();\n\t\t\trefreshed = true;\n\t\t}\n\t\treturn this.refreshChildren(changedTiddlers) || refreshed;\n\t}\n};\n\nexports.checkbox = CheckboxWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/checkbox.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/codeblock.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/codeblock.js\ntype: application/javascript\nmodule-type: widget\n\nCode block node widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar CodeBlockWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nCodeBlockWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nCodeBlockWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tvar codeNode = this.document.createElement(\&quot;code\&quot;),\n\t\tdomNode = this.document.createElement(\&quot;pre\&quot;);\n\tcodeNode.appendChild(this.document.createTextNode(this.getAttribute(\&quot;code\&quot;)));\n\tdomNode.appendChild(codeNode);\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.domNodes.push(domNode);\n\tif(this.postRender) {\n\t\tthis.postRender();\n\t}\n};\n\n/*\nCompute the internal state of the widget\n*/\nCodeBlockWidget.prototype.execute = function() {\n\tthis.language = this.getAttribute(\&quot;language\&quot;);\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nCodeBlockWidget.prototype.refresh = function(changedTiddlers) {\n\treturn false;\n};\n\nexports.codeblock = CodeBlockWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/codeblock.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/count.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/count.js\ntype: application/javascript\nmodule-type: widget\n\nCount widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar CountWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nCountWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nCountWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tvar textNode = this.document.createTextNode(this.currentCount);\n\tparent.insertBefore(textNode,nextSibling);\n\tthis.domNodes.push(textNode);\n};\n\n/*\nCompute the internal state of the widget\n*/\nCountWidget.prototype.execute = function() {\n\t// Get parameters from our attributes\n\tthis.filter = this.getAttribute(\&quot;filter\&quot;);\n\t// Execute the filter\n\tif(this.filter) {\n\t\tthis.currentCount = this.wiki.filterTiddlers(this.filter,this).length;\n\t} else {\n\t\tthis.currentCount = undefined;\n\t}\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nCountWidget.prototype.refresh = function(changedTiddlers) {\n\t// Re-execute the filter to get the count\n\tthis.computeAttributes();\n\tvar oldCount = this.currentCount;\n\tthis.execute();\n\tif(this.currentCount !== oldCount) {\n\t\t// Regenerate and rerender the widget and replace the existing DOM node\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n\n};\n\nexports.count = CountWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/count.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/dropzone.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/dropzone.js\ntype: application/javascript\nmodule-type: widget\n\nDropzone widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar DropZoneWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nDropZoneWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nDropZoneWidget.prototype.render = function(parent,nextSibling) {\n\tvar self = this;\n\t// Remember parent\n\tthis.parentDomNode = parent;\n\t// Compute attributes and execute state\n\tthis.computeAttributes();\n\tthis.execute();\n\t// Create element\n\tvar domNode = this.document.createElement(\&quot;div\&quot;);\n\tdomNode.className = \&quot;tc-dropzone\&quot;;\n\t// Add event handlers\n\t$tw.utils.addEventListeners(domNode,[\n\t\t{name: \&quot;dragenter\&quot;, handlerObject: this, handlerMethod: \&quot;handleDragEnterEvent\&quot;},\n\t\t{name: \&quot;dragover\&quot;, handlerObject: this, handlerMethod: \&quot;handleDragOverEvent\&quot;},\n\t\t{name: \&quot;dragleave\&quot;, handlerObject: this, handlerMethod: \&quot;handleDragLeaveEvent\&quot;},\n\t\t{name: \&quot;drop\&quot;, handlerObject: this, handlerMethod: \&quot;handleDropEvent\&quot;},\n\t\t{name: \&quot;paste\&quot;, handlerObject: this, handlerMethod: \&quot;handlePasteEvent\&quot;}\n\t]);\n\tdomNode.addEventListener(\&quot;click\&quot;,function (event) {\n\t},false);\n\t// Insert element\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.renderChildren(domNode,null);\n\tthis.domNodes.push(domNode);\n};\n\nDropZoneWidget.prototype.enterDrag = function() {\n\t// We count enter/leave events\n\tthis.dragEnterCount = (this.dragEnterCount || 0) + 1;\n\t// If we're entering for the first time we need to apply highlighting\n\tif(this.dragEnterCount === 1) {\n\t\t$tw.utils.addClass(this.domNodes[0],\&quot;tc-dragover\&quot;);\n\t}\n};\n\nDropZoneWidget.prototype.leaveDrag = function() {\n\t// Reduce the enter count\n\tthis.dragEnterCount = (this.dragEnterCount || 0) - 1;\n\t// Remove highlighting if we're leaving externally\n\tif(this.dragEnterCount &lt;= 0) {\n\t\t$tw.utils.removeClass(this.domNodes[0],\&quot;tc-dragover\&quot;);\n\t}\n};\n\nDropZoneWidget.prototype.handleDragEnterEvent  = function(event) {\n\tthis.enterDrag();\n\t// Tell the browser that we're ready to handle the drop\n\tevent.preventDefault();\n\t// Tell the browser not to ripple the drag up to any parent drop handlers\n\tevent.stopPropagation();\n};\n\nDropZoneWidget.prototype.handleDragOverEvent  = function(event) {\n\t// Check for being over a TEXTAREA or INPUT\n\tif([\&quot;TEXTAREA\&quot;,\&quot;INPUT\&quot;].indexOf(event.target.tagName) !== -1) {\n\t\treturn false;\n\t}\n\t// Tell the browser that we're still interested in the drop\n\tevent.preventDefault();\n\tevent.dataTransfer.dropEffect = \&quot;copy\&quot;; // Explicitly show this is a copy\n};\n\nDropZoneWidget.prototype.handleDragLeaveEvent  = function(event) {\n\tthis.leaveDrag();\n};\n\nDropZoneWidget.prototype.handleDropEvent  = function(event) {\n\tthis.leaveDrag();\n\t// Check for being over a TEXTAREA or INPUT\n\tif([\&quot;TEXTAREA\&quot;,\&quot;INPUT\&quot;].indexOf(event.target.tagName) !== -1) {\n\t\treturn false;\n\t}\n\tvar self = this,\n\t\tdataTransfer = event.dataTransfer;\n\t// Reset the enter count\n\tthis.dragEnterCount = 0;\n\t// Remove highlighting\n\t$tw.utils.removeClass(this.domNodes[0],\&quot;tc-dragover\&quot;);\n\t// Import any files in the drop\n\tvar numFiles = this.wiki.readFiles(dataTransfer.files,function(tiddlerFieldsArray) {\n\t\tself.dispatchEvent({type: \&quot;tm-import-tiddlers\&quot;, param: JSON.stringify(tiddlerFieldsArray)});\n\t});\n\t// Try to import the various data types we understand\n\tif(numFiles === 0) {\n\t\tthis.importData(dataTransfer);\n\t}\n\t// Tell the browser that we handled the drop\n\tevent.preventDefault();\n\t// Stop the drop ripple up to any parent handlers\n\tevent.stopPropagation();\n};\n\nDropZoneWidget.prototype.importData = function(dataTransfer) {\n\t// Try each provided data type in turn\n\tfor(var t=0; t&lt;this.importDataTypes.length; t++) {\n\t\tif(!$tw.browser.isIE || this.importDataTypes[t].IECompatible) {\n\t\t\t// Get the data\n\t\t\tvar dataType = this.importDataTypes[t];\n\t\t\t\tvar data = dataTransfer.getData(dataType.type);\n\t\t\t// Import the tiddlers in the data\n\t\t\tif(data !== \&quot;\&quot; &amp;&amp; data !== null) {\n\t\t\t\tif($tw.log.IMPORT) {\n\t\t\t\t\tconsole.log(\&quot;Importing data type '\&quot; + dataType.type + \&quot;', data: '\&quot; + data + \&quot;'\&quot;)\n\t\t\t\t}\n\t\t\t\tvar tiddlerFields = dataType.convertToFields(data);\n\t\t\t\tif(!tiddlerFields.title) {\n\t\t\t\t\ttiddlerFields.title = this.wiki.generateNewTitle(\&quot;Untitled\&quot;);\n\t\t\t\t}\n\t\t\t\tthis.dispatchEvent({type: \&quot;tm-import-tiddlers\&quot;, param: JSON.stringify([tiddlerFields])});\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n};\n\nDropZoneWidget.prototype.importDataTypes = [\n\t{type: \&quot;text/vnd.tiddler\&quot;, IECompatible: false, convertToFields: function(data) {\n\t\treturn JSON.parse(data);\n\t}},\n\t{type: \&quot;URL\&quot;, IECompatible: true, convertToFields: function(data) {\n\t\t// Check for tiddler data URI\n\t\tvar match = decodeURI(data).match(/^data\\:text\\/vnd\\.tiddler,(.*)/i);\n\t\tif(match) {\n\t\t\treturn JSON.parse(match[1]);\n\t\t} else {\n\t\t\treturn { // As URL string\n\t\t\t\ttext: data\n\t\t\t};\n\t\t}\n\t}},\n\t{type: \&quot;text/x-moz-url\&quot;, IECompatible: false, convertToFields: function(data) {\n\t\t// Check for tiddler data URI\n\t\tvar match = decodeURI(data).match(/^data\\:text\\/vnd\\.tiddler,(.*)/i);\n\t\tif(match) {\n\t\t\treturn JSON.parse(match[1]);\n\t\t} else {\n\t\t\treturn { // As URL string\n\t\t\t\ttext: data\n\t\t\t};\n\t\t}\n\t}},\n\t{type: \&quot;text/html\&quot;, IECompatible: false, convertToFields: function(data) {\n\t\treturn {\n\t\t\ttext: data\n\t\t};\n\t}},\n\t{type: \&quot;text/plain\&quot;, IECompatible: false, convertToFields: function(data) {\n\t\treturn {\n\t\t\ttext: data\n\t\t};\n\t}},\n\t{type: \&quot;Text\&quot;, IECompatible: true, convertToFields: function(data) {\n\t\treturn {\n\t\t\ttext: data\n\t\t};\n\t}},\n\t{type: \&quot;text/uri-list\&quot;, IECompatible: false, convertToFields: function(data) {\n\t\treturn {\n\t\t\ttext: data\n\t\t};\n\t}}\n];\n\nDropZoneWidget.prototype.handlePasteEvent  = function(event) {\n\t// Let the browser handle it if we're in a textarea or input box\n\tif([\&quot;TEXTAREA\&quot;,\&quot;INPUT\&quot;].indexOf(event.target.tagName) == -1) {\n\t\tvar self = this,\n\t\t\titems = event.clipboardData.items;\n\t\t// Enumerate the clipboard items\n\t\tfor(var t = 0; t&lt;items.length; t++) {\n\t\t\tvar item = items[t];\n\t\t\tif(item.kind === \&quot;file\&quot;) {\n\t\t\t\t// Import any files\n\t\t\t\tthis.wiki.readFile(item.getAsFile(),function(tiddlerFieldsArray) {\n\t\t\t\t\tself.dispatchEvent({type: \&quot;tm-import-tiddlers\&quot;, param: JSON.stringify(tiddlerFieldsArray)});\n\t\t\t\t});\n\t\t\t} else if(item.kind === \&quot;string\&quot;) {\n\t\t\t\t// Create tiddlers from string items\n\t\t\t\tvar type = item.type;\n\t\t\t\titem.getAsString(function(str) {\n\t\t\t\t\tvar tiddlerFields = {\n\t\t\t\t\t\ttitle: self.wiki.generateNewTitle(\&quot;Untitled\&quot;),\n\t\t\t\t\t\ttext: str,\n\t\t\t\t\t\ttype: type\n\t\t\t\t\t};\n\t\t\t\t\tif($tw.log.IMPORT) {\n\t\t\t\t\t\tconsole.log(\&quot;Importing string '\&quot; + str + \&quot;', type: '\&quot; + type + \&quot;'\&quot;);\n\t\t\t\t\t}\n\t\t\t\t\tself.dispatchEvent({type: \&quot;tm-import-tiddlers\&quot;, param: JSON.stringify([tiddlerFields])});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t// Tell the browser that we've handled the paste\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n};\n\n/*\nCompute the internal state of the widget\n*/\nDropZoneWidget.prototype.execute = function() {\n\t// Make child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nDropZoneWidget.prototype.refresh = function(changedTiddlers) {\n\treturn this.refreshChildren(changedTiddlers);\n};\n\nexports.dropzone = DropZoneWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/dropzone.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/edit-binary.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/edit-binary.js\ntype: application/javascript\nmodule-type: widget\n\nEdit-binary widget; placeholder for editing binary tiddlers\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar BINARY_WARNING_MESSAGE = \&quot;$:/core/ui/BinaryWarning\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar EditBinaryWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nEditBinaryWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nEditBinaryWidget.prototype.render = function(parent,nextSibling) {\n\tvar self = this;\n\t// Save the parent dom node\n\tthis.parentDomNode = parent;\n\t// Compute our attributes\n\tthis.computeAttributes();\n\t// Execute our logic\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nEditBinaryWidget.prototype.execute = function() {\n\t// Construct the child widgets\n\tthis.makeChildWidgets([{\n\t\ttype: \&quot;transclude\&quot;,\n\t\tattributes: {\n\t\t\ttiddler: {type: \&quot;string\&quot;, value: BINARY_WARNING_MESSAGE}\n\t\t}\n\t}]);\n};\n\n/*\nRefresh by refreshing our child widget\n*/\nEditBinaryWidget.prototype.refresh = function(changedTiddlers) {\n\treturn this.refreshChildren(changedTiddlers);\n};\n\nexports[\&quot;edit-binary\&quot;] = EditBinaryWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/edit-binary.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/edit-bitmap.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/edit-bitmap.js\ntype: application/javascript\nmodule-type: widget\n\nEdit-bitmap widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n// Default image sizes\nvar DEFAULT_IMAGE_WIDTH = 300,\n\tDEFAULT_IMAGE_HEIGHT = 185;\n\n// Configuration tiddlers\nvar LINE_WIDTH_TITLE = \&quot;$:/config/BitmapEditor/LineWidth\&quot;,\n\tLINE_COLOUR_TITLE = \&quot;$:/config/BitmapEditor/Colour\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar EditBitmapWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nEditBitmapWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nEditBitmapWidget.prototype.render = function(parent,nextSibling) {\n\tvar self = this;\n\t// Save the parent dom node\n\tthis.parentDomNode = parent;\n\t// Compute our attributes\n\tthis.computeAttributes();\n\t// Execute our logic\n\tthis.execute();\n\t// Create our element\n\tthis.canvasDomNode = $tw.utils.domMaker(\&quot;canvas\&quot;,{\n\t\tdocument: this.document,\n\t\t\&quot;class\&quot;:\&quot;tc-edit-bitmapeditor\&quot;,\n\t\teventListeners: [{\n\t\t\tname: \&quot;touchstart\&quot;, handlerObject: this, handlerMethod: \&quot;handleTouchStartEvent\&quot;\n\t\t},{\n\t\t\tname: \&quot;touchmove\&quot;, handlerObject: this, handlerMethod: \&quot;handleTouchMoveEvent\&quot;\n\t\t},{\n\t\t\tname: \&quot;touchend\&quot;, handlerObject: this, handlerMethod: \&quot;handleTouchEndEvent\&quot;\n\t\t},{\n\t\t\tname: \&quot;mousedown\&quot;, handlerObject: this, handlerMethod: \&quot;handleMouseDownEvent\&quot;\n\t\t},{\n\t\t\tname: \&quot;mousemove\&quot;, handlerObject: this, handlerMethod: \&quot;handleMouseMoveEvent\&quot;\n\t\t},{\n\t\t\tname: \&quot;mouseup\&quot;, handlerObject: this, handlerMethod: \&quot;handleMouseUpEvent\&quot;\n\t\t}]\n\t});\n\tthis.widthDomNode = $tw.utils.domMaker(\&quot;input\&quot;,{\n\t\tdocument: this.document,\n\t\t\&quot;class\&quot;:\&quot;tc-edit-bitmapeditor-width\&quot;,\n\t\teventListeners: [{\n\t\t\tname: \&quot;change\&quot;, handlerObject: this, handlerMethod: \&quot;handleWidthChangeEvent\&quot;\n\t\t}]\n\t});\n\tthis.heightDomNode = $tw.utils.domMaker(\&quot;input\&quot;,{\n\t\tdocument: this.document,\n\t\t\&quot;class\&quot;:\&quot;tc-edit-bitmapeditor-height\&quot;,\n\t\teventListeners: [{\n\t\t\tname: \&quot;change\&quot;, handlerObject: this, handlerMethod: \&quot;handleHeightChangeEvent\&quot;\n\t\t}]\n\t});\n\t// Insert the elements into the DOM\n\tparent.insertBefore(this.canvasDomNode,nextSibling);\n\tparent.insertBefore(this.widthDomNode,nextSibling);\n\tparent.insertBefore(this.heightDomNode,nextSibling);\n\tthis.domNodes.push(this.canvasDomNode,this.widthDomNode,this.heightDomNode);\n\t// Load the image into the canvas\n\tif($tw.browser) {\n\t\tthis.loadCanvas();\n\t}\n};\n\n/*\nCompute the internal state of the widget\n*/\nEditBitmapWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.editTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n};\n\n/*\nNote that the bitmap editor intentionally doesn't try to refresh itself because it would be confusing to have the image changing spontaneously while editting it\n*/\nEditBitmapWidget.prototype.refresh = function(changedTiddlers) {\n\treturn false;\n};\n\nEditBitmapWidget.prototype.loadCanvas = function() {\n\tvar tiddler = this.wiki.getTiddler(this.editTitle),\n\t\tcurrImage = new Image();\n\t// Set up event handlers for loading the image\n\tvar self = this;\n\tcurrImage.onload = function() {\n\t\t// Copy the image to the on-screen canvas\n\t\tself.initCanvas(self.canvasDomNode,currImage.width,currImage.height,currImage);\n\t\t// And also copy the current bitmap to the off-screen canvas\n\t\tself.currCanvas = self.document.createElement(\&quot;canvas\&quot;);\n\t\tself.initCanvas(self.currCanvas,currImage.width,currImage.height,currImage);\n\t\t// Set the width and height input boxes\n\t\tself.updateSize();\n\t};\n\tcurrImage.onerror = function() {\n\t\t// Set the on-screen canvas size and clear it\n\t\tself.initCanvas(self.canvasDomNode,DEFAULT_IMAGE_WIDTH,DEFAULT_IMAGE_HEIGHT);\n\t\t// Set the off-screen canvas size and clear it\n\t\tself.currCanvas = self.document.createElement(\&quot;canvas\&quot;);\n\t\tself.initCanvas(self.currCanvas,DEFAULT_IMAGE_WIDTH,DEFAULT_IMAGE_HEIGHT);\n\t\t// Set the width and height input boxes\n\t\tself.updateSize();\n\t};\n\t// Get the current bitmap into an image object\n\tcurrImage.src = \&quot;data:\&quot; + tiddler.fields.type + \&quot;;base64,\&quot; + tiddler.fields.text;\n};\n\nEditBitmapWidget.prototype.initCanvas = function(canvas,width,height,image) {\n\tcanvas.width = width;\n\tcanvas.height = height;\n\tvar ctx = canvas.getContext(\&quot;2d\&quot;);\n\tif(image) {\n\t\tctx.drawImage(image,0,0);\n\t} else {\n\t\tctx.fillStyle = \&quot;#fff\&quot;;\n\t\tctx.fillRect(0,0,canvas.width,canvas.height);\n\t}\n};\n\n/*\n** Update the input boxes with the actual size of the canvas\n*/\nEditBitmapWidget.prototype.updateSize = function() {\n\tthis.widthDomNode.value = this.currCanvas.width;\n\tthis.heightDomNode.value = this.currCanvas.height;\n};\n\n/*\n** Change the size of the canvas, preserving the current image\n*/\nEditBitmapWidget.prototype.changeCanvasSize = function(newWidth,newHeight) {\n\t// Create and size a new canvas\n\tvar newCanvas = this.document.createElement(\&quot;canvas\&quot;);\n\tthis.initCanvas(newCanvas,newWidth,newHeight);\n\t// Copy the old image\n\tvar ctx = newCanvas.getContext(\&quot;2d\&quot;);\n\tctx.drawImage(this.currCanvas,0,0);\n\t// Set the new canvas as the current one\n\tthis.currCanvas = newCanvas;\n\t// Set the size of the onscreen canvas\n\tthis.canvasDomNode.width = newWidth;\n\tthis.canvasDomNode.height = newHeight;\n\t// Paint the onscreen canvas with the offscreen canvas\n\tctx = this.canvasDomNode.getContext(\&quot;2d\&quot;);\n\tctx.drawImage(this.currCanvas,0,0);\n};\n\nEditBitmapWidget.prototype.handleWidthChangeEvent = function(event) {\n\t// Get the new width\n\tvar newWidth = parseInt(this.widthDomNode.value,10);\n\t// Update if necessary\n\tif(newWidth &gt; 0 &amp;&amp; newWidth !== this.currCanvas.width) {\n\t\tthis.changeCanvasSize(newWidth,this.currCanvas.height);\n\t}\n\t// Update the input controls\n\tthis.updateSize();\n};\n\nEditBitmapWidget.prototype.handleHeightChangeEvent = function(event) {\n\t// Get the new width\n\tvar newHeight = parseInt(this.heightDomNode.value,10);\n\t// Update if necessary\n\tif(newHeight &gt; 0 &amp;&amp; newHeight !== this.currCanvas.height) {\n\t\tthis.changeCanvasSize(this.currCanvas.width,newHeight);\n\t}\n\t// Update the input controls\n\tthis.updateSize();\n};\n\nEditBitmapWidget.prototype.handleTouchStartEvent = function(event) {\n\tthis.brushDown = true;\n\tthis.strokeStart(event.touches[0].clientX,event.touches[0].clientY);\n\tevent.preventDefault();\n\tevent.stopPropagation();\n\treturn false;\n};\n\nEditBitmapWidget.prototype.handleTouchMoveEvent = function(event) {\n\tif(this.brushDown) {\n\t\tthis.strokeMove(event.touches[0].clientX,event.touches[0].clientY);\n\t}\n\tevent.preventDefault();\n\tevent.stopPropagation();\n\treturn false;\n};\n\nEditBitmapWidget.prototype.handleTouchEndEvent = function(event) {\n\tif(this.brushDown) {\n\t\tthis.brushDown = false;\n\t\tthis.strokeEnd();\n\t}\n\tevent.preventDefault();\n\tevent.stopPropagation();\n\treturn false;\n};\n\nEditBitmapWidget.prototype.handleMouseDownEvent = function(event) {\n\tthis.strokeStart(event.clientX,event.clientY);\n\tthis.brushDown = true;\n\tevent.preventDefault();\n\tevent.stopPropagation();\n\treturn false;\n};\n\nEditBitmapWidget.prototype.handleMouseMoveEvent = function(event) {\n\tif(this.brushDown) {\n\t\tthis.strokeMove(event.clientX,event.clientY);\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\treturn false;\n\t}\n\treturn true;\n};\n\nEditBitmapWidget.prototype.handleMouseUpEvent = function(event) {\n\tif(this.brushDown) {\n\t\tthis.brushDown = false;\n\t\tthis.strokeEnd();\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\treturn false;\n\t}\n\treturn true;\n};\n\nEditBitmapWidget.prototype.adjustCoordinates = function(x,y) {\n\tvar canvasRect = this.canvasDomNode.getBoundingClientRect(),\n\t\tscale = this.canvasDomNode.width/canvasRect.width;\n\treturn {x: (x - canvasRect.left) * scale, y: (y - canvasRect.top) * scale};\n};\n\nEditBitmapWidget.prototype.strokeStart = function(x,y) {\n\t// Start off a new stroke\n\tthis.stroke = [this.adjustCoordinates(x,y)];\n};\n\nEditBitmapWidget.prototype.strokeMove = function(x,y) {\n\tvar ctx = this.canvasDomNode.getContext(\&quot;2d\&quot;),\n\t\tt;\n\t// Add the new position to the end of the stroke\n\tthis.stroke.push(this.adjustCoordinates(x,y));\n\t// Redraw the previous image\n\tctx.drawImage(this.currCanvas,0,0);\n\t// Render the stroke\n\tctx.strokeStyle = this.wiki.getTiddlerText(LINE_COLOUR_TITLE,\&quot;#ff0\&quot;);\n\tctx.lineWidth = parseInt(this.wiki.getTiddlerText(LINE_WIDTH_TITLE,\&quot;3\&quot;),10);\n\tctx.lineCap = \&quot;round\&quot;;\n\tctx.lineJoin = \&quot;round\&quot;;\n\tctx.beginPath();\n\tctx.moveTo(this.stroke[0].x,this.stroke[0].y);\n\tfor(t=1; t&lt;this.stroke.length-1; t++) {\n\t\tvar s1 = this.stroke[t],\n\t\t\ts2 = this.stroke[t-1],\n\t\t\ttx = (s1.x + s2.x)/2,\n\t\t\tty = (s1.y + s2.y)/2;\n\t\tctx.quadraticCurveTo(s2.x,s2.y,tx,ty);\n\t}\n\tctx.stroke();\n};\n\nEditBitmapWidget.prototype.strokeEnd = function() {\n\t// Copy the bitmap to the off-screen canvas\n\tvar ctx = this.currCanvas.getContext(\&quot;2d\&quot;);\n\tctx.drawImage(this.canvasDomNode,0,0);\n\t// Save the image into the tiddler\n\tthis.saveChanges();\n};\n\nEditBitmapWidget.prototype.saveChanges = function() {\n\tvar tiddler = this.wiki.getTiddler(this.editTitle);\n\tif(tiddler) {\n\t\t// data URIs look like \&quot;data:&lt;type&gt;;base64,&lt;text&gt;\&quot;\n\t\tvar dataURL = this.canvasDomNode.toDataURL(tiddler.fields.type,1.0),\n\t\t\tposColon = dataURL.indexOf(\&quot;:\&quot;),\n\t\t\tposSemiColon = dataURL.indexOf(\&quot;;\&quot;),\n\t\t\tposComma = dataURL.indexOf(\&quot;,\&quot;),\n\t\t\ttype = dataURL.substring(posColon+1,posSemiColon),\n\t\t\ttext = dataURL.substring(posComma+1);\n\t\tvar update = {type: type, text: text};\n\t\tthis.wiki.addTiddler(new $tw.Tiddler(tiddler,update));\n\t}\n};\n\nexports[\&quot;edit-bitmap\&quot;] = EditBitmapWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/edit-bitmap.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/edit-text.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/edit-text.js\ntype: application/javascript\nmodule-type: widget\n\nEdit-text widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar DEFAULT_MIN_TEXT_AREA_HEIGHT = \&quot;100px\&quot;; // Minimum height of textareas in pixels\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar EditTextWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nEditTextWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nEditTextWidget.prototype.render = function(parent,nextSibling) {\n\tvar self = this;\n\t// Save the parent dom node\n\tthis.parentDomNode = parent;\n\t// Compute our attributes\n\tthis.computeAttributes();\n\t// Execute our logic\n\tthis.execute();\n\t// Create our element\n\tvar editInfo = this.getEditInfo();\n\tvar domNode = this.document.createElement(this.editTag);\n\tif(this.editType) {\n\t\tdomNode.setAttribute(\&quot;type\&quot;,this.editType);\n\t}\n\tif(editInfo.value === \&quot;\&quot; &amp;&amp; this.editPlaceholder) {\n\t\tdomNode.setAttribute(\&quot;placeholder\&quot;,this.editPlaceholder);\n\t}\n\tif(this.editSize) {\n\t\tdomNode.setAttribute(\&quot;size\&quot;,this.editSize);\n\t}\n\t// Assign classes\n\tif(this.editClass) {\n\t\tdomNode.className = this.editClass;\n\t}\n\t// Set the text\n\tif(this.editTag === \&quot;textarea\&quot;) {\n\t\tdomNode.appendChild(this.document.createTextNode(editInfo.value));\n\t} else {\n\t\tdomNode.value = editInfo.value;\n\t}\n\t// Add an input event handler\n\t$tw.utils.addEventListeners(domNode,[\n\t\t{name: \&quot;focus\&quot;, handlerObject: this, handlerMethod: \&quot;handleFocusEvent\&quot;},\n\t\t{name: \&quot;input\&quot;, handlerObject: this, handlerMethod: \&quot;handleInputEvent\&quot;}\n\t]);\n\t// Insert the element into the DOM\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.domNodes.push(domNode);\n\tif(this.postRender) {\n\t\tthis.postRender();\n\t}\n\t// Fix height\n\tthis.fixHeight();\n\t// Focus field\n\tif(this.editFocus === \&quot;true\&quot;) {\n\t\tdomNode.focus();\n\t\tdomNode.select();\n\t}\n};\n\n/*\nGet the tiddler being edited and current value\n*/\nEditTextWidget.prototype.getEditInfo = function() {\n\t// Get the edit value\n\tvar self = this,\n\t\tvalue,\n\t\tupdate;\n\tif(this.editIndex) {\n\t\tvalue = this.wiki.extractTiddlerDataItem(this.editTitle,this.editIndex,this.editDefault);\n\t\tupdate = function(value) {\n\t\t\tvar data = self.wiki.getTiddlerData(self.editTitle,{});\n\t\t\tif(data[self.editIndex] !== value) {\n\t\t\t\tdata[self.editIndex] = value;\n\t\t\t\tself.wiki.setTiddlerData(self.editTitle,data);\n\t\t\t}\n\t\t};\n\t} else {\n\t\t// Get the current tiddler and the field name\n\t\tvar tiddler = this.wiki.getTiddler(this.editTitle);\n\t\tif(tiddler) {\n\t\t\t// If we've got a tiddler, the value to display is the field string value\n\t\t\tvalue = tiddler.getFieldString(this.editField);\n\t\t} else {\n\t\t\t// Otherwise, we need to construct a default value for the editor\n\t\t\tswitch(this.editField) {\n\t\t\t\tcase \&quot;text\&quot;:\n\t\t\t\t\tvalue = \&quot;Type the text for the tiddler '\&quot; + this.editTitle + \&quot;'\&quot;;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \&quot;title\&quot;:\n\t\t\t\t\tvalue = this.editTitle;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tvalue = \&quot;\&quot;;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(this.editDefault !== undefined) {\n\t\t\t\tvalue = this.editDefault;\n\t\t\t}\n\t\t}\n\t\tupdate = function(value) {\n\t\t\tvar tiddler = self.wiki.getTiddler(self.editTitle),\n\t\t\t\tupdateFields = {\n\t\t\t\t\ttitle: self.editTitle\n\t\t\t\t};\n\t\t\tupdateFields[self.editField] = value;\n\t\t\tself.wiki.addTiddler(new $tw.Tiddler(self.wiki.getCreationFields(),tiddler,updateFields,self.wiki.getModificationFields()));\n\t\t};\n\t}\n\treturn {value: value, update: update};\n};\n\n/*\nCompute the internal state of the widget\n*/\nEditTextWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.editTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.editField = this.getAttribute(\&quot;field\&quot;,\&quot;text\&quot;);\n\tthis.editIndex = this.getAttribute(\&quot;index\&quot;);\n\tthis.editDefault = this.getAttribute(\&quot;default\&quot;);\n\tthis.editClass = this.getAttribute(\&quot;class\&quot;);\n\tthis.editPlaceholder = this.getAttribute(\&quot;placeholder\&quot;);\n\tthis.editSize = this.getAttribute(\&quot;size\&quot;);\n\tthis.editAutoHeight = this.getAttribute(\&quot;autoHeight\&quot;,\&quot;yes\&quot;) === \&quot;yes\&quot;;\n\tthis.editMinHeight = this.getAttribute(\&quot;minHeight\&quot;,DEFAULT_MIN_TEXT_AREA_HEIGHT);\n\tthis.editFocusPopup = this.getAttribute(\&quot;focusPopup\&quot;);\n\tthis.editFocus = this.getAttribute(\&quot;focus\&quot;);\n\t// Get the editor element tag and type\n\tvar tag,type;\n\tif(this.editField === \&quot;text\&quot;) {\n\t\ttag = \&quot;textarea\&quot;;\n\t} else {\n\t\ttag = \&quot;input\&quot;;\n\t\tvar fieldModule = $tw.Tiddler.fieldModules[this.editField];\n\t\tif(fieldModule &amp;&amp; fieldModule.editTag) {\n\t\t\ttag = fieldModule.editTag;\n\t\t}\n\t\tif(fieldModule &amp;&amp; fieldModule.editType) {\n\t\t\ttype = fieldModule.editType;\n\t\t}\n\t\ttype = type || \&quot;text\&quot;;\n\t}\n\t// Get the rest of our parameters\n\tthis.editTag = this.getAttribute(\&quot;tag\&quot;,tag);\n\tthis.editType = this.getAttribute(\&quot;type\&quot;,type);\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nEditTextWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\t// Completely rerender if any of our attributes have changed\n\tif(changedAttributes.tiddler || changedAttributes.field || changedAttributes.index || changedAttributes[\&quot;default\&quot;] || changedAttributes[\&quot;class\&quot;] || changedAttributes.placeholder || changedAttributes.size || changedAttributes.autoHeight || changedAttributes.minHeight || changedAttributes.focusPopup) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else if(changedTiddlers[this.editTitle]) {\n\t\tthis.updateEditor(this.getEditInfo().value);\n\t\treturn true;\n\t}\n\treturn false;\n};\n\n/*\nUpdate the editor with new text. This method is separate from updateEditorDomNode()\nso that subclasses can override updateEditor() and still use updateEditorDomNode()\n*/\nEditTextWidget.prototype.updateEditor = function(text) {\n\tthis.updateEditorDomNode(text);\n};\n\n/*\nUpdate the editor dom node with new text\n*/\nEditTextWidget.prototype.updateEditorDomNode = function(text) {\n\t// Replace the edit value if the tiddler we're editing has changed\n\tvar domNode = this.domNodes[0];\n\tif(!domNode.isTiddlyWikiFakeDom) {\n\t\tif(this.document.activeElement !== domNode) {\n\t\t\tdomNode.value = text;\n\t\t}\n\t\t// Fix the height if needed\n\t\tthis.fixHeight();\n\t}\n};\n\n/*\nFix the height of textareas to fit their content\n*/\nEditTextWidget.prototype.fixHeight = function() {\n\tvar self = this,\n\t\tdomNode = this.domNodes[0];\n\tif(this.editAutoHeight &amp;&amp; domNode &amp;&amp; !domNode.isTiddlyWikiFakeDom &amp;&amp; this.editTag === \&quot;textarea\&quot;) {\n\t\t// Resize the textarea to fit its content, preserving scroll position\n\t\tvar scrollPosition = $tw.utils.getScrollPosition(),\n\t\t\tscrollTop = scrollPosition.y;\n\t\t// Measure the specified minimum height\n\t\tdomNode.style.height = self.editMinHeight;\n\t\tvar minHeight = domNode.offsetHeight;\n\t\t// Set its height to auto so that it snaps to the correct height\n\t\tdomNode.style.height = \&quot;auto\&quot;;\n\t\t// Calculate the revised height\n\t\tvar newHeight = Math.max(domNode.scrollHeight + domNode.offsetHeight - domNode.clientHeight,minHeight);\n\t\t// Only try to change the height if it has changed\n\t\tif(newHeight !== domNode.offsetHeight) {\n\t\t\tdomNode.style.height =  newHeight + \&quot;px\&quot;;\n\t\t\t// Make sure that the dimensions of the textarea are recalculated\n\t\t\t$tw.utils.forceLayout(domNode);\n\t\t\t// Check that the scroll position is still visible before trying to scroll back to it\n\t\t\tscrollTop = Math.min(scrollTop,self.document.body.scrollHeight - window.innerHeight);\n\t\t\twindow.scrollTo(scrollPosition.x,scrollTop);\n\t\t}\n\t}\n};\n\n/*\nHandle a dom \&quot;input\&quot; event\n*/\nEditTextWidget.prototype.handleInputEvent = function(event) {\n\tthis.saveChanges(this.domNodes[0].value);\n\tthis.fixHeight();\n\treturn true;\n};\n\nEditTextWidget.prototype.handleFocusEvent = function(event) {\n\tif(this.editFocusPopup) {\n\t\t$tw.popup.triggerPopup({\n\t\t\tdomNode: this.domNodes[0],\n\t\t\ttitle: this.editFocusPopup,\n\t\t\twiki: this.wiki,\n\t\t\tforce: true\n\t\t});\n\t}\n\treturn true;\n};\n\nEditTextWidget.prototype.saveChanges = function(text) {\n\tvar editInfo = this.getEditInfo();\n\tif(text !== editInfo.value) {\n\t\teditInfo.update(text);\n\t}\n};\n\nexports[\&quot;edit-text\&quot;] = EditTextWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/edit-text.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/edit.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/edit.js\ntype: application/javascript\nmodule-type: widget\n\nEdit widget is a meta-widget chooses the appropriate actual editting widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar EditWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nEditWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nEditWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n// Mappings from content type to editor type are stored in tiddlers with this prefix\nvar EDITOR_MAPPING_PREFIX = \&quot;$:/config/EditorTypeMappings/\&quot;;\n\n/*\nCompute the internal state of the widget\n*/\nEditWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.editTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.editField = this.getAttribute(\&quot;field\&quot;,\&quot;text\&quot;);\n\tthis.editIndex = this.getAttribute(\&quot;index\&quot;);\n\tthis.editClass = this.getAttribute(\&quot;class\&quot;);\n\tthis.editPlaceholder = this.getAttribute(\&quot;placeholder\&quot;);\n\t// Choose the appropriate edit widget\n\tthis.editorType = this.getEditorType();\n\t// Make the child widgets\n\tthis.makeChildWidgets([{\n\t\ttype: \&quot;edit-\&quot; + this.editorType,\n\t\tattributes: {\n\t\t\ttiddler: {type: \&quot;string\&quot;, value: this.editTitle},\n\t\t\tfield: {type: \&quot;string\&quot;, value: this.editField},\n\t\t\tindex: {type: \&quot;string\&quot;, value: this.editIndex},\n\t\t\t\&quot;class\&quot;: {type: \&quot;string\&quot;, value: this.editClass},\n\t\t\t\&quot;placeholder\&quot;: {type: \&quot;string\&quot;, value: this.editPlaceholder}\n\t\t}\n\t}]);\n};\n\nEditWidget.prototype.getEditorType = function() {\n\t// Get the content type of the thing we're editing\n\tvar type;\n\tif(this.editField === \&quot;text\&quot;) {\n\t\tvar tiddler = this.wiki.getTiddler(this.editTitle);\n\t\tif(tiddler) {\n\t\t\ttype = tiddler.fields.type;\n\t\t}\n\t}\n\ttype = type || \&quot;text/vnd.tiddlywiki\&quot;;\n\tvar editorType = this.wiki.getTiddlerText(EDITOR_MAPPING_PREFIX + type);\n\tif(!editorType) {\n\t\tvar typeInfo = $tw.config.contentTypeInfo[type];\n\t\tif(typeInfo &amp;&amp; typeInfo.encoding === \&quot;base64\&quot;) {\n\t\t\teditorType = \&quot;binary\&quot;;\n\t\t} else {\n\t\t\teditorType = \&quot;text\&quot;;\n\t\t}\n\t}\n\treturn editorType;\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nEditWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\t// Refresh if an attribute has changed, or the type associated with the target tiddler has changed\n\tif(changedAttributes.tiddler || changedAttributes.field || changedAttributes.index || (changedTiddlers[this.editTitle] &amp;&amp; this.getEditorType() !== this.editorType)) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\t\t\n\t}\n};\n\nexports.edit = EditWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/edit.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/element.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/element.js\ntype: application/javascript\nmodule-type: widget\n\nElement widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar ElementWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nElementWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nElementWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\t// Neuter blacklisted elements\n\tvar tag = this.parseTreeNode.tag;\n\tif($tw.config.htmlUnsafeElements.indexOf(tag) !== -1) {\n\t\ttag = \&quot;safe-\&quot; + tag;\n\t}\n\tvar domNode = this.document.createElementNS(this.namespace,tag);\n\tthis.assignAttributes(domNode,{excludeEventAttributes: true});\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.renderChildren(domNode,null);\n\tthis.domNodes.push(domNode);\n};\n\n/*\nCompute the internal state of the widget\n*/\nElementWidget.prototype.execute = function() {\n\t// Select the namespace for the tag\n\tvar tagNamespaces = {\n\t\t\tsvg: \&quot;http://www.w3.org/2000/svg\&quot;,\n\t\t\tmath: \&quot;http://www.w3.org/1998/Math/MathML\&quot;,\n\t\t\tbody: \&quot;http://www.w3.org/1999/xhtml\&quot;\n\t\t};\n\tthis.namespace = tagNamespaces[this.parseTreeNode.tag];\n\tif(this.namespace) {\n\t\tthis.setVariable(\&quot;namespace\&quot;,this.namespace);\n\t} else {\n\t\tthis.namespace = this.getVariable(\&quot;namespace\&quot;,{defaultValue: \&quot;http://www.w3.org/1999/xhtml\&quot;});\n\t}\n\t// Make the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nElementWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes(),\n\t\thasChangedAttributes = $tw.utils.count(changedAttributes) &gt; 0;\n\tif(hasChangedAttributes) {\n\t\t// Update our attributes\n\t\tthis.assignAttributes(this.domNodes[0],{excludeEventAttributes: true});\n\t}\n\treturn this.refreshChildren(changedTiddlers) || hasChangedAttributes;\n};\n\nexports.element = ElementWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/element.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/encrypt.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/encrypt.js\ntype: application/javascript\nmodule-type: widget\n\nEncrypt widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar EncryptWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nEncryptWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nEncryptWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tvar textNode = this.document.createTextNode(this.encryptedText);\n\tparent.insertBefore(textNode,nextSibling);\n\tthis.domNodes.push(textNode);\n};\n\n/*\nCompute the internal state of the widget\n*/\nEncryptWidget.prototype.execute = function() {\n\t// Get parameters from our attributes\n\tthis.filter = this.getAttribute(\&quot;filter\&quot;,\&quot;[!is[system]]\&quot;);\n\t// Encrypt the filtered tiddlers\n\tvar tiddlers = this.wiki.filterTiddlers(this.filter),\n\t\tjson = {},\n\t\tself = this;\n\t$tw.utils.each(tiddlers,function(title) {\n\t\tvar tiddler = self.wiki.getTiddler(title),\n\t\t\tjsonTiddler = {};\n\t\tfor(var f in tiddler.fields) {\n\t\t\tjsonTiddler[f] = tiddler.getFieldString(f);\n\t\t}\n\t\tjson[title] = jsonTiddler;\n\t});\n\tthis.encryptedText = $tw.utils.htmlEncode($tw.crypto.encrypt(JSON.stringify(json)));\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nEncryptWidget.prototype.refresh = function(changedTiddlers) {\n\t// We don't need to worry about refreshing because the encrypt widget isn't for interactive use\n\treturn false;\n};\n\nexports.encrypt = EncryptWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/encrypt.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/entity.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/entity.js\ntype: application/javascript\nmodule-type: widget\n\nHTML entity widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar EntityWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nEntityWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nEntityWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.execute();\n\tvar textNode = this.document.createTextNode($tw.utils.entityDecode(this.parseTreeNode.entity));\n\tparent.insertBefore(textNode,nextSibling);\n\tthis.domNodes.push(textNode);\n};\n\n/*\nCompute the internal state of the widget\n*/\nEntityWidget.prototype.execute = function() {\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nEntityWidget.prototype.refresh = function(changedTiddlers) {\n\treturn false;\n};\n\nexports.entity = EntityWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/entity.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/fieldmangler.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/fieldmangler.js\ntype: application/javascript\nmodule-type: widget\n\nField mangler widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar FieldManglerWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n\tthis.addEventListeners([\n\t\t{type: \&quot;tm-remove-field\&quot;, handler: \&quot;handleRemoveFieldEvent\&quot;},\n\t\t{type: \&quot;tm-add-field\&quot;, handler: \&quot;handleAddFieldEvent\&quot;},\n\t\t{type: \&quot;tm-remove-tag\&quot;, handler: \&quot;handleRemoveTagEvent\&quot;},\n\t\t{type: \&quot;tm-add-tag\&quot;, handler: \&quot;handleAddTagEvent\&quot;}\n\t]);\n};\n\n/*\nInherit from the base widget class\n*/\nFieldManglerWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nFieldManglerWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nFieldManglerWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.mangleTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\t// Construct the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nFieldManglerWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.tiddler) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\t\t\n\t}\n};\n\nFieldManglerWidget.prototype.handleRemoveFieldEvent = function(event) {\n\tvar tiddler = this.wiki.getTiddler(this.mangleTitle),\n\t\tdeletion = {};\n\tdeletion[event.param] = undefined;\n\tthis.wiki.addTiddler(new $tw.Tiddler(tiddler,deletion));\n\treturn true;\n};\n\nFieldManglerWidget.prototype.handleAddFieldEvent = function(event) {\n\tvar tiddler = this.wiki.getTiddler(this.mangleTitle),\n\t\taddition = this.wiki.getModificationFields(),\n\t\thadInvalidFieldName = false,\n\t\taddField = function(name,value) {\n\t\t\tvar trimmedName = name.toLowerCase().trim();\n\t\t\tif(!$tw.utils.isValidFieldName(trimmedName)) {\n\t\t\t\tif(!hadInvalidFieldName) {\n\t\t\t\t\talert($tw.language.getString(\n\t\t\t\t\t\t\&quot;InvalidFieldName\&quot;,\n\t\t\t\t\t\t{variables:\n\t\t\t\t\t\t\t{fieldName: trimmedName}\n\t\t\t\t\t\t}\n\t\t\t\t\t));\n\t\t\t\t\thadInvalidFieldName = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(!value &amp;&amp; tiddler) {\n\t\t\t\t\tvalue = tiddler.fields[trimmedName];\n\t\t\t\t}\n\t\t\t\taddition[trimmedName] = value || \&quot;\&quot;;\n\t\t\t}\n\t\t\treturn;\n\t\t};\n\taddition.title = this.mangleTitle;\n\tif(typeof event.param === \&quot;string\&quot;) {\n\t\taddField(event.param,\&quot;\&quot;);\n\t}\n\tif(typeof event.paramObject === \&quot;object\&quot;) {\n\t\tfor(var name in event.paramObject) {\n\t\t\taddField(name,event.paramObject[name]);\n\t\t}\n\t}\n\tthis.wiki.addTiddler(new $tw.Tiddler(tiddler,addition));\n\treturn true;\n};\n\nFieldManglerWidget.prototype.handleRemoveTagEvent = function(event) {\n\tvar tiddler = this.wiki.getTiddler(this.mangleTitle);\n\tif(tiddler &amp;&amp; tiddler.fields.tags) {\n\t\tvar p = tiddler.fields.tags.indexOf(event.param);\n\t\tif(p !== -1) {\n\t\t\tvar modification = this.wiki.getModificationFields();\n\t\t\tmodification.tags = (tiddler.fields.tags || []).slice(0);\n\t\t\tmodification.tags.splice(p,1);\n\t\t\tif(modification.tags.length === 0) {\n\t\t\t\tmodification.tags = undefined;\n\t\t\t}\n\t\tthis.wiki.addTiddler(new $tw.Tiddler(tiddler,modification));\n\t\t}\n\t}\n\treturn true;\n};\n\nFieldManglerWidget.prototype.handleAddTagEvent = function(event) {\n\tvar tiddler = this.wiki.getTiddler(this.mangleTitle);\n\tif(tiddler &amp;&amp; typeof event.param === \&quot;string\&quot;) {\n\t\tvar tag = event.param.trim();\n\t\tif(tag !== \&quot;\&quot;) {\n\t\t\tvar modification = this.wiki.getModificationFields();\n\t\t\tmodification.tags = (tiddler.fields.tags || []).slice(0);\n\t\t\t$tw.utils.pushTop(modification.tags,tag);\n\t\t\tthis.wiki.addTiddler(new $tw.Tiddler(tiddler,modification));\t\t\t\n\t\t}\n\t}\n\treturn true;\n};\n\nexports.fieldmangler = FieldManglerWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/fieldmangler.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/fields.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/fields.js\ntype: application/javascript\nmodule-type: widget\n\nFields widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar FieldsWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nFieldsWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nFieldsWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tvar textNode = this.document.createTextNode(this.text);\n\tparent.insertBefore(textNode,nextSibling);\n\tthis.domNodes.push(textNode);\n};\n\n/*\nCompute the internal state of the widget\n*/\nFieldsWidget.prototype.execute = function() {\n\t// Get parameters from our attributes\n\tthis.tiddlerTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.template = this.getAttribute(\&quot;template\&quot;);\n\tthis.exclude = this.getAttribute(\&quot;exclude\&quot;);\n\tthis.stripTitlePrefix = this.getAttribute(\&quot;stripTitlePrefix\&quot;,\&quot;no\&quot;) === \&quot;yes\&quot;;\n\t// Get the value to display\n\tvar tiddler = this.wiki.getTiddler(this.tiddlerTitle);\n\t// Get the exclusion list\n\tvar exclude;\n\tif(this.exclude) {\n\t\texclude = this.exclude.split(\&quot; \&quot;);\n\t} else {\n\t\texclude = [\&quot;text\&quot;]; \n\t}\n\t// Compose the template\n\tvar text = [];\n\tif(this.template &amp;&amp; tiddler) {\n\t\tvar fields = [];\n\t\tfor(var fieldName in tiddler.fields) {\n\t\t\tif(exclude.indexOf(fieldName) === -1) {\n\t\t\t\tfields.push(fieldName);\n\t\t\t}\n\t\t}\n\t\tfields.sort();\n\t\tfor(var f=0; f&lt;fields.length; f++) {\n\t\t\tfieldName = fields[f];\n\t\t\tif(exclude.indexOf(fieldName) === -1) {\n\t\t\t\tvar row = this.template,\n\t\t\t\t\tvalue = tiddler.getFieldString(fieldName);\n\t\t\t\tif(this.stripTitlePrefix &amp;&amp; fieldName === \&quot;title\&quot;) {\n\t\t\t\t\tvar reStrip = /^\\{[^\\}]+\\}(.+)/mg,\n\t\t\t\t\t\treMatch = reStrip.exec(value);\n\t\t\t\t\tif(reMatch) {\n\t\t\t\t\t\tvalue = reMatch[1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trow = row.replace(\&quot;$name$\&quot;,fieldName);\n\t\t\t\trow = row.replace(\&quot;$value$\&quot;,value);\n\t\t\t\trow = row.replace(\&quot;$encoded_value$\&quot;,$tw.utils.htmlEncode(value));\n\t\t\t\ttext.push(row);\n\t\t\t}\n\t\t}\n\t}\n\tthis.text = text.join(\&quot;\&quot;);\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nFieldsWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.tiddler || changedAttributes.template || changedAttributes.exclude || changedAttributes.stripTitlePrefix || changedTiddlers[this.tiddlerTitle]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn false;\t\n\t}\n};\n\nexports.fields = FieldsWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/fields.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/image.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/image.js\ntype: application/javascript\nmodule-type: widget\n\nThe image widget displays an image referenced with an external URI or with a local tiddler title.\n\n```\n&lt;$image src=\&quot;TiddlerTitle\&quot; width=\&quot;320\&quot; height=\&quot;400\&quot; class=\&quot;classnames\&quot;&gt;\n```\n\nThe image source can be the title of an existing tiddler or the URL of an external image.\n\nExternal images always generate an HTML `&lt;img&gt;` tag.\n\nTiddlers that have a _canonical_uri field generate an HTML `&lt;img&gt;` tag with the src attribute containing the URI.\n\nTiddlers that contain image data generate an HTML `&lt;img&gt;` tag with the src attribute containing a base64 representation of the image.\n\nTiddlers that contain wikitext could be rendered to a DIV of the usual size of a tiddler, and then transformed to the size requested.\n\nThe width and height attributes are interpreted as a number of pixels, and do not need to include the \&quot;px\&quot; suffix.\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar ImageWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nImageWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nImageWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\t// Create element\n\t// Determine what type of image it is\n\tvar tag = \&quot;img\&quot;, src = \&quot;\&quot;,\n\t\ttiddler = this.wiki.getTiddler(this.imageSource);\n\tif(!tiddler) {\n\t\t// The source isn't the title of a tiddler, so we'll assume it's a URL\n\t\tsrc = this.imageSource;\n\t} else {\n\t\t// Check if it is an image tiddler\n\t\tif(this.wiki.isImageTiddler(this.imageSource)) {\n\t\t\tvar type = tiddler.fields.type,\n\t\t\t\ttext = tiddler.fields.text,\n\t\t\t\t_canonical_uri = tiddler.fields._canonical_uri;\n\t\t\t// If the tiddler has body text then it doesn't need to be lazily loaded\n\t\t\tif(text) {\n\t\t\t\t// Render the appropriate element for the image type\n\t\t\t\tswitch(type) {\n\t\t\t\t\tcase \&quot;application/pdf\&quot;:\n\t\t\t\t\t\ttag = \&quot;embed\&quot;;\n\t\t\t\t\t\tsrc = \&quot;data:application/pdf;base64,\&quot; + text;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \&quot;image/svg+xml\&quot;:\n\t\t\t\t\t\tsrc = \&quot;data:image/svg+xml,\&quot; + encodeURIComponent(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tsrc = \&quot;data:\&quot; + type + \&quot;;base64,\&quot; + text;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if(_canonical_uri) {\n\t\t\t\tswitch(type) {\n\t\t\t\t\tcase \&quot;application/pdf\&quot;:\n\t\t\t\t\t\ttag = \&quot;embed\&quot;;\n\t\t\t\t\t\tsrc = _canonical_uri;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \&quot;image/svg+xml\&quot;:\n\t\t\t\t\t\tsrc = _canonical_uri;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tsrc = _canonical_uri;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\t\n\t\t\t}\n\t\t}\n\t}\n\t// Create the element and assign the attributes\n\tvar domNode = this.document.createElement(tag);\n\tdomNode.setAttribute(\&quot;src\&quot;,src);\n\tif(this.imageClass) {\n\t\tdomNode.setAttribute(\&quot;class\&quot;,this.imageClass);\t\t\n\t}\n\tif(this.imageWidth) {\n\t\tdomNode.setAttribute(\&quot;width\&quot;,this.imageWidth);\n\t}\n\tif(this.imageHeight) {\n\t\tdomNode.setAttribute(\&quot;height\&quot;,this.imageHeight);\n\t}\n\tif(this.imageTooltip) {\n\t\tdomNode.setAttribute(\&quot;title\&quot;,this.imageTooltip);\t\t\n\t}\n\tif(this.imageAlt) {\n\t\tdomNode.setAttribute(\&quot;alt\&quot;,this.imageAlt);\t\t\n\t}\n\t// Insert element\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.domNodes.push(domNode);\n};\n\n/*\nCompute the internal state of the widget\n*/\nImageWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.imageSource = this.getAttribute(\&quot;source\&quot;);\n\tthis.imageWidth = this.getAttribute(\&quot;width\&quot;);\n\tthis.imageHeight = this.getAttribute(\&quot;height\&quot;);\n\tthis.imageClass = this.getAttribute(\&quot;class\&quot;);\n\tthis.imageTooltip = this.getAttribute(\&quot;tooltip\&quot;);\n\tthis.imageAlt = this.getAttribute(\&quot;alt\&quot;);\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nImageWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.source || changedAttributes.width || changedAttributes.height || changedAttributes[\&quot;class\&quot;] || changedAttributes.tooltip || changedTiddlers[this.imageSource]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn false;\t\t\n\t}\n};\n\nexports.image = ImageWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/image.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/importvariables.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/importvariables.js\ntype: application/javascript\nmodule-type: widget\n\nImport variable definitions from other tiddlers\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar ImportVariablesWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nImportVariablesWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nImportVariablesWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nImportVariablesWidget.prototype.execute = function(tiddlerList) {\n\tvar self = this;\n\t// Get our parameters\n\tthis.filter = this.getAttribute(\&quot;filter\&quot;);\n\t// Compute the filter\n\tthis.tiddlerList = tiddlerList || this.wiki.filterTiddlers(this.filter,this);\n\t// Accumulate the &lt;$set&gt; widgets from each tiddler\n\tvar widgetStackStart,widgetStackEnd;\n\tfunction addWidgetNode(widgetNode) {\n\t\tif(widgetNode) {\n\t\t\tif(!widgetStackStart &amp;&amp; !widgetStackEnd) {\n\t\t\t\twidgetStackStart = widgetNode;\n\t\t\t\twidgetStackEnd = widgetNode;\n\t\t\t} else {\n\t\t\t\twidgetStackEnd.children = [widgetNode];\n\t\t\t\twidgetStackEnd = widgetNode;\n\t\t\t}\n\t\t}\n\t}\n\t$tw.utils.each(this.tiddlerList,function(title) {\n\t\tvar parser = self.wiki.parseTiddler(title);\n\t\tif(parser) {\n\t\t\tvar parseTreeNode = parser.tree[0];\n\t\t\twhile(parseTreeNode &amp;&amp; parseTreeNode.type === \&quot;set\&quot;) {\n\t\t\t\taddWidgetNode({\n\t\t\t\t\ttype: \&quot;set\&quot;,\n\t\t\t\t\tattributes: parseTreeNode.attributes,\n\t\t\t\t\tparams: parseTreeNode.params\n\t\t\t\t});\n\t\t\t\tparseTreeNode = parseTreeNode.children[0];\n\t\t\t}\n\t\t} \n\t});\n\t// Add our own children to the end of the pile\n\tvar parseTreeNodes;\n\tif(widgetStackStart &amp;&amp; widgetStackEnd) {\n\t\tparseTreeNodes = [widgetStackStart];\n\t\twidgetStackEnd.children = this.parseTreeNode.children;\n\t} else {\n\t\tparseTreeNodes = this.parseTreeNode.children;\n\t}\n\t// Construct the child widgets\n\tthis.makeChildWidgets(parseTreeNodes);\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nImportVariablesWidget.prototype.refresh = function(changedTiddlers) {\n\t// Recompute our attributes and the filter list\n\tvar changedAttributes = this.computeAttributes(),\n\t\ttiddlerList = this.wiki.filterTiddlers(this.getAttribute(\&quot;filter\&quot;),this);\n\t// Refresh if the filter has changed, or the list of tiddlers has changed, or any of the tiddlers in the list has changed\n\tfunction haveListedTiddlersChanged() {\n\t\tvar changed = false;\n\t\ttiddlerList.forEach(function(title) {\n\t\t\tif(changedTiddlers[title]) {\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\t\treturn changed;\n\t}\n\tif(changedAttributes.filter || !$tw.utils.isArrayEqual(this.tiddlerList,tiddlerList) || haveListedTiddlersChanged()) {\n\t\t// Compute the filter\n\t\tthis.removeChildDomNodes();\n\t\tthis.execute(tiddlerList);\n\t\tthis.renderChildren(this.parentDomNode,this.findNextSiblingDomNode());\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\t\t\n\t}\n};\n\nexports.importvariables = ImportVariablesWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/importvariables.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/keyboard.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/keyboard.js\ntype: application/javascript\nmodule-type: widget\n\nKeyboard shortcut widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar KeyboardWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nKeyboardWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nKeyboardWidget.prototype.render = function(parent,nextSibling) {\n\tvar self = this;\n\t// Remember parent\n\tthis.parentDomNode = parent;\n\t// Compute attributes and execute state\n\tthis.computeAttributes();\n\tthis.execute();\n\t// Create element\n\tvar domNode = this.document.createElement(\&quot;div\&quot;);\n\t// Assign classes\n\tvar classes = (this[\&quot;class\&quot;] || \&quot;\&quot;).split(\&quot; \&quot;);\n\tclasses.push(\&quot;tc-keyboard\&quot;);\n\tdomNode.className = classes.join(\&quot; \&quot;);\n\t// Add a keyboard event handler\n\tdomNode.addEventListener(\&quot;keydown\&quot;,function (event) {\n\t\tif($tw.utils.checkKeyDescriptor(event,self.keyInfo)) {\n\t\t\tself.dispatchMessage(event);\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},false);\n\t// Insert element\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.renderChildren(domNode,null);\n\tthis.domNodes.push(domNode);\n};\n\nKeyboardWidget.prototype.dispatchMessage = function(event) {\n\tthis.dispatchEvent({type: this.message, param: this.param, tiddlerTitle: this.getVariable(\&quot;currentTiddler\&quot;)});\n};\n\n/*\nCompute the internal state of the widget\n*/\nKeyboardWidget.prototype.execute = function() {\n\t// Get attributes\n\tthis.message = this.getAttribute(\&quot;message\&quot;);\n\tthis.param = this.getAttribute(\&quot;param\&quot;);\n\tthis.key = this.getAttribute(\&quot;key\&quot;);\n\tthis.keyInfo = $tw.utils.parseKeyDescriptor(this.key);\n\tthis[\&quot;class\&quot;] = this.getAttribute(\&quot;class\&quot;);\n\t// Make child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nKeyboardWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.message || changedAttributes.param || changedAttributes.key || changedAttributes[\&quot;class\&quot;]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t}\n\treturn this.refreshChildren(changedTiddlers);\n};\n\nexports.keyboard = KeyboardWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/keyboard.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/link.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/link.js\ntype: application/javascript\nmodule-type: widget\n\nLink widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar LinkWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nLinkWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nLinkWidget.prototype.render = function(parent,nextSibling) {\n\t// Save the parent dom node\n\tthis.parentDomNode = parent;\n\t// Compute our attributes\n\tthis.computeAttributes();\n\t// Execute our logic\n\tthis.execute();\n\t// Get the value of the tv-wikilinks configuration macro\n\tvar wikiLinksMacro = this.getVariable(\&quot;tv-wikilinks\&quot;),\n\t\tuseWikiLinks = wikiLinksMacro ? (wikiLinksMacro.trim() !== \&quot;no\&quot;) : true;\n\t// Render the link if required\n\tif(useWikiLinks) {\n\t\tthis.renderLink(parent,nextSibling);\n\t} else {\n\t\t// Just insert the link text\n\t\tvar domNode = this.document.createElement(\&quot;span\&quot;);\n\t\tparent.insertBefore(domNode,nextSibling);\n\t\tthis.renderChildren(domNode,null);\n\t\tthis.domNodes.push(domNode);\n\t}\n};\n\n/*\nRender this widget into the DOM\n*/\nLinkWidget.prototype.renderLink = function(parent,nextSibling) {\n\tvar self = this;\n\t// Create our element\n\tvar domNode = this.document.createElement(\&quot;a\&quot;);\n\t// Assign classes\n\tvar classes = [];\n\tif(this.linkClasses) {\n\t\tclasses.push(this.linkClasses);\n\t}\n\tclasses.push(\&quot;tc-tiddlylink\&quot;);\n\tif(this.isShadow) {\n\t\tclasses.push(\&quot;tc-tiddlylink-shadow\&quot;);\n\t}\n\tif(this.isMissing &amp;&amp; !this.isShadow) {\n\t\tclasses.push(\&quot;tc-tiddlylink-missing\&quot;);\n\t} else {\n\t\tif(!this.isMissing) {\n\t\t\tclasses.push(\&quot;tc-tiddlylink-resolves\&quot;);\n\t\t}\n\t}\n\tdomNode.setAttribute(\&quot;class\&quot;,classes.join(\&quot; \&quot;));\n\t// Set an href\n\tvar wikiLinkTemplateMacro = this.getVariable(\&quot;tv-wikilink-template\&quot;),\n\t\twikiLinkTemplate = wikiLinkTemplateMacro ? wikiLinkTemplateMacro.trim() : \&quot;#$uri_encoded$\&quot;,\n\t\twikiLinkText = wikiLinkTemplate.replace(\&quot;$uri_encoded$\&quot;,encodeURIComponent(this.to));\n\twikiLinkText = wikiLinkText.replace(\&quot;$uri_doubleencoded$\&quot;,encodeURIComponent(encodeURIComponent(this.to)));\n\tdomNode.setAttribute(\&quot;href\&quot;,wikiLinkText);\n\t// Set the tooltip\n\t// HACK: Performance issues with re-parsing the tooltip prevent us defaulting the tooltip to \&quot;&lt;$transclude field='tooltip'&gt;&lt;$transclude field='title'/&gt;&lt;/$transclude&gt;\&quot;\n\tvar tooltipWikiText = this.tooltip || this.getVariable(\&quot;tv-wikilink-tooltip\&quot;);\n\tif(tooltipWikiText) {\n\t\tvar tooltipText = this.wiki.renderText(\&quot;text/plain\&quot;,\&quot;text/vnd.tiddlywiki\&quot;,tooltipWikiText,{\n\t\t\t\tparseAsInline: true,\n\t\t\t\tvariables: {\n\t\t\t\t\tcurrentTiddler: this.to\n\t\t\t\t},\n\t\t\t\tparentWidget: this\n\t\t\t});\n\t\tdomNode.setAttribute(\&quot;title\&quot;,tooltipText);\n\t}\n\tif(this[\&quot;aria-label\&quot;]) {\n\t\tdomNode.setAttribute(\&quot;aria-label\&quot;,this[\&quot;aria-label\&quot;]);\n\t}\n\t// Add a click event handler\n\t$tw.utils.addEventListeners(domNode,[\n\t\t{name: \&quot;click\&quot;, handlerObject: this, handlerMethod: \&quot;handleClickEvent\&quot;},\n\t\t{name: \&quot;dragstart\&quot;, handlerObject: this, handlerMethod: \&quot;handleDragStartEvent\&quot;},\n\t\t{name: \&quot;dragend\&quot;, handlerObject: this, handlerMethod: \&quot;handleDragEndEvent\&quot;}\n\t]);\n\t// Insert the link into the DOM and render any children\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.renderChildren(domNode,null);\n\tthis.domNodes.push(domNode);\n};\n\nLinkWidget.prototype.handleClickEvent = function (event) {\n\t// Send the click on it's way as a navigate event\n\tvar bounds = this.domNodes[0].getBoundingClientRect();\n\tthis.dispatchEvent({\n\t\ttype: \&quot;tm-navigate\&quot;,\n\t\tnavigateTo: this.to,\n\t\tnavigateFromTitle: this.getVariable(\&quot;storyTiddler\&quot;),\n\t\tnavigateFromNode: this,\n\t\tnavigateFromClientRect: { top: bounds.top, left: bounds.left, width: bounds.width, right: bounds.right, bottom: bounds.bottom, height: bounds.height\n\t\t},\n\t\tnavigateSuppressNavigation: event.metaKey || event.ctrlKey || (event.button === 1)\n\t});\n\tevent.preventDefault();\n\tevent.stopPropagation();\n\treturn false;\n};\n\nLinkWidget.prototype.handleDragStartEvent = function(event) {\n\tif(event.target === this.domNodes[0]) {\n\t\tif(this.to) {\n\t\t\t// Set the dragging class on the element being dragged\n\t\t\t$tw.utils.addClass(event.target,\&quot;tc-tiddlylink-dragging\&quot;);\n\t\t\t// Create the drag image elements\n\t\t\tthis.dragImage = this.document.createElement(\&quot;div\&quot;);\n\t\t\tthis.dragImage.className = \&quot;tc-tiddler-dragger\&quot;;\n\t\t\tvar inner = this.document.createElement(\&quot;div\&quot;);\n\t\t\tinner.className = \&quot;tc-tiddler-dragger-inner\&quot;;\n\t\t\tinner.appendChild(this.document.createTextNode(this.to));\n\t\t\tthis.dragImage.appendChild(inner);\n\t\t\tthis.document.body.appendChild(this.dragImage);\n\t\t\t// Astoundingly, we need to cover the dragger up: http://www.kryogenix.org/code/browser/custom-drag-image.html\n\t\t\tvar cover = this.document.createElement(\&quot;div\&quot;);\n\t\t\tcover.className = \&quot;tc-tiddler-dragger-cover\&quot;;\n\t\t\tcover.style.left = (inner.offsetLeft - 16) + \&quot;px\&quot;;\n\t\t\tcover.style.top = (inner.offsetTop - 16) + \&quot;px\&quot;;\n\t\t\tcover.style.width = (inner.offsetWidth + 32) + \&quot;px\&quot;;\n\t\t\tcover.style.height = (inner.offsetHeight + 32) + \&quot;px\&quot;;\n\t\t\tthis.dragImage.appendChild(cover);\n\t\t\t// Set the data transfer properties\n\t\t\tvar dataTransfer = event.dataTransfer;\n\t\t\t// First the image\n\t\t\tdataTransfer.effectAllowed = \&quot;copy\&quot;;\n\t\t\tif(dataTransfer.setDragImage) {\n\t\t\t\tdataTransfer.setDragImage(this.dragImage.firstChild,-16,-16);\n\t\t\t}\n\t\t\t// Then the data\n\t\t\tdataTransfer.clearData();\n\t\t\tvar jsonData = this.wiki.getTiddlerAsJson(this.to),\n\t\t\t\ttextData = this.wiki.getTiddlerText(this.to,\&quot;\&quot;),\n\t\t\t\ttitle = (new RegExp(\&quot;^\&quot; + $tw.config.textPrimitives.wikiLink + \&quot;$\&quot;,\&quot;mg\&quot;)).exec(this.to) ? this.to : \&quot;[[\&quot; + this.to + \&quot;]]\&quot;;\n\t\t\t// IE doesn't like these content types\n\t\t\tif(!$tw.browser.isIE) {\n\t\t\t\tdataTransfer.setData(\&quot;text/vnd.tiddler\&quot;,jsonData);\n\t\t\t\tdataTransfer.setData(\&quot;text/plain\&quot;,title);\n\t\t\t\tdataTransfer.setData(\&quot;text/x-moz-url\&quot;,\&quot;data:text/vnd.tiddler,\&quot; + encodeURI(jsonData));\n\t\t\t}\n\t\t\tdataTransfer.setData(\&quot;URL\&quot;,\&quot;data:text/vnd.tiddler,\&quot; + encodeURI(jsonData));\n\t\t\tdataTransfer.setData(\&quot;Text\&quot;,title);\n\t\t\tevent.stopPropagation();\n\t\t} else {\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n};\n\nLinkWidget.prototype.handleDragEndEvent = function(event) {\n\tif(event.target === this.domNodes[0]) {\n\t\t// Remove the dragging class on the element being dragged\n\t\t$tw.utils.removeClass(event.target,\&quot;tc-tiddlylink-dragging\&quot;);\n\t\t// Delete the drag image element\n\t\tif(this.dragImage) {\n\t\t\tthis.dragImage.parentNode.removeChild(this.dragImage);\n\t\t}\n\t}\n};\n\n/*\nCompute the internal state of the widget\n*/\nLinkWidget.prototype.execute = function() {\n\t// Get the target tiddler title\n\tthis.to = this.getAttribute(\&quot;to\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\t// Get the link title and aria label\n\tthis.tooltip = this.getAttribute(\&quot;tooltip\&quot;);\n\tthis[\&quot;aria-label\&quot;] = this.getAttribute(\&quot;aria-label\&quot;);\n\t// Get the link classes\n\tthis.linkClasses = this.getAttribute(\&quot;class\&quot;);\n\t// Determine the link characteristics\n\tthis.isMissing = !this.wiki.tiddlerExists(this.to);\n\tthis.isShadow = this.wiki.isShadowTiddler(this.to);\n\t// Make the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nLinkWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.to || changedTiddlers[this.to] || changedAttributes[\&quot;aria-label\&quot;] || changedAttributes.tooltip) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t}\n\treturn this.refreshChildren(changedTiddlers);\n};\n\nexports.link = LinkWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/link.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/linkcatcher.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/linkcatcher.js\ntype: application/javascript\nmodule-type: widget\n\nLinkcatcher widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar LinkCatcherWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n\tthis.addEventListeners([\n\t\t{type: \&quot;tm-navigate\&quot;, handler: \&quot;handleNavigateEvent\&quot;}\n\t]);\n};\n\n/*\nInherit from the base widget class\n*/\nLinkCatcherWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nLinkCatcherWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nLinkCatcherWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.catchTo = this.getAttribute(\&quot;to\&quot;);\n\tthis.catchMessage = this.getAttribute(\&quot;message\&quot;);\n\tthis.catchSet = this.getAttribute(\&quot;set\&quot;);\n\tthis.catchSetTo = this.getAttribute(\&quot;setTo\&quot;);\n\t// Construct the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nLinkCatcherWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.to || changedAttributes.message || changedAttributes.set || changedAttributes.setTo) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\t\t\n\t}\n};\n\n/*\nHandle a tm-navigate event\n*/\nLinkCatcherWidget.prototype.handleNavigateEvent = function(event) {\n\tif(this.catchTo) {\n\t\tthis.wiki.setTextReference(this.catchTo,event.navigateTo,this.getVariable(\&quot;currentTiddler\&quot;));\n\t}\n\tif(this.catchMessage &amp;&amp; this.parentWidget) {\n\t\tthis.parentWidget.dispatchEvent({\n\t\t\ttype: this.catchMessage,\n\t\t\tparam: event.navigateTo,\n\t\t\tnavigateTo: event.navigateTo\n\t\t});\n\t}\n\tif(this.catchSet) {\n\t\tvar tiddler = this.wiki.getTiddler(this.catchSet);\n\t\tthis.wiki.addTiddler(new $tw.Tiddler(tiddler,{title: this.catchSet, text: this.catchSetTo}));\n\t}\n\treturn false;\n};\n\nexports.linkcatcher = LinkCatcherWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/linkcatcher.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/list.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/list.js\ntype: application/javascript\nmodule-type: widget\n\nList and list item widgets\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\n/*\nThe list widget creates list element sub-widgets that reach back into the list widget for their configuration\n*/\n\nvar ListWidget = function(parseTreeNode,options) {\n\t// Initialise the storyviews if they've not been done already\n\tif(!this.storyViews) {\n\t\tListWidget.prototype.storyViews = {};\n\t\t$tw.modules.applyMethods(\&quot;storyview\&quot;,this.storyViews);\n\t}\n\t// Main initialisation inherited from widget.js\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nListWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nListWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n\t// Construct the storyview\n\tvar StoryView = this.storyViews[this.storyViewName];\n\tif(StoryView &amp;&amp; !this.document.isTiddlyWikiFakeDom) {\n\t\tthis.storyview = new StoryView(this);\n\t} else {\n\t\tthis.storyview = null;\n\t}\n};\n\n/*\nCompute the internal state of the widget\n*/\nListWidget.prototype.execute = function() {\n\t// Get our attributes\n\tthis.template = this.getAttribute(\&quot;template\&quot;);\n\tthis.editTemplate = this.getAttribute(\&quot;editTemplate\&quot;);\n\tthis.variableName = this.getAttribute(\&quot;variable\&quot;,\&quot;currentTiddler\&quot;);\n\tthis.storyViewName = this.getAttribute(\&quot;storyview\&quot;);\n\tthis.historyTitle = this.getAttribute(\&quot;history\&quot;);\n\t// Compose the list elements\n\tthis.list = this.getTiddlerList();\n\tvar members = [],\n\t\tself = this;\n\t// Check for an empty list\n\tif(this.list.length === 0) {\n\t\tmembers = this.getEmptyMessage();\n\t} else {\n\t\t$tw.utils.each(this.list,function(title,index) {\n\t\t\tmembers.push(self.makeItemTemplate(title));\n\t\t});\n\t}\n\t// Construct the child widgets\n\tthis.makeChildWidgets(members);\n\t// Clear the last history\n\tthis.history = [];\n};\n\nListWidget.prototype.getTiddlerList = function() {\n\tvar defaultFilter = \&quot;[!is[system]sort[title]]\&quot;;\n\treturn this.wiki.filterTiddlers(this.getAttribute(\&quot;filter\&quot;,defaultFilter),this);\n};\n\nListWidget.prototype.getEmptyMessage = function() {\n\tvar emptyMessage = this.getAttribute(\&quot;emptyMessage\&quot;,\&quot;\&quot;),\n\t\tparser = this.wiki.parseText(\&quot;text/vnd.tiddlywiki\&quot;,emptyMessage,{parseAsInline: true});\n\tif(parser) {\n\t\treturn parser.tree;\n\t} else {\n\t\treturn [];\n\t}\n};\n\n/*\nCompose the template for a list item\n*/\nListWidget.prototype.makeItemTemplate = function(title) {\n\t// Check if the tiddler is a draft\n\tvar tiddler = this.wiki.getTiddler(title),\n\t\tisDraft = tiddler &amp;&amp; tiddler.hasField(\&quot;draft.of\&quot;),\n\t\ttemplate = this.template,\n\t\ttemplateTree;\n\tif(isDraft &amp;&amp; this.editTemplate) {\n\t\ttemplate = this.editTemplate;\n\t}\n\t// Compose the transclusion of the template\n\tif(template) {\n\t\ttemplateTree = [{type: \&quot;transclude\&quot;, attributes: {tiddler: {type: \&quot;string\&quot;, value: template}}}];\n\t} else {\n\t\tif(this.parseTreeNode.children &amp;&amp; this.parseTreeNode.children.length &gt; 0) {\n\t\t\ttemplateTree = this.parseTreeNode.children;\n\t\t} else {\n\t\t\t// Default template is a link to the title\n\t\t\ttemplateTree = [{type: \&quot;element\&quot;, tag: this.parseTreeNode.isBlock ? \&quot;div\&quot; : \&quot;span\&quot;, children: [{type: \&quot;link\&quot;, attributes: {to: {type: \&quot;string\&quot;, value: title}}, children: [\n\t\t\t\t\t{type: \&quot;text\&quot;, text: title}\n\t\t\t]}]}];\n\t\t}\n\t}\n\t// Return the list item\n\treturn {type: \&quot;listitem\&quot;, itemTitle: title, variableName: this.variableName, children: templateTree};\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nListWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\t// Completely refresh if any of our attributes have changed\n\tif(changedAttributes.filter || changedAttributes.template || changedAttributes.editTemplate || changedAttributes.emptyMessage || changedAttributes.storyview || changedAttributes.history) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\t// Handle any changes to the list\n\t\tvar hasChanged = this.handleListChanges(changedTiddlers);\n\t\t// Handle any changes to the history stack\n\t\tif(this.historyTitle &amp;&amp; changedTiddlers[this.historyTitle]) {\n\t\t\tthis.handleHistoryChanges();\n\t\t}\n\t\treturn hasChanged;\n\t}\n};\n\n/*\nHandle any changes to the history list\n*/\nListWidget.prototype.handleHistoryChanges = function() {\n\t// Get the history data\n\tvar newHistory = this.wiki.getTiddlerData(this.historyTitle,[]);\n\t// Ignore any entries of the history that match the previous history\n\tvar entry = 0;\n\twhile(entry &lt; newHistory.length &amp;&amp; entry &lt; this.history.length &amp;&amp; newHistory[entry].title === this.history[entry].title) {\n\t\tentry++;\n\t}\n\t// Navigate forwards to each of the new tiddlers\n\twhile(entry &lt; newHistory.length) {\n\t\tif(this.storyview &amp;&amp; this.storyview.navigateTo) {\n\t\t\tthis.storyview.navigateTo(newHistory[entry]);\n\t\t}\n\t\tentry++;\n\t}\n\t// Update the history\n\tthis.history = newHistory;\n};\n\n/*\nProcess any changes to the list\n*/\nListWidget.prototype.handleListChanges = function(changedTiddlers) {\n\t// Get the new list\n\tvar prevList = this.list;\n\tthis.list = this.getTiddlerList();\n\t// Check for an empty list\n\tif(this.list.length === 0) {\n\t\t// Check if it was empty before\n\t\tif(prevList.length === 0) {\n\t\t\t// If so, just refresh the empty message\n\t\t\treturn this.refreshChildren(changedTiddlers);\n\t\t} else {\n\t\t\t// Replace the previous content with the empty message\n\t\t\tfor(t=this.children.length-1; t&gt;=0; t--) {\n\t\t\t\tthis.removeListItem(t);\n\t\t\t}\n\t\t\tvar nextSibling = this.findNextSiblingDomNode();\n\t\t\tthis.makeChildWidgets(this.getEmptyMessage());\n\t\t\tthis.renderChildren(this.parentDomNode,nextSibling);\n\t\t\treturn true;\n\t\t}\n\t} else {\n\t\t// If the list was empty then we need to remove the empty message\n\t\tif(prevList.length === 0) {\n\t\t\tthis.removeChildDomNodes();\n\t\t\tthis.children = [];\n\t\t}\n\t\t// Cycle through the list, inserting and removing list items as needed\n\t\tvar hasRefreshed = false;\n\t\tfor(var t=0; t&lt;this.list.length; t++) {\n\t\t\tvar index = this.findListItem(t,this.list[t]);\n\t\t\tif(index === undefined) {\n\t\t\t\t// The list item must be inserted\n\t\t\t\tthis.insertListItem(t,this.list[t]);\n\t\t\t\thasRefreshed = true;\n\t\t\t} else {\n\t\t\t\t// There are intervening list items that must be removed\n\t\t\t\tfor(var n=index-1; n&gt;=t; n--) {\n\t\t\t\t\tthis.removeListItem(n);\n\t\t\t\t\thasRefreshed = true;\n\t\t\t\t}\n\t\t\t\t// Refresh the item we're reusing\n\t\t\t\tvar refreshed = this.children[t].refresh(changedTiddlers);\n\t\t\t\thasRefreshed = hasRefreshed || refreshed;\n\t\t\t}\n\t\t}\n\t\t// Remove any left over items\n\t\tfor(t=this.children.length-1; t&gt;=this.list.length; t--) {\n\t\t\tthis.removeListItem(t);\n\t\t\thasRefreshed = true;\n\t\t}\n\t\treturn hasRefreshed;\n\t}\n};\n\n/*\nFind the list item with a given title, starting from a specified position\n*/\nListWidget.prototype.findListItem = function(startIndex,title) {\n\twhile(startIndex &lt; this.children.length) {\n\t\tif(this.children[startIndex].parseTreeNode.itemTitle === title) {\n\t\t\treturn startIndex;\n\t\t}\n\t\tstartIndex++;\n\t}\n\treturn undefined;\n};\n\n/*\nInsert a new list item at the specified index\n*/\nListWidget.prototype.insertListItem = function(index,title) {\n\t// Create, insert and render the new child widgets\n\tvar widget = this.makeChildWidget(this.makeItemTemplate(title));\n\twidget.parentDomNode = this.parentDomNode; // Hack to enable findNextSiblingDomNode() to work\n\tthis.children.splice(index,0,widget);\n\tvar nextSibling = widget.findNextSiblingDomNode();\n\twidget.render(this.parentDomNode,nextSibling);\n\t// Animate the insertion if required\n\tif(this.storyview &amp;&amp; this.storyview.insert) {\n\t\tthis.storyview.insert(widget);\n\t}\n\treturn true;\n};\n\n/*\nRemove the specified list item\n*/\nListWidget.prototype.removeListItem = function(index) {\n\tvar widget = this.children[index];\n\t// Animate the removal if required\n\tif(this.storyview &amp;&amp; this.storyview.remove) {\n\t\tthis.storyview.remove(widget);\n\t} else {\n\t\twidget.removeChildDomNodes();\n\t}\n\t// Remove the child widget\n\tthis.children.splice(index,1);\n};\n\nexports.list = ListWidget;\n\nvar ListItemWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nListItemWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nListItemWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nListItemWidget.prototype.execute = function() {\n\t// Set the current list item title\n\tthis.setVariable(this.parseTreeNode.variableName,this.parseTreeNode.itemTitle);\n\t// Construct the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nListItemWidget.prototype.refresh = function(changedTiddlers) {\n\treturn this.refreshChildren(changedTiddlers);\n};\n\nexports.listitem = ListItemWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/list.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/macrocall.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/macrocall.js\ntype: application/javascript\nmodule-type: widget\n\nMacrocall widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar MacroCallWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nMacroCallWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nMacroCallWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nMacroCallWidget.prototype.execute = function() {\n\t// Get the parse type if specified\n\tthis.parseType = this.getAttribute(\&quot;$type\&quot;,\&quot;text/vnd.tiddlywiki\&quot;);\n\tthis.renderOutput = this.getAttribute(\&quot;$output\&quot;,\&quot;text/html\&quot;);\n\t// Merge together the parameters specified in the parse tree with the specified attributes\n\tvar params = this.parseTreeNode.params ? this.parseTreeNode.params.slice(0) : [];\n\t$tw.utils.each(this.attributes,function(attribute,name) {\n\t\tif(name.charAt(0) !== \&quot;$\&quot;) {\n\t\t\tparams.push({name: name, value: attribute});\t\t\t\n\t\t}\n\t});\n\t// Get the macro value\n\tvar text = this.getVariable(this.parseTreeNode.name || this.getAttribute(\&quot;$name\&quot;),{params: params}),\n\t\tparseTreeNodes;\n\t// Are we rendering to HTML?\n\tif(this.renderOutput === \&quot;text/html\&quot;) {\n\t\t// If so we'll return the parsed macro\n\t\tvar parser = this.wiki.parseText(this.parseType,text,\n\t\t\t\t\t\t\t{parseAsInline: !this.parseTreeNode.isBlock});\n\t\tparseTreeNodes = parser ? parser.tree : [];\n\t} else {\n\t\t// Otherwise, we'll render the text\n\t\tvar plainText = this.wiki.renderText(\&quot;text/plain\&quot;,this.parseType,text,{parentWidget: this});\n\t\tparseTreeNodes = [{type: \&quot;text\&quot;, text: plainText}];\n\t}\n\t// Construct the child widgets\n\tthis.makeChildWidgets(parseTreeNodes);\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nMacroCallWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif($tw.utils.count(changedAttributes) &gt; 0) {\n\t\t// Rerender ourselves\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\n\t}\n};\n\nexports.macrocall = MacroCallWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/macrocall.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/navigator.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/navigator.js\ntype: application/javascript\nmodule-type: widget\n\nNavigator widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar IMPORT_TITLE = \&quot;$:/Import\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar NavigatorWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n\tthis.addEventListeners([\n\t\t{type: \&quot;tm-navigate\&quot;, handler: \&quot;handleNavigateEvent\&quot;},\n\t\t{type: \&quot;tm-edit-tiddler\&quot;, handler: \&quot;handleEditTiddlerEvent\&quot;},\n\t\t{type: \&quot;tm-delete-tiddler\&quot;, handler: \&quot;handleDeleteTiddlerEvent\&quot;},\n\t\t{type: \&quot;tm-save-tiddler\&quot;, handler: \&quot;handleSaveTiddlerEvent\&quot;},\n\t\t{type: \&quot;tm-cancel-tiddler\&quot;, handler: \&quot;handleCancelTiddlerEvent\&quot;},\n\t\t{type: \&quot;tm-close-tiddler\&quot;, handler: \&quot;handleCloseTiddlerEvent\&quot;},\n\t\t{type: \&quot;tm-close-all-tiddlers\&quot;, handler: \&quot;handleCloseAllTiddlersEvent\&quot;},\n\t\t{type: \&quot;tm-close-other-tiddlers\&quot;, handler: \&quot;handleCloseOtherTiddlersEvent\&quot;},\n\t\t{type: \&quot;tm-new-tiddler\&quot;, handler: \&quot;handleNewTiddlerEvent\&quot;},\n\t\t{type: \&quot;tm-import-tiddlers\&quot;, handler: \&quot;handleImportTiddlersEvent\&quot;},\n\t\t{type: \&quot;tm-perform-import\&quot;, handler: \&quot;handlePerformImportEvent\&quot;}\n\t]);\n};\n\n/*\nInherit from the base widget class\n*/\nNavigatorWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nNavigatorWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nNavigatorWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.storyTitle = this.getAttribute(\&quot;story\&quot;);\n\tthis.historyTitle = this.getAttribute(\&quot;history\&quot;);\n\t// Construct the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nNavigatorWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.story || changedAttributes.history) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\t\t\n\t}\n};\n\nNavigatorWidget.prototype.getStoryList = function() {\n\treturn this.storyTitle ? this.wiki.getTiddlerList(this.storyTitle) : null;\n};\n\nNavigatorWidget.prototype.saveStoryList = function(storyList) {\n\tvar storyTiddler = this.wiki.getTiddler(this.storyTitle);\n\tthis.wiki.addTiddler(new $tw.Tiddler(\n\t\t{title: this.storyTitle},\n\t\tstoryTiddler,\n\t\t{list: storyList}\n\t));\n};\n\nNavigatorWidget.prototype.findTitleInStory = function(storyList,title,defaultIndex) {\n\tvar p = storyList.indexOf(title);\n\treturn p === -1 ? defaultIndex : p;\n};\n\nNavigatorWidget.prototype.removeTitleFromStory = function(storyList,title) {\n\tvar p = storyList.indexOf(title);\n\twhile(p !== -1) {\n\t\tstoryList.splice(p,1);\n\t\tp = storyList.indexOf(title);\n\t}\n};\n\nNavigatorWidget.prototype.replaceFirstTitleInStory = function(storyList,oldTitle,newTitle) {\n\tvar pos = storyList.indexOf(oldTitle);\n\tif(pos !== -1) {\n\t\tstoryList[pos] = newTitle;\n\t\tdo {\n\t\t\tpos = storyList.indexOf(oldTitle,pos + 1);\n\t\t\tif(pos !== -1) {\n\t\t\t\tstoryList.splice(pos,1);\n\t\t\t}\n\t\t} while(pos !== -1);\n\t} else {\n\t\tstoryList.splice(0,0,newTitle);\n\t}\n};\n\nNavigatorWidget.prototype.addToStory = function(title,fromTitle) {\n\tvar storyList = this.getStoryList();\n\tif(storyList) {\n\t\t// See if the tiddler is already there\n\t\tvar slot = this.findTitleInStory(storyList,title,-1);\n\t\t// If not we need to add it\n\t\tif(slot === -1) {\n\t\t\t// First we try to find the position of the story element we navigated from\n\t\t\tslot = this.findTitleInStory(storyList,fromTitle,-1) + 1;\n\t\t\t// Add the tiddler\n\t\t\tstoryList.splice(slot,0,title);\n\t\t\t// Save the story\n\t\t\tthis.saveStoryList(storyList);\n\t\t}\n\t}\n};\n\n/*\nAdd a new record to the top of the history stack\ntitle: a title string or an array of title strings\nfromPageRect: page coordinates of the origin of the navigation\n*/\nNavigatorWidget.prototype.addToHistory = function(title,fromPageRect) {\n\tthis.wiki.addToHistory(title,fromPageRect,this.historyTitle);\n};\n\n/*\nHandle a tm-navigate event\n*/\nNavigatorWidget.prototype.handleNavigateEvent = function(event) {\n\tthis.addToStory(event.navigateTo,event.navigateFromTitle);\n\tif(!event.navigateSuppressNavigation) {\n\t\tthis.addToHistory(event.navigateTo,event.navigateFromClientRect);\n\t}\n\treturn false;\n};\n\n// Close a specified tiddler\nNavigatorWidget.prototype.handleCloseTiddlerEvent = function(event) {\n\tvar title = event.param || event.tiddlerTitle,\n\t\tstoryList = this.getStoryList();\n\t// Look for tiddlers with this title to close\n\tthis.removeTitleFromStory(storyList,title);\n\tthis.saveStoryList(storyList);\n\treturn false;\n};\n\n// Close all tiddlers\nNavigatorWidget.prototype.handleCloseAllTiddlersEvent = function(event) {\n\tthis.saveStoryList([]);\n\treturn false;\n};\n\n// Close other tiddlers\nNavigatorWidget.prototype.handleCloseOtherTiddlersEvent = function(event) {\n\tvar title = event.param || event.tiddlerTitle;\n\tthis.saveStoryList([title]);\n\treturn false;\n};\n\n// Place a tiddler in edit mode\nNavigatorWidget.prototype.handleEditTiddlerEvent = function(event) {\n\tvar self = this;\n\tfunction isUnmodifiedShadow(title) {\n\t\treturn self.wiki.isShadowTiddler(title) &amp;&amp; !self.wiki.tiddlerExists(title);\n\t}\n\tfunction confirmEditShadow(title) {\n\t\treturn confirm($tw.language.getString(\n\t\t\t\&quot;ConfirmEditShadowTiddler\&quot;,\n\t\t\t{variables:\n\t\t\t\t{title: title}\n\t\t\t}\n\t\t));\n\t}\n\tvar title = event.param || event.tiddlerTitle;\n\tif(isUnmodifiedShadow(title) &amp;&amp; !confirmEditShadow(title)) {\n\t\treturn false;\n\t}\n\t// Replace the specified tiddler with a draft in edit mode\n\tvar draftTiddler = this.makeDraftTiddler(title),\n\t\tdraftTitle = draftTiddler.fields.title,\n\t\tstoryList = this.getStoryList();\n\tthis.removeTitleFromStory(storyList,draftTitle);\n\tthis.replaceFirstTitleInStory(storyList,title,draftTitle);\n\tthis.addToHistory(draftTitle,event.navigateFromClientRect);\n\tthis.saveStoryList(storyList);\n\treturn false;\n};\n\n// Delete a tiddler\nNavigatorWidget.prototype.handleDeleteTiddlerEvent = function(event) {\n\t// Get the tiddler we're deleting\n\tvar title = event.param || event.tiddlerTitle,\n\t\ttiddler = this.wiki.getTiddler(title),\n\t\tstoryList = this.getStoryList(),\n\t\toriginalTitle = tiddler.fields[\&quot;draft.of\&quot;],\n\t\tconfirmationTitle;\n\t// Check if the tiddler we're deleting is in draft mode\n\tif(originalTitle) {\n\t\t// If so, we'll prompt for confirmation referencing the original tiddler\n\t\tconfirmationTitle = originalTitle;\n\t} else {\n\t\t// If not a draft, then prompt for confirmation referencing the specified tiddler\n\t\tconfirmationTitle = title;\n\t}\n\t// Seek confirmation\n\tif((this.wiki.getTiddler(originalTitle) || (tiddler.fields.text || \&quot;\&quot;) !== \&quot;\&quot;) &amp;&amp; !confirm($tw.language.getString(\n\t\t\t\t\&quot;ConfirmDeleteTiddler\&quot;,\n\t\t\t\t{variables:\n\t\t\t\t\t{title: confirmationTitle}\n\t\t\t\t}\n\t\t\t))) {\n\t\treturn false;\n\t}\n\t// Delete the original tiddler\n\tif(originalTitle) {\n\t\tthis.wiki.deleteTiddler(originalTitle);\n\t\tthis.removeTitleFromStory(storyList,originalTitle);\n\t}\n\t// Delete this tiddler\n\tthis.wiki.deleteTiddler(title);\n\t// Remove the closed tiddler from the story\n\tthis.removeTitleFromStory(storyList,title);\n\tthis.saveStoryList(storyList);\n\t// Trigger an autosave\n\t$tw.rootWidget.dispatchEvent({type: \&quot;tm-auto-save-wiki\&quot;});\n\treturn false;\n};\n\n/*\nCreate/reuse the draft tiddler for a given title\n*/\nNavigatorWidget.prototype.makeDraftTiddler = function(targetTitle) {\n\t// See if there is already a draft tiddler for this tiddler\n\tvar draftTitle = this.wiki.findDraft(targetTitle);\n\tif(draftTitle) {\n\t\treturn this.wiki.getTiddler(draftTitle);\n\t}\n\t// Get the current value of the tiddler we're editing\n\tvar tiddler = this.wiki.getTiddler(targetTitle);\n\t// Save the initial value of the draft tiddler\n\tdraftTitle = this.generateDraftTitle(targetTitle);\n\tvar draftTiddler = new $tw.Tiddler(\n\t\t\ttiddler,\n\t\t\t{\n\t\t\t\ttitle: draftTitle,\n\t\t\t\t\&quot;draft.title\&quot;: targetTitle,\n\t\t\t\t\&quot;draft.of\&quot;: targetTitle\n\t\t\t},\n\t\t\tthis.wiki.getModificationFields()\n\t\t);\n\tthis.wiki.addTiddler(draftTiddler);\n\treturn draftTiddler;\n};\n\n/*\nGenerate a title for the draft of a given tiddler\n*/\nNavigatorWidget.prototype.generateDraftTitle = function(title) {\n\tvar c = 0,\n\t\tdraftTitle;\n\tdo {\n\t\tdraftTitle = \&quot;Draft \&quot; + (c ? (c + 1) + \&quot; \&quot; : \&quot;\&quot;) + \&quot;of '\&quot; + title + \&quot;'\&quot;;\n\t\tc++;\n\t} while(this.wiki.tiddlerExists(draftTitle));\n\treturn draftTitle;\n};\n\n// Take a tiddler out of edit mode, saving the changes\nNavigatorWidget.prototype.handleSaveTiddlerEvent = function(event) {\n\tvar title = event.param || event.tiddlerTitle,\n\t\ttiddler = this.wiki.getTiddler(title),\n\t\tstoryList = this.getStoryList();\n\t// Replace the original tiddler with the draft\n\tif(tiddler) {\n\t\tvar draftTitle = (tiddler.fields[\&quot;draft.title\&quot;] || \&quot;\&quot;).trim(),\n\t\t\tdraftOf = (tiddler.fields[\&quot;draft.of\&quot;] || \&quot;\&quot;).trim();\n\t\tif(draftTitle) {\n\t\t\tvar isRename = draftOf !== draftTitle,\n\t\t\t\tisConfirmed = true;\n\t\t\tif(isRename &amp;&amp; this.wiki.tiddlerExists(draftTitle)) {\n\t\t\t\tisConfirmed = confirm($tw.language.getString(\n\t\t\t\t\t\&quot;ConfirmOverwriteTiddler\&quot;,\n\t\t\t\t\t{variables:\n\t\t\t\t\t\t{title: draftTitle}\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t\t}\n\t\t\tif(isConfirmed) {\n\t\t\t\t// Save the draft tiddler as the real tiddler\n\t\t\t\tthis.wiki.addTiddler(new $tw.Tiddler(this.wiki.getCreationFields(),tiddler,{\n\t\t\t\t\ttitle: draftTitle,\n\t\t\t\t\t\&quot;draft.title\&quot;: undefined,\n\t\t\t\t\t\&quot;draft.of\&quot;: undefined\n\t\t\t\t},this.wiki.getModificationFields()));\n\t\t\t\t// Remove the draft tiddler\n\t\t\t\tthis.wiki.deleteTiddler(title);\n\t\t\t\t// Remove the original tiddler if we're renaming it\n\t\t\t\tif(isRename) {\n\t\t\t\t\tthis.wiki.deleteTiddler(draftOf);\n\t\t\t\t}\n\t\t\t\t// Replace the draft in the story with the original\n\t\t\t\tthis.replaceFirstTitleInStory(storyList,title,draftTitle);\n\t\t\t\tthis.addToHistory(draftTitle,event.navigateFromClientRect);\n\t\t\t\tif(draftTitle !== this.storyTitle) {\n\t\t\t\t\tthis.saveStoryList(storyList);\n\t\t\t\t}\n\t\t\t\t// Trigger an autosave\n\t\t\t\t$tw.rootWidget.dispatchEvent({type: \&quot;tm-auto-save-wiki\&quot;});\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n\n// Take a tiddler out of edit mode without saving the changes\nNavigatorWidget.prototype.handleCancelTiddlerEvent = function(event) {\n\t// Flip the specified tiddler from draft back to the original\n\tvar draftTitle = event.param || event.tiddlerTitle,\n\t\tdraftTiddler = this.wiki.getTiddler(draftTitle),\n\t\toriginalTitle = draftTiddler.fields[\&quot;draft.of\&quot;],\n\t\toriginalTiddler = this.wiki.getTiddler(originalTitle),\n\t\tstoryList = this.getStoryList();\n\tif(draftTiddler &amp;&amp; originalTitle) {\n\t\t// Ask for confirmation if the tiddler text has changed\n\t\tvar isConfirmed = true;\n\t\tif(this.wiki.isDraftModified(draftTitle)) {\n\t\t\tisConfirmed = confirm($tw.language.getString(\n\t\t\t\t\&quot;ConfirmCancelTiddler\&quot;,\n\t\t\t\t{variables:\n\t\t\t\t\t{title: draftTitle}\n\t\t\t\t}\n\t\t\t));\n\t\t}\n\t\t// Remove the draft tiddler\n\t\tif(isConfirmed) {\n\t\t\tthis.wiki.deleteTiddler(draftTitle);\n\t\t\tif(originalTiddler) {\n\t\t\t\tthis.replaceFirstTitleInStory(storyList,draftTitle,originalTitle);\n\t\t\t\tthis.addToHistory(originalTitle,event.navigateFromClientRect);\n\t\t\t} else {\n\t\t\t\tthis.removeTitleFromStory(storyList,draftTitle);\n\t\t\t}\n\t\t\tthis.saveStoryList(storyList);\n\t\t\t// Trigger an autosave\n\t\t\t$tw.rootWidget.dispatchEvent({type: \&quot;tm-auto-save-wiki\&quot;});\t\t\t\n\t\t}\n\t}\n\treturn false;\n};\n\n// Create a new draft tiddler\n// event.param can either be the title of a template tiddler, or a hashmap of fields.\n//\n// The title of the newly created tiddler follows these rules:\n// * If a hashmap was used and a title field was specified, use that title\n// * If a hashmap was used without a title field, use a default title, if necessary making it unique with a numeric suffix\n// * If a template tiddler was used, use the title of the template, if necessary making it unique with a numeric suffix\n//\n// If a draft of the target tiddler already exists then it is reused\nNavigatorWidget.prototype.handleNewTiddlerEvent = function(event) {\n\t// Get the story details\n\tvar storyList = this.getStoryList(),\n\t\ttemplateTiddler, additionalFields, title, draftTitle, existingTiddler;\n\t// Get the template tiddler (if any)\n\tif(typeof event.param === \&quot;string\&quot;) {\n\t\t// Get the template tiddler\n\t\ttemplateTiddler = this.wiki.getTiddler(event.param);\n\t\t// Generate a new title\n\t\ttitle = this.wiki.generateNewTitle(event.param || $tw.language.getString(\&quot;DefaultNewTiddlerTitle\&quot;));\n\t}\n\t// Get the specified additional fields\n\tif(typeof event.paramObject === \&quot;object\&quot;) {\n\t\tadditionalFields = event.paramObject;\n\t}\n\tif(typeof event.param === \&quot;object\&quot;) { // Backwards compatibility with 5.1.3\n\t\tadditionalFields = event.param;\n\t}\n\tif(additionalFields &amp;&amp; additionalFields.title) {\n\t\ttitle = additionalFields.title;\n\t}\n\t// Generate a title if we don't have one\n\ttitle = title || this.wiki.generateNewTitle($tw.language.getString(\&quot;DefaultNewTiddlerTitle\&quot;));\n\t// Find any existing draft for this tiddler\n\tdraftTitle = this.wiki.findDraft(title);\n\t// Pull in any existing tiddler\n\tif(draftTitle) {\n\t\texistingTiddler = this.wiki.getTiddler(draftTitle);\n\t} else {\n\t\tdraftTitle = this.generateDraftTitle(title);\n\t\texistingTiddler = this.wiki.getTiddler(title);\n\t}\n\t// Merge the tags\n\tvar mergedTags = [];\n\tif(existingTiddler &amp;&amp; existingTiddler.fields.tags) {\n\t\t$tw.utils.pushTop(mergedTags,existingTiddler.fields.tags)\n\t}\n\tif(additionalFields &amp;&amp; additionalFields.tags) {\n\t\t// Merge tags\n\t\tmergedTags = $tw.utils.pushTop(mergedTags,$tw.utils.parseStringArray(additionalFields.tags));\n\t}\n\tif(templateTiddler &amp;&amp; templateTiddler.fields.tags) {\n\t\t// Merge tags\n\t\tmergedTags = $tw.utils.pushTop(mergedTags,templateTiddler.fields.tags);\n\t}\n\t// Save the draft tiddler\n\tvar draftTiddler = new $tw.Tiddler({\n\t\t\ttext: \&quot;\&quot;,\n\t\t\t\&quot;draft.title\&quot;: title\n\t\t},\n\t\ttemplateTiddler,\n\t\texistingTiddler,\n\t\tadditionalFields,\n\t\tthis.wiki.getCreationFields(),\n\t\t{\n\t\t\ttitle: draftTitle,\n\t\t\t\&quot;draft.of\&quot;: title,\n\t\t\ttags: mergedTags\n\t\t},this.wiki.getModificationFields());\n\tthis.wiki.addTiddler(draftTiddler);\n\t// Update the story to insert the new draft at the top and remove any existing tiddler\n\tif(storyList.indexOf(draftTitle) === -1) {\n\t\tvar slot = storyList.indexOf(event.navigateFromTitle);\n\t\tstoryList.splice(slot + 1,0,draftTitle);\n\t}\n\tif(storyList.indexOf(title) !== -1) {\n\t\tstoryList.splice(storyList.indexOf(title),1);\t\t\n\t}\n\tthis.saveStoryList(storyList);\n\t// Add a new record to the top of the history stack\n\tthis.addToHistory(draftTitle);\n\treturn false;\n};\n\n// Import JSON tiddlers into a pending import tiddler\nNavigatorWidget.prototype.handleImportTiddlersEvent = function(event) {\n\tvar self = this;\n\t// Get the tiddlers\n\tvar tiddlers = [];\n\ttry {\n\t\ttiddlers = JSON.parse(event.param);\t\n\t} catch(e) {\n\t}\n\t// Get the current $:/Import tiddler\n\tvar importTiddler = this.wiki.getTiddler(IMPORT_TITLE),\n\t\timportData = this.wiki.getTiddlerData(IMPORT_TITLE,{}),\n\t\tnewFields = new Object({\n\t\t\ttitle: IMPORT_TITLE,\n\t\t\ttype: \&quot;application/json\&quot;,\n\t\t\t\&quot;plugin-type\&quot;: \&quot;import\&quot;,\n\t\t\t\&quot;status\&quot;: \&quot;pending\&quot;\n\t\t}),\n\t\tincomingTiddlers = [];\n\t// Process each tiddler\n\timportData.tiddlers = importData.tiddlers || {};\n\t$tw.utils.each(tiddlers,function(tiddlerFields) {\n\t\tvar title = tiddlerFields.title;\n\t\tif(title) {\n\t\t\tincomingTiddlers.push(title);\n\t\t\timportData.tiddlers[title] = tiddlerFields;\n\t\t}\n\t});\n\t// Give the active upgrader modules a chance to process the incoming tiddlers\n\tvar messages = this.wiki.invokeUpgraders(incomingTiddlers,importData.tiddlers);\n\t$tw.utils.each(messages,function(message,title) {\n\t\tnewFields[\&quot;message-\&quot; + title] = message;\n\t});\n\t// Deselect any suppressed tiddlers\n\t$tw.utils.each(importData.tiddlers,function(tiddler,title) {\n\t\tif($tw.utils.count(tiddler) === 0) {\n\t\t\tnewFields[\&quot;selection-\&quot; + title] = \&quot;unchecked\&quot;;\n\t\t}\n\t});\n\t// Save the $:/Import tiddler\n\tnewFields.text = JSON.stringify(importData,null,$tw.config.preferences.jsonSpaces);\n\tthis.wiki.addTiddler(new $tw.Tiddler(importTiddler,newFields));\n\t// Update the story and history details\n\tif(this.getVariable(\&quot;tv-auto-open-on-import\&quot;) !== \&quot;no\&quot;) {\n\t\tvar storyList = this.getStoryList(),\n\t\t\thistory = [];\n\t\t// Add it to the story\n\t\tif(storyList.indexOf(IMPORT_TITLE) === -1) {\n\t\t\tstoryList.unshift(IMPORT_TITLE);\n\t\t}\n\t\t// And to history\n\t\thistory.push(IMPORT_TITLE);\n\t\t// Save the updated story and history\n\t\tthis.saveStoryList(storyList);\n\t\tthis.addToHistory(history);\t\t\n\t}\n\treturn false;\n};\n\n// \nNavigatorWidget.prototype.handlePerformImportEvent = function(event) {\n\tvar self = this,\n\t\timportTiddler = this.wiki.getTiddler(event.param),\n\t\timportData = this.wiki.getTiddlerData(event.param,{tiddlers: {}}),\n\t\timportReport = [];\n\t// Add the tiddlers to the store\n\timportReport.push(\&quot;The following tiddlers were imported:\\n\&quot;);\n\t$tw.utils.each(importData.tiddlers,function(tiddlerFields) {\n\t\tvar title = tiddlerFields.title;\n\t\tif(title &amp;&amp; importTiddler &amp;&amp; importTiddler.fields[\&quot;selection-\&quot; + title] !== \&quot;unchecked\&quot;) {\n\t\t\tself.wiki.addTiddler(new $tw.Tiddler(tiddlerFields));\n\t\t\timportReport.push(\&quot;# [[\&quot; + tiddlerFields.title + \&quot;]]\&quot;);\n\t\t}\n\t});\n\t// Replace the $:/Import tiddler with an import report\n\tthis.wiki.addTiddler(new $tw.Tiddler({\n\t\ttitle: IMPORT_TITLE,\n\t\ttext: importReport.join(\&quot;\\n\&quot;),\n\t\t\&quot;status\&quot;: \&quot;complete\&quot;\n\t}));\n\t// Navigate to the $:/Import tiddler\n\tthis.addToHistory([IMPORT_TITLE]);\n\t// Trigger an autosave\n\t$tw.rootWidget.dispatchEvent({type: \&quot;tm-auto-save-wiki\&quot;});\n};\n\nexports.navigator = NavigatorWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/navigator.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/password.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/password.js\ntype: application/javascript\nmodule-type: widget\n\nPassword widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar PasswordWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nPasswordWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nPasswordWidget.prototype.render = function(parent,nextSibling) {\n\t// Save the parent dom node\n\tthis.parentDomNode = parent;\n\t// Compute our attributes\n\tthis.computeAttributes();\n\t// Execute our logic\n\tthis.execute();\n\t// Get the current password\n\tvar password = $tw.browser ? $tw.utils.getPassword(this.passwordName) || \&quot;\&quot; : \&quot;\&quot;;\n\t// Create our element\n\tvar domNode = this.document.createElement(\&quot;input\&quot;);\n\tdomNode.setAttribute(\&quot;type\&quot;,\&quot;password\&quot;);\n\tdomNode.setAttribute(\&quot;value\&quot;,password);\n\t// Add a click event handler\n\t$tw.utils.addEventListeners(domNode,[\n\t\t{name: \&quot;change\&quot;, handlerObject: this, handlerMethod: \&quot;handleChangeEvent\&quot;}\n\t]);\n\t// Insert the label into the DOM and render any children\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.renderChildren(domNode,null);\n\tthis.domNodes.push(domNode);\n};\n\nPasswordWidget.prototype.handleChangeEvent = function(event) {\n\tvar password = this.domNodes[0].value;\n\treturn $tw.utils.savePassword(this.passwordName,password);\n};\n\n/*\nCompute the internal state of the widget\n*/\nPasswordWidget.prototype.execute = function() {\n\t// Get the parameters from the attributes\n\tthis.passwordName = this.getAttribute(\&quot;name\&quot;,\&quot;\&quot;);\n\t// Make the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nPasswordWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.name) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\n\t}\n};\n\nexports.password = PasswordWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/password.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/radio.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/radio.js\ntype: application/javascript\nmodule-type: widget\n\nRadio widget\n\nWill set a field to the selected value:\n\n```\n\t&lt;$radio field=\&quot;myfield\&quot; value=\&quot;check 1\&quot;&gt;one&lt;/$radio&gt;\n\t&lt;$radio field=\&quot;myfield\&quot; value=\&quot;check 2\&quot;&gt;two&lt;/$radio&gt;\n\t&lt;$radio field=\&quot;myfield\&quot; value=\&quot;check 3\&quot;&gt;three&lt;/$radio&gt;\n```\n\n|Parameter |Description |h\n|tiddler |Name of the tiddler in which the field should be set. Defaults to current tiddler |\n|field |The name of the field to be set |\n|value |The value to set |\n|class |Optional class name(s) |\n\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar RadioWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nRadioWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nRadioWidget.prototype.render = function(parent,nextSibling) {\n\t// Save the parent dom node\n\tthis.parentDomNode = parent;\n\t// Compute our attributes\n\tthis.computeAttributes();\n\t// Execute our logic\n\tthis.execute();\n\t// Create our elements\n\tthis.labelDomNode = this.document.createElement(\&quot;label\&quot;);\n\tthis.labelDomNode.setAttribute(\&quot;class\&quot;,this.radioClass);\n\tthis.inputDomNode = this.document.createElement(\&quot;input\&quot;);\n\tthis.inputDomNode.setAttribute(\&quot;type\&quot;,\&quot;radio\&quot;);\n\tif(this.getValue() == this.radioValue) {\n\t\tthis.inputDomNode.setAttribute(\&quot;checked\&quot;,\&quot;true\&quot;);\n\t}\n\tthis.labelDomNode.appendChild(this.inputDomNode);\n\tthis.spanDomNode = this.document.createElement(\&quot;span\&quot;);\n\tthis.labelDomNode.appendChild(this.spanDomNode);\n\t// Add a click event handler\n\t$tw.utils.addEventListeners(this.inputDomNode,[\n\t\t{name: \&quot;change\&quot;, handlerObject: this, handlerMethod: \&quot;handleChangeEvent\&quot;}\n\t]);\n\t// Insert the label into the DOM and render any children\n\tparent.insertBefore(this.labelDomNode,nextSibling);\n\tthis.renderChildren(this.spanDomNode,null);\n\tthis.domNodes.push(this.labelDomNode);\n};\n\nRadioWidget.prototype.getValue = function() {\n\tvar tiddler = this.wiki.getTiddler(this.radioTitle);\n\treturn tiddler &amp;&amp; tiddler.getFieldString(this.radioField);\n};\n\nRadioWidget.prototype.setValue = function() {\n\tif(this.radioField) {\n\t\tvar tiddler = this.wiki.getTiddler(this.radioTitle),\n\t\t\taddition = {};\n\t\taddition[this.radioField] = this.radioValue;\n\t\tthis.wiki.addTiddler(new $tw.Tiddler({title: this.radioTitle},tiddler,addition,this.wiki.getModificationFields()));\n\t}\n};\n\nRadioWidget.prototype.handleChangeEvent = function(event) {\n\tif(this.inputDomNode.checked) {\n\t\tthis.setValue();\n\t}\n};\n\n/*\nCompute the internal state of the widget\n*/\nRadioWidget.prototype.execute = function() {\n\t// Get the parameters from the attributes\n\tthis.radioTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.radioField = this.getAttribute(\&quot;field\&quot;,\&quot;text\&quot;);\n\tthis.radioValue = this.getAttribute(\&quot;value\&quot;);\n\tthis.radioClass = this.getAttribute(\&quot;class\&quot;,\&quot;\&quot;);\n\tif(this.radioClass !== \&quot;\&quot;) {\n\t\tthis.radioClass += \&quot; \&quot;;\n\t}\n\tthis.radioClass += \&quot;tc-radio\&quot;;\n\t// Make the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nRadioWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.tiddler || changedAttributes.field || changedAttributes.value || changedAttributes[\&quot;class\&quot;]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\tvar refreshed = false;\n\t\tif(changedTiddlers[this.radioTitle]) {\n\t\t\tthis.inputDomNode.checked = this.getValue() === this.radioValue;\n\t\t\trefreshed = true;\n\t\t}\n\t\treturn this.refreshChildren(changedTiddlers) || refreshed;\n\t}\n};\n\nexports.radio = RadioWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/radio.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/raw.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/raw.js\ntype: application/javascript\nmodule-type: widget\n\nRaw widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar RawWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nRawWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nRawWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.execute();\n\tvar div = this.document.createElement(\&quot;div\&quot;);\n\tdiv.innerHTML=this.parseTreeNode.html;\n\tparent.insertBefore(div,nextSibling);\n\tthis.domNodes.push(div);\t\n};\n\n/*\nCompute the internal state of the widget\n*/\nRawWidget.prototype.execute = function() {\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nRawWidget.prototype.refresh = function(changedTiddlers) {\n\treturn false;\n};\n\nexports.raw = RawWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/raw.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/reveal.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/reveal.js\ntype: application/javascript\nmodule-type: widget\n\nReveal widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar RevealWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nRevealWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nRevealWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tvar domNode = this.document.createElement(this.parseTreeNode.isBlock ? \&quot;div\&quot; : \&quot;span\&quot;);\n\tvar classes = this[\&quot;class\&quot;].split(\&quot; \&quot;) || [];\n\tclasses.push(\&quot;tc-reveal\&quot;);\n\tdomNode.className = classes.join(\&quot; \&quot;);\n\tparent.insertBefore(domNode,nextSibling);\n\tthis.renderChildren(domNode,null);\n\tif(!domNode.isTiddlyWikiFakeDom &amp;&amp; this.type === \&quot;popup\&quot; &amp;&amp; this.isOpen) {\n\t\tthis.positionPopup(domNode);\n\t\t$tw.utils.addClass(domNode,\&quot;tc-popup\&quot;); // Make sure that clicks don't dismiss popups within the revealed content\n\t}\n\tif(!this.isOpen) {\n\t\tdomNode.setAttribute(\&quot;hidden\&quot;,\&quot;true\&quot;);\n\t}\n\tthis.domNodes.push(domNode);\n};\n\nRevealWidget.prototype.positionPopup = function(domNode) {\n\tdomNode.style.position = \&quot;absolute\&quot;;\n\tdomNode.style.zIndex = \&quot;1000\&quot;;\n\tswitch(this.position) {\n\t\tcase \&quot;left\&quot;:\n\t\t\tdomNode.style.left = (this.popup.left - domNode.offsetWidth) + \&quot;px\&quot;;\n\t\t\tdomNode.style.top = this.popup.top + \&quot;px\&quot;;\n\t\t\tbreak;\n\t\tcase \&quot;above\&quot;:\n\t\t\tdomNode.style.left = this.popup.left + \&quot;px\&quot;;\n\t\t\tdomNode.style.top = (this.popup.top - domNode.offsetHeight) + \&quot;px\&quot;;\n\t\t\tbreak;\n\t\tcase \&quot;aboveright\&quot;:\n\t\t\tdomNode.style.left = (this.popup.left + this.popup.width) + \&quot;px\&quot;;\n\t\t\tdomNode.style.top = (this.popup.top + this.popup.height - domNode.offsetHeight) + \&quot;px\&quot;;\n\t\t\tbreak;\n\t\tcase \&quot;right\&quot;:\n\t\t\tdomNode.style.left = (this.popup.left + this.popup.width) + \&quot;px\&quot;;\n\t\t\tdomNode.style.top = this.popup.top + \&quot;px\&quot;;\n\t\t\tbreak;\n\t\tcase \&quot;belowleft\&quot;:\n\t\t\tdomNode.style.left = (this.popup.left + this.popup.width - domNode.offsetWidth) + \&quot;px\&quot;;\n\t\t\tdomNode.style.top = (this.popup.top + this.popup.height) + \&quot;px\&quot;;\n\t\t\tbreak;\n\t\tdefault: // Below\n\t\t\tdomNode.style.left = this.popup.left + \&quot;px\&quot;;\n\t\t\tdomNode.style.top = (this.popup.top + this.popup.height) + \&quot;px\&quot;;\n\t\t\tbreak;\n\t}\n};\n\n/*\nCompute the internal state of the widget\n*/\nRevealWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.state = this.getAttribute(\&quot;state\&quot;);\n\tthis.type = this.getAttribute(\&quot;type\&quot;);\n\tthis.text = this.getAttribute(\&quot;text\&quot;);\n\tthis.position = this.getAttribute(\&quot;position\&quot;);\n\tthis[\&quot;class\&quot;] = this.getAttribute(\&quot;class\&quot;,\&quot;\&quot;);\n\tthis[\&quot;default\&quot;] = this.getAttribute(\&quot;default\&quot;,\&quot;\&quot;);\n\tthis.animate = this.getAttribute(\&quot;animate\&quot;,\&quot;no\&quot;);\n\tthis.retain = this.getAttribute(\&quot;retain\&quot;,\&quot;no\&quot;);\n\tthis.openAnimation = this.animate === \&quot;no\&quot; ? undefined : \&quot;open\&quot;;\n\tthis.closeAnimation = this.animate === \&quot;no\&quot; ? undefined : \&quot;close\&quot;;\n\t// Compute the title of the state tiddler and read it\n\tthis.stateTitle = this.state;\n\tthis.readState();\n\t// Construct the child widgets\n\tvar childNodes = this.isOpen ? this.parseTreeNode.children : [];\n\tthis.hasChildNodes = this.isOpen;\n\tthis.makeChildWidgets(childNodes);\n};\n\n/*\nRead the state tiddler\n*/\nRevealWidget.prototype.readState = function() {\n\t// Read the information from the state tiddler\n\tvar state = this.stateTitle ? this.wiki.getTextReference(this.stateTitle,this[\&quot;default\&quot;],this.getVariable(\&quot;currentTiddler\&quot;)) : this[\&quot;default\&quot;];\n\tswitch(this.type) {\n\t\tcase \&quot;popup\&quot;:\n\t\t\tthis.readPopupState(state);\n\t\t\tbreak;\n\t\tcase \&quot;match\&quot;:\n\t\t\tthis.readMatchState(state);\n\t\t\tbreak;\n\t\tcase \&quot;nomatch\&quot;:\n\t\t\tthis.readMatchState(state);\n\t\t\tthis.isOpen = !this.isOpen;\n\t\t\tbreak;\n\t}\n};\n\nRevealWidget.prototype.readMatchState = function(state) {\n\tthis.isOpen = state === this.text;\n};\n\nRevealWidget.prototype.readPopupState = function(state) {\n\tvar popupLocationRegExp = /^\\((-?[0-9\\.E]+),(-?[0-9\\.E]+),(-?[0-9\\.E]+),(-?[0-9\\.E]+)\\)$/,\n\t\tmatch = popupLocationRegExp.exec(state);\n\t// Check if the state matches the location regexp\n\tif(match) {\n\t\t// If so, we're open\n\t\tthis.isOpen = true;\n\t\t// Get the location\n\t\tthis.popup = {\n\t\t\tleft: parseFloat(match[1]),\n\t\t\ttop: parseFloat(match[2]),\n\t\t\twidth: parseFloat(match[3]),\n\t\t\theight: parseFloat(match[4])\n\t\t};\n\t} else {\n\t\t// If not, we're closed\n\t\tthis.isOpen = false;\n\t}\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nRevealWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.state || changedAttributes.type || changedAttributes.text || changedAttributes.position || changedAttributes[\&quot;default\&quot;] || changedAttributes.animate) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\tvar refreshed = false,\n\t\t\tcurrentlyOpen = this.isOpen;\n\t\tthis.readState();\n\t\tif(this.isOpen !== currentlyOpen) {\n\t\t\tif(this.retain === \&quot;yes\&quot;) {\n\t\t\t\tthis.updateState();\n\t\t\t} else {\n\t\t\t\tthis.refreshSelf();\n\t\t\t\trefreshed = true;\n\t\t\t}\n\t\t}\n\t\treturn this.refreshChildren(changedTiddlers) || refreshed;\n\t}\n};\n\n/*\nCalled by refresh() to dynamically show or hide the content\n*/\nRevealWidget.prototype.updateState = function() {\n\t// Read the current state\n\tthis.readState();\n\t// Construct the child nodes if needed\n\tvar domNode = this.domNodes[0];\n\tif(this.isOpen &amp;&amp; !this.hasChildNodes) {\n\t\tthis.hasChildNodes = true;\n\t\tthis.makeChildWidgets(this.parseTreeNode.children);\n\t\tthis.renderChildren(domNode,null);\n\t}\n\t// Animate our DOM node\n\tif(!domNode.isTiddlyWikiFakeDom &amp;&amp; this.type === \&quot;popup\&quot; &amp;&amp; this.isOpen) {\n\t\tthis.positionPopup(domNode);\n\t\t$tw.utils.addClass(domNode,\&quot;tc-popup\&quot;); // Make sure that clicks don't dismiss popups within the revealed content\n\n\t}\n\tif(this.isOpen) {\n\t\tdomNode.removeAttribute(\&quot;hidden\&quot;);\n        $tw.anim.perform(this.openAnimation,domNode);\n\t} else {\n\t\t$tw.anim.perform(this.closeAnimation,domNode,{callback: function() {\n\t\t\tdomNode.setAttribute(\&quot;hidden\&quot;,\&quot;true\&quot;);\n        }});\n\t}\n};\n\nexports.reveal = RevealWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/reveal.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/scrollable.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/scrollable.js\ntype: application/javascript\nmodule-type: widget\n\nScrollable widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar ScrollableWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n\tthis.scaleFactor = 1;\n\tthis.addEventListeners([\n\t\t{type: \&quot;tm-scroll\&quot;, handler: \&quot;handleScrollEvent\&quot;}\n\t]);\n\tif($tw.browser) {\n\t\tthis.requestAnimationFrame = window.requestAnimationFrame ||\n\t\t\twindow.webkitRequestAnimationFrame ||\n\t\t\twindow.mozRequestAnimationFrame ||\n\t\t\tfunction(callback) {\n\t\t\t\treturn window.setTimeout(callback, 1000/60);\n\t\t\t};\n\t\tthis.cancelAnimationFrame = window.cancelAnimationFrame ||\n\t\t\twindow.webkitCancelAnimationFrame ||\n\t\t\twindow.webkitCancelRequestAnimationFrame ||\n\t\t\twindow.mozCancelAnimationFrame ||\n\t\t\twindow.mozCancelRequestAnimationFrame ||\n\t\t\tfunction(id) {\n\t\t\t\twindow.clearTimeout(id);\n\t\t\t};\n\t}\n};\n\n/*\nInherit from the base widget class\n*/\nScrollableWidget.prototype = new Widget();\n\nScrollableWidget.prototype.cancelScroll = function() {\n\tif(this.idRequestFrame) {\n\t\tthis.cancelAnimationFrame.call(window,this.idRequestFrame);\n\t\tthis.idRequestFrame = null;\n\t}\n};\n\n/*\nHandle a scroll event\n*/\nScrollableWidget.prototype.handleScrollEvent = function(event) {\n\t// Pass the scroll event through if our offsetsize is larger than our scrollsize\n\tif(this.outerDomNode.scrollWidth &lt;= this.outerDomNode.offsetWidth &amp;&amp; this.outerDomNode.scrollHeight &lt;= this.outerDomNode.offsetHeight &amp;&amp; this.fallthrough === \&quot;yes\&quot;) {\n\t\treturn true;\n\t}\n\tthis.scrollIntoView(event.target);\n\treturn false; // Handled event\n};\n\n/*\nScroll an element into view\n*/\nScrollableWidget.prototype.scrollIntoView = function(element) {\n\tvar duration = $tw.utils.getAnimationDuration();\n\tthis.cancelScroll();\n\tthis.startTime = Date.now();\n\tvar scrollPosition = {\n\t\tx: this.outerDomNode.scrollLeft,\n\t\ty: this.outerDomNode.scrollTop\n\t};\n\t// Get the client bounds of the element and adjust by the scroll position\n\tvar scrollableBounds = this.outerDomNode.getBoundingClientRect(),\n\t\tclientTargetBounds = element.getBoundingClientRect(),\n\t\tbounds = {\n\t\t\tleft: clientTargetBounds.left + scrollPosition.x - scrollableBounds.left,\n\t\t\ttop: clientTargetBounds.top + scrollPosition.y - scrollableBounds.top,\n\t\t\twidth: clientTargetBounds.width,\n\t\t\theight: clientTargetBounds.height\n\t\t};\n\t// We'll consider the horizontal and vertical scroll directions separately via this function\n\tvar getEndPos = function(targetPos,targetSize,currentPos,currentSize) {\n\t\t\t// If the target is already visible then stay where we are\n\t\t\tif(targetPos &gt;= currentPos &amp;&amp; (targetPos + targetSize) &lt;= (currentPos + currentSize)) {\n\t\t\t\treturn currentPos;\n\t\t\t// If the target is above/left of the current view, then scroll to its top/left\n\t\t\t} else if(targetPos &lt;= currentPos) {\n\t\t\t\treturn targetPos;\n\t\t\t// If the target is smaller than the window and the scroll position is too far up, then scroll till the target is at the bottom of the window\n\t\t\t} else if(targetSize &lt; currentSize &amp;&amp; currentPos &lt; (targetPos + targetSize - currentSize)) {\n\t\t\t\treturn targetPos + targetSize - currentSize;\n\t\t\t// If the target is big, then just scroll to the top\n\t\t\t} else if(currentPos &lt; targetPos) {\n\t\t\t\treturn targetPos;\n\t\t\t// Otherwise, stay where we are\n\t\t\t} else {\n\t\t\t\treturn currentPos;\n\t\t\t}\n\t\t},\n\t\tendX = getEndPos(bounds.left,bounds.width,scrollPosition.x,this.outerDomNode.offsetWidth),\n\t\tendY = getEndPos(bounds.top,bounds.height,scrollPosition.y,this.outerDomNode.offsetHeight);\n\t// Only scroll if necessary\n\tif(endX !== scrollPosition.x || endY !== scrollPosition.y) {\n\t\tvar self = this,\n\t\t\tdrawFrame;\n\t\tdrawFrame = function () {\n\t\t\tvar t;\n\t\t\tif(duration &lt;= 0) {\n\t\t\t\tt = 1;\n\t\t\t} else {\n\t\t\t\tt = ((Date.now()) - self.startTime) / duration;\t\n\t\t\t}\n\t\t\tif(t &gt;= 1) {\n\t\t\t\tself.cancelScroll();\n\t\t\t\tt = 1;\n\t\t\t}\n\t\t\tt = $tw.utils.slowInSlowOut(t);\n\t\t\tself.outerDomNode.scrollLeft = scrollPosition.x + (endX - scrollPosition.x) * t;\n\t\t\tself.outerDomNode.scrollTop = scrollPosition.y + (endY - scrollPosition.y) * t;\n\t\t\tif(t &lt; 1) {\n\t\t\t\tself.idRequestFrame = self.requestAnimationFrame.call(window,drawFrame);\n\t\t\t}\n\t\t};\n\t\tdrawFrame();\n\t}\n};\n\n/*\nRender this widget into the DOM\n*/\nScrollableWidget.prototype.render = function(parent,nextSibling) {\n\tvar self = this;\n\t// Remember parent\n\tthis.parentDomNode = parent;\n\t// Compute attributes and execute state\n\tthis.computeAttributes();\n\tthis.execute();\n\t// Create elements\n\tthis.outerDomNode = this.document.createElement(\&quot;div\&quot;);\n\t$tw.utils.setStyle(this.outerDomNode,[\n\t\t{overflowY: \&quot;auto\&quot;},\n\t\t{overflowX: \&quot;auto\&quot;},\n\t\t{webkitOverflowScrolling: \&quot;touch\&quot;}\n\t]);\n\tthis.innerDomNode = this.document.createElement(\&quot;div\&quot;);\n\tthis.outerDomNode.appendChild(this.innerDomNode);\n\t// Assign classes\n\tthis.outerDomNode.className = this[\&quot;class\&quot;] || \&quot;\&quot;;\n\t// Insert element\n\tparent.insertBefore(this.outerDomNode,nextSibling);\n\tthis.renderChildren(this.innerDomNode,null);\n\tthis.domNodes.push(this.outerDomNode);\n};\n\n/*\nCompute the internal state of the widget\n*/\nScrollableWidget.prototype.execute = function() {\n\t// Get attributes\n\tthis.fallthrough = this.getAttribute(\&quot;fallthrough\&quot;,\&quot;yes\&quot;);\n\tthis[\&quot;class\&quot;] = this.getAttribute(\&quot;class\&quot;);\n\t// Make child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nScrollableWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes[\&quot;class\&quot;]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t}\n\treturn this.refreshChildren(changedTiddlers);\n};\n\nexports.scrollable = ScrollableWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/scrollable.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/select.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/select.js\ntype: application/javascript\nmodule-type: widget\n\nSelect widget:\n\n```\n&lt;$select tiddler=\&quot;MyTiddler\&quot; field=\&quot;text\&quot;&gt;\n&lt;$list filter=\&quot;[tag[chapter]]\&quot;&gt;\n&lt;option value=&lt;&lt;currentTiddler&gt;&gt;&gt;\n&lt;$view field=\&quot;description\&quot;/&gt;\n&lt;/option&gt;\n&lt;/$list&gt;\n&lt;/$select&gt;\n```\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar SelectWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nSelectWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nSelectWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n\tthis.setSelectValue();\n\t$tw.utils.addEventListeners(this.getSelectDomNode(),[\n\t\t{name: \&quot;change\&quot;, handlerObject: this, handlerMethod: \&quot;handleChangeEvent\&quot;}\n\t]);\n};\n\n/*\nHandle a change event\n*/\nSelectWidget.prototype.handleChangeEvent = function(event) {\n\tvar value = this.getSelectDomNode().value;\n\tthis.wiki.setText(this.selectTitle,this.selectField,this.selectIndex,value);\n};\n\n/*\nIf necessary, set the value of the select element to the current value\n*/\nSelectWidget.prototype.setSelectValue = function() {\n\tvar value = this.selectDefault;\n\t// Get the value\n\tif(this.selectIndex) {\n\t\tvalue = this.wiki.extractTiddlerDataItem(this.selectTitle,this.selectIndex);\n\t} else {\n\t\tvar tiddler = this.wiki.getTiddler(this.selectTitle);\n\t\tif(tiddler) {\n\t\t\tif(this.selectField === \&quot;text\&quot;) {\n\t\t\t\t// Calling getTiddlerText() triggers lazy loading of skinny tiddlers\n\t\t\t\tvalue = this.wiki.getTiddlerText(this.selectTitle);\n\t\t\t} else {\n\t\t\t\tif($tw.utils.hop(tiddler.fields,this.selectField)) {\n\t\t\t\t\tvalue = tiddler.getFieldString(this.selectField);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif(this.selectField === \&quot;title\&quot;) {\n\t\t\t\tvalue = this.selectTitle;\n\t\t\t}\n\t\t}\n\t}\n\t// Assign it to the select element if it's different than the current value\n\tvar domNode = this.getSelectDomNode();\n\tif(domNode.value !== value) {\n\t\tdomNode.value = value;\n\t}\n};\n\n/*\nGet the DOM node of the select element\n*/\nSelectWidget.prototype.getSelectDomNode = function() {\n\treturn this.children[0].domNodes[0];\n};\n\n/*\nCompute the internal state of the widget\n*/\nSelectWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.selectTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.selectField = this.getAttribute(\&quot;field\&quot;,\&quot;text\&quot;);\n\tthis.selectIndex = this.getAttribute(\&quot;index\&quot;);\n\tthis.selectClass = this.getAttribute(\&quot;class\&quot;);\n\tthis.selectDefault = this.getAttribute(\&quot;default\&quot;);\n\t// Make the child widgets\n\tvar selectNode = {\n\t\ttype: \&quot;element\&quot;,\n\t\ttag: \&quot;select\&quot;,\n\t\tchildren: this.parseTreeNode.children\n\t};\n\tif(this.selectClass) {\n\t\t$tw.utils.addAttributeToParseTreeNode(selectNode,\&quot;class\&quot;,this.selectClass);\n\t}\n\tthis.makeChildWidgets([selectNode]);\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nSelectWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\t// If we're using a different tiddler/field/index then completely refresh ourselves\n\tif(changedAttributes.selectTitle || changedAttributes.selectField || changedAttributes.selectIndex) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t// If the target tiddler value has changed, just update setting and refresh the children\n\t} else {\n\t\tif(changedTiddlers[this.selectTitle]) {\n\t\t\tthis.setSelectValue();\n\t\t} \n\t\treturn this.refreshChildren(changedTiddlers);\t\t\n\t}\n};\n\nexports.select = SelectWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/select.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/set.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/set.js\ntype: application/javascript\nmodule-type: widget\n\nSet variable widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar SetWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nSetWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nSetWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nSetWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.setName = this.getAttribute(\&quot;name\&quot;,\&quot;currentTiddler\&quot;);\n\tthis.setFilter = this.getAttribute(\&quot;filter\&quot;);\n\tthis.setValue = this.getAttribute(\&quot;value\&quot;);\n\tthis.setEmptyValue = this.getAttribute(\&quot;emptyValue\&quot;);\n\t// Set context variable\n\tvar value = this.setValue;\n\tif(this.setFilter) {\n\t\tvar results = this.wiki.filterTiddlers(this.setFilter,this);\n\t\tif(!this.setValue) {\n\t\t\tvalue = $tw.utils.stringifyList(results);\n\t\t}\n\t\tif(results.length === 0 &amp;&amp; this.setEmptyValue !== undefined) {\n\t\t\tvalue = this.setEmptyValue;\n\t\t}\n\t}\n\tthis.setVariable(this.setName,value,this.parseTreeNode.params);\n\t// Construct the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nSetWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.name || changedAttributes.filter || changedAttributes.value || changedAttributes.emptyValue) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\t\t\n\t}\n};\n\nexports.setvariable = SetWidget;\nexports.set = SetWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/set.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/text.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/text.js\ntype: application/javascript\nmodule-type: widget\n\nText node widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar TextNodeWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nTextNodeWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nTextNodeWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tvar text = this.getAttribute(\&quot;text\&quot;,this.parseTreeNode.text || \&quot;\&quot;);\n\ttext = text.replace(/\\r/mg,\&quot;\&quot;);\n\tvar textNode = this.document.createTextNode(text);\n\tparent.insertBefore(textNode,nextSibling);\n\tthis.domNodes.push(textNode);\n};\n\n/*\nCompute the internal state of the widget\n*/\nTextNodeWidget.prototype.execute = function() {\n\t// Nothing to do for a text node\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nTextNodeWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.text) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn false;\t\n\t}\n};\n\nexports.text = TextNodeWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/text.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/tiddler.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/tiddler.js\ntype: application/javascript\nmodule-type: widget\n\nTiddler widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar TiddlerWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nTiddlerWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nTiddlerWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nTiddlerWidget.prototype.execute = function() {\n\tthis.tiddlerState = this.computeTiddlerState();\n\tthis.setVariable(\&quot;currentTiddler\&quot;,this.tiddlerState.currentTiddler);\n\tthis.setVariable(\&quot;missingTiddlerClass\&quot;,this.tiddlerState.missingTiddlerClass);\n\tthis.setVariable(\&quot;shadowTiddlerClass\&quot;,this.tiddlerState.shadowTiddlerClass);\n\tthis.setVariable(\&quot;systemTiddlerClass\&quot;,this.tiddlerState.systemTiddlerClass);\n\tthis.setVariable(\&quot;tiddlerTagClasses\&quot;,this.tiddlerState.tiddlerTagClasses);\n\t// Construct the child widgets\n\tthis.makeChildWidgets();\n};\n\n/*\nCompute the tiddler state flags\n*/\nTiddlerWidget.prototype.computeTiddlerState = function() {\n\t// Get our parameters\n\tthis.tiddlerTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\t// Compute the state\n\tvar state = {\n\t\tcurrentTiddler: this.tiddlerTitle || \&quot;\&quot;,\n\t\tmissingTiddlerClass: (this.wiki.tiddlerExists(this.tiddlerTitle) || this.wiki.isShadowTiddler(this.tiddlerTitle)) ? \&quot;tc-tiddler-exists\&quot; : \&quot;tc-tiddler-missing\&quot;,\n\t\tshadowTiddlerClass: this.wiki.isShadowTiddler(this.tiddlerTitle) ? \&quot;tc-tiddler-shadow\&quot; : \&quot;\&quot;,\n\t\tsystemTiddlerClass: this.wiki.isSystemTiddler(this.tiddlerTitle) ? \&quot;tc-tiddler-system\&quot; : \&quot;\&quot;,\n\t\ttiddlerTagClasses: this.getTagClasses()\n\t};\n\t// Compute a simple hash to make it easier to detect changes\n\tstate.hash = state.currentTiddler + state.missingTiddlerClass + state.shadowTiddlerClass + state.systemTiddlerClass + state.tiddlerTagClasses;\n\treturn state;\n};\n\n/*\nCreate a string of CSS classes derived from the tags of the current tiddler\n*/\nTiddlerWidget.prototype.getTagClasses = function() {\n\tvar tiddler = this.wiki.getTiddler(this.tiddlerTitle);\n\tif(tiddler) {\n\t\tvar tags = [];\n\t\t$tw.utils.each(tiddler.fields.tags,function(tag) {\n\t\t\ttags.push(\&quot;tc-tagged-\&quot; + encodeURIComponent(tag));\n\t\t});\n\t\treturn tags.join(\&quot; \&quot;);\n\t} else {\n\t\treturn \&quot;\&quot;;\n\t}\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nTiddlerWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes(),\n\t\tnewTiddlerState = this.computeTiddlerState();\n\tif(changedAttributes.tiddler || newTiddlerState.hash !== this.tiddlerState.hash) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\t\t\n\t}\n};\n\nexports.tiddler = TiddlerWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/tiddler.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/transclude.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/transclude.js\ntype: application/javascript\nmodule-type: widget\n\nTransclude widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar TranscludeWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nTranscludeWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nTranscludeWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nTranscludeWidget.prototype.execute = function() {\n\t// Get our parameters\n\tthis.transcludeTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.transcludeSubTiddler = this.getAttribute(\&quot;subtiddler\&quot;);\n\tthis.transcludeField = this.getAttribute(\&quot;field\&quot;);\n\tthis.transcludeIndex = this.getAttribute(\&quot;index\&quot;);\n\tthis.transcludeMode = this.getAttribute(\&quot;mode\&quot;);\n\t// Parse the text reference\n\tvar parseAsInline = !this.parseTreeNode.isBlock;\n\tif(this.transcludeMode === \&quot;inline\&quot;) {\n\t\tparseAsInline = true;\n\t} else if(this.transcludeMode === \&quot;block\&quot;) {\n\t\tparseAsInline = false;\n\t}\n\tvar parser = this.wiki.parseTextReference(\n\t\t\t\t\t\tthis.transcludeTitle,\n\t\t\t\t\t\tthis.transcludeField,\n\t\t\t\t\t\tthis.transcludeIndex,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparseAsInline: parseAsInline,\n\t\t\t\t\t\t\tsubTiddler: this.transcludeSubTiddler\n\t\t\t\t\t\t}),\n\t\tparseTreeNodes = parser ? parser.tree : this.parseTreeNode.children;\n\t// Set context variables for recursion detection\n\tvar recursionMarker = this.makeRecursionMarker();\n\tthis.setVariable(\&quot;transclusion\&quot;,recursionMarker);\n\t// Check for recursion\n\tif(parser) {\n\t\tif(this.parentWidget &amp;&amp; this.parentWidget.hasVariable(\&quot;transclusion\&quot;,recursionMarker)) {\n\t\t\tparseTreeNodes = [{type: \&quot;element\&quot;, tag: \&quot;span\&quot;, attributes: {\n\t\t\t\t\&quot;class\&quot;: {type: \&quot;string\&quot;, value: \&quot;tc-error\&quot;}\n\t\t\t}, children: [\n\t\t\t\t{type: \&quot;text\&quot;, text: \&quot;Recursive transclusion error in transclude widget\&quot;}\n\t\t\t]}];\n\t\t}\n\t}\n\t// Construct the child widgets\n\tthis.makeChildWidgets(parseTreeNodes);\n};\n\n/*\nCompose a string comprising the title, field and/or index to identify this transclusion for recursion detection\n*/\nTranscludeWidget.prototype.makeRecursionMarker = function() {\n\tvar output = [];\n\toutput.push(\&quot;{\&quot;);\n\toutput.push(this.getVariable(\&quot;currentTiddler\&quot;,{defaultValue: \&quot;\&quot;}));\n\toutput.push(\&quot;|\&quot;);\n\toutput.push(this.transcludeTitle || \&quot;\&quot;);\n\toutput.push(\&quot;|\&quot;);\n\toutput.push(this.transcludeField || \&quot;\&quot;);\n\toutput.push(\&quot;|\&quot;);\n\toutput.push(this.transcludeIndex || \&quot;\&quot;);\n\toutput.push(\&quot;|\&quot;);\n\toutput.push(this.transcludeSubTiddler || \&quot;\&quot;);\n\toutput.push(\&quot;}\&quot;);\n\treturn output.join(\&quot;\&quot;);\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nTranscludeWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.tiddler || changedAttributes.field || changedAttributes.index || changedTiddlers[this.transcludeTitle]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn this.refreshChildren(changedTiddlers);\t\t\n\t}\n};\n\nexports.transclude = TranscludeWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/transclude.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/view.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/view.js\ntype: application/javascript\nmodule-type: widget\n\nView widget\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar Widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;).widget;\n\nvar ViewWidget = function(parseTreeNode,options) {\n\tthis.initialise(parseTreeNode,options);\n};\n\n/*\nInherit from the base widget class\n*/\nViewWidget.prototype = new Widget();\n\n/*\nRender this widget into the DOM\n*/\nViewWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.computeAttributes();\n\tthis.execute();\n\tif(this.text) {\n\t\tvar textNode = this.document.createTextNode(this.text);\n\t\tparent.insertBefore(textNode,nextSibling);\n\t\tthis.domNodes.push(textNode);\n\t} else {\n\t\tthis.makeChildWidgets();\n\t\tthis.renderChildren(parent,nextSibling);\n\t}\n};\n\n/*\nCompute the internal state of the widget\n*/\nViewWidget.prototype.execute = function() {\n\t// Get parameters from our attributes\n\tthis.viewTitle = this.getAttribute(\&quot;tiddler\&quot;,this.getVariable(\&quot;currentTiddler\&quot;));\n\tthis.viewSubtiddler = this.getAttribute(\&quot;subtiddler\&quot;);\n\tthis.viewField = this.getAttribute(\&quot;field\&quot;,\&quot;text\&quot;);\n\tthis.viewIndex = this.getAttribute(\&quot;index\&quot;);\n\tthis.viewFormat = this.getAttribute(\&quot;format\&quot;,\&quot;text\&quot;);\n\tthis.viewTemplate = this.getAttribute(\&quot;template\&quot;,\&quot;\&quot;);\n\tswitch(this.viewFormat) {\n\t\tcase \&quot;htmlwikified\&quot;:\n\t\t\tthis.text = this.getValueAsHtmlWikified();\n\t\t\tbreak;\n\t\tcase \&quot;htmlencoded\&quot;:\n\t\t\tthis.text = this.getValueAsHtmlEncoded();\n\t\t\tbreak;\n\t\tcase \&quot;urlencoded\&quot;:\n\t\t\tthis.text = this.getValueAsUrlEncoded();\n\t\t\tbreak;\n\t\tcase \&quot;doubleurlencoded\&quot;:\n\t\t\tthis.text = this.getValueAsDoubleUrlEncoded();\n\t\t\tbreak;\n\t\tcase \&quot;date\&quot;:\n\t\t\tthis.text = this.getValueAsDate(this.viewTemplate);\n\t\t\tbreak;\n\t\tcase \&quot;relativedate\&quot;:\n\t\t\tthis.text = this.getValueAsRelativeDate();\n\t\t\tbreak;\n\t\tcase \&quot;stripcomments\&quot;:\n\t\t\tthis.text = this.getValueAsStrippedComments();\n\t\t\tbreak;\n\t\tcase \&quot;jsencoded\&quot;:\n\t\t\tthis.text = this.getValueAsJsEncoded();\n\t\t\tbreak;\n\t\tdefault: // \&quot;text\&quot;\n\t\t\tthis.text = this.getValueAsText();\n\t\t\tbreak;\n\t}\n};\n\n/*\nThe various formatter functions are baked into this widget for the moment. Eventually they will be replaced by macro functions\n*/\n\n/*\nRetrieve the value of the widget. Options are:\nasString: Optionally return the value as a string\n*/\nViewWidget.prototype.getValue = function(options) {\n\toptions = options || {};\n\tvar value = options.asString ? \&quot;\&quot; : undefined;\n\tif(this.viewIndex) {\n\t\tvalue = this.wiki.extractTiddlerDataItem(this.viewTitle,this.viewIndex);\n\t} else {\n\t\tvar tiddler;\n\t\tif(this.viewSubtiddler) {\n\t\t\ttiddler = this.wiki.getSubTiddler(this.viewTitle,this.viewSubtiddler);\t\n\t\t} else {\n\t\t\ttiddler = this.wiki.getTiddler(this.viewTitle);\n\t\t}\n\t\tif(tiddler) {\n\t\t\tif(this.viewField === \&quot;text\&quot; &amp;&amp; !this.viewSubtiddler) {\n\t\t\t\t// Calling getTiddlerText() triggers lazy loading of skinny tiddlers\n\t\t\t\tvalue = this.wiki.getTiddlerText(this.viewTitle);\n\t\t\t} else {\n\t\t\t\tif($tw.utils.hop(tiddler.fields,this.viewField)) {\n\t\t\t\t\tif(options.asString) {\n\t\t\t\t\t\tvalue = tiddler.getFieldString(this.viewField);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = tiddler.fields[this.viewField];\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif(this.viewField === \&quot;title\&quot;) {\n\t\t\t\tvalue = this.viewTitle;\n\t\t\t}\n\t\t}\n\t}\n\treturn value;\n};\n\nViewWidget.prototype.getValueAsText = function() {\n\treturn this.getValue({asString: true});\n};\n\nViewWidget.prototype.getValueAsHtmlWikified = function() {\n\treturn this.wiki.renderText(\&quot;text/html\&quot;,\&quot;text/vnd.tiddlywiki\&quot;,this.getValueAsText(),{parentWidget: this});\n};\n\nViewWidget.prototype.getValueAsHtmlEncoded = function() {\n\treturn $tw.utils.htmlEncode(this.getValueAsText());\n};\n\nViewWidget.prototype.getValueAsUrlEncoded = function() {\n\treturn encodeURIComponent(this.getValueAsText());\n};\n\nViewWidget.prototype.getValueAsDoubleUrlEncoded = function() {\n\treturn encodeURIComponent(encodeURIComponent(this.getValueAsText()));\n};\n\nViewWidget.prototype.getValueAsDate = function(format) {\n\tformat = format || \&quot;YYYY MM DD 0hh:0mm\&quot;;\n\tvar value = $tw.utils.parseDate(this.getValue());\n\tif(value &amp;&amp; $tw.utils.isDate(value) &amp;&amp; value.toString() !== \&quot;Invalid Date\&quot;) {\n\t\treturn $tw.utils.formatDateString(value,format);\n\t} else {\n\t\treturn \&quot;\&quot;;\n\t}\n};\n\nViewWidget.prototype.getValueAsRelativeDate = function(format) {\n\tvar value = $tw.utils.parseDate(this.getValue());\n\tif(value &amp;&amp; $tw.utils.isDate(value) &amp;&amp; value.toString() !== \&quot;Invalid Date\&quot;) {\n\t\treturn $tw.utils.getRelativeDate((new Date()) - (new Date(value))).description;\n\t} else {\n\t\treturn \&quot;\&quot;;\n\t}\n};\n\nViewWidget.prototype.getValueAsStrippedComments = function() {\n\tvar lines = this.getValueAsText().split(\&quot;\\n\&quot;),\n\t\tout = [];\n\tfor(var line=0; line&lt;lines.length; line++) {\n\t\tvar text = lines[line];\n\t\tif(!/^\\s*\\/\\/#/.test(text)) {\n\t\t\tout.push(text);\n\t\t}\n\t}\n\treturn out.join(\&quot;\\n\&quot;);\n};\n\nViewWidget.prototype.getValueAsJsEncoded = function() {\n\treturn $tw.utils.stringify(this.getValueAsText());\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nViewWidget.prototype.refresh = function(changedTiddlers) {\n\tvar changedAttributes = this.computeAttributes();\n\tif(changedAttributes.tiddler || changedAttributes.field || changedAttributes.index || changedAttributes.template || changedAttributes.format || changedTiddlers[this.viewTitle]) {\n\t\tthis.refreshSelf();\n\t\treturn true;\n\t} else {\n\t\treturn false;\t\n\t}\n};\n\nexports.view = ViewWidget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/view.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/widgets/widget.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/widgets/widget.js\ntype: application/javascript\nmodule-type: widget\n\nWidget base class\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\n/*\nCreate a widget object for a parse tree node\n\tparseTreeNode: reference to the parse tree node to be rendered\n\toptions: see below\nOptions include:\n\twiki: mandatory reference to wiki associated with this render tree\n\tparentWidget: optional reference to a parent renderer node for the context chain\n\tdocument: optional document object to use instead of global document\n*/\nvar Widget = function(parseTreeNode,options) {\n\tif(arguments.length &gt; 0) {\n\t\tthis.initialise(parseTreeNode,options);\n\t}\n};\n\n/*\nInitialise widget properties. These steps are pulled out of the constructor so that we can reuse them in subclasses\n*/\nWidget.prototype.initialise = function(parseTreeNode,options) {\n\toptions = options || {};\n\t// Save widget info\n\tthis.parseTreeNode = parseTreeNode;\n\tthis.wiki = options.wiki;\n\tthis.parentWidget = options.parentWidget;\n\tthis.variablesConstructor = function() {};\n\tthis.variablesConstructor.prototype = this.parentWidget ? this.parentWidget.variables : {};\n\tthis.variables = new this.variablesConstructor();\n\tthis.document = options.document;\n\tthis.attributes = {};\n\tthis.children = [];\n\tthis.domNodes = [];\n\tthis.eventListeners = {};\n\t// Hashmap of the widget classes\n\tif(!this.widgetClasses) {\n\t\tWidget.prototype.widgetClasses = $tw.modules.applyMethods(\&quot;widget\&quot;);\n\t}\n};\n\n/*\nRender this widget into the DOM\n*/\nWidget.prototype.render = function(parent,nextSibling) {\n\tthis.parentDomNode = parent;\n\tthis.execute();\n\tthis.renderChildren(parent,nextSibling);\n};\n\n/*\nCompute the internal state of the widget\n*/\nWidget.prototype.execute = function() {\n\tthis.makeChildWidgets();\n};\n\n/*\nSet the value of a context variable\nname: name of the variable\nvalue: value of the variable\nparams: array of {name:, default:} for each parameter\n*/\nWidget.prototype.setVariable = function(name,value,params) {\n\tthis.variables[name] = {value: value, params: params};\n};\n\n/*\nGet the prevailing value of a context variable\nname: name of variable\noptions: see below\nOptions include\nparams: array of {name:, value:} for each parameter\ndefaultValue: default value if the variable is not defined\n*/\nWidget.prototype.getVariable = function(name,options) {\n\toptions = options || {};\n\tvar actualParams = options.params || [],\n\t\tparentWidget = this.parentWidget;\n\t// Check for the variable defined in the parent widget (or an ancestor in the prototype chain)\n\tif(parentWidget &amp;&amp; name in parentWidget.variables) {\n\t\tvar variable = parentWidget.variables[name],\n\t\t\tvalue = variable.value;\n\t\t// Substitute any parameters specified in the definition\n\t\tvalue = this.substituteVariableParameters(value,variable.params,actualParams);\n\t\tvalue = this.substituteVariableReferences(value);\n\t\treturn value;\n\t}\n\t// If the variable doesn't exist in the parent widget then look for a macro module\n\treturn this.evaluateMacroModule(name,actualParams,options.defaultValue);\n};\n\nWidget.prototype.substituteVariableParameters = function(text,formalParams,actualParams) {\n\tif(formalParams) {\n\t\tvar nextAnonParameter = 0, // Next candidate anonymous parameter in macro call\n\t\t\tparamInfo, paramValue;\n\t\t// Step through each of the parameters in the macro definition\n\t\tfor(var p=0; p&lt;formalParams.length; p++) {\n\t\t\t// Check if we've got a macro call parameter with the same name\n\t\t\tparamInfo = formalParams[p];\n\t\t\tparamValue = undefined;\n\t\t\tfor(var m=0; m&lt;actualParams.length; m++) {\n\t\t\t\tif(actualParams[m].name === paramInfo.name) {\n\t\t\t\t\tparamValue = actualParams[m].value;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If not, use the next available anonymous macro call parameter\n\t\t\twhile(nextAnonParameter &lt; actualParams.length &amp;&amp; actualParams[nextAnonParameter].name) {\n\t\t\t\tnextAnonParameter++;\n\t\t\t}\n\t\t\tif(paramValue === undefined &amp;&amp; nextAnonParameter &lt; actualParams.length) {\n\t\t\t\tparamValue = actualParams[nextAnonParameter++].value;\n\t\t\t}\n\t\t\t// If we've still not got a value, use the default, if any\n\t\t\tparamValue = paramValue || paramInfo[\&quot;default\&quot;] || \&quot;\&quot;;\n\t\t\t// Replace any instances of this parameter\n\t\t\ttext = text.replace(new RegExp(\&quot;\\\\$\&quot; + $tw.utils.escapeRegExp(paramInfo.name) + \&quot;\\\\$\&quot;,\&quot;mg\&quot;),paramValue);\n\t\t}\n\t}\n\treturn text;\n};\n\nWidget.prototype.substituteVariableReferences = function(text) {\n\tvar self = this;\n\treturn (text || \&quot;\&quot;).replace(/\\$\\(([^\\)\\$]+)\\)\\$/g,function(match,p1,offset,string) {\n\t\treturn self.getVariable(p1,{defaultValue: \&quot;\&quot;});\n\t});\n};\n\nWidget.prototype.evaluateMacroModule = function(name,actualParams,defaultValue) {\n\tif($tw.utils.hop($tw.macros,name)) {\n\t\tvar macro = $tw.macros[name],\n\t\t\targs = [];\n\t\tif(macro.params.length &gt; 0) {\n\t\t\tvar nextAnonParameter = 0, // Next candidate anonymous parameter in macro call\n\t\t\t\tparamInfo, paramValue;\n\t\t\t// Step through each of the parameters in the macro definition\n\t\t\tfor(var p=0; p&lt;macro.params.length; p++) {\n\t\t\t\t// Check if we've got a macro call parameter with the same name\n\t\t\t\tparamInfo = macro.params[p];\n\t\t\t\tparamValue = undefined;\n\t\t\t\tfor(var m=0; m&lt;actualParams.length; m++) {\n\t\t\t\t\tif(actualParams[m].name === paramInfo.name) {\n\t\t\t\t\t\tparamValue = actualParams[m].value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// If not, use the next available anonymous macro call parameter\n\t\t\t\twhile(nextAnonParameter &lt; actualParams.length &amp;&amp; actualParams[nextAnonParameter].name) {\n\t\t\t\t\tnextAnonParameter++;\n\t\t\t\t}\n\t\t\t\tif(paramValue === undefined &amp;&amp; nextAnonParameter &lt; actualParams.length) {\n\t\t\t\t\tparamValue = actualParams[nextAnonParameter++].value;\n\t\t\t\t}\n\t\t\t\t// If we've still not got a value, use the default, if any\n\t\t\t\tparamValue = paramValue || paramInfo[\&quot;default\&quot;] || \&quot;\&quot;;\n\t\t\t\t// Save the parameter\n\t\t\t\targs.push(paramValue);\n\t\t\t}\n\t\t}\n\t\telse for(var i=0; i&lt;actualParams.length; ++i) {\n\t\t\targs.push(actualParams[i].value);\n\t\t}\n\t\treturn macro.run.apply(this,args).toString();\n\t} else {\n\t\treturn defaultValue;\n\t}\n};\n\n/*\nCheck whether a given context variable value exists in the parent chain\n*/\nWidget.prototype.hasVariable = function(name,value) {\n\tvar node = this;\n\twhile(node) {\n\t\tif($tw.utils.hop(node.variables,name) &amp;&amp; node.variables[name].value === value) {\n\t\t\treturn true;\n\t\t}\n\t\tnode = node.parentWidget;\n\t}\n\treturn false;\n};\n\n/*\nConstruct a qualifying string based on a hash of concatenating the values of a given variable in the parent chain\n*/\nWidget.prototype.getStateQualifier = function(name) {\n\tname = name || \&quot;transclusion\&quot;;\n\tvar output = [],\n\t\tnode = this;\n\twhile(node &amp;&amp; node.parentWidget) {\n\t\tif($tw.utils.hop(node.parentWidget.variables,name)) {\n\t\t\toutput.push(node.getVariable(name));\n\t\t}\n\t\tnode = node.parentWidget;\n\t}\n\treturn $tw.utils.hashString(output.join(\&quot;\&quot;));\n};\n\n/*\nCompute the current values of the attributes of the widget. Returns a hashmap of the names of the attributes that have changed\n*/\nWidget.prototype.computeAttributes = function() {\n\tvar changedAttributes = {},\n\t\tself = this,\n\t\tvalue;\n\t$tw.utils.each(this.parseTreeNode.attributes,function(attribute,name) {\n\t\tif(attribute.type === \&quot;indirect\&quot;) {\n\t\t\tvalue = self.wiki.getTextReference(attribute.textReference,\&quot;\&quot;,self.getVariable(\&quot;currentTiddler\&quot;));\n\t\t} else if(attribute.type === \&quot;macro\&quot;) {\n\t\t\tvalue = self.getVariable(attribute.value.name,{params: attribute.value.params});\n\t\t} else { // String attribute\n\t\t\tvalue = attribute.value;\n\t\t}\n\t\t// Check whether the attribute has changed\n\t\tif(self.attributes[name] !== value) {\n\t\t\tself.attributes[name] = value;\n\t\t\tchangedAttributes[name] = true;\n\t\t}\n\t});\n\treturn changedAttributes;\n};\n\n/*\nCheck for the presence of an attribute\n*/\nWidget.prototype.hasAttribute = function(name) {\n\treturn $tw.utils.hop(this.attributes,name);\n};\n\n/*\nGet the value of an attribute\n*/\nWidget.prototype.getAttribute = function(name,defaultText) {\n\tif($tw.utils.hop(this.attributes,name)) {\n\t\treturn this.attributes[name];\n\t} else {\n\t\treturn defaultText;\n\t}\n};\n\n/*\nAssign the computed attributes of the widget to a domNode\noptions include:\nexcludeEventAttributes: ignores attributes whose name begins with \&quot;on\&quot;\n*/\nWidget.prototype.assignAttributes = function(domNode,options) {\n\toptions = options || {};\n\tvar self = this;\n\t$tw.utils.each(this.attributes,function(v,a) {\n\t\t// Check exclusions\n\t\tif(options.excludeEventAttributes &amp;&amp; a.substr(0,2) === \&quot;on\&quot;) {\n\t\t\tv = undefined;\n\t\t}\n\t\tif(v !== undefined) {\n\t\t\tvar b = a.split(\&quot;:\&quot;);\n\t\t\t// Setting certain attributes can cause a DOM error (eg xmlns on the svg element)\n\t\t\ttry {\n\t\t\t\tif (b.length == 2 &amp;&amp; b[0] == \&quot;xlink\&quot;){\n\t\t\t\t\tdomNode.setAttributeNS(\&quot;http://www.w3.org/1999/xlink\&quot;,b[1],v);\n\t\t\t\t} else {\n\t\t\t\t\tdomNode.setAttributeNS(null,a,v);\n\t\t\t\t}\n\t\t\t} catch(e) {\n\t\t\t}\n\t\t}\n\t});\n};\n\n/*\nMake child widgets correspondng to specified parseTreeNodes\n*/\nWidget.prototype.makeChildWidgets = function(parseTreeNodes) {\n\tthis.children = [];\n\tvar self = this;\n\t$tw.utils.each(parseTreeNodes || (this.parseTreeNode &amp;&amp; this.parseTreeNode.children),function(childNode) {\n\t\tself.children.push(self.makeChildWidget(childNode));\n\t});\n};\n\n/*\nConstruct the widget object for a parse tree node\n*/\nWidget.prototype.makeChildWidget = function(parseTreeNode) {\n\tvar WidgetClass = this.widgetClasses[parseTreeNode.type];\n\tif(!WidgetClass) {\n\t\tWidgetClass = this.widgetClasses.text;\n\t\tparseTreeNode = {type: \&quot;text\&quot;, text: \&quot;Undefined widget '\&quot; + parseTreeNode.type + \&quot;'\&quot;};\n\t}\n\treturn new WidgetClass(parseTreeNode,{\n\t\twiki: this.wiki,\n\t\tvariables: {},\n\t\tparentWidget: this,\n\t\tdocument: this.document\n\t});\n};\n\n/*\nGet the next sibling of this widget\n*/\nWidget.prototype.nextSibling = function() {\n\tif(this.parentWidget) {\n\t\tvar index = this.parentWidget.children.indexOf(this);\n\t\tif(index !== -1 &amp;&amp; index &lt; this.parentWidget.children.length-1) {\n\t\t\treturn this.parentWidget.children[index+1];\n\t\t}\n\t}\n\treturn null;\n};\n\n/*\nGet the previous sibling of this widget\n*/\nWidget.prototype.previousSibling = function() {\n\tif(this.parentWidget) {\n\t\tvar index = this.parentWidget.children.indexOf(this);\n\t\tif(index !== -1 &amp;&amp; index &gt; 0) {\n\t\t\treturn this.parentWidget.children[index-1];\n\t\t}\n\t}\n\treturn null;\n};\n\n/*\nRender the children of this widget into the DOM\n*/\nWidget.prototype.renderChildren = function(parent,nextSibling) {\n\t$tw.utils.each(this.children,function(childWidget) {\n\t\tchildWidget.render(parent,nextSibling);\n\t});\n};\n\n/*\nAdd a list of event listeners from an array [{type:,handler:},...]\n*/\nWidget.prototype.addEventListeners = function(listeners) {\n\tvar self = this;\n\t$tw.utils.each(listeners,function(listenerInfo) {\n\t\tself.addEventListener(listenerInfo.type,listenerInfo.handler);\n\t});\n};\n\n/*\nAdd an event listener\n*/\nWidget.prototype.addEventListener = function(type,handler) {\n\tvar self = this;\n\tif(typeof handler === \&quot;string\&quot;) { // The handler is a method name on this widget\n\t\tthis.eventListeners[type] = function(event) {\n\t\t\treturn self[handler].call(self,event);\n\t\t};\n\t} else { // The handler is a function\n\t\tthis.eventListeners[type] = function(event) {\n\t\t\treturn handler.call(self,event);\n\t\t};\n\t}\n};\n\n/*\nDispatch an event to a widget. If the widget doesn't handle the event then it is also dispatched to the parent widget\n*/\nWidget.prototype.dispatchEvent = function(event) {\n\t// Dispatch the event if this widget handles it\n\tvar listener = this.eventListeners[event.type];\n\tif(listener) {\n\t\t// Don't propagate the event if the listener returned false\n\t\tif(!listener(event)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\t// Dispatch the event to the parent widget\n\tif(this.parentWidget) {\n\t\treturn this.parentWidget.dispatchEvent(event);\n\t}\n\treturn true;\n};\n\n/*\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\n*/\nWidget.prototype.refresh = function(changedTiddlers) {\n\treturn this.refreshChildren(changedTiddlers);\n};\n\n/*\nRebuild a previously rendered widget\n*/\nWidget.prototype.refreshSelf = function() {\n\tvar nextSibling = this.findNextSiblingDomNode();\n\tthis.removeChildDomNodes();\n\tthis.render(this.parentDomNode,nextSibling);\n};\n\n/*\nRefresh all the children of a widget\n*/\nWidget.prototype.refreshChildren = function(changedTiddlers) {\n\tvar self = this,\n\t\trefreshed = false;\n\t$tw.utils.each(this.children,function(childWidget) {\n\t\trefreshed = childWidget.refresh(changedTiddlers) || refreshed;\n\t});\n\treturn refreshed;\n};\n\n/*\nFind the next sibling in the DOM to this widget. This is done by scanning the widget tree through all next siblings and their descendents that share the same parent DOM node\n*/\nWidget.prototype.findNextSiblingDomNode = function(startIndex) {\n\t// Refer to this widget by its index within its parents children\n\tvar parent = this.parentWidget,\n\t\tindex = startIndex !== undefined ? startIndex : parent.children.indexOf(this);\nif(index === -1) {\n\tthrow \&quot;node not found in parents children\&quot;;\n}\n\t// Look for a DOM node in the later siblings\n\twhile(++index &lt; parent.children.length) {\n\t\tvar domNode = parent.children[index].findFirstDomNode();\n\t\tif(domNode) {\n\t\t\treturn domNode;\n\t\t}\n\t}\n\t// Go back and look for later siblings of our parent if it has the same parent dom node\n\tvar grandParent = parent.parentWidget;\n\tif(grandParent &amp;&amp; parent.parentDomNode === this.parentDomNode) {\n\t\tindex = grandParent.children.indexOf(parent);\n\t\treturn parent.findNextSiblingDomNode(index);\n\t}\n\treturn null;\n};\n\n/*\nFind the first DOM node generated by a widget or its children\n*/\nWidget.prototype.findFirstDomNode = function() {\n\t// Return the first dom node of this widget, if we've got one\n\tif(this.domNodes.length &gt; 0) {\n\t\treturn this.domNodes[0];\n\t}\n\t// Otherwise, recursively call our children\n\tfor(var t=0; t&lt;this.children.length; t++) {\n\t\tvar domNode = this.children[t].findFirstDomNode();\n\t\tif(domNode) {\n\t\t\treturn domNode;\n\t\t}\n\t}\n\treturn null;\n};\n\n/*\nRemove any DOM nodes created by this widget or its children\n*/\nWidget.prototype.removeChildDomNodes = function() {\n\t// If this widget has directly created DOM nodes, delete them and exit. This assumes that any child widgets are contained within the created DOM nodes, which would normally be the case\n\tif(this.domNodes.length &gt; 0) {\n\t\t$tw.utils.each(this.domNodes,function(domNode) {\n\t\t\tdomNode.parentNode.removeChild(domNode);\n\t\t});\n\t\tthis.domNodes = [];\n\t} else {\n\t\t// Otherwise, ask the child widgets to delete their DOM nodes\n\t\t$tw.utils.each(this.children,function(childWidget) {\n\t\t\tchildWidget.removeChildDomNodes();\n\t\t});\n\t}\n};\n\n/*\nInvoke any action widgets that are immediate children of this widget\n*/\nWidget.prototype.invokeActions = function(event) {\n\tvar handled = false;\n\tfor(var t=0; t&lt;this.children.length; t++) {\n\t\tvar child = this.children[t];\n\t\tif(child.invokeAction &amp;&amp; child.invokeAction(this,event)) {\n\t\t\thandled = true;\n\t\t}\n\t}\n\treturn handled;\n};\n\nexports.widget = Widget;\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/widgets/widget.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;widget&quot;
        },
        &quot;$:/core/modules/wiki.js&quot;: {
            &quot;text&quot;: &quot;/*\\\ntitle: $:/core/modules/wiki.js\ntype: application/javascript\nmodule-type: wikimethod\n\nExtension methods for the $tw.Wiki object\n\nAdds the following properties to the wiki object:\n\n* `eventListeners` is a hashmap by type of arrays of listener functions\n* `changedTiddlers` is a hashmap describing changes to named tiddlers since wiki change events were last dispatched. Each entry is a hashmap containing two fields:\n\tmodified: true/false\n\tdeleted: true/false\n* `changeCount` is a hashmap by tiddler title containing a numerical index that starts at zero and is incremented each time a tiddler is created changed or deleted\n* `caches` is a hashmap by tiddler title containing a further hashmap of named cache objects. Caches are automatically cleared when a tiddler is modified or deleted\n* `globalCache` is a hashmap by cache name of cache objects that are cleared whenever any tiddler change occurs\n\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\&quot;use strict\&quot;;\n\nvar widget = require(\&quot;$:/core/modules/widgets/widget.js\&quot;);\n\nvar USER_NAME_TITLE = \&quot;$:/status/UserName\&quot;;\n\n/*\nGet the value of a text reference. Text references can have any of these forms:\n\t&lt;tiddlertitle&gt;\n\t&lt;tiddlertitle&gt;!!&lt;fieldname&gt;\n\t!!&lt;fieldname&gt; - specifies a field of the current tiddlers\n\t&lt;tiddlertitle&gt;##&lt;index&gt;\n*/\nexports.getTextReference = function(textRef,defaultText,currTiddlerTitle) {\n\tvar tr = $tw.utils.parseTextReference(textRef),\n\t\ttitle = tr.title || currTiddlerTitle;\n\tif(tr.field) {\n\t\tvar tiddler = this.getTiddler(title);\n\t\tif(tr.field === \&quot;title\&quot;) { // Special case so we can return the title of a non-existent tiddler\n\t\t\treturn title;\n\t\t} else if(tiddler &amp;&amp; $tw.utils.hop(tiddler.fields,tr.field)) {\n\t\t\treturn tiddler.getFieldString(tr.field);\n\t\t} else {\n\t\t\treturn defaultText;\n\t\t}\n\t} else if(tr.index) {\n\t\treturn this.extractTiddlerDataItem(title,tr.index,defaultText);\n\t} else {\n\t\treturn this.getTiddlerText(title,defaultText);\n\t}\n};\n\nexports.setTextReference = function(textRef,value,currTiddlerTitle) {\n\tvar tr = $tw.utils.parseTextReference(textRef),\n\t\ttitle = tr.title || currTiddlerTitle;\n\tthis.setText(title,tr.field,tr.index,value);\n};\n\nexports.setText = function(title,field,index,value) {\n\t// Check if it is a reference to a tiddler field\n\tif(index) {\n\t\tvar data = this.getTiddlerData(title,Object.create(null));\n\t\tdata[index] = value;\n\t\tthis.setTiddlerData(title,data,this.getModificationFields());\n\t} else {\n\t\tvar tiddler = this.getTiddler(title),\n\t\t\tfields = {title: title};\n\t\tfields[field || \&quot;text\&quot;] = value;\n\t\tthis.addTiddler(new $tw.Tiddler(tiddler,fields,this.getModificationFields()));\n\t}\n};\n\nexports.deleteTextReference = function(textRef,currTiddlerTitle) {\n\tvar tr = $tw.utils.parseTextReference(textRef),\n\t\ttitle,tiddler,fields;\n\t// Check if it is a reference to a tiddler\n\tif(tr.title &amp;&amp; !tr.field) {\n\t\tthis.deleteTiddler(tr.title);\n\t// Else check for a field reference\n\t} else if(tr.field) {\n\t\ttitle = tr.title || currTiddlerTitle;\n\t\ttiddler = this.getTiddler(title);\n\t\tif(tiddler &amp;&amp; $tw.utils.hop(tiddler.fields,tr.field)) {\n\t\t\tfields = Object.create(null);\n\t\t\tfields[tr.field] = undefined;\n\t\t\tthis.addTiddler(new $tw.Tiddler(tiddler,fields,this.getModificationFields()));\n\t\t}\n\t}\n};\n\nexports.addEventListener = function(type,listener) {\n\tthis.eventListeners = this.eventListeners || {};\n\tthis.eventListeners[type] = this.eventListeners[type]  || [];\n\tthis.eventListeners[type].push(listener);\t\n};\n\nexports.removeEventListener = function(type,listener) {\n\tvar listeners = this.eventListeners[type];\n\tif(listeners) {\n\t\tvar p = listeners.indexOf(listener);\n\t\tif(p !== -1) {\n\t\t\tlisteners.splice(p,1);\n\t\t}\n\t}\n};\n\nexports.dispatchEvent = function(type /*, args */) {\n\tvar args = Array.prototype.slice.call(arguments,1),\n\t\tlisteners = this.eventListeners[type];\n\tif(listeners) {\n\t\tfor(var p=0; p&lt;listeners.length; p++) {\n\t\t\tvar listener = listeners[p];\n\t\t\tlistener.apply(listener,args);\n\t\t}\n\t}\n};\n\n/*\nCauses a tiddler to be marked as changed, incrementing the change count, and triggers event handlers.\nThis method should be called after the changes it describes have been made to the wiki.tiddlers[] array.\n\ttitle: Title of tiddler\n\tisDeleted: defaults to false (meaning the tiddler has been created or modified),\n\t\ttrue if the tiddler has been deleted\n*/\nexports.enqueueTiddlerEvent = function(title,isDeleted) {\n\t// Record the touch in the list of changed tiddlers\n\tthis.changedTiddlers = this.changedTiddlers || Object.create(null);\n\tthis.changedTiddlers[title] = this.changedTiddlers[title] || Object.create(null);\n\tthis.changedTiddlers[title][isDeleted ? \&quot;deleted\&quot; : \&quot;modified\&quot;] = true;\n\t// Increment the change count\n\tthis.changeCount = this.changeCount || Object.create(null);\n\tif($tw.utils.hop(this.changeCount,title)) {\n\t\tthis.changeCount[title]++;\n\t} else {\n\t\tthis.changeCount[title] = 1;\n\t}\n\t// Trigger events\n\tthis.eventListeners = this.eventListeners || [];\n\tif(!this.eventsTriggered) {\n\t\tvar self = this;\n\t\t$tw.utils.nextTick(function() {\n\t\t\tvar changes = self.changedTiddlers;\n\t\t\tself.changedTiddlers = Object.create(null);\n\t\t\tself.eventsTriggered = false;\n\t\t\tif($tw.utils.count(changes) &gt; 0) {\n\t\t\t\tself.dispatchEvent(\&quot;change\&quot;,changes);\n\t\t\t}\n\t\t});\n\t\tthis.eventsTriggered = true;\n\t}\n};\n\nexports.getSizeOfTiddlerEventQueue = function() {\n\treturn $tw.utils.count(this.changedTiddlers);\n};\n\nexports.clearTiddlerEventQueue = function() {\n\tthis.changedTiddlers = Object.create(null);\n\tthis.changeCount = Object.create(null);\n};\n\nexports.getChangeCount = function(title) {\n\tthis.changeCount = this.changeCount || Object.create(null);\n\tif($tw.utils.hop(this.changeCount,title)) {\n\t\treturn this.changeCount[title];\n\t} else {\n\t\treturn 0;\n\t}\n};\n\n/*\nGenerate an unused title from the specified base\n*/\nexports.generateNewTitle = function(baseTitle,options) {\n\toptions = options || {};\n\tvar c = 0,\n\t\ttitle = baseTitle;\n\twhile(this.tiddlerExists(title) || this.isShadowTiddler(title) || this.findDraft(title)) {\n\t\ttitle = baseTitle + \n\t\t\t(options.prefix || \&quot; \&quot;) + \n\t\t\t(++c);\n\t}\n\treturn title;\n};\n\nexports.isSystemTiddler = function(title) {\n\treturn title.indexOf(\&quot;$:/\&quot;) === 0;\n};\n\nexports.isTemporaryTiddler = function(title) {\n\treturn title.indexOf(\&quot;$:/temp/\&quot;) === 0;\n};\n\nexports.isImageTiddler = function(title) {\n\tvar tiddler = this.getTiddler(title);\n\tif(tiddler) {\t\t\n\t\tvar contentTypeInfo = $tw.config.contentTypeInfo[tiddler.fields.type || \&quot;text/vnd.tiddlywiki\&quot;];\n\t\treturn !!contentTypeInfo &amp;&amp; contentTypeInfo.flags.indexOf(\&quot;image\&quot;) !== -1;\n\t} else {\n\t\treturn null;\n\t}\n};\n\n/*\nLike addTiddler() except it will silently reject any plugin tiddlers that are older than the currently loaded version. Returns true if the tiddler was imported\n*/\nexports.importTiddler = function(tiddler) {\n\tvar existingTiddler = this.getTiddler(tiddler.fields.title);\n\t// Check if we're dealing with a plugin\n\tif(tiddler &amp;&amp; tiddler.hasField(\&quot;plugin-type\&quot;) &amp;&amp; tiddler.hasField(\&quot;version\&quot;) &amp;&amp; existingTiddler &amp;&amp; existingTiddler.hasField(\&quot;plugin-type\&quot;) &amp;&amp; existingTiddler.hasField(\&quot;version\&quot;)) {\n\t\t// Reject the incoming plugin if it is older\n\t\tif($tw.utils.checkVersions(existingTiddler.fields.version,tiddler.fields.version)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\t// Fall through to adding the tiddler\n\tthis.addTiddler(tiddler);\n\treturn true;\n};\n\n/*\nReturn a hashmap of the fields that should be set when a tiddler is created\n*/\nexports.getCreationFields = function() {\n\tvar fields = {\n\t\t\tcreated: new Date()\n\t\t},\n\t\tcreator = this.getTiddlerText(USER_NAME_TITLE);\n\tif(creator) {\n\t\tfields.creator = creator;\n\t}\n\treturn fields;\n};\n\n/*\nReturn a hashmap of the fields that should be set when a tiddler is modified\n*/\nexports.getModificationFields = function() {\n\tvar fields = Object.create(null),\n\t\tmodifier = this.getTiddlerText(USER_NAME_TITLE);\n\tfields.modified = new Date();\n\tif(modifier) {\n\t\tfields.modifier = modifier;\n\t}\n\treturn fields;\n};\n\n/*\nReturn a sorted array of tiddler titles.  Options include:\nsortField: field to sort by\nexcludeTag: tag to exclude\nincludeSystem: whether to include system tiddlers (defaults to false)\n*/\nexports.getTiddlers = function(options) {\n\toptions = options || Object.create(null);\n\tvar self = this,\n\t\tsortField = options.sortField || \&quot;title\&quot;,\n\t\ttiddlers = [], t, titles = [];\n\tthis.each(function(tiddler,title) {\n\t\tif(options.includeSystem || !self.isSystemTiddler(title)) {\n\t\t\tif(!options.excludeTag || !tiddler.hasTag(options.excludeTag)) {\n\t\t\t\ttiddlers.push(tiddler);\n\t\t\t}\n\t\t}\n\t});\n\ttiddlers.sort(function(a,b) {\n\t\tvar aa = a.fields[sortField].toLowerCase() || \&quot;\&quot;,\n\t\t\tbb = b.fields[sortField].toLowerCase() || \&quot;\&quot;;\n\t\tif(aa &lt; bb) {\n\t\t\treturn -1;\n\t\t} else {\n\t\t\tif(aa &gt; bb) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t});\n\tfor(t=0; t&lt;tiddlers.length; t++) {\n\t\ttitles.push(tiddlers[t].fields.title);\n\t}\n\treturn titles;\n};\n\nexports.countTiddlers = function(excludeTag) {\n\tvar tiddlers = this.getTiddlers({excludeTag: excludeTag});\n\treturn $tw.utils.count(tiddlers);\n};\n\n/*\nReturns a function iterator(callback) that iterates through the specified titles, and invokes the callback with callback(tiddler,title)\n*/\nexports.makeTiddlerIterator = function(titles) {\n\tvar self = this;\n\tif(!$tw.utils.isArray(titles)) {\n\t\ttitles = Object.keys(titles);\n\t} else {\n\t\ttitles = titles.slice(0);\n\t}\n\treturn function(callback) {\n\t\ttitles.forEach(function(title) {\n\t\t\tcallback(self.getTiddler(title),title);\n\t\t});\n\t};\n};\n\n/*\nSort an array of tiddler titles by a specified field\n\ttitles: array of titles (sorted in place)\n\tsortField: name of field to sort by\n\tisDescending: true if the sort should be descending\n\tisCaseSensitive: true if the sort should consider upper and lower case letters to be different\n*/\nexports.sortTiddlers = function(titles,sortField,isDescending,isCaseSensitive,isNumeric) {\n\tvar self = this;\n\ttitles.sort(function(a,b) {\n\t\tif(sortField !== \&quot;title\&quot;) {\n\t\t\tvar tiddlerA = self.getTiddler(a),\n\t\t\t\ttiddlerB = self.getTiddler(b);\n\t\t\tif(tiddlerA) {\n\t\t\t\ta = tiddlerA.fields[sortField] || \&quot;\&quot;;\n\t\t\t} else {\n\t\t\t\ta = \&quot;\&quot;;\n\t\t\t}\n\t\t\tif(tiddlerB) {\n\t\t\t\tb = tiddlerB.fields[sortField] || \&quot;\&quot;;\n\t\t\t} else {\n\t\t\t\tb = \&quot;\&quot;;\n\t\t\t}\n\t\t}\n\t\tif(isNumeric) {\n\t\t\ta = Number(a);\n\t\t\tb = Number(b);\n\t\t\treturn isDescending ? b - a : a - b;\n\t\t} else if($tw.utils.isDate(a) &amp;&amp; $tw.utils.isDate(b)) {\n\t\t\treturn isDescending ? b - a : a - b;\n\t\t} else {\n\t\t\ta = String(a);\n\t\t\tb = String(b);\n\t\t\tif(!isCaseSensitive) {\n\t\t\t\ta = a.toLowerCase();\n\t\t\t\tb = b.toLowerCase();\n\t\t\t}\n\t\t\treturn isDescending ? b.localeCompare(a) : a.localeCompare(b);\n\t\t}\n\t});\n};\n\n/*\nFor every tiddler invoke a callback(title,tiddler) with `this` set to the wiki object. Options include:\nsortField: field to sort by\nexcludeTag: tag to exclude\nincludeSystem: whether to include system tiddlers (defaults to false)\n*/\nexports.forEachTiddler = function(/* [options,]callback */) {\n\tvar arg = 0,\n\t\toptions = arguments.length &gt;= 2 ? arguments[arg++] : {},\n\t\tcallback = arguments[arg++],\n\t\ttitles = this.getTiddlers(options),\n\t\tt, tiddler;\n\tfor(t=0; t&lt;titles.length; t++) {\n\t\ttiddler = this.getTiddler(titles[t]);\n\t\tif(tiddler) {\n\t\t\tcallback.call(this,tiddler.fields.title,tiddler);\n\t\t}\n\t}\n};\n\n/*\nReturn an array of tiddler titles that are directly linked from the specified tiddler\n*/\nexports.getTiddlerLinks = function(title) {\n\tvar self = this;\n\t// We'll cache the links so they only get computed if the tiddler changes\n\treturn this.getCacheForTiddler(title,\&quot;links\&quot;,function() {\n\t\t// Parse the tiddler\n\t\tvar parser = self.parseTiddler(title);\n\t\t// Count up the links\n\t\tvar links = [],\n\t\t\tcheckParseTree = function(parseTree) {\n\t\t\t\tfor(var t=0; t&lt;parseTree.length; t++) {\n\t\t\t\t\tvar parseTreeNode = parseTree[t];\n\t\t\t\t\tif(parseTreeNode.type === \&quot;link\&quot; &amp;&amp; parseTreeNode.attributes.to &amp;&amp; parseTreeNode.attributes.to.type === \&quot;string\&quot;) {\n\t\t\t\t\t\tvar value = parseTreeNode.attributes.to.value;\n\t\t\t\t\t\tif(links.indexOf(value) === -1) {\n\t\t\t\t\t\t\tlinks.push(value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(parseTreeNode.children) {\n\t\t\t\t\t\tcheckParseTree(parseTreeNode.children);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\tif(parser) {\n\t\t\tcheckParseTree(parser.tree);\n\t\t}\n\t\treturn links;\n\t});\n};\n\n/*\nReturn an array of tiddler titles that link to the specified tiddler\n*/\nexports.getTiddlerBacklinks = function(targetTitle) {\n\tvar self = this,\n\t\tbacklinks = [];\n\tthis.forEachTiddler(function(title,tiddler) {\n\t\tvar links = self.getTiddlerLinks(title);\n\t\tif(links.indexOf(targetTitle) !== -1) {\n\t\t\tbacklinks.push(title);\n\t\t}\n\t});\n\treturn backlinks;\n};\n\n/*\nReturn a hashmap of tiddler titles that are referenced but not defined. Each value is the number of times the missing tiddler is referenced\n*/\nexports.getMissingTitles = function() {\n\tvar self = this,\n\t\tmissing = [];\n// We should cache the missing tiddler list, even if we recreate it every time any tiddler is modified\n\tthis.forEachTiddler(function(title,tiddler) {\n\t\tvar links = self.getTiddlerLinks(title);\n\t\t$tw.utils.each(links,function(link) {\n\t\t\tif((!self.tiddlerExists(link) &amp;&amp; !self.isShadowTiddler(link)) &amp;&amp; missing.indexOf(link) === -1) {\n\t\t\t\tmissing.push(link);\n\t\t\t}\n\t\t});\n\t});\n\treturn missing;\n};\n\nexports.getOrphanTitles = function() {\n\tvar self = this,\n\t\torphans = this.getTiddlers();\n\tthis.forEachTiddler(function(title,tiddler) {\n\t\tvar links = self.getTiddlerLinks(title);\n\t\t$tw.utils.each(links,function(link) {\n\t\t\tvar p = orphans.indexOf(link);\n\t\t\tif(p !== -1) {\n\t\t\t\torphans.splice(p,1);\n\t\t\t}\n\t\t});\n\t});\n\treturn orphans; // Todo\n};\n\n/*\nRetrieves a list of the tiddler titles that are tagged with a given tag\n*/\nexports.getTiddlersWithTag = function(tag) {\n\tvar self = this;\n\treturn this.getGlobalCache(\&quot;taglist-\&quot; + tag,function() {\n\t\tvar tagmap = self.getTagMap();\n\t\treturn self.sortByList(tagmap[tag],tag);\n\t});\n};\n\n/*\nGet a hashmap by tag of arrays of tiddler titles\n*/\nexports.getTagMap = function() {\n\tvar self = this;\n\treturn this.getGlobalCache(\&quot;tagmap\&quot;,function() {\n\t\tvar tags = Object.create(null),\n\t\t\tstoreTags = function(tagArray,title) {\n\t\t\t\tif(tagArray) {\n\t\t\t\t\tfor(var index=0; index&lt;tagArray.length; index++) {\n\t\t\t\t\t\tvar tag = tagArray[index];\n\t\t\t\t\t\tif($tw.utils.hop(tags,tag)) {\n\t\t\t\t\t\t\ttags[tag].push(title);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttags[tag] = [title];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\ttitle, tiddler;\n\t\t// Collect up all the tags\n\t\tself.eachShadow(function(tiddler,title) {\n\t\t\tif(!self.tiddlerExists(title)) {\n\t\t\t\ttiddler = self.getTiddler(title);\n\t\t\t\tstoreTags(tiddler.fields.tags,title);\n\t\t\t}\n\t\t});\n\t\tself.each(function(tiddler,title) {\n\t\t\tstoreTags(tiddler.fields.tags,title);\n\t\t});\n\t\treturn tags;\n\t});\n};\n\n/*\nLookup a given tiddler and return a list of all the tiddlers that include it in the specified list field\n*/\nexports.findListingsOfTiddler = function(targetTitle,fieldName) {\n\tfieldName = fieldName || \&quot;list\&quot;;\n\tvar titles = [];\n\tthis.each(function(tiddler,title) {\n\t\tvar list = $tw.utils.parseStringArray(tiddler.fields[fieldName]);\n\t\tif(list &amp;&amp; list.indexOf(targetTitle) !== -1) {\n\t\t\ttitles.push(title);\n\t\t}\n\t});\n\treturn titles;\n};\n\n/*\nSorts an array of tiddler titles according to an ordered list\n*/\nexports.sortByList = function(array,listTitle) {\n\tvar list = this.getTiddlerList(listTitle);\n\tif(!array || array.length === 0) {\n\t\treturn [];\n\t} else {\n\t\tvar titles = [], t, title;\n\t\t// First place any entries that are present in the list\n\t\tfor(t=0; t&lt;list.length; t++) {\n\t\t\ttitle = list[t];\n\t\t\tif(array.indexOf(title) !== -1) {\n\t\t\t\ttitles.push(title);\n\t\t\t}\n\t\t}\n\t\t// Then place any remaining entries\n\t\tfor(t=0; t&lt;array.length; t++) {\n\t\t\ttitle = array[t];\n\t\t\tif(list.indexOf(title) === -1) {\n\t\t\t\ttitles.push(title);\n\t\t\t}\n\t\t}\n\t\t// Finally obey the list-before and list-after fields of each tiddler in turn\n\t\tvar sortedTitles = titles.slice(0);\n\t\tfor(t=0; t&lt;sortedTitles.length; t++) {\n\t\t\ttitle = sortedTitles[t];\n\t\t\tvar currPos = titles.indexOf(title),\n\t\t\t\tnewPos = -1,\n\t\t\t\ttiddler = this.getTiddler(title);\n\t\t\tif(tiddler) {\n\t\t\t\tvar beforeTitle = tiddler.fields[\&quot;list-before\&quot;],\n\t\t\t\t\tafterTitle = tiddler.fields[\&quot;list-after\&quot;];\n\t\t\t\tif(beforeTitle === \&quot;\&quot;) {\n\t\t\t\t\tnewPos = 0;\n\t\t\t\t} else if(beforeTitle) {\n\t\t\t\t\tnewPos = titles.indexOf(beforeTitle);\n\t\t\t\t} else if(afterTitle) {\n\t\t\t\t\tnewPos = titles.indexOf(afterTitle);\n\t\t\t\t\tif(newPos &gt;= 0) {\n\t\t\t\t\t\t++newPos;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(newPos === -1) {\n\t\t\t\t\tnewPos = currPos;\n\t\t\t\t}\n\t\t\t\tif(newPos !== currPos) {\n\t\t\t\t\ttitles.splice(currPos,1);\n\t\t\t\t\tif(newPos &gt;= currPos) {\n\t\t\t\t\t\tnewPos--;\n\t\t\t\t\t}\n\t\t\t\t\ttitles.splice(newPos,0,title);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\treturn titles;\n\t}\n};\n\nexports.getSubTiddler = function(title,subTiddlerTitle) {\n\tvar bundleInfo = this.getPluginInfo(title) || this.getTiddlerData(title);\n\tif(bundleInfo &amp;&amp; bundleInfo.tiddlers) {\n\t\tvar subTiddler = bundleInfo.tiddlers[subTiddlerTitle];\n\t\tif(subTiddler) {\n\t\t\treturn new $tw.Tiddler(subTiddler);\n\t\t}\n\t}\n\treturn null;\n};\n\n/*\nRetrieve a tiddler as a JSON string of the fields\n*/\nexports.getTiddlerAsJson = function(title) {\n\tvar tiddler = this.getTiddler(title);\n\tif(tiddler) {\n\t\tvar fields = Object.create(null);\n\t\t$tw.utils.each(tiddler.fields,function(value,name) {\n\t\t\tfields[name] = tiddler.getFieldString(name);\n\t\t});\n\t\treturn JSON.stringify(fields);\n\t} else {\n\t\treturn JSON.stringify({title: title});\n\t}\n};\n\n/*\nGet the content of a tiddler as a JavaScript object. How this is done depends on the type of the tiddler:\n\napplication/json: the tiddler JSON is parsed into an object\napplication/x-tiddler-dictionary: the tiddler is parsed as sequence of name:value pairs\n\nOther types currently just return null.\n\ntitleOrTiddler: string tiddler title or a tiddler object\ndefaultData: default data to be returned if the tiddler is missing or doesn't contain data\n*/\nexports.getTiddlerData = function(titleOrTiddler,defaultData) {\n\tvar tiddler = titleOrTiddler,\n\t\tdata;\n\tif(!(tiddler instanceof $tw.Tiddler)) {\n\t\ttiddler = this.getTiddler(tiddler);\t\n\t}\n\tif(tiddler &amp;&amp; tiddler.fields.text) {\n\t\tswitch(tiddler.fields.type) {\n\t\t\tcase \&quot;application/json\&quot;:\n\t\t\t\t// JSON tiddler\n\t\t\t\ttry {\n\t\t\t\t\tdata = JSON.parse(tiddler.fields.text);\n\t\t\t\t} catch(ex) {\n\t\t\t\t\treturn defaultData;\n\t\t\t\t}\n\t\t\t\treturn data;\n\t\t\tcase \&quot;application/x-tiddler-dictionary\&quot;:\n\t\t\t\treturn $tw.utils.parseFields(tiddler.fields.text);\n\t\t}\n\t}\n\treturn defaultData;\n};\n\n/*\nExtract an indexed field from within a data tiddler\n*/\nexports.extractTiddlerDataItem = function(titleOrTiddler,index,defaultText) {\n\tvar data = this.getTiddlerData(titleOrTiddler,Object.create(null)),\n\t\ttext;\n\tif(data &amp;&amp; $tw.utils.hop(data,index)) {\n\t\ttext = data[index];\n\t}\n\tif(typeof text === \&quot;string\&quot; || typeof text === \&quot;number\&quot;) {\n\t\treturn text.toString();\n\t} else {\n\t\treturn defaultText;\n\t}\n};\n\n/*\nSet a tiddlers content to a JavaScript object. Currently this is done by setting the tiddler's type to \&quot;application/json\&quot; and setting the text to the JSON text of the data.\ntitle: title of tiddler\ndata: object that can be serialised to JSON\nfields: optional hashmap of additional tiddler fields to be set\n*/\nexports.setTiddlerData = function(title,data,fields) {\n\tvar existingTiddler = this.getTiddler(title),\n\t\tnewFields = {\n\t\t\ttitle: title\n\t};\n\tif(existingTiddler &amp;&amp; existingTiddler.fields.type === \&quot;application/x-tiddler-dictionary\&quot;) {\n\t\tnewFields.text = $tw.utils.makeTiddlerDictionary(data);\n\t} else {\n\t\tnewFields.type = \&quot;application/json\&quot;;\n\t\tnewFields.text = JSON.stringify(data,null,$tw.config.preferences.jsonSpaces);\n\t}\n\tthis.addTiddler(new $tw.Tiddler(existingTiddler,fields,newFields,this.getModificationFields()));\n};\n\n/*\nReturn the content of a tiddler as an array containing each line\n*/\nexports.getTiddlerList = function(title,field,index) {\n\tif(index) {\n\t\treturn $tw.utils.parseStringArray(this.extractTiddlerDataItem(title,index,\&quot;\&quot;));\n\t}\n\tfield = field || \&quot;list\&quot;;\n\tvar tiddler = this.getTiddler(title);\n\tif(tiddler) {\n\t\treturn ($tw.utils.parseStringArray(tiddler.fields[field]) || []).slice(0);\n\t}\n\treturn [];\n};\n\n// Return a named global cache object. Global cache objects are cleared whenever a tiddler change occurs\nexports.getGlobalCache = function(cacheName,initializer) {\n\tthis.globalCache = this.globalCache || Object.create(null);\n\tif($tw.utils.hop(this.globalCache,cacheName)) {\n\t\treturn this.globalCache[cacheName];\n\t} else {\n\t\tthis.globalCache[cacheName] = initializer();\n\t\treturn this.globalCache[cacheName];\n\t}\n};\n\nexports.clearGlobalCache = function() {\n\tthis.globalCache = Object.create(null);\n};\n\n// Return the named cache object for a tiddler. If the cache doesn't exist then the initializer function is invoked to create it\nexports.getCacheForTiddler = function(title,cacheName,initializer) {\n\n// Temporarily disable caching so that tweakParseTreeNode() works\nreturn initializer();\n\n//\tthis.caches = this.caches || Object.create(null);\n//\tvar caches = this.caches[title];\n//\tif(caches &amp;&amp; caches[cacheName]) {\n//\t\treturn caches[cacheName];\n//\t} else {\n//\t\tif(!caches) {\n//\t\t\tcaches = Object.create(null);\n//\t\t\tthis.caches[title] = caches;\n//\t\t}\n//\t\tcaches[cacheName] = initializer();\n//\t\treturn caches[cacheName];\n//\t}\n};\n\n// Clear all caches associated with a particular tiddler\nexports.clearCache = function(title) {\n\tthis.caches = this.caches || Object.create(null);\n\tif($tw.utils.hop(this.caches,title)) {\n\t\tdelete this.caches[title];\n\t}\n};\n\nexports.initParsers = function(moduleType) {\n\t// Install the parser modules\n\t$tw.Wiki.parsers = {};\n\tvar self = this;\n\t$tw.modules.forEachModuleOfType(\&quot;parser\&quot;,function(title,module) {\n\t\tfor(var f in module) {\n\t\t\tif($tw.utils.hop(module,f)) {\n\t\t\t\t$tw.Wiki.parsers[f] = module[f]; // Store the parser class\n\t\t\t}\n\t\t}\n\t});\n};\n\n/*\nParse a block of text of a specified MIME type\n\ttype: content type of text to be parsed\n\ttext: text\n\toptions: see below\nOptions include:\n\tparseAsInline: if true, the text of the tiddler will be parsed as an inline run\n\t_canonical_uri: optional string of the canonical URI of this content\n*/\nexports.old_parseText = function(type,text,options) {\n\toptions = options || {};\n\t// Select a parser\n\tvar Parser = $tw.Wiki.parsers[type];\n\tif(!Parser &amp;&amp; $tw.config.fileExtensionInfo[type]) {\n\t\tParser = $tw.Wiki.parsers[$tw.config.fileExtensionInfo[type].type];\n\t}\n\tif(!Parser) {\n\t\tParser = $tw.Wiki.parsers[options.defaultType || \&quot;text/vnd.tiddlywiki\&quot;];\n\t}\n\tif(!Parser) {\n\t\treturn null;\n\t}\n\t// Return the parser instance\n\treturn new Parser(type,text,{\n\t\tparseAsInline: options.parseAsInline,\n\t\twiki: this,\n\t\t_canonical_uri: options._canonical_uri\n\t});\n};\n\n/*\nParse a tiddler according to its MIME type\n*/\nexports.old_parseTiddler = function(title,options) {\n\toptions = $tw.utils.extend({},options);\n\tvar cacheType = options.parseAsInline ? \&quot;newInlineParseTree\&quot; : \&quot;newBlockParseTree\&quot;,\n\t\ttiddler = this.getTiddler(title),\n\t\tself = this;\n\treturn tiddler ? this.getCacheForTiddler(title,cacheType,function() {\n\t\t\tif(tiddler.hasField(\&quot;_canonical_uri\&quot;)) {\n\t\t\t\toptions._canonical_uri = tiddler.fields._canonical_uri;\n\t\t\t}\n\t\t\treturn self.old_parseText(tiddler.fields.type,tiddler.fields.text,options);\n\t\t}) : null;\n};\n\nvar tweakMacroDefinition = function(nodeList) {\n\tif(nodeList &amp;&amp; nodeList[0] &amp;&amp; nodeList[0].type === \&quot;macrodef\&quot;) {\n\t\tnodeList[0].type = \&quot;set\&quot;;\n\t\tnodeList[0].attributes = {\n\t\t\tname: {type: \&quot;string\&quot;, value: nodeList[0].name},\n\t\t\tvalue: {type: \&quot;string\&quot;, value: nodeList[0].text}\n\t\t};\n\t\tnodeList[0].children = nodeList.slice(1);\n\t\tnodeList.splice(1,nodeList.length-1);\n\t\ttweakMacroDefinition(nodeList[0].children);\n\t}\n};\n\nvar tweakParser = function(parser) {\n\t// Move any macro definitions to contain the body tree\n\ttweakMacroDefinition(parser.tree);\n};\n\nexports.parseText = function(type,text,options) {\n\tvar parser = this.old_parseText(type,text,options);\n\tif(parser) {\n\t\ttweakParser(parser);\n\t}\n\treturn parser;\n};\n\nexports.parseTiddler = function(title,options) {\n\tvar parser = this.old_parseTiddler(title,options);\n\tif(parser) {\n\t\ttweakParser(parser);\n\t}\n\treturn parser;\n};\n\nexports.parseTextReference = function(title,field,index,options) {\n\tvar tiddler,text;\n\tif(options.subTiddler) {\n\t\ttiddler = this.getSubTiddler(title,options.subTiddler);\n\t} else {\n\t\ttiddler = this.getTiddler(title);\n\t\tif(field === \&quot;text\&quot; || (!field &amp;&amp; !index)) {\n\t\t\tthis.getTiddlerText(title); // Force the tiddler to be lazily loaded\n\t\t\treturn this.parseTiddler(title,options);\n\t\t}\n\t}\n\tif(field === \&quot;text\&quot; || (!field &amp;&amp; !index)) {\n\t\tif(tiddler &amp;&amp; tiddler.fields) {\n\t\t\treturn this.parseText(tiddler.fields.type || \&quot;text/vnd.tiddlywiki\&quot;,tiddler.fields.text,options);\t\t\t\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t} else if(field) {\n\t\tif(field === \&quot;title\&quot;) {\n\t\t\ttext = title;\n\t\t} else {\n\t\t\tif(!tiddler || !tiddler.hasField(field)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\ttext = tiddler.fields[field];\n\t\t}\n\t\treturn this.parseText(\&quot;text/vnd.tiddlywiki\&quot;,text.toString(),options);\n\t} else if(index) {\n\t\tthis.getTiddlerText(title); // Force the tiddler to be lazily loaded\n\t\ttext = this.extractTiddlerDataItem(tiddler,index,undefined);\n\t\tif(text === undefined) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this.parseText(\&quot;text/vnd.tiddlywiki\&quot;,text,options);\n\t}\n};\n\n/*\nMake a widget tree for a parse tree\nparser: parser object\noptions: see below\nOptions include:\ndocument: optional document to use\nvariables: hashmap of variables to set\nparentWidget: optional parent widget for the root node\n*/\nexports.makeWidget = function(parser,options) {\n\toptions = options || {};\n\tvar widgetNode = {\n\t\t\ttype: \&quot;widget\&quot;,\n\t\t\tchildren: []\n\t\t},\n\t\tcurrWidgetNode = widgetNode;\n\t// Create set variable widgets for each variable\n\t$tw.utils.each(options.variables,function(value,name) {\n\t\tvar setVariableWidget = {\n\t\t\ttype: \&quot;set\&quot;,\n\t\t\tattributes: {\n\t\t\t\tname: {type: \&quot;string\&quot;, value: name},\n\t\t\t\tvalue: {type: \&quot;string\&quot;, value: value}\n\t\t\t},\n\t\t\tchildren: []\n\t\t};\n\t\tcurrWidgetNode.children = [setVariableWidget];\n\t\tcurrWidgetNode = setVariableWidget;\n\t});\n\t// Add in the supplied parse tree nodes\n\tcurrWidgetNode.children = parser ? parser.tree : [];\n\t// Create the widget\n\treturn new widget.widget(widgetNode,{\n\t\twiki: this,\n\t\tdocument: options.document || $tw.fakeDocument,\n\t\tparentWidget: options.parentWidget\n\t});\n};\n\n/*\nMake a widget tree for transclusion\ntitle: target tiddler title\noptions: as for wiki.makeWidget() plus:\noptions.field: optional field to transclude (defaults to \&quot;text\&quot;)\noptions.children: optional array of children for the transclude widget\n*/\nexports.makeTranscludeWidget = function(title,options) {\n\toptions = options || {};\n\tvar parseTree = {tree: [{\n\t\t\ttype: \&quot;element\&quot;,\n\t\t\ttag: \&quot;div\&quot;,\n\t\t\tchildren: [{\n\t\t\t\ttype: \&quot;transclude\&quot;,\n\t\t\t\tattributes: {\n\t\t\t\t\ttiddler: {\n\t\t\t\t\t\tname: \&quot;tiddler\&quot;,\n\t\t\t\t\t\ttype: \&quot;string\&quot;,\n\t\t\t\t\t\tvalue: title}},\n\t\t\t\tisBlock: !options.parseAsInline}]}\n\t]};\n\tif(options.field) {\n\t\tparseTree.tree[0].children[0].attributes.field = {type: \&quot;string\&quot;, value: options.field};\n\t}\n\tif(options.children) {\n\t\tparseTree.tree[0].children[0].children = options.children;\n\t}\n\treturn $tw.wiki.makeWidget(parseTree,options);\n};\n\n/*\nParse text in a specified format and render it into another format\n\toutputType: content type for the output\n\ttextType: content type of the input text\n\ttext: input text\n\toptions: see below\nOptions include:\nvariables: hashmap of variables to set\nparentWidget: optional parent widget for the root node\n*/\nexports.renderText = function(outputType,textType,text,options) {\n\toptions = options || {};\n\tvar parser = this.parseText(textType,text,options),\n\t\twidgetNode = this.makeWidget(parser,options);\n\tvar container = $tw.fakeDocument.createElement(\&quot;div\&quot;);\n\twidgetNode.render(container,null);\n\treturn outputType === \&quot;text/html\&quot; ? container.innerHTML : container.textContent;\n};\n\n/*\nParse text from a tiddler and render it into another format\n\toutputType: content type for the output\n\ttitle: title of the tiddler to be rendered\n\toptions: see below\nOptions include:\nvariables: hashmap of variables to set\nparentWidget: optional parent widget for the root node\n*/\nexports.renderTiddler = function(outputType,title,options) {\n\toptions = options || {};\n\tvar parser = this.parseTiddler(title,options),\n\t\twidgetNode = this.makeWidget(parser,options);\n\tvar container = $tw.fakeDocument.createElement(\&quot;div\&quot;);\n\twidgetNode.render(container,null);\n\treturn outputType === \&quot;text/html\&quot; ? container.innerHTML : (outputType === \&quot;text/plain-formatted\&quot; ? container.formattedTextContent : container.textContent);\n};\n\n/*\nReturn an array of tiddler titles that match a search string\n\ttext: The text string to search for\n\toptions: see below\nOptions available:\n\tsource: an iterator function for the source tiddlers, called source(iterator), where iterator is called as iterator(tiddler,title)\n\texclude: An array of tiddler titles to exclude from the search\n\tinvert: If true returns tiddlers that do not contain the specified string\n\tcaseSensitive: If true forces a case sensitive search\n\tliteral: If true, searches for literal string, rather than separate search terms\n\tfield: If specified, restricts the search to the specified field\n*/\nexports.search = function(text,options) {\n\toptions = options || {};\n\tvar self = this,\n\t\tt,\n\t\tinvert = !!options.invert;\n\t// Convert the search string into a regexp for each term\n\tvar terms, searchTermsRegExps,\n\t\tflags = options.caseSensitive ? \&quot;\&quot; : \&quot;i\&quot;;\n\tif(options.literal) {\n\t\tif(text.length === 0) {\n\t\t\tsearchTermsRegExps = null;\n\t\t} else {\n\t\t\tsearchTermsRegExps = [new RegExp(\&quot;(\&quot; + $tw.utils.escapeRegExp(text) + \&quot;)\&quot;,flags)];\n\t\t}\n\t} else {\n\t\tterms = text.split(/ +/);\n\t\tif(terms.length === 1 &amp;&amp; terms[0] === \&quot;\&quot;) {\n\t\t\tsearchTermsRegExps = null;\n\t\t} else {\n\t\t\tsearchTermsRegExps = [];\n\t\t\tfor(t=0; t&lt;terms.length; t++) {\n\t\t\t\tsearchTermsRegExps.push(new RegExp(\&quot;(\&quot; + $tw.utils.escapeRegExp(terms[t]) + \&quot;)\&quot;,flags));\n\t\t\t}\n\t\t}\n\t}\n\t// Function to check a given tiddler for the search term\n\tvar searchTiddler = function(title) {\n\t\tif(!searchTermsRegExps) {\n\t\t\treturn true;\n\t\t}\n\t\tvar tiddler = self.getTiddler(title);\n\t\tif(!tiddler) {\n\t\t\ttiddler = new $tw.Tiddler({title: title, text: \&quot;\&quot;, type: \&quot;text/vnd.tiddlywiki\&quot;});\n\t\t}\n\t\tvar contentTypeInfo = $tw.config.contentTypeInfo[tiddler.fields.type] || $tw.config.contentTypeInfo[\&quot;text/vnd.tiddlywiki\&quot;],\n\t\t\tmatch;\n\t\tfor(var t=0; t&lt;searchTermsRegExps.length; t++) {\n\t\t\tmatch = false;\n\t\t\tif(options.field) {\n\t\t\t\tmatch = searchTermsRegExps[t].test(tiddler.getFieldString(options.field));\n\t\t\t} else {\n\t\t\t\t// Search title, tags and body\n\t\t\t\tif(contentTypeInfo.encoding === \&quot;utf8\&quot;) {\n\t\t\t\t\tmatch = match || searchTermsRegExps[t].test(tiddler.fields.text);\n\t\t\t\t}\n\t\t\t\tvar tags = tiddler.fields.tags ? tiddler.fields.tags.join(\&quot;\\0\&quot;) : \&quot;\&quot;;\n\t\t\t\tmatch = match || searchTermsRegExps[t].test(tags) || searchTermsRegExps[t].test(tiddler.fields.title);\n\t\t\t}\n\t\t\tif(!match) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\t// Loop through all the tiddlers doing the search\n\tvar results = [],\n\t\tsource = options.source || this.each;\n\tsource(function(tiddler,title) {\n\t\tif(searchTiddler(title) !== options.invert) {\n\t\t\tresults.push(title);\n\t\t}\n\t});\n\t// Remove any of the results we have to exclude\n\tif(options.exclude) {\n\t\tfor(t=0; t&lt;options.exclude.length; t++) {\n\t\t\tvar p = results.indexOf(options.exclude[t]);\n\t\t\tif(p !== -1) {\n\t\t\t\tresults.splice(p,1);\n\t\t\t}\n\t\t}\n\t}\n\treturn results;\n};\n\n/*\nTrigger a load for a tiddler if it is skinny. Returns the text, or undefined if the tiddler is missing, null if the tiddler is being lazily loaded.\n*/\nexports.getTiddlerText = function(title,defaultText) {\n\tvar tiddler = this.getTiddler(title);\n\t// Return undefined if the tiddler isn't found\n\tif(!tiddler) {\n\t\treturn defaultText;\n\t}\n\tif(tiddler.fields.text !== undefined) {\n\t\t// Just return the text if we've got it\n\t\treturn tiddler.fields.text;\n\t} else {\n\t\t// Tell any listeners about the need to lazily load this tiddler\n\t\tthis.dispatchEvent(\&quot;lazyLoad\&quot;,title);\n\t\t// Indicate that the text is being loaded\n\t\treturn null;\n\t}\n};\n\n/*\nRead an array of browser File objects, invoking callback(tiddlerFieldsArray) once they're all read\n*/\nexports.readFiles = function(files,callback) {\n\tvar result = [],\n\t\toutstanding = files.length;\n\tfor(var f=0; f&lt;files.length; f++) {\n\t\tthis.readFile(files[f],function(tiddlerFieldsArray) {\n\t\t\tresult.push.apply(result,tiddlerFieldsArray);\n\t\t\tif(--outstanding === 0) {\n\t\t\t\tcallback(result);\n\t\t\t}\n\t\t});\n\t}\n\treturn files.length;\n};\n\n/*\nRead a browser File object, invoking callback(tiddlerFieldsArray) with an array of tiddler fields objects\n*/\nexports.readFile = function(file,callback) {\n\t// Get the type, falling back to the filename extension\n\tvar self = this,\n\t\ttype = file.type;\n\tif(type === \&quot;\&quot; || !type) {\n\t\tvar dotPos = file.name.lastIndexOf(\&quot;.\&quot;);\n\t\tif(dotPos !== -1) {\n\t\t\tvar fileExtensionInfo = $tw.config.fileExtensionInfo[file.name.substr(dotPos)];\n\t\t\tif(fileExtensionInfo) {\n\t\t\t\ttype = fileExtensionInfo.type;\n\t\t\t}\n\t\t}\n\t}\n\t// Figure out if we're reading a binary file\n\tvar contentTypeInfo = $tw.config.contentTypeInfo[type],\n\t\tisBinary = contentTypeInfo ? contentTypeInfo.encoding === \&quot;base64\&quot; : false;\n\t// Log some debugging information\n\tif($tw.log.IMPORT) {\n\t\tconsole.log(\&quot;Importing file '\&quot; + file.name + \&quot;', type: '\&quot; + type + \&quot;', isBinary: \&quot; + isBinary);\n\t}\n\t// Create the FileReader\n\tvar reader = new FileReader();\n\t// Onload\n\treader.onload = function(event) {\n\t\t// Deserialise the file contents\n\t\tvar text = event.target.result,\n\t\t\ttiddlerFields = {title: file.name || \&quot;Untitled\&quot;, type: type};\n\t\t// Are we binary?\n\t\tif(isBinary) {\n\t\t\t// The base64 section starts after the first comma in the data URI\n\t\t\tvar commaPos = text.indexOf(\&quot;,\&quot;);\n\t\t\tif(commaPos !== -1) {\n\t\t\t\ttiddlerFields.text = text.substr(commaPos+1);\n\t\t\t\tcallback([tiddlerFields]);\n\t\t\t}\n\t\t} else {\n\t\t\t// Check whether this is an encrypted TiddlyWiki file\n\t\t\tvar encryptedJson = $tw.utils.extractEncryptedStoreArea(text);\n\t\t\tif(encryptedJson) {\n\t\t\t\t// If so, attempt to decrypt it with the current password\n\t\t\t\t$tw.utils.decryptStoreAreaInteractive(encryptedJson,function(tiddlers) {\n\t\t\t\t\tcallback(tiddlers);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Otherwise, just try to deserialise any tiddlers in the file\n\t\t\t\tcallback(self.deserializeTiddlers(type,text,tiddlerFields));\n\t\t\t}\n\t\t}\n\t};\n\t// Kick off the read\n\tif(isBinary) {\n\t\treader.readAsDataURL(file);\n\t} else {\n\t\treader.readAsText(file);\n\t}\n};\n\n/*\nFind any existing draft of a specified tiddler\n*/\nexports.findDraft = function(targetTitle) {\n\tvar draftTitle = undefined;\n\tthis.forEachTiddler({includeSystem: true},function(title,tiddler) {\n\t\tif(tiddler.fields[\&quot;draft.title\&quot;] &amp;&amp; tiddler.fields[\&quot;draft.of\&quot;] === targetTitle) {\n\t\t\tdraftTitle = title;\n\t\t}\n\t});\n\treturn draftTitle;\n}\n\n/*\nCheck whether the specified draft tiddler has been modified\n*/\nexports.isDraftModified = function(title) {\n\tvar tiddler = this.getTiddler(title);\n\tif(!tiddler.isDraft()) {\n\t\treturn false;\n\t}\n\tvar ignoredFields = [\&quot;created\&quot;, \&quot;modified\&quot;, \&quot;title\&quot;, \&quot;draft.title\&quot;, \&quot;draft.of\&quot;],\n\t\torigTiddler = this.getTiddler(tiddler.fields[\&quot;draft.of\&quot;]);\n\tif(!origTiddler) {\n\t\treturn tiddler.fields.text !== \&quot;\&quot;;\n\t}\n\treturn tiddler.fields[\&quot;draft.title\&quot;] !== tiddler.fields[\&quot;draft.of\&quot;] || !tiddler.isEqual(origTiddler,ignoredFields);\n};\n\n/*\nAdd a new record to the top of the history stack\ntitle: a title string or an array of title strings\nfromPageRect: page coordinates of the origin of the navigation\nhistoryTitle: title of history tiddler (defaults to $:/HistoryList)\n*/\nexports.addToHistory = function(title,fromPageRect,historyTitle) {\n\thistoryTitle = historyTitle || \&quot;$:/HistoryList\&quot;;\n\tvar titles = $tw.utils.isArray(title) ? title : [title];\n\t// Add a new record to the top of the history stack\n\tvar historyList = this.getTiddlerData(historyTitle,[]);\n\t$tw.utils.each(titles,function(title) {\n\t\thistoryList.push({title: title, fromPageRect: fromPageRect});\n\t});\n\tthis.setTiddlerData(historyTitle,historyList,{\&quot;current-tiddler\&quot;: titles[titles.length-1]});\n};\n\n/*\nInvoke the available upgrader modules\ntitles: array of tiddler titles to be processed\ntiddlers: hashmap by title of tiddler fields of pending import tiddlers. These can be modified by the upgraders. An entry with no fields indicates a tiddler that was pending import has been suppressed. When entries are added to the pending import the tiddlers hashmap may have entries that are not present in the titles array\nReturns a hashmap of messages keyed by tiddler title.\n*/\nexports.invokeUpgraders = function(titles,tiddlers) {\n\t// Collect up the available upgrader modules\n\tvar self = this;\n\tif(!this.upgraderModules) {\n\t\tthis.upgraderModules = [];\n\t\t$tw.modules.forEachModuleOfType(\&quot;upgrader\&quot;,function(title,module) {\n\t\t\tif(module.upgrade) {\n\t\t\t\tself.upgraderModules.push(module);\n\t\t\t}\n\t\t});\n\t}\n\t// Invoke each upgrader in turn\n\tvar messages = {};\n\tfor(var t=0; t&lt;this.upgraderModules.length; t++) {\n\t\tvar upgrader = this.upgraderModules[t],\n\t\t\tupgraderMessages = upgrader.upgrade(this,titles,tiddlers);\n\t\t$tw.utils.extend(messages,upgraderMessages);\n\t}\n\treturn messages;\n};\n\n})();\n&quot;,
            &quot;title&quot;: &quot;$:/core/modules/wiki.js&quot;,
            &quot;type&quot;: &quot;application/javascript&quot;,
            &quot;module-type&quot;: &quot;wikimethod&quot;
        },
        &quot;$:/palettes/Blanca&quot;: {
            &quot;title&quot;: &quot;$:/palettes/Blanca&quot;,
            &quot;name&quot;: &quot;Blanca&quot;,
            &quot;description&quot;: &quot;A clean white palette to let you focus&quot;,
            &quot;tags&quot;: &quot;$:/tags/Palette&quot;,
            &quot;type&quot;: &quot;application/x-tiddler-dictionary&quot;,
            &quot;text&quot;: &quot;alert-background: #ffe476\nalert-border: #b99e2f\nalert-highlight: #881122\nalert-muted-foreground: #b99e2f\nbackground: #ffffff\nblockquote-bar: &lt;&lt;colour muted-foreground&gt;&gt;\ncode-background: #f7f7f9\ncode-border: #e1e1e8\ncode-foreground: #dd1144\ndirty-indicator: #ff0000\ndownload-background: #66cccc\ndownload-foreground: &lt;&lt;colour background&gt;&gt;\ndragger-background: &lt;&lt;colour foreground&gt;&gt;\ndragger-foreground: &lt;&lt;colour background&gt;&gt;\ndropdown-background: &lt;&lt;colour background&gt;&gt;\ndropdown-border: &lt;&lt;colour muted-foreground&gt;&gt;\ndropdown-tab-background-selected: #fff\ndropdown-tab-background: #ececec\ndropzone-background: rgba(0,200,0,0.7)\nexternal-link-background-hover: inherit\nexternal-link-background-visited: inherit\nexternal-link-background: inherit\nexternal-link-foreground-hover: inherit\nexternal-link-foreground-visited: #0000aa\nexternal-link-foreground: #0000ee\nforeground: #333333\nmessage-background: #ecf2ff\nmessage-border: #cfd6e6\nmessage-foreground: #547599\nmodal-backdrop: &lt;&lt;colour foreground&gt;&gt;\nmodal-background: &lt;&lt;colour background&gt;&gt;\nmodal-border: #999999\nmodal-footer-background: #f5f5f5\nmodal-footer-border: #dddddd\nmodal-header-border: #eeeeee\nmuted-foreground: #999999\nnotification-background: #ffffdd\nnotification-border: #999999\npage-background: #ffffff\npre-background: #f5f5f5\npre-border: #cccccc\nprimary: #7897f3\nsidebar-button-foreground: &lt;&lt;colour foreground&gt;&gt;\nsidebar-controls-foreground-hover: #000000\nsidebar-controls-foreground: #ccc\nsidebar-foreground-shadow: rgba(255,255,255, 0.8)\nsidebar-foreground: #acacac\nsidebar-muted-foreground-hover: #444444\nsidebar-muted-foreground: #c0c0c0\nsidebar-tab-background-selected: #ffffff\nsidebar-tab-background: &lt;&lt;colour tab-background&gt;&gt;\nsidebar-tab-border-selected: &lt;&lt;colour tab-border-selected&gt;&gt;\nsidebar-tab-border: &lt;&lt;colour tab-border&gt;&gt;\nsidebar-tab-divider: &lt;&lt;colour tab-divider&gt;&gt;\nsidebar-tab-foreground-selected: \nsidebar-tab-foreground: &lt;&lt;colour tab-foreground&gt;&gt;\nsidebar-tiddler-link-foreground-hover: #444444\nsidebar-tiddler-link-foreground: #7897f3\nstatic-alert-foreground: #aaaaaa\ntab-background-selected: #fffffffff\ntab-background: #eeeeee\ntab-border-selected: #cccccc\ntab-border: #cccccc\ntab-divider: #d8d8d8\ntab-foreground-selected: &lt;&lt;colour tab-foreground&gt;&gt;\ntab-foreground: #666666\ntable-border: #dddddd\ntable-footer-background: #a8a8a8\ntable-header-background: #f0f0f0\ntag-background: #ffeedd\ntag-foreground: #000\ntiddler-background: &lt;&lt;colour background&gt;&gt;\ntiddler-border: #eee\ntiddler-controls-foreground-hover: #888888\ntiddler-controls-foreground-selected: #444444\ntiddler-controls-foreground: #cccccc\ntiddler-editor-background: #f8f8f8\ntiddler-editor-border-image: #ffffff\ntiddler-editor-border: #cccccc\ntiddler-editor-fields-even: #e0e8e0\ntiddler-editor-fields-odd: #f0f4f0\ntiddler-info-background: #f8f8f8\ntiddler-info-border: #dddddd\ntiddler-info-tab-background: #f8f8f8\ntiddler-link-background: &lt;&lt;colour background&gt;&gt;\ntiddler-link-foreground: &lt;&lt;colour primary&gt;&gt;\ntiddler-subtitle-foreground: #c0c0c0\ntiddler-title-foreground: #ff9900\ntoolbar-new-button:\ntoolbar-options-button:\ntoolbar-save-button:\ntoolbar-info-button:\ntoolbar-edit-button:\ntoolbar-close-button:\ntoolbar-delete-button:\ntoolbar-cancel-button:\ntoolbar-done-button:\nuntagged-background: #999999\nvery-muted-foreground: #888888\n&quot;
        },
        &quot;$:/palettes/Blue&quot;: {
            &quot;title&quot;: &quot;$:/palettes/Blue&quot;,
            &quot;name&quot;: &quot;Blue&quot;,
            &quot;description&quot;: &quot;A blue theme&quot;,
            &quot;tags&quot;: &quot;$:/tags/Palette&quot;,
            &quot;type&quot;: &quot;application/x-tiddler-dictionary&quot;,
            &quot;text&quot;: &quot;alert-background: #ffe476\nalert-border: #b99e2f\nalert-highlight: #881122\nalert-muted-foreground: #b99e2f\nbackground: #fff\nblockquote-bar: &lt;&lt;colour muted-foreground&gt;&gt;\ncode-background: #f7f7f9\ncode-border: #e1e1e8\ncode-foreground: #dd1144\ndirty-indicator: #ff0000\ndownload-background: #34c734\ndownload-foreground: &lt;&lt;colour foreground&gt;&gt;\ndragger-background: &lt;&lt;colour foreground&gt;&gt;\ndragger-foreground: &lt;&lt;colour background&gt;&gt;\ndropdown-background: &lt;&lt;colour background&gt;&gt;\ndropdown-border: &lt;&lt;colour muted-foreground&gt;&gt;\ndropdown-tab-background-selected: #fff\ndropdown-tab-background: #ececec\ndropzone-background: rgba(0,200,0,0.7)\nexternal-link-background-hover: inherit\nexternal-link-background-visited: inherit\nexternal-link-background: inherit\nexternal-link-foreground-hover: inherit\nexternal-link-foreground-visited: #0000aa\nexternal-link-foreground: #0000ee\nforeground: #333353\nmessage-background: #ecf2ff\nmessage-border: #cfd6e6\nmessage-foreground: #547599\nmodal-backdrop: &lt;&lt;colour foreground&gt;&gt;\nmodal-background: &lt;&lt;colour background&gt;&gt;\nmodal-border: #999999\nmodal-footer-background: #f5f5f5\nmodal-footer-border: #dddddd\nmodal-header-border: #eeeeee\nmuted-foreground: #999999\nnotification-background: #ffffdd\nnotification-border: #999999\npage-background: #ddddff\npre-background: #f5f5f5\npre-border: #cccccc\nprimary: #5778d8\nsidebar-button-foreground: &lt;&lt;colour foreground&gt;&gt;\nsidebar-controls-foreground-hover: #000000\nsidebar-controls-foreground: #ffffff\nsidebar-foreground-shadow: rgba(255,255,255, 0.8)\nsidebar-foreground: #acacac\nsidebar-muted-foreground-hover: #444444\nsidebar-muted-foreground: #c0c0c0\nsidebar-tab-background-selected: &lt;&lt;colour page-background&gt;&gt;\nsidebar-tab-background: &lt;&lt;colour tab-background&gt;&gt;\nsidebar-tab-border-selected: &lt;&lt;colour tab-border-selected&gt;&gt;\nsidebar-tab-border: &lt;&lt;colour tab-border&gt;&gt;\nsidebar-tab-divider: &lt;&lt;colour tab-divider&gt;&gt;\nsidebar-tab-foreground-selected: \nsidebar-tab-foreground: &lt;&lt;colour tab-foreground&gt;&gt;\nsidebar-tiddler-link-foreground-hover: #444444\nsidebar-tiddler-link-foreground: #5959c0\nstatic-alert-foreground: #aaaaaa\ntab-background-selected: &lt;&lt;colour background&gt;&gt;\ntab-background: #ccccdd\ntab-border-selected: #ccccdd\ntab-border: #cccccc\ntab-divider: #d8d8d8\ntab-foreground-selected: &lt;&lt;colour tab-foreground&gt;&gt;\ntab-foreground: #666666\ntable-border: #dddddd\ntable-footer-background: #a8a8a8\ntable-header-background: #f0f0f0\ntag-background: #eeeeff\ntag-foreground: #000\ntiddler-background: &lt;&lt;colour background&gt;&gt;\ntiddler-border: &lt;&lt;colour background&gt;&gt;\ntiddler-controls-foreground-hover: #666666\ntiddler-controls-foreground-selected: #444444\ntiddler-controls-foreground: #cccccc\ntiddler-editor-background: #f8f8f8\ntiddler-editor-border-image: #ffffff\ntiddler-editor-border: #cccccc\ntiddler-editor-fields-even: #e0e8e0\ntiddler-editor-fields-odd: #f0f4f0\ntiddler-info-background: #ffffff\ntiddler-info-border: #dddddd\ntiddler-info-tab-background: #ffffff\ntiddler-link-background: &lt;&lt;colour background&gt;&gt;\ntiddler-link-foreground: &lt;&lt;colour primary&gt;&gt;\ntiddler-subtitle-foreground: #c0c0c0\ntiddler-title-foreground: #5959c0\ntoolbar-new-button: #5eb95e\ntoolbar-options-button: rgb(128, 88, 165)\ntoolbar-save-button: #0e90d2\ntoolbar-info-button: #0e90d2\ntoolbar-edit-button: rgb(243, 123, 29)\ntoolbar-close-button: #dd514c\ntoolbar-delete-button: #dd514c\ntoolbar-cancel-button: rgb(243, 123, 29)\ntoolbar-done-button: #5eb95e\nuntagged-background: #999999\nvery-muted-foreground: #888888\n&quot;
        },
        &quot;$:/palettes/Muted&quot;: {
            &quot;title&quot;: &quot;$:/palettes/Muted&quot;,
            &quot;name&quot;: &quot;Muted&quot;,
            &quot;description&quot;: &quot;Bright tiddlers on a muted background&quot;,
            &quot;tags&quot;: &quot;$:/tags/Palette&quot;,
            &quot;type&quot;: &quot;application/x-tiddler-dictionary&quot;,
            &quot;text&quot;: &quot;alert-background: #ffe476\nalert-border: #b99e2f\nalert-highlight: #881122\nalert-muted-foreground: #b99e2f\nbackground: #ffffff\nblockquote-bar: &lt;&lt;colour muted-foreground&gt;&gt;\ncode-background: #f7f7f9\ncode-border: #e1e1e8\ncode-foreground: #dd1144\ndirty-indicator: #ff0000\ndownload-background: #34c734\ndownload-foreground: &lt;&lt;colour background&gt;&gt;\ndragger-background: &lt;&lt;colour foreground&gt;&gt;\ndragger-foreground: &lt;&lt;colour background&gt;&gt;\ndropdown-background: &lt;&lt;colour background&gt;&gt;\ndropdown-border: &lt;&lt;colour muted-foreground&gt;&gt;\ndropdown-tab-background-selected: #fff\ndropdown-tab-background: #ececec\ndropzone-background: rgba(0,200,0,0.7)\nexternal-link-background-hover: inherit\nexternal-link-background-visited: inherit\nexternal-link-background: inherit\nexternal-link-foreground-hover: inherit\nexternal-link-foreground-visited: #0000aa\nexternal-link-foreground: #0000ee\nforeground: #333333\nmessage-background: #ecf2ff\nmessage-border: #cfd6e6\nmessage-foreground: #547599\nmodal-backdrop: &lt;&lt;colour foreground&gt;&gt;\nmodal-background: &lt;&lt;colour background&gt;&gt;\nmodal-border: #999999\nmodal-footer-background: #f5f5f5\nmodal-footer-border: #dddddd\nmodal-header-border: #eeeeee\nmuted-foreground: #bbb\nnotification-background: #ffffdd\nnotification-border: #999999\npage-background: #6f6f70\npre-background: #f5f5f5\npre-border: #cccccc\nprimary: #29a6ee\nsidebar-button-foreground: &lt;&lt;colour foreground&gt;&gt;\nsidebar-controls-foreground-hover: #000000\nsidebar-controls-foreground: #c2c1c2\nsidebar-foreground-shadow: rgba(255,255,255,0)\nsidebar-foreground: #d3d2d4\nsidebar-muted-foreground-hover: #444444\nsidebar-muted-foreground: #c0c0c0\nsidebar-tab-background-selected: #6f6f70\nsidebar-tab-background: #666667\nsidebar-tab-border-selected: #999\nsidebar-tab-border: #515151\nsidebar-tab-divider: #999\nsidebar-tab-foreground-selected: \nsidebar-tab-foreground: #999\nsidebar-tiddler-link-foreground-hover: #444444\nsidebar-tiddler-link-foreground: #d1d0d2\nstatic-alert-foreground: #aaaaaa\ntab-background-selected: #ffffff\ntab-background: #d8d8d8\ntab-border-selected: #d8d8d8\ntab-border: #cccccc\ntab-divider: #d8d8d8\ntab-foreground-selected: &lt;&lt;colour tab-foreground&gt;&gt;\ntab-foreground: #666666\ntable-border: #dddddd\ntable-footer-background: #a8a8a8\ntable-header-background: #f0f0f0\ntag-background: #d5ad34\ntag-foreground: #ffffff\ntiddler-background: &lt;&lt;colour background&gt;&gt;\ntiddler-border: &lt;&lt;colour background&gt;&gt;\ntiddler-controls-foreground-hover: #888888\ntiddler-controls-foreground-selected: #444444\ntiddler-controls-foreground: #cccccc\ntiddler-editor-background: #f8f8f8\ntiddler-editor-border-image: #ffffff\ntiddler-editor-border: #cccccc\ntiddler-editor-fields-even: #e0e8e0\ntiddler-editor-fields-odd: #f0f4f0\ntiddler-info-background: #f8f8f8\ntiddler-info-border: #dddddd\ntiddler-info-tab-background: #f8f8f8\ntiddler-link-background: &lt;&lt;colour background&gt;&gt;\ntiddler-link-foreground: &lt;&lt;colour primary&gt;&gt;\ntiddler-subtitle-foreground: #c0c0c0\ntiddler-title-foreground: #182955\ntoolbar-new-button: \ntoolbar-options-button: \ntoolbar-save-button: \ntoolbar-info-button: \ntoolbar-edit-button: \ntoolbar-close-button: \ntoolbar-delete-button: \ntoolbar-cancel-button: \ntoolbar-done-button: \nuntagged-background: #999999\nvery-muted-foreground: #888888\n&quot;
        },
        &quot;$:/palettes/Contrast&quot;: {
            &quot;title&quot;: &quot;$:/palettes/Contrast&quot;,
            &quot;name&quot;: &quot;Contrast&quot;,
            &quot;description&quot;: &quot;High contrast and unambiguous&quot;,
            &quot;tags&quot;: &quot;$:/tags/Palette&quot;,
            &quot;type&quot;: &quot;application/x-tiddler-dictionary&quot;,
            &quot;text&quot;: &quot;alert-background: #ffe476\nalert-border: #b99e2f\nalert-highlight: #881122\nalert-muted-foreground: #b99e2f\nbackground: #ffffff\nblockquote-bar: &lt;&lt;colour muted-foreground&gt;&gt;\ncode-background: #f7f7f9\ncode-border: #e1e1e8\ncode-foreground: #dd1144\ndirty-indicator: #ff0000\ndownload-background: #34c734\ndownload-foreground: &lt;&lt;colour background&gt;&gt;\ndragger-background: &lt;&lt;colour foreground&gt;&gt;\ndragger-foreground: &lt;&lt;colour background&gt;&gt;\ndropdown-background: &lt;&lt;colour background&gt;&gt;\ndropdown-border: &lt;&lt;colour muted-foreground&gt;&gt;\ndropdown-tab-background-selected: #fff\ndropdown-tab-background: #ececec\ndropzone-background: rgba(0,200,0,0.7)\nexternal-link-background-hover: inherit\nexternal-link-background-visited: inherit\nexternal-link-background: inherit\nexternal-link-foreground-hover: inherit\nexternal-link-foreground-visited: #0000aa\nexternal-link-foreground: #0000ee\nforeground: #333333\nmessage-background: #ecf2ff\nmessage-border: #cfd6e6\nmessage-foreground: #547599\nmodal-backdrop: &lt;&lt;colour foreground&gt;&gt;\nmodal-background: &lt;&lt;colour background&gt;&gt;\nmodal-border: #999999\nmodal-footer-background: #f5f5f5\nmodal-footer-border: #dddddd\nmodal-header-border: #eeeeee\nmuted-foreground: #999999\nnotification-background: #ffffdd\nnotification-border: #999999\npage-background: #000000\npre-background: #f5f5f5\npre-border: #cccccc\nprimary: #5778d8\nsidebar-button-foreground: &lt;&lt;colour foreground&gt;&gt;\nsidebar-controls-foreground-hover: #000000\nsidebar-controls-foreground: #ffffff\nsidebar-foreground-shadow: rgba(255,0,0, 0.5)\nsidebar-foreground: #ffffff\nsidebar-muted-foreground-hover: #444444\nsidebar-muted-foreground: #c0c0c0\nsidebar-tab-background-selected: #ececec\nsidebar-tab-background: &lt;&lt;colour tab-background&gt;&gt;\nsidebar-tab-border-selected: &lt;&lt;colour tab-border-selected&gt;&gt;\nsidebar-tab-border: &lt;&lt;colour tab-border&gt;&gt;\nsidebar-tab-divider: &lt;&lt;colour tab-divider&gt;&gt;\nsidebar-tab-foreground-selected: \nsidebar-tab-foreground: &lt;&lt;colour tab-foreground&gt;&gt;\nsidebar-tiddler-link-foreground-hover: #444444\nsidebar-tiddler-link-foreground: #999999\nstatic-alert-foreground: #aaaaaa\ntab-background-selected: #ffffff\ntab-background: #d8d8d8\ntab-border-selected: #d8d8d8\ntab-border: #cccccc\ntab-divider: #d8d8d8\ntab-foreground-selected: &lt;&lt;colour tab-foreground&gt;&gt;\ntab-foreground: #666666\ntable-border: #dddddd\ntable-footer-background: #a8a8a8\ntable-header-background: #f0f0f0\ntag-background: #d5ad34\ntag-foreground: #ffffff\ntiddler-background: &lt;&lt;colour background&gt;&gt;\ntiddler-border: &lt;&lt;colour background&gt;&gt;\ntiddler-controls-foreground-hover: #888888\ntiddler-controls-foreground-selected: #444444\ntiddler-controls-foreground: #cccccc\ntiddler-editor-background: #f8f8f8\ntiddler-editor-border-image: #ffffff\ntiddler-editor-border: #cccccc\ntiddler-editor-fields-even: #e0e8e0\ntiddler-editor-fields-odd: #f0f4f0\ntiddler-info-background: #f8f8f8\ntiddler-info-border: #dddddd\ntiddler-info-tab-background: #f8f8f8\ntiddler-link-background: &lt;&lt;colour background&gt;&gt;\ntiddler-link-foreground: &lt;&lt;colour primary&gt;&gt;\ntiddler-subtitle-foreground: #c0c0c0\ntiddler-title-foreground: #182955\ntoolbar-new-button:\ntoolbar-options-button:\ntoolbar-save-button:\ntoolbar-info-button:\ntoolbar-edit-button:\ntoolbar-close-button:\ntoolbar-delete-button:\ntoolbar-cancel-button:\ntoolbar-done-button:\nuntagged-background: #999999\nvery-muted-foreground: #888888\n&quot;
        },
        &quot;$:/palettes/Rocker&quot;: {
            &quot;title&quot;: &quot;$:/palettes/Rocker&quot;,
            &quot;name&quot;: &quot;Rocker&quot;,
            &quot;description&quot;: &quot;A dark theme&quot;,
            &quot;tags&quot;: &quot;$:/tags/Palette&quot;,
            &quot;type&quot;: &quot;application/x-tiddler-dictionary&quot;,
            &quot;text&quot;: &quot;alert-background: #ffe476\nalert-border: #b99e2f\nalert-highlight: #881122\nalert-muted-foreground: #b99e2f\nbackground: #ffffff\nblockquote-bar: &lt;&lt;colour muted-foreground&gt;&gt;\ncode-background: #f7f7f9\ncode-border: #e1e1e8\ncode-foreground: #dd1144\ndirty-indicator: #ff0000\ndownload-background: #34c734\ndownload-foreground: &lt;&lt;colour background&gt;&gt;\ndragger-background: &lt;&lt;colour foreground&gt;&gt;\ndragger-foreground: &lt;&lt;colour background&gt;&gt;\ndropdown-background: &lt;&lt;colour background&gt;&gt;\ndropdown-border: &lt;&lt;colour muted-foreground&gt;&gt;\ndropdown-tab-background-selected: #fff\ndropdown-tab-background: #ececec\ndropzone-background: rgba(0,200,0,0.7)\nexternal-link-background-hover: inherit\nexternal-link-background-visited: inherit\nexternal-link-background: inherit\nexternal-link-foreground-hover: inherit\nexternal-link-foreground-visited: #0000aa\nexternal-link-foreground: #0000ee\nforeground: #333333\nmessage-background: #ecf2ff\nmessage-border: #cfd6e6\nmessage-foreground: #547599\nmodal-backdrop: &lt;&lt;colour foreground&gt;&gt;\nmodal-background: &lt;&lt;colour background&gt;&gt;\nmodal-border: #999999\nmodal-footer-background: #f5f5f5\nmodal-footer-border: #dddddd\nmodal-header-border: #eeeeee\nmuted-foreground: #999999\nnotification-background: #ffffdd\nnotification-border: #999999\npage-background: #000\npre-background: #f5f5f5\npre-border: #cccccc\nprimary: #cc0000\nsidebar-button-foreground: &lt;&lt;colour foreground&gt;&gt;\nsidebar-controls-foreground-hover: #000000\nsidebar-controls-foreground: #ffffff\nsidebar-foreground-shadow: rgba(255,255,255, 0.0)\nsidebar-foreground: #acacac\nsidebar-muted-foreground-hover: #444444\nsidebar-muted-foreground: #c0c0c0\nsidebar-tab-background-selected: #000\nsidebar-tab-background: &lt;&lt;colour tab-background&gt;&gt;\nsidebar-tab-border-selected: &lt;&lt;colour tab-border-selected&gt;&gt;\nsidebar-tab-border: &lt;&lt;colour tab-border&gt;&gt;\nsidebar-tab-divider: &lt;&lt;colour tab-divider&gt;&gt;\nsidebar-tab-foreground-selected: \nsidebar-tab-foreground: &lt;&lt;colour tab-foreground&gt;&gt;\nsidebar-tiddler-link-foreground-hover: #ffbb99\nsidebar-tiddler-link-foreground: #cc0000\nstatic-alert-foreground: #aaaaaa\ntab-background-selected: #ffffff\ntab-background: #d8d8d8\ntab-border-selected: #d8d8d8\ntab-border: #cccccc\ntab-divider: #d8d8d8\ntab-foreground-selected: &lt;&lt;colour tab-foreground&gt;&gt;\ntab-foreground: #666666\ntable-border: #dddddd\ntable-footer-background: #a8a8a8\ntable-header-background: #f0f0f0\ntag-background: #ffbb99\ntag-foreground: #000\ntiddler-background: &lt;&lt;colour background&gt;&gt;\ntiddler-border: &lt;&lt;colour background&gt;&gt;\ntiddler-controls-foreground-hover: #888888\ntiddler-controls-foreground-selected: #444444\ntiddler-controls-foreground: #cccccc\ntiddler-editor-background: #f8f8f8\ntiddler-editor-border-image: #ffffff\ntiddler-editor-border: #cccccc\ntiddler-editor-fields-even: #e0e8e0\ntiddler-editor-fields-odd: #f0f4f0\ntiddler-info-background: #f8f8f8\ntiddler-info-border: #dddddd\ntiddler-info-tab-background: #f8f8f8\ntiddler-link-background: &lt;&lt;colour background&gt;&gt;\ntiddler-link-foreground: &lt;&lt;colour primary&gt;&gt;\ntiddler-subtitle-foreground: #c0c0c0\ntiddler-title-foreground: #cc0000\ntoolbar-new-button:\ntoolbar-options-button:\ntoolbar-save-button:\ntoolbar-info-button:\ntoolbar-edit-button:\ntoolbar-close-button:\ntoolbar-delete-button:\ntoolbar-cancel-button:\ntoolbar-done-button:\nuntagged-background: #999999\nvery-muted-foreground: #888888\n&quot;
        },
        &quot;$:/palettes/Vanilla&quot;: {
            &quot;title&quot;: &quot;$:/palettes/Vanilla&quot;,
            &quot;name&quot;: &quot;Vanilla&quot;,
            &quot;description&quot;: &quot;Pale and unobtrusive&quot;,
            &quot;tags&quot;: &quot;$:/tags/Palette&quot;,
            &quot;type&quot;: &quot;application/x-tiddler-dictionary&quot;,
            &quot;text&quot;: &quot;alert-background: #ffe476\nalert-border: #b99e2f\nalert-highlight: #881122\nalert-muted-foreground: #b99e2f\nbackground: #ffffff\nblockquote-bar: &lt;&lt;colour muted-foreground&gt;&gt;\ncode-background: #f7f7f9\ncode-border: #e1e1e8\ncode-foreground: #dd1144\ndirty-indicator: #ff0000\ndownload-background: #34c734\ndownload-foreground: &lt;&lt;colour background&gt;&gt;\ndragger-background: &lt;&lt;colour foreground&gt;&gt;\ndragger-foreground: &lt;&lt;colour background&gt;&gt;\ndropdown-background: &lt;&lt;colour background&gt;&gt;\ndropdown-border: &lt;&lt;colour muted-foreground&gt;&gt;\ndropdown-tab-background-selected: #fff\ndropdown-tab-background: #ececec\ndropzone-background: rgba(0,200,0,0.7)\nexternal-link-background-hover: inherit\nexternal-link-background-visited: inherit\nexternal-link-background: inherit\nexternal-link-foreground-hover: inherit\nexternal-link-foreground-visited: #0000aa\nexternal-link-foreground: #0000ee\nforeground: #333333\nmessage-background: #ecf2ff\nmessage-border: #cfd6e6\nmessage-foreground: #547599\nmodal-backdrop: &lt;&lt;colour foreground&gt;&gt;\nmodal-background: &lt;&lt;colour background&gt;&gt;\nmodal-border: #999999\nmodal-footer-background: #f5f5f5\nmodal-footer-border: #dddddd\nmodal-header-border: #eeeeee\nmuted-foreground: #bbb\nnotification-background: #ffffdd\nnotification-border: #999999\npage-background: #ececec\npre-background: #f5f5f5\npre-border: #cccccc\nprimary: #5778d8\nsidebar-button-foreground: &lt;&lt;colour foreground&gt;&gt;\nsidebar-controls-foreground-hover: #000000\nsidebar-controls-foreground: #aaaaaa\nsidebar-foreground-shadow: rgba(255,255,255, 0.8)\nsidebar-foreground: #acacac\nsidebar-muted-foreground-hover: #444444\nsidebar-muted-foreground: #c0c0c0\nsidebar-tab-background-selected: #ececec\nsidebar-tab-background: &lt;&lt;colour tab-background&gt;&gt;\nsidebar-tab-border-selected: &lt;&lt;colour tab-border-selected&gt;&gt;\nsidebar-tab-border: &lt;&lt;colour tab-border&gt;&gt;\nsidebar-tab-divider: #e4e4e4\nsidebar-tab-foreground-selected: \nsidebar-tab-foreground: &lt;&lt;colour tab-foreground&gt;&gt;\nsidebar-tiddler-link-foreground-hover: #444444\nsidebar-tiddler-link-foreground: #999999\nstatic-alert-foreground: #aaaaaa\ntab-background-selected: #ffffff\ntab-background: #d8d8d8\ntab-border-selected: #d8d8d8\ntab-border: #cccccc\ntab-divider: #d8d8d8\ntab-foreground-selected: &lt;&lt;colour tab-foreground&gt;&gt;\ntab-foreground: #666666\ntable-border: #dddddd\ntable-footer-background: #a8a8a8\ntable-header-background: #f0f0f0\ntag-background: #ec6\ntag-foreground: #ffffff\ntiddler-background: &lt;&lt;colour background&gt;&gt;\ntiddler-border: &lt;&lt;colour background&gt;&gt;\ntiddler-controls-foreground-hover: #888888\ntiddler-controls-foreground-selected: #444444\ntiddler-controls-foreground: #cccccc\ntiddler-editor-background: #f8f8f8\ntiddler-editor-border-image: #ffffff\ntiddler-editor-border: #cccccc\ntiddler-editor-fields-even: #e0e8e0\ntiddler-editor-fields-odd: #f0f4f0\ntiddler-info-background: #f8f8f8\ntiddler-info-border: #dddddd\ntiddler-info-tab-background: #f8f8f8\ntiddler-link-background: &lt;&lt;colour background&gt;&gt;\ntiddler-link-foreground: &lt;&lt;colour primary&gt;&gt;\ntiddler-subtitle-foreground: #c0c0c0\ntiddler-title-foreground: #182955\ntoolbar-new-button:\ntoolbar-options-button:\ntoolbar-save-button:\ntoolbar-info-button:\ntoolbar-edit-button:\ntoolbar-close-button:\ntoolbar-delete-button:\ntoolbar-cancel-button:\ntoolbar-done-button:\nuntagged-background: #999999\nvery-muted-foreground: #888888\n&quot;
        },
        &quot;$:/core/readme&quot;: {
            &quot;title&quot;: &quot;$:/core/readme&quot;,
            &quot;text&quot;: &quot;This plugin contains TiddlyWiki's core components, comprising:\n\n* JavaScript code modules\n* Icons\n* Templates needed to create TiddlyWiki's user interface\n* British English (''en-GB'') translations of the localisable strings used by the core\n&quot;
        },
        &quot;$:/core/templates/MOTW.html&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/MOTW.html&quot;,
            &quot;text&quot;: &quot;\\rules only filteredtranscludeinline transcludeinline entity\n&lt;!-- The following comment is called a MOTW comment and is necessary for the TiddlyIE Internet Explorer extension --&gt;\n&lt;!-- saved from url=(0021)http://tiddlywiki.com --&gt;&amp;#13;&amp;#10;&quot;
        },
        &quot;$:/core/templates/alltiddlers.template.html&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/alltiddlers.template.html&quot;,
            &quot;type&quot;: &quot;text/vnd.tiddlywiki-html&quot;,
            &quot;text&quot;: &quot;&lt;!-- This template is provided for backwards compatibility with older versions of TiddlyWiki --&gt;\n\n&lt;$set name=\&quot;exportFilter\&quot; value=\&quot;[!is[system]sort[title]]\&quot;&gt;\n\n{{$:/core/templates/exporters/StaticRiver}}\n\n&lt;/$set&gt;\n&quot;
        },
        &quot;$:/core/templates/canonical-uri-external-image&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/canonical-uri-external-image&quot;,
            &quot;text&quot;: &quot;&lt;!--\n\nThis template is used to assign the ''_canonical_uri'' field to external images.\n\nChange the `./images/` part to a different base URI. The URI can be relative or absolute.\n\n--&gt;\n./images/&lt;$view field=\&quot;title\&quot; format=\&quot;doubleurlencoded\&quot;/&gt;&quot;
        },
        &quot;$:/core/templates/css-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/css-tiddler&quot;,
            &quot;text&quot;: &quot;&lt;!--\n\nThis template is used for saving CSS tiddlers as a style tag with data attributes representing the tiddler fields.\n\n--&gt;`&lt;style`&lt;$fields template=' data-tiddler-$name$=\&quot;$encoded_value$\&quot;'&gt;&lt;/$fields&gt;` type=\&quot;text/css\&quot;&gt;`&lt;$view field=\&quot;text\&quot; format=\&quot;text\&quot; /&gt;`&lt;/style&gt;`&quot;
        },
        &quot;$:/core/templates/exporters/CsvFile&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/exporters/CsvFile&quot;,
            &quot;tags&quot;: &quot;$:/tags/Exporter&quot;,
            &quot;description&quot;: &quot;{{$:/language/Exporters/CsvFile}}&quot;,
            &quot;extension&quot;: &quot;.csv&quot;,
            &quot;text&quot;: &quot;\\define renderContent()\n&lt;$text text=&lt;&lt;csvtiddlers filter:\&quot;\&quot;\&quot;$(exportFilter)$\&quot;\&quot;\&quot; format:\&quot;quoted-comma-sep\&quot;&gt;&gt;/&gt;\n\\end\n&lt;&lt;renderContent&gt;&gt;\n&quot;
        },
        &quot;$:/core/templates/exporters/JsonFile&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/exporters/JsonFile&quot;,
            &quot;tags&quot;: &quot;$:/tags/Exporter&quot;,
            &quot;description&quot;: &quot;{{$:/language/Exporters/JsonFile}}&quot;,
            &quot;extension&quot;: &quot;.json&quot;,
            &quot;text&quot;: &quot;\\define renderContent()\n&lt;$text text=&lt;&lt;jsontiddlers filter:\&quot;\&quot;\&quot;$(exportFilter)$\&quot;\&quot;\&quot;&gt;&gt;/&gt;\n\\end\n&lt;&lt;renderContent&gt;&gt;\n&quot;
        },
        &quot;$:/core/templates/exporters/StaticRiver&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/exporters/StaticRiver&quot;,
            &quot;tags&quot;: &quot;$:/tags/Exporter&quot;,
            &quot;description&quot;: &quot;{{$:/language/Exporters/StaticRiver}}&quot;,
            &quot;extension&quot;: &quot;.html&quot;,
            &quot;text&quot;: &quot;\\define tv-wikilink-template() #$uri_encoded$\n\\define tv-config-toolbar-icons() no\n\\define tv-config-toolbar-text() no\n\\define tv-config-toolbar-class() tc-btn-invisible\n\\rules only filteredtranscludeinline transcludeinline\n&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html;charset=utf-8\&quot; /&gt;\n&lt;meta name=\&quot;generator\&quot; content=\&quot;TiddlyWiki\&quot; /&gt;\n&lt;meta name=\&quot;tiddlywiki-version\&quot; content=\&quot;{{$:/core/templates/version}}\&quot; /&gt;\n&lt;meta name=\&quot;format-detection\&quot; content=\&quot;telephone=no\&quot;&gt;\n&lt;link id=\&quot;faviconLink\&quot; rel=\&quot;shortcut icon\&quot; href=\&quot;favicon.ico\&quot;&gt;\n&lt;title&gt;{{$:/core/wiki/title}}&lt;/title&gt;\n&lt;div id=\&quot;styleArea\&quot;&gt;\n{{$:/boot/boot.css||$:/core/templates/css-tiddler}}\n&lt;/div&gt;\n&lt;style type=\&quot;text/css\&quot;&gt;\n{{$:/core/ui/PageStylesheet||$:/core/templates/wikified-tiddler}}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body class=\&quot;tc-body\&quot;&gt;\n{{$:/StaticBanner||$:/core/templates/html-tiddler}}\n&lt;section class=\&quot;tc-story-river\&quot;&gt;\n{{$:/core/templates/exporters/StaticRiver/Content||$:/core/templates/html-tiddler}}\n&lt;/section&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;
        },
        &quot;$:/core/templates/exporters/StaticRiver/Content&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/exporters/StaticRiver/Content&quot;,
            &quot;text&quot;: &quot;\\define renderContent()\n{{{ $(exportFilter)$ ||$:/core/templates/static-tiddler}}}\n\\end\n&lt;$importvariables filter=\&quot;[[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\&quot;&gt;\n&lt;&lt;renderContent&gt;&gt;\n&lt;/$importvariables&gt;\n&quot;
        },
        &quot;$:/core/templates/exporters/TidFile&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/exporters/TidFile&quot;,
            &quot;tags&quot;: &quot;$:/tags/Exporter&quot;,
            &quot;description&quot;: &quot;{{$:/language/Exporters/TidFile}}&quot;,
            &quot;extension&quot;: &quot;.tid&quot;,
            &quot;text&quot;: &quot;\\define renderContent()\n{{{ $(exportFilter)$ +[limit[1]] ||$:/core/templates/tid-tiddler}}}\n\\end\n&lt;$importvariables filter=\&quot;[[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\&quot;&gt;&lt;&lt;renderContent&gt;&gt;&lt;/$importvariables&gt;&quot;
        },
        &quot;$:/core/templates/html-div-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/html-div-tiddler&quot;,
            &quot;text&quot;: &quot;&lt;!--\n\nThis template is used for saving tiddlers as an HTML DIV tag with attributes representing the tiddler fields.\n\n--&gt;`&lt;div`&lt;$fields template=' $name$=\&quot;$encoded_value$\&quot;'&gt;&lt;/$fields&gt;`&gt;\n&lt;pre&gt;`&lt;$view field=\&quot;text\&quot; format=\&quot;htmlencoded\&quot; /&gt;`&lt;/pre&gt;\n&lt;/div&gt;`\n&quot;
        },
        &quot;$:/core/templates/html-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/html-tiddler&quot;,
            &quot;text&quot;: &quot;&lt;!--\n\nThis template is used for saving tiddlers as raw HTML\n\n--&gt;&lt;$view field=\&quot;text\&quot; format=\&quot;htmlwikified\&quot; /&gt;&quot;
        },
        &quot;$:/core/templates/javascript-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/javascript-tiddler&quot;,
            &quot;text&quot;: &quot;&lt;!--\n\nThis template is used for saving JavaScript tiddlers as a script tag with data attributes representing the tiddler fields.\n\n--&gt;`&lt;script`&lt;$fields template=' data-tiddler-$name$=\&quot;$encoded_value$\&quot;'&gt;&lt;/$fields&gt;` type=\&quot;text/javascript\&quot;&gt;`&lt;$view field=\&quot;text\&quot; format=\&quot;text\&quot; /&gt;`&lt;/script&gt;`&quot;
        },
        &quot;$:/core/templates/module-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/module-tiddler&quot;,
            &quot;text&quot;: &quot;&lt;!--\n\nThis template is used for saving JavaScript tiddlers as a script tag with data attributes representing the tiddler fields. The body of the tiddler is wrapped in a call to the `$tw.modules.define` function in order to define the body of the tiddler as a module\n\n--&gt;`&lt;script`&lt;$fields template=' data-tiddler-$name$=\&quot;$encoded_value$\&quot;'&gt;&lt;/$fields&gt;` type=\&quot;text/javascript\&quot; data-module=\&quot;yes\&quot;&gt;$tw.modules.define(\&quot;`&lt;$view field=\&quot;title\&quot; format=\&quot;jsencoded\&quot; /&gt;`\&quot;,\&quot;`&lt;$view field=\&quot;module-type\&quot; format=\&quot;jsencoded\&quot; /&gt;`\&quot;,function(module,exports,require) {`&lt;$view field=\&quot;text\&quot; format=\&quot;text\&quot; /&gt;`});\n&lt;/script&gt;`&quot;
        },
        &quot;$:/core/templates/plain-text-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/plain-text-tiddler&quot;,
            &quot;text&quot;: &quot;&lt;$view field=\&quot;text\&quot; format=\&quot;text\&quot; /&gt;&quot;
        },
        &quot;$:/core/save/all&quot;: {
            &quot;title&quot;: &quot;$:/core/save/all&quot;,
            &quot;text&quot;: &quot;\\define saveTiddlerFilter()\n[is[tiddler]] -[prefix[$:/state/popup/]] -[[$:/HistoryList]] -[[$:/boot/boot.css]] -[type[application/javascript]library[yes]] -[[$:/boot/boot.js]] -[[$:/boot/bootprefix.js]] +[sort[title]]\n\\end\n{{$:/core/templates/tiddlywiki5.html}}\n&quot;
        },
        &quot;$:/core/save/empty&quot;: {
            &quot;title&quot;: &quot;$:/core/save/empty&quot;,
            &quot;text&quot;: &quot;\\define saveTiddlerFilter()\n[is[system]] -[prefix[$:/state/popup/]] -[[$:/boot/boot.css]] -[type[application/javascript]library[yes]] -[[$:/boot/boot.js]] -[[$:/boot/bootprefix.js]] +[sort[title]]\n\\end\n{{$:/core/templates/tiddlywiki5.html}}\n&quot;
        },
        &quot;$:/core/save/lazy-images&quot;: {
            &quot;title&quot;: &quot;$:/core/save/lazy-images&quot;,
            &quot;text&quot;: &quot;\\define saveTiddlerFilter()\n[is[tiddler]] -[prefix[$:/state/popup/]] -[[$:/HistoryList]] -[[$:/boot/boot.css]] -[type[application/javascript]library[yes]] -[[$:/boot/boot.js]] -[[$:/boot/bootprefix.js]] -[!is[system]is[image]] +[sort[title]] \n\\end\n{{$:/core/templates/tiddlywiki5.html}}\n&quot;
        },
        &quot;$:/core/templates/split-recipe&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/split-recipe&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[!is[system]]\&quot;&gt;\ntiddler: &lt;$view field=\&quot;title\&quot; format=\&quot;urlencoded\&quot;/&gt;.tid\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/templates/static-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/static-tiddler&quot;,
            &quot;text&quot;: &quot;&lt;a name=&lt;&lt;currentTiddler&gt;&gt;&gt;\n&lt;$transclude tiddler=\&quot;$:/core/ui/ViewTemplate\&quot;/&gt;\n&lt;/a&gt;&quot;
        },
        &quot;$:/core/templates/static.area&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/static.area&quot;,
            &quot;text&quot;: &quot;&lt;$reveal type=\&quot;nomatch\&quot; state=\&quot;$:/isEncrypted\&quot; text=\&quot;yes\&quot;&gt;\n{{$:/core/templates/static.content||$:/core/templates/html-tiddler}}\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=\&quot;$:/isEncrypted\&quot; text=\&quot;yes\&quot;&gt;\nThis file contains an encrypted ~TiddlyWiki. Enable ~JavaScript and enter the decryption password when prompted.\n&lt;/$reveal&gt;\n&quot;
        },
        &quot;$:/core/templates/static.content&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/static.content&quot;,
            &quot;type&quot;: &quot;text/vnd.tiddlywiki&quot;,
            &quot;text&quot;: &quot;&lt;!-- For Google, and people without JavaScript--&gt;\nThis [[TiddlyWiki|http://tiddlywiki.com]] contains the following tiddlers:\n\n&lt;ul&gt;\n&lt;$list filter=&lt;&lt;saveTiddlerFilter&gt;&gt;&gt;\n&lt;li&gt;&lt;$view field=\&quot;title\&quot; format=\&quot;text\&quot;&gt;&lt;/$view&gt;&lt;/li&gt;\n&lt;/$list&gt;\n&lt;/ul&gt;\n&quot;
        },
        &quot;$:/core/templates/static.template.css&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/static.template.css&quot;,
            &quot;text&quot;: &quot;{{$:/boot/boot.css||$:/core/templates/plain-text-tiddler}}\n\n{{$:/core/ui/PageStylesheet||$:/core/templates/wikified-tiddler}}\n&quot;
        },
        &quot;$:/core/templates/static.template.html&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/static.template.html&quot;,
            &quot;type&quot;: &quot;text/vnd.tiddlywiki-html&quot;,
            &quot;text&quot;: &quot;\\define tv-wikilink-template() static/$uri_doubleencoded$.html\n\\define tv-config-toolbar-icons() no\n\\define tv-config-toolbar-text() no\n\\define tv-config-toolbar-class() tc-btn-invisible\n\\rules only filteredtranscludeinline transcludeinline\n&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html;charset=utf-8\&quot; /&gt;\n&lt;meta name=\&quot;generator\&quot; content=\&quot;TiddlyWiki\&quot; /&gt;\n&lt;meta name=\&quot;tiddlywiki-version\&quot; content=\&quot;{{$:/core/templates/version}}\&quot; /&gt;\n&lt;meta name=\&quot;format-detection\&quot; content=\&quot;telephone=no\&quot;&gt;\n&lt;link id=\&quot;faviconLink\&quot; rel=\&quot;shortcut icon\&quot; href=\&quot;favicon.ico\&quot;&gt;\n&lt;title&gt;{{$:/core/wiki/title}}&lt;/title&gt;\n&lt;div id=\&quot;styleArea\&quot;&gt;\n{{$:/boot/boot.css||$:/core/templates/css-tiddler}}\n&lt;/div&gt;\n&lt;style type=\&quot;text/css\&quot;&gt;\n{{$:/core/ui/PageStylesheet||$:/core/templates/wikified-tiddler}}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body class=\&quot;tc-body\&quot;&gt;\n{{$:/StaticBanner||$:/core/templates/html-tiddler}}\n{{$:/core/ui/PageTemplate||$:/core/templates/html-tiddler}}\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;
        },
        &quot;$:/core/templates/static.tiddler.html&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/static.tiddler.html&quot;,
            &quot;text&quot;: &quot;\\define tv-wikilink-template() $uri_doubleencoded$.html\n\\define tv-config-toolbar-icons() no\n\\define tv-config-toolbar-text() no\n\\define tv-config-toolbar-class() tc-btn-invisible\n`&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html;charset=utf-8\&quot; /&gt;\n&lt;meta name=\&quot;generator\&quot; content=\&quot;TiddlyWiki\&quot; /&gt;\n&lt;meta name=\&quot;tiddlywiki-version\&quot; content=\&quot;`{{$:/core/templates/version}}`\&quot; /&gt;\n&lt;meta name=\&quot;format-detection\&quot; content=\&quot;telephone=no\&quot;&gt;\n&lt;link id=\&quot;faviconLink\&quot; rel=\&quot;shortcut icon\&quot; href=\&quot;favicon.ico\&quot;&gt;\n&lt;link rel=\&quot;stylesheet\&quot; href=\&quot;static.css\&quot;&gt;\n&lt;title&gt;`{{$:/core/wiki/title}}`&lt;/title&gt;\n&lt;/head&gt;\n&lt;body class=\&quot;tc-body\&quot;&gt;\n`{{$:/StaticBanner||$:/core/templates/html-tiddler}}`\n&lt;section class=\&quot;tc-story-river\&quot;&gt;\n`&lt;$importvariables filter=\&quot;[[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\&quot;&gt;\n&lt;$view tiddler=\&quot;$:/core/ui/ViewTemplate\&quot; format=\&quot;htmlwikified\&quot;/&gt;\n&lt;/$importvariables&gt;`\n&lt;/section&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n`&quot;
        },
        &quot;$:/core/templates/store.area.template.html&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/store.area.template.html&quot;,
            &quot;text&quot;: &quot;&lt;$reveal type=\&quot;nomatch\&quot; state=\&quot;$:/isEncrypted\&quot; text=\&quot;yes\&quot;&gt;\n`&lt;div id=\&quot;storeArea\&quot; style=\&quot;display:none;\&quot;&gt;`\n&lt;$list filter=&lt;&lt;saveTiddlerFilter&gt;&gt; template=\&quot;$:/core/templates/html-div-tiddler\&quot;/&gt;\n`&lt;/div&gt;`\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=\&quot;$:/isEncrypted\&quot; text=\&quot;yes\&quot;&gt;\n`&lt;!--~~ Encrypted tiddlers ~~--&gt;`\n`&lt;pre id=\&quot;encryptedStoreArea\&quot; type=\&quot;text/plain\&quot; style=\&quot;display:none;\&quot;&gt;`\n&lt;$encrypt filter=&lt;&lt;saveTiddlerFilter&gt;&gt;/&gt;\n`&lt;/pre&gt;`\n&lt;/$reveal&gt;&quot;
        },
        &quot;$:/core/templates/tid-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/tid-tiddler&quot;,
            &quot;text&quot;: &quot;&lt;!--\n\nThis template is used for saving tiddlers in TiddlyWeb *.tid format\n\n--&gt;&lt;$fields exclude='text bag' template='$name$: $value$\n'&gt;&lt;/$fields&gt;`\n`&lt;$view field=\&quot;text\&quot; format=\&quot;text\&quot; /&gt;&quot;
        },
        &quot;$:/core/templates/tiddler-metadata&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/tiddler-metadata&quot;,
            &quot;text&quot;: &quot;&lt;!--\n\nThis template is used for saving tiddler metadata *.meta files\n\n--&gt;&lt;$fields exclude='text bag' template='$name$: $value$\n'&gt;&lt;/$fields&gt;&quot;
        },
        &quot;$:/core/templates/tiddlywiki5.html&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/tiddlywiki5.html&quot;,
            &quot;text&quot;: &quot;\\rules only filteredtranscludeinline transcludeinline\n&lt;!doctype html&gt;\n{{$:/core/templates/MOTW.html}}&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\&quot;X-UA-Compatible\&quot; content=\&quot;IE=edge\&quot; /&gt;\t\t&lt;!-- Force IE standards mode for Intranet and HTA - should be the first meta --&gt;\n&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html;charset=utf-8\&quot; /&gt;\n&lt;meta name=\&quot;application-name\&quot; content=\&quot;TiddlyWiki\&quot; /&gt;\n&lt;meta name=\&quot;generator\&quot; content=\&quot;TiddlyWiki\&quot; /&gt;\n&lt;meta name=\&quot;tiddlywiki-version\&quot; content=\&quot;{{$:/core/templates/version}}\&quot; /&gt;\n&lt;meta name=\&quot;viewport\&quot; content=\&quot;width=device-width, initial-scale=1.0\&quot; /&gt;\n&lt;meta name=\&quot;apple-mobile-web-app-capable\&quot; content=\&quot;yes\&quot; /&gt;\n&lt;meta name=\&quot;apple-mobile-web-app-status-bar-style\&quot; content=\&quot;black-translucent\&quot; /&gt;\n&lt;meta name=\&quot;format-detection\&quot; content=\&quot;telephone=no\&quot; /&gt;\n&lt;meta name=\&quot;copyright\&quot; content=\&quot;{{$:/core/copyright.txt}}\&quot; /&gt;\n&lt;link id=\&quot;faviconLink\&quot; rel=\&quot;shortcut icon\&quot; href=\&quot;favicon.ico\&quot;&gt;\n&lt;title&gt;{{$:/core/wiki/title}}&lt;/title&gt;\n&lt;!--~~ This is a Tiddlywiki file. The points of interest in the file are marked with this pattern ~~--&gt;\n\n&lt;!--~~ Raw markup ~~--&gt;\n{{{ [all[shadows+tiddlers]tag[$:/core/wiki/rawmarkup]] [all[shadows+tiddlers]tag[$:/tags/RawMarkup]] ||$:/core/templates/plain-text-tiddler}}}\n&lt;/head&gt;\n&lt;body class=\&quot;tc-body\&quot;&gt;\n&lt;!--~~ Static styles ~~--&gt;\n&lt;div id=\&quot;styleArea\&quot;&gt;\n{{$:/boot/boot.css||$:/core/templates/css-tiddler}}\n&lt;/div&gt;\n&lt;!--~~ Static content for Google and browsers without JavaScript ~~--&gt;\n&lt;noscript&gt;\n&lt;div id=\&quot;splashArea\&quot;&gt;\n{{$:/core/templates/static.area}}\n&lt;/div&gt;\n&lt;/noscript&gt;\n&lt;!--~~ Ordinary tiddlers ~~--&gt;\n{{$:/core/templates/store.area.template.html}}\n&lt;!--~~ Library modules ~~--&gt;\n&lt;div id=\&quot;libraryModules\&quot; style=\&quot;display:none;\&quot;&gt;\n{{{ [is[system]type[application/javascript]library[yes]] ||$:/core/templates/javascript-tiddler}}}\n&lt;/div&gt;\n&lt;!--~~ Boot kernel prologue ~~--&gt;\n&lt;div id=\&quot;bootKernelPrefix\&quot; style=\&quot;display:none;\&quot;&gt;\n{{ $:/boot/bootprefix.js ||$:/core/templates/javascript-tiddler}}\n&lt;/div&gt;\n&lt;!--~~ Boot kernel ~~--&gt;\n&lt;div id=\&quot;bootKernel\&quot; style=\&quot;display:none;\&quot;&gt;\n{{ $:/boot/boot.js ||$:/core/templates/javascript-tiddler}}\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;
        },
        &quot;$:/core/templates/version&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/version&quot;,
            &quot;text&quot;: &quot;&lt;&lt;version&gt;&gt;&quot;
        },
        &quot;$:/core/templates/wikified-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/templates/wikified-tiddler&quot;,
            &quot;text&quot;: &quot;&lt;$transclude /&gt;&quot;
        },
        &quot;$:/core/ui/AdvancedSearch/Filter&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/AdvancedSearch/Filter&quot;,
            &quot;tags&quot;: &quot;$:/tags/AdvancedSearch&quot;,
            &quot;caption&quot;: &quot;{{$:/language/Search/Filter/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/Search/\n&lt;$linkcatcher to=\&quot;$:/temp/advancedsearch\&quot;&gt;\n\n&lt;&lt;lingo Filter/Hint&gt;&gt;\n\n&lt;div class=\&quot;tc-search tc-advanced-search\&quot;&gt;\n&lt;$edit-text tiddler=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;search\&quot; tag=\&quot;input\&quot;/&gt;\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/filterDropdown\&quot;&gt;&gt; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/down-arrow}}\n&lt;/$button&gt;\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n&lt;$button class=\&quot;tc-btn-invisible\&quot;&gt;\n&lt;$action-setfield $tiddler=\&quot;$:/temp/advancedsearch\&quot; $field=\&quot;text\&quot; $value=\&quot;\&quot;/&gt;\n{{$:/core/images/close-button}}\n&lt;/$button&gt;\n&lt;$macrocall $name=\&quot;exportButton\&quot; exportFilter={{$:/temp/advancedsearch}} lingoBase=\&quot;$:/language/Buttons/ExportTiddlers/\&quot;/&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n\n&lt;div class=\&quot;tc-block-dropdown-wrapper\&quot;&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/filterDropdown\&quot;&gt;&gt; type=\&quot;nomatch\&quot; text=\&quot;\&quot; default=\&quot;\&quot;&gt;\n&lt;div class=\&quot;tc-block-dropdown tc-edit-type-dropdown\&quot;&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/Filter]]\&quot;&gt;&lt;$link to={{!!filter}}&gt;&lt;$transclude field=\&quot;description\&quot;/&gt;&lt;/$link&gt;\n&lt;/$list&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n\n&lt;/$linkcatcher&gt;\n\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n&lt;$set name=\&quot;resultCount\&quot; value=\&quot;\&quot;\&quot;&lt;$count filter={{$:/temp/advancedsearch}}/&gt;\&quot;\&quot;\&quot;&gt;\n&lt;div class=\&quot;tc-search-results\&quot;&gt;\n&lt;&lt;lingo Filter/Matches&gt;&gt;\n&lt;$list filter={{$:/temp/advancedsearch}} template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&lt;/div&gt;\n&lt;/$set&gt;\n&lt;/$reveal&gt;\n&quot;
        },
        &quot;$:/core/ui/AdvancedSearch/Shadows&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/AdvancedSearch/Shadows&quot;,
            &quot;tags&quot;: &quot;$:/tags/AdvancedSearch&quot;,
            &quot;caption&quot;: &quot;{{$:/language/Search/Shadows/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/Search/\n&lt;$linkcatcher to=\&quot;$:/temp/advancedsearch\&quot;&gt;\n\n&lt;&lt;lingo Shadows/Hint&gt;&gt;\n\n&lt;div class=\&quot;tc-search\&quot;&gt;\n&lt;$edit-text tiddler=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;search\&quot; tag=\&quot;input\&quot;/&gt;\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n&lt;$button class=\&quot;tc-btn-invisible\&quot;&gt;\n&lt;$action-setfield $tiddler=\&quot;$:/temp/advancedsearch\&quot; $field=\&quot;text\&quot; $value=\&quot;\&quot;/&gt;\n{{$:/core/images/close-button}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n\n&lt;/$linkcatcher&gt;\n\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n\n&lt;$set name=\&quot;resultCount\&quot; value=\&quot;\&quot;\&quot;&lt;$count filter=\&quot;[all[shadows]search{$:/temp/advancedsearch}] -[[$:/temp/advancedsearch]]\&quot;/&gt;\&quot;\&quot;\&quot;&gt;\n\n&lt;div class=\&quot;tc-search-results\&quot;&gt;\n\n&lt;&lt;lingo Shadows/Matches&gt;&gt;\n\n&lt;$list filter=\&quot;[all[shadows]search{$:/temp/advancedsearch}sort[title]limit[250]] -[[$:/temp/advancedsearch]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n\n&lt;/div&gt;\n\n&lt;/$set&gt;\n\n&lt;/$reveal&gt;\n\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;match\&quot; text=\&quot;\&quot;&gt;\n\n&lt;/$reveal&gt;\n&quot;
        },
        &quot;$:/core/ui/AdvancedSearch/Standard&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/AdvancedSearch/Standard&quot;,
            &quot;tags&quot;: &quot;$:/tags/AdvancedSearch&quot;,
            &quot;caption&quot;: &quot;{{$:/language/Search/Standard/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/Search/\n&lt;$linkcatcher to=\&quot;$:/temp/advancedsearch\&quot;&gt;\n\n&lt;&lt;lingo Standard/Hint&gt;&gt;\n\n&lt;div class=\&quot;tc-search\&quot;&gt;\n&lt;$edit-text tiddler=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;search\&quot; tag=\&quot;input\&quot;/&gt;\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n&lt;$button class=\&quot;tc-btn-invisible\&quot;&gt;\n&lt;$action-setfield $tiddler=\&quot;$:/temp/advancedsearch\&quot; $field=\&quot;text\&quot; $value=\&quot;\&quot;/&gt;\n{{$:/core/images/close-button}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n\n&lt;/$linkcatcher&gt;\n\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n&lt;$set name=\&quot;searchTiddler\&quot; value=\&quot;$:/temp/advancedsearch\&quot;&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/SearchResults]!has[draft.of]butfirst[]limit[1]]\&quot; emptyMessage=\&quot;\&quot;\&quot;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/SearchResults]!has[draft.of]]\&quot;&gt;\n&lt;$transclude/&gt;\n&lt;/$list&gt;\n\&quot;\&quot;\&quot;&gt;\n&lt;$macrocall $name=\&quot;tabs\&quot; tabsList=\&quot;[all[shadows+tiddlers]tag[$:/tags/SearchResults]!has[draft.of]]\&quot; default={{$:/config/SearchResults/Default}}/&gt;\n&lt;/$list&gt;\n&lt;/$set&gt;\n&lt;/$reveal&gt;\n&quot;
        },
        &quot;$:/core/ui/AdvancedSearch/System&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/AdvancedSearch/System&quot;,
            &quot;tags&quot;: &quot;$:/tags/AdvancedSearch&quot;,
            &quot;caption&quot;: &quot;{{$:/language/Search/System/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/Search/\n&lt;$linkcatcher to=\&quot;$:/temp/advancedsearch\&quot;&gt;\n\n&lt;&lt;lingo System/Hint&gt;&gt;\n\n&lt;div class=\&quot;tc-search\&quot;&gt;\n&lt;$edit-text tiddler=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;search\&quot; tag=\&quot;input\&quot;/&gt;\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n&lt;$button class=\&quot;tc-btn-invisible\&quot;&gt;\n&lt;$action-setfield $tiddler=\&quot;$:/temp/advancedsearch\&quot; $field=\&quot;text\&quot; $value=\&quot;\&quot;/&gt;\n{{$:/core/images/close-button}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n\n&lt;/$linkcatcher&gt;\n\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n\n&lt;$set name=\&quot;resultCount\&quot; value=\&quot;\&quot;\&quot;&lt;$count filter=\&quot;[is[system]search{$:/temp/advancedsearch}] -[[$:/temp/advancedsearch]]\&quot;/&gt;\&quot;\&quot;\&quot;&gt;\n\n&lt;div class=\&quot;tc-search-results\&quot;&gt;\n\n&lt;&lt;lingo System/Matches&gt;&gt;\n\n&lt;$list filter=\&quot;[is[system]search{$:/temp/advancedsearch}sort[title]limit[250]] -[[$:/temp/advancedsearch]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n\n&lt;/div&gt;\n\n&lt;/$set&gt;\n\n&lt;/$reveal&gt;\n\n&lt;$reveal state=\&quot;$:/temp/advancedsearch\&quot; type=\&quot;match\&quot; text=\&quot;\&quot;&gt;\n\n&lt;/$reveal&gt;\n&quot;
        },
        &quot;$:/AdvancedSearch&quot;: {
            &quot;title&quot;: &quot;$:/AdvancedSearch&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-advanced-search\&quot;&gt;\n&lt;&lt;tabs \&quot;[all[shadows+tiddlers]tag[$:/tags/AdvancedSearch]!has[draft.of]]\&quot; \&quot;$:/core/ui/AdvancedSearch/System\&quot;&gt;&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/AlertTemplate&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/AlertTemplate&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-alert\&quot;&gt;\n&lt;div class=\&quot;tc-alert-toolbar\&quot;&gt;\n&lt;$button message=\&quot;tm-delete-tiddler\&quot; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/delete-button}}&lt;/$button&gt;\n&lt;/div&gt;\n&lt;div class=\&quot;tc-alert-subtitle\&quot;&gt;\n&lt;$view field=\&quot;component\&quot;/&gt; - &lt;$view field=\&quot;modified\&quot; format=\&quot;date\&quot; template=\&quot;0hh:0mm:0ss DD MM YYYY\&quot;/&gt; &lt;$reveal type=\&quot;nomatch\&quot; state=\&quot;!!count\&quot; text=\&quot;\&quot;&gt;&lt;span class=\&quot;tc-alert-highlight\&quot;&gt;(count: &lt;$view field=\&quot;count\&quot;/&gt;)&lt;/span&gt;&lt;/$reveal&gt;\n&lt;/div&gt;\n&lt;div class=\&quot;tc-alert-body\&quot;&gt;\n\n&lt;$transclude/&gt;\n\n&lt;/div&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/BinaryWarning&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/BinaryWarning&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/BinaryWarning/\n&lt;div class=\&quot;tc-binary-warning\&quot;&gt;\n\n&lt;&lt;lingo Prompt&gt;&gt;\n\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Advanced&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Advanced&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Info&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Advanced/Caption}}&quot;,
            &quot;text&quot;: &quot;{{$:/language/ControlPanel/Advanced/Hint}}\n\n&lt;div class=\&quot;tc-control-panel\&quot;&gt;\n&lt;&lt;tabs \&quot;[all[shadows+tiddlers]tag[$:/tags/ControlPanel/Advanced]!has[draft.of]]\&quot; \&quot;$:/core/ui/ControlPanel/TiddlerFields\&quot;&gt;&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Appearance&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Appearance&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Appearance/Caption}}&quot;,
            &quot;text&quot;: &quot;{{$:/language/ControlPanel/Appearance/Hint}}\n\n&lt;div class=\&quot;tc-control-panel\&quot;&gt;\n&lt;&lt;tabs \&quot;[all[shadows+tiddlers]tag[$:/tags/ControlPanel/Appearance]!has[draft.of]]\&quot; \&quot;$:/core/ui/ControlPanel/Theme\&quot;&gt;&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Basics&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Basics&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Info&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Basics/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Basics/\n\n\\define show-filter-count(filter)\n&lt;$button class=\&quot;tc-btn-invisible\&quot;&gt;\n&lt;$action-setfield $tiddler=\&quot;$:/temp/advancedsearch\&quot; $value=\&quot;\&quot;\&quot;$filter$\&quot;\&quot;\&quot;/&gt;\n&lt;$action-setfield $tiddler=\&quot;$:/state/tab--1498284803\&quot; $value=\&quot;$:/core/ui/AdvancedSearch/Filter\&quot;/&gt;\n&lt;$action-navigate $to=\&quot;$:/AdvancedSearch\&quot;/&gt;\n''&lt;$count filter=\&quot;\&quot;\&quot;$filter$\&quot;\&quot;\&quot;/&gt;''\n{{$:/core/images/advanced-search-button}}\n&lt;/$button&gt;\n\\end\n\n|&lt;&lt;lingo Version/Prompt&gt;&gt; |''&lt;&lt;version&gt;&gt;'' |\n|&lt;$link to=\&quot;$:/SiteTitle\&quot;&gt;&lt;&lt;lingo Title/Prompt&gt;&gt;&lt;/$link&gt; |&lt;$edit-text tiddler=\&quot;$:/SiteTitle\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;$link to=\&quot;$:/SiteSubtitle\&quot;&gt;&lt;&lt;lingo Subtitle/Prompt&gt;&gt;&lt;/$link&gt; |&lt;$edit-text tiddler=\&quot;$:/SiteSubtitle\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;$link to=\&quot;$:/status/UserName\&quot;&gt;&lt;&lt;lingo Username/Prompt&gt;&gt;&lt;/$link&gt; |&lt;$edit-text tiddler=\&quot;$:/status/UserName\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;$link to=\&quot;$:/config/AnimationDuration\&quot;&gt;&lt;&lt;lingo AnimDuration/Prompt&gt;&gt;&lt;/$link&gt; |&lt;$edit-text tiddler=\&quot;$:/config/AnimationDuration\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;$link to=\&quot;$:/DefaultTiddlers\&quot;&gt;&lt;&lt;lingo DefaultTiddlers/Prompt&gt;&gt;&lt;/$link&gt; |&lt;&lt;lingo DefaultTiddlers/TopHint&gt;&gt;&lt;br&gt; &lt;$edit-text tag=\&quot;textarea\&quot; tiddler=\&quot;$:/DefaultTiddlers\&quot;/&gt;&lt;br&gt;//&lt;&lt;lingo DefaultTiddlers/BottomHint&gt;&gt;// |\n|&lt;$link to=\&quot;$:/config/NewJournal/Title\&quot;&gt;&lt;&lt;lingo NewJournal/Title/Prompt&gt;&gt;&lt;/$link&gt; |&lt;$edit-text tiddler=\&quot;$:/config/NewJournal/Title\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;$link to=\&quot;$:/config/NewJournal/Tags\&quot;&gt;&lt;&lt;lingo NewJournal/Tags/Prompt&gt;&gt;&lt;/$link&gt; |&lt;$edit-text tiddler=\&quot;$:/config/NewJournal/Tags\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;&lt;lingo Language/Prompt&gt;&gt; |{{$:/snippets/minilanguageswitcher}} |\n|&lt;&lt;lingo Tiddlers/Prompt&gt;&gt; |&lt;&lt;show-filter-count \&quot;[!is[system]sort[title]]\&quot;&gt;&gt; |\n|&lt;&lt;lingo Tags/Prompt&gt;&gt; |&lt;&lt;show-filter-count \&quot;[tags[]sort[title]]\&quot;&gt;&gt; |\n|&lt;&lt;lingo SystemTiddlers/Prompt&gt;&gt; |&lt;&lt;show-filter-count \&quot;[is[system]sort[title]]\&quot;&gt;&gt; |\n|&lt;&lt;lingo ShadowTiddlers/Prompt&gt;&gt; |&lt;&lt;show-filter-count \&quot;[all[shadows]sort[title]]\&quot;&gt;&gt; |\n|&lt;&lt;lingo OverriddenShadowTiddlers/Prompt&gt;&gt; |&lt;&lt;show-filter-count \&quot;[is[tiddler]is[shadow]sort[title]]\&quot;&gt;&gt; |\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/EditorTypes&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/EditorTypes&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Advanced&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/EditorTypes/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/EditorTypes/\n\n&lt;&lt;lingo Hint&gt;&gt;\n\n&lt;table&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;th&gt;&lt;&lt;lingo Type/Caption&gt;&gt;&lt;/th&gt;\n&lt;th&gt;&lt;&lt;lingo Editor/Caption&gt;&gt;&lt;/th&gt;\n&lt;/tr&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]prefix[$:/config/EditorTypeMappings/]sort[title]]\&quot;&gt;\n&lt;tr&gt;\n&lt;td&gt;\n&lt;$link&gt;\n&lt;$list filter=\&quot;[all[current]removeprefix[$:/config/EditorTypeMappings/]]\&quot;&gt;\n&lt;$text text={{!!title}}/&gt;\n&lt;/$list&gt;\n&lt;/$link&gt;\n&lt;/td&gt;\n&lt;td&gt;\n&lt;$view field=\&quot;text\&quot;/&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/$list&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Info&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Info&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Info/Caption}}&quot;,
            &quot;text&quot;: &quot;{{$:/language/ControlPanel/Info/Hint}}\n\n&lt;div class=\&quot;tc-control-panel\&quot;&gt;\n&lt;&lt;tabs \&quot;[all[shadows+tiddlers]tag[$:/tags/ControlPanel/Info]!has[draft.of]]\&quot; \&quot;$:/core/ui/ControlPanel/Basics\&quot;&gt;&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/LoadedModules&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/LoadedModules&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Advanced&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/LoadedModules/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/\n&lt;&lt;lingo LoadedModules/Hint&gt;&gt;\n\n{{$:/snippets/modules}}\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Palette&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Palette&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Appearance&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Palette/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Palette/\n\n{{$:/snippets/paletteswitcher}}\n\n&lt;$reveal type=\&quot;nomatch\&quot; state=\&quot;$:/state/ShowPaletteEditor\&quot; text=\&quot;yes\&quot;&gt;\n\n&lt;$button set=\&quot;$:/state/ShowPaletteEditor\&quot; setTo=\&quot;yes\&quot;&gt;&lt;&lt;lingo ShowEditor/Caption&gt;&gt;&lt;/$button&gt;\n\n&lt;/$reveal&gt;\n\n&lt;$reveal type=\&quot;match\&quot; state=\&quot;$:/state/ShowPaletteEditor\&quot; text=\&quot;yes\&quot;&gt;\n\n&lt;$button set=\&quot;$:/state/ShowPaletteEditor\&quot; setTo=\&quot;no\&quot;&gt;&lt;&lt;lingo HideEditor/Caption&gt;&gt;&lt;/$button&gt;\n{{$:/snippets/paletteeditor}}\n\n&lt;/$reveal&gt;\n\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Plugins&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Plugins&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Plugins/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Plugins/\n\\define popup-state-macro()\n$(qualified-state)$-$(currentTiddler)$\n\\end\n\\define tabs-state-macro()\n$(popup-state)$-$(pluginInfoType)$\n\\end\n\\define plugin-icon-title()\n$(currentTiddler)$/icon\n\\end\n\\define plugin-disable-title()\n$:/config/Plugins/Disabled/$(currentTiddler)$\n\\end\n\\define plugin-table-body(type,disabledMessage)\n&lt;div class=\&quot;tc-plugin-info-chunk\&quot;&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;popup-state&gt;&gt; text=\&quot;yes\&quot;&gt;\n&lt;$button class=\&quot;tc-btn-invisible tc-btn-dropdown\&quot; set=&lt;&lt;popup-state&gt;&gt; setTo=\&quot;yes\&quot;&gt;\n{{$:/core/images/right-arrow}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;popup-state&gt;&gt; text=\&quot;yes\&quot;&gt;\n&lt;$button class=\&quot;tc-btn-invisible tc-btn-dropdown\&quot; set=&lt;&lt;popup-state&gt;&gt; setTo=\&quot;no\&quot;&gt;\n{{$:/core/images/down-arrow}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n&lt;div class=\&quot;tc-plugin-info-chunk\&quot;&gt;\n&lt;$transclude tiddler=&lt;&lt;currentTiddler&gt;&gt; subtiddler=&lt;&lt;plugin-icon-title&gt;&gt;&gt;\n&lt;$transclude tiddler=\&quot;$:/core/images/plugin-generic-$type$\&quot;/&gt;\n&lt;/$transclude&gt;\n&lt;/div&gt;\n&lt;div class=\&quot;tc-plugin-info-chunk\&quot;&gt;\n&lt;div&gt;\n''&lt;$view field=\&quot;description\&quot;&gt;&lt;$view field=\&quot;title\&quot;/&gt;&lt;/$view&gt;'' $disabledMessage$\n&lt;/div&gt;\n&lt;div&gt;\n&lt;$view field=\&quot;title\&quot;/&gt;\n&lt;/div&gt;\n&lt;div&gt;\n&lt;$view field=\&quot;version\&quot;/&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n\\end\n\\define plugin-table(type)\n&lt;$set name=\&quot;qualified-state\&quot; value=&lt;&lt;qualify \&quot;$:/state/plugin-info\&quot;&gt;&gt;&gt;\n&lt;$list filter=\&quot;[!has[draft.of]plugin-type[$type$]sort[description]]\&quot; emptyMessage=&lt;&lt;lingo \&quot;Empty/Hint\&quot;&gt;&gt;&gt;\n&lt;$set name=\&quot;popup-state\&quot; value=&lt;&lt;popup-state-macro&gt;&gt;&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;plugin-disable-title&gt;&gt; text=\&quot;yes\&quot;&gt;\n&lt;$link to={{!!title}} class=\&quot;tc-plugin-info\&quot;&gt;\n&lt;&lt;plugin-table-body type:\&quot;$type$\&quot;&gt;&gt;\n&lt;/$link&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;plugin-disable-title&gt;&gt; text=\&quot;yes\&quot;&gt;\n&lt;$link to={{!!title}} class=\&quot;tc-plugin-info tc-plugin-info-disabled\&quot;&gt;\n&lt;&lt;plugin-table-body type:\&quot;$type$\&quot; disabledMessage:\&quot;&lt;$macrocall $name='lingo' title='Disabled/Status'/&gt;\&quot;&gt;&gt;\n&lt;/$link&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; text=\&quot;yes\&quot; state=&lt;&lt;popup-state&gt;&gt;&gt;\n&lt;div class=\&quot;tc-plugin-info-dropdown\&quot;&gt;\n&lt;$list filter=\&quot;[all[current]] -[[$:/core]]\&quot;&gt;\n&lt;div style=\&quot;float:right;\&quot;&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;plugin-disable-title&gt;&gt; text=\&quot;yes\&quot;&gt;\n&lt;$button set=&lt;&lt;plugin-disable-title&gt;&gt; setTo=\&quot;yes\&quot; tooltip={{$:/language/ControlPanel/Plugins/Disable/Hint}} aria-label={{$:/language/ControlPanel/Plugins/Disable/Caption}}&gt;\n&lt;&lt;lingo Disable/Caption&gt;&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;plugin-disable-title&gt;&gt; text=\&quot;yes\&quot;&gt;\n&lt;$button set=&lt;&lt;plugin-disable-title&gt;&gt; setTo=\&quot;no\&quot; tooltip={{$:/language/ControlPanel/Plugins/Enable/Hint}} aria-label={{$:/language/ControlPanel/Plugins/Enable/Caption}}&gt;\n&lt;&lt;lingo Enable/Caption&gt;&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n&lt;/$list&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; text=\&quot;\&quot; state=\&quot;!!list\&quot;&gt;\n&lt;$macrocall $name=\&quot;tabs\&quot; state=&lt;&lt;tabs-state-macro&gt;&gt; tabsList={{!!list}} default=\&quot;readme\&quot; template=\&quot;$:/core/ui/PluginInfo\&quot;/&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; text=\&quot;\&quot; state=\&quot;!!list\&quot;&gt;\nNo information provided\n&lt;/$reveal&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;\n&lt;/$set&gt;\n&lt;/$list&gt;\n&lt;/$set&gt;\n\\end\n\n! &lt;&lt;lingo Plugin/Prompt&gt;&gt;\n\n&lt;&lt;plugin-table plugin&gt;&gt;\n\n! &lt;&lt;lingo Theme/Prompt&gt;&gt;\n\n&lt;&lt;plugin-table theme&gt;&gt;\n\n! &lt;&lt;lingo Language/Prompt&gt;&gt;\n\n&lt;&lt;plugin-table language&gt;&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Saving&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Saving&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Saving/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Saving/\n\\define backupURL()\nhttp://$(userName)$.tiddlyspot.com/backup/\n\\end\n\\define backupLink()\n&lt;$reveal type=\&quot;nomatch\&quot; state=\&quot;$:/UploadName\&quot; text=\&quot;\&quot;&gt;\n&lt;$set name=\&quot;userName\&quot; value={{$:/UploadName}}&gt;\n&lt;a href=&lt;&lt;backupURL&gt;&gt;&gt;&lt;$macrocall $name=\&quot;backupURL\&quot; $type=\&quot;text/plain\&quot; $output=\&quot;text/plain\&quot;/&gt;&lt;/a&gt;\n&lt;/$set&gt;\n&lt;/$reveal&gt;\n\\end\n! &lt;&lt;lingo TiddlySpot/Heading&gt;&gt;\n\n&lt;&lt;lingo TiddlySpot/Description&gt;&gt;\n\n|&lt;&lt;lingo TiddlySpot/UserName&gt;&gt; |&lt;$edit-text tiddler=\&quot;$:/UploadName\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;&lt;lingo TiddlySpot/Password&gt;&gt; |&lt;$password name=\&quot;upload\&quot;/&gt; |\n|&lt;&lt;lingo TiddlySpot/Backups&gt;&gt; |&lt;&lt;backupLink&gt;&gt; |\n\n''&lt;&lt;lingo TiddlySpot/Advanced/Heading&gt;&gt;''\n\n|&lt;&lt;lingo TiddlySpot/ServerURL&gt;&gt;  |&lt;$edit-text tiddler=\&quot;$:/UploadURL\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;&lt;lingo TiddlySpot/Filename&gt;&gt; |&lt;$edit-text tiddler=\&quot;$:/UploadFilename\&quot; default=\&quot;index.html\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;&lt;lingo TiddlySpot/UploadDir&gt;&gt; |&lt;$edit-text tiddler=\&quot;$:/UploadDir\&quot; default=\&quot;.\&quot; tag=\&quot;input\&quot;/&gt; |\n|&lt;&lt;lingo TiddlySpot/BackupDir&gt;&gt; |&lt;$edit-text tiddler=\&quot;$:/UploadBackupDir\&quot; default=\&quot;.\&quot; tag=\&quot;input\&quot;/&gt; |\n\n&lt;&lt;lingo TiddlySpot/Hint&gt;&gt;\n\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Settings/AutoSave&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Settings/AutoSave&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Settings&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Settings/AutoSave/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Settings/AutoSave/\n\n&lt;$link to=\&quot;$:/config/AutoSave\&quot;&gt;&lt;&lt;lingo Hint&gt;&gt;&lt;/$link&gt;\n\n&lt;$radio tiddler=\&quot;$:/config/AutoSave\&quot; value=\&quot;yes\&quot;&gt; &lt;&lt;lingo Enabled/Description&gt;&gt; &lt;/$radio&gt;\n\n&lt;$radio tiddler=\&quot;$:/config/AutoSave\&quot; value=\&quot;no\&quot;&gt; &lt;&lt;lingo Disabled/Description&gt;&gt; &lt;/$radio&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Settings/NavigationAddressBar&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Settings/NavigationAddressBar&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Settings&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Settings/NavigationAddressBar/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Settings/NavigationAddressBar/\n\n&lt;$link to=\&quot;$:/config/Navigation/UpdateAddressBar\&quot;&gt;&lt;&lt;lingo Hint&gt;&gt;&lt;/$link&gt;\n\n&lt;$radio tiddler=\&quot;$:/config/Navigation/UpdateAddressBar\&quot; value=\&quot;permaview\&quot;&gt; &lt;&lt;lingo Permaview/Description&gt;&gt; &lt;/$radio&gt;\n\n&lt;$radio tiddler=\&quot;$:/config/Navigation/UpdateAddressBar\&quot; value=\&quot;permalink\&quot;&gt; &lt;&lt;lingo Permalink/Description&gt;&gt; &lt;/$radio&gt;\n\n&lt;$radio tiddler=\&quot;$:/config/Navigation/UpdateAddressBar\&quot; value=\&quot;no\&quot;&gt; &lt;&lt;lingo No/Description&gt;&gt; &lt;/$radio&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Settings/NavigationHistory&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Settings/NavigationHistory&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Settings&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Settings/NavigationHistory/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Settings/NavigationHistory/\n&lt;$link to=\&quot;$:/config/Navigation/UpdateHistory\&quot;&gt;&lt;&lt;lingo Hint&gt;&gt;&lt;/$link&gt;\n\n&lt;$radio tiddler=\&quot;$:/config/Navigation/UpdateHistory\&quot; value=\&quot;yes\&quot;&gt; &lt;&lt;lingo Yes/Description&gt;&gt; &lt;/$radio&gt;\n\n&lt;$radio tiddler=\&quot;$:/config/Navigation/UpdateHistory\&quot; value=\&quot;no\&quot;&gt; &lt;&lt;lingo No/Description&gt;&gt; &lt;/$radio&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Settings/ToolbarButtons&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Settings/ToolbarButtons&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Settings&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Settings/ToolbarButtons/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Settings/ToolbarButtons/\n&lt;&lt;lingo Hint&gt;&gt;\n\n&lt;$checkbox tiddler=\&quot;$:/config/Toolbar/Icons\&quot; field=\&quot;text\&quot; checked=\&quot;yes\&quot; unchecked=\&quot;no\&quot; default=\&quot;yes\&quot;&gt; &lt;$link to=\&quot;$:/config/Toolbar/Icons\&quot;&gt;&lt;&lt;lingo Icons/Description&gt;&gt;&lt;/$link&gt; &lt;/$checkbox&gt;\n\n&lt;$checkbox tiddler=\&quot;$:/config/Toolbar/Text\&quot; field=\&quot;text\&quot; checked=\&quot;yes\&quot; unchecked=\&quot;no\&quot; default=\&quot;no\&quot;&gt; &lt;$link to=\&quot;$:/config/Toolbar/Text\&quot;&gt;&lt;&lt;lingo Text/Description&gt;&gt;&lt;/$link&gt; &lt;/$checkbox&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Settings&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Settings&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Settings/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Settings/\n\n&lt;&lt;lingo Hint&gt;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/ControlPanel/Settings]]\&quot;&gt;\n\n&lt;div style=\&quot;border-top:1px solid #eee;\&quot;&gt;\n\n!! &lt;$link&gt;&lt;$transclude field=\&quot;caption\&quot;/&gt;&lt;/$link&gt;\n\n&lt;$transclude/&gt;\n\n&lt;/div&gt;\n\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/StoryView&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/StoryView&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Appearance&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/StoryView/Caption}}&quot;,
            &quot;text&quot;: &quot;{{$:/snippets/viewswitcher}}\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Theme&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Theme&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Appearance&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Theme/Caption}}&quot;,
            &quot;text&quot;: &quot;{{$:/snippets/themeswitcher}}\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/TiddlerFields&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/TiddlerFields&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Advanced&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/TiddlerFields/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/\n\n&lt;&lt;lingo TiddlerFields/Hint&gt;&gt;\n\n{{$:/snippets/allfields}}&quot;
        },
        &quot;$:/core/ui/ControlPanel/Toolbars/EditToolbar&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Toolbars/EditToolbar&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Toolbars&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Toolbars/EditToolbar/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/\n\\define config-title()\n$:/config/EditToolbarButtons/Visibility/$(listItem)$\n\\end\n\n{{$:/language/ControlPanel/Toolbars/EditToolbar/Hint}}\n\n&lt;$set name=\&quot;tv-config-toolbar-icons\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-text\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/EditToolbar]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n\n&lt;$checkbox tiddler=&lt;&lt;config-title&gt;&gt; field=\&quot;text\&quot; checked=\&quot;show\&quot; unchecked=\&quot;hide\&quot; default=\&quot;show\&quot;/&gt; &lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; field=\&quot;caption\&quot;/&gt; &lt;i class=\&quot;tc-muted\&quot;&gt;-- &lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; field=\&quot;description\&quot;/&gt;&lt;/i&gt;\n\n&lt;/$list&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Toolbars/PageControls&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Toolbars/PageControls&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Toolbars&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Toolbars/PageControls/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/\n\\define config-title()\n$:/config/PageControlButtons/Visibility/$(listItem)$\n\\end\n\n{{$:/language/ControlPanel/Toolbars/PageControls/Hint}}\n\n&lt;$set name=\&quot;tv-config-toolbar-icons\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-text\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/PageControls]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n\n&lt;$checkbox tiddler=&lt;&lt;config-title&gt;&gt; field=\&quot;text\&quot; checked=\&quot;show\&quot; unchecked=\&quot;hide\&quot; default=\&quot;show\&quot;/&gt; &lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; field=\&quot;caption\&quot;/&gt; &lt;i class=\&quot;tc-muted\&quot;&gt;-- &lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; field=\&quot;description\&quot;/&gt;&lt;/i&gt;\n\n&lt;/$list&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Toolbars/ViewToolbar&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Toolbars/ViewToolbar&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Toolbars&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Toolbars/ViewToolbar/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/\n\\define config-title()\n$:/config/ViewToolbarButtons/Visibility/$(listItem)$\n\\end\n\n{{$:/language/ControlPanel/Toolbars/ViewToolbar/Hint}}\n\n&lt;$set name=\&quot;tv-config-toolbar-icons\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-text\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/ViewToolbar]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n\n&lt;$checkbox tiddler=&lt;&lt;config-title&gt;&gt; field=\&quot;text\&quot; checked=\&quot;show\&quot; unchecked=\&quot;hide\&quot; default=\&quot;show\&quot;/&gt; &lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; field=\&quot;caption\&quot;/&gt; &lt;i class=\&quot;tc-muted\&quot;&gt;-- &lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; field=\&quot;description\&quot;/&gt;&lt;/i&gt;\n\n&lt;/$list&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n&quot;
        },
        &quot;$:/core/ui/ControlPanel/Toolbars&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ControlPanel/Toolbars&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Appearance&quot;,
            &quot;caption&quot;: &quot;{{$:/language/ControlPanel/Toolbars/Caption}}&quot;,
            &quot;text&quot;: &quot;{{$:/language/ControlPanel/Toolbars/Hint}}\n\n&lt;div class=\&quot;tc-control-panel\&quot;&gt;\n&lt;&lt;tabs \&quot;[all[shadows+tiddlers]tag[$:/tags/ControlPanel/Toolbars]!has[draft.of]]\&quot; \&quot;$:/core/ui/ControlPanel/Toolbars/ViewToolbar\&quot; \&quot;$:/state/tabs/controlpanel/toolbars\&quot; \&quot;tc-vertical\&quot;&gt;&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/ControlPanel&quot;: {
            &quot;title&quot;: &quot;$:/ControlPanel&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-control-panel\&quot;&gt;\n&lt;&lt;tabs \&quot;[all[shadows+tiddlers]tag[$:/tags/ControlPanel]!has[draft.of]]\&quot; \&quot;$:/core/ui/ControlPanel/Info\&quot;&gt;&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/DefaultSearchResultList&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/DefaultSearchResultList&quot;,
            &quot;tags&quot;: &quot;$:/tags/SearchResults&quot;,
            &quot;caption&quot;: &quot;{{$:/language/Search/DefaultResults/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define searchResultList()\n&lt;$set name=\&quot;resultCount\&quot; value=\&quot;\&quot;\&quot;&lt;$count filter=\&quot;[!is[system]search{$(searchTiddler)$}]\&quot;/&gt;\&quot;\&quot;\&quot;&gt;\n\n{{$:/language/Search/Matches}}\n\n&lt;/$set&gt;\n\n//&lt;small&gt;Title matches:&lt;/small&gt;//\n\n&lt;$list filter=\&quot;[!is[system]search:title{$(searchTiddler)$}sort[title]limit[250]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n\n//&lt;small&gt;All matches:&lt;/small&gt;//\n\n&lt;$list filter=\&quot;[!is[system]search{$(searchTiddler)$}sort[title]limit[250]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n\\end\n&lt;&lt;searchResultList&gt;&gt;\n&quot;
        },
        &quot;$:/core/ui/EditTemplate/body&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/EditTemplate/body&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditTemplate&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/EditTemplate/Body/\n&lt;$list filter=\&quot;[is[current]has[_canonical_uri]]\&quot;&gt;\n\n&lt;div class=\&quot;tc-message-box\&quot;&gt;\n\n&lt;&lt;lingo External/Hint&gt;&gt;\n\n&lt;a href={{!!_canonical_uri}}&gt;&lt;$text text={{!!_canonical_uri}}/&gt;&lt;/a&gt;\n\n&lt;$edit-text field=\&quot;_canonical_uri\&quot; class=\&quot;tc-edit-fields\&quot;&gt;&lt;/$edit-text&gt;\n\n&lt;/div&gt;\n\n&lt;/$list&gt;\n\n&lt;$list filter=\&quot;[is[current]!has[_canonical_uri]]\&quot;&gt;\n\n&lt;$reveal state=\&quot;$:/state/showeditpreview\&quot; type=\&quot;match\&quot; text=\&quot;yes\&quot;&gt;\n\n&lt;em class=\&quot;tc-edit\&quot;&gt;&lt;&lt;lingo Hint&gt;&gt;&lt;/em&gt; &lt;$button type=\&quot;set\&quot; set=\&quot;$:/state/showeditpreview\&quot; setTo=\&quot;no\&quot;&gt;&lt;&lt;lingo Preview/Button/Hide&gt;&gt;&lt;/$button&gt;\n\n&lt;div class=\&quot;tc-tiddler-preview\&quot;&gt;\n&lt;div class=\&quot;tc-tiddler-preview-preview\&quot;&gt;\n\n&lt;$transclude /&gt;\n\n&lt;/div&gt;\n\n&lt;div class=\&quot;tc-tiddler-preview-edit\&quot;&gt;\n&lt;$edit field=\&quot;text\&quot; class=\&quot;tc-edit-texteditor\&quot; placeholder={{$:/language/EditTemplate/Body/Placeholder}}/&gt;\n\n&lt;/div&gt;\n\n&lt;/div&gt;\n\n&lt;/$reveal&gt;\n\n&lt;$reveal state=\&quot;$:/state/showeditpreview\&quot; type=\&quot;nomatch\&quot; text=\&quot;yes\&quot;&gt;\n\n&lt;em class=\&quot;tc-edit\&quot;&gt;&lt;&lt;lingo Hint&gt;&gt;&lt;/em&gt; &lt;$button type=\&quot;set\&quot; set=\&quot;$:/state/showeditpreview\&quot; setTo=\&quot;yes\&quot;&gt;&lt;&lt;lingo Preview/Button/Show&gt;&gt;&lt;/$button&gt;\n&lt;$edit field=\&quot;text\&quot; class=\&quot;tc-edit-texteditor\&quot; placeholder={{$:/language/EditTemplate/Body/Placeholder}}/&gt;\n\n&lt;/$reveal&gt;\n\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/EditTemplate/controls&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/EditTemplate/controls&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditTemplate&quot;,
            &quot;text&quot;: &quot;\\define config-title()\n$:/config/EditToolbarButtons/Visibility/$(listItem)$\n\\end\n&lt;div class=\&quot;tc-tiddler-title tc-tiddler-edit-title\&quot;&gt;\n&lt;$view field=\&quot;title\&quot;/&gt;\n&lt;span class=\&quot;tc-tiddler-controls tc-titlebar\&quot;&gt;&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/EditToolbar]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;config-title&gt;&gt; text=\&quot;hide\&quot;&gt;&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt;/&gt;&lt;/$reveal&gt;&lt;/$list&gt;&lt;/span&gt;\n&lt;div style=\&quot;clear: both;\&quot;&gt;&lt;/div&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/EditTemplate/fields&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/EditTemplate/fields&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditTemplate&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/EditTemplate/\n\\define config-title()\n$:/config/EditTemplateFields/Visibility/$(currentField)$\n\\end\n\n\\define config-filter()\n[[hide]] -[title{$(config-title)$}]\n\\end\n\n\\define new-field(name,value)\n&lt;$reveal type=\&quot;nomatch\&quot; text=\&quot;\&quot; default=\&quot;\&quot;\&quot;$name$\&quot;\&quot;\&quot;&gt;\n&lt;$button&gt;\n&lt;$action-sendmessage $message=\&quot;tm-add-field\&quot; $name$=\&quot;\&quot;\&quot;$value$\&quot;\&quot;\&quot;/&gt;\n&lt;$action-deletetiddler $tiddler=\&quot;$:/temp/newfieldname\&quot;/&gt;\n&lt;$action-deletetiddler $tiddler=\&quot;$:/temp/newfieldvalue\&quot;/&gt;\n&lt;&lt;lingo Fields/Add/Button&gt;&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; text=\&quot;\&quot; default=\&quot;\&quot;\&quot;$name$\&quot;\&quot;\&quot;&gt;\n&lt;$button&gt;\n&lt;&lt;lingo Fields/Add/Button&gt;&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n\\end\n\n&lt;div class=\&quot;tc-edit-fields\&quot;&gt;\n&lt;table class=\&quot;tc-edit-fields\&quot;&gt;\n&lt;tbody&gt;\n&lt;$list filter=\&quot;[all[current]fields[]] +[sort[title]]\&quot; variable=\&quot;currentField\&quot;&gt;\n&lt;$list filter=&lt;&lt;config-filter&gt;&gt; variable=\&quot;temp\&quot;&gt;\n&lt;tr class=\&quot;tc-edit-field\&quot;&gt;\n&lt;td class=\&quot;tc-edit-field-name\&quot;&gt;\n&lt;$text text=&lt;&lt;currentField&gt;&gt;/&gt;:&lt;/td&gt;\n&lt;td class=\&quot;tc-edit-field-value\&quot;&gt;\n&lt;$edit-text tiddler=&lt;&lt;currentTiddler&gt;&gt; field=&lt;&lt;currentField&gt;&gt; placeholder={{$:/language/EditTemplate/Fields/Add/Value/Placeholder}}/&gt;\n&lt;/td&gt;\n&lt;td class=\&quot;tc-edit-field-remove\&quot;&gt;\n&lt;$button class=\&quot;tc-btn-invisible\&quot; tooltip={{$:/language/EditTemplate/Field/Remove/Hint}} aria-label={{$:/language/EditTemplate/Field/Remove/Caption}}&gt;\n&lt;$action-deletefield $field=&lt;&lt;currentField&gt;&gt;/&gt;\n{{$:/core/images/delete-button}}\n&lt;/$button&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/$list&gt;\n&lt;/$list&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;/div&gt;\n\n&lt;$fieldmangler&gt;\n&lt;div class=\&quot;tc-edit-field-add\&quot;&gt;\n&lt;em class=\&quot;tc-edit\&quot;&gt;\n&lt;&lt;lingo Fields/Add/Prompt&gt;&gt;\n&lt;/em&gt;\n&lt;span class=\&quot;tc-edit-field-add-name\&quot;&gt;\n&lt;$edit-text tiddler=\&quot;$:/temp/newfieldname\&quot; tag=\&quot;input\&quot; default=\&quot;\&quot; placeholder={{$:/language/EditTemplate/Fields/Add/Name/Placeholder}} class=\&quot;tc-edit-texteditor\&quot;/&gt;\n&lt;/span&gt;\n&lt;span class=\&quot;tc-edit-field-add-value\&quot;&gt;\n&lt;$edit-text tiddler=\&quot;$:/temp/newfieldvalue\&quot; tag=\&quot;input\&quot; default=\&quot;\&quot; placeholder={{$:/language/EditTemplate/Fields/Add/Value/Placeholder}} class=\&quot;tc-edit-texteditor\&quot;/&gt;\n&lt;/span&gt;\n&lt;span class=\&quot;tc-edit-field-add-button\&quot;&gt;\n&lt;$macrocall $name=\&quot;new-field\&quot; name={{$:/temp/newfieldname}} value={{$:/temp/newfieldvalue}}/&gt;\n&lt;/span&gt;\n&lt;/div&gt;\n&lt;/$fieldmangler&gt;\n\n&quot;
        },
        &quot;$:/core/ui/EditTemplate/shadow&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/EditTemplate/shadow&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditTemplate&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/EditTemplate/Shadow/\n&lt;$list filter=\&quot;[all[current]get[draft.of]is[shadow]!is[tiddler]]\&quot;&gt;\n&lt;div class=\&quot;tc-message-box\&quot;&gt;\n\n&lt;&lt;lingo Warning&gt;&gt;\n\n&lt;/div&gt;\n&lt;/$list&gt;\n\n&lt;$list filter=\&quot;[all[current]get[draft.of]is[shadow]is[tiddler]]\&quot;&gt;\n&lt;div class=\&quot;tc-message-box\&quot;&gt;\n\n&lt;&lt;lingo OverriddenWarning&gt;&gt;\n\n&lt;/div&gt;\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/EditTemplate/tags&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/EditTemplate/tags&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditTemplate&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/EditTemplate/\n\\define tag-styles()\nbackground-color:$(backgroundColor)$;\n\\end\n&lt;div class=\&quot;tc-edit-tags\&quot;&gt;\n&lt;$fieldmangler&gt;\n&lt;$list filter=\&quot;[all[current]tags[]sort[title]]\&quot; storyview=\&quot;pop\&quot;&gt;&lt;$set name=\&quot;backgroundColor\&quot; value={{!!color}}&gt;&lt;span style=&lt;&lt;tag-styles&gt;&gt; class=\&quot;tc-tag-label\&quot;&gt;\n&lt;$view field=\&quot;title\&quot; format=\&quot;text\&quot; /&gt;\n&lt;$button message=\&quot;tm-remove-tag\&quot; param={{!!title}} class=\&quot;tc-btn-invisible tc-remove-tag-button\&quot;&gt;&amp;times;&lt;/$button&gt;&lt;/span&gt;\n&lt;/$set&gt;\n&lt;/$list&gt;\n\n&lt;div class=\&quot;tc-edit-add-tag\&quot;&gt;\n&lt;span class=\&quot;tc-add-tag-name\&quot;&gt;\n&lt;$edit-text tiddler=\&quot;$:/temp/NewTagName\&quot; tag=\&quot;input\&quot; default=\&quot;\&quot; placeholder={{$:/language/EditTemplate/Tags/Add/Placeholder}} focusPopup=&lt;&lt;qualify \&quot;$:/state/popup/tags-auto-complete\&quot;&gt;&gt; class=\&quot;tc-edit-texteditor tc-popup-handle\&quot;/&gt;\n&lt;/span&gt; &lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/tags-auto-complete\&quot;&gt;&gt; class=\&quot;tc-btn-invisible tc-btn-dropdown\&quot; tooltip={{$:/language/EditTemplate/Tags/Dropdown/Hint}} aria-label={{$:/language/EditTemplate/Tags/Dropdown/Caption}}&gt;{{$:/core/images/down-arrow}}&lt;/$button&gt; &lt;span class=\&quot;tc-add-tag-button\&quot;&gt;\n&lt;$button message=\&quot;tm-add-tag\&quot; param={{$:/temp/NewTagName}} set=\&quot;$:/temp/NewTagName\&quot; setTo=\&quot;\&quot; class=\&quot;\&quot;&gt;\n&lt;&lt;lingo Tags/Add/Button&gt;&gt;\n&lt;/$button&gt;\n&lt;/span&gt;\n&lt;/div&gt;\n\n&lt;div class=\&quot;tc-block-dropdown-wrapper\&quot;&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/tags-auto-complete\&quot;&gt;&gt; type=\&quot;nomatch\&quot; text=\&quot;\&quot; default=\&quot;\&quot;&gt;\n&lt;div class=\&quot;tc-block-dropdown\&quot;&gt;\n&lt;$linkcatcher set=\&quot;$:/temp/NewTagName\&quot; setTo=\&quot;\&quot; message=\&quot;tm-add-tag\&quot;&gt;\n&lt;$list filter=\&quot;[!is[shadow]tags[]search{$:/temp/NewTagName}sort[title]]\&quot;&gt;\n&lt;$link&gt;\n&lt;$set name=\&quot;backgroundColor\&quot; value={{!!color}}&gt;\n&lt;span style=&lt;&lt;tag-styles&gt;&gt; class=\&quot;tc-tag-label\&quot;&gt;\n&lt;$view field=\&quot;title\&quot; format=\&quot;text\&quot;/&gt;\n&lt;/span&gt;\n&lt;/$set&gt;\n&lt;/$link&gt;\n&lt;/$list&gt;\n&lt;/$linkcatcher&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n&lt;/$fieldmangler&gt;\n&lt;/div&gt;&quot;
        },
        &quot;$:/core/ui/EditTemplate/title&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/EditTemplate/title&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditTemplate&quot;,
            &quot;text&quot;: &quot;&lt;$edit-text field=\&quot;draft.title\&quot; class=\&quot;tc-titlebar tc-edit-texteditor\&quot; focus=\&quot;true\&quot;/&gt;&quot;
        },
        &quot;$:/core/ui/EditTemplate/type&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/EditTemplate/type&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditTemplate&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/EditTemplate/\n&lt;div class=\&quot;tc-type-selector\&quot;&gt;&lt;$fieldmangler&gt;\n&lt;em class=\&quot;tc-edit\&quot;&gt;&lt;&lt;lingo Type/Prompt&gt;&gt;&lt;/em&gt; &lt;$edit-text field=\&quot;type\&quot; tag=\&quot;input\&quot; default=\&quot;\&quot; placeholder={{$:/language/EditTemplate/Type/Placeholder}} focusPopup=&lt;&lt;qualify \&quot;$:/state/popup/type-dropdown\&quot;&gt;&gt; class=\&quot;tc-edit-typeeditor tc-popup-handle\&quot;/&gt; &lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/type-dropdown\&quot;&gt;&gt; class=\&quot;tc-btn-invisible tc-btn-dropdown\&quot; tooltip={{$:/language/EditTemplate/Type/Dropdown/Hint}} aria-label={{$:/language/EditTemplate/Type/Dropdown/Caption}}&gt;{{$:/core/images/down-arrow}}&lt;/$button&gt; &lt;$button message=\&quot;tm-remove-field\&quot; param=\&quot;type\&quot; class=\&quot;tc-btn-invisible tc-btn-icon\&quot; tooltip={{$:/language/EditTemplate/Type/Delete/Hint}} aria-label={{$:/language/EditTemplate/Type/Delete/Caption}}&gt;{{$:/core/images/delete-button}}&lt;/$button&gt;\n&lt;/$fieldmangler&gt;&lt;/div&gt;\n\n&lt;div class=\&quot;tc-block-dropdown-wrapper\&quot;&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/type-dropdown\&quot;&gt;&gt; type=\&quot;nomatch\&quot; text=\&quot;\&quot; default=\&quot;\&quot;&gt;\n&lt;div class=\&quot;tc-block-dropdown tc-edit-type-dropdown\&quot;&gt;\n&lt;$linkcatcher to=\&quot;!!type\&quot;&gt;\n&lt;$list filter='[all[shadows+tiddlers]prefix[$:/language/Docs/Types/]each[group]sort[group]]'&gt;\n&lt;div class=\&quot;tc-dropdown-item\&quot;&gt;\n&lt;$text text={{!!group}}/&gt;\n&lt;/div&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]prefix[$:/language/Docs/Types/]group{!!group}] +[sort[description]]\&quot;&gt;&lt;$link to={{!!name}}&gt;&lt;$view field=\&quot;description\&quot;/&gt; (&lt;$view field=\&quot;name\&quot;/&gt;)&lt;/$link&gt;\n&lt;/$list&gt;\n&lt;/$list&gt;\n&lt;/$linkcatcher&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;&quot;
        },
        &quot;$:/core/ui/EditTemplate&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/EditTemplate&quot;,
            &quot;text&quot;: &quot;\\define frame-classes()\ntc-tiddler-frame tc-tiddler-edit-frame $(missingTiddlerClass)$ $(shadowTiddlerClass)$ $(systemTiddlerClass)$\n\\end\n&lt;div class=&lt;&lt;frame-classes&gt;&gt;&gt;\n&lt;$set name=\&quot;storyTiddler\&quot; value=&lt;&lt;currentTiddler&gt;&gt;&gt;\n&lt;$keyboard key=\&quot;escape\&quot; message=\&quot;tm-cancel-tiddler\&quot;&gt;\n&lt;$keyboard key=\&quot;ctrl+enter\&quot; message=\&quot;tm-save-tiddler\&quot;&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/EditTemplate]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt;/&gt;\n&lt;/$list&gt;\n&lt;/$keyboard&gt;\n&lt;/$keyboard&gt;\n&lt;/$set&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/Buttons/cancel&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/cancel&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/cancel-button}} {{$:/language/Buttons/Cancel/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Cancel/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-cancel-tiddler\&quot; tooltip={{$:/language/Buttons/Cancel/Hint}} aria-label={{$:/language/Buttons/Cancel/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/cancel-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Cancel/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/delete&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/delete&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/delete-button}} {{$:/language/Buttons/Delete/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Delete/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-delete-tiddler\&quot; tooltip={{$:/language/Buttons/Delete/Hint}} aria-label={{$:/language/Buttons/Delete/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/delete-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Delete/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/save&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/save&quot;,
            &quot;tags&quot;: &quot;$:/tags/EditToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/done-button}} {{$:/language/Buttons/Save/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Save/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-save-tiddler\&quot; tooltip={{$:/language/Buttons/Save/Hint}} aria-label={{$:/language/Buttons/Save/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/done-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Save/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/Filters/AllTags&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/AllTags&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[tags[]!is[system]sort[title]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/AllTags}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/AllTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/AllTiddlers&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[!is[system]sort[title]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/AllTiddlers}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/Drafts&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/Drafts&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[has[draft.of]sort[title]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/Drafts}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/Missing&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/Missing&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[all[missing]sort[title]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/Missing}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/Orphans&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/Orphans&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[all[orphans]sort[title]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/Orphans}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/OverriddenShadowTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/OverriddenShadowTiddlers&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[is[shadow]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/OverriddenShadowTiddlers}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/RecentSystemTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/RecentSystemTiddlers&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[has[modified]!sort[modified]limit[50]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/RecentSystemTiddlers}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/RecentTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/RecentTiddlers&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[!is[system]has[modified]!sort[modified]limit[50]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/RecentTiddlers}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/ShadowTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/ShadowTiddlers&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[all[shadows]sort[title]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/ShadowTiddlers}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/SystemTags&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/SystemTags&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[all[shadows+tiddlers]tags[]is[system]sort[title]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/SystemTags}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/Filters/SystemTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/core/Filters/SystemTiddlers&quot;,
            &quot;tags&quot;: &quot;$:/tags/Filter&quot;,
            &quot;filter&quot;: &quot;[is[system]sort[title]]&quot;,
            &quot;description&quot;: &quot;{{$:/language/Filters/SystemTiddlers}}&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/core/ui/ImportListing&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ImportListing&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/Import/\n\\define messageField()\nmessage-$(payloadTiddler)$\n\\end\n\\define selectionField()\nselection-$(payloadTiddler)$\n\\end\n\\define previewPopupState()\n$(currentTiddler)$!!popup-$(payloadTiddler)$\n\\end\n&lt;table&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;th&gt;\n&lt;&lt;lingo Listing/Select/Caption&gt;&gt;\n&lt;/th&gt;\n&lt;th&gt;\n&lt;&lt;lingo Listing/Title/Caption&gt;&gt;\n&lt;/th&gt;\n&lt;th&gt;\n&lt;&lt;lingo Listing/Status/Caption&gt;&gt;\n&lt;/th&gt;\n&lt;/tr&gt;\n&lt;$list filter=\&quot;[all[current]plugintiddlers[]sort[title]]\&quot; variable=\&quot;payloadTiddler\&quot;&gt;\n&lt;tr&gt;\n&lt;td&gt;\n&lt;$checkbox field=&lt;&lt;selectionField&gt;&gt; checked=\&quot;checked\&quot; unchecked=\&quot;unchecked\&quot; default=\&quot;checked\&quot;/&gt;\n&lt;/td&gt;\n&lt;td&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;previewPopupState&gt;&gt; text=\&quot;yes\&quot;&gt;\n&lt;$button class=\&quot;tc-btn-invisible tc-btn-dropdown\&quot; set=&lt;&lt;previewPopupState&gt;&gt; setTo=\&quot;yes\&quot;&gt;\n{{$:/core/images/right-arrow}}&amp;nbsp;&lt;$text text=&lt;&lt;payloadTiddler&gt;&gt;/&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;previewPopupState&gt;&gt; text=\&quot;yes\&quot;&gt;\n&lt;$button class=\&quot;tc-btn-invisible tc-btn-dropdown\&quot; set=&lt;&lt;previewPopupState&gt;&gt; setTo=\&quot;no\&quot;&gt;\n{{$:/core/images/down-arrow}}&amp;nbsp;&lt;$text text=&lt;&lt;payloadTiddler&gt;&gt;/&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;/td&gt;\n&lt;td&gt;\n&lt;$view field=&lt;&lt;messageField&gt;&gt;/&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td colspan=\&quot;3\&quot;&gt;\n&lt;$reveal type=\&quot;match\&quot; text=\&quot;yes\&quot; state=&lt;&lt;previewPopupState&gt;&gt;&gt;\n&lt;$transclude subtiddler=&lt;&lt;payloadTiddler&gt;&gt; mode=\&quot;block\&quot;/&gt;\n&lt;/$reveal&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/$list&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&quot;
        },
        &quot;$:/core/ui/ListItemTemplate&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ListItemTemplate&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-menu-list-item\&quot;&gt;\n&lt;$link to={{!!title}}&gt;\n&lt;$view field=\&quot;title\&quot;/&gt;\n&lt;/$link&gt;\n&lt;/div&gt;&quot;
        },
        &quot;$:/core/ui/MissingTemplate&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MissingTemplate&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-tiddler-missing\&quot;&gt;\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/missing\&quot;&gt;&gt; class=\&quot;tc-btn-invisible tc-missing-tiddler-label\&quot;&gt;\n&lt;$view field=\&quot;title\&quot; format=\&quot;text\&quot; /&gt;\n&lt;/$button&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/missing\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;below\&quot; animate=\&quot;yes\&quot;&gt;\n&lt;div class=\&quot;tc-drop-down\&quot;&gt;\n&lt;$transclude tiddler=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&lt;hr&gt;\n&lt;$list filter=\&quot;[all[current]backlinks[]sort[title]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/MoreSideBar/All&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MoreSideBar/All&quot;,
            &quot;tags&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/All/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[!is[system]sort[title]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/MoreSideBar/Drafts&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MoreSideBar/Drafts&quot;,
            &quot;tags&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Drafts/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[has[draft.of]sort[title]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/MoreSideBar/Missing&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MoreSideBar/Missing&quot;,
            &quot;tags&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Missing/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[all[missing]sort[title]]\&quot; template=\&quot;$:/core/ui/MissingTemplate\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/MoreSideBar/Orphans&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MoreSideBar/Orphans&quot;,
            &quot;tags&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Orphans/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[all[orphans]sort[title]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/MoreSideBar/Recent&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MoreSideBar/Recent&quot;,
            &quot;tags&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Recent/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$macrocall $name=\&quot;timeline\&quot; format={{$:/language/RecentChanges/DateFormat}}/&gt;\n&quot;
        },
        &quot;$:/core/ui/MoreSideBar/Shadows&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MoreSideBar/Shadows&quot;,
            &quot;tags&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Shadows/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[all[shadows]sort[title]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/MoreSideBar/System&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MoreSideBar/System&quot;,
            &quot;tags&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/System/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[is[system]sort[title]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/MoreSideBar/Tags&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MoreSideBar/Tags&quot;,
            &quot;tags&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Tags/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$set name=\&quot;tv-config-toolbar-icons\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-text\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-class\&quot; value=\&quot;\&quot;&gt;\n\n{{$:/core/ui/Buttons/tag-manager}}\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;$list filter=\&quot;[tags[]!is[system]sort[title]]\&quot;&gt;\n\n&lt;$transclude tiddler=\&quot;$:/core/ui/TagTemplate\&quot;/&gt; &lt;small class=\&quot;tc-menu-list-count\&quot;&gt;&lt;$count filter=\&quot;[all[current]tagging[]]\&quot;/&gt;&lt;/small&gt;\n\n&lt;/$list&gt;\n\n&lt;hr class=\&quot;tc-untagged-separator\&quot;&gt;\n\n{{$:/core/ui/UntaggedTemplate}} &lt;small class=\&quot;tc-menu-list-count\&quot;&gt;&lt;$count filter=\&quot;[untagged[]!is[system]] -[tags[]]\&quot;/&gt;&lt;/small&gt;\n&quot;
        },
        &quot;$:/core/ui/MoreSideBar/Types&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/MoreSideBar/Types&quot;,
            &quot;tags&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Types/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[!is[system]has[type]each[type]sort[type]] -[type[text/vnd.tiddlywiki]]\&quot;&gt;\n&lt;div class=\&quot;tc-menu-list-item\&quot;&gt;\n&lt;$view field=\&quot;type\&quot;/&gt;\n&lt;$list filter=\&quot;[type{!!type}!is[system]sort[title]]\&quot;&gt;\n&lt;div class=\&quot;tc-menu-list-subitem\&quot;&gt;\n&lt;$link to={{!!title}}&gt;&lt;$view field=\&quot;title\&quot;/&gt;&lt;/$link&gt;\n&lt;/div&gt;\n&lt;/$list&gt;\n&lt;/div&gt;\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/Buttons/advanced-search&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/advanced-search&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/advanced-search-button}} {{$:/language/Buttons/AdvancedSearch/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/AdvancedSearch/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button to=\&quot;$:/AdvancedSearch\&quot; tooltip={{$:/language/Buttons/AdvancedSearch/Hint}} aria-label={{$:/language/Buttons/AdvancedSearch/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/advanced-search-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/AdvancedSearch/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/close-all&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/close-all&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/close-all-button}} {{$:/language/Buttons/CloseAll/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/CloseAll/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-close-all-tiddlers\&quot; tooltip={{$:/language/Buttons/CloseAll/Hint}} aria-label={{$:/language/Buttons/CloseAll/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/close-all-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/CloseAll/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/control-panel&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/control-panel&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/options-button}} {{$:/language/Buttons/ControlPanel/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/ControlPanel/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button to=\&quot;$:/ControlPanel\&quot; tooltip={{$:/language/Buttons/ControlPanel/Hint}} aria-label={{$:/language/Buttons/ControlPanel/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/options-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/ControlPanel/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/encryption&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/encryption&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/locked-padlock}} {{$:/language/Buttons/Encryption/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Encryption/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$reveal type=\&quot;match\&quot; state=\&quot;$:/isEncrypted\&quot; text=\&quot;yes\&quot;&gt;\n&lt;$button message=\&quot;tm-clear-password\&quot; tooltip={{$:/language/Buttons/Encryption/ClearPassword/Hint}} aria-label={{$:/language/Buttons/Encryption/ClearPassword/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/locked-padlock}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Encryption/ClearPassword/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=\&quot;$:/isEncrypted\&quot; text=\&quot;yes\&quot;&gt;\n&lt;$button message=\&quot;tm-set-password\&quot; tooltip={{$:/language/Buttons/Encryption/SetPassword/Hint}} aria-label={{$:/language/Buttons/Encryption/SetPassword/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/unlocked-padlock}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Encryption/SetPassword/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/export-page&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/export-page&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/export-button}} {{$:/language/Buttons/ExportPage/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/ExportPage/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$macrocall $name=\&quot;exportButton\&quot; exportFilter=\&quot;[!is[system]sort[title]]\&quot; lingoBase=\&quot;$:/language/Buttons/ExportPage/\&quot;/&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/full-screen&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/full-screen&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/full-screen-button}} {{$:/language/Buttons/FullScreen/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/FullScreen/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-full-screen\&quot; tooltip={{$:/language/Buttons/FullScreen/Hint}} aria-label={{$:/language/Buttons/FullScreen/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/full-screen-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/FullScreen/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/home&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/home&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/home-button}} {{$:/language/Buttons/Home/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Home/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-home\&quot; tooltip={{$:/language/Buttons/Home/Hint}} aria-label={{$:/language/Buttons/Home/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/home-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Home/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/import&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/import&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/import-button}} {{$:/language/Buttons/Import/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Import/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-file-input-wrapper\&quot;&gt;\n&lt;$button tooltip={{$:/language/Buttons/Import/Hint}} aria-label={{$:/language/Buttons/Import/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/import-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Import/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n&lt;$browse tooltip={{$:/language/Buttons/Import/Hint}}/&gt;\n&lt;/div&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/language&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/language&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/globe}} {{$:/language/Buttons/Language/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Language/Hint}}&quot;,
            &quot;text&quot;: &quot;\\define flag-title()\n$(languagePluginTitle)$/icon\n\\end\n&lt;span class=\&quot;tc-popup-keep\&quot;&gt;\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/language\&quot;&gt;&gt; tooltip={{$:/language/Buttons/Language/Hint}} aria-label={{$:/language/Buttons/Language/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt; selectedClass=\&quot;tc-selected\&quot;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-image-button\&quot;&gt;\n&lt;$set name=\&quot;languagePluginTitle\&quot; value={{$:/language}}&gt;\n&lt;$image source=&lt;&lt;flag-title&gt;&gt;/&gt;\n&lt;/$set&gt;\n&lt;/span&gt;\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Language/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n&lt;/span&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/language\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;below\&quot; animate=\&quot;yes\&quot;&gt;\n&lt;div class=\&quot;tc-drop-down tc-drop-down-language-chooser\&quot;&gt;\n&lt;$linkcatcher to=\&quot;$:/language\&quot;&gt;\n&lt;$list filter=\&quot;[[$:/languages/en-GB]] [plugin-type[language]sort[description]]\&quot;&gt;\n&lt;$link&gt;\n&lt;span class=\&quot;tc-drop-down-bullet\&quot;&gt;\n&lt;$reveal type=\&quot;match\&quot; state=\&quot;$:/language\&quot; text=&lt;&lt;currentTiddler&gt;&gt;&gt;\n&amp;bull;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=\&quot;$:/language\&quot; text=&lt;&lt;currentTiddler&gt;&gt;&gt;\n&amp;nbsp;\n&lt;/$reveal&gt;\n&lt;/span&gt;\n&lt;span class=\&quot;tc-image-button\&quot;&gt;\n&lt;$set name=\&quot;languagePluginTitle\&quot; value=&lt;&lt;currentTiddler&gt;&gt;&gt;\n&lt;$transclude subtiddler=&lt;&lt;flag-title&gt;&gt;&gt;\n&lt;$list filter=\&quot;[all[current]field:title[$:/languages/en-GB]]\&quot;&gt;\n&lt;$transclude tiddler=\&quot;$:/languages/en-GB/icon\&quot;/&gt;\n&lt;/$list&gt;\n&lt;/$transclude&gt;\n&lt;/$set&gt;\n&lt;/span&gt;\n&lt;$view field=\&quot;description\&quot;&gt;\n&lt;$view field=\&quot;name\&quot;&gt;\n&lt;$view field=\&quot;title\&quot;/&gt;\n&lt;/$view&gt;\n&lt;/$view&gt;\n&lt;/$link&gt;\n&lt;/$list&gt;\n&lt;/$linkcatcher&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/more-page-actions&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/more-page-actions&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/down-arrow}} {{$:/language/Buttons/More/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/More/Hint}}&quot;,
            &quot;text&quot;: &quot;\\define config-title()\n$:/config/PageControlButtons/Visibility/$(listItem)$\n\\end\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/more\&quot;&gt;&gt; tooltip={{$:/language/Buttons/More/Hint}} aria-label={{$:/language/Buttons/More/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt; selectedClass=\&quot;tc-selected\&quot;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/down-arrow}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/More/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/more\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;below\&quot; animate=\&quot;yes\&quot;&gt;\n\n&lt;div class=\&quot;tc-drop-down\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-icons\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-text\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-class\&quot; value=\&quot;tc-btn-invisible\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/PageControls]!has[draft.of]] -[[$:/core/ui/Buttons/more-page-actions]]\&quot; variable=\&quot;listItem\&quot;&gt;\n\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;config-title&gt;&gt; text=\&quot;hide\&quot;&gt;\n\n&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; mode=\&quot;inline\&quot;/&gt;\n\n&lt;/$reveal&gt;\n\n&lt;/$list&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/div&gt;\n\n&lt;/$reveal&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/new-journal&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/new-journal&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/new-journal-button}} {{$:/language/Buttons/NewJournal/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/NewJournal/Hint}}&quot;,
            &quot;text&quot;: &quot;\\define journalButton()\n&lt;$button tooltip={{$:/language/Buttons/NewJournal/Hint}} aria-label={{$:/language/Buttons/NewJournal/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$action-sendmessage $message=\&quot;tm-new-tiddler\&quot; title=&lt;&lt;now \&quot;$(journalTitleTemplate)$\&quot;&gt;&gt; tags=\&quot;$(journalTags)$\&quot;/&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/new-journal-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/NewJournal/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n\\end\n&lt;$set name=\&quot;journalTitleTemplate\&quot; value={{$:/config/NewJournal/Title}}&gt;\n&lt;$set name=\&quot;journalTags\&quot; value={{$:/config/NewJournal/Tags}}&gt;\n&lt;&lt;journalButton&gt;&gt;\n&lt;/$set&gt;&lt;/$set&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/new-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/new-tiddler&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/new-button}} {{$:/language/Buttons/NewTiddler/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/NewTiddler/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-new-tiddler\&quot; tooltip={{$:/language/Buttons/NewTiddler/Hint}} aria-label={{$:/language/Buttons/NewTiddler/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/new-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/NewTiddler/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/refresh&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/refresh&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/refresh-button}} {{$:/language/Buttons/Refresh/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Refresh/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-browser-refresh\&quot; tooltip={{$:/language/Buttons/Refresh/Hint}} aria-label={{$:/language/Buttons/Refresh/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/refresh-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Refresh/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/save-wiki&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/save-wiki&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/save-button}} {{$:/language/Buttons/SaveWiki/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/SaveWiki/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-save-wiki\&quot; param={{$:/config/SaveWikiButton/Template}} tooltip={{$:/language/Buttons/SaveWiki/Hint}} aria-label={{$:/language/Buttons/SaveWiki/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;span class=\&quot;tc-dirty-indicator\&quot;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/save-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/SaveWiki/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/span&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/storyview&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/storyview&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/storyview-classic}} {{$:/language/Buttons/StoryView/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/StoryView/Hint}}&quot;,
            &quot;text&quot;: &quot;\\define icon()\n$:/core/images/storyview-$(storyview)$\n\\end\n&lt;span class=\&quot;tc-popup-keep\&quot;&gt;\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/storyview\&quot;&gt;&gt; tooltip={{$:/language/Buttons/StoryView/Hint}} aria-label={{$:/language/Buttons/StoryView/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt; selectedClass=\&quot;tc-selected\&quot;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n&lt;$set name=\&quot;storyview\&quot; value={{$:/view}}&gt;\n&lt;$transclude tiddler=&lt;&lt;icon&gt;&gt;/&gt;\n&lt;/$set&gt;\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/StoryView/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n&lt;/span&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/storyview\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;below\&quot; animate=\&quot;yes\&quot;&gt;\n&lt;div class=\&quot;tc-drop-down\&quot;&gt;\n&lt;$linkcatcher to=\&quot;$:/view\&quot;&gt;\n&lt;$list filter=\&quot;[storyviews[]]\&quot; variable=\&quot;storyview\&quot;&gt;\n&lt;$link to=&lt;&lt;storyview&gt;&gt;&gt;\n&lt;span class=\&quot;tc-drop-down-bullet\&quot;&gt;\n&lt;$reveal type=\&quot;match\&quot; state=\&quot;$:/view\&quot; text=&lt;&lt;storyview&gt;&gt;&gt;\n&amp;bull;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=\&quot;$:/view\&quot; text=&lt;&lt;storyview&gt;&gt;&gt;\n&amp;nbsp;\n&lt;/$reveal&gt;\n&lt;/span&gt;\n&lt;$transclude tiddler=&lt;&lt;icon&gt;&gt;/&gt;\n&lt;$text text=&lt;&lt;storyview&gt;&gt;/&gt;&lt;/$link&gt;\n&lt;/$list&gt;\n&lt;/$linkcatcher&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/tag-manager&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/tag-manager&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/tag-button}} {{$:/language/Buttons/TagManager/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/TagManager/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button to=\&quot;$:/TagManager\&quot; tooltip={{$:/language/Buttons/TagManager/Hint}} aria-label={{$:/language/Buttons/TagManager/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/tag-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/TagManager/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/theme&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/theme&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/theme-button}} {{$:/language/Buttons/Theme/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Theme/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;span class=\&quot;tc-popup-keep\&quot;&gt;\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/theme\&quot;&gt;&gt; tooltip={{$:/language/Buttons/Theme/Hint}} aria-label={{$:/language/Buttons/Theme/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt; selectedClass=\&quot;tc-selected\&quot;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/theme-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Theme/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n&lt;/span&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/theme\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;below\&quot; animate=\&quot;yes\&quot;&gt;\n&lt;div class=\&quot;tc-drop-down\&quot;&gt;\n&lt;$linkcatcher to=\&quot;$:/theme\&quot;&gt;\n&lt;$list filter=\&quot;[plugin-type[theme]sort[title]]\&quot; variable=\&quot;themeTitle\&quot;&gt;\n&lt;$link to=&lt;&lt;themeTitle&gt;&gt;&gt;\n&lt;span class=\&quot;tc-drop-down-bullet\&quot;&gt;\n&lt;$reveal type=\&quot;match\&quot; state=\&quot;$:/theme\&quot; text=&lt;&lt;themeTitle&gt;&gt;&gt;\n&amp;bull;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=\&quot;$:/theme\&quot; text=&lt;&lt;themeTitle&gt;&gt;&gt;\n&amp;nbsp;\n&lt;/$reveal&gt;\n&lt;/span&gt;\n&lt;$view tiddler=&lt;&lt;themeTitle&gt;&gt; field=\&quot;name\&quot;/&gt;\n&lt;/$link&gt;\n&lt;/$list&gt;\n&lt;/$linkcatcher&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;&quot;
        },
        &quot;$:/core/ui/PageTemplate/pagecontrols&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/PageTemplate/pagecontrols&quot;,
            &quot;text&quot;: &quot;\\define config-title()\n$:/config/PageControlButtons/Visibility/$(listItem)$\n\\end\n&lt;div class=\&quot;tc-page-controls\&quot;&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/PageControls]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;config-title&gt;&gt; text=\&quot;hide\&quot;&gt;\n&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; mode=\&quot;inline\&quot;/&gt;\n&lt;/$reveal&gt;\n&lt;/$list&gt;\n&lt;/div&gt;\n\n&quot;
        },
        &quot;$:/core/ui/PageStylesheet&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/PageStylesheet&quot;,
            &quot;text&quot;: &quot;&lt;$importvariables filter=\&quot;[[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/Stylesheet]!has[draft.of]]\&quot;&gt;\n&lt;$transclude mode=\&quot;block\&quot;/&gt;\n&lt;/$list&gt;\n\n&lt;/$importvariables&gt;\n&quot;
        },
        &quot;$:/core/ui/PageTemplate/alerts&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/PageTemplate/alerts&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageTemplate&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-alerts\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/Alert]!has[draft.of]]\&quot; template=\&quot;$:/core/ui/AlertTemplate\&quot; storyview=\&quot;pop\&quot;/&gt;\n\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/PageTemplate/sidebar&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/PageTemplate/sidebar&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageTemplate&quot;,
            &quot;text&quot;: &quot;&lt;$scrollable fallthrough=\&quot;no\&quot; class=\&quot;tc-sidebar-scrollable\&quot;&gt;\n\n&lt;div class=\&quot;tc-sidebar-header\&quot;&gt;\n\n&lt;$reveal state=\&quot;$:/state/sidebar\&quot; type=\&quot;match\&quot; text=\&quot;yes\&quot; default=\&quot;yes\&quot; retain=\&quot;yes\&quot;&gt;\n\n&lt;h1 class=\&quot;tc-site-title\&quot;&gt;\n\n&lt;$transclude tiddler=\&quot;$:/SiteTitle\&quot; mode=\&quot;inline\&quot;/&gt;\n\n&lt;/h1&gt;\n\n&lt;div class=\&quot;tc-site-subtitle\&quot;&gt;\n\n&lt;$transclude tiddler=\&quot;$:/SiteSubtitle\&quot; mode=\&quot;inline\&quot;/&gt;\n\n&lt;/div&gt;\n\n{{||$:/core/ui/PageTemplate/pagecontrols}}\n\n&lt;$transclude tiddler=\&quot;$:/core/ui/SideBarLists\&quot; mode=\&quot;inline\&quot;/&gt;\n\n&lt;/$reveal&gt;\n\n&lt;/div&gt;\n\n&lt;/$scrollable&gt;&quot;
        },
        &quot;$:/core/ui/PageTemplate/story&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/PageTemplate/story&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageTemplate&quot;,
            &quot;text&quot;: &quot;&lt;section class=\&quot;tc-story-river\&quot;&gt;\n\n&lt;section class=\&quot;story-backdrop\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/AboveStory]!has[draft.of]]\&quot;&gt;\n\n&lt;$transclude/&gt;\n\n&lt;/$list&gt;\n\n&lt;/section&gt;\n\n&lt;$list filter=\&quot;[list[$:/StoryList]]\&quot; history=\&quot;$:/HistoryList\&quot; template=\&quot;$:/core/ui/ViewTemplate\&quot; editTemplate=\&quot;$:/core/ui/EditTemplate\&quot; storyview={{$:/view}} /&gt;\n\n&lt;section class=\&quot;story-frontdrop\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/BelowStory]!has[draft.of]]\&quot;&gt;\n\n&lt;$transclude/&gt;\n\n&lt;/$list&gt;\n\n&lt;/section&gt;\n\n&lt;/section&gt;\n&quot;
        },
        &quot;$:/core/ui/PageTemplate/topleftbar&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/PageTemplate/topleftbar&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageTemplate&quot;,
            &quot;text&quot;: &quot;&lt;span class=\&quot;tc-topbar tc-topbar-left\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/TopLeftBar]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n\n&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; mode=\&quot;inline\&quot;/&gt;\n\n&lt;/$list&gt;\n\n&lt;/span&gt;\n&quot;
        },
        &quot;$:/core/ui/PageTemplate/toprightbar&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/PageTemplate/toprightbar&quot;,
            &quot;tags&quot;: &quot;$:/tags/PageTemplate&quot;,
            &quot;text&quot;: &quot;&lt;span class=\&quot;tc-topbar tc-topbar-right\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/TopRightBar]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n\n&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; mode=\&quot;inline\&quot;/&gt;\n\n&lt;/$list&gt;\n\n&lt;/span&gt;\n&quot;
        },
        &quot;$:/core/ui/PageTemplate&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/PageTemplate&quot;,
            &quot;text&quot;: &quot;\\define containerClasses()\ntc-page-container tc-page-view-$(themeTitle)$ tc-language-$(languageTitle)$\n\\end\n\n&lt;$importvariables filter=\&quot;[[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-icons\&quot; value={{$:/config/Toolbar/Icons}}&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-text\&quot; value={{$:/config/Toolbar/Text}}&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-class\&quot; value=\&quot;tc-btn-invisible\&quot;&gt;\n\n&lt;$set name=\&quot;themeTitle\&quot; value={{$:/view}}&gt;\n\n&lt;$set name=\&quot;currentTiddler\&quot; value={{$:/language}}&gt;\n\n&lt;$set name=\&quot;languageTitle\&quot; value={{!!name}}&gt;\n\n&lt;$set name=\&quot;currentTiddler\&quot; value=\&quot;\&quot;&gt;\n\n&lt;div class=&lt;&lt;containerClasses&gt;&gt;&gt;\n\n&lt;$navigator story=\&quot;$:/StoryList\&quot; history=\&quot;$:/HistoryList\&quot;&gt;\n\n&lt;$dropzone&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/PageTemplate]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n\n&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt;/&gt;\n\n&lt;/$list&gt;\n\n&lt;/$dropzone&gt;\n\n&lt;/$navigator&gt;\n\n&lt;/div&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$importvariables&gt;\n&quot;
        },
        &quot;$:/core/ui/PluginInfo&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/PluginInfo&quot;,
            &quot;text&quot;: &quot;\\define localised-info-tiddler-title()\n$(currentTiddler)$/$(languageTitle)$/$(currentTab)$\n\\end\n\\define info-tiddler-title()\n$(currentTiddler)$/$(currentTab)$\n\\end\n&lt;$transclude tiddler=&lt;&lt;localised-info-tiddler-title&gt;&gt; mode=\&quot;block\&quot;&gt;\n&lt;$transclude tiddler=&lt;&lt;currentTiddler&gt;&gt; subtiddler=&lt;&lt;localised-info-tiddler-title&gt;&gt; mode=\&quot;block\&quot;&gt;\n&lt;$transclude tiddler=&lt;&lt;currentTiddler&gt;&gt; subtiddler=&lt;&lt;info-tiddler-title&gt;&gt; mode=\&quot;block\&quot;&gt;\nNo ''\&quot;&lt;$text text=&lt;&lt;currentTab&gt;&gt;/&gt;\&quot;'' found\n&lt;/$transclude&gt;\n&lt;/$transclude&gt;\n&lt;/$transclude&gt;\n&quot;
        },
        &quot;$:/core/ui/SearchResults&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/SearchResults&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-search-results\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/SearchResults]!has[draft.of]butfirst[]limit[1]]\&quot; emptyMessage=\&quot;\&quot;\&quot;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/SearchResults]!has[draft.of]]\&quot;&gt;\n&lt;$transclude mode=\&quot;block\&quot;/&gt;\n&lt;/$list&gt;\n\&quot;\&quot;\&quot;&gt;\n&lt;$macrocall $name=\&quot;tabs\&quot; tabsList=\&quot;[all[shadows+tiddlers]tag[$:/tags/SearchResults]!has[draft.of]]\&quot; default={{$:/config/SearchResults/Default}}/&gt;\n&lt;/$list&gt;\n\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/SideBar/More&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/SideBar/More&quot;,
            &quot;tags&quot;: &quot;$:/tags/SideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/More/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-more-sidebar\&quot;&gt;\n&lt;&lt;tabs \&quot;[all[shadows+tiddlers]tag[$:/tags/MoreSideBar]!has[draft.of]]\&quot; \&quot;$:/core/ui/MoreSideBar/Tags\&quot; \&quot;$:/state/tab/moresidebar\&quot; \&quot;tc-vertical\&quot;&gt;&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/SideBar/Open&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/SideBar/Open&quot;,
            &quot;tags&quot;: &quot;$:/tags/SideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Open/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/CloseAll/\n&lt;$list filter=\&quot;[list[$:/StoryList]]\&quot; history=\&quot;$:/HistoryList\&quot; storyview=\&quot;pop\&quot;&gt;\n\n&lt;$button message=\&quot;tm-close-tiddler\&quot; tooltip={{$:/language/Buttons/Close/Hint}} aria-label={{$:/language/Buttons/Close/Caption}} class=\&quot;tc-btn-invisible tc-btn-mini\&quot;&gt;&amp;times;&lt;/$button&gt; &lt;$link to={{!!title}}&gt;&lt;$view field=\&quot;title\&quot;/&gt;&lt;/$link&gt;\n\n&lt;/$list&gt;\n\n&lt;$button message=\&quot;tm-close-all-tiddlers\&quot; class=\&quot;tc-btn-invisible tc-btn-mini\&quot;&gt;&lt;&lt;lingo Button&gt;&gt;&lt;/$button&gt;\n&quot;
        },
        &quot;$:/core/ui/SideBar/Recent&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/SideBar/Recent&quot;,
            &quot;tags&quot;: &quot;$:/tags/SideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Recent/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$macrocall $name=\&quot;timeline\&quot; format={{$:/language/RecentChanges/DateFormat}}/&gt;\n&quot;
        },
        &quot;$:/core/ui/SideBar/Tools&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/SideBar/Tools&quot;,
            &quot;tags&quot;: &quot;$:/tags/SideBar&quot;,
            &quot;caption&quot;: &quot;{{$:/language/SideBar/Tools/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/\n\\define config-title()\n$:/config/PageControlButtons/Visibility/$(listItem)$\n\\end\n\n&lt;&lt;lingo Basics/Version/Prompt&gt;&gt; &lt;&lt;version&gt;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-icons\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-text\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-class\&quot; value=\&quot;\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/PageControls]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n\n&lt;div style=\&quot;position:relative;\&quot;&gt;\n\n&lt;$checkbox tiddler=&lt;&lt;config-title&gt;&gt; field=\&quot;text\&quot; checked=\&quot;show\&quot; unchecked=\&quot;hide\&quot; default=\&quot;show\&quot;/&gt; &lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt;/&gt; &lt;i class=\&quot;tc-muted\&quot;&gt;&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; field=\&quot;description\&quot;/&gt;&lt;/i&gt;\n\n&lt;/div&gt;\n\n&lt;/$list&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n&quot;
        },
        &quot;$:/core/ui/SideBarLists&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/SideBarLists&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-sidebar-lists\&quot;&gt;\n\n&lt;div class=\&quot;tc-search\&quot;&gt;\n&lt;$edit-text tiddler=\&quot;$:/temp/search\&quot; type=\&quot;search\&quot; tag=\&quot;input\&quot;/&gt;\n&lt;$reveal state=\&quot;$:/temp/search\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n&lt;$button tooltip={{$:/language/Buttons/AdvancedSearch/Hint}} aria-label={{$:/language/Buttons/AdvancedSearch/Caption}} class=\&quot;tc-btn-invisible\&quot;&gt;\n&lt;$action-setfield $tiddler=\&quot;$:/temp/advancedsearch\&quot; text={{$:/temp/search}}/&gt;\n&lt;$action-setfield $tiddler=\&quot;$:/temp/search\&quot; text=\&quot;\&quot;/&gt;\n&lt;$action-navigate $to=\&quot;$:/AdvancedSearch\&quot;/&gt;\n{{$:/core/images/advanced-search-button}}\n&lt;/$button&gt;\n&lt;$button class=\&quot;tc-btn-invisible\&quot;&gt;\n&lt;$action-setfield $tiddler=\&quot;$:/temp/search\&quot; text=\&quot;\&quot; /&gt;\n{{$:/core/images/close-button}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal state=\&quot;$:/temp/search\&quot; type=\&quot;match\&quot; text=\&quot;\&quot;&gt;\n&lt;$button to=\&quot;$:/AdvancedSearch\&quot; tooltip={{$:/language/Buttons/AdvancedSearch/Hint}} aria-label={{$:/language/Buttons/AdvancedSearch/Caption}} class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/advanced-search-button}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n\n&lt;$reveal state=\&quot;$:/temp/search\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n\n&lt;$set name=\&quot;searchTiddler\&quot; value=\&quot;$:/temp/search\&quot;&gt;\n{{$:/core/ui/SearchResults}}\n&lt;/$set&gt;\n\n&lt;/$reveal&gt;\n\n&lt;$reveal state=\&quot;$:/temp/search\&quot; type=\&quot;match\&quot; text=\&quot;\&quot;&gt;\n\n&lt;&lt;tabs \&quot;[all[shadows+tiddlers]tag[$:/tags/SideBar]!has[draft.of]]\&quot; \&quot;$:/core/ui/SideBar/Open\&quot; \&quot;$:/state/tab/sidebar\&quot;&gt;&gt;\n\n&lt;/$reveal&gt;\n\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/TagManager&quot;: {
            &quot;title&quot;: &quot;$:/TagManager&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TagManager/\n\\define iconEditorTab(type)\n&lt;$list filter=\&quot;[all[shadows+tiddlers]is[image]] [all[shadows+tiddlers]tag[$:/tags/Image]] -[type[application/pdf]] +[sort[title]] +[$type$is[system]]\&quot;&gt;\n&lt;$link to={{!!title}}&gt;\n&lt;$transclude/&gt; &lt;$view field=\&quot;title\&quot;/&gt;\n&lt;/$link&gt;\n&lt;/$list&gt;\n\\end\n\\define iconEditor(title)\n&lt;div class=\&quot;tc-drop-down-wrapper\&quot;&gt;\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/icon/$title$\&quot;&gt;&gt; class=\&quot;tc-btn-invisible tc-btn-dropdown\&quot;&gt;{{$:/core/images/down-arrow}}&lt;/$button&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/icon/$title$\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;belowleft\&quot; text=\&quot;\&quot; default=\&quot;\&quot;&gt;\n&lt;div class=\&quot;tc-drop-down\&quot;&gt;\n&lt;$linkcatcher to=\&quot;$title$!!icon\&quot;&gt;\n&lt;&lt;iconEditorTab type:\&quot;!\&quot;&gt;&gt;\n&lt;hr/&gt;\n&lt;&lt;iconEditorTab type:\&quot;\&quot;&gt;&gt;\n&lt;/$linkcatcher&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;\n&lt;/div&gt;\n\\end\n\\define qualifyTitle(title)\n$title$$(currentTiddler)$\n\\end\n\\define toggleButton(state)\n&lt;$reveal state=\&quot;$state$\&quot; type=\&quot;match\&quot; text=\&quot;closed\&quot; default=\&quot;closed\&quot;&gt;\n&lt;$button set=\&quot;$state$\&quot; setTo=\&quot;open\&quot; class=\&quot;tc-btn-invisible tc-btn-dropdown\&quot; selectedClass=\&quot;tc-selected\&quot;&gt;\n{{$:/core/images/info-button}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal state=\&quot;$state$\&quot; type=\&quot;match\&quot; text=\&quot;open\&quot; default=\&quot;closed\&quot;&gt;\n&lt;$button set=\&quot;$state$\&quot; setTo=\&quot;closed\&quot; class=\&quot;tc-btn-invisible tc-btn-dropdown\&quot; selectedClass=\&quot;tc-selected\&quot;&gt;\n{{$:/core/images/info-button}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n\\end\n&lt;table class=\&quot;tc-tag-manager-table\&quot;&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;th&gt;&lt;&lt;lingo Colour/Heading&gt;&gt;&lt;/th&gt;\n&lt;th class=\&quot;tc-tag-manager-tag\&quot;&gt;&lt;&lt;lingo Tag/Heading&gt;&gt;&lt;/th&gt;\n&lt;th&gt;&lt;&lt;lingo Icon/Heading&gt;&gt;&lt;/th&gt;\n&lt;th&gt;&lt;&lt;lingo Info/Heading&gt;&gt;&lt;/th&gt;\n&lt;/tr&gt;\n&lt;$list filter=\&quot;[tags[]!is[system]sort[title]]\&quot;&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;$edit-text field=\&quot;color\&quot; tag=\&quot;input\&quot; type=\&quot;color\&quot;/&gt;&lt;/td&gt;\n&lt;td&gt;&lt;$transclude tiddler=\&quot;$:/core/ui/TagTemplate\&quot;/&gt;&lt;/td&gt;\n&lt;td&gt;\n&lt;$macrocall $name=\&quot;iconEditor\&quot; title={{!!title}}/&gt;\n&lt;/td&gt;\n&lt;td&gt;\n&lt;$macrocall $name=\&quot;toggleButton\&quot; state=&lt;&lt;qualifyTitle \&quot;$:/state/tag-manager/\&quot;&gt;&gt; /&gt; \n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;/td&gt;\n&lt;td&gt;\n&lt;$reveal state=&lt;&lt;qualifyTitle \&quot;$:/state/tag-manager/\&quot;&gt;&gt; type=\&quot;match\&quot; text=\&quot;open\&quot; default=\&quot;\&quot;&gt;\n&lt;table&gt;\n&lt;tbody&gt;\n&lt;tr&gt;&lt;td&gt;&lt;&lt;lingo Colour/Heading&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;$edit-text field=\&quot;color\&quot; tag=\&quot;input\&quot; type=\&quot;text\&quot; size=\&quot;9\&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td&gt;&lt;&lt;lingo Icon/Heading&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;$edit-text field=\&quot;icon\&quot; tag=\&quot;input\&quot; size=\&quot;45\&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;/$reveal&gt;\n&lt;/td&gt;\n&lt;td&gt;&lt;/td&gt;\n&lt;td&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/$list&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&quot;
        },
        &quot;$:/core/ui/TagTemplate&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TagTemplate&quot;,
            &quot;text&quot;: &quot;\\define tag-styles()\nbackground-color:$(backgroundColor)$;\nfill:$(foregroundColor)$;\ncolor:$(foregroundColor)$;\n\\end\n\n\\define tag-body-inner(colour,fallbackTarget,colourA,colourB)\n&lt;$set name=\&quot;foregroundColor\&quot; value=&lt;&lt;contrastcolour target:\&quot;\&quot;\&quot;$colour$\&quot;\&quot;\&quot; fallbackTarget:\&quot;\&quot;\&quot;$fallbackTarget$\&quot;\&quot;\&quot; colourA:\&quot;\&quot;\&quot;$colourA$\&quot;\&quot;\&quot; colourB:\&quot;\&quot;\&quot;$colourB$\&quot;\&quot;\&quot;&gt;&gt;&gt;\n&lt;$set name=\&quot;backgroundColor\&quot; value=\&quot;\&quot;\&quot;$colour$\&quot;\&quot;\&quot;&gt;\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/tag\&quot;&gt;&gt; class=\&quot;tc-btn-invisible tc-tag-label\&quot; style=&lt;&lt;tag-styles&gt;&gt;&gt;\n&lt;$transclude tiddler={{!!icon}}/&gt; &lt;$view field=\&quot;title\&quot; format=\&quot;text\&quot; /&gt;\n&lt;/$button&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/tag\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;below\&quot; animate=\&quot;yes\&quot;&gt;&lt;div class=\&quot;tc-drop-down\&quot;&gt;&lt;$transclude tiddler=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&lt;hr&gt;\n&lt;$list filter=\&quot;[all[current]tagging[]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;\n&lt;/$set&gt;\n&lt;/$set&gt;\n\\end\n\n\\define tag-body(colour,palette)\n&lt;span class=\&quot;tc-tag-list-item\&quot;&gt;\n&lt;$macrocall $name=\&quot;tag-body-inner\&quot; colour=\&quot;\&quot;\&quot;$colour$\&quot;\&quot;\&quot; fallbackTarget={{$palette$##tag-background}} colourA={{$palette$##foreground}} colourB={{$palette$##background}}/&gt;\n&lt;/span&gt;\n\\end\n\n&lt;$macrocall $name=\&quot;tag-body\&quot; colour={{!!color}} palette={{$:/palette}}/&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerFieldTemplate&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerFieldTemplate&quot;,
            &quot;text&quot;: &quot;&lt;tr class=\&quot;tc-view-field\&quot;&gt;\n&lt;td class=\&quot;tc-view-field-name\&quot;&gt;\n&lt;$text text=&lt;&lt;listItem&gt;&gt;/&gt;\n&lt;/td&gt;\n&lt;td class=\&quot;tc-view-field-value\&quot;&gt;\n&lt;$view field=&lt;&lt;listItem&gt;&gt;/&gt;\n&lt;/td&gt;\n&lt;/tr&gt;&quot;
        },
        &quot;$:/core/ui/TiddlerFields&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerFields&quot;,
            &quot;text&quot;: &quot;&lt;table class=\&quot;tc-view-field-table\&quot;&gt;\n&lt;tbody&gt;\n&lt;$list filter=\&quot;[all[current]fields[]sort[title]] -text\&quot; template=\&quot;$:/core/ui/TiddlerFieldTemplate\&quot; variable=\&quot;listItem\&quot;/&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo/Advanced/PluginInfo&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo/Advanced/PluginInfo&quot;,
            &quot;tags&quot;: &quot;$:/tags/TiddlerInfo/Advanced&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/Advanced/PluginInfo/\n&lt;$list filter=\&quot;[all[current]has[plugin-type]]\&quot;&gt;\n\n! &lt;&lt;lingo Heading&gt;&gt;\n\n&lt;&lt;lingo Hint&gt;&gt;\n&lt;ul&gt;\n&lt;$list filter=\&quot;[all[current]plugintiddlers[]sort[title]]\&quot; emptyMessage=&lt;&lt;lingo Empty/Hint&gt;&gt;&gt;\n&lt;li&gt;\n&lt;$link to={{!!title}}&gt;\n&lt;$view field=\&quot;title\&quot;/&gt;\n&lt;/$link&gt;\n&lt;/li&gt;\n&lt;/$list&gt;\n&lt;/ul&gt;\n\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo/Advanced/ShadowInfo&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo/Advanced/ShadowInfo&quot;,
            &quot;tags&quot;: &quot;$:/tags/TiddlerInfo/Advanced&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/Advanced/ShadowInfo/\n&lt;$set name=\&quot;infoTiddler\&quot; value=&lt;&lt;currentTiddler&gt;&gt;&gt;\n\n''&lt;&lt;lingo Heading&gt;&gt;''\n\n&lt;$list filter=\&quot;[all[current]!is[shadow]]\&quot;&gt;\n\n&lt;&lt;lingo NotShadow/Hint&gt;&gt;\n\n&lt;/$list&gt;\n\n&lt;$list filter=\&quot;[all[current]is[shadow]]\&quot;&gt;\n\n&lt;&lt;lingo Shadow/Hint&gt;&gt;\n\n&lt;$list filter=\&quot;[all[current]shadowsource[]]\&quot;&gt;\n\n&lt;$set name=\&quot;pluginTiddler\&quot; value=&lt;&lt;currentTiddler&gt;&gt;&gt;\n&lt;&lt;lingo Shadow/Source&gt;&gt;\n&lt;/$set&gt;\n\n&lt;/$list&gt;\n\n&lt;$list filter=\&quot;[all[current]is[shadow]is[tiddler]]\&quot;&gt;\n\n&lt;&lt;lingo OverriddenShadow/Hint&gt;&gt;\n\n&lt;/$list&gt;\n\n\n&lt;/$list&gt;\n&lt;/$set&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo/Advanced&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo/Advanced&quot;,
            &quot;tags&quot;: &quot;$:/tags/TiddlerInfo&quot;,
            &quot;caption&quot;: &quot;{{$:/language/TiddlerInfo/Advanced/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/TiddlerInfo/Advanced]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt;/&gt;\n\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo/Fields&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo/Fields&quot;,
            &quot;tags&quot;: &quot;$:/tags/TiddlerInfo&quot;,
            &quot;caption&quot;: &quot;{{$:/language/TiddlerInfo/Fields/Caption}}&quot;,
            &quot;text&quot;: &quot;&lt;$transclude tiddler=\&quot;$:/core/ui/TiddlerFields\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo/List&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo/List&quot;,
            &quot;tags&quot;: &quot;$:/tags/TiddlerInfo&quot;,
            &quot;caption&quot;: &quot;{{$:/language/TiddlerInfo/List/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/\n&lt;$list filter=\&quot;[list{!!title}]\&quot; emptyMessage=&lt;&lt;lingo List/Empty&gt;&gt; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo/Listed&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo/Listed&quot;,
            &quot;tags&quot;: &quot;$:/tags/TiddlerInfo&quot;,
            &quot;caption&quot;: &quot;{{$:/language/TiddlerInfo/Listed/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/\n&lt;$list filter=\&quot;[all[current]listed[]!is[system]]\&quot; emptyMessage=&lt;&lt;lingo Listed/Empty&gt;&gt; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo/References&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo/References&quot;,
            &quot;tags&quot;: &quot;$:/tags/TiddlerInfo&quot;,
            &quot;caption&quot;: &quot;{{$:/language/TiddlerInfo/References/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/\n&lt;$list filter=\&quot;[all[current]backlinks[]sort[title]]\&quot; emptyMessage=&lt;&lt;lingo References/Empty&gt;&gt; template=\&quot;$:/core/ui/ListItemTemplate\&quot;&gt;\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo/Tagging&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo/Tagging&quot;,
            &quot;tags&quot;: &quot;$:/tags/TiddlerInfo&quot;,
            &quot;caption&quot;: &quot;{{$:/language/TiddlerInfo/Tagging/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/\n&lt;$list filter=\&quot;[all[current]tagging[]]\&quot; emptyMessage=&lt;&lt;lingo Tagging/Empty&gt;&gt; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo/Tools&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo/Tools&quot;,
            &quot;tags&quot;: &quot;$:/tags/TiddlerInfo&quot;,
            &quot;caption&quot;: &quot;{{$:/language/TiddlerInfo/Tools/Caption}}&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/TiddlerInfo/\n\\define config-title()\n$:/config/ViewToolbarButtons/Visibility/$(listItem)$\n\\end\n&lt;$set name=\&quot;tv-config-toolbar-icons\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-text\&quot; value=\&quot;yes\&quot;&gt;\n\n&lt;$set name=\&quot;tv-config-toolbar-class\&quot; value=\&quot;\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/ViewToolbar]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;\n\n&lt;$checkbox tiddler=&lt;&lt;config-title&gt;&gt; field=\&quot;text\&quot; checked=\&quot;show\&quot; unchecked=\&quot;hide\&quot; default=\&quot;show\&quot;/&gt; &lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt;/&gt; &lt;i class=\&quot;tc-muted\&quot;&gt;&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt; field=\&quot;description\&quot;/&gt;&lt;/i&gt;\n\n&lt;/$list&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n\n&lt;/$set&gt;\n&quot;
        },
        &quot;$:/core/ui/TiddlerInfo&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TiddlerInfo&quot;,
            &quot;text&quot;: &quot;&lt;$macrocall $name=\&quot;tabs\&quot; tabsList=\&quot;[all[shadows+tiddlers]tag[$:/tags/TiddlerInfo]!has[draft.of]]\&quot; default={{$:/config/TiddlerInfo/Default}}/&gt;&quot;
        },
        &quot;$:/core/ui/TopBar/menu&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/TopBar/menu&quot;,
            &quot;tags&quot;: &quot;$:/tags/TopRightBar&quot;,
            &quot;text&quot;: &quot;&lt;$reveal state=\&quot;$:/state/sidebar\&quot; type=\&quot;nomatch\&quot; text=\&quot;no\&quot;&gt;\n&lt;$button set=\&quot;$:/state/sidebar\&quot; setTo=\&quot;no\&quot; tooltip={{$:/language/Buttons/HideSideBar/Hint}} aria-label={{$:/language/Buttons/HideSideBar/Caption}} class=\&quot;tc-btn-invisible\&quot;&gt;{{$:/core/images/chevron-right}}&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal state=\&quot;$:/state/sidebar\&quot; type=\&quot;match\&quot; text=\&quot;no\&quot;&gt;\n&lt;$button set=\&quot;$:/state/sidebar\&quot; setTo=\&quot;yes\&quot; tooltip={{$:/language/Buttons/ShowSideBar/Hint}} aria-label={{$:/language/Buttons/ShowSideBar/Caption}} class=\&quot;tc-btn-invisible\&quot;&gt;{{$:/core/images/chevron-left}}&lt;/$button&gt;\n&lt;/$reveal&gt;\n&quot;
        },
        &quot;$:/core/ui/UntaggedTemplate&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/UntaggedTemplate&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/SideBar/\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/tag\&quot;&gt;&gt; class=\&quot;tc-btn-invisible tc-untagged-label tc-tag-label\&quot;&gt;\n&lt;&lt;lingo Tags/Untagged/Caption&gt;&gt;\n&lt;/$button&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/tag\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;below\&quot;&gt;\n&lt;div class=\&quot;tc-drop-down\&quot;&gt;\n&lt;$list filter=\&quot;[untagged[]!is[system]] -[tags[]] +[sort[title]]\&quot; template=\&quot;$:/core/ui/ListItemTemplate\&quot;/&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;\n&quot;
        },
        &quot;$:/core/ui/ViewTemplate/body&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ViewTemplate/body&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewTemplate&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-tiddler-body\&quot;&gt;\n\n&lt;$list filter=\&quot;[all[current]!has[plugin-type]!field:hide-body[yes]]\&quot;&gt;\n\n&lt;$transclude&gt;\n\n&lt;$transclude tiddler=\&quot;$:/language/MissingTiddler/Hint\&quot;/&gt;\n\n&lt;/$transclude&gt;\n\n&lt;/$list&gt;\n\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/ViewTemplate/classic&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ViewTemplate/classic&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewTemplate $:/tags/EditTemplate&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ClassicWarning/\n&lt;$list filter=\&quot;[all[current]type[text/x-tiddlywiki]]\&quot;&gt;\n&lt;div class=\&quot;tc-message-box\&quot;&gt;\n\n&lt;&lt;lingo Hint&gt;&gt;\n\n&lt;$button set=\&quot;!!type\&quot; setTo=\&quot;text/vnd.tiddlywiki\&quot;&gt;&lt;&lt;lingo Upgrade/Caption&gt;&gt;&lt;/$button&gt;\n\n&lt;/div&gt;\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/ViewTemplate/import&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ViewTemplate/import&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewTemplate&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/Import/\n\n&lt;$list filter=\&quot;[all[current]field:plugin-type[import]]\&quot;&gt;\n\n&lt;div class=\&quot;tc-import\&quot;&gt;\n\n&lt;&lt;lingo Listing/Hint&gt;&gt;\n\n{{||$:/core/ui/ImportListing}}\n\n&lt;$button message=\&quot;tm-delete-tiddler\&quot; param=&lt;&lt;currentTiddler&gt;&gt;&gt;&lt;&lt;lingo Listing/Cancel/Caption&gt;&gt;&lt;/$button&gt;\n&lt;$button message=\&quot;tm-perform-import\&quot; param=&lt;&lt;currentTiddler&gt;&gt;&gt;&lt;&lt;lingo Listing/Import/Caption&gt;&gt;&lt;/$button&gt;\n\n&lt;/div&gt;\n\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/ViewTemplate/plugin&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ViewTemplate/plugin&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewTemplate&quot;,
            &quot;text&quot;: &quot;&lt;$list filter=\&quot;[all[current]has[plugin-type]] -[all[current]field:plugin-type[import]]\&quot;&gt;\n\n{{||$:/core/ui/TiddlerInfo/Advanced/PluginInfo}}\n\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/core/ui/ViewTemplate/subtitle&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ViewTemplate/subtitle&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewTemplate&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-subtitle\&quot;&gt;\n&lt;$link to={{!!modifier}}&gt;\n&lt;$view field=\&quot;modifier\&quot;/&gt;\n&lt;/$link&gt; &lt;$view field=\&quot;modified\&quot; format=\&quot;relativedate\&quot;/&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/ViewTemplate/tags&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ViewTemplate/tags&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewTemplate&quot;,
            &quot;text&quot;: &quot;&lt;div class=\&quot;tc-tags-wrapper\&quot;&gt;&lt;$list filter=\&quot;[all[current]tags[]sort[title]]\&quot; template=\&quot;$:/core/ui/TagTemplate\&quot; storyview=\&quot;pop\&quot;/&gt;&lt;/div&gt;\n&quot;
        },
        &quot;$:/core/ui/ViewTemplate/title&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ViewTemplate/title&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewTemplate&quot;,
            &quot;text&quot;: &quot;\\define title-styles()\nfill:$(foregroundColor)$;\n\\end\n\\define config-title()\n$:/config/ViewToolbarButtons/Visibility/$(listItem)$\n\\end\n&lt;div class=\&quot;tc-tiddler-title\&quot;&gt;\n&lt;div class=\&quot;tc-titlebar\&quot;&gt;\n&lt;span class=\&quot;tc-tiddler-controls\&quot;&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/ViewToolbar]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;config-title&gt;&gt; text=\&quot;hide\&quot;&gt;&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt;/&gt;&lt;/$reveal&gt;&lt;/$list&gt;\n&lt;/span&gt;\n&lt;$set name=\&quot;foregroundColor\&quot; value={{!!color}}&gt;\n&lt;span class=\&quot;tc-tiddler-title-icon\&quot; style=&lt;&lt;title-styles&gt;&gt;&gt;\n&lt;$transclude tiddler={{!!icon}}/&gt;\n&lt;/span&gt;\n&lt;/$set&gt;\n&lt;$list filter=\&quot;[all[current]removeprefix[$:/]]\&quot;&gt;\n&lt;h2 class=\&quot;tc-title\&quot; title={{$:/language/SystemTiddler/Tooltip}}&gt;\n&lt;span class=\&quot;tc-system-title-prefix\&quot;&gt;$:/&lt;/span&gt;&lt;$text text=&lt;&lt;currentTiddler&gt;&gt;/&gt;\n&lt;/h2&gt;\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[all[current]!prefix[$:/]]\&quot;&gt;\n&lt;h2 class=\&quot;tc-title\&quot;&gt;\n&lt;$view field=\&quot;title\&quot;/&gt;\n&lt;/h2&gt;\n&lt;/$list&gt;\n&lt;/div&gt;\n\n&lt;$reveal type=\&quot;nomatch\&quot; text=\&quot;\&quot; default=\&quot;\&quot; state=&lt;&lt;tiddlerInfoState&gt;&gt; class=\&quot;tc-tiddler-info tc-popup-handle\&quot; animate=\&quot;yes\&quot; retain=\&quot;yes\&quot;&gt;\n\n&lt;$transclude tiddler=\&quot;$:/core/ui/TiddlerInfo\&quot;/&gt;\n\n&lt;/$reveal&gt;\n&lt;/div&gt;&quot;
        },
        &quot;$:/core/ui/ViewTemplate&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/ViewTemplate&quot;,
            &quot;text&quot;: &quot;\\define frame-classes()\ntc-tiddler-frame tc-tiddler-view-frame $(missingTiddlerClass)$ $(shadowTiddlerClass)$ $(systemTiddlerClass)$ $(tiddlerTagClasses)$\n\\end\n&lt;$set name=\&quot;storyTiddler\&quot; value=&lt;&lt;currentTiddler&gt;&gt;&gt;&lt;$set name=\&quot;tiddlerInfoState\&quot; value=&lt;&lt;qualify \&quot;$:/state/popup/tiddler-info\&quot;&gt;&gt;&gt;&lt;$tiddler tiddler=&lt;&lt;currentTiddler&gt;&gt;&gt;&lt;div class=&lt;&lt;frame-classes&gt;&gt;&gt;&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/ViewTemplate]!has[draft.of]]\&quot; variable=\&quot;listItem\&quot;&gt;&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt;/&gt;&lt;/$list&gt;\n&lt;/div&gt;\n&lt;/$tiddler&gt;&lt;/$set&gt;&lt;/$set&gt;\n&quot;
        },
        &quot;$:/core/ui/Buttons/clone&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/clone&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/clone-button}} {{$:/language/Buttons/Clone/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Clone/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-new-tiddler\&quot; param=&lt;&lt;currentTiddler&gt;&gt; tooltip={{$:/language/Buttons/Clone/Hint}} aria-label={{$:/language/Buttons/Clone/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/clone-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Clone/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/close-others&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/close-others&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/close-others-button}} {{$:/language/Buttons/CloseOthers/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/CloseOthers/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-close-other-tiddlers\&quot; param=&lt;&lt;currentTiddler&gt;&gt; tooltip={{$:/language/Buttons/CloseOthers/Hint}} aria-label={{$:/language/Buttons/CloseOthers/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/close-others-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/CloseOthers/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/close&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/close&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/close-button}} {{$:/language/Buttons/Close/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Close/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-close-tiddler\&quot; tooltip={{$:/language/Buttons/Close/Hint}} aria-label={{$:/language/Buttons/Close/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/close-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Close/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/edit&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/edit&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/edit-button}} {{$:/language/Buttons/Edit/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Edit/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-edit-tiddler\&quot; tooltip={{$:/language/Buttons/Edit/Hint}} aria-label={{$:/language/Buttons/Edit/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/edit-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Edit/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/export-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/export-tiddler&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/export-button}} {{$:/language/Buttons/ExportTiddler/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/ExportTiddler/Hint}}&quot;,
            &quot;text&quot;: &quot;\\define makeExportFilter()\n[[$(currentTiddler)$]]\n\\end\n&lt;$macrocall $name=\&quot;exportButton\&quot; exportFilter=&lt;&lt;makeExportFilter&gt;&gt; lingoBase=\&quot;$:/language/Buttons/ExportTiddler/\&quot; baseFilename=&lt;&lt;currentTiddler&gt;&gt;/&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/info&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/info&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/info-button}} {{$:/language/Buttons/Info/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Info/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button popup=&lt;&lt;tiddlerInfoState&gt;&gt; tooltip={{$:/language/Buttons/Info/Hint}} aria-label={{$:/language/Buttons/Info/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt; selectedClass=\&quot;tc-selected\&quot;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/info-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Info/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/more-tiddler-actions&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/more-tiddler-actions&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/down-arrow}} {{$:/language/Buttons/More/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/More/Hint}}&quot;,
            &quot;text&quot;: &quot;\\define config-title()\n$:/config/ViewToolbarButtons/Visibility/$(listItem)$\n\\end\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/more\&quot;&gt;&gt; tooltip={{$:/language/Buttons/More/Hint}} aria-label={{$:/language/Buttons/More/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt; selectedClass=\&quot;tc-selected\&quot;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/down-arrow}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/More/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/more\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;below\&quot; animate=\&quot;yes\&quot;&gt;\n&lt;div class=\&quot;tc-drop-down\&quot;&gt;\n&lt;$set name=\&quot;tv-config-toolbar-icons\&quot; value=\&quot;yes\&quot;&gt;\n&lt;$set name=\&quot;tv-config-toolbar-text\&quot; value=\&quot;yes\&quot;&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/ViewToolbar]!has[draft.of]] -[[$:/core/ui/Buttons/more-tiddler-actions]]\&quot; variable=\&quot;listItem\&quot;&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;config-title&gt;&gt; text=\&quot;hide\&quot;&gt;\n&lt;$transclude tiddler=&lt;&lt;listItem&gt;&gt;/&gt;\n&lt;/$reveal&gt;\n&lt;/$list&gt;\n&lt;/$set&gt;\n&lt;/$set&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/new-here&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/new-here&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/new-here-button}} {{$:/language/Buttons/NewHere/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/NewHere/Hint}}&quot;,
            &quot;text&quot;: &quot;\\define newHereButtonTags()\n[[$(currentTiddler)$]]\n\\end\n\\define newHereButton()\n&lt;$button tooltip={{$:/language/Buttons/NewHere/Hint}} aria-label={{$:/language/Buttons/NewHere/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$action-sendmessage $message=\&quot;tm-new-tiddler\&quot; tags=&lt;&lt;newHereButtonTags&gt;&gt;/&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/new-here-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/NewHere/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n\\end\n&lt;&lt;newHereButton&gt;&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/new-journal-here&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/new-journal-here&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/new-journal-button}} {{$:/language/Buttons/NewJournalHere/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/NewJournalHere/Hint}}&quot;,
            &quot;text&quot;: &quot;\\define journalButtonTags()\n[[$(currentTiddlerTag)$]] $(journalTags)$\n\\end\n\\define journalButton()\n&lt;$button tooltip={{$:/language/Buttons/NewJournalHere/Hint}} aria-label={{$:/language/Buttons/NewJournalHere/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$action-sendmessage $message=\&quot;tm-new-tiddler\&quot; title=&lt;&lt;now \&quot;$(journalTitleTemplate)$\&quot;&gt;&gt; tags=&lt;&lt;journalButtonTags&gt;&gt;/&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/new-journal-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/NewJournalHere/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n\\end\n&lt;$set name=\&quot;journalTitleTemplate\&quot; value={{$:/config/NewJournal/Title}}&gt;\n&lt;$set name=\&quot;journalTags\&quot; value={{$:/config/NewJournal/Tags}}&gt;\n&lt;$set name=\&quot;currentTiddlerTag\&quot; value=&lt;&lt;currentTiddler&gt;&gt;&gt;\n&lt;&lt;journalButton&gt;&gt;\n&lt;/$set&gt;&lt;/$set&gt;&lt;/$set&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/permalink&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/permalink&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/permalink-button}} {{$:/language/Buttons/Permalink/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Permalink/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-permalink\&quot; tooltip={{$:/language/Buttons/Permalink/Hint}} aria-label={{$:/language/Buttons/Permalink/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/permalink-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Permalink/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/core/ui/Buttons/permaview&quot;: {
            &quot;title&quot;: &quot;$:/core/ui/Buttons/permaview&quot;,
            &quot;tags&quot;: &quot;$:/tags/ViewToolbar $:/tags/PageControls&quot;,
            &quot;caption&quot;: &quot;{{$:/core/images/permaview-button}} {{$:/language/Buttons/Permaview/Caption}}&quot;,
            &quot;description&quot;: &quot;{{$:/language/Buttons/Permaview/Hint}}&quot;,
            &quot;text&quot;: &quot;&lt;$button message=\&quot;tm-permaview\&quot; tooltip={{$:/language/Buttons/Permaview/Hint}} aria-label={{$:/language/Buttons/Permaview/Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/permaview-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$:/language/Buttons/Permaview/Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;&quot;
        },
        &quot;$:/DefaultTiddlers&quot;: {
            &quot;title&quot;: &quot;$:/DefaultTiddlers&quot;,
            &quot;text&quot;: &quot;GettingStarted\n&quot;
        },
        &quot;$:/temp/advancedsearch&quot;: {
            &quot;title&quot;: &quot;$:/temp/advancedsearch&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/snippets/allfields&quot;: {
            &quot;title&quot;: &quot;$:/snippets/allfields&quot;,
            &quot;text&quot;: &quot;\\define renderfield(title)\n&lt;tr class=\&quot;tc-view-field\&quot;&gt;&lt;td class=\&quot;tc-view-field-name\&quot;&gt;''$title$'':&lt;/td&gt;&lt;td class=\&quot;tc-view-field-value\&quot;&gt;//{{$:/language/Docs/Fields/$title$}}//&lt;/td&gt;&lt;/tr&gt;\n\\end\n&lt;table class=\&quot;tc-view-field-table\&quot;&gt;&lt;tbody&gt;&lt;$list filter=\&quot;[fields[]sort[title]]\&quot; variable=\&quot;listItem\&quot;&gt;&lt;$macrocall $name=\&quot;renderfield\&quot; title=&lt;&lt;listItem&gt;&gt;/&gt;&lt;/$list&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n&quot;
        },
        &quot;$:/config/AnimationDuration&quot;: {
            &quot;title&quot;: &quot;$:/config/AnimationDuration&quot;,
            &quot;text&quot;: &quot;400&quot;
        },
        &quot;$:/config/AutoSave&quot;: {
            &quot;title&quot;: &quot;$:/config/AutoSave&quot;,
            &quot;text&quot;: &quot;yes&quot;
        },
        &quot;$:/config/BitmapEditor/Colour&quot;: {
            &quot;title&quot;: &quot;$:/config/BitmapEditor/Colour&quot;,
            &quot;text&quot;: &quot;#ff0&quot;
        },
        &quot;$:/config/BitmapEditor/LineWidth&quot;: {
            &quot;title&quot;: &quot;$:/config/BitmapEditor/LineWidth&quot;,
            &quot;text&quot;: &quot;3&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/title&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/title&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/tags&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/tags&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/text&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/text&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/creator&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/creator&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/created&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/created&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/modified&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/modified&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/modifier&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/modifier&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/type&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/type&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/draft.title&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/draft.title&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/draft.of&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/draft.of&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/revision&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/revision&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditTemplateFields/Visibility/bag&quot;: {
            &quot;title&quot;: &quot;$:/config/EditTemplateFields/Visibility/bag&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/EditorTypeMappings/image/gif&quot;: {
            &quot;title&quot;: &quot;$:/config/EditorTypeMappings/image/gif&quot;,
            &quot;text&quot;: &quot;bitmap&quot;
        },
        &quot;$:/config/EditorTypeMappings/image/jpeg&quot;: {
            &quot;title&quot;: &quot;$:/config/EditorTypeMappings/image/jpeg&quot;,
            &quot;text&quot;: &quot;bitmap&quot;
        },
        &quot;$:/config/EditorTypeMappings/image/jpg&quot;: {
            &quot;title&quot;: &quot;$:/config/EditorTypeMappings/image/jpg&quot;,
            &quot;text&quot;: &quot;bitmap&quot;
        },
        &quot;$:/config/EditorTypeMappings/image/png&quot;: {
            &quot;title&quot;: &quot;$:/config/EditorTypeMappings/image/png&quot;,
            &quot;text&quot;: &quot;bitmap&quot;
        },
        &quot;$:/config/EditorTypeMappings/image/x-icon&quot;: {
            &quot;title&quot;: &quot;$:/config/EditorTypeMappings/image/x-icon&quot;,
            &quot;text&quot;: &quot;bitmap&quot;
        },
        &quot;$:/config/EditorTypeMappings/text/vnd.tiddlywiki&quot;: {
            &quot;title&quot;: &quot;$:/config/EditorTypeMappings/text/vnd.tiddlywiki&quot;,
            &quot;text&quot;: &quot;text&quot;
        },
        &quot;$:/config/Navigation/UpdateAddressBar&quot;: {
            &quot;title&quot;: &quot;$:/config/Navigation/UpdateAddressBar&quot;,
            &quot;text&quot;: &quot;no&quot;
        },
        &quot;$:/config/Navigation/UpdateHistory&quot;: {
            &quot;title&quot;: &quot;$:/config/Navigation/UpdateHistory&quot;,
            &quot;text&quot;: &quot;no&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/advanced-search&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/advanced-search&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/close-all&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/close-all&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/encryption&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/encryption&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/export-page&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/export-page&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/full-screen&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/full-screen&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/home&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/home&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/refresh&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/refresh&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/import&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/import&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/language&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/language&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/tag-manager&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/tag-manager&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/more-page-actions&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/more-page-actions&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/new-journal&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/new-journal&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/permaview&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/permaview&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/storyview&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/storyview&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/theme&quot;: {
            &quot;title&quot;: &quot;$:/config/PageControlButtons/Visibility/$:/core/ui/Buttons/theme&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/SaveWikiButton/Template&quot;: {
            &quot;title&quot;: &quot;$:/config/SaveWikiButton/Template&quot;,
            &quot;text&quot;: &quot;$:/core/save/all&quot;
        },
        &quot;$:/config/SaverFilter&quot;: {
            &quot;title&quot;: &quot;$:/config/SaverFilter&quot;,
            &quot;text&quot;: &quot;[all[]] -[[$:/HistoryList]] -[[$:/StoryList]] -[[$:/Import]] -[[$:/isEncrypted]] -[[$:/UploadName]] -[prefix[$:/state]] -[prefix[$:/temp]]&quot;
        },
        &quot;$:/config/SearchResults/Default&quot;: {
            &quot;title&quot;: &quot;$:/config/SearchResults/Default&quot;,
            &quot;text&quot;: &quot;$:/core/ui/DefaultSearchResultList&quot;
        },
        &quot;$:/config/SyncFilter&quot;: {
            &quot;title&quot;: &quot;$:/config/SyncFilter&quot;,
            &quot;text&quot;: &quot;[is[tiddler]] -[[$:/HistoryList]] -[[$:/StoryList]] -[[$:/Import]] -[[$:/isEncrypted]] -[prefix[$:/status]] -[prefix[$:/state]] -[prefix[$:/temp]]&quot;
        },
        &quot;$:/config/TiddlerInfo/Default&quot;: {
            &quot;title&quot;: &quot;$:/config/TiddlerInfo/Default&quot;,
            &quot;text&quot;: &quot;$:/core/ui/TiddlerInfo/Fields&quot;
        },
        &quot;$:/config/Toolbar/Icons&quot;: {
            &quot;title&quot;: &quot;$:/config/Toolbar/Icons&quot;,
            &quot;text&quot;: &quot;yes&quot;
        },
        &quot;$:/config/Toolbar/Text&quot;: {
            &quot;title&quot;: &quot;$:/config/Toolbar/Text&quot;,
            &quot;text&quot;: &quot;no&quot;
        },
        &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/clone&quot;: {
            &quot;title&quot;: &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/clone&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/close-others&quot;: {
            &quot;title&quot;: &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/close-others&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/export-tiddler&quot;: {
            &quot;title&quot;: &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/export-tiddler&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/info&quot;: {
            &quot;title&quot;: &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/info&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/more-tiddler-actions&quot;: {
            &quot;title&quot;: &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/more-tiddler-actions&quot;,
            &quot;text&quot;: &quot;show&quot;
        },
        &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/new-here&quot;: {
            &quot;title&quot;: &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/new-here&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/new-journal-here&quot;: {
            &quot;title&quot;: &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/new-journal-here&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/permalink&quot;: {
            &quot;title&quot;: &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/permalink&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/permaview&quot;: {
            &quot;title&quot;: &quot;$:/config/ViewToolbarButtons/Visibility/$:/core/ui/Buttons/permaview&quot;,
            &quot;text&quot;: &quot;hide&quot;
        },
        &quot;$:/snippets/currpalettepreview&quot;: {
            &quot;title&quot;: &quot;$:/snippets/currpalettepreview&quot;,
            &quot;text&quot;: &quot;\\define swatchStyle()\nbackground-color: $(swatchColour)$;\n\\end\n\\define swatch(colour)\n&lt;$set name=\&quot;swatchColour\&quot; value={{##$colour$}}&gt;\n&lt;div class=\&quot;tc-swatch\&quot; style=&lt;&lt;swatchStyle&gt;&gt;/&gt;\n&lt;/$set&gt;\n\\end\n&lt;div class=\&quot;tc-swatches-horiz\&quot;&gt;\n&lt;&lt;swatch foreground&gt;&gt;\n&lt;&lt;swatch background&gt;&gt;\n&lt;&lt;swatch muted-foreground&gt;&gt;\n&lt;&lt;swatch primary&gt;&gt;\n&lt;&lt;swatch page-background&gt;&gt;\n&lt;&lt;swatch tab-background&gt;&gt;\n&lt;&lt;swatch tiddler-info-background&gt;&gt;\n&lt;/div&gt;\n&quot;
        },
        &quot;$:/snippets/download-wiki-button&quot;: {
            &quot;title&quot;: &quot;$:/snippets/download-wiki-button&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Tools/Download/\n&lt;$button class=\&quot;tc-btn-big-green\&quot;&gt;\n&lt;$action-sendmessage $message=\&quot;tm-download-file\&quot; $param=\&quot;$:/core/save/all\&quot; filename=\&quot;index.html\&quot;/&gt;\n&lt;&lt;lingo Full/Caption&gt;&gt; {{$:/core/images/save-button}}\n&lt;/$button&gt;&quot;
        },
        &quot;$:/language&quot;: {
            &quot;title&quot;: &quot;$:/language&quot;,
            &quot;text&quot;: &quot;$:/languages/en-GB&quot;
        },
        &quot;$:/snippets/languageswitcher&quot;: {
            &quot;title&quot;: &quot;$:/snippets/languageswitcher&quot;,
            &quot;text&quot;: &quot;{{$:/language/ControlPanel/Basics/Language/Prompt}} &lt;$select tiddler=\&quot;$:/language\&quot;&gt;\n&lt;$list filter=\&quot;[[$:/languages/en-GB]] [plugin-type[language]sort[description]]\&quot;&gt;\n&lt;option value=&lt;&lt;currentTiddler&gt;&gt;&gt;&lt;$view field=\&quot;description\&quot;&gt;&lt;$view field=\&quot;name\&quot;&gt;&lt;$view field=\&quot;title\&quot;/&gt;&lt;/$view&gt;&lt;/$view&gt;&lt;/option&gt;\n&lt;/$list&gt;\n&lt;/$select&gt;&quot;
        },
        &quot;$:/core/macros/CSS&quot;: {
            &quot;title&quot;: &quot;$:/core/macros/CSS&quot;,
            &quot;tags&quot;: &quot;$:/tags/Macro&quot;,
            &quot;text&quot;: &quot;\\define colour(name)\n&lt;$transclude tiddler={{$:/palette}} index=\&quot;$name$\&quot;&gt;&lt;$transclude tiddler=\&quot;$:/palettes/Vanilla\&quot; index=\&quot;$name$\&quot;/&gt;&lt;/$transclude&gt;\n\\end\n\n\\define color(name)\n&lt;&lt;colour $name$&gt;&gt;\n\\end\n\n\\define box-shadow(shadow)\n``\n  -webkit-box-shadow: $shadow$;\n     -moz-box-shadow: $shadow$;\n          box-shadow: $shadow$;\n``\n\\end\n\n\\define filter(filter)\n``\n  -webkit-filter: $filter$;\n     -moz-filter: $filter$;\n          filter: $filter$;\n``\n\\end\n\n\\define transition(transition)\n``\n  -webkit-transition: $transition$;\n     -moz-transition: $transition$;\n          transition: $transition$;\n``\n\\end\n\n\\define transform-origin(origin)\n``\n  -webkit-transform-origin: $origin$;\n     -moz-transform-origin: $origin$;\n          transform-origin: $origin$;\n``\n\\end\n\n\\define background-linear-gradient(gradient)\n``\nbackground-image: linear-gradient($gradient$);\nbackground-image: -o-linear-gradient($gradient$);\nbackground-image: -moz-linear-gradient($gradient$);\nbackground-image: -webkit-linear-gradient($gradient$);\nbackground-image: -ms-linear-gradient($gradient$);\n``\n\\end\n\n\\define datauri(title)\n&lt;$macrocall $name=\&quot;makedatauri\&quot; type={{$title$!!type}} text={{$title$}}/&gt;\n\\end\n\n\\define if-sidebar(text)\n&lt;$reveal state=\&quot;$:/state/sidebar\&quot; type=\&quot;match\&quot; text=\&quot;yes\&quot; default=\&quot;yes\&quot;&gt;$text$&lt;/$reveal&gt;\n\\end\n\n\\define if-no-sidebar(text)\n&lt;$reveal state=\&quot;$:/state/sidebar\&quot; type=\&quot;nomatch\&quot; text=\&quot;yes\&quot; default=\&quot;yes\&quot;&gt;$text$&lt;/$reveal&gt;\n\\end\n&quot;
        },
        &quot;$:/core/macros/export&quot;: {
            &quot;title&quot;: &quot;$:/core/macros/export&quot;,
            &quot;tags&quot;: &quot;$:/tags/Macro&quot;,
            &quot;text&quot;: &quot;\\define exportButtonFilename(baseFilename)\n$baseFilename$$(extension)$\n\\end\n\n\\define exportButton(exportFilter:\&quot;[!is[system]sort[title]]\&quot;,lingoBase,baseFilename:\&quot;tiddlers\&quot;)\n&lt;span class=\&quot;tc-popup-keep\&quot;&gt;\n&lt;$button popup=&lt;&lt;qualify \&quot;$:/state/popup/export\&quot;&gt;&gt; tooltip={{$lingoBase$Hint}} aria-label={{$lingoBase$Caption}} class=&lt;&lt;tv-config-toolbar-class&gt;&gt; selectedClass=\&quot;tc-selected\&quot;&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-icons&gt;prefix[yes]]\&quot;&gt;\n{{$:/core/images/export-button}}\n&lt;/$list&gt;\n&lt;$list filter=\&quot;[&lt;tv-config-toolbar-text&gt;prefix[yes]]\&quot;&gt;\n&lt;span class=\&quot;tc-btn-text\&quot;&gt;&lt;$text text={{$lingoBase$Caption}}/&gt;&lt;/span&gt;\n&lt;/$list&gt;\n&lt;/$button&gt;\n&lt;/span&gt;\n&lt;$reveal state=&lt;&lt;qualify \&quot;$:/state/popup/export\&quot;&gt;&gt; type=\&quot;popup\&quot; position=\&quot;below\&quot; animate=\&quot;yes\&quot;&gt;\n&lt;div class=\&quot;tc-drop-down\&quot;&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/Exporter]]\&quot;&gt;\n&lt;$set name=\&quot;extension\&quot; value={{!!extension}}&gt;\n&lt;$button class=\&quot;tc-btn-invisible\&quot;&gt;\n&lt;$action-sendmessage $message=\&quot;tm-download-file\&quot; $param=&lt;&lt;currentTiddler&gt;&gt; exportFilter=\&quot;\&quot;\&quot;$exportFilter$\&quot;\&quot;\&quot; filename=&lt;&lt;exportButtonFilename \&quot;\&quot;\&quot;$baseFilename$\&quot;\&quot;\&quot;&gt;&gt;/&gt;\n&lt;$action-deletetiddler $tiddler=&lt;&lt;qualify \&quot;$:/state/popup/export\&quot;&gt;&gt;/&gt;\n&lt;$transclude field=\&quot;description\&quot;/&gt;\n&lt;/$button&gt;\n&lt;/$set&gt;\n&lt;/$list&gt;\n&lt;/div&gt;\n&lt;/$reveal&gt;\n\\end\n&quot;
        },
        &quot;$:/core/macros/lingo&quot;: {
            &quot;title&quot;: &quot;$:/core/macros/lingo&quot;,
            &quot;tags&quot;: &quot;$:/tags/Macro&quot;,
            &quot;text&quot;: &quot;\\define lingo-base()\n$:/language/\n\\end\n\n\\define lingo(title)\n{{$(lingo-base)$$title$}}\n\\end\n&quot;
        },
        &quot;$:/core/macros/list&quot;: {
            &quot;title&quot;: &quot;$:/core/macros/list&quot;,
            &quot;tags&quot;: &quot;$:/tags/Macro&quot;,
            &quot;text&quot;: &quot;\\define list-links(filter,type:\&quot;ul\&quot;,subtype:\&quot;li\&quot;,class:\&quot;\&quot;)\n&lt;$type$ class=\&quot;$class$\&quot;&gt;\n&lt;$list filter=\&quot;$filter$\&quot;&gt;\n&lt;$subtype$&gt;\n&lt;$link to={{!!title}}&gt;\n&lt;$transclude field=\&quot;caption\&quot;&gt;\n&lt;$view field=\&quot;title\&quot;/&gt;\n&lt;/$transclude&gt;\n&lt;/$link&gt;\n&lt;/$subtype$&gt;\n&lt;/$list&gt;\n&lt;/$type$&gt;\n\\end\n&quot;
        },
        &quot;$:/core/macros/tabs&quot;: {
            &quot;title&quot;: &quot;$:/core/macros/tabs&quot;,
            &quot;tags&quot;: &quot;$:/tags/Macro&quot;,
            &quot;text&quot;: &quot;\\define tabs(tabsList,default,state:\&quot;$:/state/tab\&quot;,class,template)\n&lt;div class=\&quot;tc-tab-set $class$\&quot;&gt;\n&lt;div class=\&quot;tc-tab-buttons $class$\&quot;&gt;\n&lt;$list filter=\&quot;$tabsList$\&quot; variable=\&quot;currentTab\&quot;&gt;\n&lt;$button set=&lt;&lt;qualify \&quot;$state$\&quot;&gt;&gt; setTo=&lt;&lt;currentTab&gt;&gt; default=\&quot;$default$\&quot; selectedClass=\&quot;tc-tab-selected\&quot;&gt;\n&lt;$transclude tiddler=&lt;&lt;currentTab&gt;&gt; field=\&quot;caption\&quot;&gt;\n&lt;$macrocall $name=\&quot;currentTab\&quot; $type=\&quot;text/plain\&quot; $output=\&quot;text/plain\&quot;/&gt;\n&lt;/$transclude&gt;\n&lt;/$button&gt;\n&lt;/$list&gt;\n&lt;/div&gt;&lt;div class=\&quot;tc-tab-divider $class$\&quot;/&gt;&lt;div class=\&quot;tc-tab-content $class$\&quot;&gt;\n&lt;$list filter=\&quot;$tabsList$\&quot; variable=\&quot;currentTab\&quot;&gt;\n\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;qualify \&quot;$state$\&quot;&gt;&gt; text=&lt;&lt;currentTab&gt;&gt; default=\&quot;$default$\&quot;&gt;\n\n&lt;$transclude tiddler=\&quot;$template$\&quot; mode=\&quot;block\&quot;&gt;\n\n&lt;$transclude tiddler=&lt;&lt;currentTab&gt;&gt; mode=\&quot;block\&quot;/&gt;\n\n&lt;/$transclude&gt;\n\n&lt;/$reveal&gt;\n\n&lt;/$list&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n\\end\n&quot;
        },
        &quot;$:/core/macros/tag&quot;: {
            &quot;title&quot;: &quot;$:/core/macros/tag&quot;,
            &quot;tags&quot;: &quot;$:/tags/Macro&quot;,
            &quot;text&quot;: &quot;\\define tag(tag)\n{{$tag$||$:/core/ui/TagTemplate}}\n\\end\n&quot;
        },
        &quot;$:/core/macros/timeline&quot;: {
            &quot;created&quot;: &quot;20141212105914482&quot;,
            &quot;modified&quot;: &quot;20141212110330815&quot;,
            &quot;tags&quot;: &quot;$:/tags/Macro&quot;,
            &quot;title&quot;: &quot;$:/core/macros/timeline&quot;,
            &quot;type&quot;: &quot;text/vnd.tiddlywiki&quot;,
            &quot;text&quot;: &quot;\\define timeline-title()\n&lt;!-- Override this macro with a global macro \n     of the same name if you need to change \n     how titles are displayed on the timeline \n     --&gt;\n&lt;$view field=\&quot;title\&quot;/&gt;\n\\end\n\\define timeline(limit:\&quot;100\&quot;,format:\&quot;DDth MMM YYYY\&quot;,subfilter:\&quot;\&quot;,dateField:\&quot;modified\&quot;)\n&lt;div class=\&quot;tc-timeline\&quot;&gt;\n&lt;$list filter=\&quot;[!is[system]$subfilter$has[$dateField$]!sort[$dateField$]limit[$limit$]eachday[$dateField$]]\&quot;&gt;\n&lt;div class=\&quot;tc-menu-list-item\&quot;&gt;\n&lt;$view field=\&quot;$dateField$\&quot; format=\&quot;date\&quot; template=\&quot;$format$\&quot;/&gt;\n&lt;$list filter=\&quot;[sameday{!!$dateField$}!is[system]$subfilter$!sort[$dateField$]]\&quot;&gt;\n&lt;div class=\&quot;tc-menu-list-subitem\&quot;&gt;\n&lt;$link to={{!!title}}&gt;\n&lt;&lt;timeline-title&gt;&gt;\n&lt;/$link&gt;\n&lt;/div&gt;\n&lt;/$list&gt;\n&lt;/div&gt;\n&lt;/$list&gt;\n&lt;/div&gt;\n\\end\n&quot;
        },
        &quot;$:/core/macros/toc&quot;: {
            &quot;title&quot;: &quot;$:/core/macros/toc&quot;,
            &quot;tags&quot;: &quot;$:/tags/Macro&quot;,
            &quot;text&quot;: &quot;\\define toc-caption()\n&lt;$set name=\&quot;tv-wikilinks\&quot; value=\&quot;no\&quot;&gt;\n&lt;$transclude field=\&quot;caption\&quot;&gt;\n&lt;$view field=\&quot;title\&quot;/&gt;\n&lt;/$transclude&gt;\n&lt;/$set&gt;\n\\end\n\n\\define toc-body(rootTag,tag,sort:\&quot;\&quot;,itemClassFilter)\n&lt;ol class=\&quot;tc-toc\&quot;&gt;\n&lt;$list filter=\&quot;\&quot;\&quot;[all[shadows+tiddlers]tag[$tag$]!has[draft.of]$sort$]\&quot;\&quot;\&quot;&gt;\n&lt;$set name=\&quot;toc-item-class\&quot; filter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot; value=\&quot;toc-item-selected\&quot; emptyValue=\&quot;toc-item\&quot;&gt;\n&lt;li class=&lt;&lt;toc-item-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[all[current]toc-link[no]]\&quot; emptyMessage=\&quot;&lt;$link&gt;&lt;$view field='caption'&gt;&lt;$view field='title'/&gt;&lt;/$view&gt;&lt;/$link&gt;\&quot;&gt;\n&lt;&lt;toc-caption&gt;&gt;\n&lt;/$list&gt;\n&lt;$list filter=\&quot;\&quot;\&quot;[all[current]] -[[$rootTag$]]\&quot;\&quot;\&quot;&gt;\n&lt;$macrocall $name=\&quot;toc-body\&quot; rootTag=\&quot;\&quot;\&quot;$rootTag$\&quot;\&quot;\&quot; tag=&lt;&lt;currentTiddler&gt;&gt; sort=\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; itemClassFilter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot;/&gt;\n&lt;/$list&gt;\n&lt;/li&gt;\n&lt;/$set&gt;\n&lt;/$list&gt;\n&lt;/ol&gt;\n\\end\n\n\\define toc(tag,sort:\&quot;\&quot;,itemClassFilter)\n&lt;&lt;toc-body rootTag:\&quot;\&quot;\&quot;$tag$\&quot;\&quot;\&quot; tag:\&quot;\&quot;\&quot;$tag$\&quot;\&quot;\&quot; sort:\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; itemClassFilter:\&quot;\&quot;\&quot;itemClassFilter\&quot;\&quot;\&quot;&gt;&gt;\n\\end\n\n\\define toc-linked-expandable-body(tag,sort:\&quot;\&quot;,itemClassFilter)\n&lt;$set name=\&quot;toc-state\&quot; value=&lt;&lt;qualify \&quot;$:/state/toc/$tag$-$(currentTiddler)$\&quot;&gt;&gt;&gt;\n&lt;$set name=\&quot;toc-item-class\&quot; filter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot; value=\&quot;toc-item-selected\&quot; emptyValue=\&quot;toc-item\&quot;&gt;\n&lt;li class=&lt;&lt;toc-item-class&gt;&gt;&gt;\n&lt;$link&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$button set=&lt;&lt;toc-state&gt;&gt; setTo=\&quot;open\&quot; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/right-arrow}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$button set=&lt;&lt;toc-state&gt;&gt; setTo=\&quot;close\&quot; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/down-arrow}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;&lt;toc-caption&gt;&gt;\n&lt;/$link&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$macrocall $name=\&quot;toc-expandable\&quot; tag=&lt;&lt;currentTiddler&gt;&gt; sort=\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; itemClassFilter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot;/&gt;\n&lt;/$reveal&gt;\n&lt;/li&gt;\n&lt;/$set&gt;\n&lt;/$set&gt;\n\\end\n\n\\define toc-unlinked-expandable-body(tag,sort:\&quot;\&quot;,itemClassFilter)\n&lt;$set name=\&quot;toc-state\&quot; value=&lt;&lt;qualify \&quot;$:/state/toc/$tag$-$(currentTiddler)$\&quot;&gt;&gt;&gt;\n&lt;$set name=\&quot;toc-item-class\&quot; filter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot; value=\&quot;toc-item-selected\&quot; emptyValue=\&quot;toc-item\&quot;&gt;\n&lt;li class=&lt;&lt;toc-item-class&gt;&gt;&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$button set=&lt;&lt;toc-state&gt;&gt; setTo=\&quot;open\&quot; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/right-arrow}}\n&lt;&lt;toc-caption&gt;&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$button set=&lt;&lt;toc-state&gt;&gt; setTo=\&quot;close\&quot; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/down-arrow}}\n&lt;&lt;toc-caption&gt;&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$macrocall $name=\&quot;toc-expandable\&quot; tag=&lt;&lt;currentTiddler&gt;&gt; sort=\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; itemClassFilter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot;/&gt;\n&lt;/$reveal&gt;\n&lt;/li&gt;\n&lt;/$set&gt;\n&lt;/$set&gt;\n\\end\n\n\\define toc-expandable(tag,sort:\&quot;\&quot;,itemClassFilter)\n&lt;ol class=\&quot;tc-toc toc-expandable\&quot;&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$tag$]!has[draft.of]$sort$]\&quot;&gt;\n&lt;$list filter=\&quot;[all[current]toc-link[no]]\&quot; emptyMessage=\&quot;&lt;&lt;toc-linked-expandable-body tag:'$tag$' sort:'$sort$' itemClassFilter:'$itemClassFilter$'&gt;&gt;\&quot;&gt;\n&lt;&lt;toc-unlinked-expandable-body tag:\&quot;\&quot;\&quot;$tag$\&quot;\&quot;\&quot; sort:\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; itemClassFilter:\&quot;\&quot;\&quot;itemClassFilter\&quot;\&quot;\&quot;&gt;&gt;\n&lt;/$list&gt;\n&lt;/$list&gt;\n&lt;/ol&gt;\n\\end\n\n\\define toc-linked-selective-expandable-body(tag,sort:\&quot;\&quot;,itemClassFilter)\n&lt;$set name=\&quot;toc-state\&quot; value=&lt;&lt;qualify \&quot;$:/state/toc/$tag$-$(currentTiddler)$\&quot;&gt;&gt;&gt;\n&lt;$set name=\&quot;toc-item-class\&quot; filter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot; value=\&quot;toc-item-selected\&quot; emptyValue=\&quot;toc-item\&quot;&gt;\n&lt;li class=&lt;&lt;toc-item-class&gt;&gt;&gt;\n&lt;$link&gt;\n&lt;$list filter=\&quot;[all[current]tagging[]limit[1]]\&quot; variable=\&quot;ignore\&quot; emptyMessage=\&quot;&lt;$button class='tc-btn-invisible'&gt;{{$:/core/images/blank}}&lt;/$button&gt;\&quot;&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$button set=&lt;&lt;toc-state&gt;&gt; setTo=\&quot;open\&quot; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/right-arrow}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$button set=&lt;&lt;toc-state&gt;&gt; setTo=\&quot;close\&quot; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/down-arrow}}\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;/$list&gt;\n&lt;&lt;toc-caption&gt;&gt;\n&lt;/$link&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$macrocall $name=\&quot;toc-selective-expandable\&quot; tag=&lt;&lt;currentTiddler&gt;&gt; sort=\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; itemClassFilter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot;/&gt;\n&lt;/$reveal&gt;\n&lt;/li&gt;\n&lt;/$set&gt;\n&lt;/$set&gt;\n\\end\n\n\\define toc-unlinked-selective-expandable-body(tag,sort:\&quot;\&quot;,itemClassFilter)\n&lt;$set name=\&quot;toc-state\&quot; value=&lt;&lt;qualify \&quot;$:/state/toc/$tag$-$(currentTiddler)$\&quot;&gt;&gt;&gt;\n&lt;$set name=\&quot;toc-item-class\&quot; filter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot; value=\&quot;toc-item-selected\&quot; emptyValue=\&quot;toc-item\&quot;&gt;\n&lt;li class=&lt;&lt;toc-item-class&gt;&gt;&gt;\n&lt;$list filter=\&quot;[all[current]tagging[]limit[1]]\&quot; variable=\&quot;ignore\&quot; emptyMessage=\&quot;&lt;$button class='tc-btn-invisible'&gt;{{$:/core/images/blank}}&lt;/$button&gt; &lt;$view field='caption'&gt;&lt;$view field='title'/&gt;&lt;/$view&gt;\&quot;&gt;\n&lt;$reveal type=\&quot;nomatch\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$button set=&lt;&lt;toc-state&gt;&gt; setTo=\&quot;open\&quot; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/right-arrow}}\n&lt;&lt;toc-caption&gt;&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$button set=&lt;&lt;toc-state&gt;&gt; setTo=\&quot;close\&quot; class=\&quot;tc-btn-invisible\&quot;&gt;\n{{$:/core/images/down-arrow}}\n&lt;&lt;toc-caption&gt;&gt;\n&lt;/$button&gt;\n&lt;/$reveal&gt;\n&lt;/$list&gt;\n&lt;$reveal type=\&quot;match\&quot; state=&lt;&lt;toc-state&gt;&gt; text=\&quot;open\&quot;&gt;\n&lt;$macrocall $name=\&quot;\&quot;\&quot;toc-selective-expandable\&quot;\&quot;\&quot; tag=&lt;&lt;currentTiddler&gt;&gt; sort=\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; itemClassFilter=\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot;/&gt;\n&lt;/$reveal&gt;\n&lt;/li&gt;\n&lt;/$set&gt;\n&lt;/$set&gt;\n\\end\n\n\\define toc-selective-expandable(tag,sort:\&quot;\&quot;,itemClassFilter)\n&lt;ol class=\&quot;tc-toc toc-selective-expandable\&quot;&gt;\n&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$tag$]!has[draft.of]$sort$]\&quot;&gt;\n&lt;$list filter=\&quot;[all[current]toc-link[no]]\&quot; variable=\&quot;ignore\&quot; emptyMessage=\&quot;&lt;&lt;toc-linked-selective-expandable-body tag:'$tag$' sort:'$sort$' itemClassFilter:'$itemClassFilter$'&gt;&gt;\&quot;&gt;\n&lt;&lt;toc-unlinked-selective-expandable-body tag:\&quot;\&quot;\&quot;$tag$\&quot;\&quot;\&quot; sort:\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; itemClassFilter:\&quot;\&quot;\&quot;$itemClassFilter$\&quot;\&quot;\&quot;&gt;&gt;\n&lt;/$list&gt;\n&lt;/$list&gt;\n&lt;/ol&gt;\n\\end\n\n\\define toc-tabbed-selected-item-filter(selectedTiddler)\n[all[current]field:title{$selectedTiddler$}]\n\\end\n\n\\define toc-tabbed-external-nav(tag,sort:\&quot;\&quot;,selectedTiddler:\&quot;$:/temp/toc/selectedTiddler\&quot;,unselectedText,missingText,template:\&quot;\&quot;)\n&lt;$tiddler tiddler={{$selectedTiddler$}}&gt;\n&lt;div class=\&quot;tc-tabbed-table-of-contents\&quot;&gt;\n&lt;$linkcatcher to=\&quot;$selectedTiddler$\&quot;&gt;\n&lt;div class=\&quot;tc-table-of-contents\&quot;&gt;\n&lt;$macrocall $name=\&quot;toc-selective-expandable\&quot; tag=\&quot;\&quot;\&quot;$tag$\&quot;\&quot;\&quot; sort=\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; itemClassFilter=&lt;&lt;toc-tabbed-selected-item-filter selectedTiddler:\&quot;\&quot;\&quot;$selectedTiddler$\&quot;\&quot;\&quot;&gt;&gt;/&gt;\n&lt;/div&gt;\n&lt;/$linkcatcher&gt;\n&lt;div class=\&quot;tc-tabbed-table-of-contents-content\&quot;&gt;\n&lt;$reveal state=\&quot;\&quot;\&quot;$selectedTiddler$\&quot;\&quot;\&quot; type=\&quot;nomatch\&quot; text=\&quot;\&quot;&gt;\n&lt;$transclude mode=\&quot;block\&quot; tiddler=\&quot;$template$\&quot;&gt;\n&lt;h1&gt;&lt;$transclude field=\&quot;caption\&quot;&gt;&lt;$view field=\&quot;title\&quot;/&gt;&lt;/$transclude&gt;&lt;/h1&gt;\n&lt;$transclude mode=\&quot;block\&quot;&gt;$missingText$&lt;/$transclude&gt;\n&lt;/$transclude&gt;\n&lt;/$reveal&gt;\n&lt;$reveal state=\&quot;\&quot;\&quot;$selectedTiddler$\&quot;\&quot;\&quot; type=\&quot;match\&quot; text=\&quot;\&quot;&gt;\n$unselectedText$\n&lt;/$reveal&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/$tiddler&gt;\n\\end\n\n\\define toc-tabbed-internal-nav(tag,sort:\&quot;\&quot;,selectedTiddler:\&quot;$:/temp/toc/selectedTiddler\&quot;,unselectedText,missingText,template:\&quot;\&quot;)\n&lt;$linkcatcher to=\&quot;\&quot;\&quot;$selectedTiddler$\&quot;\&quot;\&quot;&gt;\n&lt;$macrocall $name=\&quot;toc-tabbed-external-nav\&quot; tag=\&quot;\&quot;\&quot;$tag$\&quot;\&quot;\&quot; sort=\&quot;\&quot;\&quot;$sort$\&quot;\&quot;\&quot; selectedTiddler=\&quot;\&quot;\&quot;$selectedTiddler$\&quot;\&quot;\&quot; unselectedText=\&quot;\&quot;\&quot;$unselectedText$\&quot;\&quot;\&quot; missingText=\&quot;\&quot;\&quot;$missingText$\&quot;\&quot;\&quot; template=\&quot;\&quot;\&quot;$template$\&quot;\&quot;\&quot;/&gt;\n&lt;/$linkcatcher&gt;\n\\end\n\n&quot;
        },
        &quot;$:/snippets/minilanguageswitcher&quot;: {
            &quot;title&quot;: &quot;$:/snippets/minilanguageswitcher&quot;,
            &quot;text&quot;: &quot;&lt;$select tiddler=\&quot;$:/language\&quot;&gt;\n&lt;$list filter=\&quot;[[$:/languages/en-GB]] [plugin-type[language]sort[title]]\&quot;&gt;\n&lt;option value=&lt;&lt;currentTiddler&gt;&gt;&gt;&lt;$view field=\&quot;description\&quot;&gt;&lt;$view field=\&quot;name\&quot;&gt;&lt;$view field=\&quot;title\&quot;/&gt;&lt;/$view&gt;&lt;/$view&gt;&lt;/option&gt;\n&lt;/$list&gt;\n&lt;/$select&gt;&quot;
        },
        &quot;$:/snippets/minithemeswitcher&quot;: {
            &quot;title&quot;: &quot;$:/snippets/minithemeswitcher&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Theme/\n&lt;&lt;lingo Prompt&gt;&gt; &lt;$select tiddler=\&quot;$:/theme\&quot;&gt;\n&lt;$list filter=\&quot;[plugin-type[theme]sort[title]]\&quot;&gt;\n&lt;option value=&lt;&lt;currentTiddler&gt;&gt;&gt;&lt;$view field=\&quot;name\&quot;&gt;&lt;$view field=\&quot;title\&quot;/&gt;&lt;/$view&gt;&lt;/option&gt;\n&lt;/$list&gt;\n&lt;/$select&gt;&quot;
        },
        &quot;$:/snippets/modules&quot;: {
            &quot;title&quot;: &quot;$:/snippets/modules&quot;,
            &quot;text&quot;: &quot;\\define describeModuleType(type)\n{{$:/language/Docs/ModuleTypes/$type$}}\n\\end\n&lt;$list filter=\&quot;[moduletypes[]]\&quot;&gt;\n\n!! &lt;$macrocall $name=\&quot;currentTiddler\&quot; $type=\&quot;text/plain\&quot; $output=\&quot;text/plain\&quot;/&gt;\n\n&lt;$macrocall $name=\&quot;describeModuleType\&quot; type=&lt;&lt;currentTiddler&gt;&gt;/&gt;\n\n&lt;ul&gt;&lt;$list filter=\&quot;[all[current]modules[]]\&quot;&gt;&lt;li&gt;&lt;$link&gt;&lt;&lt;currentTiddler&gt;&gt;&lt;/$link&gt;\n&lt;/li&gt;\n&lt;/$list&gt;\n&lt;/ul&gt;\n&lt;/$list&gt;\n&quot;
        },
        &quot;$:/palette&quot;: {
            &quot;title&quot;: &quot;$:/palette&quot;,
            &quot;text&quot;: &quot;$:/palettes/Vanilla&quot;
        },
        &quot;$:/snippets/paletteeditor&quot;: {
            &quot;title&quot;: &quot;$:/snippets/paletteeditor&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Palette/Editor/\n\\define describePaletteColour(colour)\n{{$:/language/Docs/PaletteColours/$colour$}}\n\\end\n&lt;$set name=\&quot;currentTiddler\&quot; value={{$:/palette}}&gt;\n\n&lt;&lt;lingo Prompt&gt;&gt; &lt;$link to={{$:/palette}}&gt;&lt;$macrocall $name=\&quot;currentTiddler\&quot; $output=\&quot;text/plain\&quot;/&gt;&lt;/$link&gt;\n\n&lt;$list filter=\&quot;[all[current]is[shadow]is[tiddler]]\&quot; variable=\&quot;listItem\&quot;&gt;\n&lt;&lt;lingo Prompt/Modified&gt;&gt;\n&lt;$button message=\&quot;tm-delete-tiddler\&quot; param={{$:/palette}}&gt;&lt;&lt;lingo Reset/Caption&gt;&gt;&lt;/$button&gt;\n&lt;/$list&gt;\n\n&lt;$list filter=\&quot;[all[current]is[shadow]!is[tiddler]]\&quot; variable=\&quot;listItem\&quot;&gt;\n&lt;&lt;lingo Clone/Prompt&gt;&gt;\n&lt;/$list&gt;\n\n&lt;$button message=\&quot;tm-new-tiddler\&quot; param={{$:/palette}}&gt;&lt;&lt;lingo Clone/Caption&gt;&gt;&lt;/$button&gt;\n\n&lt;table&gt;\n&lt;tbody&gt;\n&lt;$list filter=\&quot;[all[current]indexes[]]\&quot; variable=\&quot;colourName\&quot;&gt;\n&lt;tr&gt;\n&lt;td&gt;\n''&lt;$macrocall $name=\&quot;describePaletteColour\&quot; colour=&lt;&lt;colourName&gt;&gt;/&gt;''&lt;br/&gt;\n&lt;$macrocall $name=\&quot;colourName\&quot; $output=\&quot;text/plain\&quot;/&gt;\n&lt;/td&gt;\n&lt;td&gt;\n&lt;$edit-text index=&lt;&lt;colourName&gt;&gt; tag=\&quot;input\&quot;/&gt;\n&lt;br&gt;\n&lt;$edit-text index=&lt;&lt;colourName&gt;&gt; type=\&quot;color\&quot; tag=\&quot;input\&quot;/&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/$list&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;/$set&gt;\n&quot;
        },
        &quot;$:/snippets/palettepreview&quot;: {
            &quot;title&quot;: &quot;$:/snippets/palettepreview&quot;,
            &quot;text&quot;: &quot;&lt;$set name=\&quot;currentTiddler\&quot; value={{$:/palette}}&gt;\n&lt;$transclude tiddler=\&quot;$:/snippets/currpalettepreview\&quot;/&gt;\n&lt;/$set&gt;\n&quot;
        },
        &quot;$:/snippets/paletteswitcher&quot;: {
            &quot;title&quot;: &quot;$:/snippets/paletteswitcher&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Palette/\n&lt;&lt;lingo Prompt&gt;&gt; &lt;$view tiddler={{$:/palette}} field=\&quot;name\&quot;/&gt;\n\n&lt;$linkcatcher to=\&quot;$:/palette\&quot;&gt;\n&lt;div class=\&quot;tc-chooser\&quot;&gt;&lt;$list filter=\&quot;[all[shadows+tiddlers]tag[$:/tags/Palette]sort[description]]\&quot;&gt;&lt;div class=\&quot;tc-chooser-item\&quot;&gt;&lt;$link to={{!!title}}&gt;&lt;div&gt;&lt;$reveal state=\&quot;$:/palette\&quot; type=\&quot;match\&quot; text={{!!title}}&gt;&amp;bull;&lt;/$reveal&gt;&lt;$reveal state=\&quot;$:/palette\&quot; type=\&quot;nomatch\&quot; text={{!!title}}&gt;&amp;nbsp;&lt;/$reveal&gt; ''&lt;$view field=\&quot;name\&quot; format=\&quot;text\&quot;/&gt;'' - &lt;$view field=\&quot;description\&quot; format=\&quot;text\&quot;/&gt;&lt;/div&gt;&lt;$transclude tiddler=\&quot;$:/snippets/currpalettepreview\&quot;/&gt;&lt;/$link&gt;&lt;/div&gt;\n&lt;/$list&gt;\n&lt;/div&gt;\n&lt;/$linkcatcher&gt;&quot;
        },
        &quot;$:/temp/search&quot;: {
            &quot;title&quot;: &quot;$:/temp/search&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/tags/AdvancedSearch&quot;: {
            &quot;title&quot;: &quot;$:/tags/AdvancedSearch&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/AdvancedSearch/Standard]] [[$:/core/ui/AdvancedSearch/System]] [[$:/core/ui/AdvancedSearch/Shadows]] [[$:/core/ui/AdvancedSearch/Filter]]&quot;
        },
        &quot;$:/tags/ControlPanel&quot;: {
            &quot;title&quot;: &quot;$:/tags/ControlPanel&quot;,
            &quot;list&quot;: &quot;$:/core/ui/ControlPanel/Info $:/core/ui/ControlPanel/Appearance $:/core/ui/ControlPanel/Settings $:/core/ui/ControlPanel/Saving $:/core/ui/ControlPanel/Plugins $:/core/ui/ControlPanel/Tools $:/core/ui/ControlPanel/Internals&quot;
        },
        &quot;$:/tags/ControlPanel/Info&quot;: {
            &quot;title&quot;: &quot;$:/tags/ControlPanel/Info&quot;,
            &quot;list&quot;: &quot;$:/core/ui/ControlPanel/Basics $:/core/ui/ControlPanel/Advanced&quot;
        },
        &quot;$:/tags/EditTemplate&quot;: {
            &quot;title&quot;: &quot;$:/tags/EditTemplate&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/EditTemplate/controls]] [[$:/core/ui/EditTemplate/title]] [[$:/core/ui/EditTemplate/tags]] [[$:/core/ui/EditTemplate/shadow]] [[$:/core/ui/ViewTemplate/classic]] [[$:/core/ui/EditTemplate/body]] [[$:/core/ui/EditTemplate/type]] [[$:/core/ui/EditTemplate/fields]]&quot;
        },
        &quot;$:/tags/EditToolbar&quot;: {
            &quot;title&quot;: &quot;$:/tags/EditToolbar&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/Buttons/delete]] [[$:/core/ui/Buttons/cancel]] [[$:/core/ui/Buttons/save]]&quot;
        },
        &quot;$:/tags/MoreSideBar&quot;: {
            &quot;title&quot;: &quot;$:/tags/MoreSideBar&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/MoreSideBar/All]] [[$:/core/ui/MoreSideBar/Recent]] [[$:/core/ui/MoreSideBar/Tags]] [[$:/core/ui/MoreSideBar/Missing]] [[$:/core/ui/MoreSideBar/Drafts]] [[$:/core/ui/MoreSideBar/Orphans]] [[$:/core/ui/MoreSideBar/Types]] [[$:/core/ui/MoreSideBar/System]] [[$:/core/ui/MoreSideBar/Shadows]]&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/tags/PageControls&quot;: {
            &quot;title&quot;: &quot;$:/tags/PageControls&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/Buttons/home]] [[$:/core/ui/Buttons/close-all]] [[$:/core/ui/Buttons/permaview]] [[$:/core/ui/Buttons/new-tiddler]] [[$:/core/ui/Buttons/new-journal]] [[$:/core/ui/Buttons/import]] [[$:/core/ui/Buttons/export-page]] [[$:/core/ui/Buttons/control-panel]] [[$:/core/ui/Buttons/advanced-search]] [[$:/core/ui/Buttons/tag-manager]] [[$:/core/ui/Buttons/language]] [[$:/core/ui/Buttons/theme]] [[$:/core/ui/Buttons/storyview]] [[$:/core/ui/Buttons/encryption]] [[$:/core/ui/Buttons/full-screen]] [[$:/core/ui/Buttons/save-wiki]] [[$:/core/ui/Buttons/refresh]] [[$:/core/ui/Buttons/more-page-actions]]&quot;
        },
        &quot;$:/tags/PageTemplate&quot;: {
            &quot;title&quot;: &quot;$:/tags/PageTemplate&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/PageTemplate/sidebar]] [[$:/core/ui/PageTemplate/story]] [[$:/core/ui/PageTemplate/alerts]] [[$:/core/ui/PageTemplate/topleftbar]] [[$:/core/ui/PageTemplate/toprightbar]]&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/tags/SideBar&quot;: {
            &quot;title&quot;: &quot;$:/tags/SideBar&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/SideBar/Open]] [[$:/core/ui/SideBar/Recent]] [[$:/core/ui/SideBar/Tools]] [[$:/core/ui/SideBar/More]]&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/tags/TiddlerInfo&quot;: {
            &quot;title&quot;: &quot;$:/tags/TiddlerInfo&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/TiddlerInfo/Tools]] [[$:/core/ui/TiddlerInfo/References]] [[$:/core/ui/TiddlerInfo/Tagging]] [[$:/core/ui/TiddlerInfo/List]] [[$:/core/ui/TiddlerInfo/Listed]] [[$:/core/ui/TiddlerInfo/Fields]]&quot;,
            &quot;text&quot;: &quot;&quot;
        },
        &quot;$:/tags/TiddlerInfo/Advanced&quot;: {
            &quot;title&quot;: &quot;$:/tags/TiddlerInfo/Advanced&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/TiddlerInfo/Advanced/ShadowInfo]] [[$:/core/ui/TiddlerInfo/Advanced/PluginInfo]]&quot;
        },
        &quot;$:/tags/ViewTemplate&quot;: {
            &quot;title&quot;: &quot;$:/tags/ViewTemplate&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/ViewTemplate/title]] [[$:/core/ui/ViewTemplate/subtitle]] [[$:/core/ui/ViewTemplate/tags]] [[$:/core/ui/ViewTemplate/classic]] [[$:/core/ui/ViewTemplate/body]]&quot;
        },
        &quot;$:/tags/ViewToolbar&quot;: {
            &quot;title&quot;: &quot;$:/tags/ViewToolbar&quot;,
            &quot;list&quot;: &quot;[[$:/core/ui/Buttons/more-tiddler-actions]] [[$:/core/ui/Buttons/info]] [[$:/core/ui/Buttons/new-here]] [[$:/core/ui/Buttons/new-journal-here]] [[$:/core/ui/Buttons/clone]] [[$:/core/ui/Buttons/export-tiddler]] [[$:/core/ui/Buttons/edit]] [[$:/core/ui/Buttons/permalink]] [[$:/core/ui/Buttons/permaview]] [[$:/core/ui/Buttons/close-others]] [[$:/core/ui/Buttons/close]]&quot;
        },
        &quot;$:/snippets/themeswitcher&quot;: {
            &quot;title&quot;: &quot;$:/snippets/themeswitcher&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/Theme/\n&lt;&lt;lingo Prompt&gt;&gt; &lt;$view tiddler={{$:/theme}} field=\&quot;name\&quot;/&gt;\n\n&lt;$linkcatcher to=\&quot;$:/theme\&quot;&gt;\n&lt;$list filter=\&quot;[plugin-type[theme]sort[title]]\&quot;&gt;&lt;div&gt;&lt;$reveal state=\&quot;$:/theme\&quot; type=\&quot;match\&quot; text={{!!title}}&gt;&amp;bull;&lt;/$reveal&gt;&lt;$reveal state=\&quot;$:/theme\&quot; type=\&quot;nomatch\&quot; text={{!!title}}&gt;&amp;nbsp;&lt;/$reveal&gt; &lt;$link to={{!!title}}&gt;''&lt;$view field=\&quot;name\&quot; format=\&quot;text\&quot;/&gt;'' &lt;$view field=\&quot;description\&quot; format=\&quot;text\&quot;/&gt;&lt;/$link&gt;&lt;/div&gt;\n&lt;/$list&gt;\n&lt;/$linkcatcher&gt;&quot;
        },
        &quot;$:/core/wiki/title&quot;: {
            &quot;title&quot;: &quot;$:/core/wiki/title&quot;,
            &quot;type&quot;: &quot;text/vnd.tiddlywiki&quot;,
            &quot;text&quot;: &quot;{{$:/SiteTitle}} --- {{$:/SiteSubtitle}}&quot;
        },
        &quot;$:/view&quot;: {
            &quot;title&quot;: &quot;$:/view&quot;,
            &quot;text&quot;: &quot;classic&quot;
        },
        &quot;$:/snippets/viewswitcher&quot;: {
            &quot;title&quot;: &quot;$:/snippets/viewswitcher&quot;,
            &quot;text&quot;: &quot;\\define lingo-base() $:/language/ControlPanel/StoryView/\n&lt;&lt;lingo Prompt&gt;&gt; &lt;$select tiddler=\&quot;$:/view\&quot;&gt;\n&lt;$list filter=\&quot;[storyviews[]]\&quot;&gt;\n&lt;option&gt;&lt;$view field=\&quot;title\&quot;/&gt;&lt;/option&gt;\n&lt;/$list&gt;\n&lt;/$select&gt;&quot;
        }
    }
}</pre>
</div>
<div created="20150302215755788" modified="20150302215801811" title="$:/DefaultTiddlers">
<pre>[[Plato's Republic]]</pre>
</div>
<div status="complete" title="$:/Import">
<pre>The following tiddlers were imported:

# [[Help]]</pre>
</div>
<div title="$:/isEncrypted">
<pre>no</pre>
</div>
<div created="20150302192132303" modified="20150302192143575" title="$:/SiteSubtitle">
<pre>A personal wiki for study of Plato's Republic</pre>
</div>
<div created="20150302192125119" modified="20150302192128647" title="$:/SiteTitle">
<pre>Plato's Republic</pre>
</div>
<div modified="20150302215023714" title="$:/state/tab/sidebar--1835078512">
<pre>$:/core/ui/SideBar/Recent</pre>
</div>
<div list="[[Plato's Republic]]" title="$:/StoryList">
<pre></pre>
</div>
<div plugin-type="info" title="$:/temp/info-plugin" type="application/json">
<pre>{
    &quot;tiddlers&quot;: {
        &quot;$:/info/browser&quot;: {
            &quot;title&quot;: &quot;$:/info/browser&quot;,
            &quot;text&quot;: &quot;yes&quot;
        },
        &quot;$:/info/node&quot;: {
            &quot;title&quot;: &quot;$:/info/node&quot;,
            &quot;text&quot;: &quot;no&quot;
        }
    }
}</pre>
</div>
<div title="$:/temp/NewTagName">
<pre></pre>
</div>
<div author="JeremyRuston" core-version="&gt;=5.0.0" dependents="$:/themes/tiddlywiki/vanilla" description="A clean theme that emphasises individual tiddlers" name="Snow White" plugin-type="theme" title="$:/themes/tiddlywiki/snowwhite" type="application/json" version="5.1.7">
<pre>{
    &quot;tiddlers&quot;: {
        &quot;$:/themes/tiddlywiki/snowwhite/base&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/snowwhite/base&quot;,
            &quot;tags&quot;: &quot;[[$:/tags/Stylesheet]]&quot;,
            &quot;text&quot;: &quot;\\rules only filteredtranscludeinline transcludeinline macrodef macrocallinline\n\n.tc-sidebar-header {\n\ttext-shadow: 0 1px 0 &lt;&lt;colour sidebar-foreground-shadow&gt;&gt;;\n}\n\n.tc-tiddler-info {\n\t&lt;&lt;box-shadow \&quot;inset 1px 2px 3px rgba(0,0,0,0.1)\&quot;&gt;&gt;\n}\n\n@media screen {\n\t.tc-tiddler-frame {\n\t\t&lt;&lt;box-shadow \&quot;5px 5px 5px rgba(0, 0, 0, 0.1)\&quot;&gt;&gt;\n\t}\n}\n\n@media (max-width: {{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}}) {\n\t.tc-tiddler-frame {\n\t\t&lt;&lt;box-shadow none&gt;&gt;\n\t}\n}\n\n.tc-page-controls button svg, .tc-tiddler-controls button svg, .tc-topbar button svg {\n\t&lt;&lt;transition \&quot;fill 150ms ease-in-out\&quot;&gt;&gt;\n}\n\n.tc-tiddler-controls button.tc-selected svg {\n\t&lt;&lt;filter \&quot;drop-shadow(0px -1px 2px rgba(0,0,0,0.25))\&quot;&gt;&gt;\n}\n\n.tc-tiddler-frame input.tc-edit-texteditor {\n\t&lt;&lt;box-shadow \&quot;inset 0 1px 8px rgba(0, 0, 0, 0.15)\&quot;&gt;&gt;\n}\n\n.tc-edit-tags {\n\t&lt;&lt;box-shadow \&quot;inset 0 1px 8px rgba(0, 0, 0, 0.15)\&quot;&gt;&gt;\n}\n\n.tc-tiddler-frame .tc-edit-tags input.tc-edit-texteditor {\n\t&lt;&lt;box-shadow \&quot;none\&quot;&gt;&gt;\n\tborder: none;\n\toutline: none;\n}\n\ncanvas.tc-edit-bitmapeditor  {\n\t&lt;&lt;box-shadow \&quot;2px 2px 5px rgba(0, 0, 0, 0.5)\&quot;&gt;&gt;\n}\n\n.tc-drop-down {\n\tborder-radius: 4px;\n\t&lt;&lt;box-shadow \&quot;2px 2px 10px rgba(0, 0, 0, 0.5)\&quot;&gt;&gt;\n}\n\n.tc-block-dropdown {\n\tborder-radius: 4px;\n\t&lt;&lt;box-shadow \&quot;2px 2px 10px rgba(0, 0, 0, 0.5)\&quot;&gt;&gt;\n}\n\n.tc-modal-displayed {\n\t-webkit-filter: blur(4px);\n}\n\n.tc-modal {\n\tborder-radius: 6px;\n\t&lt;&lt;box-shadow \&quot;0 3px 7px rgba(0,0,0,0.3)\&quot;&gt;&gt;\n}\n\n.tc-modal-footer {\n\tborder-radius: 0 0 6px 6px;\n\t&lt;&lt;box-shadow \&quot;inset 0 1px 0 #fff\&quot;&gt;&gt;;\n}\n\n\n.tc-alert {\n\tborder-radius: 6px;\n\t&lt;&lt;box-shadow \&quot;0 3px 7px rgba(0,0,0,0.6)\&quot;&gt;&gt;\n}\n\n.tc-notification {\n\tborder-radius: 6px;\n\t&lt;&lt;box-shadow \&quot;0 3px 7px rgba(0,0,0,0.3)\&quot;&gt;&gt;\n\ttext-shadow: 0 1px 0 rgba(255,255,255, 0.8);\n}\n\n.tc-sidebar-lists .tc-tab-divider {\n\t&lt;&lt;background-linear-gradient \&quot;left, rgb(216,216,216) 0%, rgb(236,236,236) 250px\&quot;&gt;&gt;\n}\n\n.tc-more-sidebar .tc-tab-buttons button {\n\t&lt;&lt;background-linear-gradient \&quot;left, rgb(236,236,236) 0%, rgb(224,224,224) 100%\&quot;&gt;&gt;\n}\n\n.tc-more-sidebar .tc-tab-buttons button.tc-tab-selected {\n\t&lt;&lt;background-linear-gradient \&quot;left, rgb(236,236,236) 0%, rgb(248,248,248) 100%\&quot;&gt;&gt;\n}\n\n.tc-message-box img {\n\t&lt;&lt;box-shadow \&quot;1px 1px 3px rgba(0,0,0,0.5)\&quot;&gt;&gt;\n}\n\n.tc-plugin-info {\n\t&lt;&lt;box-shadow \&quot;2px 2px 4px rgba(0,0,0,0.2)\&quot;&gt;&gt;\n}\n&quot;
        }
    }
}</pre>
</div>
<div author="JeremyRuston" core-version="&gt;=5.0.0" dependents="" description="A basic default theme" name="Vanilla" plugin-type="theme" title="$:/themes/tiddlywiki/vanilla" type="application/json" version="5.1.7">
<pre>{
    &quot;tiddlers&quot;: {
        &quot;$:/themes/tiddlywiki/vanilla/themetweaks&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/themetweaks&quot;,
            &quot;tags&quot;: &quot;$:/tags/ControlPanel/Appearance&quot;,
            &quot;caption&quot;: &quot;Theme Tweaks&quot;,
            &quot;text&quot;: &quot;You can tweak certain aspects of the ''Vanilla'' theme.\n\n! Settings\n\n* [[Font family|$:/themes/tiddlywiki/vanilla/settings/fontfamily]]: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/settings/fontfamily\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n\n! Sizes\n\n* [[Font size|$:/themes/tiddlywiki/vanilla/metrics/fontsize]]: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/fontsize\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n* [[Line height|$:/themes/tiddlywiki/vanilla/metrics/lineheight]]: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/lineheight\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n* [[Font size for tiddler body|$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize]]: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n* [[Line height for tiddler body|$:/themes/tiddlywiki/vanilla/metrics/bodylineheight]]: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/bodylineheight\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n* [[Story left position|$:/themes/tiddlywiki/vanilla/metrics/storyleft]] //(the distance between the left of the screen and the left margin of the story river or tiddler area)//: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/storyleft\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n* [[Story top position|$:/themes/tiddlywiki/vanilla/metrics/storytop]] //(the distance between the top of the screen and the top margin of the story river or tiddler area)//: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/storytop\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n* [[Story right|$:/themes/tiddlywiki/vanilla/metrics/storyright]] //(the distance between the left side of the screen and the left margin of the sidebar area)//: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/storyright\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n* [[Story width|$:/themes/tiddlywiki/vanilla/metrics/storywidth]] //(the width of the story river or tiddler area)//: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/storywidth\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n* [[Tiddler width|$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth]] //(the width of individual tiddlers -- used for zoomin storyview)//: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n* [[Sidebar breakpoint|$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint]] //(the minimum width for the sidebar to be displayed alongside the story river)//: &lt;$edit-text tiddler=\&quot;$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint\&quot; default=\&quot;\&quot; tag=\&quot;input\&quot;/&gt;\n&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/base&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/base&quot;,
            &quot;tags&quot;: &quot;[[$:/tags/Stylesheet]]&quot;,
            &quot;text&quot;: &quot;\\rules only filteredtranscludeinline transcludeinline macrodef macrocallinline\n/*\n** Start with the normalize CSS reset, and then belay some of its effects\n*/\n\n{{$:/themes/tiddlywiki/vanilla/reset}}\n\n*, input[type=\&quot;search\&quot;] {\n\tbox-sizing: border-box;\n\t-moz-box-sizing: border-box;\n\t-webkit-box-sizing: border-box;\n}\n\nhtml button {\n\tline-height: 1.2;\n}\n\n/*\n** Basic element styles\n*/\n\nhtml {\n\tfont-family: {{$:/themes/tiddlywiki/vanilla/settings/fontfamily}};\n\ttext-rendering: optimizeLegibility; /* Enables kerning and ligatures etc. */\t\n}\n\nhtml:-webkit-full-screen {\n\tbackground-color: &lt;&lt;colour page-background&gt;&gt;;\n}\n\nbody.tc-body {\n\tfont-size: {{$:/themes/tiddlywiki/vanilla/metrics/fontsize}};\n\tline-height: {{$:/themes/tiddlywiki/vanilla/metrics/lineheight}};\n\tcolor: &lt;&lt;colour foreground&gt;&gt;;\n\tbackground-color: &lt;&lt;colour page-background&gt;&gt;;\n\tword-wrap: break-word;\n}\n\nh1, h2, h3, h4, h5, h6 {\n\tline-height: 1.2;\n\tfont-weight: 300;\n}\n\npre {\n\tdisplay: block;\n\tpadding: 14px;\n\tmargin-top: 1em;\n\tmargin-bottom: 1em;\n\tword-break: normal;\n\tword-wrap: break-word;\n\twhite-space: pre;\n\twhite-space: pre-wrap;\n\tbackground-color: &lt;&lt;colour pre-background&gt;&gt;;\n\tborder: 1px solid &lt;&lt;colour pre-border&gt;&gt;;\n\tpadding: 0 3px 2px;\n\tborder-radius: 3px;\n}\n\ncode {\n\tcolor: &lt;&lt;colour code-foreground&gt;&gt;;\n\tbackground-color: &lt;&lt;colour code-background&gt;&gt;;\n\tborder: 1px solid &lt;&lt;colour code-border&gt;&gt;;\n    white-space: pre-wrap;\n\tpadding: 0 3px 2px;\n\tborder-radius: 3px;\n}\n\nblockquote {\n\tborder-left: 5px solid &lt;&lt;colour blockquote-bar&gt;&gt;;\n\tmargin-left: 25px;\n\tpadding-left: 10px;\n}\n\ndl dt {\n\tfont-weight: bold;\n\tmargin-top: 6px;\n}\n\n.tc-muted {\n\tcolor: &lt;&lt;colour muted-foreground&gt;&gt;;\n}\n\n/*\nMarkdown likes putting code elements inside pre elements\n*/\npre &gt; code {\n\tpadding: 0;\n\tborder: none;\n\tbackground-color: inherit;\n\tcolor: inherit;\n}\n\ntable {\n\tborder: 1px solid &lt;&lt;colour table-border&gt;&gt;;\n\twidth: auto;\n\tmax-width: 100%;\n\tcaption-side: bottom;\n\tmargin-top: 1em;\n\tmargin-bottom: 1em;\n}\n\ntable th, table td {\n\tpadding: 0 7px 0 7px;\n\tborder-top: 1px solid &lt;&lt;colour table-border&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour table-border&gt;&gt;;\n}\n\ntable thead tr td, table th {\n\tbackground-color: &lt;&lt;colour table-header-background&gt;&gt;;\n\tfont-weight: bold;\n}\n\ntable tfoot tr td {\n\tbackground-color: &lt;&lt;colour table-footer-background&gt;&gt;;\n}\n\n.tc-csv-table {\n\twhite-space: nowrap;\n}\n\n.tc-tiddler-frame img,\n.tc-tiddler-frame svg,\n.tc-tiddler-frame canvas,\n.tc-tiddler-frame embed,\n.tc-tiddler-frame iframe {\n\tmax-width: 100%;\n}\n\n.tc-tiddler-body &gt; embed,\n.tc-tiddler-body &gt; iframe {\n\twidth: 100%;\n\theight: 600px;\n}\n\n/*\n** Links\n*/\n\nbutton.tc-tiddlylink,\na.tc-tiddlylink {\n\ttext-decoration: none;\n\tfont-weight: normal;\n\tcolor: &lt;&lt;colour tiddler-link-foreground&gt;&gt;;\n\t-webkit-user-select: inherit; /* Otherwise the draggable attribute makes links impossible to select */\n}\n\n.tc-sidebar-lists a.tc-tiddlylink {\n\tcolor: &lt;&lt;colour sidebar-tiddler-link-foreground&gt;&gt;;\n}\n\n.tc-sidebar-lists a.tc-tiddlylink:hover {\n\tcolor: &lt;&lt;colour sidebar-tiddler-link-foreground-hover&gt;&gt;;\n}\n\nbutton.tc-tiddlylink:hover,\na.tc-tiddlylink:hover {\n\ttext-decoration: underline;\n}\n\na.tc-tiddlylink-resolves {\n}\n\na.tc-tiddlylink-shadow {\n\tfont-weight: bold;\n}\n\na.tc-tiddlylink-shadow.tc-tiddlylink-resolves {\n\tfont-weight: normal;\n}\n\na.tc-tiddlylink-missing {\n\tfont-style: italic;\n}\n\na.tc-tiddlylink-external {\n\ttext-decoration: underline;\n\tcolor: &lt;&lt;colour external-link-foreground&gt;&gt;;\n\tbackground-color: &lt;&lt;colour external-link-background&gt;&gt;;\n}\n\na.tc-tiddlylink-external:visited {\n\tcolor: &lt;&lt;colour external-link-foreground-visited&gt;&gt;;\n\tbackground-color: &lt;&lt;colour external-link-background-visited&gt;&gt;;\n}\n\na.tc-tiddlylink-external:hover {\n\tcolor: &lt;&lt;colour external-link-foreground-hover&gt;&gt;;\n\tbackground-color: &lt;&lt;colour external-link-background-hover&gt;&gt;;\n}\n\n/*\n** Drag and drop styles\n*/\n\n.tc-tiddler-dragger {\n\tposition: relative;\n\tz-index: -10000;\n}\n\n.tc-tiddler-dragger-inner {\n\tposition: absolute;\n\tdisplay: inline-block;\n\tpadding: 8px 20px;\n\tfont-size: 16.9px;\n\tfont-weight: bold;\n\tline-height: 20px;\n\tcolor: &lt;&lt;colour dragger-foreground&gt;&gt;;\n\ttext-shadow: 0 1px 0 rgba(0, 0, 0, 1);\n\twhite-space: nowrap;\n\tvertical-align: baseline;\n\tbackground-color: &lt;&lt;colour dragger-background&gt;&gt;;\n\tborder-radius: 20px;\n}\n\n.tc-tiddler-dragger-cover {\n\tposition: absolute;\n\tbackground-color: &lt;&lt;colour page-background&gt;&gt;;\n}\n\n.tc-dropzone {\n\tposition: relative;\n}\n\n.tc-dropzone.tc-dragover:before {\n\tz-index: 10000;\n\tdisplay: block;\n\tposition: absolute;\n\tposition: -webkit-sticky;\n\tposition: -moz-sticky;\n\tposition: -o-sticky;\n\tposition: -ms-sticky;\n\tposition: sticky;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbackground: &lt;&lt;colour dropzone-background&gt;&gt;;\n\ttext-align: center;\n\tcontent: \&quot;&lt;&lt;lingo DropMessage&gt;&gt;\&quot;;\n}\n\n/*\n** Buttons\n*/\n\nbutton svg, button img {\n\tvertical-align: middle;\n}\n\n.tc-btn-invisible {\n\tpadding: 0;\n\tmargin: 0;\n\tbackground: none;\n\tborder: none;\n}\n\n.tc-btn-icon svg {\n\theight: 1em;\n\twidth: 1em;\n\tfill: &lt;&lt;colour muted-foreground&gt;&gt;;\n}\n\n.tc-btn-text {\n\tpadding: 0;\n\tmargin: 0;\n}\n\n.tc-btn-big-green {\n\tpadding: 8px;\n\tmargin: 4px 8px 4px 8px;\n\tbackground: &lt;&lt;colour download-background&gt;&gt;;\n\tcolor: &lt;&lt;colour download-foreground&gt;&gt;;\n\tfill: &lt;&lt;colour download-foreground&gt;&gt;;\n\tborder: none;\n\tfont-size: 1.2em;\n\tline-height: 1.4em;\n}\n\n.tc-sidebar-lists input {\n\tcolor: &lt;&lt;colour foreground&gt;&gt;;\n}\n\n.tc-sidebar-lists button {\n\tcolor: &lt;&lt;colour sidebar-button-foreground&gt;&gt;;\n\tfill: &lt;&lt;colour sidebar-button-foreground&gt;&gt;;\n}\n\n.tc-sidebar-lists button.tc-btn-mini {\n\tcolor: &lt;&lt;colour sidebar-muted-foreground&gt;&gt;;\n}\n\n.tc-sidebar-lists button.tc-btn-mini:hover {\n\tcolor: &lt;&lt;colour sidebar-muted-foreground-hover&gt;&gt;;\n}\n\nbutton svg.tc-image-button, button .tc-image-button img {\n\theight: 1em;\n\twidth: 1em;\n}\n\n/*\n** Tags and missing tiddlers\n*/\n\n.tc-tag-list-item {\n\tposition: relative;\n\tdisplay: inline-block;\n\tmargin-right: 7px;\n}\n\n.tc-tags-wrapper {\n\tmargin: 4px 0 14px 0;\n}\n\n.tc-missing-tiddler-label {\n\tfont-style: italic;\n\tfont-weight: normal;\n\tdisplay: inline-block;\n\tfont-size: 11.844px;\n\tline-height: 14px;\n\twhite-space: nowrap;\n\tvertical-align: baseline;\n}\n\nbutton.tc-tag-label, span.tc-tag-label {\n\tdisplay: inline-block;\n\tpadding: 0.16em 0.7em;\n\tfont-size: 0.9em;\n\tfont-weight: 300;\n\tline-height: 1.2em;\n\tcolor: &lt;&lt;colour tag-foreground&gt;&gt;;\n\twhite-space: nowrap;\n\tvertical-align: baseline;\n\tbackground-color: &lt;&lt;colour tag-background&gt;&gt;;\n\tborder-radius: 1em;\n}\n\n.tc-untagged-separator {\n\twidth: 10em;\n\tleft: 0;\n\tmargin-left: 0;\n\tborder: 0;\n\theight: 1px;\n\tbackground: &lt;&lt;colour tab-divider&gt;&gt;;\n}\n\nbutton.tc-untagged-label {\n\tbackground-color: &lt;&lt;colour untagged-background&gt;&gt;;\n}\n\n.tc-tag-label svg, .tc-tag-label img {\n\theight: 1em;\n\twidth: 1em;\n\tfill: &lt;&lt;colour tag-foreground&gt;&gt;;\n}\n\n.tc-tag-manager-table .tc-tag-label {\n\twhite-space: normal;\n}\n\n.tc-tag-manager-tag {\n\twidth: 100%;\n}\n\n/*\n** Page layout\n*/\n\n.tc-topbar {\n\tposition: fixed;\n\tz-index: 1200;\n}\n\n.tc-topbar-left {\n\tleft: 29px;\n\ttop: 5px;\n}\n\n.tc-topbar-right {\n\ttop: 5px;\n\tright: 29px;\n}\n\n.tc-topbar button {\n\tpadding: 8px;\n}\n\n.tc-topbar svg {\n\tfill: &lt;&lt;colour muted-foreground&gt;&gt;;\n}\n\n.tc-topbar button:hover svg {\n\tfill: &lt;&lt;colour foreground&gt;&gt;;\n}\n\n.tc-sidebar-header {\n\tcolor: &lt;&lt;colour sidebar-foreground&gt;&gt;;\n\tfill: &lt;&lt;colour sidebar-foreground&gt;&gt;;\n}\n\n.tc-sidebar-header .tc-title a.tc-tiddlylink-resolves {\n\tfont-weight: 300;\n}\n\n.tc-sidebar-header .tc-sidebar-lists p {\n\tmargin-top: 3px;\n\tmargin-bottom: 3px;\n}\n\n.tc-sidebar-header .tc-missing-tiddler-label {\n\tcolor: &lt;&lt;colour sidebar-foreground&gt;&gt;;\n}\n\n.tc-advanced-search input {\n\twidth: 60%;\n}\n\n.tc-search a svg {\n\twidth: 1.2em;\n\theight: 1.2em;\n\tvertical-align: middle;\n}\n\n.tc-search-results {\n\tpadding-top: 14px;\n}\n\n.tc-page-controls {\n\tmargin-top: 14px;\n\tfont-size: 1.5em;\n}\n\n.tc-page-controls button {\n\tmargin-right: 0.5em;\n}\n\n.tc-page-controls a.tc-tiddlylink:hover {\n\ttext-decoration: none;\n}\n\n.tc-page-controls img {\n\twidth: 1em;\n}\n\n.tc-page-controls svg,\n.tc-search svg {\n\tfill: &lt;&lt;colour sidebar-controls-foreground&gt;&gt;;\n}\n\n.tc-page-controls button:hover svg, .tc-page-controls a:hover svg,\n.tc-search button:hover svg, .tc-search a:hover svg {\n\tfill: &lt;&lt;colour sidebar-controls-foreground-hover&gt;&gt;;\n}\n\n.tc-menu-list-item {\n\twhite-space: nowrap;\n}\n\n.tc-menu-list-count {\n\tfont-weight: bold;\n}\n\n.tc-menu-list-subitem {\n\tpadding-left: 7px;\n}\n\n.tc-story-river {\n\tposition: relative;\n}\n\n@media (max-width: {{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}}) {\n\n\t.tc-sidebar-header {\n\t\tpadding: 14px;\n\t\tmin-height: 32px;\n\t\tmargin-top: {{$:/themes/tiddlywiki/vanilla/metrics/storytop}};\n\t}\n\n\t.tc-story-river {\n\t\tposition: relative;\n\t\tpadding: 0;\n\t}\n}\n\n@media (min-width: {{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}}) {\n\n\t.tc-message-box {\n\t\tmargin: 21px -21px 21px -21px;\n\t}\n\n\t.tc-sidebar-scrollable {\n\t\tposition: fixed;\n\t\ttop: {{$:/themes/tiddlywiki/vanilla/metrics/storytop}};\n\t\tleft: {{$:/themes/tiddlywiki/vanilla/metrics/storyright}};\n\t\tbottom: 0;\n\t\tright: 0;\n\t\toverflow-y: auto;\n\t\toverflow-x: auto;\n\t\t-webkit-overflow-scrolling: touch;\n\t\tmargin: 0 0 0 -42px;\n\t\tpadding: 71px 0 28px 42px;\n\t}\n\n\t.tc-story-river {\n\t\tposition: relative;\n\t\tleft: {{$:/themes/tiddlywiki/vanilla/metrics/storyleft}};\n\t\ttop: {{$:/themes/tiddlywiki/vanilla/metrics/storytop}};\n\t\twidth: {{$:/themes/tiddlywiki/vanilla/metrics/storywidth}};\n\t\tpadding: 42px 42px 42px 42px;\n\t}\n\n&lt;&lt;if-no-sidebar \&quot;\n\n\t.tc-story-river {\n\t\twidth: auto;\n\t}\n\n\&quot;&gt;&gt;\n\n}\n\n@media print {\n\n\tbody.tc-body {\n\t\tbackground-color: transparent;\n\t}\n\n\t.tc-sidebar-header, .tc-topbar {\n\t\tdisplay: none;\n\t}\n\n\t.tc-story-river {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t}\n\n\t.tc-story-river .tc-tiddler-frame {\n\t\tmargin: 0;\n\t\tborder: none;\n\t\tpadding: 28px;\n\t}\n}\n\n/*\n** Tiddler styles\n*/\n\n.tc-tiddler-frame {\n\tmargin-bottom: 28px;\n\tbackground-color: &lt;&lt;colour tiddler-background&gt;&gt;;\n\tborder: 1px solid &lt;&lt;colour tiddler-border&gt;&gt;;\n}\n\n.tc-tiddler-info {\n\tpadding: 14px 42px 14px 42px;\n\tbackground-color: &lt;&lt;colour tiddler-info-background&gt;&gt;;\n\tborder-top: 1px solid &lt;&lt;colour tiddler-info-border&gt;&gt;;\n\tborder-bottom: 1px solid &lt;&lt;colour tiddler-info-border&gt;&gt;;\n}\n\n.tc-tiddler-info p {\n\tmargin-top: 3px;\n\tmargin-bottom: 3px;\n}\n\n.tc-tiddler-info .tc-tab-buttons button.tc-tab-selected {\n\tbackground-color: &lt;&lt;colour tiddler-info-tab-background&gt;&gt;;\n\tborder-bottom: 1px solid &lt;&lt;colour tiddler-info-tab-background&gt;&gt;;\n}\n\n.tc-view-field-table {\n\twidth: 100%;\n}\n\n.tc-view-field-name {\n\twidth: 1%; /* Makes this column be as narrow as possible */\n\ttext-align: right;\n\tfont-style: italic;\n\tfont-weight: 200;\n}\n\n.tc-view-field-value {\n}\n\n@media (max-width: {{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}}) {\n\t.tc-tiddler-frame {\n\t\tpadding: 14px 14px 14px 14px;\n\t}\n\n\t.tc-tiddler-info {\n\t\tmargin: 0 -14px 0 -14px;\n\t}\n}\n\n@media (min-width: {{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}}) {\n\t.tc-tiddler-frame {\n\t\tpadding: 28px 42px 42px 42px;\n\t\twidth: {{$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth}};\n\t\tborder-radius: 2px;\n\t}\n\n&lt;&lt;if-no-sidebar \&quot;\n\n\t.tc-tiddler-frame {\n\t\twidth: 100%;\n\t}\n\n\&quot;&gt;&gt;\n\n\t.tc-tiddler-info {\n\t\tmargin: 0 -42px 0 -42px;\n\t}\n}\n\n.tc-site-title,\n.tc-titlebar {\n\tfont-weight: 300;\n\tfont-size: 2.35em;\n\tline-height: 1.2em;\n\tcolor: &lt;&lt;colour tiddler-title-foreground&gt;&gt;;\n\tmargin: 0;\n}\n\n.tc-tiddler-title-icon {\n\tvertical-align: middle;\n}\n\n.tc-system-title-prefix {\n\tcolor: &lt;&lt;colour muted-foreground&gt;&gt;;\n}\n\n.tc-titlebar h2 {\n\tfont-size: 1em;\n\tdisplay: inline;\n}\n\n.tc-titlebar img {\n\theight: 1em;\n}\n\n.tc-subtitle {\n\tfont-size: 0.9em;\n\tcolor: &lt;&lt;colour tiddler-subtitle-foreground&gt;&gt;;\n\tfont-weight: 300;\n}\n\n.tc-tiddler-missing .tc-title {\n  font-style: italic;\n  font-weight: normal;\n}\n\n.tc-tiddler-frame .tc-tiddler-controls {\n\tfloat: right;\n}\n\n.tc-tiddler-controls .tc-drop-down {\n\tfont-size: 0.6em;\n}\n\n.tc-tiddler-controls .tc-drop-down .tc-drop-down {\n\tfont-size: 1em;\n}\n\n.tc-tiddler-controls &gt; span &gt; button {\n\tvertical-align: baseline;\n\tmargin-left:5px;\n}\n\n.tc-tiddler-controls button svg, .tc-tiddler-controls button img {\n\theight: 0.75em;\n\tfill: &lt;&lt;colour tiddler-controls-foreground&gt;&gt;;\n}\n\n.tc-tiddler-controls button.tc-selected svg {\n\tfill: &lt;&lt;colour tiddler-controls-foreground-selected&gt;&gt;;\n}\n\n.tc-tiddler-controls button.tc-btn-invisible:hover svg {\n\tfill: &lt;&lt;colour tiddler-controls-foreground-hover&gt;&gt;;\n}\n\n@media print {\n\t.tc-tiddler-controls {\n\t\tdisplay: none;\n\t}\n}\n\n.tc-tiddler-help { /* Help prompts within tiddler template */\n\tcolor: &lt;&lt;colour muted-foreground&gt;&gt;;\n\tmargin-top: 14px;\n}\n\n.tc-tiddler-help a.tc-tiddlylink {\n\tcolor: &lt;&lt;colour very-muted-foreground&gt;&gt;;\n}\n\n.tc-tiddler-frame input.tc-edit-texteditor, .tc-tiddler-frame textarea.tc-edit-texteditor {\n\twidth: 100%;\n\tpadding: 3px 3px 3px 3px;\n\tborder: 1px solid &lt;&lt;colour tiddler-editor-border&gt;&gt;;\n\tline-height: 1.3em;\n\t-webkit-appearance: none;\n\tmargin: 4px 0 4px 0;\n}\n\n.tc-tiddler-frame .tc-binary-warning {\n\twidth: 100%;\n\theight: 5em;\n\ttext-align: center;\n\tpadding: 3em 3em 6em 3em;\n\tbackground: &lt;&lt;colour alert-background&gt;&gt;;\n\tborder: 1px solid &lt;&lt;colour alert-border&gt;&gt;;\n}\n\n.tc-tiddler-frame input.tc-edit-texteditor {\n\tbackground-color: &lt;&lt;colour tiddler-editor-background&gt;&gt;;\n}\n\ncanvas.tc-edit-bitmapeditor  {\n\tborder: 6px solid &lt;&lt;colour tiddler-editor-border-image&gt;&gt;;\n\tcursor: crosshair;\n\t-moz-user-select: none;\n\t-webkit-user-select: none;\n\t-ms-user-select: none;\n\tmargin-top: 6px;\n\tmargin-bottom: 6px;\n}\n\n.tc-edit-bitmapeditor-width {\n\tdisplay: block;\n}\n\n.tc-edit-bitmapeditor-height {\n\tdisplay: block;\n}\n\n.tc-tiddler-frame .tc-tiddler-body {\n\tfont-size: {{$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize}};\n\tline-height: {{$:/themes/tiddlywiki/vanilla/metrics/bodylineheight}};\n}\n\n.tc-titlebar, .tc-tiddler-edit-title {\n\toverflow: hidden; /* https://github.com/Jermolene/TiddlyWiki5/issues/282 */\n}\n\n/*\n** Toolbar buttons\n*/\n\n.tc-page-controls svg.tc-image-new-button {\n  fill: &lt;&lt;colour toolbar-new-button&gt;&gt;;\n}\n\n.tc-page-controls svg.tc-image-options-button {\n  fill: &lt;&lt;colour toolbar-options-button&gt;&gt;;\n}\n\n.tc-page-controls svg.tc-image-save-button {\n  fill: &lt;&lt;colour toolbar-save-button&gt;&gt;;\n}\n\n.tc-tiddler-controls button svg.tc-image-info-button {\n  fill: &lt;&lt;colour toolbar-info-button&gt;&gt;;\n}\n\n.tc-tiddler-controls button svg.tc-image-edit-button {\n  fill: &lt;&lt;colour toolbar-edit-button&gt;&gt;;\n}\n\n.tc-tiddler-controls button svg.tc-image-close-button {\n  fill: &lt;&lt;colour toolbar-close-button&gt;&gt;;\n}\n\n.tc-tiddler-controls button svg.tc-image-delete-button {\n  fill: &lt;&lt;colour toolbar-delete-button&gt;&gt;;\n}\n\n.tc-tiddler-controls button svg.tc-image-cancel-button {\n  fill: &lt;&lt;colour toolbar-cancel-button&gt;&gt;;\n}\n\n.tc-tiddler-controls button svg.tc-image-done-button {\n  fill: &lt;&lt;colour toolbar-done-button&gt;&gt;;\n}\n\n/*\n** Tiddler edit mode\n*/\n\n.tc-tiddler-edit-frame em.tc-edit {\n\tcolor: &lt;&lt;colour muted-foreground&gt;&gt;;\n\tfont-style: normal;\n}\n\n.tc-edit-type-dropdown a.tc-tiddlylink-missing {\n\tfont-style: normal;\n}\n\n.tc-edit-tags {\n\tborder: 1px solid &lt;&lt;colour tiddler-editor-border&gt;&gt;;\n\tpadding: 4px 8px 4px 8px;\n}\n\n.tc-edit-add-tag {\n\tdisplay: inline-block;\n}\n\n.tc-edit-add-tag .tc-add-tag-name input {\n\twidth: 50%;\n}\n\n.tc-edit-tags .tc-tag-label {\n\tdisplay: inline-block;\n}\n\n.tc-edit-tags-list {\n\tmargin: 14px 0 14px 0;\n}\n\n.tc-remove-tag-button {\n\tpadding-left: 4px;\n}\n\n.tc-tiddler-preview {\n\toverflow: auto;\n}\n\n.tc-tiddler-preview-preview {\n\tfloat: right;\n\twidth: 48%;\n\tborder: 1px solid &lt;&lt;colour tiddler-editor-border&gt;&gt;;\n\tmargin: 4px 3px 3px 3px;\n\tpadding: 3px 3px 3px 3px;\n}\n\n.tc-tiddler-preview-edit {\n\twidth: 48%;\n}\n\n.tc-edit-fields {\n\twidth: 100%;\n}\n\n\n.tc-edit-fields table, .tc-edit-fields tr, .tc-edit-fields td {\n\tborder: none;\n\tpadding: 4px;\n}\n\n.tc-edit-fields &gt; tbody &gt; .tc-edit-field:nth-child(odd) {\n\tbackground-color: &lt;&lt;colour tiddler-editor-fields-odd&gt;&gt;;\n}\n\n.tc-edit-fields &gt; tbody &gt; .tc-edit-field:nth-child(even) {\n\tbackground-color: &lt;&lt;colour tiddler-editor-fields-even&gt;&gt;;\n}\n\n.tc-edit-field-name {\n\ttext-align: right;\n}\n\n.tc-edit-field-value input {\n\twidth: 100%;\n}\n\n.tc-edit-field-remove {\n}\n\n.tc-edit-field-remove svg {\n\theight: 1em;\n\twidth: 1em;\n\tfill: &lt;&lt;colour muted-foreground&gt;&gt;;\n\tvertical-align: middle;\n}\n\n.tc-edit-field-add-name {\n\tdisplay: inline-block;\n\twidth: 15%;\n}\n\n.tc-edit-field-add-value {\n\tdisplay: inline-block;\n\twidth: 40%;\n}\n\n.tc-edit-field-add-button {\n\tdisplay: inline-block;\n\twidth: 10%;\n}\n\n/*\n** Storyview Classes\n*/\n\n.tc-storyview-zoomin-tiddler {\n\tposition: absolute;\n\tdisplay: block;\n\twidth: 100%;\n\twidth: calc(100% - 84px);\n}\n\n/*\n** Dropdowns\n*/\n\n.tc-btn-dropdown {\n\ttext-align: left;\n}\n\n.tc-btn-dropdown svg, .tc-btn-dropdown img {\n\theight: 1em;\n\twidth: 1em;\n\tfill: &lt;&lt;colour muted-foreground&gt;&gt;;\n}\n\n.tc-drop-down-wrapper {\n\tposition: relative;\n}\n\n.tc-drop-down {\n\tmin-width: 380px;\n\tborder: 1px solid &lt;&lt;colour dropdown-border&gt;&gt;;\n\tbackground-color: &lt;&lt;colour dropdown-background&gt;&gt;;\n\tpadding: 7px 0 7px 0;\n\tmargin: 4px 0 0 0;\n\twhite-space: nowrap;\n\ttext-shadow: none;\n\tline-height: 1.4;\n}\n\n.tc-drop-down .tc-drop-down {\n\tmargin-left: 14px;\n}\n\n.tc-drop-down button svg, .tc-drop-down a svg  {\n\tfill: &lt;&lt;colour foreground&gt;&gt;;\n}\n\n.tc-drop-down button.tc-btn-invisible:hover svg {\n\tfill: &lt;&lt;colour foreground&gt;&gt;;\n}\n\n.tc-drop-down p {\n\tpadding: 0 14px 0 14px;\n}\n\n.tc-drop-down svg {\n\twidth: 1em;\n\theight: 1em;\n}\n\n.tc-drop-down img {\n\twidth: 1em;\n}\n\n.tc-drop-down-language-chooser img {\n\twidth: 2em;\n\tvertical-align: baseline;\n}\n\n.tc-drop-down a, .tc-drop-down button {\n\tdisplay: block;\n\tpadding: 0 14px 0 14px;\n\twidth: 100%;\n\ttext-align: left;\n\tcolor: &lt;&lt;colour foreground&gt;&gt;;\n\tline-height: 1.4;\n}\n\n.tc-drop-down .tc-file-input-wrapper {\n\twidth: 100%;\n}\n\n.tc-drop-down .tc-file-input-wrapper button {\n\tcolor: &lt;&lt;colour foreground&gt;&gt;;\n}\n\n.tc-drop-down a:hover, .tc-drop-down button:hover, .tc-drop-down .tc-file-input-wrapper:hover button {\n\tcolor: &lt;&lt;colour tiddler-link-background&gt;&gt;;\n\tbackground-color: &lt;&lt;colour tiddler-link-foreground&gt;&gt;;\n\ttext-decoration: none;\n}\n\n.tc-drop-down .tc-tab-buttons button {\n\tbackground-color: &lt;&lt;colour dropdown-tab-background&gt;&gt;;\n}\n\n.tc-drop-down .tc-tab-buttons button.tc-tab-selected {\n\tbackground-color: &lt;&lt;colour dropdown-tab-background-selected&gt;&gt;;\n\tborder-bottom: 1px solid &lt;&lt;colour dropdown-tab-background-selected&gt;&gt;;\n}\n\n.tc-drop-down-bullet {\n\tdisplay: inline-block;\n\twidth: 0.5em;\n}\n\n.tc-drop-down .tc-tab-contents a {\n\tpadding: 0 0.5em 0 0.5em;\n}\n\n.tc-block-dropdown-wrapper {\n\tposition: relative;\n}\n\n.tc-block-dropdown {\n\tposition: absolute;\n\tmin-width: 220px;\n\tborder: 1px solid &lt;&lt;colour dropdown-border&gt;&gt;;\n\tbackground-color: &lt;&lt;colour dropdown-background&gt;&gt;;\n\tpadding: 7px 0;\n\tmargin: 4px 0 0 0;\n\twhite-space: nowrap;\n\tz-index: 1000;\n}\n\n.tc-block-dropdown a {\n\tdisplay: block;\n\tpadding: 4px 14px 4px 14px;\n}\n\n.tc-drop-down .tc-dropdown-item,\n.tc-block-dropdown .tc-dropdown-item {\n\tpadding: 4px 14px 4px 7px;\n\tcolor: &lt;&lt;colour muted-foreground&gt;&gt;;\n}\n\n.tc-block-dropdown a:hover {\n\tcolor: &lt;&lt;colour tiddler-link-background&gt;&gt;;\n\tbackground-color: &lt;&lt;colour tiddler-link-foreground&gt;&gt;;\n\ttext-decoration: none;\n}\n\n/*\n** Modals\n*/\n\n.tc-modal-wrapper {\n\tposition: fixed;\n\toverflow: auto;\n\toverflow-y: scroll;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n}\n\n.tc-modal-backdrop {\n\tposition: fixed;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tz-index: 1000;\n\tbackground-color: &lt;&lt;colour modal-backdrop&gt;&gt;;\n}\n\n.tc-modal {\n\tz-index: 1100;\n\tbackground-color: &lt;&lt;colour modal-background&gt;&gt;;\n\tborder: 1px solid &lt;&lt;colour modal-border&gt;&gt;;\n}\n\n@media (max-width: 55em) {\n\t.tc-modal {\n\t\tposition: fixed;\n\t\ttop: 1em;\n\t\tleft: 1em;\n\t\tright: 1em;\n\t}\n\n\t.tc-modal-body {\n\t\toverflow-y: auto;\n\t\tmax-height: 400px;\n\t}\n}\n\n@media (min-width: 55em) {\n\t.tc-modal {\n\t\tposition: relative;\n\t\twidth: 50%;\n\t\tmargin: 30px auto;\n\t}\n}\n\n.tc-modal-header {\n\tpadding: 9px 15px;\n\tborder-bottom: 1px solid &lt;&lt;colour modal-header-border&gt;&gt;;\n}\n\n.tc-modal-header h3 {\n\tmargin: 0;\n\tline-height: 30px;\n}\n\n.tc-modal-body {\n\tpadding: 15px;\n}\n\n.tc-modal-footer {\n\tpadding: 14px 15px 15px;\n\tmargin-bottom: 0;\n\ttext-align: right;\n\tbackground-color: &lt;&lt;colour modal-footer-background&gt;&gt;;\n\tborder-top: 1px solid &lt;&lt;colour modal-footer-border&gt;&gt;;\n}\n\n/*\n** Notifications\n*/\n\n.tc-notification {\n\tposition: fixed;\n\ttop: 14px;\n\tright: 42px;\n\tz-index: 1300;\n\tmax-width: 280px;\n\tpadding: 0 14px 0 14px;\n\tbackground-color: &lt;&lt;colour notification-background&gt;&gt;;\n\tborder: 1px solid &lt;&lt;colour notification-border&gt;&gt;;\n}\n\n/*\n** Tabs\n*/\n\n.tc-tab-set.tc-vertical {\n\tdisplay: -webkit-flex;\n\tdisplay: flex;\n}\n\n.tc-tab-buttons {\n\tfont-size: 0.85em;\n\tpadding-top: 1em;\n\tmargin-bottom: -2px;\n}\n\n.tc-tab-buttons.tc-vertical  {\n\tz-index: 100;\n\tdisplay: block;\n\tpadding-top: 14px;\n\tvertical-align: top;\n\ttext-align: right;\n\tmargin-bottom: inherit;\n\tmargin-right: -1px;\n\tmax-width: 33%;\n\t-webkit-flex: 0 0 auto;\n\tflex: 0 0 auto;\n}\n\n.tc-tab-buttons button.tc-tab-selected {\n\tcolor: &lt;&lt;colour tab-foreground-selected&gt;&gt;;\n\tbackground-color: &lt;&lt;colour tab-background-selected&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour tab-border-selected&gt;&gt;;\n\tborder-top: 1px solid &lt;&lt;colour tab-border-selected&gt;&gt;;\n\tborder-right: 1px solid &lt;&lt;colour tab-border-selected&gt;&gt;;\n}\n\n.tc-tab-buttons button {\n\tcolor: &lt;&lt;colour tab-foreground&gt;&gt;;\n\tpadding: 3px 5px 3px 5px;\n\tfont-weight: 300;\n\tborder: none;\n\tbackground: inherit;\n\tbackground-color: &lt;&lt;colour tab-background&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-top: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-right: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-top-left-radius: 2px;\n\tborder-top-right-radius: 2px;\n}\n\n.tc-tab-buttons.tc-vertical button {\n\tdisplay: block;\n\twidth: 100%;\n\tmargin-top: 3px;\n\ttext-align: right;\n\tbackground-color: &lt;&lt;colour tab-background&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-bottom: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-right: none;\n\tborder-top-left-radius: 2px;\n\tborder-bottom-left-radius: 2px;\n}\n\n.tc-tab-buttons.tc-vertical button.tc-tab-selected {\n\tbackground-color: &lt;&lt;colour tab-background-selected&gt;&gt;;\n\tborder-right: 1px solid &lt;&lt;colour tab-background-selected&gt;&gt;;\n}\n\n.tc-tab-divider {\n\tborder-top: 1px solid &lt;&lt;colour tab-divider&gt;&gt;;\n}\n\n.tc-tab-divider.tc-vertical  {\n\tdisplay: none;\n}\n\n.tc-tab-content {\n\tmargin-top: 14px;\n}\n\n.tc-tab-content.tc-vertical  {\n\tdisplay: inline-block;\n\tvertical-align: top;\n\tpadding-top: 0;\n\tpadding-left: 14px;\n\tborder-left: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\t-webkit-flex: 1 0 70%;\n\tflex: 1 0 70%;\n}\n\n.tc-sidebar-lists .tc-tab-buttons {\n\tmargin-bottom: -1px;\n}\n\n.tc-sidebar-lists .tc-tab-buttons button.tc-tab-selected {\n\tbackground-color: &lt;&lt;colour sidebar-tab-background-selected&gt;&gt;;\n\tcolor: &lt;&lt;colour sidebar-tab-foreground-selected&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour sidebar-tab-border-selected&gt;&gt;;\n\tborder-top: 1px solid &lt;&lt;colour sidebar-tab-border-selected&gt;&gt;;\n\tborder-right: 1px solid &lt;&lt;colour sidebar-tab-border-selected&gt;&gt;;\n}\n\n.tc-sidebar-lists .tc-tab-buttons button {\n\tbackground-color: &lt;&lt;colour sidebar-tab-background&gt;&gt;;\n\tcolor: &lt;&lt;colour sidebar-tab-foreground&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour sidebar-tab-border&gt;&gt;;\n\tborder-top: 1px solid &lt;&lt;colour sidebar-tab-border&gt;&gt;;\n\tborder-right: 1px solid &lt;&lt;colour sidebar-tab-border&gt;&gt;;\n}\n\n.tc-sidebar-lists .tc-tab-divider {\n\tborder-top: 1px solid &lt;&lt;colour sidebar-tab-divider&gt;&gt;;\n}\n\n.tc-more-sidebar .tc-tab-buttons button {\n\tbackground-color: &lt;&lt;colour sidebar-tab-background&gt;&gt;;\n\tborder-top: none;\n\tborder-left: none;\n\tborder-bottom: none;\n\tborder-right: 1px solid #ccc;\n\tmargin-bottom: inherit;\n}\n\n.tc-more-sidebar .tc-tab-buttons button.tc-tab-selected {\n\tbackground-color: &lt;&lt;colour sidebar-tab-background-selected&gt;&gt;;\n\tborder: none;\n}\n\n/*\n** Alerts\n*/\n\n.tc-alerts {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tmax-width: 500px;\n\tz-index: 20000;\n}\n\n.tc-alert {\n\tposition: relative;\n\tmargin: 28px;\n\tpadding: 14px 14px 14px 14px;\n\tborder: 2px solid &lt;&lt;colour alert-border&gt;&gt;;\n\tbackground-color: &lt;&lt;colour alert-background&gt;&gt;;\n}\n\n.tc-alert-toolbar {\n\tposition: absolute;\n\ttop: 14px;\n\tright: 14px;\n}\n\n.tc-alert-toolbar svg {\n\tfill: &lt;&lt;colour alert-muted-foreground&gt;&gt;;\n}\n\n.tc-alert-subtitle {\n\tcolor: &lt;&lt;colour alert-muted-foreground&gt;&gt;;\n\tfont-weight: bold;\n}\n\n.tc-alert-highlight {\n\tcolor: &lt;&lt;colour alert-highlight&gt;&gt;;\t\n}\n\n.tc-static-alert {\n\tposition: relative;\n}\n\n.tc-static-alert-inner {\n\tpadding: 0 2px 2px 42px;\n\tcolor: &lt;&lt;colour static-alert-foreground&gt;&gt;;\n\tposition: absolute;\n}\n\n/*\n** Control panel\n*/\n\n.tc-control-panel td {\n\tpadding: 4px;\n}\n\n.tc-control-panel table, .tc-control-panel table input, .tc-control-panel table textarea {\n\twidth: 100%;\n}\n\n.tc-plugin-info {\n\tdisplay: block;\n\tborder: 1px solid &lt;&lt;colour muted-foreground&gt;&gt;;\n\tbackground-colour: &lt;&lt;colour background&gt;&gt;;\n\tmargin: 1em 0 1em 0;\n\tpadding: 8px;\n}\n\n.tc-plugin-info-disabled {\n\tbackground: -webkit-repeating-linear-gradient(45deg, #ff0, #ff0 10px, #eee 10px, #eee 20px);\n\tbackground: repeating-linear-gradient(45deg, #ff0, #ff0 10px, #eee 10px, #eee 20px);\n}\n\n.tc-plugin-info-disabled:hover {\n\tbackground: -webkit-repeating-linear-gradient(45deg, #aa0, #aa0 10px, #888 10px, #888 20px);\n\tbackground: repeating-linear-gradient(45deg, #aa0, #aa0 10px, #888 10px, #888 20px);\n}\n\na.tc-tiddlylink.tc-plugin-info:hover {\n\ttext-decoration: none;\n\tbackground-color: &lt;&lt;colour primary&gt;&gt;;\n\tcolor: &lt;&lt;colour background&gt;&gt;;\n\tfill: &lt;&lt;colour foreground&gt;&gt;;\n}\n\na.tc-tiddlylink.tc-plugin-info:hover svg {\n\tfill: &lt;&lt;colour foreground&gt;&gt;;\n}\n\n.tc-plugin-info-chunk {\n\tdisplay: inline-block;\n\tvertical-align: middle;\t\n}\n\na.tc-plugin-info img, a.tc-plugin-info svg {\n\twidth: 2em;\n\theight: 2em;\n\tfill: &lt;&lt;colour muted-foreground&gt;&gt;;\n}\n\n.tc-plugin-info-dropdown {\n\tborder: 1px solid &lt;&lt;colour muted-foreground&gt;&gt;;\n\tpadding: 1em 1em 1em 1em;\n\tmargin-top: -1em;\n}\n\n/*\n** Message boxes\n*/\n\n.tc-message-box {\n\tborder: 1px solid &lt;&lt;colour message-border&gt;&gt;;\n\tbackground: &lt;&lt;colour message-background&gt;&gt;;\n\tpadding: 0px 21px 0px 21px;\n\tfont-size: 12px;\n\tline-height: 18px;\n\tcolor: &lt;&lt;colour message-foreground&gt;&gt;;\n}\n\n/*\n** Pictures\n*/\n\n.tc-bordered-image {\n\tborder: 1px solid &lt;&lt;colour muted-foreground&gt;&gt;;\n\tpadding: 5px;\n\tmargin: 5px;\n}\n\n/*\n** Floats\n*/\n\n.tc-float-right {\n\tfloat: right;\n}\n\n/*\n** Chooser\n*/\n\n.tc-chooser {\n\tborder: 1px solid &lt;&lt;colour table-border&gt;&gt;;\n}\n\n.tc-chooser-item {\n\tborder: 8px;\n}\n\n.tc-chooser-item a.tc-tiddlylink {\n\tdisplay: block;\n\ttext-decoration: none;\n\tcolor: &lt;&lt;colour tiddler-link-foreground&gt;&gt;;\n\tbackground-color: &lt;&lt;colour tiddler-link-background&gt;&gt;;\n\tmargin: 4px;\n}\n\n.tc-chooser-item a.tc-tiddlylink:hover {\n\ttext-decoration: none;\n\tcolor: &lt;&lt;colour tiddler-link-background&gt;&gt;;\n\tbackground-color: &lt;&lt;colour tiddler-link-foreground&gt;&gt;;\n}\n\n/*\n** Palette swatches\n*/\n\n.tc-swatches-horiz {\n}\n\n.tc-swatches-horiz .tc-swatch {\n\tdisplay: inline-block;\n}\n\n.tc-swatch {\n\twidth: 2em;\n\theight: 2em;\n\tmargin: 4px;\n\tborder: 1px solid #000;\n}\n\n/*\n** Table of contents\n*/\n\n.tc-sidebar-lists .tc-table-of-contents {\n\twhite-space: nowrap;\n}\n\n.tc-table-of-contents button {\n\tcolor: &lt;&lt;colour sidebar-foreground&gt;&gt;;\n}\n\n.tc-table-of-contents svg {\n\twidth: 0.7em;\n\theight: 0.7em;\n\tvertical-align: middle;\n\tfill: &lt;&lt;colour sidebar-foreground&gt;&gt;;\n}\n\n.tc-table-of-contents ol {\n\tlist-style-type: none;\n\tpadding-left: 0;\n}\n\n.tc-table-of-contents ol ol {\n\tpadding-left: 1em;\n}\n\n.tc-table-of-contents li {\n\tfont-size: 1.0em;\n\tfont-weight: bold;\n}\n\n.tc-table-of-contents li a {\n\tfont-weight: bold;\n}\n\n.tc-table-of-contents li li {\n\tfont-size: 0.95em;\n\tfont-weight: normal;\n\tline-height: 1.4;\n}\n\n.tc-table-of-contents li li a {\n\tfont-weight: normal;\n}\n\n.tc-table-of-contents li li li {\n\tfont-size: 0.95em;\n\tfont-weight: 200;\n\tline-height: 1.5;\n}\n\n.tc-table-of-contents li li li a {\n\tfont-weight: bold;\n}\n\n.tc-table-of-contents li li li li {\n\tfont-size: 0.95em;\n\tfont-weight: 200;\n}\n\n.tc-tabbed-table-of-contents {\n\tdisplay: -webkit-flex;\n\tdisplay: flex;\n}\n\n.tc-tabbed-table-of-contents .tc-table-of-contents {\n\tz-index: 100;\n\tdisplay: inline-block;\n\tpadding-left: 1em;\n\tmax-width: 50%;\n\t-webkit-flex: 0 0 auto;\n\tflex: 0 0 auto;\n\tbackground: &lt;&lt;colour tab-background&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-top: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-bottom: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n}\n\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item &gt; a,\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item-selected &gt; a {\n\tdisplay: block;\n\tpadding: 0.12em 1em 0.12em 0.25em;\n}\n\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item &gt; a {\n\tborder-top: 1px solid &lt;&lt;colour tab-background&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour tab-background&gt;&gt;;\n\tborder-bottom: 1px solid &lt;&lt;colour tab-background&gt;&gt;;\n}\n\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item &gt; a:hover {\n\ttext-decoration: none;\n\tborder-top: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-bottom: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tbackground: &lt;&lt;colour tab-border&gt;&gt;;\n}\n\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item-selected &gt; a {\n\tborder-top: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-left: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tborder-bottom: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\tbackground: &lt;&lt;colour background&gt;&gt;;\n\tmargin-right: -1px;\n}\n\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item-selected &gt; a:hover {\n\ttext-decoration: none;\n}\n\n.tc-tabbed-table-of-contents .tc-tabbed-table-of-contents-content {\n\tdisplay: inline-block;\n\tvertical-align: top;\n\tpadding-left: 1.5em;\n\tpadding-right: 1.5em;\n\tborder: 1px solid &lt;&lt;colour tab-border&gt;&gt;;\n\t-webkit-flex: 1 0 50%;\n\tflex: 1 0 50%;\n}\n\n/*\n** Dirty indicator\n*/\n\nbody.tc-dirty span.tc-dirty-indicator, body.tc-dirty span.tc-dirty-indicator svg {\n\tfill: &lt;&lt;colour dirty-indicator&gt;&gt;;\n\tcolor: &lt;&lt;colour dirty-indicator&gt;&gt;;\n}\n\n/*\n** File inputs\n*/\n\n.tc-file-input-wrapper {\n\tposition: relative;\n\toverflow: hidden;\n\tdisplay: inline-block;\n\tvertical-align: middle;\n}\n\n.tc-file-input-wrapper input[type=file] {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tfont-size: 999px;\n\tmax-width: 100%;\n\tmax-height: 100%;\n\tfilter: alpha(opacity=0);\n\topacity: 0;\n\toutline: none;\n\tbackground: white;\n\tcursor: pointer;\n\tdisplay: inline-block;\n}\n\n/*\n** Errors\n*/\n\n.tc-error {\n\tbackground: #f00;\n\tcolor: #fff;\n}\n&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize&quot;,
            &quot;text&quot;: &quot;15px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/bodylineheight&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/bodylineheight&quot;,
            &quot;text&quot;: &quot;22px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/fontsize&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/fontsize&quot;,
            &quot;text&quot;: &quot;14px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/lineheight&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/lineheight&quot;,
            &quot;text&quot;: &quot;20px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/storyleft&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/storyleft&quot;,
            &quot;text&quot;: &quot;0px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/storytop&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/storytop&quot;,
            &quot;text&quot;: &quot;0px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/storyright&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/storyright&quot;,
            &quot;text&quot;: &quot;770px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/storywidth&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/storywidth&quot;,
            &quot;text&quot;: &quot;770px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth&quot;,
            &quot;text&quot;: &quot;686px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint&quot;,
            &quot;text&quot;: &quot;960px&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/reset&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/reset&quot;,
            &quot;type&quot;: &quot;text/plain&quot;,
            &quot;text&quot;: &quot;/*! normalize.css v3.0.0 | MIT License | git.io/normalize */\n\n/**\n * 1. Set default font family to sans-serif.\n * 2. Prevent iOS text size adjust after orientation change, without disabling\n *    user zoom.\n */\n\nhtml {\n  font-family: sans-serif; /* 1 */\n  -ms-text-size-adjust: 100%; /* 2 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n}\n\n/**\n * Remove default margin.\n */\n\nbody {\n  margin: 0;\n}\n\n/* HTML5 display definitions\n   ========================================================================== */\n\n/**\n * Correct `block` display not defined in IE 8/9.\n */\n\narticle,\naside,\ndetails,\nfigcaption,\nfigure,\nfooter,\nheader,\nhgroup,\nmain,\nnav,\nsection,\nsummary {\n  display: block;\n}\n\n/**\n * 1. Correct `inline-block` display not defined in IE 8/9.\n * 2. Normalize vertical alignment of `progress` in Chrome, Firefox, and Opera.\n */\n\naudio,\ncanvas,\nprogress,\nvideo {\n  display: inline-block; /* 1 */\n  vertical-align: baseline; /* 2 */\n}\n\n/**\n * Prevent modern browsers from displaying `audio` without controls.\n * Remove excess height in iOS 5 devices.\n */\n\naudio:not([controls]) {\n  display: none;\n  height: 0;\n}\n\n/**\n * Address `[hidden]` styling not present in IE 8/9.\n * Hide the `template` element in IE, Safari, and Firefox &lt; 22.\n */\n\n[hidden],\ntemplate {\n  display: none;\n}\n\n/* Links\n   ========================================================================== */\n\n/**\n * Remove the gray background color from active links in IE 10.\n */\n\na {\n  background: transparent;\n}\n\n/**\n * Improve readability when focused and also mouse hovered in all browsers.\n */\n\na:active,\na:hover {\n  outline: 0;\n}\n\n/* Text-level semantics\n   ========================================================================== */\n\n/**\n * Address styling not present in IE 8/9, Safari 5, and Chrome.\n */\n\nabbr[title] {\n  border-bottom: 1px dotted;\n}\n\n/**\n * Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome.\n */\n\nb,\nstrong {\n  font-weight: bold;\n}\n\n/**\n * Address styling not present in Safari 5 and Chrome.\n */\n\ndfn {\n  font-style: italic;\n}\n\n/**\n * Address variable `h1` font-size and margin within `section` and `article`\n * contexts in Firefox 4+, Safari 5, and Chrome.\n */\n\nh1 {\n  font-size: 2em;\n  margin: 0.67em 0;\n}\n\n/**\n * Address styling not present in IE 8/9.\n */\n\nmark {\n  background: #ff0;\n  color: #000;\n}\n\n/**\n * Address inconsistent and variable font size in all browsers.\n */\n\nsmall {\n  font-size: 80%;\n}\n\n/**\n * Prevent `sub` and `sup` affecting `line-height` in all browsers.\n */\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsup {\n  top: -0.5em;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\n/* Embedded content\n   ========================================================================== */\n\n/**\n * Remove border when inside `a` element in IE 8/9.\n */\n\nimg {\n  border: 0;\n}\n\n/**\n * Correct overflow displayed oddly in IE 9.\n */\n\nsvg:not(:root) {\n  overflow: hidden;\n}\n\n/* Grouping content\n   ========================================================================== */\n\n/**\n * Address margin not present in IE 8/9 and Safari 5.\n */\n\nfigure {\n  margin: 1em 40px;\n}\n\n/**\n * Address differences between Firefox and other browsers.\n */\n\nhr {\n  -moz-box-sizing: content-box;\n  box-sizing: content-box;\n  height: 0;\n}\n\n/**\n * Contain overflow in all browsers.\n */\n\npre {\n  overflow: auto;\n}\n\n/**\n * Address odd `em`-unit font size rendering in all browsers.\n */\n\ncode,\nkbd,\npre,\nsamp {\n  font-family: monospace, monospace;\n  font-size: 1em;\n}\n\n/* Forms\n   ========================================================================== */\n\n/**\n * Known limitation: by default, Chrome and Safari on OS X allow very limited\n * styling of `select`, unless a `border` property is set.\n */\n\n/**\n * 1. Correct color not being inherited.\n *    Known issue: affects color of disabled elements.\n * 2. Correct font properties not being inherited.\n * 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome.\n */\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  color: inherit; /* 1 */\n  font: inherit; /* 2 */\n  margin: 0; /* 3 */\n}\n\n/**\n * Address `overflow` set to `hidden` in IE 8/9/10.\n */\n\nbutton {\n  overflow: visible;\n}\n\n/**\n * Address inconsistent `text-transform` inheritance for `button` and `select`.\n * All other form control elements do not inherit `text-transform` values.\n * Correct `button` style inheritance in Firefox, IE 8+, and Opera\n * Correct `select` style inheritance in Firefox.\n */\n\nbutton,\nselect {\n  text-transform: none;\n}\n\n/**\n * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`\n *    and `video` controls.\n * 2. Correct inability to style clickable `input` types in iOS.\n * 3. Improve usability and consistency of cursor style between image-type\n *    `input` and others.\n */\n\nbutton,\nhtml input[type=\&quot;button\&quot;], /* 1 */\ninput[type=\&quot;reset\&quot;],\ninput[type=\&quot;submit\&quot;] {\n  -webkit-appearance: button; /* 2 */\n  cursor: pointer; /* 3 */\n}\n\n/**\n * Re-set default cursor for disabled elements.\n */\n\nbutton[disabled],\nhtml input[disabled] {\n  cursor: default;\n}\n\n/**\n * Remove inner padding and border in Firefox 4+.\n */\n\nbutton::-moz-focus-inner,\ninput::-moz-focus-inner {\n  border: 0;\n  padding: 0;\n}\n\n/**\n * Address Firefox 4+ setting `line-height` on `input` using `!important` in\n * the UA stylesheet.\n */\n\ninput {\n  line-height: normal;\n}\n\n/**\n * It's recommended that you don't attempt to style these elements.\n * Firefox's implementation doesn't respect box-sizing, padding, or width.\n *\n * 1. Address box sizing set to `content-box` in IE 8/9/10.\n * 2. Remove excess padding in IE 8/9/10.\n */\n\ninput[type=\&quot;checkbox\&quot;],\ninput[type=\&quot;radio\&quot;] {\n  box-sizing: border-box; /* 1 */\n  padding: 0; /* 2 */\n}\n\n/**\n * Fix the cursor style for Chrome's increment/decrement buttons. For certain\n * `font-size` values of the `input`, it causes the cursor style of the\n * decrement button to change from `default` to `text`.\n */\n\ninput[type=\&quot;number\&quot;]::-webkit-inner-spin-button,\ninput[type=\&quot;number\&quot;]::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/**\n * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.\n * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome\n *    (include `-moz` to future-proof).\n */\n\ninput[type=\&quot;search\&quot;] {\n  -webkit-appearance: textfield; /* 1 */\n  -moz-box-sizing: content-box;\n  -webkit-box-sizing: content-box; /* 2 */\n  box-sizing: content-box;\n}\n\n/**\n * Remove inner padding and search cancel button in Safari and Chrome on OS X.\n * Safari (but not Chrome) clips the cancel button when the search input has\n * padding (and `textfield` appearance).\n */\n\ninput[type=\&quot;search\&quot;]::-webkit-search-cancel-button,\ninput[type=\&quot;search\&quot;]::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/**\n * Define consistent border, margin, and padding.\n */\n\nfieldset {\n  border: 1px solid #c0c0c0;\n  margin: 0 2px;\n  padding: 0.35em 0.625em 0.75em;\n}\n\n/**\n * 1. Correct `color` not being inherited in IE 8/9.\n * 2. Remove padding so people aren't caught out if they zero out fieldsets.\n */\n\nlegend {\n  border: 0; /* 1 */\n  padding: 0; /* 2 */\n}\n\n/**\n * Remove default vertical scrollbar in IE 8/9.\n */\n\ntextarea {\n  overflow: auto;\n}\n\n/**\n * Don't inherit the `font-weight` (applied by a rule above).\n * NOTE: the default cannot safely be changed in Chrome and Safari on OS X.\n */\n\noptgroup {\n  font-weight: bold;\n}\n\n/* Tables\n   ========================================================================== */\n\n/**\n * Remove most spacing between table cells.\n */\n\ntable {\n  border-collapse: collapse;\n  border-spacing: 0;\n}\n\ntd,\nth {\n  padding: 0;\n}\n&quot;
        },
        &quot;$:/themes/tiddlywiki/vanilla/settings/fontfamily&quot;: {
            &quot;title&quot;: &quot;$:/themes/tiddlywiki/vanilla/settings/fontfamily&quot;,
            &quot;text&quot;: &quot;\&quot;Helvetica Neue\&quot;, Helvetica, Arial, \&quot;Lucida Grande\&quot;, sans-serif&quot;
        }
    }
}</pre>
</div>
<div created="20150302200519432" modified="20150302213137409" tags="" title="Book I (Jowett translation)">
<pre>I went down yesterday to the Piraeus with Glaucon the son of Ariston, that I might offer up my prayers to the goddess (Bendis, the Thracian Artemis.); and also because I wanted to see in what manner they would celebrate the festival, which was a new thing. I was delighted with the procession of the inhabitants; but that of the Thracians was equally, if not more, beautiful. When we had finished our prayers and viewed the spectacle, we turned in the direction of the city; and at that instant Polemarchus the son of Cephalus chanced to catch sight of us from a distance as we were starting on our way home, and told his servant to run and bid us wait for him. The servant took hold of me by the cloak behind, and said: Polemarchus desires you to wait.

I turned round, and asked him where his master was.

There he is, said the youth, coming after you, if you will only wait.

Certainly we will, said Glaucon; and in a few minutes Polemarchus appeared, and with him Adeimantus, Glaucon's brother, Niceratus the son of Nicias, and several others who had been at the procession.

Polemarchus said to me: I perceive, Socrates, that you and your companion are already on your way to the city.

You are not far wrong, I said.

But do you see, he rejoined, how many we are?

Of course.

And are you stronger than all these? for if not, you will have to remain where you are.

May there not be the alternative, I said, that we may persuade you to let us go?

But can you persuade us, if we refuse to listen to you? he said.

Certainly not, replied Glaucon.

Then we are not going to listen; of that you may be assured.

Adeimantus added: Has no one told you of the torch-race on horseback in honour of the goddess which will take place in the evening?

With horses! I replied: That is a novelty. Will horsemen carry torches and pass them one to another during the race?

Yes, said Polemarchus, and not only so, but a festival will be celebrated at night, which you certainly ought to see. Let us rise soon after supper and see this festival; there will be a gathering of young men, and we will have a good talk. Stay then, and do not be perverse.

Glaucon said: I suppose, since you insist, that we must.

Very good, I replied.

Accordingly we went with Polemarchus to his house; and there we found his brothers Lysias and Euthydemus, and with them Thrasymachus the Chalcedonian, Charmantides the Paeanian, and Cleitophon the son of Aristonymus. There too was Cephalus the father of Polemarchus, whom I had not seen for a long time, and I thought him very much aged. He was seated on a cushioned chair, and had a garland on his head, for he had been sacrificing in the court; and there were some other chairs in the room arranged in a semicircle, upon which we sat down by him. He saluted me eagerly, and then he said:—

You don't come to see me, Socrates, as often as you ought: If I were still able to go and see you I would not ask you to come to me. But at my age I can hardly get to the city, and therefore you should come oftener to the Piraeus. For let me tell you, that the more the pleasures of the body fade away, the greater to me is the pleasure and charm of conversation. Do not then deny my request, but make our house your resort and keep company with these young men; we are old friends, and you will be quite at home with us.

I replied: There is nothing which for my part I like better, Cephalus, than conversing with aged men; for I regard them as travellers who have gone a journey which I too may have to go, and of whom I ought to enquire, whether the way is smooth and easy, or rugged and difficult. And this is a question which I should like to ask of you who have arrived at that time which the poets call the 'threshold of old age'—Is life harder towards the end, or what report do you give of it?

I will tell you, Socrates, he said, what my own feeling is. Men of my age flock together; we are birds of a feather, as the old proverb says; and at our meetings the tale of my acquaintance commonly is—I cannot eat, I cannot drink; the pleasures of youth and love are fled away: there was a good time once, but now that is gone, and life is no longer life. Some complain of the slights which are put upon them by relations, and they will tell you sadly of how many evils their old age is the cause. But to me, Socrates, these complainers seem to blame that which is not really in fault. For if old age were the cause, I too being old, and every other old man, would have felt as they do. But this is not my own experience, nor that of others whom I have known. How well I remember the aged poet Sophocles, when in answer to the question, How does love suit with age, Sophocles,—are you still the man you were? Peace, he replied; most gladly have I escaped the thing of which you speak; I feel as if I had escaped from a mad and furious master. His words have often occurred to my mind since, and they seem as good to me now as at the time when he uttered them. For certainly old age has a great sense of calm and freedom; when the passions relax their hold, then, as Sophocles says, we are freed from the grasp not of one mad master only, but of many. The truth is, Socrates, that these regrets, and also the complaints about relations, are to be attributed to the same cause, which is not old age, but men's characters and tempers; for he who is of a calm and happy nature will hardly feel the pressure of age, but to him who is of an opposite disposition youth and age are equally a burden.

I listened in admiration, and wanting to draw him out, that he might go on—Yes, Cephalus, I said: but I rather suspect that people in general are not convinced by you when you speak thus; they think that old age sits lightly upon you, not because of your happy disposition, but because you are rich, and wealth is well known to be a great comforter.

You are right, he replied; they are not convinced: and there is something in what they say; not, however, so much as they imagine. I might answer them as Themistocles answered the Seriphian who was abusing him and saying that he was famous, not for his own merits but because he was an Athenian: 'If you had been a native of my country or I of yours, neither of us would have been famous.' And to those who are not rich and are impatient of old age, the same reply may be made; for to the good poor man old age cannot be a light burden, nor can a bad rich man ever have peace with himself.

May I ask, Cephalus, whether your fortune was for the most part inherited or acquired by you?

Acquired! Socrates; do you want to know how much I acquired? In the art of making money I have been midway between my father and grandfather: for my grandfather, whose name I bear, doubled and trebled the value of his patrimony, that which he inherited being much what I possess now; but my father Lysanias reduced the property below what it is at present: and I shall be satisfied if I leave to these my sons not less but a little more than I received.

That was why I asked you the question, I replied, because I see that you are indifferent about money, which is a characteristic rather of those who have inherited their fortunes than of those who have acquired them; the makers of fortunes have a second love of money as a creation of their own, resembling the affection of authors for their own poems, or of parents for their children, besides that natural love of it for the sake of use and profit which is common to them and all men. And hence they are very bad company, for they can talk about nothing but the praises of wealth.

That is true, he said.

Yes, that is very true, but may I ask another question?—What do you consider to be the greatest blessing which you have reaped from your wealth?

One, he said, of which I could not expect easily to convince others. For let me tell you, Socrates, that when a man thinks himself to be near death, fears and cares enter into his mind which he never had before; the tales of a world below and the punishment which is exacted there of deeds done here were once a laughing matter to him, but now he is tormented with the thought that they may be true: either from the weakness of age, or because he is now drawing nearer to that other place, he has a clearer view of these things; suspicions and alarms crowd thickly upon him, and he begins to reflect and consider what wrongs he has done to others. And when he finds that the sum of his transgressions is great he will many a time like a child start up in his sleep for fear, and he is filled with dark forebodings. But to him who is conscious of no sin, sweet hope, as Pindar charmingly says, is the kind nurse of his age:

'Hope,' he says, 'cherishes the soul of him who lives in justice and holiness, and is the nurse of his age and the companion of his journey;—hope which is mightiest to sway the restless soul of man.'

How admirable are his words! And the great blessing of riches, I do not say to every man, but to a good man, is, that he has had no occasion to deceive or to defraud others, either intentionally or unintentionally; and when he departs to the world below he is not in any apprehension about offerings due to the gods or debts which he owes to men. Now to this peace of mind the possession of wealth greatly contributes; and therefore I say, that, setting one thing against another, of the many advantages which wealth has to give, to a man of sense this is in my opinion the greatest.

Well said, Cephalus, I replied; but as concerning justice, what is it?—to speak the truth and to pay your debts—no more than this? And even to this are there not exceptions? Suppose that a friend when in his right mind has deposited arms with me and he asks for them when he is not in his right mind, ought I to give them back to him? No one would say that I ought or that I should be right in doing so, any more than they would say that I ought always to speak the truth to one who is in his condition.

You are quite right, he replied.

But then, I said, speaking the truth and paying your debts is not a correct definition of justice.

Quite correct, Socrates, if Simonides is to be believed, said Polemarchus interposing.

I fear, said Cephalus, that I must go now, for I have to look after the sacrifices, and I hand over the argument to Polemarchus and the company.

Is not Polemarchus your heir? I said.

To be sure, he answered, and went away laughing to the sacrifices.

Tell me then, O thou heir of the argument, what did Simonides say, and according to you truly say, about justice?

He said that the repayment of a debt is just, and in saying so he appears to me to be right.

I should be sorry to doubt the word of such a wise and inspired man, but his meaning, though probably clear to you, is the reverse of clear to me. For he certainly does not mean, as we were just now saying, that I ought to return a deposit of arms or of anything else to one who asks for it when he is not in his right senses; and yet a deposit cannot be denied to be a debt.

True.

Then when the person who asks me is not in his right mind I am by no means to make the return?

Certainly not.

When Simonides said that the repayment of a debt was justice, he did not mean to include that case?

Certainly not; for he thinks that a friend ought always to do good to a friend and never evil.

You mean that the return of a deposit of gold which is to the injury of the receiver, if the two parties are friends, is not the repayment of a debt,—that is what you would imagine him to say?

Yes.

And are enemies also to receive what we owe to them?

To be sure, he said, they are to receive what we owe them, and an enemy, as I take it, owes to an enemy that which is due or proper to him—that is to say, evil.

Simonides, then, after the manner of poets, would seem to have spoken darkly of the nature of justice; for he really meant to say that justice is the giving to each man what is proper to him, and this he termed a debt.

That must have been his meaning, he said.

By heaven! I replied; and if we asked him what due or proper thing is given by medicine, and to whom, what answer do you think that he would make to us?

He would surely reply that medicine gives drugs and meat and drink to human bodies.

And what due or proper thing is given by cookery, and to what?

Seasoning to food.

And what is that which justice gives, and to whom?

If, Socrates, we are to be guided at all by the analogy of the preceding instances, then justice is the art which gives good to friends and evil to enemies.

That is his meaning then?

I think so.

And who is best able to do good to his friends and evil to his enemies in time of sickness?

The physician.

Or when they are on a voyage, amid the perils of the sea?

The pilot.

And in what sort of actions or with a view to what result is the just man most able to do harm to his enemy and good to his friend?

In going to war against the one and in making alliances with the other.

But when a man is well, my dear Polemarchus, there is no need of a physician?

No.

And he who is not on a voyage has no need of a pilot?

No.

Then in time of peace justice will be of no use?

I am very far from thinking so.

You think that justice may be of use in peace as well as in war?

Yes.

Like husbandry for the acquisition of corn?

Yes.

Or like shoemaking for the acquisition of shoes,—that is what you mean?

Yes.

And what similar use or power of acquisition has justice in time of peace?

In contracts, Socrates, justice is of use.

And by contracts you mean partnerships?

Exactly.

But is the just man or the skilful player a more useful and better partner at a game of draughts?

The skilful player.

And in the laying of bricks and stones is the just man a more useful or better partner than the builder?

Quite the reverse.

Then in what sort of partnership is the just man a better partner than the harp-player, as in playing the harp the harp-player is certainly a better partner than the just man?

In a money partnership.

Yes, Polemarchus, but surely not in the use of money; for you do not want a just man to be your counsellor in the purchase or sale of a horse; a man who is knowing about horses would be better for that, would he not?

Certainly.

And when you want to buy a ship, the shipwright or the pilot would be better?

True.

Then what is that joint use of silver or gold in which the just man is to be preferred?

When you want a deposit to be kept safely.

You mean when money is not wanted, but allowed to lie?

Precisely.

That is to say, justice is useful when money is useless?

That is the inference.

And when you want to keep a pruning-hook safe, then justice is useful to the individual and to the state; but when you want to use it, then the art of the vine-dresser?

Clearly.

And when you want to keep a shield or a lyre, and not to use them, you would say that justice is useful; but when you want to use them, then the art of the soldier or of the musician?

Certainly.

And so of all other things;—justice is useful when they are useless, and useless when they are useful?

That is the inference.

Then justice is not good for much. But let us consider this further point: Is not he who can best strike a blow in a boxing match or in any kind of fighting best able to ward off a blow?

Certainly.

And he who is most skilful in preventing or escaping from a disease is best able to create one?

True.

And he is the best guard of a camp who is best able to steal a march upon the enemy?

Certainly.

Then he who is a good keeper of anything is also a good thief?

That, I suppose, is to be inferred.

Then if the just man is good at keeping money, he is good at stealing it.

That is implied in the argument.

Then after all the just man has turned out to be a thief. And this is a lesson which I suspect you must have learnt out of Homer; for he, speaking of Autolycus, the maternal grandfather of Odysseus, who is a favourite of his, affirms that

'He was excellent above all men in theft and perjury.'

And so, you and Homer and Simonides are agreed that justice is an art of theft; to be practised however 'for the good of friends and for the harm of enemies,'—that was what you were saying?

No, certainly not that, though I do not now know what I did say; but I still stand by the latter words.

Well, there is another question: By friends and enemies do we mean those who are so really, or only in seeming?

Surely, he said, a man may be expected to love those whom he thinks good, and to hate those whom he thinks evil.

Yes, but do not persons often err about good and evil: many who are not good seem to be so, and conversely?

That is true.

Then to them the good will be enemies and the evil will be their friends? True.

And in that case they will be right in doing good to the evil and evil to the good?

Clearly.

But the good are just and would not do an injustice?

True.

Then according to your argument it is just to injure those who do no wrong?

Nay, Socrates; the doctrine is immoral.

Then I suppose that we ought to do good to the just and harm to the unjust?

I like that better.

But see the consequence:—Many a man who is ignorant of human nature has friends who are bad friends, and in that case he ought to do harm to them; and he has good enemies whom he ought to benefit; but, if so, we shall be saying the very opposite of that which we affirmed to be the meaning of Simonides.

Very true, he said: and I think that we had better correct an error into which we seem to have fallen in the use of the words 'friend' and 'enemy.'

What was the error, Polemarchus? I asked.

We assumed that he is a friend who seems to be or who is thought good.

And how is the error to be corrected?

We should rather say that he is a friend who is, as well as seems, good; and that he who seems only, and is not good, only seems to be and is not a friend; and of an enemy the same may be said.

You would argue that the good are our friends and the bad our enemies?

Yes.

And instead of saying simply as we did at first, that it is just to do good to our friends and harm to our enemies, we should further say: It is just to do good to our friends when they are good and harm to our enemies when they are evil?

Yes, that appears to me to be the truth.

But ought the just to injure any one at all?

Undoubtedly he ought to injure those who are both wicked and his enemies.

When horses are injured, are they improved or deteriorated?

The latter.

Deteriorated, that is to say, in the good qualities of horses, not of dogs?

Yes, of horses.

And dogs are deteriorated in the good qualities of dogs, and not of horses?

Of course.

And will not men who are injured be deteriorated in that which is the proper virtue of man?

Certainly.

And that human virtue is justice?

To be sure.

Then men who are injured are of necessity made unjust?

That is the result.

But can the musician by his art make men unmusical?

Certainly not.

Or the horseman by his art make them bad horsemen?

Impossible.

And can the just by justice make men unjust, or speaking generally, can the good by virtue make them bad?

Assuredly not.

Any more than heat can produce cold?

It cannot.

Or drought moisture?

Clearly not.

Nor can the good harm any one?

Impossible.

And the just is the good?

Certainly.

Then to injure a friend or any one else is not the act of a just man, but of the opposite, who is the unjust?

I think that what you say is quite true, Socrates.

Then if a man says that justice consists in the repayment of debts, and that good is the debt which a just man owes to his friends, and evil the debt which he owes to his enemies,—to say this is not wise; for it is not true, if, as has been clearly shown, the injuring of another can be in no case just.

I agree with you, said Polemarchus.

Then you and I are prepared to take up arms against any one who attributes such a saying to Simonides or Bias or Pittacus, or any other wise man or seer?

I am quite ready to do battle at your side, he said.

Shall I tell you whose I believe the saying to be?

Whose?

I believe that Periander or Perdiccas or Xerxes or Ismenias the Theban, or some other rich and mighty man, who had a great opinion of his own power, was the first to say that justice is 'doing good to your friends and harm to your enemies.'

Most true, he said.

Yes, I said; but if this definition of justice also breaks down, what other can be offered?

Several times in the course of the discussion Thrasymachus had made an attempt to get the argument into his own hands, and had been put down by the rest of the company, who wanted to hear the end. But when Polemarchus and I had done speaking and there was a pause, he could no longer hold his peace; and, gathering himself up, he came at us like a wild beast, seeking to devour us. We were quite panic-stricken at the sight of him.

He roared out to the whole company: What folly, Socrates, has taken possession of you all? And why, sillybillies, do you knock under to one another? I say that if you want really to know what justice is, you should not only ask but answer, and you should not seek honour to yourself from the refutation of an opponent, but have your own answer; for there is many a one who can ask and cannot answer. And now I will not have you say that justice is duty or advantage or profit or gain or interest, for this sort of nonsense will not do for me; I must have clearness and accuracy.

I was panic-stricken at his words, and could not look at him without trembling. Indeed I believe that if I had not fixed my eye upon him, I should have been struck dumb: but when I saw his fury rising, I looked at him first, and was therefore able to reply to him.

Thrasymachus, I said, with a quiver, don't be hard upon us. Polemarchus and I may have been guilty of a little mistake in the argument, but I can assure you that the error was not intentional. If we were seeking for a piece of gold, you would not imagine that we were 'knocking under to one another,' and so losing our chance of finding it. And why, when we are seeking for justice, a thing more precious than many pieces of gold, do you say that we are weakly yielding to one another and not doing our utmost to get at the truth? Nay, my good friend, we are most willing and anxious to do so, but the fact is that we cannot. And if so, you people who know all things should pity us and not be angry with us.

How characteristic of Socrates! he replied, with a bitter laugh;—that's your ironical style! Did I not foresee—have I not already told you, that whatever he was asked he would refuse to answer, and try irony or any other shuffle, in order that he might avoid answering?

You are a philosopher, Thrasymachus, I replied, and well know that if you ask a person what numbers make up twelve, taking care to prohibit him whom you ask from answering twice six, or three times four, or six times two, or four times three, 'for this sort of nonsense will not do for me,'—then obviously, if that is your way of putting the question, no one can answer you. But suppose that he were to retort, 'Thrasymachus, what do you mean? If one of these numbers which you interdict be the true answer to the question, am I falsely to say some other number which is not the right one?—is that your meaning?'—How would you answer him?

Just as if the two cases were at all alike! he said.

Why should they not be? I replied; and even if they are not, but only appear to be so to the person who is asked, ought he not to say what he thinks, whether you and I forbid him or not?

I presume then that you are going to make one of the interdicted answers?

I dare say that I may, notwithstanding the danger, if upon reflection I approve of any of them.

But what if I give you an answer about justice other and better, he said, than any of these? What do you deserve to have done to you?

Done to me!—as becomes the ignorant, I must learn from the wise—that is what I deserve to have done to me.

What, and no payment! a pleasant notion!

I will pay when I have the money, I replied.

But you have, Socrates, said Glaucon: and you, Thrasymachus, need be under no anxiety about money, for we will all make a contribution for Socrates.

Yes, he replied, and then Socrates will do as he always does—refuse to answer himself, but take and pull to pieces the answer of some one else.

Why, my good friend, I said, how can any one answer who knows, and says that he knows, just nothing; and who, even if he has some faint notions of his own, is told by a man of authority not to utter them? The natural thing is, that the speaker should be some one like yourself who professes to know and can tell what he knows. Will you then kindly answer, for the edification of the company and of myself?

Glaucon and the rest of the company joined in my request, and Thrasymachus, as any one might see, was in reality eager to speak; for he thought that he had an excellent answer, and would distinguish himself. But at first he affected to insist on my answering; at length he consented to begin. Behold, he said, the wisdom of Socrates; he refuses to teach himself, and goes about learning of others, to whom he never even says Thank you.

That I learn of others, I replied, is quite true; but that I am ungrateful I wholly deny. Money I have none, and therefore I pay in praise, which is all I have; and how ready I am to praise any one who appears to me to speak well you will very soon find out when you answer; for I expect that you will answer well.

Listen, then, he said; I proclaim that justice is nothing else than the interest of the stronger. And now why do you not praise me? But of course you won't.

Let me first understand you, I replied. Justice, as you say, is the interest of the stronger. What, Thrasymachus, is the meaning of this? You cannot mean to say that because Polydamas, the pancratiast, is stronger than we are, and finds the eating of beef conducive to his bodily strength, that to eat beef is therefore equally for our good who are weaker than he is, and right and just for us?

That's abominable of you, Socrates; you take the words in the sense which is most damaging to the argument.

Not at all, my good sir, I said; I am trying to understand them; and I wish that you would be a little clearer.

Well, he said, have you never heard that forms of government differ; there are tyrannies, and there are democracies, and there are aristocracies?

Yes, I know.

And the government is the ruling power in each state?

Certainly.

And the different forms of government make laws democratical, aristocratical, tyrannical, with a view to their several interests; and these laws, which are made by them for their own interests, are the justice which they deliver to their subjects, and him who transgresses them they punish as a breaker of the law, and unjust. And that is what I mean when I say that in all states there is the same principle of justice, which is the interest of the government; and as the government must be supposed to have power, the only reasonable conclusion is, that everywhere there is one principle of justice, which is the interest of the stronger.

Now I understand you, I said; and whether you are right or not I will try to discover. But let me remark, that in defining justice you have yourself used the word 'interest' which you forbade me to use. It is true, however, that in your definition the words 'of the stronger' are added.

A small addition, you must allow, he said.

Great or small, never mind about that: we must first enquire whether what you are saying is the truth. Now we are both agreed that justice is interest of some sort, but you go on to say 'of the stronger'; about this addition I am not so sure, and must therefore consider further.

Proceed.

I will; and first tell me, Do you admit that it is just for subjects to obey their rulers?

I do.

But are the rulers of states absolutely infallible, or are they sometimes liable to err?

To be sure, he replied, they are liable to err.

Then in making their laws they may sometimes make them rightly, and sometimes not?

True.

When they make them rightly, they make them agreeably to their interest; when they are mistaken, contrary to their interest; you admit that?

Yes.

And the laws which they make must be obeyed by their subjects,—and that is what you call justice?

Doubtless.

Then justice, according to your argument, is not only obedience to the interest of the stronger but the reverse?

What is that you are saying? he asked.

I am only repeating what you are saying, I believe. But let us consider: Have we not admitted that the rulers may be mistaken about their own interest in what they command, and also that to obey them is justice? Has not that been admitted?

Yes.

Then you must also have acknowledged justice not to be for the interest of the stronger, when the rulers unintentionally command things to be done which are to their own injury. For if, as you say, justice is the obedience which the subject renders to their commands, in that case, O wisest of men, is there any escape from the conclusion that the weaker are commanded to do, not what is for the interest, but what is for the injury of the stronger?

Nothing can be clearer, Socrates, said Polemarchus.

Yes, said Cleitophon, interposing, if you are allowed to be his witness.

But there is no need of any witness, said Polemarchus, for Thrasymachus himself acknowledges that rulers may sometimes command what is not for their own interest, and that for subjects to obey them is justice.

Yes, Polemarchus,—Thrasymachus said that for subjects to do what was commanded by their rulers is just.

Yes, Cleitophon, but he also said that justice is the interest of the stronger, and, while admitting both these propositions, he further acknowledged that the stronger may command the weaker who are his subjects to do what is not for his own interest; whence follows that justice is the injury quite as much as the interest of the stronger.

But, said Cleitophon, he meant by the interest of the stronger what the stronger thought to be his interest,—this was what the weaker had to do; and this was affirmed by him to be justice.

Those were not his words, rejoined Polemarchus.

Never mind, I replied, if he now says that they are, let us accept his statement. Tell me, Thrasymachus, I said, did you mean by justice what the stronger thought to be his interest, whether really so or not?

Certainly not, he said. Do you suppose that I call him who is mistaken the stronger at the time when he is mistaken?

Yes, I said, my impression was that you did so, when you admitted that the ruler was not infallible but might be sometimes mistaken.

You argue like an informer, Socrates. Do you mean, for example, that he who is mistaken about the sick is a physician in that he is mistaken? or that he who errs in arithmetic or grammar is an arithmetician or grammarian at the time when he is making the mistake, in respect of the mistake? True, we say that the physician or arithmetician or grammarian has made a mistake, but this is only a way of speaking; for the fact is that neither the grammarian nor any other person of skill ever makes a mistake in so far as he is what his name implies; they none of them err unless their skill fails them, and then they cease to be skilled artists. No artist or sage or ruler errs at the time when he is what his name implies; though he is commonly said to err, and I adopted the common mode of speaking. But to be perfectly accurate, since you are such a lover of accuracy, we should say that the ruler, in so far as he is a ruler, is unerring, and, being unerring, always commands that which is for his own interest; and the subject is required to execute his commands; and therefore, as I said at first and now repeat, justice is the interest of the stronger.

Indeed, Thrasymachus, and do I really appear to you to argue like an informer?

Certainly, he replied.

And do you suppose that I ask these questions with any design of injuring you in the argument?

Nay, he replied, 'suppose' is not the word—I know it; but you will be found out, and by sheer force of argument you will never prevail.

I shall not make the attempt, my dear man; but to avoid any misunderstanding occurring between us in future, let me ask, in what sense do you speak of a ruler or stronger whose interest, as you were saying, he being the superior, it is just that the inferior should execute—is he a ruler in the popular or in the strict sense of the term?

In the strictest of all senses, he said. And now cheat and play the informer if you can; I ask no quarter at your hands. But you never will be able, never.

And do you imagine, I said, that I am such a madman as to try and cheat, Thrasymachus? I might as well shave a lion.

Why, he said, you made the attempt a minute ago, and you failed.

Enough, I said, of these civilities. It will be better that I should ask you a question: Is the physician, taken in that strict sense of which you are speaking, a healer of the sick or a maker of money? And remember that I am now speaking of the true physician.

A healer of the sick, he replied.

And the pilot—that is to say, the true pilot—is he a captain of sailors or a mere sailor?

A captain of sailors.

The circumstance that he sails in the ship is not to be taken into account; neither is he to be called a sailor; the name pilot by which he is distinguished has nothing to do with sailing, but is significant of his skill and of his authority over the sailors.

Very true, he said.

Now, I said, every art has an interest?

Certainly.

For which the art has to consider and provide?

Yes, that is the aim of art.

And the interest of any art is the perfection of it—this and nothing else?

What do you mean?

I mean what I may illustrate negatively by the example of the body. Suppose you were to ask me whether the body is self-sufficing or has wants, I should reply: Certainly the body has wants; for the body may be ill and require to be cured, and has therefore interests to which the art of medicine ministers; and this is the origin and intention of medicine, as you will acknowledge. Am I not right?

Quite right, he replied.

But is the art of medicine or any other art faulty or deficient in any quality in the same way that the eye may be deficient in sight or the ear fail of hearing, and therefore requires another art to provide for the interests of seeing and hearing—has art in itself, I say, any similar liability to fault or defect, and does every art require another supplementary art to provide for its interests, and that another and another without end? Or have the arts to look only after their own interests? Or have they no need either of themselves or of another?—having no faults or defects, they have no need to correct them, either by the exercise of their own art or of any other; they have only to consider the interest of their subject-matter. For every art remains pure and faultless while remaining true—that is to say, while perfect and unimpaired. Take the words in your precise sense, and tell me whether I am not right.

Yes, clearly.

Then medicine does not consider the interest of medicine, but the interest of the body?

True, he said.

Nor does the art of horsemanship consider the interests of the art of horsemanship, but the interests of the horse; neither do any other arts care for themselves, for they have no needs; they care only for that which is the subject of their art?

True, he said.

But surely, Thrasymachus, the arts are the superiors and rulers of their own subjects?

To this he assented with a good deal of reluctance.

Then, I said, no science or art considers or enjoins the interest of the stronger or superior, but only the interest of the subject and weaker?

He made an attempt to contest this proposition also, but finally acquiesced.

Then, I continued, no physician, in so far as he is a physician, considers his own good in what he prescribes, but the good of his patient; for the true physician is also a ruler having the human body as a subject, and is not a mere money-maker; that has been admitted?

Yes.

And the pilot likewise, in the strict sense of the term, is a ruler of sailors and not a mere sailor?

That has been admitted.

And such a pilot and ruler will provide and prescribe for the interest of the sailor who is under him, and not for his own or the ruler's interest?

He gave a reluctant 'Yes.'

Then, I said, Thrasymachus, there is no one in any rule who, in so far as he is a ruler, considers or enjoins what is for his own interest, but always what is for the interest of his subject or suitable to his art; to that he looks, and that alone he considers in everything which he says and does.

When we had got to this point in the argument, and every one saw that the definition of justice had been completely upset, Thrasymachus, instead of replying to me, said: Tell me, Socrates, have you got a nurse?

Why do you ask such a question, I said, when you ought rather to be answering?

Because she leaves you to snivel, and never wipes your nose: she has not even taught you to know the shepherd from the sheep.

What makes you say that? I replied.

Because you fancy that the shepherd or neatherd fattens or tends the sheep or oxen with a view to their own good and not to the good of himself or his master; and you further imagine that the rulers of states, if they are true rulers, never think of their subjects as sheep, and that they are not studying their own advantage day and night. Oh, no; and so entirely astray are you in your ideas about the just and unjust as not even to know that justice and the just are in reality another's good; that is to say, the interest of the ruler and stronger, and the loss of the subject and servant; and injustice the opposite; for the unjust is lord over the truly simple and just: he is the stronger, and his subjects do what is for his interest, and minister to his happiness, which is very far from being their own. Consider further, most foolish Socrates, that the just is always a loser in comparison with the unjust. First of all, in private contracts: wherever the unjust is the partner of the just you will find that, when the partnership is dissolved, the unjust man has always more and the just less. Secondly, in their dealings with the State: when there is an income-tax, the just man will pay more and the unjust less on the same amount of income; and when there is anything to be received the one gains nothing and the other much. Observe also what happens when they take an office; there is the just man neglecting his affairs and perhaps suffering other losses, and getting nothing out of the public, because he is just; moreover he is hated by his friends and acquaintance for refusing to serve them in unlawful ways. But all this is reversed in the case of the unjust man. I am speaking, as before, of injustice on a large scale in which the advantage of the unjust is most apparent; and my meaning will be most clearly seen if we turn to that highest form of injustice in which the criminal is the happiest of men, and the sufferers or those who refuse to do injustice are the most miserable—that is to say tyranny, which by fraud and force takes away the property of others, not little by little but wholesale; comprehending in one, things sacred as well as profane, private and public; for which acts of wrong, if he were detected perpetrating any one of them singly, he would be punished and incur great disgrace—they who do such wrong in particular cases are called robbers of temples, and man-stealers and burglars and swindlers and thieves. But when a man besides taking away the money of the citizens has made slaves of them, then, instead of these names of reproach, he is termed happy and blessed, not only by the citizens but by all who hear of his having achieved the consummation of injustice. For mankind censure injustice, fearing that they may be the victims of it and not because they shrink from committing it. And thus, as I have shown, Socrates, injustice, when on a sufficient scale, has more strength and freedom and mastery than justice; and, as I said at first, justice is the interest of the stronger, whereas injustice is a man's own profit and interest.

Thrasymachus, when he had thus spoken, having, like a bath-man, deluged our ears with his words, had a mind to go away. But the company would not let him; they insisted that he should remain and defend his position; and I myself added my own humble request that he would not leave us. Thrasymachus, I said to him, excellent man, how suggestive are your remarks! And are you going to run away before you have fairly taught or learned whether they are true or not? Is the attempt to determine the way of man's life so small a matter in your eyes—to determine how life may be passed by each one of us to the greatest advantage?

And do I differ from you, he said, as to the importance of the enquiry?

You appear rather, I replied, to have no care or thought about us, Thrasymachus—whether we live better or worse from not knowing what you say you know, is to you a matter of indifference. Prithee, friend, do not keep your knowledge to yourself; we are a large party; and any benefit which you confer upon us will be amply rewarded. For my own part I openly declare that I am not convinced, and that I do not believe injustice to be more gainful than justice, even if uncontrolled and allowed to have free play. For, granting that there may be an unjust man who is able to commit injustice either by fraud or force, still this does not convince me of the superior advantage of injustice, and there may be others who are in the same predicament with myself. Perhaps we may be wrong; if so, you in your wisdom should convince us that we are mistaken in preferring justice to injustice.

And how am I to convince you, he said, if you are not already convinced by what I have just said; what more can I do for you? Would you have me put the proof bodily into your souls?

Heaven forbid! I said; I would only ask you to be consistent; or, if you change, change openly and let there be no deception. For I must remark, Thrasymachus, if you will recall what was previously said, that although you began by defining the true physician in an exact sense, you did not observe a like exactness when speaking of the shepherd; you thought that the shepherd as a shepherd tends the sheep not with a view to their own good, but like a mere diner or banquetter with a view to the pleasures of the table; or, again, as a trader for sale in the market, and not as a shepherd. Yet surely the art of the shepherd is concerned only with the good of his subjects; he has only to provide the best for them, since the perfection of the art is already ensured whenever all the requirements of it are satisfied. And that was what I was saying just now about the ruler. I conceived that the art of the ruler, considered as ruler, whether in a state or in private life, could only regard the good of his flock or subjects; whereas you seem to think that the rulers in states, that is to say, the true rulers, like being in authority.

Think! Nay, I am sure of it.

Then why in the case of lesser offices do men never take them willingly without payment, unless under the idea that they govern for the advantage not of themselves but of others? Let me ask you a question: Are not the several arts different, by reason of their each having a separate function? And, my dear illustrious friend, do say what you think, that we may make a little progress.

Yes, that is the difference, he replied.

And each art gives us a particular good and not merely a general one—medicine, for example, gives us health; navigation, safety at sea, and so on?

Yes, he said.

And the art of payment has the special function of giving pay: but we do not confuse this with other arts, any more than the art of the pilot is to be confused with the art of medicine, because the health of the pilot may be improved by a sea voyage. You would not be inclined to say, would you, that navigation is the art of medicine, at least if we are to adopt your exact use of language?

Certainly not.

Or because a man is in good health when he receives pay you would not say that the art of payment is medicine?

I should not.

Nor would you say that medicine is the art of receiving pay because a man takes fees when he is engaged in healing?

Certainly not.

And we have admitted, I said, that the good of each art is specially confined to the art?

Yes.

Then, if there be any good which all artists have in common, that is to be attributed to something of which they all have the common use?

True, he replied.

And when the artist is benefited by receiving pay the advantage is gained by an additional use of the art of pay, which is not the art professed by him?

He gave a reluctant assent to this.

Then the pay is not derived by the several artists from their respective arts. But the truth is, that while the art of medicine gives health, and the art of the builder builds a house, another art attends them which is the art of pay. The various arts may be doing their own business and benefiting that over which they preside, but would the artist receive any benefit from his art unless he were paid as well?

I suppose not.

But does he therefore confer no benefit when he works for nothing?

Certainly, he confers a benefit.

Then now, Thrasymachus, there is no longer any doubt that neither arts nor governments provide for their own interests; but, as we were before saying, they rule and provide for the interests of their subjects who are the weaker and not the stronger—to their good they attend and not to the good of the superior. And this is the reason, my dear Thrasymachus, why, as I was just now saying, no one is willing to govern; because no one likes to take in hand the reformation of evils which are not his concern without remuneration. For, in the execution of his work, and in giving his orders to another, the true artist does not regard his own interest, but always that of his subjects; and therefore in order that rulers may be willing to rule, they must be paid in one of three modes of payment, money, or honour, or a penalty for refusing.

What do you mean, Socrates? said Glaucon. The first two modes of payment are intelligible enough, but what the penalty is I do not understand, or how a penalty can be a payment.

You mean that you do not understand the nature of this payment which to the best men is the great inducement to rule? Of course you know that ambition and avarice are held to be, as indeed they are, a disgrace?

Very true.

And for this reason, I said, money and honour have no attraction for them; good men do not wish to be openly demanding payment for governing and so to get the name of hirelings, nor by secretly helping themselves out of the public revenues to get the name of thieves. And not being ambitious they do not care about honour. Wherefore necessity must be laid upon them, and they must be induced to serve from the fear of punishment. And this, as I imagine, is the reason why the forwardness to take office, instead of waiting to be compelled, has been deemed dishonourable. Now the worst part of the punishment is that he who refuses to rule is liable to be ruled by one who is worse than himself. And the fear of this, as I conceive, induces the good to take office, not because they would, but because they cannot help—not under the idea that they are going to have any benefit or enjoyment themselves, but as a necessity, and because they are not able to commit the task of ruling to any one who is better than themselves, or indeed as good. For there is reason to think that if a city were composed entirely of good men, then to avoid office would be as much an object of contention as to obtain office is at present; then we should have plain proof that the true ruler is not meant by nature to regard his own interest, but that of his subjects; and every one who knew this would choose rather to receive a benefit from another than to have the trouble of conferring one. So far am I from agreeing with Thrasymachus that justice is the interest of the stronger. This latter question need not be further discussed at present; but when Thrasymachus says that the life of the unjust is more advantageous than that of the just, his new statement appears to me to be of a far more serious character. Which of us has spoken truly? And which sort of life, Glaucon, do you prefer?

I for my part deem the life of the just to be the more advantageous, he answered.

Did you hear all the advantages of the unjust which Thrasymachus was rehearsing?

Yes, I heard him, he replied, but he has not convinced me.

Then shall we try to find some way of convincing him, if we can, that he is saying what is not true?

Most certainly, he replied.

If, I said, he makes a set speech and we make another recounting all the advantages of being just, and he answers and we rejoin, there must be a numbering and measuring of the goods which are claimed on either side, and in the end we shall want judges to decide; but if we proceed in our enquiry as we lately did, by making admissions to one another, we shall unite the offices of judge and advocate in our own persons.

Very good, he said.

And which method do I understand you to prefer? I said.

That which you propose.

Well, then, Thrasymachus, I said, suppose you begin at the beginning and answer me. You say that perfect injustice is more gainful than perfect justice?

Yes, that is what I say, and I have given you my reasons.

And what is your view about them? Would you call one of them virtue and the other vice?

Certainly.

I suppose that you would call justice virtue and injustice vice?

What a charming notion! So likely too, seeing that I affirm injustice to be profitable and justice not.

What else then would you say?

The opposite, he replied.

And would you call justice vice?

No, I would rather say sublime simplicity.

Then would you call injustice malignity?

No; I would rather say discretion.

And do the unjust appear to you to be wise and good?

Yes, he said; at any rate those of them who are able to be perfectly unjust, and who have the power of subduing states and nations; but perhaps you imagine me to be talking of cutpurses. Even this profession if undetected has advantages, though they are not to be compared with those of which I was just now speaking.

I do not think that I misapprehend your meaning, Thrasymachus, I replied; but still I cannot hear without amazement that you class injustice with wisdom and virtue, and justice with the opposite.

Certainly I do so class them.

Now, I said, you are on more substantial and almost unanswerable ground; for if the injustice which you were maintaining to be profitable had been admitted by you as by others to be vice and deformity, an answer might have been given to you on received principles; but now I perceive that you will call injustice honourable and strong, and to the unjust you will attribute all the qualities which were attributed by us before to the just, seeing that you do not hesitate to rank injustice with wisdom and virtue.

You have guessed most infallibly, he replied.

Then I certainly ought not to shrink from going through with the argument so long as I have reason to think that you, Thrasymachus, are speaking your real mind; for I do believe that you are now in earnest and are not amusing yourself at our expense.

I may be in earnest or not, but what is that to you?—to refute the argument is your business.

Very true, I said; that is what I have to do: But will you be so good as answer yet one more question? Does the just man try to gain any advantage over the just?

Far otherwise; if he did he would not be the simple amusing creature which he is.

And would he try to go beyond just action?

He would not.

And how would he regard the attempt to gain an advantage over the unjust; would that be considered by him as just or unjust?

He would think it just, and would try to gain the advantage; but he would not be able.

Whether he would or would not be able, I said, is not to the point. My question is only whether the just man, while refusing to have more than another just man, would wish and claim to have more than the unjust?

Yes, he would.

And what of the unjust—does he claim to have more than the just man and to do more than is just?

Of course, he said, for he claims to have more than all men.

And the unjust man will strive and struggle to obtain more than the unjust man or action, in order that he may have more than all?

True.

We may put the matter thus, I said—the just does not desire more than his like but more than his unlike, whereas the unjust desires more than both his like and his unlike?

Nothing, he said, can be better than that statement.

And the unjust is good and wise, and the just is neither?

Good again, he said.

And is not the unjust like the wise and good and the just unlike them?

Of course, he said, he who is of a certain nature, is like those who are of a certain nature; he who is not, not.

Each of them, I said, is such as his like is?

Certainly, he replied.

Very good, Thrasymachus, I said; and now to take the case of the arts: you would admit that one man is a musician and another not a musician?

Yes.

And which is wise and which is foolish?

Clearly the musician is wise, and he who is not a musician is foolish.

And he is good in as far as he is wise, and bad in as far as he is foolish?

Yes.

And you would say the same sort of thing of the physician?

Yes.

And do you think, my excellent friend, that a musician when he adjusts the lyre would desire or claim to exceed or go beyond a musician in the tightening and loosening the strings?

I do not think that he would.

But he would claim to exceed the non-musician?

Of course.

And what would you say of the physician? In prescribing meats and drinks would he wish to go beyond another physician or beyond the practice of medicine?

He would not.

But he would wish to go beyond the non-physician?

Yes.

And about knowledge and ignorance in general; see whether you think that any man who has knowledge ever would wish to have the choice of saying or doing more than another man who has knowledge. Would he not rather say or do the same as his like in the same case?

That, I suppose, can hardly be denied.

And what of the ignorant? would he not desire to have more than either the knowing or the ignorant?

I dare say.

And the knowing is wise?

Yes.

And the wise is good?

True.

Then the wise and good will not desire to gain more than his like, but more than his unlike and opposite?

I suppose so.

Whereas the bad and ignorant will desire to gain more than both?

Yes.

But did we not say, Thrasymachus, that the unjust goes beyond both his like and unlike? Were not these your words?

They were.

And you also said that the just will not go beyond his like but his unlike?

Yes.

Then the just is like the wise and good, and the unjust like the evil and ignorant?

That is the inference.

And each of them is such as his like is?

That was admitted.

Then the just has turned out to be wise and good and the unjust evil and ignorant.

Thrasymachus made all these admissions, not fluently, as I repeat them, but with extreme reluctance; it was a hot summer's day, and the perspiration poured from him in torrents; and then I saw what I had never seen before, Thrasymachus blushing. As we were now agreed that justice was virtue and wisdom, and injustice vice and ignorance, I proceeded to another point:

Well, I said, Thrasymachus, that matter is now settled; but were we not also saying that injustice had strength; do you remember?

Yes, I remember, he said, but do not suppose that I approve of what you are saying or have no answer; if however I were to answer, you would be quite certain to accuse me of haranguing; therefore either permit me to have my say out, or if you would rather ask, do so, and I will answer 'Very good,' as they say to story-telling old women, and will nod 'Yes' and 'No.'

Certainly not, I said, if contrary to your real opinion.

Yes, he said, I will, to please you, since you will not let me speak. What else would you have?

Nothing in the world, I said; and if you are so disposed I will ask and you shall answer.

Proceed.

Then I will repeat the question which I asked before, in order that our examination of the relative nature of justice and injustice may be carried on regularly. A statement was made that injustice is stronger and more powerful than justice, but now justice, having been identified with wisdom and virtue, is easily shown to be stronger than injustice, if injustice is ignorance; this can no longer be questioned by any one. But I want to view the matter, Thrasymachus, in a different way: You would not deny that a state may be unjust and may be unjustly attempting to enslave other states, or may have already enslaved them, and may be holding many of them in subjection?

True, he replied; and I will add that the best and most perfectly unjust state will be most likely to do so.

I know, I said, that such was your position; but what I would further consider is, whether this power which is possessed by the superior state can exist or be exercised without justice or only with justice.

If you are right in your view, and justice is wisdom, then only with justice; but if I am right, then without justice.

I am delighted, Thrasymachus, to see you not only nodding assent and dissent, but making answers which are quite excellent.

That is out of civility to you, he replied.

You are very kind, I said; and would you have the goodness also to inform me, whether you think that a state, or an army, or a band of robbers and thieves, or any other gang of evil-doers could act at all if they injured one another?

No indeed, he said, they could not.

But if they abstained from injuring one another, then they might act together better?

Yes.

And this is because injustice creates divisions and hatreds and fighting, and justice imparts harmony and friendship; is not that true, Thrasymachus?

I agree, he said, because I do not wish to quarrel with you.

How good of you, I said; but I should like to know also whether injustice, having this tendency to arouse hatred, wherever existing, among slaves or among freemen, will not make them hate one another and set them at variance and render them incapable of common action?

Certainly.

And even if injustice be found in two only, will they not quarrel and fight, and become enemies to one another and to the just?

They will.

And suppose injustice abiding in a single person, would your wisdom say that she loses or that she retains her natural power?

Let us assume that she retains her power.

Yet is not the power which injustice exercises of such a nature that wherever she takes up her abode, whether in a city, in an army, in a family, or in any other body, that body is, to begin with, rendered incapable of united action by reason of sedition and distraction; and does it not become its own enemy and at variance with all that opposes it, and with the just? Is not this the case?

Yes, certainly.

And is not injustice equally fatal when existing in a single person; in the first place rendering him incapable of action because he is not at unity with himself, and in the second place making him an enemy to himself and the just? Is not that true, Thrasymachus?

Yes.

And O my friend, I said, surely the gods are just?

Granted that they are.

But if so, the unjust will be the enemy of the gods, and the just will be their friend?

Feast away in triumph, and take your fill of the argument; I will not oppose you, lest I should displease the company.

Well then, proceed with your answers, and let me have the remainder of my repast. For we have already shown that the just are clearly wiser and better and abler than the unjust, and that the unjust are incapable of common action; nay more, that to speak as we did of men who are evil acting at any time vigorously together, is not strictly true, for if they had been perfectly evil, they would have laid hands upon one another; but it is evident that there must have been some remnant of justice in them, which enabled them to combine; if there had not been they would have injured one another as well as their victims; they were but half-villains in their enterprises; for had they been whole villains, and utterly unjust, they would have been utterly incapable of action. That, as I believe, is the truth of the matter, and not what you said at first. But whether the just have a better and happier life than the unjust is a further question which we also proposed to consider. I think that they have, and for the reasons which I have given; but still I should like to examine further, for no light matter is at stake, nothing less than the rule of human life.

Proceed.

I will proceed by asking a question: Would you not say that a horse has some end?

I should.

And the end or use of a horse or of anything would be that which could not be accomplished, or not so well accomplished, by any other thing?

I do not understand, he said.

Let me explain: Can you see, except with the eye?

Certainly not.

Or hear, except with the ear?

No.

These then may be truly said to be the ends of these organs?

They may.

But you can cut off a vine-branch with a dagger or with a chisel, and in many other ways?

Of course.

And yet not so well as with a pruning-hook made for the purpose?

True.

May we not say that this is the end of a pruning-hook?

We may.

Then now I think you will have no difficulty in understanding my meaning when I asked the question whether the end of anything would be that which could not be accomplished, or not so well accomplished, by any other thing?

I understand your meaning, he said, and assent.

And that to which an end is appointed has also an excellence? Need I ask again whether the eye has an end?

It has.

And has not the eye an excellence?

Yes.

And the ear has an end and an excellence also?

True.

And the same is true of all other things; they have each of them an end and a special excellence?

That is so.

Well, and can the eyes fulfil their end if they are wanting in their own proper excellence and have a defect instead?

How can they, he said, if they are blind and cannot see?

You mean to say, if they have lost their proper excellence, which is sight; but I have not arrived at that point yet. I would rather ask the question more generally, and only enquire whether the things which fulfil their ends fulfil them by their own proper excellence, and fail of fulfilling them by their own defect?

Certainly, he replied.

I might say the same of the ears; when deprived of their own proper excellence they cannot fulfil their end?

True.

And the same observation will apply to all other things?

I agree.

Well; and has not the soul an end which nothing else can fulfil? for example, to superintend and command and deliberate and the like. Are not these functions proper to the soul, and can they rightly be assigned to any other?

To no other.

And is not life to be reckoned among the ends of the soul?

Assuredly, he said.

And has not the soul an excellence also?

Yes.

And can she or can she not fulfil her own ends when deprived of that excellence?

She cannot.

Then an evil soul must necessarily be an evil ruler and superintendent, and the good soul a good ruler?

Yes, necessarily.

And we have admitted that justice is the excellence of the soul, and injustice the defect of the soul?

That has been admitted.

Then the just soul and the just man will live well, and the unjust man will live ill?

That is what your argument proves.

And he who lives well is blessed and happy, and he who lives ill the reverse of happy?

Certainly.

Then the just is happy, and the unjust miserable?

So be it.

But happiness and not misery is profitable.

Of course.

Then, my blessed Thrasymachus, injustice can never be more profitable than justice.

Let this, Socrates, he said, be your entertainment at the Bendidea.

For which I am indebted to you, I said, now that you have grown gentle towards me and have left off scolding. Nevertheless, I have not been well entertained; but that was my own fault and not yours. As an epicure snatches a taste of every dish which is successively brought to table, he not having allowed himself time to enjoy the one before, so have I gone from one subject to another without having discovered what I sought at first, the nature of justice. I left that enquiry and turned away to consider whether justice is virtue and wisdom or evil and folly; and when there arose a further question about the comparative advantages of justice and injustice, I could not refrain from passing on to that. And the result of the whole discussion has been that I know nothing at all. For I know not what justice is, and therefore I am not likely to know whether it is or is not a virtue, nor can I say whether the just man is happy or unhappy.</pre>
</div>
<div created="20150302201423769" modified="20150302213143969" tags="" title="Book II (Jowett translation)">
<pre>With these words I was thinking that I had made an end of the discussion; but the end, in truth, proved to be only a beginning. For Glaucon, who is always the most pugnacious of men, was dissatisfied at Thrasymachus' retirement; he wanted to have the battle out. So he said to me: Socrates, do you wish really to persuade us, or only to seem to have persuaded us, that to be just is always better than to be unjust?

I should wish really to persuade you, I replied, if I could.

Then you certainly have not succeeded. Let me ask you now:—How would you arrange goods—are there not some which we welcome for their own sakes, and independently of their consequences, as, for example, harmless pleasures and enjoyments, which delight us at the time, although nothing follows from them?

I agree in thinking that there is such a class, I replied.

Is there not also a second class of goods, such as knowledge, sight, health, which are desirable not only in themselves, but also for their results?

Certainly, I said.

And would you not recognize a third class, such as gymnastic, and the care of the sick, and the physician's art; also the various ways of money-making—these do us good but we regard them as disagreeable; and no one would choose them for their own sakes, but only for the sake of some reward or result which flows from them?

There is, I said, this third class also. But why do you ask?

Because I want to know in which of the three classes you would place justice?

In the highest class, I replied,—among those goods which he who would be happy desires both for their own sake and for the sake of their results.

Then the many are of another mind; they think that justice is to be reckoned in the troublesome class, among goods which are to be pursued for the sake of rewards and of reputation, but in themselves are disagreeable and rather to be avoided.

I know, I said, that this is their manner of thinking, and that this was the thesis which Thrasymachus was maintaining just now, when he censured justice and praised injustice. But I am too stupid to be convinced by him.

I wish, he said, that you would hear me as well as him, and then I shall see whether you and I agree. For Thrasymachus seems to me, like a snake, to have been charmed by your voice sooner than he ought to have been; but to my mind the nature of justice and injustice have not yet been made clear. Setting aside their rewards and results, I want to know what they are in themselves, and how they inwardly work in the soul. If you, please, then, I will revive the argument of Thrasymachus. And first I will speak of the nature and origin of justice according to the common view of them. Secondly, I will show that all men who practise justice do so against their will, of necessity, but not as a good. And thirdly, I will argue that there is reason in this view, for the life of the unjust is after all better far than the life of the just—if what they say is true, Socrates, since I myself am not of their opinion. But still I acknowledge that I am perplexed when I hear the voices of Thrasymachus and myriads of others dinning in my ears; and, on the other hand, I have never yet heard the superiority of justice to injustice maintained by any one in a satisfactory way. I want to hear justice praised in respect of itself; then I shall be satisfied, and you are the person from whom I think that I am most likely to hear this; and therefore I will praise the unjust life to the utmost of my power, and my manner of speaking will indicate the manner in which I desire to hear you too praising justice and censuring injustice. Will you say whether you approve of my proposal?

Indeed I do; nor can I imagine any theme about which a man of sense would oftener wish to converse.

I am delighted, he replied, to hear you say so, and shall begin by speaking, as I proposed, of the nature and origin of justice.

They say that to do injustice is, by nature, good; to suffer injustice, evil; but that the evil is greater than the good. And so when men have both done and suffered injustice and have had experience of both, not being able to avoid the one and obtain the other, they think that they had better agree among themselves to have neither; hence there arise laws and mutual covenants; and that which is ordained by law is termed by them lawful and just. This they affirm to be the origin and nature of justice;—it is a mean or compromise, between the best of all, which is to do injustice and not be punished, and the worst of all, which is to suffer injustice without the power of retaliation; and justice, being at a middle point between the two, is tolerated not as a good, but as the lesser evil, and honoured by reason of the inability of men to do injustice. For no man who is worthy to be called a man would ever submit to such an agreement if he were able to resist; he would be mad if he did. Such is the received account, Socrates, of the nature and origin of justice.

Now that those who practise justice do so involuntarily and because they have not the power to be unjust will best appear if we imagine something of this kind: having given both to the just and the unjust power to do what they will, let us watch and see whither desire will lead them; then we shall discover in the very act the just and unjust man to be proceeding along the same road, following their interest, which all natures deem to be their good, and are only diverted into the path of justice by the force of law. The liberty which we are supposing may be most completely given to them in the form of such a power as is said to have been possessed by Gyges, the ancestor of Croesus the Lydian. According to the tradition, Gyges was a shepherd in the service of the king of Lydia; there was a great storm, and an earthquake made an opening in the earth at the place where he was feeding his flock. Amazed at the sight, he descended into the opening, where, among other marvels, he beheld a hollow brazen horse, having doors, at which he stooping and looking in saw a dead body of stature, as appeared to him, more than human, and having nothing on but a gold ring; this he took from the finger of the dead and reascended. Now the shepherds met together, according to custom, that they might send their monthly report about the flocks to the king; into their assembly he came having the ring on his finger, and as he was sitting among them he chanced to turn the collet of the ring inside his hand, when instantly he became invisible to the rest of the company and they began to speak of him as if he were no longer present. He was astonished at this, and again touching the ring he turned the collet outwards and reappeared; he made several trials of the ring, and always with the same result—when he turned the collet inwards he became invisible, when outwards he reappeared. Whereupon he contrived to be chosen one of the messengers who were sent to the court; whereas soon as he arrived he seduced the queen, and with her help conspired against the king and slew him, and took the kingdom. Suppose now that there were two such magic rings, and the just put on one of them and the unjust the other; no man can be imagined to be of such an iron nature that he would stand fast in justice. No man would keep his hands off what was not his own when he could safely take what he liked out of the market, or go into houses and lie with any one at his pleasure, or kill or release from prison whom he would, and in all respects be like a God among men. Then the actions of the just would be as the actions of the unjust; they would both come at last to the same point. And this we may truly affirm to be a great proof that a man is just, not willingly or because he thinks that justice is any good to him individually, but of necessity, for wherever any one thinks that he can safely be unjust, there he is unjust. For all men believe in their hearts that injustice is far more profitable to the individual than justice, and he who argues as I have been supposing, will say that they are right. If you could imagine any one obtaining this power of becoming invisible, and never doing any wrong or touching what was another's, he would be thought by the lookers-on to be a most wretched idiot, although they would praise him to one another's faces, and keep up appearances with one another from a fear that they too might suffer injustice. Enough of this.

Now, if we are to form a real judgment of the life of the just and unjust, we must isolate them; there is no other way; and how is the isolation to be effected? I answer: Let the unjust man be entirely unjust, and the just man entirely just; nothing is to be taken away from either of them, and both are to be perfectly furnished for the work of their respective lives. First, let the unjust be like other distinguished masters of craft; like the skilful pilot or physician, who knows intuitively his own powers and keeps within their limits, and who, if he fails at any point, is able to recover himself. So let the unjust make his unjust attempts in the right way, and lie hidden if he means to be great in his injustice: (he who is found out is nobody:) for the highest reach of injustice is, to be deemed just when you are not. Therefore I say that in the perfectly unjust man we must assume the most perfect injustice; there is to be no deduction, but we must allow him, while doing the most unjust acts, to have acquired the greatest reputation for justice. If he have taken a false step he must be able to recover himself; he must be one who can speak with effect, if any of his deeds come to light, and who can force his way where force is required by his courage and strength, and command of money and friends. And at his side let us place the just man in his nobleness and simplicity, wishing, as Aeschylus says, to be and not to seem good. There must be no seeming, for if he seem to be just he will be honoured and rewarded, and then we shall not know whether he is just for the sake of justice or for the sake of honours and rewards; therefore, let him be clothed in justice only, and have no other covering; and he must be imagined in a state of life the opposite of the former. Let him be the best of men, and let him be thought the worst; then he will have been put to the proof; and we shall see whether he will be affected by the fear of infamy and its consequences. And let him continue thus to the hour of death; being just and seeming to be unjust. When both have reached the uttermost extreme, the one of justice and the other of injustice, let judgment be given which of them is the happier of the two.

Heavens! my dear Glaucon, I said, how energetically you polish them up for the decision, first one and then the other, as if they were two statues.

I do my best, he said. And now that we know what they are like there is no difficulty in tracing out the sort of life which awaits either of them. This I will proceed to describe; but as you may think the description a little too coarse, I ask you to suppose, Socrates, that the words which follow are not mine.—Let me put them into the mouths of the eulogists of injustice: They will tell you that the just man who is thought unjust will be scourged, racked, bound—will have his eyes burnt out; and, at last, after suffering every kind of evil, he will be impaled: Then he will understand that he ought to seem only, and not to be, just; the words of Aeschylus may be more truly spoken of the unjust than of the just. For the unjust is pursuing a reality; he does not live with a view to appearances—he wants to be really unjust and not to seem only:—

'His mind has a soil deep and fertile, Out of which spring his prudent counsels.'

In the first place, he is thought just, and therefore bears rule in the city; he can marry whom he will, and give in marriage to whom he will; also he can trade and deal where he likes, and always to his own advantage, because he has no misgivings about injustice; and at every contest, whether in public or private, he gets the better of his antagonists, and gains at their expense, and is rich, and out of his gains he can benefit his friends, and harm his enemies; moreover, he can offer sacrifices, and dedicate gifts to the gods abundantly and magnificently, and can honour the gods or any man whom he wants to honour in a far better style than the just, and therefore he is likely to be dearer than they are to the gods. And thus, Socrates, gods and men are said to unite in making the life of the unjust better than the life of the just.

I was going to say something in answer to Glaucon, when Adeimantus, his brother, interposed: Socrates, he said, you do not suppose that there is nothing more to be urged?

Why, what else is there? I answered.

The strongest point of all has not been even mentioned, he replied.

Well, then, according to the proverb, 'Let brother help brother'—if he fails in any part do you assist him; although I must confess that Glaucon has already said quite enough to lay me in the dust, and take from me the power of helping justice.

&lt;&lt;&lt;
Nonsense, he replied. But let me add something more: There is another side to Glaucon's argument about the praise and censure of justice and injustice, which is equally required in order to bring out what I believe to be his meaning. Parents and tutors are always telling their sons and their wards that they are to be just; but why? not for the sake of justice, but for the sake of character and reputation; in the hope of obtaining for him who is reputed just some of those offices, marriages, and the like which Glaucon has enumerated among the advantages accruing to the unjust from the reputation of justice. More, however, is made of appearances by this class of persons than by the others; for they throw in the good opinion of the gods, and will tell you of a shower of benefits which the heavens, as they say, rain upon the pious; and this accords with the testimony of the noble Hesiod and Homer, the first of whom says, that the gods make the oaks of the just—

'To bear acorns at their summit, and bees in the middle;&lt;br&gt;And the sheep are bowed down with the weight of their fleeces,'
&lt;&lt;&lt;

and many other blessings of a like kind are provided for them. And Homer has a very similar strain; for he speaks of one whose fame is—

'As the fame of some blameless king who, like a god, Maintains justice; to whom the black earth brings forth Wheat and barley, whose trees are bowed with fruit, And his sheep never fail to bear, and the sea gives him fish.'

Still grander are the gifts of heaven which Musaeus and his son vouchsafe to the just; they take them down into the world below, where they have the saints lying on couches at a feast, everlastingly drunk, crowned with garlands; their idea seems to be that an immortality of drunkenness is the highest meed of virtue. Some extend their rewards yet further; the posterity, as they say, of the faithful and just shall survive to the third and fourth generation. This is the style in which they praise justice. But about the wicked there is another strain; they bury them in a slough in Hades, and make them carry water in a sieve; also while they are yet living they bring them to infamy, and inflict upon them the punishments which Glaucon described as the portion of the just who are reputed to be unjust; nothing else does their invention supply. Such is their manner of praising the one and censuring the other.

Once more, Socrates, I will ask you to consider another way of speaking about justice and injustice, which is not confined to the poets, but is found in prose writers. The universal voice of mankind is always declaring that justice and virtue are honourable, but grievous and toilsome; and that the pleasures of vice and injustice are easy of attainment, and are only censured by law and opinion. They say also that honesty is for the most part less profitable than dishonesty; and they are quite ready to call wicked men happy, and to honour them both in public and private when they are rich or in any other way influential, while they despise and overlook those who may be weak and poor, even though acknowledging them to be better than the others. But most extraordinary of all is their mode of speaking about virtue and the gods: they say that the gods apportion calamity and misery to many good men, and good and happiness to the wicked. And mendicant prophets go to rich men's doors and persuade them that they have a power committed to them by the gods of making an atonement for a man's own or his ancestor's sins by sacrifices or charms, with rejoicings and feasts; and they promise to harm an enemy, whether just or unjust, at a small cost; with magic arts and incantations binding heaven, as they say, to execute their will. And the poets are the authorities to whom they appeal, now smoothing the path of vice with the words of Hesiod;—

'Vice may be had in abundance without trouble; the way is smooth and her dwelling-place is near. But before virtue the gods have set toil,'

and a tedious and uphill road: then citing Homer as a witness that the gods may be influenced by men; for he also says:—

'The gods, too, may be turned from their purpose; and men pray to them and avert their wrath by sacrifices and soothing entreaties, and by libations and the odour of fat, when they have sinned and transgressed.'

And they produce a host of books written by Musaeus and Orpheus, who were children of the Moon and the Muses—that is what they say—according to which they perform their ritual, and persuade not only individuals, but whole cities, that expiations and atonements for sin may be made by sacrifices and amusements which fill a vacant hour, and are equally at the service of the living and the dead; the latter sort they call mysteries, and they redeem us from the pains of hell, but if we neglect them no one knows what awaits us.

He proceeded: And now when the young hear all this said about virtue and vice, and the way in which gods and men regard them, how are their minds likely to be affected, my dear Socrates,—those of them, I mean, who are quickwitted, and, like bees on the wing, light on every flower, and from all that they hear are prone to draw conclusions as to what manner of persons they should be and in what way they should walk if they would make the best of life? Probably the youth will say to himself in the words of Pindar—

'Can I by justice or by crooked ways of deceit ascend a loftier tower which may be a fortress to me all my days?'

For what men say is that, if I am really just and am not also thought just profit there is none, but the pain and loss on the other hand are unmistakeable. But if, though unjust, I acquire the reputation of justice, a heavenly life is promised to me. Since then, as philosophers prove, appearance tyrannizes over truth and is lord of happiness, to appearance I must devote myself. I will describe around me a picture and shadow of virtue to be the vestibule and exterior of my house; behind I will trail the subtle and crafty fox, as Archilochus, greatest of sages, recommends. But I hear some one exclaiming that the concealment of wickedness is often difficult; to which I answer, Nothing great is easy. Nevertheless, the argument indicates this, if we would be happy, to be the path along which we should proceed. With a view to concealment we will establish secret brotherhoods and political clubs. And there are professors of rhetoric who teach the art of persuading courts and assemblies; and so, partly by persuasion and partly by force, I shall make unlawful gains and not be punished. Still I hear a voice saying that the gods cannot be deceived, neither can they be compelled. But what if there are no gods? or, suppose them to have no care of human things—why in either case should we mind about concealment? And even if there are gods, and they do care about us, yet we know of them only from tradition and the genealogies of the poets; and these are the very persons who say that they may be influenced and turned by 'sacrifices and soothing entreaties and by offerings.' Let us be consistent then, and believe both or neither. If the poets speak truly, why then we had better be unjust, and offer of the fruits of injustice; for if we are just, although we may escape the vengeance of heaven, we shall lose the gains of injustice; but, if we are unjust, we shall keep the gains, and by our sinning and praying, and praying and sinning, the gods will be propitiated, and we shall not be punished. 'But there is a world below in which either we or our posterity will suffer for our unjust deeds.' Yes, my friend, will be the reflection, but there are mysteries and atoning deities, and these have great power. That is what mighty cities declare; and the children of the gods, who were their poets and prophets, bear a like testimony.

On what principle, then, shall we any longer choose justice rather than the worst injustice? when, if we only unite the latter with a deceitful regard to appearances, we shall fare to our mind both with gods and men, in life and after death, as the most numerous and the highest authorities tell us. Knowing all this, Socrates, how can a man who has any superiority of mind or person or rank or wealth, be willing to honour justice; or indeed to refrain from laughing when he hears justice praised? And even if there should be some one who is able to disprove the truth of my words, and who is satisfied that justice is best, still he is not angry with the unjust, but is very ready to forgive them, because he also knows that men are not just of their own free will; unless, peradventure, there be some one whom the divinity within him may have inspired with a hatred of injustice, or who has attained knowledge of the truth—but no other man. He only blames injustice who, owing to cowardice or age or some weakness, has not the power of being unjust. And this is proved by the fact that when he obtains the power, he immediately becomes unjust as far as he can be.

The cause of all this, Socrates, was indicated by us at the beginning of the argument, when my brother and I told you how astonished we were to find that of all the professing panegyrists of justice—beginning with the ancient heroes of whom any memorial has been preserved to us, and ending with the men of our own time—no one has ever blamed injustice or praised justice except with a view to the glories, honours, and benefits which flow from them. No one has ever adequately described either in verse or prose the true essential nature of either of them abiding in the soul, and invisible to any human or divine eye; or shown that of all the things of a man's soul which he has within him, justice is the greatest good, and injustice the greatest evil. Had this been the universal strain, had you sought to persuade us of this from our youth upwards, we should not have been on the watch to keep one another from doing wrong, but every one would have been his own watchman, because afraid, if he did wrong, of harbouring in himself the greatest of evils. I dare say that Thrasymachus and others would seriously hold the language which I have been merely repeating, and words even stronger than these about justice and injustice, grossly, as I conceive, perverting their true nature. But I speak in this vehement manner, as I must frankly confess to you, because I want to hear from you the opposite side; and I would ask you to show not only the superiority which justice has over injustice, but what effect they have on the possessor of them which makes the one to be a good and the other an evil to him. And please, as Glaucon requested of you, to exclude reputations; for unless you take away from each of them his true reputation and add on the false, we shall say that you do not praise justice, but the appearance of it; we shall think that you are only exhorting us to keep injustice dark, and that you really agree with Thrasymachus in thinking that justice is another's good and the interest of the stronger, and that injustice is a man's own profit and interest, though injurious to the weaker. Now as you have admitted that justice is one of that highest class of goods which are desired indeed for their results, but in a far greater degree for their own sakes—like sight or hearing or knowledge or health, or any other real and natural and not merely conventional good—I would ask you in your praise of justice to regard one point only: I mean the essential good and evil which justice and injustice work in the possessors of them. Let others praise justice and censure injustice, magnifying the rewards and honours of the one and abusing the other; that is a manner of arguing which, coming from them, I am ready to tolerate, but from you who have spent your whole life in the consideration of this question, unless I hear the contrary from your own lips, I expect something better. And therefore, I say, not only prove to us that justice is better than injustice, but show what they either of them do to the possessor of them, which makes the one to be a good and the other an evil, whether seen or unseen by gods and men.

I had always admired the genius of Glaucon and Adeimantus, but on hearing these words I was quite delighted, and said: Sons of an illustrious father, that was not a bad beginning of the Elegiac verses which the admirer of Glaucon made in honour of you after you had distinguished yourselves at the battle of Megara:—

'Sons of Ariston,' he sang, 'divine offspring of an illustrious hero.'

The epithet is very appropriate, for there is something truly divine in being able to argue as you have done for the superiority of injustice, and remaining unconvinced by your own arguments. And I do believe that you are not convinced—this I infer from your general character, for had I judged only from your speeches I should have mistrusted you. But now, the greater my confidence in you, the greater is my difficulty in knowing what to say. For I am in a strait between two; on the one hand I feel that I am unequal to the task; and my inability is brought home to me by the fact that you were not satisfied with the answer which I made to Thrasymachus, proving, as I thought, the superiority which justice has over injustice. And yet I cannot refuse to help, while breath and speech remain to me; I am afraid that there would be an impiety in being present when justice is evil spoken of and not lifting up a hand in her defence. And therefore I had best give such help as I can.

Glaucon and the rest entreated me by all means not to let the question drop, but to proceed in the investigation. They wanted to arrive at the truth, first, about the nature of justice and injustice, and secondly, about their relative advantages. I told them, what I really thought, that the enquiry would be of a serious nature, and would require very good eyes. Seeing then, I said, that we are no great wits, I think that we had better adopt a method which I may illustrate thus; suppose that a short-sighted person had been asked by some one to read small letters from a distance; and it occurred to some one else that they might be found in another place which was larger and in which the letters were larger—if they were the same and he could read the larger letters first, and then proceed to the lesser—this would have been thought a rare piece of good fortune.

Very true, said Adeimantus; but how does the illustration apply to our enquiry?

I will tell you, I replied; justice, which is the subject of our enquiry, is, as you know, sometimes spoken of as the virtue of an individual, and sometimes as the virtue of a State.

True, he replied.

And is not a State larger than an individual?

It is.

Then in the larger the quantity of justice is likely to be larger and more easily discernible. I propose therefore that we enquire into the nature of justice and injustice, first as they appear in the State, and secondly in the individual, proceeding from the greater to the lesser and comparing them.

That, he said, is an excellent proposal.

And if we imagine the State in process of creation, we shall see the justice and injustice of the State in process of creation also.

I dare say.

When the State is completed there may be a hope that the object of our search will be more easily discovered.

Yes, far more easily.

But ought we to attempt to construct one? I said; for to do so, as I am inclined to think, will be a very serious task. Reflect therefore.

I have reflected, said Adeimantus, and am anxious that you should proceed.

A State, I said, arises, as I conceive, out of the needs of mankind; no one is self-sufficing, but all of us have many wants. Can any other origin of a State be imagined?

There can be no other.

Then, as we have many wants, and many persons are needed to supply them, one takes a helper for one purpose and another for another; and when these partners and helpers are gathered together in one habitation the body of inhabitants is termed a State.

True, he said.

And they exchange with one another, and one gives, and another receives, under the idea that the exchange will be for their good.

Very true.

Then, I said, let us begin and create in idea a State; and yet the true creator is necessity, who is the mother of our invention.

Of course, he replied.

Now the first and greatest of necessities is food, which is the condition of life and existence.

Certainly.

The second is a dwelling, and the third clothing and the like.

True.

And now let us see how our city will be able to supply this great demand: We may suppose that one man is a husbandman, another a builder, some one else a weaver—shall we add to them a shoemaker, or perhaps some other purveyor to our bodily wants?

Quite right.

The barest notion of a State must include four or five men.

Clearly.

And how will they proceed? Will each bring the result of his labours into a common stock?—the individual husbandman, for example, producing for four, and labouring four times as long and as much as he need in the provision of food with which he supplies others as well as himself; or will he have nothing to do with others and not be at the trouble of producing for them, but provide for himself alone a fourth of the food in a fourth of the time, and in the remaining three fourths of his time be employed in making a house or a coat or a pair of shoes, having no partnership with others, but supplying himself all his own wants?

Adeimantus thought that he should aim at producing food only and not at producing everything.

Probably, I replied, that would be the better way; and when I hear you say this, I am myself reminded that we are not all alike; there are diversities of natures among us which are adapted to different occupations.

Very true.

And will you have a work better done when the workman has many occupations, or when he has only one?

When he has only one.

Further, there can be no doubt that a work is spoilt when not done at the right time?

No doubt.

For business is not disposed to wait until the doer of the business is at leisure; but the doer must follow up what he is doing, and make the business his first object.

He must.

And if so, we must infer that all things are produced more plentifully and easily and of a better quality when one man does one thing which is natural to him and does it at the right time, and leaves other things.

Undoubtedly.

Then more than four citizens will be required; for the husbandman will not make his own plough or mattock, or other implements of agriculture, if they are to be good for anything. Neither will the builder make his tools—and he too needs many; and in like manner the weaver and shoemaker.

True.

Then carpenters, and smiths, and many other artisans, will be sharers in our little State, which is already beginning to grow?

True.

Yet even if we add neatherds, shepherds, and other herdsmen, in order that our husbandmen may have oxen to plough with, and builders as well as husbandmen may have draught cattle, and curriers and weavers fleeces and hides,—still our State will not be very large.

That is true; yet neither will it be a very small State which contains all these.

Then, again, there is the situation of the city—to find a place where nothing need be imported is wellnigh impossible.

Impossible.

Then there must be another class of citizens who will bring the required supply from another city?

There must.

But if the trader goes empty-handed, having nothing which they require who would supply his need, he will come back empty-handed.

That is certain.

And therefore what they produce at home must be not only enough for themselves, but such both in quantity and quality as to accommodate those from whom their wants are supplied.

Very true.

Then more husbandmen and more artisans will be required?

They will.

Not to mention the importers and exporters, who are called merchants?

Yes.

Then we shall want merchants?

We shall.

And if merchandise is to be carried over the sea, skilful sailors will also be needed, and in considerable numbers?

Yes, in considerable numbers.

Then, again, within the city, how will they exchange their productions? To secure such an exchange was, as you will remember, one of our principal objects when we formed them into a society and constituted a State.

Clearly they will buy and sell.

Then they will need a market-place, and a money-token for purposes of exchange.

Certainly.

Suppose now that a husbandman, or an artisan, brings some production to market, and he comes at a time when there is no one to exchange with him,—is he to leave his calling and sit idle in the market-place?

Not at all; he will find people there who, seeing the want, undertake the office of salesmen. In well-ordered states they are commonly those who are the weakest in bodily strength, and therefore of little use for any other purpose; their duty is to be in the market, and to give money in exchange for goods to those who desire to sell and to take money from those who desire to buy.

This want, then, creates a class of retail-traders in our State. Is not 'retailer' the term which is applied to those who sit in the market-place engaged in buying and selling, while those who wander from one city to another are called merchants?

Yes, he said.

And there is another class of servants, who are intellectually hardly on the level of companionship; still they have plenty of bodily strength for labour, which accordingly they sell, and are called, if I do not mistake, hirelings, hire being the name which is given to the price of their labour.

True.

Then hirelings will help to make up our population?

Yes.

And now, Adeimantus, is our State matured and perfected?

I think so.

Where, then, is justice, and where is injustice, and in what part of the State did they spring up?

Probably in the dealings of these citizens with one another. I cannot imagine that they are more likely to be found any where else.

I dare say that you are right in your suggestion, I said; we had better think the matter out, and not shrink from the enquiry.

Let us then consider, first of all, what will be their way of life, now that we have thus established them. Will they not produce corn, and wine, and clothes, and shoes, and build houses for themselves? And when they are housed, they will work, in summer, commonly, stripped and barefoot, but in winter substantially clothed and shod. They will feed on barley-meal and flour of wheat, baking and kneading them, making noble cakes and loaves; these they will serve up on a mat of reeds or on clean leaves, themselves reclining the while upon beds strewn with yew or myrtle. And they and their children will feast, drinking of the wine which they have made, wearing garlands on their heads, and hymning the praises of the gods, in happy converse with one another. And they will take care that their families do not exceed their means; having an eye to poverty or war.

But, said Glaucon, interposing, you have not given them a relish to their meal.

True, I replied, I had forgotten; of course they must have a relish—salt, and olives, and cheese, and they will boil roots and herbs such as country people prepare; for a dessert we shall give them figs, and peas, and beans; and they will roast myrtle-berries and acorns at the fire, drinking in moderation. And with such a diet they may be expected to live in peace and health to a good old age, and bequeath a similar life to their children after them.

Yes, Socrates, he said, and if you were providing for a city of pigs, how else would you feed the beasts?

But what would you have, Glaucon? I replied.

Why, he said, you should give them the ordinary conveniences of life. People who are to be comfortable are accustomed to lie on sofas, and dine off tables, and they should have sauces and sweets in the modern style.

Yes, I said, now I understand: the question which you would have me consider is, not only how a State, but how a luxurious State is created; and possibly there is no harm in this, for in such a State we shall be more likely to see how justice and injustice originate. In my opinion the true and healthy constitution of the State is the one which I have described. But if you wish also to see a State at fever-heat, I have no objection. For I suspect that many will not be satisfied with the simpler way of life. They will be for adding sofas, and tables, and other furniture; also dainties, and perfumes, and incense, and courtesans, and cakes, all these not of one sort only, but in every variety; we must go beyond the necessaries of which I was at first speaking, such as houses, and clothes, and shoes: the arts of the painter and the embroiderer will have to be set in motion, and gold and ivory and all sorts of materials must be procured.

True, he said.

Then we must enlarge our borders; for the original healthy State is no longer sufficient. Now will the city have to fill and swell with a multitude of callings which are not required by any natural want; such as the whole tribe of hunters and actors, of whom one large class have to do with forms and colours; another will be the votaries of music—poets and their attendant train of rhapsodists, players, dancers, contractors; also makers of divers kinds of articles, including women's dresses. And we shall want more servants. Will not tutors be also in request, and nurses wet and dry, tirewomen and barbers, as well as confectioners and cooks; and swineherds, too, who were not needed and therefore had no place in the former edition of our State, but are needed now? They must not be forgotten: and there will be animals of many other kinds, if people eat them.

Certainly.

And living in this way we shall have much greater need of physicians than before?

Much greater.

And the country which was enough to support the original inhabitants will be too small now, and not enough?

Quite true.

Then a slice of our neighbours' land will be wanted by us for pasture and tillage, and they will want a slice of ours, if, like ourselves, they exceed the limit of necessity, and give themselves up to the unlimited accumulation of wealth?

That, Socrates, will be inevitable.

And so we shall go to war, Glaucon. Shall we not?

Most certainly, he replied.

Then without determining as yet whether war does good or harm, thus much we may affirm, that now we have discovered war to be derived from causes which are also the causes of almost all the evils in States, private as well as public.

Undoubtedly.

And our State must once more enlarge; and this time the enlargement will be nothing short of a whole army, which will have to go out and fight with the invaders for all that we have, as well as for the things and persons whom we were describing above.

Why? he said; are they not capable of defending themselves?

No, I said; not if we were right in the principle which was acknowledged by all of us when we were framing the State: the principle, as you will remember, was that one man cannot practise many arts with success.

Very true, he said.

But is not war an art?

Certainly.

And an art requiring as much attention as shoemaking?

Quite true.

And the shoemaker was not allowed by us to be a husbandman, or a weaver, or a builder—in order that we might have our shoes well made; but to him and to every other worker was assigned one work for which he was by nature fitted, and at that he was to continue working all his life long and at no other; he was not to let opportunities slip, and then he would become a good workman. Now nothing can be more important than that the work of a soldier should be well done. But is war an art so easily acquired that a man may be a warrior who is also a husbandman, or shoemaker, or other artisan; although no one in the world would be a good dice or draught player who merely took up the game as a recreation, and had not from his earliest years devoted himself to this and nothing else? No tools will make a man a skilled workman, or master of defence, nor be of any use to him who has not learned how to handle them, and has never bestowed any attention upon them. How then will he who takes up a shield or other implement of war become a good fighter all in a day, whether with heavy-armed or any other kind of troops?

Yes, he said, the tools which would teach men their own use would be beyond price.

And the higher the duties of the guardian, I said, the more time, and skill, and art, and application will be needed by him?

No doubt, he replied.

Will he not also require natural aptitude for his calling?

Certainly.

Then it will be our duty to select, if we can, natures which are fitted for the task of guarding the city?

It will.

And the selection will be no easy matter, I said; but we must be brave and do our best.

We must.

Is not the noble youth very like a well-bred dog in respect of guarding and watching?

What do you mean?

I mean that both of them ought to be quick to see, and swift to overtake the enemy when they see him; and strong too if, when they have caught him, they have to fight with him.

All these qualities, he replied, will certainly be required by them.

Well, and your guardian must be brave if he is to fight well?

Certainly.

And is he likely to be brave who has no spirit, whether horse or dog or any other animal? Have you never observed how invincible and unconquerable is spirit and how the presence of it makes the soul of any creature to be absolutely fearless and indomitable?

I have.

Then now we have a clear notion of the bodily qualities which are required in the guardian.

True.

And also of the mental ones; his soul is to be full of spirit?

Yes.

But are not these spirited natures apt to be savage with one another, and with everybody else?

A difficulty by no means easy to overcome, he replied.

Whereas, I said, they ought to be dangerous to their enemies, and gentle to their friends; if not, they will destroy themselves without waiting for their enemies to destroy them.

True, he said.

What is to be done then? I said; how shall we find a gentle nature which has also a great spirit, for the one is the contradiction of the other?

True.

He will not be a good guardian who is wanting in either of these two qualities; and yet the combination of them appears to be impossible; and hence we must infer that to be a good guardian is impossible.

I am afraid that what you say is true, he replied.

Here feeling perplexed I began to think over what had preceded.—My friend, I said, no wonder that we are in a perplexity; for we have lost sight of the image which we had before us.

What do you mean? he said.

I mean to say that there do exist natures gifted with those opposite qualities.

And where do you find them?

Many animals, I replied, furnish examples of them; our friend the dog is a very good one: you know that well-bred dogs are perfectly gentle to their familiars and acquaintances, and the reverse to strangers.

Yes, I know.

Then there is nothing impossible or out of the order of nature in our finding a guardian who has a similar combination of qualities?

Certainly not.

Would not he who is fitted to be a guardian, besides the spirited nature, need to have the qualities of a philosopher?

I do not apprehend your meaning.

The trait of which I am speaking, I replied, may be also seen in the dog, and is remarkable in the animal.

What trait?

Why, a dog, whenever he sees a stranger, is angry; when an acquaintance, he welcomes him, although the one has never done him any harm, nor the other any good. Did this never strike you as curious?

The matter never struck me before; but I quite recognise the truth of your remark.

And surely this instinct of the dog is very charming;—your dog is a true philosopher.

Why?

Why, because he distinguishes the face of a friend and of an enemy only by the criterion of knowing and not knowing. And must not an animal be a lover of learning who determines what he likes and dislikes by the test of knowledge and ignorance?

Most assuredly.

And is not the love of learning the love of wisdom, which is philosophy?

They are the same, he replied.

And may we not say confidently of man also, that he who is likely to be gentle to his friends and acquaintances, must by nature be a lover of wisdom and knowledge?

That we may safely affirm.

Then he who is to be a really good and noble guardian of the State will require to unite in himself philosophy and spirit and swiftness and strength?

Undoubtedly.

Then we have found the desired natures; and now that we have found them, how are they to be reared and educated? Is not this an enquiry which may be expected to throw light on the greater enquiry which is our final end—How do justice and injustice grow up in States? for we do not want either to omit what is to the point or to draw out the argument to an inconvenient length.

Adeimantus thought that the enquiry would be of great service to us.

Then, I said, my dear friend, the task must not be given up, even if somewhat long.

Certainly not.

Come then, and let us pass a leisure hour in story-telling, and our story shall be the education of our heroes.

By all means.

And what shall be their education? Can we find a better than the traditional sort?—and this has two divisions, gymnastic for the body, and music for the soul.

True.

Shall we begin education with music, and go on to gymnastic afterwards?

By all means.

And when you speak of music, do you include literature or not?

I do.

And literature may be either true or false?

Yes.

And the young should be trained in both kinds, and we begin with the false?

I do not understand your meaning, he said.

You know, I said, that we begin by telling children stories which, though not wholly destitute of truth, are in the main fictitious; and these stories are told them when they are not of an age to learn gymnastics.

Very true.

That was my meaning when I said that we must teach music before gymnastics.

Quite right, he said.

You know also that the beginning is the most important part of any work, especially in the case of a young and tender thing; for that is the time at which the character is being formed and the desired impression is more readily taken.

Quite true.

And shall we just carelessly allow children to hear any casual tales which may be devised by casual persons, and to receive into their minds ideas for the most part the very opposite of those which we should wish them to have when they are grown up?

We cannot.

Then the first thing will be to establish a censorship of the writers of fiction, and let the censors receive any tale of fiction which is good, and reject the bad; and we will desire mothers and nurses to tell their children the authorised ones only. Let them fashion the mind with such tales, even more fondly than they mould the body with their hands; but most of those which are now in use must be discarded.

Of what tales are you speaking? he said.

You may find a model of the lesser in the greater, I said; for they are necessarily of the same type, and there is the same spirit in both of them.

Very likely, he replied; but I do not as yet know what you would term the greater.

Those, I said, which are narrated by Homer and Hesiod, and the rest of the poets, who have ever been the great story-tellers of mankind.

But which stories do you mean, he said; and what fault do you find with them?

A fault which is most serious, I said; the fault of telling a lie, and, what is more, a bad lie.

But when is this fault committed?

Whenever an erroneous representation is made of the nature of gods and heroes,—as when a painter paints a portrait not having the shadow of a likeness to the original.

Yes, he said, that sort of thing is certainly very blameable; but what are the stories which you mean?

First of all, I said, there was that greatest of all lies in high places, which the poet told about Uranus, and which was a bad lie too,—I mean what Hesiod says that Uranus did, and how Cronus retaliated on him. The doings of Cronus, and the sufferings which in turn his son inflicted upon him, even if they were true, ought certainly not to be lightly told to young and thoughtless persons; if possible, they had better be buried in silence. But if there is an absolute necessity for their mention, a chosen few might hear them in a mystery, and they should sacrifice not a common (Eleusinian) pig, but some huge and unprocurable victim; and then the number of the hearers will be very few indeed.

Why, yes, said he, those stories are extremely objectionable.

Yes, Adeimantus, they are stories not to be repeated in our State; the young man should not be told that in committing the worst of crimes he is far from doing anything outrageous; and that even if he chastises his father when he does wrong, in whatever manner, he will only be following the example of the first and greatest among the gods.

I entirely agree with you, he said; in my opinion those stories are quite unfit to be repeated.

Neither, if we mean our future guardians to regard the habit of quarrelling among themselves as of all things the basest, should any word be said to them of the wars in heaven, and of the plots and fightings of the gods against one another, for they are not true. No, we shall never mention the battles of the giants, or let them be embroidered on garments; and we shall be silent about the innumerable other quarrels of gods and heroes with their friends and relatives. If they would only believe us we would tell them that quarrelling is unholy, and that never up to this time has there been any quarrel between citizens; this is what old men and old women should begin by telling children; and when they grow up, the poets also should be told to compose for them in a similar spirit. But the narrative of Hephaestus binding Here his mother, or how on another occasion Zeus sent him flying for taking her part when she was being beaten, and all the battles of the gods in Homer—these tales must not be admitted into our State, whether they are supposed to have an allegorical meaning or not. For a young person cannot judge what is allegorical and what is literal; anything that he receives into his mind at that age is likely to become indelible and unalterable; and therefore it is most important that the tales which the young first hear should be models of virtuous thoughts.

There you are right, he replied; but if any one asks where are such models to be found and of what tales are you speaking—how shall we answer him?

I said to him, You and I, Adeimantus, at this moment are not poets, but founders of a State: now the founders of a State ought to know the general forms in which poets should cast their tales, and the limits which must be observed by them, but to make the tales is not their business.

Very true, he said; but what are these forms of theology which you mean?

Something of this kind, I replied:—God is always to be represented as he truly is, whatever be the sort of poetry, epic, lyric or tragic, in which the representation is given.

Right.

And is he not truly good? and must he not be represented as such?

Certainly.

And no good thing is hurtful?

No, indeed.

And that which is not hurtful hurts not?

Certainly not.

And that which hurts not does no evil?

No.

And can that which does no evil be a cause of evil?

Impossible.

And the good is advantageous?

Yes.

And therefore the cause of well-being?

Yes.

It follows therefore that the good is not the cause of all things, but of the good only?

Assuredly.

Then God, if he be good, is not the author of all things, as the many assert, but he is the cause of a few things only, and not of most things that occur to men. For few are the goods of human life, and many are the evils, and the good is to be attributed to God alone; of the evils the causes are to be sought elsewhere, and not in him.

That appears to me to be most true, he said.

Then we must not listen to Homer or to any other poet who is guilty of the folly of saying that two casks

'Lie at the threshold of Zeus, full of lots, one of good, the other of evil lots,'

and that he to whom Zeus gives a mixture of the two

'Sometimes meets with evil fortune, at other times with good;'

but that he to whom is given the cup of unmingled ill,

'Him wild hunger drives o'er the beauteous earth.'

And again—

'Zeus, who is the dispenser of good and evil to us.'

And if any one asserts that the violation of oaths and treaties, which was really the work of Pandarus, was brought about by Athene and Zeus, or that the strife and contention of the gods was instigated by Themis and Zeus, he shall not have our approval; neither will we allow our young men to hear the words of Aeschylus, that

'God plants guilt among men when he desires utterly to destroy a house.'

And if a poet writes of the sufferings of Niobe—the subject of the tragedy in which these iambic verses occur—or of the house of Pelops, or of the Trojan war or on any similar theme, either we must not permit him to say that these are the works of God, or if they are of God, he must devise some explanation of them such as we are seeking; he must say that God did what was just and right, and they were the better for being punished; but that those who are punished are miserable, and that God is the author of their misery—the poet is not to be permitted to say; though he may say that the wicked are miserable because they require to be punished, and are benefited by receiving punishment from God; but that God being good is the author of evil to any one is to be strenuously denied, and not to be said or sung or heard in verse or prose by any one whether old or young in any well-ordered commonwealth. Such a fiction is suicidal, ruinous, impious.

I agree with you, he replied, and am ready to give my assent to the law.

Let this then be one of our rules and principles concerning the gods, to which our poets and reciters will be expected to conform,—that God is not the author of all things, but of good only.

That will do, he said.

And what do you think of a second principle? Shall I ask you whether God is a magician, and of a nature to appear insidiously now in one shape, and now in another—sometimes himself changing and passing into many forms, sometimes deceiving us with the semblance of such transformations; or is he one and the same immutably fixed in his own proper image?

I cannot answer you, he said, without more thought.

Well, I said; but if we suppose a change in anything, that change must be effected either by the thing itself, or by some other thing?

Most certainly.

And things which are at their best are also least liable to be altered or discomposed; for example, when healthiest and strongest, the human frame is least liable to be affected by meats and drinks, and the plant which is in the fullest vigour also suffers least from winds or the heat of the sun or any similar causes.

Of course.

And will not the bravest and wisest soul be least confused or deranged by any external influence?

True.

And the same principle, as I should suppose, applies to all composite things—furniture, houses, garments: when good and well made, they are least altered by time and circumstances.

Very true.

Then everything which is good, whether made by art or nature, or both, is least liable to suffer change from without?

True.

But surely God and the things of God are in every way perfect?

Of course they are.

Then he can hardly be compelled by external influence to take many shapes?

He cannot.

But may he not change and transform himself?

Clearly, he said, that must be the case if he is changed at all.

And will he then change himself for the better and fairer, or for the worse and more unsightly?

If he change at all he can only change for the worse, for we cannot suppose him to be deficient either in virtue or beauty.

Very true, Adeimantus; but then, would any one, whether God or man, desire to make himself worse?

Impossible.

Then it is impossible that God should ever be willing to change; being, as is supposed, the fairest and best that is conceivable, every God remains absolutely and for ever in his own form.

That necessarily follows, he said, in my judgment.

Then, I said, my dear friend, let none of the poets tell us that

'The gods, taking the disguise of strangers from other lands, walk up and down cities in all sorts of forms;'

and let no one slander Proteus and Thetis, neither let any one, either in tragedy or in any other kind of poetry, introduce Here disguised in the likeness of a priestess asking an alms

'For the life-giving daughters of Inachus the river of Argos;'

—let us have no more lies of that sort. Neither must we have mothers under the influence of the poets scaring their children with a bad version of these myths—telling how certain gods, as they say, 'Go about by night in the likeness of so many strangers and in divers forms;' but let them take heed lest they make cowards of their children, and at the same time speak blasphemy against the gods.

Heaven forbid, he said.

But although the gods are themselves unchangeable, still by witchcraft and deception they may make us think that they appear in various forms?

Perhaps, he replied.

Well, but can you imagine that God will be willing to lie, whether in word or deed, or to put forth a phantom of himself?

I cannot say, he replied.

Do you not know, I said, that the true lie, if such an expression may be allowed, is hated of gods and men?

What do you mean? he said.

I mean that no one is willingly deceived in that which is the truest and highest part of himself, or about the truest and highest matters; there, above all, he is most afraid of a lie having possession of him.

Still, he said, I do not comprehend you.

The reason is, I replied, that you attribute some profound meaning to my words; but I am only saying that deception, or being deceived or uninformed about the highest realities in the highest part of themselves, which is the soul, and in that part of them to have and to hold the lie, is what mankind least like;—that, I say, is what they utterly detest.

There is nothing more hateful to them.

And, as I was just now remarking, this ignorance in the soul of him who is deceived may be called the true lie; for the lie in words is only a kind of imitation and shadowy image of a previous affection of the soul, not pure unadulterated falsehood. Am I not right?

Perfectly right.

The true lie is hated not only by the gods, but also by men?

Yes.

Whereas the lie in words is in certain cases useful and not hateful; in dealing with enemies—that would be an instance; or again, when those whom we call our friends in a fit of madness or illusion are going to do some harm, then it is useful and is a sort of medicine or preventive; also in the tales of mythology, of which we were just now speaking—because we do not know the truth about ancient times, we make falsehood as much like truth as we can, and so turn it to account.

Very true, he said.

But can any of these reasons apply to God? Can we suppose that he is ignorant of antiquity, and therefore has recourse to invention?

That would be ridiculous, he said.

Then the lying poet has no place in our idea of God?

I should say not.

Or perhaps he may tell a lie because he is afraid of enemies?

That is inconceivable.

But he may have friends who are senseless or mad?

But no mad or senseless person can be a friend of God.

Then no motive can be imagined why God should lie?

None whatever.

Then the superhuman and divine is absolutely incapable of falsehood?

Yes.

Then is God perfectly simple and true both in word and deed; he changes not; he deceives not, either by sign or word, by dream or waking vision.

Your thoughts, he said, are the reflection of my own.

You agree with me then, I said, that this is the second type or form in which we should write and speak about divine things. The gods are not magicians who transform themselves, neither do they deceive mankind in any way.

I grant that.

Then, although we are admirers of Homer, we do not admire the lying dream which Zeus sends to Agamemnon; neither will we praise the verses of Aeschylus in which Thetis says that Apollo at her nuptials

'Was celebrating in song her fair progeny whose days were to be long, and to know no sickness. And when he had spoken of my lot as in all things blessed of heaven he raised a note of triumph and cheered my soul. And I thought that the word of Phoebus, being divine and full of prophecy, would not fail. And now he himself who uttered the strain, he who was present at the banquet, and who said this—he it is who has slain my son.'

These are the kind of sentiments about the gods which will arouse our anger; and he who utters them shall be refused a chorus; neither shall we allow teachers to make use of them in the instruction of the young, meaning, as we do, that our guardians, as far as men can be, should be true worshippers of the gods and like them.

I entirely agree, he said, in these principles, and promise to make them my laws.</pre>
</div>
<div created="20150302201848579" modified="20150302213121401" tags="" title="Book III (Jowett translation)">
<pre>Such then, I said, are our principles of theology—some tales are to be told, and others are not to be told to our disciples from their youth upwards, if we mean them to honour the gods and their parents, and to value friendship with one another.

Yes; and I think that our principles are right, he said.

But if they are to be courageous, must they not learn other lessons besides these, and lessons of such a kind as will take away the fear of death? Can any man be courageous who has the fear of death in him?

Certainly not, he said.

And can he be fearless of death, or will he choose death in battle rather than defeat and slavery, who believes the world below to be real and terrible?

Impossible.

Then we must assume a control over the narrators of this class of tales as well as over the others, and beg them not simply to revile but rather to commend the world below, intimating to them that their descriptions are untrue, and will do harm to our future warriors.

That will be our duty, he said.

Then, I said, we shall have to obliterate many obnoxious passages, beginning with the verses,

'I would rather be a serf on the land of a poor and portionless man than rule over all the dead who have come to nought.'

We must also expunge the verse, which tells us how Pluto feared,

'Lest the mansions grim and squalid which the gods abhor should be seen both of mortals and immortals.'

And again:—

'O heavens! verily in the house of Hades there is soul and ghostly form but no mind at all!'

Again of Tiresias:—

'(To him even after death did Persephone grant mind,) that he alone should be wise; but the other souls are flitting shades.'

Again:—

'The soul flying from the limbs had gone to Hades, lamenting her fate, leaving manhood and youth.'

Again:—

'And the soul, with shrilling cry, passed like smoke beneath the earth.'

And,—

'As bats in hollow of mystic cavern, whenever any of them has dropped out of the string and falls from the rock, fly shrilling and cling to one another, so did they with shrilling cry hold together as they moved.'

And we must beg Homer and the other poets not to be angry if we strike out these and similar passages, not because they are unpoetical, or unattractive to the popular ear, but because the greater the poetical charm of them, the less are they meet for the ears of boys and men who are meant to be free, and who should fear slavery more than death.

Undoubtedly.

Also we shall have to reject all the terrible and appalling names which describe the world below—Cocytus and Styx, ghosts under the earth, and sapless shades, and any similar words of which the very mention causes a shudder to pass through the inmost soul of him who hears them. I do not say that these horrible stories may not have a use of some kind; but there is a danger that the nerves of our guardians may be rendered too excitable and effeminate by them.

There is a real danger, he said.

Then we must have no more of them.

True.

Another and a nobler strain must be composed and sung by us.

Clearly.

And shall we proceed to get rid of the weepings and wailings of famous men?

They will go with the rest.

But shall we be right in getting rid of them? Reflect: our principle is that the good man will not consider death terrible to any other good man who is his comrade.

Yes; that is our principle.

And therefore he will not sorrow for his departed friend as though he had suffered anything terrible?

He will not.

Such an one, as we further maintain, is sufficient for himself and his own happiness, and therefore is least in need of other men.

True, he said.

And for this reason the loss of a son or brother, or the deprivation of fortune, is to him of all men least terrible.

Assuredly.

And therefore he will be least likely to lament, and will bear with the greatest equanimity any misfortune of this sort which may befall him.

Yes, he will feel such a misfortune far less than another.

Then we shall be right in getting rid of the lamentations of famous men, and making them over to women (and not even to women who are good for anything), or to men of a baser sort, that those who are being educated by us to be the defenders of their country may scorn to do the like.

That will be very right.

Then we will once more entreat Homer and the other poets not to depict Achilles, who is the son of a goddess, first lying on his side, then on his back, and then on his face; then starting up and sailing in a frenzy along the shores of the barren sea; now taking the sooty ashes in both his hands and pouring them over his head, or weeping and wailing in the various modes which Homer has delineated. Nor should he describe Priam the kinsman of the gods as praying and beseeching,

'Rolling in the dirt, calling each man loudly by his name.'

Still more earnestly will we beg of him at all events not to introduce the gods lamenting and saying,

'Alas! my misery! Alas! that I bore the bravest to my sorrow.'

But if he must introduce the gods, at any rate let him not dare so completely to misrepresent the greatest of the gods, as to make him say—

'O heavens! with my eyes verily I behold a dear friend of mine chased round and round the city, and my heart is sorrowful.'

Or again:—

Woe is me that I am fated to have Sarpedon, dearest of men to me, subdued at the hands of Patroclus the son of Menoetius.'

For if, my sweet Adeimantus, our youth seriously listen to such unworthy representations of the gods, instead of laughing at them as they ought, hardly will any of them deem that he himself, being but a man, can be dishonoured by similar actions; neither will he rebuke any inclination which may arise in his mind to say and do the like. And instead of having any shame or self-control, he will be always whining and lamenting on slight occasions.

Yes, he said, that is most true.

Yes, I replied; but that surely is what ought not to be, as the argument has just proved to us; and by that proof we must abide until it is disproved by a better.

It ought not to be.

Neither ought our guardians to be given to laughter. For a fit of laughter which has been indulged to excess almost always produces a violent reaction.

So I believe.

Then persons of worth, even if only mortal men, must not be represented as overcome by laughter, and still less must such a representation of the gods be allowed.

Still less of the gods, as you say, he replied.

Then we shall not suffer such an expression to be used about the gods as that of Homer when he describes how

'Inextinguishable laughter arose among the blessed gods, when they saw Hephaestus bustling about the mansion.'

On your views, we must not admit them.

On my views, if you like to father them on me; that we must not admit them is certain.

Again, truth should be highly valued; if, as we were saying, a lie is useless to the gods, and useful only as a medicine to men, then the use of such medicines should be restricted to physicians; private individuals have no business with them.

Clearly not, he said.

Then if any one at all is to have the privilege of lying, the rulers of the State should be the persons; and they, in their dealings either with enemies or with their own citizens, may be allowed to lie for the public good. But nobody else should meddle with anything of the kind; and although the rulers have this privilege, for a private man to lie to them in return is to be deemed a more heinous fault than for the patient or the pupil of a gymnasium not to speak the truth about his own bodily illnesses to the physician or to the trainer, or for a sailor not to tell the captain what is happening about the ship and the rest of the crew, and how things are going with himself or his fellow sailors.

Most true, he said.

If, then, the ruler catches anybody beside himself lying in the State,

'Any of the craftsmen, whether he be priest or physician or carpenter,'

he will punish him for introducing a practice which is equally subversive and destructive of ship or State.

Most certainly, he said, if our idea of the State is ever carried out.

In the next place our youth must be temperate?

Certainly.

Are not the chief elements of temperance, speaking generally, obedience to commanders and self-control in sensual pleasures?

True.

Then we shall approve such language as that of Diomede in Homer,

'Friend, sit still and obey my word,'

and the verses which follow,

'The Greeks marched breathing prowess, ...in silent awe of their leaders,'

and other sentiments of the same kind.

We shall.

What of this line,

'O heavy with wine, who hast the eyes of a dog and the heart of a stag,'

and of the words which follow? Would you say that these, or any similar impertinences which private individuals are supposed to address to their rulers, whether in verse or prose, are well or ill spoken?

They are ill spoken.

They may very possibly afford some amusement, but they do not conduce to temperance. And therefore they are likely to do harm to our young men—you would agree with me there?

Yes.

And then, again, to make the wisest of men say that nothing in his opinion is more glorious than

'When the tables are full of bread and meat, and the cup-bearer carries round wine which he draws from the bowl and pours into the cups,'

is it fit or conducive to temperance for a young man to hear such words? Or the verse

'The saddest of fates is to die and meet destiny from hunger?'

What would you say again to the tale of Zeus, who, while other gods and men were asleep and he the only person awake, lay devising plans, but forgot them all in a moment through his lust, and was so completely overcome at the sight of Here that he would not even go into the hut, but wanted to lie with her on the ground, declaring that he had never been in such a state of rapture before, even when they first met one another

'Without the knowledge of their parents;'

or that other tale of how Hephaestus, because of similar goings on, cast a chain around Ares and Aphrodite?

Indeed, he said, I am strongly of opinion that they ought not to hear that sort of thing.

But any deeds of endurance which are done or told by famous men, these they ought to see and hear; as, for example, what is said in the verses,

'He smote his breast, and thus reproached his heart, Endure, my heart; far worse hast thou endured!'

Certainly, he said.

In the next place, we must not let them be receivers of gifts or lovers of money.

Certainly not.

Neither must we sing to them of

'Gifts persuading gods, and persuading reverend kings.'

Neither is Phoenix, the tutor of Achilles, to be approved or deemed to have given his pupil good counsel when he told him that he should take the gifts of the Greeks and assist them; but that without a gift he should not lay aside his anger. Neither will we believe or acknowledge Achilles himself to have been such a lover of money that he took Agamemnon's gifts, or that when he had received payment he restored the dead body of Hector, but that without payment he was unwilling to do so.

Undoubtedly, he said, these are not sentiments which can be approved.

Loving Homer as I do, I hardly like to say that in attributing these feelings to Achilles, or in believing that they are truly attributed to him, he is guilty of downright impiety. As little can I believe the narrative of his insolence to Apollo, where he says,

'Thou hast wronged me, O far-darter, most abominable of deities. Verily I would be even with thee, if I had only the power;'

or his insubordination to the river-god, on whose divinity he is ready to lay hands; or his offering to the dead Patroclus of his own hair, which had been previously dedicated to the other river-god Spercheius, and that he actually performed this vow; or that he dragged Hector round the tomb of Patroclus, and slaughtered the captives at the pyre; of all this I cannot believe that he was guilty, any more than I can allow our citizens to believe that he, the wise Cheiron's pupil, the son of a goddess and of Peleus who was the gentlest of men and third in descent from Zeus, was so disordered in his wits as to be at one time the slave of two seemingly inconsistent passions, meanness, not untainted by avarice, combined with overweening contempt of gods and men.

You are quite right, he replied.

And let us equally refuse to believe, or allow to be repeated, the tale of Theseus son of Poseidon, or of Peirithous son of Zeus, going forth as they did to perpetrate a horrid rape; or of any other hero or son of a god daring to do such impious and dreadful things as they falsely ascribe to them in our day: and let us further compel the poets to declare either that these acts were not done by them, or that they were not the sons of gods;—both in the same breath they shall not be permitted to affirm. We will not have them trying to persuade our youth that the gods are the authors of evil, and that heroes are no better than men—sentiments which, as we were saying, are neither pious nor true, for we have already proved that evil cannot come from the gods.

Assuredly not.

And further they are likely to have a bad effect on those who hear them; for everybody will begin to excuse his own vices when he is convinced that similar wickednesses are always being perpetrated by—

'The kindred of the gods, the relatives of Zeus, whose ancestral altar, the altar of Zeus, is aloft in air on the peak of Ida,'

and who have

'the blood of deities yet flowing in their veins.'

And therefore let us put an end to such tales, lest they engender laxity of morals among the young.

By all means, he replied.

But now that we are determining what classes of subjects are or are not to be spoken of, let us see whether any have been omitted by us. The manner in which gods and demigods and heroes and the world below should be treated has been already laid down.

Very true.

And what shall we say about men? That is clearly the remaining portion of our subject.

Clearly so.

But we are not in a condition to answer this question at present, my friend.

Why not?

Because, if I am not mistaken, we shall have to say that about men poets and story-tellers are guilty of making the gravest misstatements when they tell us that wicked men are often happy, and the good miserable; and that injustice is profitable when undetected, but that justice is a man's own loss and another's gain—these things we shall forbid them to utter, and command them to sing and say the opposite.

To be sure we shall, he replied.

But if you admit that I am right in this, then I shall maintain that you have implied the principle for which we have been all along contending.

I grant the truth of your inference.

That such things are or are not to be said about men is a question which we cannot determine until we have discovered what justice is, and how naturally advantageous to the possessor, whether he seem to be just or not.

Most true, he said.

Enough of the subjects of poetry: let us now speak of the style; and when this has been considered, both matter and manner will have been completely treated.

I do not understand what you mean, said Adeimantus.

Then I must make you understand; and perhaps I may be more intelligible if I put the matter in this way. You are aware, I suppose, that all mythology and poetry is a narration of events, either past, present, or to come?

Certainly, he replied.

And narration may be either simple narration, or imitation, or a union of the two?

That again, he said, I do not quite understand.

I fear that I must be a ridiculous teacher when I have so much difficulty in making myself apprehended. Like a bad speaker, therefore, I will not take the whole of the subject, but will break a piece off in illustration of my meaning. You know the first lines of the Iliad, in which the poet says that Chryses prayed Agamemnon to release his daughter, and that Agamemnon flew into a passion with him; whereupon Chryses, failing of his object, invoked the anger of the God against the Achaeans. Now as far as these lines,

'And he prayed all the Greeks, but especially the two sons of Atreus, the chiefs of the people,'

the poet is speaking in his own person; he never leads us to suppose that he is any one else. But in what follows he takes the person of Chryses, and then he does all that he can to make us believe that the speaker is not Homer, but the aged priest himself. And in this double form he has cast the entire narrative of the events which occurred at Troy and in Ithaca and throughout the Odyssey.

Yes.

And a narrative it remains both in the speeches which the poet recites from time to time and in the intermediate passages?

Quite true.

But when the poet speaks in the person of another, may we not say that he assimilates his style to that of the person who, as he informs you, is going to speak?

Certainly.

And this assimilation of himself to another, either by the use of voice or gesture, is the imitation of the person whose character he assumes?

Of course.

Then in this case the narrative of the poet may be said to proceed by way of imitation?

Very true.

Or, if the poet everywhere appears and never conceals himself, then again the imitation is dropped, and his poetry becomes simple narration. However, in order that I may make my meaning quite clear, and that you may no more say, 'I don't understand,' I will show how the change might be effected. If Homer had said, 'The priest came, having his daughter's ransom in his hands, supplicating the Achaeans, and above all the kings;' and then if, instead of speaking in the person of Chryses, he had continued in his own person, the words would have been, not imitation, but simple narration. The passage would have run as follows (I am no poet, and therefore I drop the metre), 'The priest came and prayed the gods on behalf of the Greeks that they might capture Troy and return safely home, but begged that they would give him back his daughter, and take the ransom which he brought, and respect the God. Thus he spoke, and the other Greeks revered the priest and assented. But Agamemnon was wroth, and bade him depart and not come again, lest the staff and chaplets of the God should be of no avail to him—the daughter of Chryses should not be released, he said—she should grow old with him in Argos. And then he told him to go away and not to provoke him, if he intended to get home unscathed. And the old man went away in fear and silence, and, when he had left the camp, he called upon Apollo by his many names, reminding him of everything which he had done pleasing to him, whether in building his temples, or in offering sacrifice, and praying that his good deeds might be returned to him, and that the Achaeans might expiate his tears by the arrows of the god,'—and so on. In this way the whole becomes simple narrative.

I understand, he said.

Or you may suppose the opposite case—that the intermediate passages are omitted, and the dialogue only left.

That also, he said, I understand; you mean, for example, as in tragedy.

You have conceived my meaning perfectly; and if I mistake not, what you failed to apprehend before is now made clear to you, that poetry and mythology are, in some cases, wholly imitative—instances of this are supplied by tragedy and comedy; there is likewise the opposite style, in which the poet is the only speaker—of this the dithyramb affords the best example; and the combination of both is found in epic, and in several other styles of poetry. Do I take you with me?

Yes, he said; I see now what you meant.

I will ask you to remember also what I began by saying, that we had done with the subject and might proceed to the style.

Yes, I remember.

In saying this, I intended to imply that we must come to an understanding about the mimetic art,—whether the poets, in narrating their stories, are to be allowed by us to imitate, and if so, whether in whole or in part, and if the latter, in what parts; or should all imitation be prohibited?

You mean, I suspect, to ask whether tragedy and comedy shall be admitted into our State?

Yes, I said; but there may be more than this in question: I really do not know as yet, but whither the argument may blow, thither we go.

And go we will, he said.

Then, Adeimantus, let me ask you whether our guardians ought to be imitators; or rather, has not this question been decided by the rule already laid down that one man can only do one thing well, and not many; and that if he attempt many, he will altogether fail of gaining much reputation in any?

Certainly.

And this is equally true of imitation; no one man can imitate many things as well as he would imitate a single one?

He cannot.

Then the same person will hardly be able to play a serious part in life, and at the same time to be an imitator and imitate many other parts as well; for even when two species of imitation are nearly allied, the same persons cannot succeed in both, as, for example, the writers of tragedy and comedy—did you not just now call them imitations?

Yes, I did; and you are right in thinking that the same persons cannot succeed in both.

Any more than they can be rhapsodists and actors at once?

True.

Neither are comic and tragic actors the same; yet all these things are but imitations.

They are so.

And human nature, Adeimantus, appears to have been coined into yet smaller pieces, and to be as incapable of imitating many things well, as of performing well the actions of which the imitations are copies.

Quite true, he replied.

If then we adhere to our original notion and bear in mind that our guardians, setting aside every other business, are to dedicate themselves wholly to the maintenance of freedom in the State, making this their craft, and engaging in no work which does not bear on this end, they ought not to practise or imitate anything else; if they imitate at all, they should imitate from youth upward only those characters which are suitable to their profession—the courageous, temperate, holy, free, and the like; but they should not depict or be skilful at imitating any kind of illiberality or baseness, lest from imitation they should come to be what they imitate. Did you never observe how imitations, beginning in early youth and continuing far into life, at length grow into habits and become a second nature, affecting body, voice, and mind?

Yes, certainly, he said.

Then, I said, we will not allow those for whom we profess a care and of whom we say that they ought to be good men, to imitate a woman, whether young or old, quarrelling with her husband, or striving and vaunting against the gods in conceit of her happiness, or when she is in affliction, or sorrow, or weeping; and certainly not one who is in sickness, love, or labour.

Very right, he said.

Neither must they represent slaves, male or female, performing the offices of slaves?

They must not.

And surely not bad men, whether cowards or any others, who do the reverse of what we have just been prescribing, who scold or mock or revile one another in drink or out of drink, or who in any other manner sin against themselves and their neighbours in word or deed, as the manner of such is. Neither should they be trained to imitate the action or speech of men or women who are mad or bad; for madness, like vice, is to be known but not to be practised or imitated.

Very true, he replied.

Neither may they imitate smiths or other artificers, or oarsmen, or boatswains, or the like?

How can they, he said, when they are not allowed to apply their minds to the callings of any of these?

Nor may they imitate the neighing of horses, the bellowing of bulls, the murmur of rivers and roll of the ocean, thunder, and all that sort of thing?

Nay, he said, if madness be forbidden, neither may they copy the behaviour of madmen.

You mean, I said, if I understand you aright, that there is one sort of narrative style which may be employed by a truly good man when he has anything to say, and that another sort will be used by a man of an opposite character and education.

And which are these two sorts? he asked.

Suppose, I answered, that a just and good man in the course of a narration comes on some saying or action of another good man,—I should imagine that he will like to personate him, and will not be ashamed of this sort of imitation: he will be most ready to play the part of the good man when he is acting firmly and wisely; in a less degree when he is overtaken by illness or love or drink, or has met with any other disaster. But when he comes to a character which is unworthy of him, he will not make a study of that; he will disdain such a person, and will assume his likeness, if at all, for a moment only when he is performing some good action; at other times he will be ashamed to play a part which he has never practised, nor will he like to fashion and frame himself after the baser models; he feels the employment of such an art, unless in jest, to be beneath him, and his mind revolts at it.

So I should expect, he replied.

Then he will adopt a mode of narration such as we have illustrated out of Homer, that is to say, his style will be both imitative and narrative; but there will be very little of the former, and a great deal of the latter. Do you agree?

Certainly, he said; that is the model which such a speaker must necessarily take.

But there is another sort of character who will narrate anything, and, the worse he is, the more unscrupulous he will be; nothing will be too bad for him: and he will be ready to imitate anything, not as a joke, but in right good earnest, and before a large company. As I was just now saying, he will attempt to represent the roll of thunder, the noise of wind and hail, or the creaking of wheels, and pulleys, and the various sounds of flutes, pipes, trumpets, and all sorts of instruments: he will bark like a dog, bleat like a sheep, or crow like a cock; his entire art will consist in imitation of voice and gesture, and there will be very little narration.

That, he said, will be his mode of speaking.

These, then, are the two kinds of style?

Yes.

And you would agree with me in saying that one of them is simple and has but slight changes; and if the harmony and rhythm are also chosen for their simplicity, the result is that the speaker, if he speaks correctly, is always pretty much the same in style, and he will keep within the limits of a single harmony (for the changes are not great), and in like manner he will make use of nearly the same rhythm?

That is quite true, he said.

Whereas the other requires all sorts of harmonies and all sorts of rhythms, if the music and the style are to correspond, because the style has all sorts of changes.

That is also perfectly true, he replied.

And do not the two styles, or the mixture of the two, comprehend all poetry, and every form of expression in words? No one can say anything except in one or other of them or in both together.

They include all, he said.

And shall we receive into our State all the three styles, or one only of the two unmixed styles? or would you include the mixed?

I should prefer only to admit the pure imitator of virtue.

Yes, I said, Adeimantus, but the mixed style is also very charming: and indeed the pantomimic, which is the opposite of the one chosen by you, is the most popular style with children and their attendants, and with the world in general.

I do not deny it.

But I suppose you would argue that such a style is unsuitable to our State, in which human nature is not twofold or manifold, for one man plays one part only?

Yes; quite unsuitable.

And this is the reason why in our State, and in our State only, we shall find a shoemaker to be a shoemaker and not a pilot also, and a husbandman to be a husbandman and not a dicast also, and a soldier a soldier and not a trader also, and the same throughout?

True, he said.

And therefore when any one of these pantomimic gentlemen, who are so clever that they can imitate anything, comes to us, and makes a proposal to exhibit himself and his poetry, we will fall down and worship him as a sweet and holy and wonderful being; but we must also inform him that in our State such as he are not permitted to exist; the law will not allow them. And so when we have anointed him with myrrh, and set a garland of wool upon his head, we shall send him away to another city. For we mean to employ for our souls' health the rougher and severer poet or story-teller, who will imitate the style of the virtuous only, and will follow those models which we prescribed at first when we began the education of our soldiers.

We certainly will, he said, if we have the power.

Then now, my friend, I said, that part of music or literary education which relates to the story or myth may be considered to be finished; for the matter and manner have both been discussed.

I think so too, he said.

Next in order will follow melody and song.

That is obvious.

Every one can see already what we ought to say about them, if we are to be consistent with ourselves.

I fear, said Glaucon, laughing, that the word 'every one' hardly includes me, for I cannot at the moment say what they should be; though I may guess.

At any rate you can tell that a song or ode has three parts—the words, the melody, and the rhythm; that degree of knowledge I may presuppose?

Yes, he said; so much as that you may.

And as for the words, there will surely be no difference between words which are and which are not set to music; both will conform to the same laws, and these have been already determined by us?

Yes.

And the melody and rhythm will depend upon the words?

Certainly.

We were saying, when we spoke of the subject-matter, that we had no need of lamentation and strains of sorrow?

True.

And which are the harmonies expressive of sorrow? You are musical, and can tell me.

The harmonies which you mean are the mixed or tenor Lydian, and the full-toned or bass Lydian, and such like.

These then, I said, must be banished; even to women who have a character to maintain they are of no use, and much less to men.

Certainly.

In the next place, drunkenness and softness and indolence are utterly unbecoming the character of our guardians.

Utterly unbecoming.

And which are the soft or drinking harmonies?

The Ionian, he replied, and the Lydian; they are termed 'relaxed.'

Well, and are these of any military use?

Quite the reverse, he replied; and if so the Dorian and the Phrygian are the only ones which you have left.

I answered: Of the harmonies I know nothing, but I want to have one warlike, to sound the note or accent which a brave man utters in the hour of danger and stern resolve, or when his cause is failing, and he is going to wounds or death or is overtaken by some other evil, and at every such crisis meets the blows of fortune with firm step and a determination to endure; and another to be used by him in times of peace and freedom of action, when there is no pressure of necessity, and he is seeking to persuade God by prayer, or man by instruction and admonition, or on the other hand, when he is expressing his willingness to yield to persuasion or entreaty or admonition, and which represents him when by prudent conduct he has attained his end, not carried away by his success, but acting moderately and wisely under the circumstances, and acquiescing in the event. These two harmonies I ask you to leave; the strain of necessity and the strain of freedom, the strain of the unfortunate and the strain of the fortunate, the strain of courage, and the strain of temperance; these, I say, leave.

And these, he replied, are the Dorian and Phrygian harmonies of which I was just now speaking.

Then, I said, if these and these only are to be used in our songs and melodies, we shall not want multiplicity of notes or a panharmonic scale?

I suppose not.

Then we shall not maintain the artificers of lyres with three corners and complex scales, or the makers of any other many-stringed curiously-harmonised instruments?

Certainly not.

But what do you say to flute-makers and flute-players? Would you admit them into our State when you reflect that in this composite use of harmony the flute is worse than all the stringed instruments put together; even the panharmonic music is only an imitation of the flute?

Clearly not.

There remain then only the lyre and the harp for use in the city, and the shepherds may have a pipe in the country.

That is surely the conclusion to be drawn from the argument.

The preferring of Apollo and his instruments to Marsyas and his instruments is not at all strange, I said.

Not at all, he replied.

And so, by the dog of Egypt, we have been unconsciously purging the State, which not long ago we termed luxurious.

And we have done wisely, he replied.

Then let us now finish the purgation, I said. Next in order to harmonies, rhythms will naturally follow, and they should be subject to the same rules, for we ought not to seek out complex systems of metre, or metres of every kind, but rather to discover what rhythms are the expressions of a courageous and harmonious life; and when we have found them, we shall adapt the foot and the melody to words having a like spirit, not the words to the foot and melody. To say what these rhythms are will be your duty—you must teach me them, as you have already taught me the harmonies.

But, indeed, he replied, I cannot tell you. I only know that there are some three principles of rhythm out of which metrical systems are framed, just as in sounds there are four notes (i.e. the four notes of the tetrachord.) out of which all the harmonies are composed; that is an observation which I have made. But of what sort of lives they are severally the imitations I am unable to say.

Then, I said, we must take Damon into our counsels; and he will tell us what rhythms are expressive of meanness, or insolence, or fury, or other unworthiness, and what are to be reserved for the expression of opposite feelings. And I think that I have an indistinct recollection of his mentioning a complex Cretic rhythm; also a dactylic or heroic, and he arranged them in some manner which I do not quite understand, making the rhythms equal in the rise and fall of the foot, long and short alternating; and, unless I am mistaken, he spoke of an iambic as well as of a trochaic rhythm, and assigned to them short and long quantities. Also in some cases he appeared to praise or censure the movement of the foot quite as much as the rhythm; or perhaps a combination of the two; for I am not certain what he meant. These matters, however, as I was saying, had better be referred to Damon himself, for the analysis of the subject would be difficult, you know? (Socrates expresses himself carelessly in accordance with his assumed ignorance of the details of the subject. In the first part of the sentence he appears to be speaking of paeonic rhythms which are in the ratio of 3/2; in the second part, of dactylic and anapaestic rhythms, which are in the ratio of 1/1; in the last clause, of iambic and trochaic rhythms, which are in the ratio of 1/2 or 2/1.)

Rather so, I should say.

But there is no difficulty in seeing that grace or the absence of grace is an effect of good or bad rhythm.

None at all.

And also that good and bad rhythm naturally assimilate to a good and bad style; and that harmony and discord in like manner follow style; for our principle is that rhythm and harmony are regulated by the words, and not the words by them.

Just so, he said, they should follow the words.

And will not the words and the character of the style depend on the temper of the soul?

Yes.

And everything else on the style?

Yes.

Then beauty of style and harmony and grace and good rhythm depend on simplicity,—I mean the true simplicity of a rightly and nobly ordered mind and character, not that other simplicity which is only an euphemism for folly?

Very true, he replied.

And if our youth are to do their work in life, must they not make these graces and harmonies their perpetual aim?

They must.

And surely the art of the painter and every other creative and constructive art are full of them,—weaving, embroidery, architecture, and every kind of manufacture; also nature, animal and vegetable,—in all of them there is grace or the absence of grace. And ugliness and discord and inharmonious motion are nearly allied to ill words and ill nature, as grace and harmony are the twin sisters of goodness and virtue and bear their likeness.

That is quite true, he said.

But shall our superintendence go no further, and are the poets only to be required by us to express the image of the good in their works, on pain, if they do anything else, of expulsion from our State? Or is the same control to be extended to other artists, and are they also to be prohibited from exhibiting the opposite forms of vice and intemperance and meanness and indecency in sculpture and building and the other creative arts; and is he who cannot conform to this rule of ours to be prevented from practising his art in our State, lest the taste of our citizens be corrupted by him? We would not have our guardians grow up amid images of moral deformity, as in some noxious pasture, and there browse and feed upon many a baneful herb and flower day by day, little by little, until they silently gather a festering mass of corruption in their own soul. Let our artists rather be those who are gifted to discern the true nature of the beautiful and graceful; then will our youth dwell in a land of health, amid fair sights and sounds, and receive the good in everything; and beauty, the effluence of fair works, shall flow into the eye and ear, like a health-giving breeze from a purer region, and insensibly draw the soul from earliest years into likeness and sympathy with the beauty of reason.

There can be no nobler training than that, he replied.

And therefore, I said, Glaucon, musical training is a more potent instrument than any other, because rhythm and harmony find their way into the inward places of the soul, on which they mightily fasten, imparting grace, and making the soul of him who is rightly educated graceful, or of him who is ill-educated ungraceful; and also because he who has received this true education of the inner being will most shrewdly perceive omissions or faults in art and nature, and with a true taste, while he praises and rejoices over and receives into his soul the good, and becomes noble and good, he will justly blame and hate the bad, now in the days of his youth, even before he is able to know the reason why; and when reason comes he will recognise and salute the friend with whom his education has made him long familiar.

Yes, he said, I quite agree with you in thinking that our youth should be trained in music and on the grounds which you mention.

Just as in learning to read, I said, we were satisfied when we knew the letters of the alphabet, which are very few, in all their recurring sizes and combinations; not slighting them as unimportant whether they occupy a space large or small, but everywhere eager to make them out; and not thinking ourselves perfect in the art of reading until we recognise them wherever they are found:

True—

Or, as we recognise the reflection of letters in the water, or in a mirror, only when we know the letters themselves; the same art and study giving us the knowledge of both:

Exactly—

Even so, as I maintain, neither we nor our guardians, whom we have to educate, can ever become musical until we and they know the essential forms of temperance, courage, liberality, magnificence, and their kindred, as well as the contrary forms, in all their combinations, and can recognise them and their images wherever they are found, not slighting them either in small things or great, but believing them all to be within the sphere of one art and study.

Most assuredly.

And when a beautiful soul harmonizes with a beautiful form, and the two are cast in one mould, that will be the fairest of sights to him who has an eye to see it?

The fairest indeed.

And the fairest is also the loveliest?

That may be assumed.

And the man who has the spirit of harmony will be most in love with the loveliest; but he will not love him who is of an inharmonious soul?

That is true, he replied, if the deficiency be in his soul; but if there be any merely bodily defect in another he will be patient of it, and will love all the same.

I perceive, I said, that you have or have had experiences of this sort, and I agree. But let me ask you another question: Has excess of pleasure any affinity to temperance?

How can that be? he replied; pleasure deprives a man of the use of his faculties quite as much as pain.

Or any affinity to virtue in general?

None whatever.

Any affinity to wantonness and intemperance?

Yes, the greatest.

And is there any greater or keener pleasure than that of sensual love?

No, nor a madder.

Whereas true love is a love of beauty and order—temperate and harmonious?

Quite true, he said.

Then no intemperance or madness should be allowed to approach true love?

Certainly not.

Then mad or intemperate pleasure must never be allowed to come near the lover and his beloved; neither of them can have any part in it if their love is of the right sort?

No, indeed, Socrates, it must never come near them.

Then I suppose that in the city which we are founding you would make a law to the effect that a friend should use no other familiarity to his love than a father would use to his son, and then only for a noble purpose, and he must first have the other's consent; and this rule is to limit him in all his intercourse, and he is never to be seen going further, or, if he exceeds, he is to be deemed guilty of coarseness and bad taste.

I quite agree, he said.

Thus much of music, which makes a fair ending; for what should be the end of music if not the love of beauty?

I agree, he said.

After music comes gymnastic, in which our youth are next to be trained.

Certainly.

Gymnastic as well as music should begin in early years; the training in it should be careful and should continue through life. Now my belief is,—and this is a matter upon which I should like to have your opinion in confirmation of my own, but my own belief is,—not that the good body by any bodily excellence improves the soul, but, on the contrary, that the good soul, by her own excellence, improves the body as far as this may be possible. What do you say?

Yes, I agree.

Then, to the mind when adequately trained, we shall be right in handing over the more particular care of the body; and in order to avoid prolixity we will now only give the general outlines of the subject.

Very good.

That they must abstain from intoxication has been already remarked by us; for of all persons a guardian should be the last to get drunk and not know where in the world he is.

Yes, he said; that a guardian should require another guardian to take care of him is ridiculous indeed.

But next, what shall we say of their food; for the men are in training for the great contest of all—are they not?

Yes, he said.

And will the habit of body of our ordinary athletes be suited to them?

Why not?

I am afraid, I said, that a habit of body such as they have is but a sleepy sort of thing, and rather perilous to health. Do you not observe that these athletes sleep away their lives, and are liable to most dangerous illnesses if they depart, in ever so slight a degree, from their customary regimen?

Yes, I do.

Then, I said, a finer sort of training will be required for our warrior athletes, who are to be like wakeful dogs, and to see and hear with the utmost keenness; amid the many changes of water and also of food, of summer heat and winter cold, which they will have to endure when on a campaign, they must not be liable to break down in health.

That is my view.

The really excellent gymnastic is twin sister of that simple music which we were just now describing.

How so?

Why, I conceive that there is a gymnastic which, like our music, is simple and good; and especially the military gymnastic.

What do you mean?

My meaning may be learned from Homer; he, you know, feeds his heroes at their feasts, when they are campaigning, on soldiers' fare; they have no fish, although they are on the shores of the Hellespont, and they are not allowed boiled meats but only roast, which is the food most convenient for soldiers, requiring only that they should light a fire, and not involving the trouble of carrying about pots and pans.

True.

And I can hardly be mistaken in saying that sweet sauces are nowhere mentioned in Homer. In proscribing them, however, he is not singular; all professional athletes are well aware that a man who is to be in good condition should take nothing of the kind.

Yes, he said; and knowing this, they are quite right in not taking them.

Then you would not approve of Syracusan dinners, and the refinements of Sicilian cookery?

I think not.

Nor, if a man is to be in condition, would you allow him to have a Corinthian girl as his fair friend?

Certainly not.

Neither would you approve of the delicacies, as they are thought, of Athenian confectionary?

Certainly not.

All such feeding and living may be rightly compared by us to melody and song composed in the panharmonic style, and in all the rhythms.

Exactly.

There complexity engendered licence, and here disease; whereas simplicity in music was the parent of temperance in the soul; and simplicity in gymnastic of health in the body.

Most true, he said.

But when intemperance and diseases multiply in a State, halls of justice and medicine are always being opened; and the arts of the doctor and the lawyer give themselves airs, finding how keen is the interest which not only the slaves but the freemen of a city take about them.

Of course.

And yet what greater proof can there be of a bad and disgraceful state of education than this, that not only artisans and the meaner sort of people need the skill of first-rate physicians and judges, but also those who would profess to have had a liberal education? Is it not disgraceful, and a great sign of want of good-breeding, that a man should have to go abroad for his law and physic because he has none of his own at home, and must therefore surrender himself into the hands of other men whom he makes lords and judges over him?

Of all things, he said, the most disgraceful.

Would you say 'most,' I replied, when you consider that there is a further stage of the evil in which a man is not only a life-long litigant, passing all his days in the courts, either as plaintiff or defendant, but is actually led by his bad taste to pride himself on his litigiousness; he imagines that he is a master in dishonesty; able to take every crooked turn, and wriggle into and out of every hole, bending like a withy and getting out of the way of justice: and all for what?—in order to gain small points not worth mentioning, he not knowing that so to order his life as to be able to do without a napping judge is a far higher and nobler sort of thing. Is not that still more disgraceful?

Yes, he said, that is still more disgraceful.

Well, I said, and to require the help of medicine, not when a wound has to be cured, or on occasion of an epidemic, but just because, by indolence and a habit of life such as we have been describing, men fill themselves with waters and winds, as if their bodies were a marsh, compelling the ingenious sons of Asclepius to find more names for diseases, such as flatulence and catarrh; is not this, too, a disgrace?

Yes, he said, they do certainly give very strange and newfangled names to diseases.

Yes, I said, and I do not believe that there were any such diseases in the days of Asclepius; and this I infer from the circumstance that the hero Eurypylus, after he has been wounded in Homer, drinks a posset of Pramnian wine well besprinkled with barley-meal and grated cheese, which are certainly inflammatory, and yet the sons of Asclepius who were at the Trojan war do not blame the damsel who gives him the drink, or rebuke Patroclus, who is treating his case.

Well, he said, that was surely an extraordinary drink to be given to a person in his condition.

Not so extraordinary, I replied, if you bear in mind that in former days, as is commonly said, before the time of Herodicus, the guild of Asclepius did not practise our present system of medicine, which may be said to educate diseases. But Herodicus, being a trainer, and himself of a sickly constitution, by a combination of training and doctoring found out a way of torturing first and chiefly himself, and secondly the rest of the world.

How was that? he said.

By the invention of lingering death; for he had a mortal disease which he perpetually tended, and as recovery was out of the question, he passed his entire life as a valetudinarian; he could do nothing but attend upon himself, and he was in constant torment whenever he departed in anything from his usual regimen, and so dying hard, by the help of science he struggled on to old age.

A rare reward of his skill!

Yes, I said; a reward which a man might fairly expect who never understood that, if Asclepius did not instruct his descendants in valetudinarian arts, the omission arose, not from ignorance or inexperience of such a branch of medicine, but because he knew that in all well-ordered states every individual has an occupation to which he must attend, and has therefore no leisure to spend in continually being ill. This we remark in the case of the artisan, but, ludicrously enough, do not apply the same rule to people of the richer sort.

How do you mean? he said.

I mean this: When a carpenter is ill he asks the physician for a rough and ready cure; an emetic or a purge or a cautery or the knife,—these are his remedies. And if some one prescribes for him a course of dietetics, and tells him that he must swathe and swaddle his head, and all that sort of thing, he replies at once that he has no time to be ill, and that he sees no good in a life which is spent in nursing his disease to the neglect of his customary employment; and therefore bidding good-bye to this sort of physician, he resumes his ordinary habits, and either gets well and lives and does his business, or, if his constitution fails, he dies and has no more trouble.

Yes, he said, and a man in his condition of life ought to use the art of medicine thus far only.

Has he not, I said, an occupation; and what profit would there be in his life if he were deprived of his occupation?

Quite true, he said.

But with the rich man this is otherwise; of him we do not say that he has any specially appointed work which he must perform, if he would live.

He is generally supposed to have nothing to do.

Then you never heard of the saying of Phocylides, that as soon as a man has a livelihood he should practise virtue?

Nay, he said, I think that he had better begin somewhat sooner.

Let us not have a dispute with him about this, I said; but rather ask ourselves: Is the practice of virtue obligatory on the rich man, or can he live without it? And if obligatory on him, then let us raise a further question, whether this dieting of disorders, which is an impediment to the application of the mind in carpentering and the mechanical arts, does not equally stand in the way of the sentiment of Phocylides?

Of that, he replied, there can be no doubt; such excessive care of the body, when carried beyond the rules of gymnastic, is most inimical to the practice of virtue.

Yes, indeed, I replied, and equally incompatible with the management of a house, an army, or an office of state; and, what is most important of all, irreconcileable with any kind of study or thought or self-reflection—there is a constant suspicion that headache and giddiness are to be ascribed to philosophy, and hence all practising or making trial of virtue in the higher sense is absolutely stopped; for a man is always fancying that he is being made ill, and is in constant anxiety about the state of his body.

Yes, likely enough.

And therefore our politic Asclepius may be supposed to have exhibited the power of his art only to persons who, being generally of healthy constitution and habits of life, had a definite ailment; such as these he cured by purges and operations, and bade them live as usual, herein consulting the interests of the State; but bodies which disease had penetrated through and through he would not have attempted to cure by gradual processes of evacuation and infusion: he did not want to lengthen out good-for-nothing lives, or to have weak fathers begetting weaker sons;—if a man was not able to live in the ordinary way he had no business to cure him; for such a cure would have been of no use either to himself, or to the State.

Then, he said, you regard Asclepius as a statesman.

Clearly; and his character is further illustrated by his sons. Note that they were heroes in the days of old and practised the medicines of which I am speaking at the siege of Troy: You will remember how, when Pandarus wounded Menelaus, they

'Sucked the blood out of the wound, and sprinkled soothing remedies,'

but they never prescribed what the patient was afterwards to eat or drink in the case of Menelaus, any more than in the case of Eurypylus; the remedies, as they conceived, were enough to heal any man who before he was wounded was healthy and regular in his habits; and even though he did happen to drink a posset of Pramnian wine, he might get well all the same. But they would have nothing to do with unhealthy and intemperate subjects, whose lives were of no use either to themselves or others; the art of medicine was not designed for their good, and though they were as rich as Midas, the sons of Asclepius would have declined to attend them.

They were very acute persons, those sons of Asclepius.

Naturally so, I replied. Nevertheless, the tragedians and Pindar disobeying our behests, although they acknowledge that Asclepius was the son of Apollo, say also that he was bribed into healing a rich man who was at the point of death, and for this reason he was struck by lightning. But we, in accordance with the principle already affirmed by us, will not believe them when they tell us both;—if he was the son of a god, we maintain that he was not avaricious; or, if he was avaricious, he was not the son of a god.

All that, Socrates, is excellent; but I should like to put a question to you: Ought there not to be good physicians in a State, and are not the best those who have treated the greatest number of constitutions good and bad? and are not the best judges in like manner those who are acquainted with all sorts of moral natures?

Yes, I said, I too would have good judges and good physicians. But do you know whom I think good?

Will you tell me?

I will, if I can. Let me however note that in the same question you join two things which are not the same.

How so? he asked.

Why, I said, you join physicians and judges. Now the most skilful physicians are those who, from their youth upwards, have combined with the knowledge of their art the greatest experience of disease; they had better not be robust in health, and should have had all manner of diseases in their own persons. For the body, as I conceive, is not the instrument with which they cure the body; in that case we could not allow them ever to be or to have been sickly; but they cure the body with the mind, and the mind which has become and is sick can cure nothing.

That is very true, he said.

But with the judge it is otherwise; since he governs mind by mind; he ought not therefore to have been trained among vicious minds, and to have associated with them from youth upwards, and to have gone through the whole calendar of crime, only in order that he may quickly infer the crimes of others as he might their bodily diseases from his own self-consciousness; the honourable mind which is to form a healthy judgment should have had no experience or contamination of evil habits when young. And this is the reason why in youth good men often appear to be simple, and are easily practised upon by the dishonest, because they have no examples of what evil is in their own souls.

Yes, he said, they are far too apt to be deceived.

Therefore, I said, the judge should not be young; he should have learned to know evil, not from his own soul, but from late and long observation of the nature of evil in others: knowledge should be his guide, not personal experience.

Yes, he said, that is the ideal of a judge.

Yes, I replied, and he will be a good man (which is my answer to your question); for he is good who has a good soul. But the cunning and suspicious nature of which we spoke,—he who has committed many crimes, and fancies himself to be a master in wickedness, when he is amongst his fellows, is wonderful in the precautions which he takes, because he judges of them by himself: but when he gets into the company of men of virtue, who have the experience of age, he appears to be a fool again, owing to his unseasonable suspicions; he cannot recognise an honest man, because he has no pattern of honesty in himself; at the same time, as the bad are more numerous than the good, and he meets with them oftener, he thinks himself, and is by others thought to be, rather wise than foolish.

Most true, he said.

Then the good and wise judge whom we are seeking is not this man, but the other; for vice cannot know virtue too, but a virtuous nature, educated by time, will acquire a knowledge both of virtue and vice: the virtuous, and not the vicious, man has wisdom—in my opinion.

And in mine also.

This is the sort of medicine, and this is the sort of law, which you will sanction in your state. They will minister to better natures, giving health both of soul and of body; but those who are diseased in their bodies they will leave to die, and the corrupt and incurable souls they will put an end to themselves.

That is clearly the best thing both for the patients and for the State.

And thus our youth, having been educated only in that simple music which, as we said, inspires temperance, will be reluctant to go to law.

Clearly.

And the musician, who, keeping to the same track, is content to practise the simple gymnastic, will have nothing to do with medicine unless in some extreme case.

That I quite believe.

The very exercises and tolls which he undergoes are intended to stimulate the spirited element of his nature, and not to increase his strength; he will not, like common athletes, use exercise and regimen to develope his muscles.

Very right, he said.

Neither are the two arts of music and gymnastic really designed, as is often supposed, the one for the training of the soul, the other for the training of the body.

What then is the real object of them?

I believe, I said, that the teachers of both have in view chiefly the improvement of the soul.

How can that be? he asked.

Did you never observe, I said, the effect on the mind itself of exclusive devotion to gymnastic, or the opposite effect of an exclusive devotion to music?

In what way shown? he said.

The one producing a temper of hardness and ferocity, the other of softness and effeminacy, I replied.

Yes, he said, I am quite aware that the mere athlete becomes too much of a savage, and that the mere musician is melted and softened beyond what is good for him.

Yet surely, I said, this ferocity only comes from spirit, which, if rightly educated, would give courage, but, if too much intensified, is liable to become hard and brutal.

That I quite think.

On the other hand the philosopher will have the quality of gentleness. And this also, when too much indulged, will turn to softness, but, if educated rightly, will be gentle and moderate.

True.

And in our opinion the guardians ought to have both these qualities?

Assuredly.

And both should be in harmony?

Beyond question.

And the harmonious soul is both temperate and courageous?

Yes.

And the inharmonious is cowardly and boorish?

Very true.

And, when a man allows music to play upon him and to pour into his soul through the funnel of his ears those sweet and soft and melancholy airs of which we were just now speaking, and his whole life is passed in warbling and the delights of song; in the first stage of the process the passion or spirit which is in him is tempered like iron, and made useful, instead of brittle and useless. But, if he carries on the softening and soothing process, in the next stage he begins to melt and waste, until he has wasted away his spirit and cut out the sinews of his soul; and he becomes a feeble warrior.

Very true.

If the element of spirit is naturally weak in him the change is speedily accomplished, but if he have a good deal, then the power of music weakening the spirit renders him excitable;—on the least provocation he flames up at once, and is speedily extinguished; instead of having spirit he grows irritable and passionate and is quite impracticable.

Exactly.

And so in gymnastics, if a man takes violent exercise and is a great feeder, and the reverse of a great student of music and philosophy, at first the high condition of his body fills him with pride and spirit, and he becomes twice the man that he was.

Certainly.

And what happens? if he do nothing else, and holds no converse with the Muses, does not even that intelligence which there may be in him, having no taste of any sort of learning or enquiry or thought or culture, grow feeble and dull and blind, his mind never waking up or receiving nourishment, and his senses not being purged of their mists?

True, he said.

And he ends by becoming a hater of philosophy, uncivilized, never using the weapon of persuasion,—he is like a wild beast, all violence and fierceness, and knows no other way of dealing; and he lives in all ignorance and evil conditions, and has no sense of propriety and grace.

That is quite true, he said.

And as there are two principles of human nature, one the spirited and the other the philosophical, some God, as I should say, has given mankind two arts answering to them (and only indirectly to the soul and body), in order that these two principles (like the strings of an instrument) may be relaxed or drawn tighter until they are duly harmonized.

That appears to be the intention.

And he who mingles music with gymnastic in the fairest proportions, and best attempers them to the soul, may be rightly called the true musician and harmonist in a far higher sense than the tuner of the strings.

You are quite right, Socrates.

And such a presiding genius will be always required in our State if the government is to last.

Yes, he will be absolutely necessary.

Such, then, are our principles of nurture and education: Where would be the use of going into further details about the dances of our citizens, or about their hunting and coursing, their gymnastic and equestrian contests? For these all follow the general principle, and having found that, we shall have no difficulty in discovering them.

I dare say that there will be no difficulty.

Very good, I said; then what is the next question? Must we not ask who are to be rulers and who subjects?

Certainly.

There can be no doubt that the elder must rule the younger.

Clearly.

And that the best of these must rule.

That is also clear.

Now, are not the best husbandmen those who are most devoted to husbandry?

Yes.

And as we are to have the best of guardians for our city, must they not be those who have most the character of guardians?

Yes.

And to this end they ought to be wise and efficient, and to have a special care of the State?

True.

And a man will be most likely to care about that which he loves?

To be sure.

And he will be most likely to love that which he regards as having the same interests with himself, and that of which the good or evil fortune is supposed by him at any time most to affect his own?

Very true, he replied.

Then there must be a selection. Let us note among the guardians those who in their whole life show the greatest eagerness to do what is for the good of their country, and the greatest repugnance to do what is against her interests.

Those are the right men.

And they will have to be watched at every age, in order that we may see whether they preserve their resolution, and never, under the influence either of force or enchantment, forget or cast off their sense of duty to the State.

How cast off? he said.

I will explain to you, I replied. A resolution may go out of a man's mind either with his will or against his will; with his will when he gets rid of a falsehood and learns better, against his will whenever he is deprived of a truth.

I understand, he said, the willing loss of a resolution; the meaning of the unwilling I have yet to learn.

Why, I said, do you not see that men are unwillingly deprived of good, and willingly of evil? Is not to have lost the truth an evil, and to possess the truth a good? and you would agree that to conceive things as they are is to possess the truth?

Yes, he replied; I agree with you in thinking that mankind are deprived of truth against their will.

And is not this involuntary deprivation caused either by theft, or force, or enchantment?

Still, he replied, I do not understand you.

I fear that I must have been talking darkly, like the tragedians. I only mean that some men are changed by persuasion and that others forget; argument steals away the hearts of one class, and time of the other; and this I call theft. Now you understand me?

Yes.

Those again who are forced, are those whom the violence of some pain or grief compels to change their opinion.

I understand, he said, and you are quite right.

And you would also acknowledge that the enchanted are those who change their minds either under the softer influence of pleasure, or the sterner influence of fear?

Yes, he said; everything that deceives may be said to enchant.

Therefore, as I was just now saying, we must enquire who are the best guardians of their own conviction that what they think the interest of the State is to be the rule of their lives. We must watch them from their youth upwards, and make them perform actions in which they are most likely to forget or to be deceived, and he who remembers and is not deceived is to be selected, and he who fails in the trial is to be rejected. That will be the way?

Yes.

And there should also be toils and pains and conflicts prescribed for them, in which they will be made to give further proof of the same qualities.

Very right, he replied.

And then, I said, we must try them with enchantments—that is the third sort of test—and see what will be their behaviour: like those who take colts amid noise and tumult to see if they are of a timid nature, so must we take our youth amid terrors of some kind, and again pass them into pleasures, and prove them more thoroughly than gold is proved in the furnace, that we may discover whether they are armed against all enchantments, and of a noble bearing always, good guardians of themselves and of the music which they have learned, and retaining under all circumstances a rhythmical and harmonious nature, such as will be most serviceable to the individual and to the State. And he who at every age, as boy and youth and in mature life, has come out of the trial victorious and pure, shall be appointed a ruler and guardian of the State; he shall be honoured in life and death, and shall receive sepulture and other memorials of honour, the greatest that we have to give. But him who fails, we must reject. I am inclined to think that this is the sort of way in which our rulers and guardians should be chosen and appointed. I speak generally, and not with any pretension to exactness.

And, speaking generally, I agree with you, he said.

And perhaps the word 'guardian' in the fullest sense ought to be applied to this higher class only who preserve us against foreign enemies and maintain peace among our citizens at home, that the one may not have the will, or the others the power, to harm us. The young men whom we before called guardians may be more properly designated auxiliaries and supporters of the principles of the rulers.

I agree with you, he said.

How then may we devise one of those needful falsehoods of which we lately spoke—just one royal lie which may deceive the rulers, if that be possible, and at any rate the rest of the city?

What sort of lie? he said.

Nothing new, I replied; only an old Phoenician tale (Laws) of what has often occurred before now in other places, (as the poets say, and have made the world believe,) though not in our time, and I do not know whether such an event could ever happen again, or could now even be made probable, if it did.

How your words seem to hesitate on your lips!

You will not wonder, I replied, at my hesitation when you have heard.

Speak, he said, and fear not.

Well then, I will speak, although I really know not how to look you in the face, or in what words to utter the audacious fiction, which I propose to communicate gradually, first to the rulers, then to the soldiers, and lastly to the people. They are to be told that their youth was a dream, and the education and training which they received from us, an appearance only; in reality during all that time they were being formed and fed in the womb of the earth, where they themselves and their arms and appurtenances were manufactured; when they were completed, the earth, their mother, sent them up; and so, their country being their mother and also their nurse, they are bound to advise for her good, and to defend her against attacks, and her citizens they are to regard as children of the earth and their own brothers.

You had good reason, he said, to be ashamed of the lie which you were going to tell.

True, I replied, but there is more coming; I have only told you half. Citizens, we shall say to them in our tale, you are brothers, yet God has framed you differently. Some of you have the power of command, and in the composition of these he has mingled gold, wherefore also they have the greatest honour; others he has made of silver, to be auxiliaries; others again who are to be husbandmen and craftsmen he has composed of brass and iron; and the species will generally be preserved in the children. But as all are of the same original stock, a golden parent will sometimes have a silver son, or a silver parent a golden son. And God proclaims as a first principle to the rulers, and above all else, that there is nothing which they should so anxiously guard, or of which they are to be such good guardians, as of the purity of the race. They should observe what elements mingle in their offspring; for if the son of a golden or silver parent has an admixture of brass and iron, then nature orders a transposition of ranks, and the eye of the ruler must not be pitiful towards the child because he has to descend in the scale and become a husbandman or artisan, just as there may be sons of artisans who having an admixture of gold or silver in them are raised to honour, and become guardians or auxiliaries. For an oracle says that when a man of brass or iron guards the State, it will be destroyed. Such is the tale; is there any possibility of making our citizens believe in it?

Not in the present generation, he replied; there is no way of accomplishing this; but their sons may be made to believe in the tale, and their sons' sons, and posterity after them.

I see the difficulty, I replied; yet the fostering of such a belief will make them care more for the city and for one another. Enough, however, of the fiction, which may now fly abroad upon the wings of rumour, while we arm our earth-born heroes, and lead them forth under the command of their rulers. Let them look round and select a spot whence they can best suppress insurrection, if any prove refractory within, and also defend themselves against enemies, who like wolves may come down on the fold from without; there let them encamp, and when they have encamped, let them sacrifice to the proper Gods and prepare their dwellings.

Just so, he said.

And their dwellings must be such as will shield them against the cold of winter and the heat of summer.

I suppose that you mean houses, he replied.

Yes, I said; but they must be the houses of soldiers, and not of shop-keepers.

What is the difference? he said.

That I will endeavour to explain, I replied. To keep watch-dogs, who, from want of discipline or hunger, or some evil habit or other, would turn upon the sheep and worry them, and behave not like dogs but wolves, would be a foul and monstrous thing in a shepherd?

Truly monstrous, he said.

And therefore every care must be taken that our auxiliaries, being stronger than our citizens, may not grow to be too much for them and become savage tyrants instead of friends and allies?

Yes, great care should be taken.

And would not a really good education furnish the best safeguard?

But they are well-educated already, he replied.

I cannot be so confident, my dear Glaucon, I said; I am much more certain that they ought to be, and that true education, whatever that may be, will have the greatest tendency to civilize and humanize them in their relations to one another, and to those who are under their protection.

Very true, he replied.

And not only their education, but their habitations, and all that belongs to them, should be such as will neither impair their virtue as guardians, nor tempt them to prey upon the other citizens. Any man of sense must acknowledge that.

He must.

Then now let us consider what will be their way of life, if they are to realize our idea of them. In the first place, none of them should have any property of his own beyond what is absolutely necessary; neither should they have a private house or store closed against any one who has a mind to enter; their provisions should be only such as are required by trained warriors, who are men of temperance and courage; they should agree to receive from the citizens a fixed rate of pay, enough to meet the expenses of the year and no more; and they will go to mess and live together like soldiers in a camp. Gold and silver we will tell them that they have from God; the diviner metal is within them, and they have therefore no need of the dross which is current among men, and ought not to pollute the divine by any such earthly admixture; for that commoner metal has been the source of many unholy deeds, but their own is undefiled. And they alone of all the citizens may not touch or handle silver or gold, or be under the same roof with them, or wear them, or drink from them. And this will be their salvation, and they will be the saviours of the State. But should they ever acquire homes or lands or moneys of their own, they will become housekeepers and husbandmen instead of guardians, enemies and tyrants instead of allies of the other citizens; hating and being hated, plotting and being plotted against, they will pass their whole life in much greater terror of internal than of external enemies, and the hour of ruin, both to themselves and to the rest of the State, will be at hand. For all which reasons may we not say that thus shall our State be ordered, and that these shall be the regulations appointed by us for guardians concerning their houses and all other matters?

Yes, said Glaucon.</pre>
</div>
<div created="20150302202722802" modified="20150302213112329" tags="" title="Book IV (Jowett translation)">
<pre>Here Adeimantus interposed a question: How would you answer, Socrates, said he, if a person were to say that you are making these people miserable, and that they are the cause of their own unhappiness; the city in fact belongs to them, but they are none the better for it; whereas other men acquire lands, and build large and handsome houses, and have everything handsome about them, offering sacrifices to the gods on their own account, and practising hospitality; moreover, as you were saying just now, they have gold and silver, and all that is usual among the favourites of fortune; but our poor citizens are no better than mercenaries who are quartered in the city and are always mounting guard?

Yes, I said; and you may add that they are only fed, and not paid in addition to their food, like other men; and therefore they cannot, if they would, take a journey of pleasure; they have no money to spend on a mistress or any other luxurious fancy, which, as the world goes, is thought to be happiness; and many other accusations of the same nature might be added.

But, said he, let us suppose all this to be included in the charge.

You mean to ask, I said, what will be our answer?

Yes.

If we proceed along the old path, my belief, I said, is that we shall find the answer. And our answer will be that, even as they are, our guardians may very likely be the happiest of men; but that our aim in founding the State was not the disproportionate happiness of any one class, but the greatest happiness of the whole; we thought that in a State which is ordered with a view to the good of the whole we should be most likely to find justice, and in the ill-ordered State injustice: and, having found them, we might then decide which of the two is the happier. At present, I take it, we are fashioning the happy State, not piecemeal, or with a view of making a few happy citizens, but as a whole; and by-and-by we will proceed to view the opposite kind of State. Suppose that we were painting a statue, and some one came up to us and said, Why do you not put the most beautiful colours on the most beautiful parts of the body—the eyes ought to be purple, but you have made them black—to him we might fairly answer, Sir, you would not surely have us beautify the eyes to such a degree that they are no longer eyes; consider rather whether, by giving this and the other features their due proportion, we make the whole beautiful. And so I say to you, do not compel us to assign to the guardians a sort of happiness which will make them anything but guardians; for we too can clothe our husbandmen in royal apparel, and set crowns of gold on their heads, and bid them till the ground as much as they like, and no more. Our potters also might be allowed to repose on couches, and feast by the fireside, passing round the winecup, while their wheel is conveniently at hand, and working at pottery only as much as they like; in this way we might make every class happy—and then, as you imagine, the whole State would be happy. But do not put this idea into our heads; for, if we listen to you, the husbandman will be no longer a husbandman, the potter will cease to be a potter, and no one will have the character of any distinct class in the State. Now this is not of much consequence where the corruption of society, and pretension to be what you are not, is confined to cobblers; but when the guardians of the laws and of the government are only seeming and not real guardians, then see how they turn the State upside down; and on the other hand they alone have the power of giving order and happiness to the State. We mean our guardians to be true saviours and not the destroyers of the State, whereas our opponent is thinking of peasants at a festival, who are enjoying a life of revelry, not of citizens who are doing their duty to the State. But, if so, we mean different things, and he is speaking of something which is not a State. And therefore we must consider whether in appointing our guardians we would look to their greatest happiness individually, or whether this principle of happiness does not rather reside in the State as a whole. But if the latter be the truth, then the guardians and auxiliaries, and all others equally with them, must be compelled or induced to do their own work in the best way. And thus the whole State will grow up in a noble order, and the several classes will receive the proportion of happiness which nature assigns to them.

I think that you are quite right.

I wonder whether you will agree with another remark which occurs to me.

What may that be?

There seem to be two causes of the deterioration of the arts.

What are they?

Wealth, I said, and poverty.

How do they act?

The process is as follows: When a potter becomes rich, will he, think you, any longer take the same pains with his art?

Certainly not.

He will grow more and more indolent and careless?

Very true.

And the result will be that he becomes a worse potter?

Yes; he greatly deteriorates.

But, on the other hand, if he has no money, and cannot provide himself with tools or instruments, he will not work equally well himself, nor will he teach his sons or apprentices to work equally well.

Certainly not.

Then, under the influence either of poverty or of wealth, workmen and their work are equally liable to degenerate?

That is evident.

Here, then, is a discovery of new evils, I said, against which the guardians will have to watch, or they will creep into the city unobserved.

What evils?

Wealth, I said, and poverty; the one is the parent of luxury and indolence, and the other of meanness and viciousness, and both of discontent.

That is very true, he replied; but still I should like to know, Socrates, how our city will be able to go to war, especially against an enemy who is rich and powerful, if deprived of the sinews of war.

There would certainly be a difficulty, I replied, in going to war with one such enemy; but there is no difficulty where there are two of them.

How so? he asked.

In the first place, I said, if we have to fight, our side will be trained warriors fighting against an army of rich men.

That is true, he said.

And do you not suppose, Adeimantus, that a single boxer who was perfect in his art would easily be a match for two stout and well-to-do gentlemen who were not boxers?

Hardly, if they came upon him at once.

What, now, I said, if he were able to run away and then turn and strike at the one who first came up? And supposing he were to do this several times under the heat of a scorching sun, might he not, being an expert, overturn more than one stout personage?

Certainly, he said, there would be nothing wonderful in that.

And yet rich men probably have a greater superiority in the science and practise of boxing than they have in military qualities.

Likely enough.

Then we may assume that our athletes will be able to fight with two or three times their own number?

I agree with you, for I think you right.

And suppose that, before engaging, our citizens send an embassy to one of the two cities, telling them what is the truth: Silver and gold we neither have nor are permitted to have, but you may; do you therefore come and help us in war, and take the spoils of the other city: Who, on hearing these words, would choose to fight against lean wiry dogs, rather than, with the dogs on their side, against fat and tender sheep?

That is not likely; and yet there might be a danger to the poor State if the wealth of many States were to be gathered into one.

But how simple of you to use the term State at all of any but our own!

Why so?

You ought to speak of other States in the plural number; not one of them is a city, but many cities, as they say in the game. For indeed any city, however small, is in fact divided into two, one the city of the poor, the other of the rich; these are at war with one another; and in either there are many smaller divisions, and you would be altogether beside the mark if you treated them all as a single State. But if you deal with them as many, and give the wealth or power or persons of the one to the others, you will always have a great many friends and not many enemies. And your State, while the wise order which has now been prescribed continues to prevail in her, will be the greatest of States, I do not mean to say in reputation or appearance, but in deed and truth, though she number not more than a thousand defenders. A single State which is her equal you will hardly find, either among Hellenes or barbarians, though many that appear to be as great and many times greater.

That is most true, he said.

And what, I said, will be the best limit for our rulers to fix when they are considering the size of the State and the amount of territory which they are to include, and beyond which they will not go?

What limit would you propose?

I would allow the State to increase so far as is consistent with unity; that, I think, is the proper limit.

Very good, he said.

Here then, I said, is another order which will have to be conveyed to our guardians: Let our city be accounted neither large nor small, but one and self-sufficing.

And surely, said he, this is not a very severe order which we impose upon them.

And the other, said I, of which we were speaking before is lighter still,—I mean the duty of degrading the offspring of the guardians when inferior, and of elevating into the rank of guardians the offspring of the lower classes, when naturally superior. The intention was, that, in the case of the citizens generally, each individual should be put to the use for which nature intended him, one to one work, and then every man would do his own business, and be one and not many; and so the whole city would be one and not many.

Yes, he said; that is not so difficult.

The regulations which we are prescribing, my good Adeimantus, are not, as might be supposed, a number of great principles, but trifles all, if care be taken, as the saying is, of the one great thing,—a thing, however, which I would rather call, not great, but sufficient for our purpose.

What may that be? he asked.

Education, I said, and nurture: If our citizens are well educated, and grow into sensible men, they will easily see their way through all these, as well as other matters which I omit; such, for example, as marriage, the possession of women and the procreation of children, which will all follow the general principle that friends have all things in common, as the proverb says.

That will be the best way of settling them.

Also, I said, the State, if once started well, moves with accumulating force like a wheel. For good nurture and education implant good constitutions, and these good constitutions taking root in a good education improve more and more, and this improvement affects the breed in man as in other animals.

Very possibly, he said.

Then to sum up: This is the point to which, above all, the attention of our rulers should be directed,—that music and gymnastic be preserved in their original form, and no innovation made. They must do their utmost to maintain them intact. And when any one says that mankind most regard

'The newest song which the singers have,'

they will be afraid that he may be praising, not new songs, but a new kind of song; and this ought not to be praised, or conceived to be the meaning of the poet; for any musical innovation is full of danger to the whole State, and ought to be prohibited. So Damon tells me, and I can quite believe him;—he says that when modes of music change, the fundamental laws of the State always change with them.

Yes, said Adeimantus; and you may add my suffrage to Damon's and your own.

Then, I said, our guardians must lay the foundations of their fortress in music?

Yes, he said; the lawlessness of which you speak too easily steals in.

Yes, I replied, in the form of amusement; and at first sight it appears harmless.

Why, yes, he said, and there is no harm; were it not that little by little this spirit of licence, finding a home, imperceptibly penetrates into manners and customs; whence, issuing with greater force, it invades contracts between man and man, and from contracts goes on to laws and constitutions, in utter recklessness, ending at last, Socrates, by an overthrow of all rights, private as well as public.

Is that true? I said.

That is my belief, he replied.

Then, as I was saying, our youth should be trained from the first in a stricter system, for if amusements become lawless, and the youths themselves become lawless, they can never grow up into well-conducted and virtuous citizens.

Very true, he said.

And when they have made a good beginning in play, and by the help of music have gained the habit of good order, then this habit of order, in a manner how unlike the lawless play of the others! will accompany them in all their actions and be a principle of growth to them, and if there be any fallen places in the State will raise them up again.

Very true, he said.

Thus educated, they will invent for themselves any lesser rules which their predecessors have altogether neglected.

What do you mean?

I mean such things as these:—when the young are to be silent before their elders; how they are to show respect to them by standing and making them sit; what honour is due to parents; what garments or shoes are to be worn; the mode of dressing the hair; deportment and manners in general. You would agree with me?

Yes.

But there is, I think, small wisdom in legislating about such matters,—I doubt if it is ever done; nor are any precise written enactments about them likely to be lasting.

Impossible.

It would seem, Adeimantus, that the direction in which education starts a man, will determine his future life. Does not like always attract like?

To be sure.

Until some one rare and grand result is reached which may be good, and may be the reverse of good?

That is not to be denied.

And for this reason, I said, I shall not attempt to legislate further about them.

Naturally enough, he replied.

Well, and about the business of the agora, and the ordinary dealings between man and man, or again about agreements with artisans; about insult and injury, or the commencement of actions, and the appointment of juries, what would you say? there may also arise questions about any impositions and exactions of market and harbour dues which may be required, and in general about the regulations of markets, police, harbours, and the like. But, oh heavens! shall we condescend to legislate on any of these particulars?

I think, he said, that there is no need to impose laws about them on good men; what regulations are necessary they will find out soon enough for themselves.

Yes, I said, my friend, if God will only preserve to them the laws which we have given them.

And without divine help, said Adeimantus, they will go on for ever making and mending their laws and their lives in the hope of attaining perfection.

You would compare them, I said, to those invalids who, having no self-restraint, will not leave off their habits of intemperance?

Exactly.

Yes, I said; and what a delightful life they lead! they are always doctoring and increasing and complicating their disorders, and always fancying that they will be cured by any nostrum which anybody advises them to try.

Such cases are very common, he said, with invalids of this sort.

Yes, I replied; and the charming thing is that they deem him their worst enemy who tells them the truth, which is simply that, unless they give up eating and drinking and wenching and idling, neither drug nor cautery nor spell nor amulet nor any other remedy will avail.

Charming! he replied. I see nothing charming in going into a passion with a man who tells you what is right.

These gentlemen, I said, do not seem to be in your good graces.

Assuredly not.

Nor would you praise the behaviour of States which act like the men whom I was just now describing. For are there not ill-ordered States in which the citizens are forbidden under pain of death to alter the constitution; and yet he who most sweetly courts those who live under this regime and indulges them and fawns upon them and is skilful in anticipating and gratifying their humours is held to be a great and good statesman—do not these States resemble the persons whom I was describing?

Yes, he said; the States are as bad as the men; and I am very far from praising them.

But do you not admire, I said, the coolness and dexterity of these ready ministers of political corruption?

Yes, he said, I do; but not of all of them, for there are some whom the applause of the multitude has deluded into the belief that they are really statesmen, and these are not much to be admired.

What do you mean? I said; you should have more feeling for them. When a man cannot measure, and a great many others who cannot measure declare that he is four cubits high, can he help believing what they say?

Nay, he said, certainly not in that case.

Well, then, do not be angry with them; for are they not as good as a play, trying their hand at paltry reforms such as I was describing; they are always fancying that by legislation they will make an end of frauds in contracts, and the other rascalities which I was mentioning, not knowing that they are in reality cutting off the heads of a hydra?

Yes, he said; that is just what they are doing.

I conceive, I said, that the true legislator will not trouble himself with this class of enactments whether concerning laws or the constitution either in an ill-ordered or in a well-ordered State; for in the former they are quite useless, and in the latter there will be no difficulty in devising them; and many of them will naturally flow out of our previous regulations.

What, then, he said, is still remaining to us of the work of legislation?

Nothing to us, I replied; but to Apollo, the God of Delphi, there remains the ordering of the greatest and noblest and chiefest things of all.

Which are they? he said.

The institution of temples and sacrifices, and the entire service of gods, demigods, and heroes; also the ordering of the repositories of the dead, and the rites which have to be observed by him who would propitiate the inhabitants of the world below. These are matters of which we are ignorant ourselves, and as founders of a city we should be unwise in trusting them to any interpreter but our ancestral deity. He is the god who sits in the centre, on the navel of the earth, and he is the interpreter of religion to all mankind.

You are right, and we will do as you propose.

But where, amid all this, is justice? son of Ariston, tell me where. Now that our city has been made habitable, light a candle and search, and get your brother and Polemarchus and the rest of our friends to help, and let us see where in it we can discover justice and where injustice, and in what they differ from one another, and which of them the man who would be happy should have for his portion, whether seen or unseen by gods and men.

Nonsense, said Glaucon: did you not promise to search yourself, saying that for you not to help justice in her need would be an impiety?

I do not deny that I said so, and as you remind me, I will be as good as my word; but you must join.

We will, he replied.

Well, then, I hope to make the discovery in this way: I mean to begin with the assumption that our State, if rightly ordered, is perfect.

That is most certain.

And being perfect, is therefore wise and valiant and temperate and just.

That is likewise clear.

And whichever of these qualities we find in the State, the one which is not found will be the residue?

Very good.

If there were four things, and we were searching for one of them, wherever it might be, the one sought for might be known to us from the first, and there would be no further trouble; or we might know the other three first, and then the fourth would clearly be the one left.

Very true, he said.

And is not a similar method to be pursued about the virtues, which are also four in number?

Clearly.

First among the virtues found in the State, wisdom comes into view, and in this I detect a certain peculiarity.

What is that?

The State which we have been describing is said to be wise as being good in counsel?

Very true.

And good counsel is clearly a kind of knowledge, for not by ignorance, but by knowledge, do men counsel well?

Clearly.

And the kinds of knowledge in a State are many and diverse?

Of course.

There is the knowledge of the carpenter; but is that the sort of knowledge which gives a city the title of wise and good in counsel?

Certainly not; that would only give a city the reputation of skill in carpentering.

Then a city is not to be called wise because possessing a knowledge which counsels for the best about wooden implements?

Certainly not.

Nor by reason of a knowledge which advises about brazen pots, I said, nor as possessing any other similar knowledge?

Not by reason of any of them, he said.

Nor yet by reason of a knowledge which cultivates the earth; that would give the city the name of agricultural?

Yes.

Well, I said, and is there any knowledge in our recently-founded State among any of the citizens which advises, not about any particular thing in the State, but about the whole, and considers how a State can best deal with itself and with other States?

There certainly is.

And what is this knowledge, and among whom is it found? I asked.

It is the knowledge of the guardians, he replied, and is found among those whom we were just now describing as perfect guardians.

And what is the name which the city derives from the possession of this sort of knowledge?

The name of good in counsel and truly wise.

And will there be in our city more of these true guardians or more smiths?

The smiths, he replied, will be far more numerous.

Will not the guardians be the smallest of all the classes who receive a name from the profession of some kind of knowledge?

Much the smallest.

And so by reason of the smallest part or class, and of the knowledge which resides in this presiding and ruling part of itself, the whole State, being thus constituted according to nature, will be wise; and this, which has the only knowledge worthy to be called wisdom, has been ordained by nature to be of all classes the least.

Most true.

Thus, then, I said, the nature and place in the State of one of the four virtues has somehow or other been discovered.

And, in my humble opinion, very satisfactorily discovered, he replied.

Again, I said, there is no difficulty in seeing the nature of courage, and in what part that quality resides which gives the name of courageous to the State.

How do you mean?

Why, I said, every one who calls any State courageous or cowardly, will be thinking of the part which fights and goes out to war on the State's behalf.

No one, he replied, would ever think of any other.

The rest of the citizens may be courageous or may be cowardly, but their courage or cowardice will not, as I conceive, have the effect of making the city either the one or the other.

Certainly not.

The city will be courageous in virtue of a portion of herself which preserves under all circumstances that opinion about the nature of things to be feared and not to be feared in which our legislator educated them; and this is what you term courage.

I should like to hear what you are saying once more, for I do not think that I perfectly understand you.

I mean that courage is a kind of salvation.

Salvation of what?

Of the opinion respecting things to be feared, what they are and of what nature, which the law implants through education; and I mean by the words 'under all circumstances' to intimate that in pleasure or in pain, or under the influence of desire or fear, a man preserves, and does not lose this opinion. Shall I give you an illustration?

If you please.

You know, I said, that dyers, when they want to dye wool for making the true sea-purple, begin by selecting their white colour first; this they prepare and dress with much care and pains, in order that the white ground may take the purple hue in full perfection. The dyeing then proceeds; and whatever is dyed in this manner becomes a fast colour, and no washing either with lyes or without them can take away the bloom. But, when the ground has not been duly prepared, you will have noticed how poor is the look either of purple or of any other colour.

Yes, he said; I know that they have a washed-out and ridiculous appearance.

Then now, I said, you will understand what our object was in selecting our soldiers, and educating them in music and gymnastic; we were contriving influences which would prepare them to take the dye of the laws in perfection, and the colour of their opinion about dangers and of every other opinion was to be indelibly fixed by their nurture and training, not to be washed away by such potent lyes as pleasure—mightier agent far in washing the soul than any soda or lye; or by sorrow, fear, and desire, the mightiest of all other solvents. And this sort of universal saving power of true opinion in conformity with law about real and false dangers I call and maintain to be courage, unless you disagree.

But I agree, he replied; for I suppose that you mean to exclude mere uninstructed courage, such as that of a wild beast or of a slave—this, in your opinion, is not the courage which the law ordains, and ought to have another name.

Most certainly.

Then I may infer courage to be such as you describe?

Why, yes, said I, you may, and if you add the words 'of a citizen,' you will not be far wrong;—hereafter, if you like, we will carry the examination further, but at present we are seeking not for courage but justice; and for the purpose of our enquiry we have said enough.

You are right, he replied.

Two virtues remain to be discovered in the State—first, temperance, and then justice which is the end of our search.

Very true.

Now, can we find justice without troubling ourselves about temperance?

I do not know how that can be accomplished, he said, nor do I desire that justice should be brought to light and temperance lost sight of; and therefore I wish that you would do me the favour of considering temperance first.

Certainly, I replied, I should not be justified in refusing your request.

Then consider, he said.

Yes, I replied; I will; and as far as I can at present see, the virtue of temperance has more of the nature of harmony and symphony than the preceding.

How so? he asked.

Temperance, I replied, is the ordering or controlling of certain pleasures and desires; this is curiously enough implied in the saying of 'a man being his own master;' and other traces of the same notion may be found in language.

No doubt, he said.

There is something ridiculous in the expression 'master of himself;' for the master is also the servant and the servant the master; and in all these modes of speaking the same person is denoted.

Certainly.

The meaning is, I believe, that in the human soul there is a better and also a worse principle; and when the better has the worse under control, then a man is said to be master of himself; and this is a term of praise: but when, owing to evil education or association, the better principle, which is also the smaller, is overwhelmed by the greater mass of the worse—in this case he is blamed and is called the slave of self and unprincipled.

Yes, there is reason in that.

And now, I said, look at our newly-created State, and there you will find one of these two conditions realized; for the State, as you will acknowledge, may be justly called master of itself, if the words 'temperance' and 'self-mastery' truly express the rule of the better part over the worse.

Yes, he said, I see that what you say is true.

Let me further note that the manifold and complex pleasures and desires and pains are generally found in children and women and servants, and in the freemen so called who are of the lowest and more numerous class.

Certainly, he said.

Whereas the simple and moderate desires which follow reason, and are under the guidance of mind and true opinion, are to be found only in a few, and those the best born and best educated.

Very true.

These two, as you may perceive, have a place in our State; and the meaner desires of the many are held down by the virtuous desires and wisdom of the few.

That I perceive, he said.

Then if there be any city which may be described as master of its own pleasures and desires, and master of itself, ours may claim such a designation?

Certainly, he replied.

It may also be called temperate, and for the same reasons?

Yes.

And if there be any State in which rulers and subjects will be agreed as to the question who are to rule, that again will be our State?

Undoubtedly.

And the citizens being thus agreed among themselves, in which class will temperance be found—in the rulers or in the subjects?

In both, as I should imagine, he replied.

Do you observe that we were not far wrong in our guess that temperance was a sort of harmony?

Why so?

Why, because temperance is unlike courage and wisdom, each of which resides in a part only, the one making the State wise and the other valiant; not so temperance, which extends to the whole, and runs through all the notes of the scale, and produces a harmony of the weaker and the stronger and the middle class, whether you suppose them to be stronger or weaker in wisdom or power or numbers or wealth, or anything else. Most truly then may we deem temperance to be the agreement of the naturally superior and inferior, as to the right to rule of either, both in states and individuals.

I entirely agree with you.

And so, I said, we may consider three out of the four virtues to have been discovered in our State. The last of those qualities which make a state virtuous must be justice, if we only knew what that was.

The inference is obvious.

The time then has arrived, Glaucon, when, like huntsmen, we should surround the cover, and look sharp that justice does not steal away, and pass out of sight and escape us; for beyond a doubt she is somewhere in this country: watch therefore and strive to catch a sight of her, and if you see her first, let me know.

Would that I could! but you should regard me rather as a follower who has just eyes enough to see what you show him—that is about as much as I am good for.

Offer up a prayer with me and follow.

I will, but you must show me the way.

Here is no path, I said, and the wood is dark and perplexing; still we must push on.

Let us push on.

Here I saw something: Halloo! I said, I begin to perceive a track, and I believe that the quarry will not escape.

Good news, he said.

Truly, I said, we are stupid fellows.

Why so?

Why, my good sir, at the beginning of our enquiry, ages ago, there was justice tumbling out at our feet, and we never saw her; nothing could be more ridiculous. Like people who go about looking for what they have in their hands—that was the way with us—we looked not at what we were seeking, but at what was far off in the distance; and therefore, I suppose, we missed her.

What do you mean?

I mean to say that in reality for a long time past we have been talking of justice, and have failed to recognise her.

I grow impatient at the length of your exordium.

Well then, tell me, I said, whether I am right or not: You remember the original principle which we were always laying down at the foundation of the State, that one man should practise one thing only, the thing to which his nature was best adapted;—now justice is this principle or a part of it.

Yes, we often said that one man should do one thing only.

Further, we affirmed that justice was doing one's own business, and not being a busybody; we said so again and again, and many others have said the same to us.

Yes, we said so.

Then to do one's own business in a certain way may be assumed to be justice. Can you tell me whence I derive this inference?

I cannot, but I should like to be told.

Because I think that this is the only virtue which remains in the State when the other virtues of temperance and courage and wisdom are abstracted; and, that this is the ultimate cause and condition of the existence of all of them, and while remaining in them is also their preservative; and we were saying that if the three were discovered by us, justice would be the fourth or remaining one.

That follows of necessity.

If we are asked to determine which of these four qualities by its presence contributes most to the excellence of the State, whether the agreement of rulers and subjects, or the preservation in the soldiers of the opinion which the law ordains about the true nature of dangers, or wisdom and watchfulness in the rulers, or whether this other which I am mentioning, and which is found in children and women, slave and freeman, artisan, ruler, subject,—the quality, I mean, of every one doing his own work, and not being a busybody, would claim the palm—the question is not so easily answered.

Certainly, he replied, there would be a difficulty in saying which.

Then the power of each individual in the State to do his own work appears to compete with the other political virtues, wisdom, temperance, courage.

Yes, he said.

And the virtue which enters into this competition is justice?

Exactly.

Let us look at the question from another point of view: Are not the rulers in a State those to whom you would entrust the office of determining suits at law?

Certainly.

And are suits decided on any other ground but that a man may neither take what is another's, nor be deprived of what is his own?

Yes; that is their principle.

Which is a just principle?

Yes.

Then on this view also justice will be admitted to be the having and doing what is a man's own, and belongs to him?

Very true.

Think, now, and say whether you agree with me or not. Suppose a carpenter to be doing the business of a cobbler, or a cobbler of a carpenter; and suppose them to exchange their implements or their duties, or the same person to be doing the work of both, or whatever be the change; do you think that any great harm would result to the State?

Not much.

But when the cobbler or any other man whom nature designed to be a trader, having his heart lifted up by wealth or strength or the number of his followers, or any like advantage, attempts to force his way into the class of warriors, or a warrior into that of legislators and guardians, for which he is unfitted, and either to take the implements or the duties of the other; or when one man is trader, legislator, and warrior all in one, then I think you will agree with me in saying that this interchange and this meddling of one with another is the ruin of the State.

Most true.

Seeing then, I said, that there are three distinct classes, any meddling of one with another, or the change of one into another, is the greatest harm to the State, and may be most justly termed evil-doing?

Precisely.

And the greatest degree of evil-doing to one's own city would be termed by you injustice?

Certainly.

This then is injustice; and on the other hand when the trader, the auxiliary, and the guardian each do their own business, that is justice, and will make the city just.

I agree with you.

We will not, I said, be over-positive as yet; but if, on trial, this conception of justice be verified in the individual as well as in the State, there will be no longer any room for doubt; if it be not verified, we must have a fresh enquiry. First let us complete the old investigation, which we began, as you remember, under the impression that, if we could previously examine justice on the larger scale, there would be less difficulty in discerning her in the individual. That larger example appeared to be the State, and accordingly we constructed as good a one as we could, knowing well that in the good State justice would be found. Let the discovery which we made be now applied to the individual—if they agree, we shall be satisfied; or, if there be a difference in the individual, we will come back to the State and have another trial of the theory. The friction of the two when rubbed together may possibly strike a light in which justice will shine forth, and the vision which is then revealed we will fix in our souls.

That will be in regular course; let us do as you say.

I proceeded to ask: When two things, a greater and less, are called by the same name, are they like or unlike in so far as they are called the same?

Like, he replied.

The just man then, if we regard the idea of justice only, will be like the just State?

He will.

And a State was thought by us to be just when the three classes in the State severally did their own business; and also thought to be temperate and valiant and wise by reason of certain other affections and qualities of these same classes?

True, he said.

And so of the individual; we may assume that he has the same three principles in his own soul which are found in the State; and he may be rightly described in the same terms, because he is affected in the same manner?

Certainly, he said.

Once more then, O my friend, we have alighted upon an easy question—whether the soul has these three principles or not?

An easy question! Nay, rather, Socrates, the proverb holds that hard is the good.

Very true, I said; and I do not think that the method which we are employing is at all adequate to the accurate solution of this question; the true method is another and a longer one. Still we may arrive at a solution not below the level of the previous enquiry.

May we not be satisfied with that? he said;—under the circumstances, I am quite content.

I too, I replied, shall be extremely well satisfied.

Then faint not in pursuing the speculation, he said.

Must we not acknowledge, I said, that in each of us there are the same principles and habits which there are in the State; and that from the individual they pass into the State?—how else can they come there? Take the quality of passion or spirit;—it would be ridiculous to imagine that this quality, when found in States, is not derived from the individuals who are supposed to possess it, e.g. the Thracians, Scythians, and in general the northern nations; and the same may be said of the love of knowledge, which is the special characteristic of our part of the world, or of the love of money, which may, with equal truth, be attributed to the Phoenicians and Egyptians.

Exactly so, he said.

There is no difficulty in understanding this.

None whatever.

But the question is not quite so easy when we proceed to ask whether these principles are three or one; whether, that is to say, we learn with one part of our nature, are angry with another, and with a third part desire the satisfaction of our natural appetites; or whether the whole soul comes into play in each sort of action—to determine that is the difficulty.

Yes, he said; there lies the difficulty.

Then let us now try and determine whether they are the same or different.

How can we? he asked.

I replied as follows: The same thing clearly cannot act or be acted upon in the same part or in relation to the same thing at the same time, in contrary ways; and therefore whenever this contradiction occurs in things apparently the same, we know that they are really not the same, but different.

Good.

For example, I said, can the same thing be at rest and in motion at the same time in the same part?

Impossible.

Still, I said, let us have a more precise statement of terms, lest we should hereafter fall out by the way. Imagine the case of a man who is standing and also moving his hands and his head, and suppose a person to say that one and the same person is in motion and at rest at the same moment—to such a mode of speech we should object, and should rather say that one part of him is in motion while another is at rest.

Very true.

And suppose the objector to refine still further, and to draw the nice distinction that not only parts of tops, but whole tops, when they spin round with their pegs fixed on the spot, are at rest and in motion at the same time (and he may say the same of anything which revolves in the same spot), his objection would not be admitted by us, because in such cases things are not at rest and in motion in the same parts of themselves; we should rather say that they have both an axis and a circumference, and that the axis stands still, for there is no deviation from the perpendicular; and that the circumference goes round. But if, while revolving, the axis inclines either to the right or left, forwards or backwards, then in no point of view can they be at rest.

That is the correct mode of describing them, he replied.

Then none of these objections will confuse us, or incline us to believe that the same thing at the same time, in the same part or in relation to the same thing, can act or be acted upon in contrary ways.

Certainly not, according to my way of thinking.

Yet, I said, that we may not be compelled to examine all such objections, and prove at length that they are untrue, let us assume their absurdity, and go forward on the understanding that hereafter, if this assumption turn out to be untrue, all the consequences which follow shall be withdrawn.

Yes, he said, that will be the best way.

Well, I said, would you not allow that assent and dissent, desire and aversion, attraction and repulsion, are all of them opposites, whether they are regarded as active or passive (for that makes no difference in the fact of their opposition)?

Yes, he said, they are opposites.

Well, I said, and hunger and thirst, and the desires in general, and again willing and wishing,—all these you would refer to the classes already mentioned. You would say—would you not?—that the soul of him who desires is seeking after the object of his desire; or that he is drawing to himself the thing which he wishes to possess: or again, when a person wants anything to be given him, his mind, longing for the realization of his desire, intimates his wish to have it by a nod of assent, as if he had been asked a question?

Very true.

And what would you say of unwillingness and dislike and the absence of desire; should not these be referred to the opposite class of repulsion and rejection?

Certainly.

Admitting this to be true of desire generally, let us suppose a particular class of desires, and out of these we will select hunger and thirst, as they are termed, which are the most obvious of them?

Let us take that class, he said.

The object of one is food, and of the other drink?

Yes.

And here comes the point: is not thirst the desire which the soul has of drink, and of drink only; not of drink qualified by anything else; for example, warm or cold, or much or little, or, in a word, drink of any particular sort: but if the thirst be accompanied by heat, then the desire is of cold drink; or, if accompanied by cold, then of warm drink; or, if the thirst be excessive, then the drink which is desired will be excessive; or, if not great, the quantity of drink will also be small: but thirst pure and simple will desire drink pure and simple, which is the natural satisfaction of thirst, as food is of hunger?

Yes, he said; the simple desire is, as you say, in every case of the simple object, and the qualified desire of the qualified object.

But here a confusion may arise; and I should wish to guard against an opponent starting up and saying that no man desires drink only, but good drink, or food only, but good food; for good is the universal object of desire, and thirst being a desire, will necessarily be thirst after good drink; and the same is true of every other desire.

Yes, he replied, the opponent might have something to say.

Nevertheless I should still maintain, that of relatives some have a quality attached to either term of the relation; others are simple and have their correlatives simple.

I do not know what you mean.

Well, you know of course that the greater is relative to the less?

Certainly.

And the much greater to the much less?

Yes.

And the sometime greater to the sometime less, and the greater that is to be to the less that is to be?

Certainly, he said.

And so of more and less, and of other correlative terms, such as the double and the half, or again, the heavier and the lighter, the swifter and the slower; and of hot and cold, and of any other relatives;—is not this true of all of them?

Yes.

And does not the same principle hold in the sciences? The object of science is knowledge (assuming that to be the true definition), but the object of a particular science is a particular kind of knowledge; I mean, for example, that the science of house-building is a kind of knowledge which is defined and distinguished from other kinds and is therefore termed architecture.

Certainly.

Because it has a particular quality which no other has?

Yes.

And it has this particular quality because it has an object of a particular kind; and this is true of the other arts and sciences?

Yes.

Now, then, if I have made myself clear, you will understand my original meaning in what I said about relatives. My meaning was, that if one term of a relation is taken alone, the other is taken alone; if one term is qualified, the other is also qualified. I do not mean to say that relatives may not be disparate, or that the science of health is healthy, or of disease necessarily diseased, or that the sciences of good and evil are therefore good and evil; but only that, when the term science is no longer used absolutely, but has a qualified object which in this case is the nature of health and disease, it becomes defined, and is hence called not merely science, but the science of medicine.

I quite understand, and I think as you do.

Would you not say that thirst is one of these essentially relative terms, having clearly a relation—

Yes, thirst is relative to drink.

And a certain kind of thirst is relative to a certain kind of drink; but thirst taken alone is neither of much nor little, nor of good nor bad, nor of any particular kind of drink, but of drink only?

Certainly.

Then the soul of the thirsty one, in so far as he is thirsty, desires only drink; for this he yearns and tries to obtain it?

That is plain.

And if you suppose something which pulls a thirsty soul away from drink, that must be different from the thirsty principle which draws him like a beast to drink; for, as we were saying, the same thing cannot at the same time with the same part of itself act in contrary ways about the same.

Impossible.

No more than you can say that the hands of the archer push and pull the bow at the same time, but what you say is that one hand pushes and the other pulls.

Exactly so, he replied.

And might a man be thirsty, and yet unwilling to drink?

Yes, he said, it constantly happens.

And in such a case what is one to say? Would you not say that there was something in the soul bidding a man to drink, and something else forbidding him, which is other and stronger than the principle which bids him?

I should say so.

And the forbidding principle is derived from reason, and that which bids and attracts proceeds from passion and disease?

Clearly.

Then we may fairly assume that they are two, and that they differ from one another; the one with which a man reasons, we may call the rational principle of the soul, the other, with which he loves and hungers and thirsts and feels the flutterings of any other desire, may be termed the irrational or appetitive, the ally of sundry pleasures and satisfactions?

Yes, he said, we may fairly assume them to be different.

Then let us finally determine that there are two principles existing in the soul. And what of passion, or spirit? Is it a third, or akin to one of the preceding?

I should be inclined to say—akin to desire.

Well, I said, there is a story which I remember to have heard, and in which I put faith. The story is, that Leontius, the son of Aglaion, coming up one day from the Piraeus, under the north wall on the outside, observed some dead bodies lying on the ground at the place of execution. He felt a desire to see them, and also a dread and abhorrence of them; for a time he struggled and covered his eyes, but at length the desire got the better of him; and forcing them open, he ran up to the dead bodies, saying, Look, ye wretches, take your fill of the fair sight.

I have heard the story myself, he said.

The moral of the tale is, that anger at times goes to war with desire, as though they were two distinct things.

Yes; that is the meaning, he said.

And are there not many other cases in which we observe that when a man's desires violently prevail over his reason, he reviles himself, and is angry at the violence within him, and that in this struggle, which is like the struggle of factions in a State, his spirit is on the side of his reason;—but for the passionate or spirited element to take part with the desires when reason decides that she should not be opposed, is a sort of thing which I believe that you never observed occurring in yourself, nor, as I should imagine, in any one else?

Certainly not.

Suppose that a man thinks he has done a wrong to another, the nobler he is the less able is he to feel indignant at any suffering, such as hunger, or cold, or any other pain which the injured person may inflict upon him—these he deems to be just, and, as I say, his anger refuses to be excited by them.

True, he said.

But when he thinks that he is the sufferer of the wrong, then he boils and chafes, and is on the side of what he believes to be justice; and because he suffers hunger or cold or other pain he is only the more determined to persevere and conquer. His noble spirit will not be quelled until he either slays or is slain; or until he hears the voice of the shepherd, that is, reason, bidding his dog bark no more.

The illustration is perfect, he replied; and in our State, as we were saying, the auxiliaries were to be dogs, and to hear the voice of the rulers, who are their shepherds.

I perceive, I said, that you quite understand me; there is, however, a further point which I wish you to consider.

What point?

You remember that passion or spirit appeared at first sight to be a kind of desire, but now we should say quite the contrary; for in the conflict of the soul spirit is arrayed on the side of the rational principle.

Most assuredly.

But a further question arises: Is passion different from reason also, or only a kind of reason; in which latter case, instead of three principles in the soul, there will only be two, the rational and the concupiscent; or rather, as the State was composed of three classes, traders, auxiliaries, counsellors, so may there not be in the individual soul a third element which is passion or spirit, and when not corrupted by bad education is the natural auxiliary of reason?

Yes, he said, there must be a third.

Yes, I replied, if passion, which has already been shown to be different from desire, turn out also to be different from reason.

But that is easily proved:—We may observe even in young children that they are full of spirit almost as soon as they are born, whereas some of them never seem to attain to the use of reason, and most of them late enough.

Excellent, I said, and you may see passion equally in brute animals, which is a further proof of the truth of what you are saying. And we may once more appeal to the words of Homer, which have been already quoted by us,

'He smote his breast, and thus rebuked his soul,'

for in this verse Homer has clearly supposed the power which reasons about the better and worse to be different from the unreasoning anger which is rebuked by it.

Very true, he said.

And so, after much tossing, we have reached land, and are fairly agreed that the same principles which exist in the State exist also in the individual, and that they are three in number.

Exactly.

Must we not then infer that the individual is wise in the same way, and in virtue of the same quality which makes the State wise?

Certainly.

Also that the same quality which constitutes courage in the State constitutes courage in the individual, and that both the State and the individual bear the same relation to all the other virtues?

Assuredly.

And the individual will be acknowledged by us to be just in the same way in which the State is just?

That follows, of course.

We cannot but remember that the justice of the State consisted in each of the three classes doing the work of its own class?

We are not very likely to have forgotten, he said.

We must recollect that the individual in whom the several qualities of his nature do their own work will be just, and will do his own work?

Yes, he said, we must remember that too.

And ought not the rational principle, which is wise, and has the care of the whole soul, to rule, and the passionate or spirited principle to be the subject and ally?

Certainly.

And, as we were saying, the united influence of music and gymnastic will bring them into accord, nerving and sustaining the reason with noble words and lessons, and moderating and soothing and civilizing the wildness of passion by harmony and rhythm?

Quite true, he said.

And these two, thus nurtured and educated, and having learned truly to know their own functions, will rule over the concupiscent, which in each of us is the largest part of the soul and by nature most insatiable of gain; over this they will keep guard, lest, waxing great and strong with the fulness of bodily pleasures, as they are termed, the concupiscent soul, no longer confined to her own sphere, should attempt to enslave and rule those who are not her natural-born subjects, and overturn the whole life of man?

Very true, he said.

Both together will they not be the best defenders of the whole soul and the whole body against attacks from without; the one counselling, and the other fighting under his leader, and courageously executing his commands and counsels?

True.

And he is to be deemed courageous whose spirit retains in pleasure and in pain the commands of reason about what he ought or ought not to fear?

Right, he replied.

And him we call wise who has in him that little part which rules, and which proclaims these commands; that part too being supposed to have a knowledge of what is for the interest of each of the three parts and of the whole?

Assuredly.

And would you not say that he is temperate who has these same elements in friendly harmony, in whom the one ruling principle of reason, and the two subject ones of spirit and desire are equally agreed that reason ought to rule, and do not rebel?

Certainly, he said, that is the true account of temperance whether in the State or individual.

And surely, I said, we have explained again and again how and by virtue of what quality a man will be just.

That is very certain.

And is justice dimmer in the individual, and is her form different, or is she the same which we found her to be in the State?

There is no difference in my opinion, he said.

Because, if any doubt is still lingering in our minds, a few commonplace instances will satisfy us of the truth of what I am saying.

What sort of instances do you mean?

If the case is put to us, must we not admit that the just State, or the man who is trained in the principles of such a State, will be less likely than the unjust to make away with a deposit of gold or silver? Would any one deny this?

No one, he replied.

Will the just man or citizen ever be guilty of sacrilege or theft, or treachery either to his friends or to his country?

Never.

Neither will he ever break faith where there have been oaths or agreements?

Impossible.

No one will be less likely to commit adultery, or to dishonour his father and mother, or to fail in his religious duties?

No one.

And the reason is that each part of him is doing its own business, whether in ruling or being ruled?

Exactly so.

Are you satisfied then that the quality which makes such men and such states is justice, or do you hope to discover some other?

Not I, indeed.

Then our dream has been realized; and the suspicion which we entertained at the beginning of our work of construction, that some divine power must have conducted us to a primary form of justice, has now been verified?

Yes, certainly.

And the division of labour which required the carpenter and the shoemaker and the rest of the citizens to be doing each his own business, and not another's, was a shadow of justice, and for that reason it was of use?

Clearly.

But in reality justice was such as we were describing, being concerned however, not with the outward man, but with the inward, which is the true self and concernment of man: for the just man does not permit the several elements within him to interfere with one another, or any of them to do the work of others,—he sets in order his own inner life, and is his own master and his own law, and at peace with himself; and when he has bound together the three principles within him, which may be compared to the higher, lower, and middle notes of the scale, and the intermediate intervals—when he has bound all these together, and is no longer many, but has become one entirely temperate and perfectly adjusted nature, then he proceeds to act, if he has to act, whether in a matter of property, or in the treatment of the body, or in some affair of politics or private business; always thinking and calling that which preserves and co-operates with this harmonious condition, just and good action, and the knowledge which presides over it, wisdom, and that which at any time impairs this condition, he will call unjust action, and the opinion which presides over it ignorance.

You have said the exact truth, Socrates.

Very good; and if we were to affirm that we had discovered the just man and the just State, and the nature of justice in each of them, we should not be telling a falsehood?

Most certainly not.

May we say so, then?

Let us say so.

And now, I said, injustice has to be considered.

Clearly.

Must not injustice be a strife which arises among the three principles—a meddlesomeness, and interference, and rising up of a part of the soul against the whole, an assertion of unlawful authority, which is made by a rebellious subject against a true prince, of whom he is the natural vassal,—what is all this confusion and delusion but injustice, and intemperance and cowardice and ignorance, and every form of vice?

Exactly so.

And if the nature of justice and injustice be known, then the meaning of acting unjustly and being unjust, or, again, of acting justly, will also be perfectly clear?

What do you mean? he said.

Why, I said, they are like disease and health; being in the soul just what disease and health are in the body.

How so? he said.

Why, I said, that which is healthy causes health, and that which is unhealthy causes disease.

Yes.

And just actions cause justice, and unjust actions cause injustice?

That is certain.

And the creation of health is the institution of a natural order and government of one by another in the parts of the body; and the creation of disease is the production of a state of things at variance with this natural order?

True.

And is not the creation of justice the institution of a natural order and government of one by another in the parts of the soul, and the creation of injustice the production of a state of things at variance with the natural order?

Exactly so, he said.

Then virtue is the health and beauty and well-being of the soul, and vice the disease and weakness and deformity of the same?

True.

And do not good practices lead to virtue, and evil practices to vice?

Assuredly.

Still our old question of the comparative advantage of justice and injustice has not been answered: Which is the more profitable, to be just and act justly and practise virtue, whether seen or unseen of gods and men, or to be unjust and act unjustly, if only unpunished and unreformed?

In my judgment, Socrates, the question has now become ridiculous. We know that, when the bodily constitution is gone, life is no longer endurable, though pampered with all kinds of meats and drinks, and having all wealth and all power; and shall we be told that when the very essence of the vital principle is undermined and corrupted, life is still worth having to a man, if only he be allowed to do whatever he likes with the single exception that he is not to acquire justice and virtue, or to escape from injustice and vice; assuming them both to be such as we have described?

Yes, I said, the question is, as you say, ridiculous. Still, as we are near the spot at which we may see the truth in the clearest manner with our own eyes, let us not faint by the way.

Certainly not, he replied.

Come up hither, I said, and behold the various forms of vice, those of them, I mean, which are worth looking at.

I am following you, he replied: proceed.

I said, The argument seems to have reached a height from which, as from some tower of speculation, a man may look down and see that virtue is one, but that the forms of vice are innumerable; there being four special ones which are deserving of note.

What do you mean? he said.

I mean, I replied, that there appear to be as many forms of the soul as there are distinct forms of the State.

How many?

There are five of the State, and five of the soul, I said.

What are they?

The first, I said, is that which we have been describing, and which may be said to have two names, monarchy and aristocracy, accordingly as rule is exercised by one distinguished man or by many.

True, he replied.

But I regard the two names as describing one form only; for whether the government is in the hands of one or many, if the governors have been trained in the manner which we have supposed, the fundamental laws of the State will be maintained.

That is true, he replied.</pre>
</div>
<div created="20150302204805306" modified="20150302213019257" tags="" title="Book IX (Jowett translation)">
<pre>Last of all comes the tyrannical man; about whom we have once more to ask, how is he formed out of the democratical? and how does he live, in happiness or in misery?

Yes, he said, he is the only one remaining.

There is, however, I said, a previous question which remains unanswered.

What question?

I do not think that we have adequately determined the nature and number of the appetites, and until this is accomplished the enquiry will always be confused.

Well, he said, it is not too late to supply the omission.

Very true, I said; and observe the point which I want to understand: Certain of the unnecessary pleasures and appetites I conceive to be unlawful; every one appears to have them, but in some persons they are controlled by the laws and by reason, and the better desires prevail over them—either they are wholly banished or they become few and weak; while in the case of others they are stronger, and there are more of them.

Which appetites do you mean?

I mean those which are awake when the reasoning and human and ruling power is asleep; then the wild beast within us, gorged with meat or drink, starts up and having shaken off sleep, goes forth to satisfy his desires; and there is no conceivable folly or crime—not excepting incest or any other unnatural union, or parricide, or the eating of forbidden food—which at such a time, when he has parted company with all shame and sense, a man may not be ready to commit.

Most true, he said.

But when a man's pulse is healthy and temperate, and when before going to sleep he has awakened his rational powers, and fed them on noble thoughts and enquiries, collecting himself in meditation; after having first indulged his appetites neither too much nor too little, but just enough to lay them to sleep, and prevent them and their enjoyments and pains from interfering with the higher principle—which he leaves in the solitude of pure abstraction, free to contemplate and aspire to the knowledge of the unknown, whether in past, present, or future: when again he has allayed the passionate element, if he has a quarrel against any one—I say, when, after pacifying the two irrational principles, he rouses up the third, which is reason, before he takes his rest, then, as you know, he attains truth most nearly, and is least likely to be the sport of fantastic and lawless visions.

I quite agree.

In saying this I have been running into a digression; but the point which I desire to note is that in all of us, even in good men, there is a lawless wild-beast nature, which peers out in sleep. Pray, consider whether I am right, and you agree with me.

Yes, I agree.

And now remember the character which we attributed to the democratic man. He was supposed from his youth upwards to have been trained under a miserly parent, who encouraged the saving appetites in him, but discountenanced the unnecessary, which aim only at amusement and ornament?

True.

And then he got into the company of a more refined, licentious sort of people, and taking to all their wanton ways rushed into the opposite extreme from an abhorrence of his father's meanness. At last, being a better man than his corruptors, he was drawn in both directions until he halted midway and led a life, not of vulgar and slavish passion, but of what he deemed moderate indulgence in various pleasures. After this manner the democrat was generated out of the oligarch?

Yes, he said; that was our view of him, and is so still.

And now, I said, years will have passed away, and you must conceive this man, such as he is, to have a son, who is brought up in his father's principles.

I can imagine him.

Then you must further imagine the same thing to happen to the son which has already happened to the father:—he is drawn into a perfectly lawless life, which by his seducers is termed perfect liberty; and his father and friends take part with his moderate desires, and the opposite party assist the opposite ones. As soon as these dire magicians and tyrant-makers find that they are losing their hold on him, they contrive to implant in him a master passion, to be lord over his idle and spendthrift lusts—a sort of monstrous winged drone—that is the only image which will adequately describe him.

Yes, he said, that is the only adequate image of him.

And when his other lusts, amid clouds of incense and perfumes and garlands and wines, and all the pleasures of a dissolute life, now let loose, come buzzing around him, nourishing to the utmost the sting of desire which they implant in his drone-like nature, then at last this lord of the soul, having Madness for the captain of his guard, breaks out into a frenzy: and if he finds in himself any good opinions or appetites in process of formation, and there is in him any sense of shame remaining, to these better principles he puts an end, and casts them forth until he has purged away temperance and brought in madness to the full.

Yes, he said, that is the way in which the tyrannical man is generated.

And is not this the reason why of old love has been called a tyrant?

I should not wonder.

Further, I said, has not a drunken man also the spirit of a tyrant?

He has.

And you know that a man who is deranged and not right in his mind, will fancy that he is able to rule, not only over men, but also over the gods?

That he will.

And the tyrannical man in the true sense of the word comes into being when, either under the influence of nature, or habit, or both, he becomes drunken, lustful, passionate? O my friend, is not that so?

Assuredly.

Such is the man and such is his origin. And next, how does he live?

Suppose, as people facetiously say, you were to tell me.

I imagine, I said, at the next step in his progress, that there will be feasts and carousals and revellings and courtezans, and all that sort of thing; Love is the lord of the house within him, and orders all the concerns of his soul.

That is certain.

Yes; and every day and every night desires grow up many and formidable, and their demands are many.

They are indeed, he said.

His revenues, if he has any, are soon spent.

True.

Then comes debt and the cutting down of his property.

Of course.

When he has nothing left, must not his desires, crowding in the nest like young ravens, be crying aloud for food; and he, goaded on by them, and especially by love himself, who is in a manner the captain of them, is in a frenzy, and would fain discover whom he can defraud or despoil of his property, in order that he may gratify them?

Yes, that is sure to be the case.

He must have money, no matter how, if he is to escape horrid pains and pangs.

He must.

And as in himself there was a succession of pleasures, and the new got the better of the old and took away their rights, so he being younger will claim to have more than his father and his mother, and if he has spent his own share of the property, he will take a slice of theirs.

No doubt he will.

And if his parents will not give way, then he will try first of all to cheat and deceive them.

Very true.

And if he fails, then he will use force and plunder them.

Yes, probably.

And if the old man and woman fight for their own, what then, my friend? Will the creature feel any compunction at tyrannizing over them?

Nay, he said, I should not feel at all comfortable about his parents.

But, O heavens! Adeimantus, on account of some new-fangled love of a harlot, who is anything but a necessary connection, can you believe that he would strike the mother who is his ancient friend and necessary to his very existence, and would place her under the authority of the other, when she is brought under the same roof with her; or that, under like circumstances, he would do the same to his withered old father, first and most indispensable of friends, for the sake of some newly-found blooming youth who is the reverse of indispensable?

Yes, indeed, he said; I believe that he would.

Truly, then, I said, a tyrannical son is a blessing to his father and mother.

He is indeed, he replied.

He first takes their property, and when that fails, and pleasures are beginning to swarm in the hive of his soul, then he breaks into a house, or steals the garments of some nightly wayfarer; next he proceeds to clear a temple. Meanwhile the old opinions which he had when a child, and which gave judgment about good and evil, are overthrown by those others which have just been emancipated, and are now the body-guard of love and share his empire. These in his democratic days, when he was still subject to the laws and to his father, were only let loose in the dreams of sleep. But now that he is under the dominion of love, he becomes always and in waking reality what he was then very rarely and in a dream only; he will commit the foulest murder, or eat forbidden food, or be guilty of any other horrid act. Love is his tyrant, and lives lordly in him and lawlessly, and being himself a king, leads him on, as a tyrant leads a State, to the performance of any reckless deed by which he can maintain himself and the rabble of his associates, whether those whom evil communications have brought in from without, or those whom he himself has allowed to break loose within him by reason of a similar evil nature in himself. Have we not here a picture of his way of life?

Yes, indeed, he said.

And if there are only a few of them in the State, and the rest of the people are well disposed, they go away and become the body-guard or mercenary soldiers of some other tyrant who may probably want them for a war; and if there is no war, they stay at home and do many little pieces of mischief in the city.

What sort of mischief?

For example, they are the thieves, burglars, cut-purses, foot-pads, robbers of temples, man-stealers of the community; or if they are able to speak they turn informers, and bear false witness, and take bribes.

A small catalogue of evils, even if the perpetrators of them are few in number.

Yes, I said; but small and great are comparative terms, and all these things, in the misery and evil which they inflict upon a State, do not come within a thousand miles of the tyrant; when this noxious class and their followers grow numerous and become conscious of their strength, assisted by the infatuation of the people, they choose from among themselves the one who has most of the tyrant in his own soul, and him they create their tyrant.

Yes, he said, and he will be the most fit to be a tyrant.

If the people yield, well and good; but if they resist him, as he began by beating his own father and mother, so now, if he has the power, he beats them, and will keep his dear old fatherland or motherland, as the Cretans say, in subjection to his young retainers whom he has introduced to be their rulers and masters. This is the end of his passions and desires.

Exactly.

When such men are only private individuals and before they get power, this is their character; they associate entirely with their own flatterers or ready tools; or if they want anything from anybody, they in their turn are equally ready to bow down before them: they profess every sort of affection for them; but when they have gained their point they know them no more.

Yes, truly.

They are always either the masters or servants and never the friends of anybody; the tyrant never tastes of true freedom or friendship.

Certainly not.

And may we not rightly call such men treacherous?

No question.

Also they are utterly unjust, if we were right in our notion of justice?

Yes, he said, and we were perfectly right.

Let us then sum up in a word, I said, the character of the worst man: he is the waking reality of what we dreamed.

Most true.

And this is he who being by nature most of a tyrant bears rule, and the longer he lives the more of a tyrant he becomes.

That is certain, said Glaucon, taking his turn to answer.

And will not he who has been shown to be the wickedest, be also the most miserable? and he who has tyrannized longest and most, most continually and truly miserable; although this may not be the opinion of men in general?

Yes, he said, inevitably.

And must not the tyrannical man be like the tyrannical State, and the democratical man like the democratical State; and the same of the others?

Certainly.

And as State is to State in virtue and happiness, so is man in relation to man?

To be sure.

Then comparing our original city, which was under a king, and the city which is under a tyrant, how do they stand as to virtue?

They are the opposite extremes, he said, for one is the very best and the other is the very worst.

There can be no mistake, I said, as to which is which, and therefore I will at once enquire whether you would arrive at a similar decision about their relative happiness and misery. And here we must not allow ourselves to be panic-stricken at the apparition of the tyrant, who is only a unit and may perhaps have a few retainers about him; but let us go as we ought into every corner of the city and look all about, and then we will give our opinion.

A fair invitation, he replied; and I see, as every one must, that a tyranny is the wretchedest form of government, and the rule of a king the happiest.

And in estimating the men too, may I not fairly make a like request, that I should have a judge whose mind can enter into and see through human nature? he must not be like a child who looks at the outside and is dazzled at the pompous aspect which the tyrannical nature assumes to the beholder, but let him be one who has a clear insight. May I suppose that the judgment is given in the hearing of us all by one who is able to judge, and has dwelt in the same place with him, and been present at his dally life and known him in his family relations, where he may be seen stripped of his tragedy attire, and again in the hour of public danger—he shall tell us about the happiness and misery of the tyrant when compared with other men?

That again, he said, is a very fair proposal.

Shall I assume that we ourselves are able and experienced judges and have before now met with such a person? We shall then have some one who will answer our enquiries.

By all means.

Let me ask you not to forget the parallel of the individual and the State; bearing this in mind, and glancing in turn from one to the other of them, will you tell me their respective conditions?

What do you mean? he asked.

Beginning with the State, I replied, would you say that a city which is governed by a tyrant is free or enslaved?

No city, he said, can be more completely enslaved.

And yet, as you see, there are freemen as well as masters in such a State?

Yes, he said, I see that there are—a few; but the people, speaking generally, and the best of them are miserably degraded and enslaved.

Then if the man is like the State, I said, must not the same rule prevail? his soul is full of meanness and vulgarity—the best elements in him are enslaved; and there is a small ruling part, which is also the worst and maddest.

Inevitably.

And would you say that the soul of such an one is the soul of a freeman, or of a slave?

He has the soul of a slave, in my opinion.

And the State which is enslaved under a tyrant is utterly incapable of acting voluntarily?

Utterly incapable.

And also the soul which is under a tyrant (I am speaking of the soul taken as a whole) is least capable of doing what she desires; there is a gadfly which goads her, and she is full of trouble and remorse?

Certainly.

And is the city which is under a tyrant rich or poor?

Poor.

And the tyrannical soul must be always poor and insatiable?

True.

And must not such a State and such a man be always full of fear?

Yes, indeed.

Is there any State in which you will find more of lamentation and sorrow and groaning and pain?

Certainly not.

And is there any man in whom you will find more of this sort of misery than in the tyrannical man, who is in a fury of passions and desires?

Impossible.

Reflecting upon these and similar evils, you held the tyrannical State to be the most miserable of States?

And I was right, he said.

Certainly, I said. And when you see the same evils in the tyrannical man, what do you say of him?

I say that he is by far the most miserable of all men.

There, I said, I think that you are beginning to go wrong.

What do you mean?

I do not think that he has as yet reached the utmost extreme of misery.

Then who is more miserable?

One of whom I am about to speak.

Who is that?

He who is of a tyrannical nature, and instead of leading a private life has been cursed with the further misfortune of being a public tyrant.

From what has been said, I gather that you are right.

Yes, I replied, but in this high argument you should be a little more certain, and should not conjecture only; for of all questions, this respecting good and evil is the greatest.

Very true, he said.

Let me then offer you an illustration, which may, I think, throw a light upon this subject.

What is your illustration?

The case of rich individuals in cities who possess many slaves: from them you may form an idea of the tyrant's condition, for they both have slaves; the only difference is that he has more slaves.

Yes, that is the difference.

You know that they live securely and have nothing to apprehend from their servants?

What should they fear?

Nothing. But do you observe the reason of this?

Yes; the reason is, that the whole city is leagued together for the protection of each individual.

Very true, I said. But imagine one of these owners, the master say of some fifty slaves, together with his family and property and slaves, carried off by a god into the wilderness, where there are no freemen to help him—will he not be in an agony of fear lest he and his wife and children should be put to death by his slaves?

Yes, he said, he will be in the utmost fear.

The time has arrived when he will be compelled to flatter divers of his slaves, and make many promises to them of freedom and other things, much against his will—he will have to cajole his own servants.

Yes, he said, that will be the only way of saving himself.

And suppose the same god, who carried him away, to surround him with neighbours who will not suffer one man to be the master of another, and who, if they could catch the offender, would take his life?

His case will be still worse, if you suppose him to be everywhere surrounded and watched by enemies.

And is not this the sort of prison in which the tyrant will be bound—he who being by nature such as we have described, is full of all sorts of fears and lusts? His soul is dainty and greedy, and yet alone, of all men in the city, he is never allowed to go on a journey, or to see the things which other freemen desire to see, but he lives in his hole like a woman hidden in the house, and is jealous of any other citizen who goes into foreign parts and sees anything of interest.

Very true, he said.

And amid evils such as these will not he who is ill-governed in his own person—the tyrannical man, I mean—whom you just now decided to be the most miserable of all—will not he be yet more miserable when, instead of leading a private life, he is constrained by fortune to be a public tyrant? He has to be master of others when he is not master of himself: he is like a diseased or paralytic man who is compelled to pass his life, not in retirement, but fighting and combating with other men.

Yes, he said, the similitude is most exact.

Is not his case utterly miserable? and does not the actual tyrant lead a worse life than he whose life you determined to be the worst?

Certainly.

He who is the real tyrant, whatever men may think, is the real slave, and is obliged to practise the greatest adulation and servility, and to be the flatterer of the vilest of mankind. He has desires which he is utterly unable to satisfy, and has more wants than any one, and is truly poor, if you know how to inspect the whole soul of him: all his life long he is beset with fear and is full of convulsions and distractions, even as the State which he resembles: and surely the resemblance holds?

Very true, he said.

Moreover, as we were saying before, he grows worse from having power: he becomes and is of necessity more jealous, more faithless, more unjust, more friendless, more impious, than he was at first; he is the purveyor and cherisher of every sort of vice, and the consequence is that he is supremely miserable, and that he makes everybody else as miserable as himself.

No man of any sense will dispute your words.

Come then, I said, and as the general umpire in theatrical contests proclaims the result, do you also decide who in your opinion is first in the scale of happiness, and who second, and in what order the others follow: there are five of them in all—they are the royal, timocratical, oligarchical, democratical, tyrannical.

The decision will be easily given, he replied; they shall be choruses coming on the stage, and I must judge them in the order in which they enter, by the criterion of virtue and vice, happiness and misery.

Need we hire a herald, or shall I announce, that the son of Ariston (the best) has decided that the best and justest is also the happiest, and that this is he who is the most royal man and king over himself; and that the worst and most unjust man is also the most miserable, and that this is he who being the greatest tyrant of himself is also the greatest tyrant of his State?

Make the proclamation yourself, he said.

And shall I add, 'whether seen or unseen by gods and men'?

Let the words be added.

Then this, I said, will be our first proof; and there is another, which may also have some weight.

What is that?

The second proof is derived from the nature of the soul: seeing that the individual soul, like the State, has been divided by us into three principles, the division may, I think, furnish a new demonstration.

Of what nature?

It seems to me that to these three principles three pleasures correspond; also three desires and governing powers.

How do you mean? he said.

There is one principle with which, as we were saying, a man learns, another with which he is angry; the third, having many forms, has no special name, but is denoted by the general term appetitive, from the extraordinary strength and vehemence of the desires of eating and drinking and the other sensual appetites which are the main elements of it; also money-loving, because such desires are generally satisfied by the help of money.

That is true, he said.

If we were to say that the loves and pleasures of this third part were concerned with gain, we should then be able to fall back on a single notion; and might truly and intelligibly describe this part of the soul as loving gain or money.

I agree with you.

Again, is not the passionate element wholly set on ruling and conquering and getting fame?

True.

Suppose we call it the contentious or ambitious—would the term be suitable?

Extremely suitable.

On the other hand, every one sees that the principle of knowledge is wholly directed to the truth, and cares less than either of the others for gain or fame.

Far less.

'Lover of wisdom,' 'lover of knowledge,' are titles which we may fitly apply to that part of the soul?

Certainly.

One principle prevails in the souls of one class of men, another in others, as may happen?

Yes.

Then we may begin by assuming that there are three classes of men—lovers of wisdom, lovers of honour, lovers of gain?

Exactly.

And there are three kinds of pleasure, which are their several objects?

Very true.

Now, if you examine the three classes of men, and ask of them in turn which of their lives is pleasantest, each will be found praising his own and depreciating that of others: the money-maker will contrast the vanity of honour or of learning if they bring no money with the solid advantages of gold and silver?

True, he said.

And the lover of honour—what will be his opinion? Will he not think that the pleasure of riches is vulgar, while the pleasure of learning, if it brings no distinction, is all smoke and nonsense to him?

Very true.

And are we to suppose, I said, that the philosopher sets any value on other pleasures in comparison with the pleasure of knowing the truth, and in that pursuit abiding, ever learning, not so far indeed from the heaven of pleasure? Does he not call the other pleasures necessary, under the idea that if there were no necessity for them, he would rather not have them?

There can be no doubt of that, he replied.

Since, then, the pleasures of each class and the life of each are in dispute, and the question is not which life is more or less honourable, or better or worse, but which is the more pleasant or painless—how shall we know who speaks truly?

I cannot myself tell, he said.

Well, but what ought to be the criterion? Is any better than experience and wisdom and reason?

There cannot be a better, he said.

Then, I said, reflect. Of the three individuals, which has the greatest experience of all the pleasures which we enumerated? Has the lover of gain, in learning the nature of essential truth, greater experience of the pleasure of knowledge than the philosopher has of the pleasure of gain?

The philosopher, he replied, has greatly the advantage; for he has of necessity always known the taste of the other pleasures from his childhood upwards: but the lover of gain in all his experience has not of necessity tasted—or, I should rather say, even had he desired, could hardly have tasted—the sweetness of learning and knowing truth.

Then the lover of wisdom has a great advantage over the lover of gain, for he has a double experience?

Yes, very great.

Again, has he greater experience of the pleasures of honour, or the lover of honour of the pleasures of wisdom?

Nay, he said, all three are honoured in proportion as they attain their object; for the rich man and the brave man and the wise man alike have their crowd of admirers, and as they all receive honour they all have experience of the pleasures of honour; but the delight which is to be found in the knowledge of true being is known to the philosopher only.

His experience, then, will enable him to judge better than any one?

Far better.

And he is the only one who has wisdom as well as experience?

Certainly.

Further, the very faculty which is the instrument of judgment is not possessed by the covetous or ambitious man, but only by the philosopher?

What faculty?

Reason, with whom, as we were saying, the decision ought to rest.

Yes.

And reasoning is peculiarly his instrument?

Certainly.

If wealth and gain were the criterion, then the praise or blame of the lover of gain would surely be the most trustworthy?

Assuredly.

Or if honour or victory or courage, in that case the judgment of the ambitious or pugnacious would be the truest?

Clearly.

But since experience and wisdom and reason are the judges—

The only inference possible, he replied, is that pleasures which are approved by the lover of wisdom and reason are the truest.

And so we arrive at the result, that the pleasure of the intelligent part of the soul is the pleasantest of the three, and that he of us in whom this is the ruling principle has the pleasantest life.

Unquestionably, he said, the wise man speaks with authority when he approves of his own life.

And what does the judge affirm to be the life which is next, and the pleasure which is next?

Clearly that of the soldier and lover of honour; who is nearer to himself than the money-maker.

Last comes the lover of gain?

Very true, he said.

Twice in succession, then, has the just man overthrown the unjust in this conflict; and now comes the third trial, which is dedicated to Olympian Zeus the saviour: a sage whispers in my ear that no pleasure except that of the wise is quite true and pure—all others are a shadow only; and surely this will prove the greatest and most decisive of falls?

Yes, the greatest; but will you explain yourself?

I will work out the subject and you shall answer my questions.

Proceed.

Say, then, is not pleasure opposed to pain?

True.

And there is a neutral state which is neither pleasure nor pain?

There is.

A state which is intermediate, and a sort of repose of the soul about either—that is what you mean?

Yes.

You remember what people say when they are sick?

What do they say?

That after all nothing is pleasanter than health. But then they never knew this to be the greatest of pleasures until they were ill.

Yes, I know, he said.

And when persons are suffering from acute pain, you must have heard them say that there is nothing pleasanter than to get rid of their pain?

I have.

And there are many other cases of suffering in which the mere rest and cessation of pain, and not any positive enjoyment, is extolled by them as the greatest pleasure?

Yes, he said; at the time they are pleased and well content to be at rest.

Again, when pleasure ceases, that sort of rest or cessation will be painful?

Doubtless, he said.

Then the intermediate state of rest will be pleasure and will also be pain?

So it would seem.

But can that which is neither become both?

I should say not.

And both pleasure and pain are motions of the soul, are they not?

Yes.

But that which is neither was just now shown to be rest and not motion, and in a mean between them?

Yes.

How, then, can we be right in supposing that the absence of pain is pleasure, or that the absence of pleasure is pain?

Impossible.

This then is an appearance only and not a reality; that is to say, the rest is pleasure at the moment and in comparison of what is painful, and painful in comparison of what is pleasant; but all these representations, when tried by the test of true pleasure, are not real but a sort of imposition?

That is the inference.

Look at the other class of pleasures which have no antecedent pains and you will no longer suppose, as you perhaps may at present, that pleasure is only the cessation of pain, or pain of pleasure.

What are they, he said, and where shall I find them?

There are many of them: take as an example the pleasures of smell, which are very great and have no antecedent pains; they come in a moment, and when they depart leave no pain behind them.

Most true, he said.

Let us not, then, be induced to believe that pure pleasure is the cessation of pain, or pain of pleasure.

No.

Still, the more numerous and violent pleasures which reach the soul through the body are generally of this sort—they are reliefs of pain.

That is true.

And the anticipations of future pleasures and pains are of a like nature?

Yes.

Shall I give you an illustration of them?

Let me hear.

You would allow, I said, that there is in nature an upper and lower and middle region?

I should.

And if a person were to go from the lower to the middle region, would he not imagine that he is going up; and he who is standing in the middle and sees whence he has come, would imagine that he is already in the upper region, if he has never seen the true upper world?

To be sure, he said; how can he think otherwise?

But if he were taken back again he would imagine, and truly imagine, that he was descending?

No doubt.

All that would arise out of his ignorance of the true upper and middle and lower regions?

Yes.

Then can you wonder that persons who are inexperienced in the truth, as they have wrong ideas about many other things, should also have wrong ideas about pleasure and pain and the intermediate state; so that when they are only being drawn towards the painful they feel pain and think the pain which they experience to be real, and in like manner, when drawn away from pain to the neutral or intermediate state, they firmly believe that they have reached the goal of satiety and pleasure; they, not knowing pleasure, err in contrasting pain with the absence of pain, which is like contrasting black with grey instead of white—can you wonder, I say, at this?

No, indeed; I should be much more disposed to wonder at the opposite.

Look at the matter thus:—Hunger, thirst, and the like, are inanitions of the bodily state?

Yes.

And ignorance and folly are inanitions of the soul?

True.

And food and wisdom are the corresponding satisfactions of either?

Certainly.

And is the satisfaction derived from that which has less or from that which has more existence the truer?

Clearly, from that which has more.

What classes of things have a greater share of pure existence in your judgment—those of which food and drink and condiments and all kinds of sustenance are examples, or the class which contains true opinion and knowledge and mind and all the different kinds of virtue? Put the question in this way:—Which has a more pure being—that which is concerned with the invariable, the immortal, and the true, and is of such a nature, and is found in such natures; or that which is concerned with and found in the variable and mortal, and is itself variable and mortal?

Far purer, he replied, is the being of that which is concerned with the invariable.

And does the essence of the invariable partake of knowledge in the same degree as of essence?

Yes, of knowledge in the same degree.

And of truth in the same degree?

Yes.

And, conversely, that which has less of truth will also have less of essence?

Necessarily.

Then, in general, those kinds of things which are in the service of the body have less of truth and essence than those which are in the service of the soul?

Far less.

And has not the body itself less of truth and essence than the soul?

Yes.

What is filled with more real existence, and actually has a more real existence, is more really filled than that which is filled with less real existence and is less real?

Of course.

And if there be a pleasure in being filled with that which is according to nature, that which is more really filled with more real being will more really and truly enjoy true pleasure; whereas that which participates in less real being will be less truly and surely satisfied, and will participate in an illusory and less real pleasure?

Unquestionably.

Those then who know not wisdom and virtue, and are always busy with gluttony and sensuality, go down and up again as far as the mean; and in this region they move at random throughout life, but they never pass into the true upper world; thither they neither look, nor do they ever find their way, neither are they truly filled with true being, nor do they taste of pure and abiding pleasure. Like cattle, with their eyes always looking down and their heads stooping to the earth, that is, to the dining-table, they fatten and feed and breed, and, in their excessive love of these delights, they kick and butt at one another with horns and hoofs which are made of iron; and they kill one another by reason of their insatiable lust. For they fill themselves with that which is not substantial, and the part of themselves which they fill is also unsubstantial and incontinent.

Verily, Socrates, said Glaucon, you describe the life of the many like an oracle.

Their pleasures are mixed with pains—how can they be otherwise? For they are mere shadows and pictures of the true, and are coloured by contrast, which exaggerates both light and shade, and so they implant in the minds of fools insane desires of themselves; and they are fought about as Stesichorus says that the Greeks fought about the shadow of Helen at Troy in ignorance of the truth.

Something of that sort must inevitably happen.

And must not the like happen with the spirited or passionate element of the soul? Will not the passionate man who carries his passion into action, be in the like case, whether he is envious and ambitious, or violent and contentious, or angry and discontented, if he be seeking to attain honour and victory and the satisfaction of his anger without reason or sense?

Yes, he said, the same will happen with the spirited element also.

Then may we not confidently assert that the lovers of money and honour, when they seek their pleasures under the guidance and in the company of reason and knowledge, and pursue after and win the pleasures which wisdom shows them, will also have the truest pleasures in the highest degree which is attainable to them, inasmuch as they follow truth; and they will have the pleasures which are natural to them, if that which is best for each one is also most natural to him?

Yes, certainly; the best is the most natural.

And when the whole soul follows the philosophical principle, and there is no division, the several parts are just, and do each of them their own business, and enjoy severally the best and truest pleasures of which they are capable?

Exactly.

But when either of the two other principles prevails, it fails in attaining its own pleasure, and compels the rest to pursue after a pleasure which is a shadow only and which is not their own?

True.

And the greater the interval which separates them from philosophy and reason, the more strange and illusive will be the pleasure?

Yes.

And is not that farthest from reason which is at the greatest distance from law and order?

Clearly.

And the lustful and tyrannical desires are, as we saw, at the greatest distance? Yes.

And the royal and orderly desires are nearest?

Yes.

Then the tyrant will live at the greatest distance from true or natural pleasure, and the king at the least?

Certainly.

But if so, the tyrant will live most unpleasantly, and the king most pleasantly?

Inevitably.

Would you know the measure of the interval which separates them?

Will you tell me?

There appear to be three pleasures, one genuine and two spurious: now the transgression of the tyrant reaches a point beyond the spurious; he has run away from the region of law and reason, and taken up his abode with certain slave pleasures which are his satellites, and the measure of his inferiority can only be expressed in a figure.

How do you mean?

I assume, I said, that the tyrant is in the third place from the oligarch; the democrat was in the middle?

Yes.

And if there is truth in what has preceded, he will be wedded to an image of pleasure which is thrice removed as to truth from the pleasure of the oligarch?

He will.

And the oligarch is third from the royal; since we count as one royal and aristocratical?

Yes, he is third.

Then the tyrant is removed from true pleasure by the space of a number which is three times three?

Manifestly.

The shadow then of tyrannical pleasure determined by the number of length will be a plane figure.

Certainly.

And if you raise the power and make the plane a solid, there is no difficulty in seeing how vast is the interval by which the tyrant is parted from the king.

Yes; the arithmetician will easily do the sum.

Or if some person begins at the other end and measures the interval by which the king is parted from the tyrant in truth of pleasure, he will find him, when the multiplication is completed, living 729 times more pleasantly, and the tyrant more painfully by this same interval.

What a wonderful calculation! And how enormous is the distance which separates the just from the unjust in regard to pleasure and pain!

Yet a true calculation, I said, and a number which nearly concerns human life, if human beings are concerned with days and nights and months and years. (729 NEARLY equals the number of days and nights in the year.)

Yes, he said, human life is certainly concerned with them.

Then if the good and just man be thus superior in pleasure to the evil and unjust, his superiority will be infinitely greater in propriety of life and in beauty and virtue?

Immeasurably greater.

Well, I said, and now having arrived at this stage of the argument, we may revert to the words which brought us hither: Was not some one saying that injustice was a gain to the perfectly unjust who was reputed to be just?

Yes, that was said.

Now then, having determined the power and quality of justice and injustice, let us have a little conversation with him.

What shall we say to him?

Let us make an image of the soul, that he may have his own words presented before his eyes.

Of what sort?

An ideal image of the soul, like the composite creations of ancient mythology, such as the Chimera or Scylla or Cerberus, and there are many others in which two or more different natures are said to grow into one.

There are said of have been such unions.

Then do you now model the form of a multitudinous, many-headed monster, having a ring of heads of all manner of beasts, tame and wild, which he is able to generate and metamorphose at will.

You suppose marvellous powers in the artist; but, as language is more pliable than wax or any similar substance, let there be such a model as you propose.

Suppose now that you make a second form as of a lion, and a third of a man, the second smaller than the first, and the third smaller than the second.

That, he said, is an easier task; and I have made them as you say.

And now join them, and let the three grow into one.

That has been accomplished.

Next fashion the outside of them into a single image, as of a man, so that he who is not able to look within, and sees only the outer hull, may believe the beast to be a single human creature.

I have done so, he said.

And now, to him who maintains that it is profitable for the human creature to be unjust, and unprofitable to be just, let us reply that, if he be right, it is profitable for this creature to feast the multitudinous monster and strengthen the lion and the lion-like qualities, but to starve and weaken the man, who is consequently liable to be dragged about at the mercy of either of the other two; and he is not to attempt to familiarize or harmonize them with one another—he ought rather to suffer them to fight and bite and devour one another.

Certainly, he said; that is what the approver of injustice says.

To him the supporter of justice makes answer that he should ever so speak and act as to give the man within him in some way or other the most complete mastery over the entire human creature. He should watch over the many-headed monster like a good husbandman, fostering and cultivating the gentle qualities, and preventing the wild ones from growing; he should be making the lion-heart his ally, and in common care of them all should be uniting the several parts with one another and with himself.

Yes, he said, that is quite what the maintainer of justice say.

And so from every point of view, whether of pleasure, honour, or advantage, the approver of justice is right and speaks the truth, and the disapprover is wrong and false and ignorant?

Yes, from every point of view.

Come, now, and let us gently reason with the unjust, who is not intentionally in error. 'Sweet Sir,' we will say to him, 'what think you of things esteemed noble and ignoble? Is not the noble that which subjects the beast to the man, or rather to the god in man; and the ignoble that which subjects the man to the beast?' He can hardly avoid saying Yes—can he now?

Not if he has any regard for my opinion.

But, if he agree so far, we may ask him to answer another question: 'Then how would a man profit if he received gold and silver on the condition that he was to enslave the noblest part of him to the worst? Who can imagine that a man who sold his son or daughter into slavery for money, especially if he sold them into the hands of fierce and evil men, would be the gainer, however large might be the sum which he received? And will any one say that he is not a miserable caitiff who remorselessly sells his own divine being to that which is most godless and detestable? Eriphyle took the necklace as the price of her husband's life, but he is taking a bribe in order to compass a worse ruin.'

Yes, said Glaucon, far worse—I will answer for him.

Has not the intemperate been censured of old, because in him the huge multiform monster is allowed to be too much at large?

Clearly.

And men are blamed for pride and bad temper when the lion and serpent element in them disproportionately grows and gains strength?

Yes.

And luxury and softness are blamed, because they relax and weaken this same creature, and make a coward of him?

Very true.

And is not a man reproached for flattery and meanness who subordinates the spirited animal to the unruly monster, and, for the sake of money, of which he can never have enough, habituates him in the days of his youth to be trampled in the mire, and from being a lion to become a monkey?

True, he said.

And why are mean employments and manual arts a reproach? Only because they imply a natural weakness of the higher principle; the individual is unable to control the creatures within him, but has to court them, and his great study is how to flatter them.

Such appears to be the reason.

And therefore, being desirous of placing him under a rule like that of the best, we say that he ought to be the servant of the best, in whom the Divine rules; not, as Thrasymachus supposed, to the injury of the servant, but because every one had better be ruled by divine wisdom dwelling within him; or, if this be impossible, then by an external authority, in order that we may be all, as far as possible, under the same government, friends and equals.

True, he said.

And this is clearly seen to be the intention of the law, which is the ally of the whole city; and is seen also in the authority which we exercise over children, and the refusal to let them be free until we have established in them a principle analogous to the constitution of a state, and by cultivation of this higher element have set up in their hearts a guardian and ruler like our own, and when this is done they may go their ways.

Yes, he said, the purpose of the law is manifest.

From what point of view, then, and on what ground can we say that a man is profited by injustice or intemperance or other baseness, which will make him a worse man, even though he acquire money or power by his wickedness?

From no point of view at all.

What shall he profit, if his injustice be undetected and unpunished? He who is undetected only gets worse, whereas he who is detected and punished has the brutal part of his nature silenced and humanized; the gentler element in him is liberated, and his whole soul is perfected and ennobled by the acquirement of justice and temperance and wisdom, more than the body ever is by receiving gifts of beauty, strength and health, in proportion as the soul is more honourable than the body.

Certainly, he said.

To this nobler purpose the man of understanding will devote the energies of his life. And in the first place, he will honour studies which impress these qualities on his soul and will disregard others?

Clearly, he said.

In the next place, he will regulate his bodily habit and training, and so far will he be from yielding to brutal and irrational pleasures, that he will regard even health as quite a secondary matter; his first object will be not that he may be fair or strong or well, unless he is likely thereby to gain temperance, but he will always desire so to attemper the body as to preserve the harmony of the soul?

Certainly he will, if he has true music in him.

And in the acquisition of wealth there is a principle of order and harmony which he will also observe; he will not allow himself to be dazzled by the foolish applause of the world, and heap up riches to his own infinite harm?

Certainly not, he said.

He will look at the city which is within him, and take heed that no disorder occur in it, such as might arise either from superfluity or from want; and upon this principle he will regulate his property and gain or spend according to his means.

Very true.

And, for the same reason, he will gladly accept and enjoy such honours as he deems likely to make him a better man; but those, whether private or public, which are likely to disorder his life, he will avoid?

Then, if that is his motive, he will not be a statesman.

By the dog of Egypt, he will! in the city which is his own he certainly will, though in the land of his birth perhaps not, unless he have a divine call.

I understand; you mean that he will be a ruler in the city of which we are the founders, and which exists in idea only; for I do not believe that there is such an one anywhere on earth?

In heaven, I replied, there is laid up a pattern of it, methinks, which he who desires may behold, and beholding, may set his own house in order. But whether such an one exists, or ever will exist in fact, is no matter; for he will live after the manner of that city, having nothing to do with any other.

I think so, he said.</pre>
</div>
<div created="20150302214143458" modified="20150302214502250" tags="$:/tags/SideBar" title="Book List">
<pre>''Benjamin Jowett translation:''

* [[Book I|Book I (Jowett translation)]]
* [[Book II|Book II (Jowett translation)]]
* [[Book III|Book III (Jowett translation)]]
* [[Book IV|Book IV (Jowett translation)]]
* [[Book V|Book V (Jowett translation)]]
* [[Book VI|Book VI (Jowett translation)]]
* [[Book VII|Book VII (Jowett translation)]]
* [[Book VIII|Book VIII (Jowett translation)]]
* [[Book IX|Book IX (Jowett translation)]]
* [[Book X|Book X (Jowett translation)]]</pre>
</div>
<div created="20150302203110633" modified="20150302213059017" tags="" title="Book V (Jowett translation)">
<pre>Such is the good and true City or State, and the good and true man is of the same pattern; and if this is right every other is wrong; and the evil is one which affects not only the ordering of the State, but also the regulation of the individual soul, and is exhibited in four forms.

What are they? he said.

I was proceeding to tell the order in which the four evil forms appeared to me to succeed one another, when Polemarchus, who was sitting a little way off, just beyond Adeimantus, began to whisper to him: stretching forth his hand, he took hold of the upper part of his coat by the shoulder, and drew him towards him, leaning forward himself so as to be quite close and saying something in his ear, of which I only caught the words, 'Shall we let him off, or what shall we do?'

Certainly not, said Adeimantus, raising his voice.

Who is it, I said, whom you are refusing to let off?

You, he said.

I repeated, Why am I especially not to be let off?

Why, he said, we think that you are lazy, and mean to cheat us out of a whole chapter which is a very important part of the story; and you fancy that we shall not notice your airy way of proceeding; as if it were self-evident to everybody, that in the matter of women and children 'friends have all things in common.'

And was I not right, Adeimantus?

Yes, he said; but what is right in this particular case, like everything else, requires to be explained; for community may be of many kinds. Please, therefore, to say what sort of community you mean. We have been long expecting that you would tell us something about the family life of your citizens—how they will bring children into the world, and rear them when they have arrived, and, in general, what is the nature of this community of women and children—for we are of opinion that the right or wrong management of such matters will have a great and paramount influence on the State for good or for evil. And now, since the question is still undetermined, and you are taking in hand another State, we have resolved, as you heard, not to let you go until you give an account of all this.

To that resolution, said Glaucon, you may regard me as saying Agreed.

And without more ado, said Thrasymachus, you may consider us all to be equally agreed.

I said, You know not what you are doing in thus assailing me: What an argument are you raising about the State! Just as I thought that I had finished, and was only too glad that I had laid this question to sleep, and was reflecting how fortunate I was in your acceptance of what I then said, you ask me to begin again at the very foundation, ignorant of what a hornet's nest of words you are stirring. Now I foresaw this gathering trouble, and avoided it.

For what purpose do you conceive that we have come here, said Thrasymachus,—to look for gold, or to hear discourse?

Yes, but discourse should have a limit.

Yes, Socrates, said Glaucon, and the whole of life is the only limit which wise men assign to the hearing of such discourses. But never mind about us; take heart yourself and answer the question in your own way: What sort of community of women and children is this which is to prevail among our guardians? and how shall we manage the period between birth and education, which seems to require the greatest care? Tell us how these things will be.

Yes, my simple friend, but the answer is the reverse of easy; many more doubts arise about this than about our previous conclusions. For the practicability of what is said may be doubted; and looked at in another point of view, whether the scheme, if ever so practicable, would be for the best, is also doubtful. Hence I feel a reluctance to approach the subject, lest our aspiration, my dear friend, should turn out to be a dream only.

Fear not, he replied, for your audience will not be hard upon you; they are not sceptical or hostile.

I said: My good friend, I suppose that you mean to encourage me by these words.

Yes, he said.

Then let me tell you that you are doing just the reverse; the encouragement which you offer would have been all very well had I myself believed that I knew what I was talking about: to declare the truth about matters of high interest which a man honours and loves among wise men who love him need occasion no fear or faltering in his mind; but to carry on an argument when you are yourself only a hesitating enquirer, which is my condition, is a dangerous and slippery thing; and the danger is not that I shall be laughed at (of which the fear would be childish), but that I shall miss the truth where I have most need to be sure of my footing, and drag my friends after me in my fall. And I pray Nemesis not to visit upon me the words which I am going to utter. For I do indeed believe that to be an involuntary homicide is a less crime than to be a deceiver about beauty or goodness or justice in the matter of laws. And that is a risk which I would rather run among enemies than among friends, and therefore you do well to encourage me.

Glaucon laughed and said: Well then, Socrates, in case you and your argument do us any serious injury you shall be acquitted beforehand of the homicide, and shall not be held to be a deceiver; take courage then and speak.

Well, I said, the law says that when a man is acquitted he is free from guilt, and what holds at law may hold in argument.

Then why should you mind?

Well, I replied, I suppose that I must retrace my steps and say what I perhaps ought to have said before in the proper place. The part of the men has been played out, and now properly enough comes the turn of the women. Of them I will proceed to speak, and the more readily since I am invited by you.

For men born and educated like our citizens, the only way, in my opinion, of arriving at a right conclusion about the possession and use of women and children is to follow the path on which we originally started, when we said that the men were to be the guardians and watchdogs of the herd.

True.

Let us further suppose the birth and education of our women to be subject to similar or nearly similar regulations; then we shall see whether the result accords with our design.

What do you mean?

What I mean may be put into the form of a question, I said: Are dogs divided into hes and shes, or do they both share equally in hunting and in keeping watch and in the other duties of dogs? or do we entrust to the males the entire and exclusive care of the flocks, while we leave the females at home, under the idea that the bearing and suckling their puppies is labour enough for them?

No, he said, they share alike; the only difference between them is that the males are stronger and the females weaker.

But can you use different animals for the same purpose, unless they are bred and fed in the same way?

You cannot.

Then, if women are to have the same duties as men, they must have the same nurture and education?

Yes.

The education which was assigned to the men was music and gymnastic.

Yes.

Then women must be taught music and gymnastic and also the art of war, which they must practise like the men?

That is the inference, I suppose.

I should rather expect, I said, that several of our proposals, if they are carried out, being unusual, may appear ridiculous.

No doubt of it.

Yes, and the most ridiculous thing of all will be the sight of women naked in the palaestra, exercising with the men, especially when they are no longer young; they certainly will not be a vision of beauty, any more than the enthusiastic old men who in spite of wrinkles and ugliness continue to frequent the gymnasia.

Yes, indeed, he said: according to present notions the proposal would be thought ridiculous.

But then, I said, as we have determined to speak our minds, we must not fear the jests of the wits which will be directed against this sort of innovation; how they will talk of women's attainments both in music and gymnastic, and above all about their wearing armour and riding upon horseback!

Very true, he replied.

Yet having begun we must go forward to the rough places of the law; at the same time begging of these gentlemen for once in their life to be serious. Not long ago, as we shall remind them, the Hellenes were of the opinion, which is still generally received among the barbarians, that the sight of a naked man was ridiculous and improper; and when first the Cretans and then the Lacedaemonians introduced the custom, the wits of that day might equally have ridiculed the innovation.

No doubt.

But when experience showed that to let all things be uncovered was far better than to cover them up, and the ludicrous effect to the outward eye vanished before the better principle which reason asserted, then the man was perceived to be a fool who directs the shafts of his ridicule at any other sight but that of folly and vice, or seriously inclines to weigh the beautiful by any other standard but that of the good.

Very true, he replied.

First, then, whether the question is to be put in jest or in earnest, let us come to an understanding about the nature of woman: Is she capable of sharing either wholly or partially in the actions of men, or not at all? And is the art of war one of those arts in which she can or can not share? That will be the best way of commencing the enquiry, and will probably lead to the fairest conclusion.

That will be much the best way.

Shall we take the other side first and begin by arguing against ourselves; in this manner the adversary's position will not be undefended.

Why not? he said.

Then let us put a speech into the mouths of our opponents. They will say: 'Socrates and Glaucon, no adversary need convict you, for you yourselves, at the first foundation of the State, admitted the principle that everybody was to do the one work suited to his own nature.' And certainly, if I am not mistaken, such an admission was made by us. 'And do not the natures of men and women differ very much indeed?' And we shall reply: Of course they do. Then we shall be asked, 'Whether the tasks assigned to men and to women should not be different, and such as are agreeable to their different natures?' Certainly they should. 'But if so, have you not fallen into a serious inconsistency in saying that men and women, whose natures are so entirely different, ought to perform the same actions?'—What defence will you make for us, my good Sir, against any one who offers these objections?

That is not an easy question to answer when asked suddenly; and I shall and I do beg of you to draw out the case on our side.

These are the objections, Glaucon, and there are many others of a like kind, which I foresaw long ago; they made me afraid and reluctant to take in hand any law about the possession and nurture of women and children.

By Zeus, he said, the problem to be solved is anything but easy.

Why yes, I said, but the fact is that when a man is out of his depth, whether he has fallen into a little swimming bath or into mid ocean, he has to swim all the same.

Very true.

And must not we swim and try to reach the shore: we will hope that Arion's dolphin or some other miraculous help may save us?

I suppose so, he said.

Well then, let us see if any way of escape can be found. We acknowledged—did we not? that different natures ought to have different pursuits, and that men's and women's natures are different. And now what are we saying?—that different natures ought to have the same pursuits,—this is the inconsistency which is charged upon us.

Precisely.

Verily, Glaucon, I said, glorious is the power of the art of contradiction!

Why do you say so?

Because I think that many a man falls into the practice against his will. When he thinks that he is reasoning he is really disputing, just because he cannot define and divide, and so know that of which he is speaking; and he will pursue a merely verbal opposition in the spirit of contention and not of fair discussion.

Yes, he replied, such is very often the case; but what has that to do with us and our argument?

A great deal; for there is certainly a danger of our getting unintentionally into a verbal opposition.

In what way?

Why we valiantly and pugnaciously insist upon the verbal truth, that different natures ought to have different pursuits, but we never considered at all what was the meaning of sameness or difference of nature, or why we distinguished them when we assigned different pursuits to different natures and the same to the same natures.

Why, no, he said, that was never considered by us.

I said: Suppose that by way of illustration we were to ask the question whether there is not an opposition in nature between bald men and hairy men; and if this is admitted by us, then, if bald men are cobblers, we should forbid the hairy men to be cobblers, and conversely?

That would be a jest, he said.

Yes, I said, a jest; and why? because we never meant when we constructed the State, that the opposition of natures should extend to every difference, but only to those differences which affected the pursuit in which the individual is engaged; we should have argued, for example, that a physician and one who is in mind a physician may be said to have the same nature.

True.

Whereas the physician and the carpenter have different natures?

Certainly.

And if, I said, the male and female sex appear to differ in their fitness for any art or pursuit, we should say that such pursuit or art ought to be assigned to one or the other of them; but if the difference consists only in women bearing and men begetting children, this does not amount to a proof that a woman differs from a man in respect of the sort of education she should receive; and we shall therefore continue to maintain that our guardians and their wives ought to have the same pursuits.

Very true, he said.

Next, we shall ask our opponent how, in reference to any of the pursuits or arts of civic life, the nature of a woman differs from that of a man?

That will be quite fair.

And perhaps he, like yourself, will reply that to give a sufficient answer on the instant is not easy; but after a little reflection there is no difficulty.

Yes, perhaps.

Suppose then that we invite him to accompany us in the argument, and then we may hope to show him that there is nothing peculiar in the constitution of women which would affect them in the administration of the State.

By all means.

Let us say to him: Come now, and we will ask you a question:—when you spoke of a nature gifted or not gifted in any respect, did you mean to say that one man will acquire a thing easily, another with difficulty; a little learning will lead the one to discover a great deal; whereas the other, after much study and application, no sooner learns than he forgets; or again, did you mean, that the one has a body which is a good servant to his mind, while the body of the other is a hindrance to him?—would not these be the sort of differences which distinguish the man gifted by nature from the one who is ungifted?

No one will deny that.

And can you mention any pursuit of mankind in which the male sex has not all these gifts and qualities in a higher degree than the female? Need I waste time in speaking of the art of weaving, and the management of pancakes and preserves, in which womankind does really appear to be great, and in which for her to be beaten by a man is of all things the most absurd?

You are quite right, he replied, in maintaining the general inferiority of the female sex: although many women are in many things superior to many men, yet on the whole what you say is true.

And if so, my friend, I said, there is no special faculty of administration in a state which a woman has because she is a woman, or which a man has by virtue of his sex, but the gifts of nature are alike diffused in both; all the pursuits of men are the pursuits of women also, but in all of them a woman is inferior to a man.

Very true.

Then are we to impose all our enactments on men and none of them on women?

That will never do.

One woman has a gift of healing, another not; one is a musician, and another has no music in her nature?

Very true.

And one woman has a turn for gymnastic and military exercises, and another is unwarlike and hates gymnastics?

Certainly.

And one woman is a philosopher, and another is an enemy of philosophy; one has spirit, and another is without spirit?

That is also true.

Then one woman will have the temper of a guardian, and another not. Was not the selection of the male guardians determined by differences of this sort?

Yes.

Men and women alike possess the qualities which make a guardian; they differ only in their comparative strength or weakness.

Obviously.

And those women who have such qualities are to be selected as the companions and colleagues of men who have similar qualities and whom they resemble in capacity and in character?

Very true.

And ought not the same natures to have the same pursuits?

They ought.

Then, as we were saying before, there is nothing unnatural in assigning music and gymnastic to the wives of the guardians—to that point we come round again.

Certainly not.

The law which we then enacted was agreeable to nature, and therefore not an impossibility or mere aspiration; and the contrary practice, which prevails at present, is in reality a violation of nature.

That appears to be true.

We had to consider, first, whether our proposals were possible, and secondly whether they were the most beneficial?

Yes.

And the possibility has been acknowledged?

Yes.

The very great benefit has next to be established?

Quite so.

You will admit that the same education which makes a man a good guardian will make a woman a good guardian; for their original nature is the same?

Yes.

I should like to ask you a question.

What is it?

Would you say that all men are equal in excellence, or is one man better than another?

The latter.

And in the commonwealth which we were founding do you conceive the guardians who have been brought up on our model system to be more perfect men, or the cobblers whose education has been cobbling?

What a ridiculous question!

You have answered me, I replied: Well, and may we not further say that our guardians are the best of our citizens?

By far the best.

And will not their wives be the best women?

Yes, by far the best.

And can there be anything better for the interests of the State than that the men and women of a State should be as good as possible?

There can be nothing better.

And this is what the arts of music and gymnastic, when present in such manner as we have described, will accomplish?

Certainly.

Then we have made an enactment not only possible but in the highest degree beneficial to the State?

True.

Then let the wives of our guardians strip, for their virtue will be their robe, and let them share in the toils of war and the defence of their country; only in the distribution of labours the lighter are to be assigned to the women, who are the weaker natures, but in other respects their duties are to be the same. And as for the man who laughs at naked women exercising their bodies from the best of motives, in his laughter he is plucking

'A fruit of unripe wisdom,'

and he himself is ignorant of what he is laughing at, or what he is about;—for that is, and ever will be, the best of sayings, That the useful is the noble and the hurtful is the base.

Very true.

Here, then, is one difficulty in our law about women, which we may say that we have now escaped; the wave has not swallowed us up alive for enacting that the guardians of either sex should have all their pursuits in common; to the utility and also to the possibility of this arrangement the consistency of the argument with itself bears witness.

Yes, that was a mighty wave which you have escaped.

Yes, I said, but a greater is coming; you will not think much of this when you see the next.

Go on; let me see.

The law, I said, which is the sequel of this and of all that has preceded, is to the following effect,—'that the wives of our guardians are to be common, and their children are to be common, and no parent is to know his own child, nor any child his parent.'

Yes, he said, that is a much greater wave than the other; and the possibility as well as the utility of such a law are far more questionable.

I do not think, I said, that there can be any dispute about the very great utility of having wives and children in common; the possibility is quite another matter, and will be very much disputed.

I think that a good many doubts may be raised about both.

You imply that the two questions must be combined, I replied. Now I meant that you should admit the utility; and in this way, as I thought, I should escape from one of them, and then there would remain only the possibility.

But that little attempt is detected, and therefore you will please to give a defence of both.

Well, I said, I submit to my fate. Yet grant me a little favour: let me feast my mind with the dream as day dreamers are in the habit of feasting themselves when they are walking alone; for before they have discovered any means of effecting their wishes—that is a matter which never troubles them—they would rather not tire themselves by thinking about possibilities; but assuming that what they desire is already granted to them, they proceed with their plan, and delight in detailing what they mean to do when their wish has come true—that is a way which they have of not doing much good to a capacity which was never good for much. Now I myself am beginning to lose heart, and I should like, with your permission, to pass over the question of possibility at present. Assuming therefore the possibility of the proposal, I shall now proceed to enquire how the rulers will carry out these arrangements, and I shall demonstrate that our plan, if executed, will be of the greatest benefit to the State and to the guardians. First of all, then, if you have no objection, I will endeavour with your help to consider the advantages of the measure; and hereafter the question of possibility.

I have no objection; proceed.

First, I think that if our rulers and their auxiliaries are to be worthy of the name which they bear, there must be willingness to obey in the one and the power of command in the other; the guardians must themselves obey the laws, and they must also imitate the spirit of them in any details which are entrusted to their care.

That is right, he said.

You, I said, who are their legislator, having selected the men, will now select the women and give them to them;—they must be as far as possible of like natures with them; and they must live in common houses and meet at common meals. None of them will have anything specially his or her own; they will be together, and will be brought up together, and will associate at gymnastic exercises. And so they will be drawn by a necessity of their natures to have intercourse with each other—necessity is not too strong a word, I think?

Yes, he said;—necessity, not geometrical, but another sort of necessity which lovers know, and which is far more convincing and constraining to the mass of mankind.

True, I said; and this, Glaucon, like all the rest, must proceed after an orderly fashion; in a city of the blessed, licentiousness is an unholy thing which the rulers will forbid.

Yes, he said, and it ought not to be permitted.

Then clearly the next thing will be to make matrimony sacred in the highest degree, and what is most beneficial will be deemed sacred?

Exactly.

And how can marriages be made most beneficial?—that is a question which I put to you, because I see in your house dogs for hunting, and of the nobler sort of birds not a few. Now, I beseech you, do tell me, have you ever attended to their pairing and breeding?

In what particulars?

Why, in the first place, although they are all of a good sort, are not some better than others?

True.

And do you breed from them all indifferently, or do you take care to breed from the best only?

From the best.

And do you take the oldest or the youngest, or only those of ripe age?

I choose only those of ripe age.

And if care was not taken in the breeding, your dogs and birds would greatly deteriorate?

Certainly.

And the same of horses and animals in general?

Undoubtedly.

Good heavens! my dear friend, I said, what consummate skill will our rulers need if the same principle holds of the human species!

Certainly, the same principle holds; but why does this involve any particular skill?

Because, I said, our rulers will often have to practise upon the body corporate with medicines. Now you know that when patients do not require medicines, but have only to be put under a regimen, the inferior sort of practitioner is deemed to be good enough; but when medicine has to be given, then the doctor should be more of a man.

That is quite true, he said; but to what are you alluding?

I mean, I replied, that our rulers will find a considerable dose of falsehood and deceit necessary for the good of their subjects: we were saying that the use of all these things regarded as medicines might be of advantage.

And we were very right.

And this lawful use of them seems likely to be often needed in the regulations of marriages and births.

How so?

Why, I said, the principle has been already laid down that the best of either sex should be united with the best as often, and the inferior with the inferior, as seldom as possible; and that they should rear the offspring of the one sort of union, but not of the other, if the flock is to be maintained in first-rate condition. Now these goings on must be a secret which the rulers only know, or there will be a further danger of our herd, as the guardians may be termed, breaking out into rebellion.

Very true.

Had we not better appoint certain festivals at which we will bring together the brides and bridegrooms, and sacrifices will be offered and suitable hymeneal songs composed by our poets: the number of weddings is a matter which must be left to the discretion of the rulers, whose aim will be to preserve the average of population? There are many other things which they will have to consider, such as the effects of wars and diseases and any similar agencies, in order as far as this is possible to prevent the State from becoming either too large or too small.

Certainly, he replied.

We shall have to invent some ingenious kind of lots which the less worthy may draw on each occasion of our bringing them together, and then they will accuse their own ill-luck and not the rulers.

To be sure, he said.

And I think that our braver and better youth, besides their other honours and rewards, might have greater facilities of intercourse with women given them; their bravery will be a reason, and such fathers ought to have as many sons as possible.

True.

And the proper officers, whether male or female or both, for offices are to be held by women as well as by men—

Yes—

The proper officers will take the offspring of the good parents to the pen or fold, and there they will deposit them with certain nurses who dwell in a separate quarter; but the offspring of the inferior, or of the better when they chance to be deformed, will be put away in some mysterious, unknown place, as they should be.

Yes, he said, that must be done if the breed of the guardians is to be kept pure.

They will provide for their nurture, and will bring the mothers to the fold when they are full of milk, taking the greatest possible care that no mother recognises her own child; and other wet-nurses may be engaged if more are required. Care will also be taken that the process of suckling shall not be protracted too long; and the mothers will have no getting up at night or other trouble, but will hand over all this sort of thing to the nurses and attendants.

You suppose the wives of our guardians to have a fine easy time of it when they are having children.

Why, said I, and so they ought. Let us, however, proceed with our scheme. We were saying that the parents should be in the prime of life?

Very true.

And what is the prime of life? May it not be defined as a period of about twenty years in a woman's life, and thirty in a man's?

Which years do you mean to include?

A woman, I said, at twenty years of age may begin to bear children to the State, and continue to bear them until forty; a man may begin at five-and-twenty, when he has passed the point at which the pulse of life beats quickest, and continue to beget children until he be fifty-five.

Certainly, he said, both in men and women those years are the prime of physical as well as of intellectual vigour.

Any one above or below the prescribed ages who takes part in the public hymeneals shall be said to have done an unholy and unrighteous thing; the child of which he is the father, if it steals into life, will have been conceived under auspices very unlike the sacrifices and prayers, which at each hymeneal priestesses and priest and the whole city will offer, that the new generation may be better and more useful than their good and useful parents, whereas his child will be the offspring of darkness and strange lust.

Very true, he replied.

And the same law will apply to any one of those within the prescribed age who forms a connection with any woman in the prime of life without the sanction of the rulers; for we shall say that he is raising up a bastard to the State, uncertified and unconsecrated.

Very true, he replied.

This applies, however, only to those who are within the specified age: after that we allow them to range at will, except that a man may not marry his daughter or his daughter's daughter, or his mother or his mother's mother; and women, on the other hand, are prohibited from marrying their sons or fathers, or son's son or father's father, and so on in either direction. And we grant all this, accompanying the permission with strict orders to prevent any embryo which may come into being from seeing the light; and if any force a way to the birth, the parents must understand that the offspring of such an union cannot be maintained, and arrange accordingly.

That also, he said, is a reasonable proposition. But how will they know who are fathers and daughters, and so on?

They will never know. The way will be this:—dating from the day of the hymeneal, the bridegroom who was then married will call all the male children who are born in the seventh and tenth month afterwards his sons, and the female children his daughters, and they will call him father, and he will call their children his grandchildren, and they will call the elder generation grandfathers and grandmothers. All who were begotten at the time when their fathers and mothers came together will be called their brothers and sisters, and these, as I was saying, will be forbidden to inter-marry. This, however, is not to be understood as an absolute prohibition of the marriage of brothers and sisters; if the lot favours them, and they receive the sanction of the Pythian oracle, the law will allow them.

Quite right, he replied.

Such is the scheme, Glaucon, according to which the guardians of our State are to have their wives and families in common. And now you would have the argument show that this community is consistent with the rest of our polity, and also that nothing can be better—would you not?

Yes, certainly.

Shall we try to find a common basis by asking of ourselves what ought to be the chief aim of the legislator in making laws and in the organization of a State,—what is the greatest good, and what is the greatest evil, and then consider whether our previous description has the stamp of the good or of the evil?

By all means.

Can there be any greater evil than discord and distraction and plurality where unity ought to reign? or any greater good than the bond of unity?

There cannot.

And there is unity where there is community of pleasures and pains—where all the citizens are glad or grieved on the same occasions of joy and sorrow?

No doubt.

Yes; and where there is no common but only private feeling a State is disorganized—when you have one half of the world triumphing and the other plunged in grief at the same events happening to the city or the citizens?

Certainly.

Such differences commonly originate in a disagreement about the use of the terms 'mine' and 'not mine,' 'his' and 'not his.'

Exactly so.

And is not that the best-ordered State in which the greatest number of persons apply the terms 'mine' and 'not mine' in the same way to the same thing?

Quite true.

Or that again which most nearly approaches to the condition of the individual—as in the body, when but a finger of one of us is hurt, the whole frame, drawn towards the soul as a centre and forming one kingdom under the ruling power therein, feels the hurt and sympathizes all together with the part affected, and we say that the man has a pain in his finger; and the same expression is used about any other part of the body, which has a sensation of pain at suffering or of pleasure at the alleviation of suffering.

Very true, he replied; and I agree with you that in the best-ordered State there is the nearest approach to this common feeling which you describe.

Then when any one of the citizens experiences any good or evil, the whole State will make his case their own, and will either rejoice or sorrow with him?

Yes, he said, that is what will happen in a well-ordered State.

It will now be time, I said, for us to return to our State and see whether this or some other form is most in accordance with these fundamental principles.

Very good.

Our State like every other has rulers and subjects?

True.

All of whom will call one another citizens?

Of course.

But is there not another name which people give to their rulers in other States?

Generally they call them masters, but in democratic States they simply call them rulers.

And in our State what other name besides that of citizens do the people give the rulers?

They are called saviours and helpers, he replied.

And what do the rulers call the people?

Their maintainers and foster-fathers.

And what do they call them in other States?

Slaves.

And what do the rulers call one another in other States?

Fellow-rulers.

And what in ours?

Fellow-guardians.

Did you ever know an example in any other State of a ruler who would speak of one of his colleagues as his friend and of another as not being his friend?

Yes, very often.

And the friend he regards and describes as one in whom he has an interest, and the other as a stranger in whom he has no interest?

Exactly.

But would any of your guardians think or speak of any other guardian as a stranger?

Certainly he would not; for every one whom they meet will be regarded by them either as a brother or sister, or father or mother, or son or daughter, or as the child or parent of those who are thus connected with him.

Capital, I said; but let me ask you once more: Shall they be a family in name only; or shall they in all their actions be true to the name? For example, in the use of the word 'father,' would the care of a father be implied and the filial reverence and duty and obedience to him which the law commands; and is the violator of these duties to be regarded as an impious and unrighteous person who is not likely to receive much good either at the hands of God or of man? Are these to be or not to be the strains which the children will hear repeated in their ears by all the citizens about those who are intimated to them to be their parents and the rest of their kinsfolk?

These, he said, and none other; for what can be more ridiculous than for them to utter the names of family ties with the lips only and not to act in the spirit of them?

Then in our city the language of harmony and concord will be more often heard than in any other. As I was describing before, when any one is well or ill, the universal word will be 'with me it is well' or 'it is ill.'

Most true.

And agreeably to this mode of thinking and speaking, were we not saying that they will have their pleasures and pains in common?

Yes, and so they will.

And they will have a common interest in the same thing which they will alike call 'my own,' and having this common interest they will have a common feeling of pleasure and pain?

Yes, far more so than in other States.

And the reason of this, over and above the general constitution of the State, will be that the guardians will have a community of women and children?

That will be the chief reason.

And this unity of feeling we admitted to be the greatest good, as was implied in our own comparison of a well-ordered State to the relation of the body and the members, when affected by pleasure or pain?

That we acknowledged, and very rightly.

Then the community of wives and children among our citizens is clearly the source of the greatest good to the State?

Certainly.

And this agrees with the other principle which we were affirming,—that the guardians were not to have houses or lands or any other property; their pay was to be their food, which they were to receive from the other citizens, and they were to have no private expenses; for we intended them to preserve their true character of guardians.

Right, he replied.

Both the community of property and the community of families, as I am saying, tend to make them more truly guardians; they will not tear the city in pieces by differing about 'mine' and 'not mine;' each man dragging any acquisition which he has made into a separate house of his own, where he has a separate wife and children and private pleasures and pains; but all will be affected as far as may be by the same pleasures and pains because they are all of one opinion about what is near and dear to them, and therefore they all tend towards a common end.

Certainly, he replied.

And as they have nothing but their persons which they can call their own, suits and complaints will have no existence among them; they will be delivered from all those quarrels of which money or children or relations are the occasion.

Of course they will.

Neither will trials for assault or insult ever be likely to occur among them. For that equals should defend themselves against equals we shall maintain to be honourable and right; we shall make the protection of the person a matter of necessity.

That is good, he said.

Yes; and there is a further good in the law; viz. that if a man has a quarrel with another he will satisfy his resentment then and there, and not proceed to more dangerous lengths.

Certainly.

To the elder shall be assigned the duty of ruling and chastising the younger.

Clearly.

Nor can there be a doubt that the younger will not strike or do any other violence to an elder, unless the magistrates command him; nor will he slight him in any way. For there are two guardians, shame and fear, mighty to prevent him: shame, which makes men refrain from laying hands on those who are to them in the relation of parents; fear, that the injured one will be succoured by the others who are his brothers, sons, fathers.

That is true, he replied.

Then in every way the laws will help the citizens to keep the peace with one another?

Yes, there will be no want of peace.

And as the guardians will never quarrel among themselves there will be no danger of the rest of the city being divided either against them or against one another.

None whatever.

I hardly like even to mention the little meannesses of which they will be rid, for they are beneath notice: such, for example, as the flattery of the rich by the poor, and all the pains and pangs which men experience in bringing up a family, and in finding money to buy necessaries for their household, borrowing and then repudiating, getting how they can, and giving the money into the hands of women and slaves to keep—the many evils of so many kinds which people suffer in this way are mean enough and obvious enough, and not worth speaking of.

Yes, he said, a man has no need of eyes in order to perceive that.

And from all these evils they will be delivered, and their life will be blessed as the life of Olympic victors and yet more blessed.

How so?

The Olympic victor, I said, is deemed happy in receiving a part only of the blessedness which is secured to our citizens, who have won a more glorious victory and have a more complete maintenance at the public cost. For the victory which they have won is the salvation of the whole State; and the crown with which they and their children are crowned is the fulness of all that life needs; they receive rewards from the hands of their country while living, and after death have an honourable burial.

Yes, he said, and glorious rewards they are.

Do you remember, I said, how in the course of the previous discussion some one who shall be nameless accused us of making our guardians unhappy—they had nothing and might have possessed all things—to whom we replied that, if an occasion offered, we might perhaps hereafter consider this question, but that, as at present advised, we would make our guardians truly guardians, and that we were fashioning the State with a view to the greatest happiness, not of any particular class, but of the whole?

Yes, I remember.

And what do you say, now that the life of our protectors is made out to be far better and nobler than that of Olympic victors—is the life of shoemakers, or any other artisans, or of husbandmen, to be compared with it?

Certainly not.

At the same time I ought here to repeat what I have said elsewhere, that if any of our guardians shall try to be happy in such a manner that he will cease to be a guardian, and is not content with this safe and harmonious life, which, in our judgment, is of all lives the best, but infatuated by some youthful conceit of happiness which gets up into his head shall seek to appropriate the whole state to himself, then he will have to learn how wisely Hesiod spoke, when he said, 'half is more than the whole.'

If he were to consult me, I should say to him: Stay where you are, when you have the offer of such a life.

You agree then, I said, that men and women are to have a common way of life such as we have described—common education, common children; and they are to watch over the citizens in common whether abiding in the city or going out to war; they are to keep watch together, and to hunt together like dogs; and always and in all things, as far as they are able, women are to share with the men? And in so doing they will do what is best, and will not violate, but preserve the natural relation of the sexes.

I agree with you, he replied.

The enquiry, I said, has yet to be made, whether such a community be found possible—as among other animals, so also among men—and if possible, in what way possible?

You have anticipated the question which I was about to suggest.

There is no difficulty, I said, in seeing how war will be carried on by them.

How?

Why, of course they will go on expeditions together; and will take with them any of their children who are strong enough, that, after the manner of the artisan's child, they may look on at the work which they will have to do when they are grown up; and besides looking on they will have to help and be of use in war, and to wait upon their fathers and mothers. Did you never observe in the arts how the potters' boys look on and help, long before they touch the wheel?

Yes, I have.

And shall potters be more careful in educating their children and in giving them the opportunity of seeing and practising their duties than our guardians will be?

The idea is ridiculous, he said.

There is also the effect on the parents, with whom, as with other animals, the presence of their young ones will be the greatest incentive to valour.

That is quite true, Socrates; and yet if they are defeated, which may often happen in war, how great the danger is! the children will be lost as well as their parents, and the State will never recover.

True, I said; but would you never allow them to run any risk?

I am far from saying that.

Well, but if they are ever to run a risk should they not do so on some occasion when, if they escape disaster, they will be the better for it?

Clearly.

Whether the future soldiers do or do not see war in the days of their youth is a very important matter, for the sake of which some risk may fairly be incurred.

Yes, very important.

This then must be our first step,—to make our children spectators of war; but we must also contrive that they shall be secured against danger; then all will be well.

True.

Their parents may be supposed not to be blind to the risks of war, but to know, as far as human foresight can, what expeditions are safe and what dangerous?

That may be assumed.

And they will take them on the safe expeditions and be cautious about the dangerous ones?

True.

And they will place them under the command of experienced veterans who will be their leaders and teachers?

Very properly.

Still, the dangers of war cannot be always foreseen; there is a good deal of chance about them?

True.

Then against such chances the children must be at once furnished with wings, in order that in the hour of need they may fly away and escape.

What do you mean? he said.

I mean that we must mount them on horses in their earliest youth, and when they have learnt to ride, take them on horseback to see war: the horses must not be spirited and warlike, but the most tractable and yet the swiftest that can be had. In this way they will get an excellent view of what is hereafter to be their own business; and if there is danger they have only to follow their elder leaders and escape.

I believe that you are right, he said.

Next, as to war; what are to be the relations of your soldiers to one another and to their enemies? I should be inclined to propose that the soldier who leaves his rank or throws away his arms, or is guilty of any other act of cowardice, should be degraded into the rank of a husbandman or artisan. What do you think?

By all means, I should say.

And he who allows himself to be taken prisoner may as well be made a present of to his enemies; he is their lawful prey, and let them do what they like with him.

Certainly.

But the hero who has distinguished himself, what shall be done to him? In the first place, he shall receive honour in the army from his youthful comrades; every one of them in succession shall crown him. What do you say?

I approve.

And what do you say to his receiving the right hand of fellowship?

To that too, I agree.

But you will hardly agree to my next proposal.

What is your proposal?

That he should kiss and be kissed by them.

Most certainly, and I should be disposed to go further, and say: Let no one whom he has a mind to kiss refuse to be kissed by him while the expedition lasts. So that if there be a lover in the army, whether his love be youth or maiden, he may be more eager to win the prize of valour.

Capital, I said. That the brave man is to have more wives than others has been already determined: and he is to have first choices in such matters more than others, in order that he may have as many children as possible?

Agreed.

Again, there is another manner in which, according to Homer, brave youths should be honoured; for he tells how Ajax, after he had distinguished himself in battle, was rewarded with long chines, which seems to be a compliment appropriate to a hero in the flower of his age, being not only a tribute of honour but also a very strengthening thing.

Most true, he said.

Then in this, I said, Homer shall be our teacher; and we too, at sacrifices and on the like occasions, will honour the brave according to the measure of their valour, whether men or women, with hymns and those other distinctions which we were mentioning; also with

'seats of precedence, and meats and full cups;'

and in honouring them, we shall be at the same time training them.

That, he replied, is excellent.

Yes, I said; and when a man dies gloriously in war shall we not say, in the first place, that he is of the golden race?

To be sure.

Nay, have we not the authority of Hesiod for affirming that when they are dead

'They are holy angels upon the earth, authors of good, averters of evil, the guardians of speech-gifted men'?

Yes; and we accept his authority.

We must learn of the god how we are to order the sepulture of divine and heroic personages, and what is to be their special distinction; and we must do as he bids?

By all means.

And in ages to come we will reverence them and kneel before their sepulchres as at the graves of heroes. And not only they but any who are deemed pre-eminently good, whether they die from age, or in any other way, shall be admitted to the same honours.

That is very right, he said.

Next, how shall our soldiers treat their enemies? What about this?

In what respect do you mean?

First of all, in regard to slavery? Do you think it right that Hellenes should enslave Hellenic States, or allow others to enslave them, if they can help? Should not their custom be to spare them, considering the danger which there is that the whole race may one day fall under the yoke of the barbarians?

To spare them is infinitely better.

Then no Hellene should be owned by them as a slave; that is a rule which they will observe and advise the other Hellenes to observe.

Certainly, he said; they will in this way be united against the barbarians and will keep their hands off one another.

Next as to the slain; ought the conquerors, I said, to take anything but their armour? Does not the practice of despoiling an enemy afford an excuse for not facing the battle? Cowards skulk about the dead, pretending that they are fulfilling a duty, and many an army before now has been lost from this love of plunder.

Very true.

And is there not illiberality and avarice in robbing a corpse, and also a degree of meanness and womanishness in making an enemy of the dead body when the real enemy has flown away and left only his fighting gear behind him,—is not this rather like a dog who cannot get at his assailant, quarrelling with the stones which strike him instead?

Very like a dog, he said.

Then we must abstain from spoiling the dead or hindering their burial?

Yes, he replied, we most certainly must.

Neither shall we offer up arms at the temples of the gods, least of all the arms of Hellenes, if we care to maintain good feeling with other Hellenes; and, indeed, we have reason to fear that the offering of spoils taken from kinsmen may be a pollution unless commanded by the god himself?

Very true.

Again, as to the devastation of Hellenic territory or the burning of houses, what is to be the practice?

May I have the pleasure, he said, of hearing your opinion?

Both should be forbidden, in my judgment; I would take the annual produce and no more. Shall I tell you why?

Pray do.

Why, you see, there is a difference in the names 'discord' and 'war,' and I imagine that there is also a difference in their natures; the one is expressive of what is internal and domestic, the other of what is external and foreign; and the first of the two is termed discord, and only the second, war.

That is a very proper distinction, he replied.

And may I not observe with equal propriety that the Hellenic race is all united together by ties of blood and friendship, and alien and strange to the barbarians?

Very good, he said.

And therefore when Hellenes fight with barbarians and barbarians with Hellenes, they will be described by us as being at war when they fight, and by nature enemies, and this kind of antagonism should be called war; but when Hellenes fight with one another we shall say that Hellas is then in a state of disorder and discord, they being by nature friends; and such enmity is to be called discord.

I agree.

Consider then, I said, when that which we have acknowledged to be discord occurs, and a city is divided, if both parties destroy the lands and burn the houses of one another, how wicked does the strife appear! No true lover of his country would bring himself to tear in pieces his own nurse and mother: There might be reason in the conqueror depriving the conquered of their harvest, but still they would have the idea of peace in their hearts and would not mean to go on fighting for ever.

Yes, he said, that is a better temper than the other.

And will not the city, which you are founding, be an Hellenic city?

It ought to be, he replied.

Then will not the citizens be good and civilized?

Yes, very civilized.

And will they not be lovers of Hellas, and think of Hellas as their own land, and share in the common temples?

Most certainly.

And any difference which arises among them will be regarded by them as discord only—a quarrel among friends, which is not to be called a war?

Certainly not.

Then they will quarrel as those who intend some day to be reconciled?

Certainly.

They will use friendly correction, but will not enslave or destroy their opponents; they will be correctors, not enemies?

Just so.

And as they are Hellenes themselves they will not devastate Hellas, nor will they burn houses, nor ever suppose that the whole population of a city—men, women, and children—are equally their enemies, for they know that the guilt of war is always confined to a few persons and that the many are their friends. And for all these reasons they will be unwilling to waste their lands and rase their houses; their enmity to them will only last until the many innocent sufferers have compelled the guilty few to give satisfaction?

I agree, he said, that our citizens should thus deal with their Hellenic enemies; and with barbarians as the Hellenes now deal with one another.

Then let us enact this law also for our guardians:—that they are neither to devastate the lands of Hellenes nor to burn their houses.

Agreed; and we may agree also in thinking that these, like all our previous enactments, are very good.

But still I must say, Socrates, that if you are allowed to go on in this way you will entirely forget the other question which at the commencement of this discussion you thrust aside:—Is such an order of things possible, and how, if at all? For I am quite ready to acknowledge that the plan which you propose, if only feasible, would do all sorts of good to the State. I will add, what you have omitted, that your citizens will be the bravest of warriors, and will never leave their ranks, for they will all know one another, and each will call the other father, brother, son; and if you suppose the women to join their armies, whether in the same rank or in the rear, either as a terror to the enemy, or as auxiliaries in case of need, I know that they will then be absolutely invincible; and there are many domestic advantages which might also be mentioned and which I also fully acknowledge: but, as I admit all these advantages and as many more as you please, if only this State of yours were to come into existence, we need say no more about them; assuming then the existence of the State, let us now turn to the question of possibility and ways and means—the rest may be left.

If I loiter for a moment, you instantly make a raid upon me, I said, and have no mercy; I have hardly escaped the first and second waves, and you seem not to be aware that you are now bringing upon me the third, which is the greatest and heaviest. When you have seen and heard the third wave, I think you will be more considerate and will acknowledge that some fear and hesitation was natural respecting a proposal so extraordinary as that which I have now to state and investigate.

The more appeals of this sort which you make, he said, the more determined are we that you shall tell us how such a State is possible: speak out and at once.

Let me begin by reminding you that we found our way hither in the search after justice and injustice.

True, he replied; but what of that?

I was only going to ask whether, if we have discovered them, we are to require that the just man should in nothing fail of absolute justice; or may we be satisfied with an approximation, and the attainment in him of a higher degree of justice than is to be found in other men?

The approximation will be enough.

We were enquiring into the nature of absolute justice and into the character of the perfectly just, and into injustice and the perfectly unjust, that we might have an ideal. We were to look at these in order that we might judge of our own happiness and unhappiness according to the standard which they exhibited and the degree in which we resembled them, but not with any view of showing that they could exist in fact.

True, he said.

Would a painter be any the worse because, after having delineated with consummate art an ideal of a perfectly beautiful man, he was unable to show that any such man could ever have existed?

He would be none the worse.

Well, and were we not creating an ideal of a perfect State?

To be sure.

And is our theory a worse theory because we are unable to prove the possibility of a city being ordered in the manner described?

Surely not, he replied.

That is the truth, I said. But if, at your request, I am to try and show how and under what conditions the possibility is highest, I must ask you, having this in view, to repeat your former admissions.

What admissions?

I want to know whether ideals are ever fully realized in language? Does not the word express more than the fact, and must not the actual, whatever a man may think, always, in the nature of things, fall short of the truth? What do you say?

I agree.

Then you must not insist on my proving that the actual State will in every respect coincide with the ideal: if we are only able to discover how a city may be governed nearly as we proposed, you will admit that we have discovered the possibility which you demand; and will be contented. I am sure that I should be contented—will not you?

Yes, I will.

Let me next endeavour to show what is that fault in States which is the cause of their present maladministration, and what is the least change which will enable a State to pass into the truer form; and let the change, if possible, be of one thing only, or, if not, of two; at any rate, let the changes be as few and slight as possible.

Certainly, he replied.

I think, I said, that there might be a reform of the State if only one change were made, which is not a slight or easy though still a possible one.

What is it? he said.

Now then, I said, I go to meet that which I liken to the greatest of the waves; yet shall the word be spoken, even though the wave break and drown me in laughter and dishonour; and do you mark my words.

Proceed.

I said: 'Until philosophers are kings, or the kings and princes of this world have the spirit and power of philosophy, and political greatness and wisdom meet in one, and those commoner natures who pursue either to the exclusion of the other are compelled to stand aside, cities will never have rest from their evils,—nor the human race, as I believe,—and then only will this our State have a possibility of life and behold the light of day.' Such was the thought, my dear Glaucon, which I would fain have uttered if it had not seemed too extravagant; for to be convinced that in no other State can there be happiness private or public is indeed a hard thing.

Socrates, what do you mean? I would have you consider that the word which you have uttered is one at which numerous persons, and very respectable persons too, in a figure pulling off their coats all in a moment, and seizing any weapon that comes to hand, will run at you might and main, before you know where you are, intending to do heaven knows what; and if you don't prepare an answer, and put yourself in motion, you will be 'pared by their fine wits,' and no mistake.

You got me into the scrape, I said.

And I was quite right; however, I will do all I can to get you out of it; but I can only give you good-will and good advice, and, perhaps, I may be able to fit answers to your questions better than another—that is all. And now, having such an auxiliary, you must do your best to show the unbelievers that you are right.

I ought to try, I said, since you offer me such invaluable assistance. And I think that, if there is to be a chance of our escaping, we must explain to them whom we mean when we say that philosophers are to rule in the State; then we shall be able to defend ourselves: There will be discovered to be some natures who ought to study philosophy and to be leaders in the State; and others who are not born to be philosophers, and are meant to be followers rather than leaders.

Then now for a definition, he said.

Follow me, I said, and I hope that I may in some way or other be able to give you a satisfactory explanation.

Proceed.

I dare say that you remember, and therefore I need not remind you, that a lover, if he is worthy of the name, ought to show his love, not to some one part of that which he loves, but to the whole.

I really do not understand, and therefore beg of you to assist my memory.

Another person, I said, might fairly reply as you do; but a man of pleasure like yourself ought to know that all who are in the flower of youth do somehow or other raise a pang or emotion in a lover's breast, and are thought by him to be worthy of his affectionate regards. Is not this a way which you have with the fair: one has a snub nose, and you praise his charming face; the hook-nose of another has, you say, a royal look; while he who is neither snub nor hooked has the grace of regularity: the dark visage is manly, the fair are children of the gods; and as to the sweet 'honey pale,' as they are called, what is the very name but the invention of a lover who talks in diminutives, and is not averse to paleness if appearing on the cheek of youth? In a word, there is no excuse which you will not make, and nothing which you will not say, in order not to lose a single flower that blooms in the spring-time of youth.

If you make me an authority in matters of love, for the sake of the argument, I assent.

And what do you say of lovers of wine? Do you not see them doing the same? They are glad of any pretext of drinking any wine.

Very good.

And the same is true of ambitious men; if they cannot command an army, they are willing to command a file; and if they cannot be honoured by really great and important persons, they are glad to be honoured by lesser and meaner people,—but honour of some kind they must have.

Exactly.

Once more let me ask: Does he who desires any class of goods, desire the whole class or a part only?

The whole.

And may we not say of the philosopher that he is a lover, not of a part of wisdom only, but of the whole?

Yes, of the whole.

And he who dislikes learning, especially in youth, when he has no power of judging what is good and what is not, such an one we maintain not to be a philosopher or a lover of knowledge, just as he who refuses his food is not hungry, and may be said to have a bad appetite and not a good one?

Very true, he said.

Whereas he who has a taste for every sort of knowledge and who is curious to learn and is never satisfied, may be justly termed a philosopher? Am I not right?

Glaucon said: If curiosity makes a philosopher, you will find many a strange being will have a title to the name. All the lovers of sights have a delight in learning, and must therefore be included. Musical amateurs, too, are a folk strangely out of place among philosophers, for they are the last persons in the world who would come to anything like a philosophical discussion, if they could help, while they run about at the Dionysiac festivals as if they had let out their ears to hear every chorus; whether the performance is in town or country—that makes no difference—they are there. Now are we to maintain that all these and any who have similar tastes, as well as the professors of quite minor arts, are philosophers?

Certainly not, I replied; they are only an imitation.

He said: Who then are the true philosophers?

Those, I said, who are lovers of the vision of truth.

That is also good, he said; but I should like to know what you mean?

To another, I replied, I might have a difficulty in explaining; but I am sure that you will admit a proposition which I am about to make.

What is the proposition?

That since beauty is the opposite of ugliness, they are two?

Certainly.

And inasmuch as they are two, each of them is one?

True again.

And of just and unjust, good and evil, and of every other class, the same remark holds: taken singly, each of them is one; but from the various combinations of them with actions and things and with one another, they are seen in all sorts of lights and appear many?

Very true.

And this is the distinction which I draw between the sight-loving, art-loving, practical class and those of whom I am speaking, and who are alone worthy of the name of philosophers.

How do you distinguish them? he said.

The lovers of sounds and sights, I replied, are, as I conceive, fond of fine tones and colours and forms and all the artificial products that are made out of them, but their mind is incapable of seeing or loving absolute beauty.

True, he replied.

Few are they who are able to attain to the sight of this.

Very true.

And he who, having a sense of beautiful things has no sense of absolute beauty, or who, if another lead him to a knowledge of that beauty is unable to follow—of such an one I ask, Is he awake or in a dream only? Reflect: is not the dreamer, sleeping or waking, one who likens dissimilar things, who puts the copy in the place of the real object?

I should certainly say that such an one was dreaming.

But take the case of the other, who recognises the existence of absolute beauty and is able to distinguish the idea from the objects which participate in the idea, neither putting the objects in the place of the idea nor the idea in the place of the objects—is he a dreamer, or is he awake?

He is wide awake.

And may we not say that the mind of the one who knows has knowledge, and that the mind of the other, who opines only, has opinion?

Certainly.

But suppose that the latter should quarrel with us and dispute our statement, can we administer any soothing cordial or advice to him, without revealing to him that there is sad disorder in his wits?

We must certainly offer him some good advice, he replied.

Come, then, and let us think of something to say to him. Shall we begin by assuring him that he is welcome to any knowledge which he may have, and that we are rejoiced at his having it? But we should like to ask him a question: Does he who has knowledge know something or nothing? (You must answer for him.)

I answer that he knows something.

Something that is or is not?

Something that is; for how can that which is not ever be known?

And are we assured, after looking at the matter from many points of view, that absolute being is or may be absolutely known, but that the utterly non-existent is utterly unknown?

Nothing can be more certain.

Good. But if there be anything which is of such a nature as to be and not to be, that will have a place intermediate between pure being and the absolute negation of being?

Yes, between them.

And, as knowledge corresponded to being and ignorance of necessity to not-being, for that intermediate between being and not-being there has to be discovered a corresponding intermediate between ignorance and knowledge, if there be such?

Certainly.

Do we admit the existence of opinion?

Undoubtedly.

As being the same with knowledge, or another faculty?

Another faculty.

Then opinion and knowledge have to do with different kinds of matter corresponding to this difference of faculties?

Yes.

And knowledge is relative to being and knows being. But before I proceed further I will make a division.

What division?

I will begin by placing faculties in a class by themselves: they are powers in us, and in all other things, by which we do as we do. Sight and hearing, for example, I should call faculties. Have I clearly explained the class which I mean?

Yes, I quite understand.

Then let me tell you my view about them. I do not see them, and therefore the distinctions of figure, colour, and the like, which enable me to discern the differences of some things, do not apply to them. In speaking of a faculty I think only of its sphere and its result; and that which has the same sphere and the same result I call the same faculty, but that which has another sphere and another result I call different. Would that be your way of speaking?

Yes.

And will you be so very good as to answer one more question? Would you say that knowledge is a faculty, or in what class would you place it?

Certainly knowledge is a faculty, and the mightiest of all faculties.

And is opinion also a faculty?

Certainly, he said; for opinion is that with which we are able to form an opinion.

And yet you were acknowledging a little while ago that knowledge is not the same as opinion?

Why, yes, he said: how can any reasonable being ever identify that which is infallible with that which errs?

An excellent answer, proving, I said, that we are quite conscious of a distinction between them.

Yes.

Then knowledge and opinion having distinct powers have also distinct spheres or subject-matters?

That is certain.

Being is the sphere or subject-matter of knowledge, and knowledge is to know the nature of being?

Yes.

And opinion is to have an opinion?

Yes.

And do we know what we opine? or is the subject-matter of opinion the same as the subject-matter of knowledge?

Nay, he replied, that has been already disproven; if difference in faculty implies difference in the sphere or subject-matter, and if, as we were saying, opinion and knowledge are distinct faculties, then the sphere of knowledge and of opinion cannot be the same.

Then if being is the subject-matter of knowledge, something else must be the subject-matter of opinion?

Yes, something else.

Well then, is not-being the subject-matter of opinion? or, rather, how can there be an opinion at all about not-being? Reflect: when a man has an opinion, has he not an opinion about something? Can he have an opinion which is an opinion about nothing?

Impossible.

He who has an opinion has an opinion about some one thing?

Yes.

And not-being is not one thing but, properly speaking, nothing?

True.

Of not-being, ignorance was assumed to be the necessary correlative; of being, knowledge?

True, he said.

Then opinion is not concerned either with being or with not-being?

Not with either.

And can therefore neither be ignorance nor knowledge?

That seems to be true.

But is opinion to be sought without and beyond either of them, in a greater clearness than knowledge, or in a greater darkness than ignorance?

In neither.

Then I suppose that opinion appears to you to be darker than knowledge, but lighter than ignorance?

Both; and in no small degree.

And also to be within and between them?

Yes.

Then you would infer that opinion is intermediate?

No question.

But were we not saying before, that if anything appeared to be of a sort which is and is not at the same time, that sort of thing would appear also to lie in the interval between pure being and absolute not-being; and that the corresponding faculty is neither knowledge nor ignorance, but will be found in the interval between them?

True.

And in that interval there has now been discovered something which we call opinion?

There has.

Then what remains to be discovered is the object which partakes equally of the nature of being and not-being, and cannot rightly be termed either, pure and simple; this unknown term, when discovered, we may truly call the subject of opinion, and assign each to their proper faculty,—the extremes to the faculties of the extremes and the mean to the faculty of the mean.

True.

This being premised, I would ask the gentleman who is of opinion that there is no absolute or unchangeable idea of beauty—in whose opinion the beautiful is the manifold—he, I say, your lover of beautiful sights, who cannot bear to be told that the beautiful is one, and the just is one, or that anything is one—to him I would appeal, saying, Will you be so very kind, sir, as to tell us whether, of all these beautiful things, there is one which will not be found ugly; or of the just, which will not be found unjust; or of the holy, which will not also be unholy?

No, he replied; the beautiful will in some point of view be found ugly; and the same is true of the rest.

And may not the many which are doubles be also halves?—doubles, that is, of one thing, and halves of another?

Quite true.

And things great and small, heavy and light, as they are termed, will not be denoted by these any more than by the opposite names?

True; both these and the opposite names will always attach to all of them.

And can any one of those many things which are called by particular names be said to be this rather than not to be this?

He replied: They are like the punning riddles which are asked at feasts or the children's puzzle about the eunuch aiming at the bat, with what he hit him, as they say in the puzzle, and upon what the bat was sitting. The individual objects of which I am speaking are also a riddle, and have a double sense: nor can you fix them in your mind, either as being or not-being, or both, or neither.

Then what will you do with them? I said. Can they have a better place than between being and not-being? For they are clearly not in greater darkness or negation than not-being, or more full of light and existence than being.

That is quite true, he said.

Thus then we seem to have discovered that the many ideas which the multitude entertain about the beautiful and about all other things are tossing about in some region which is half-way between pure being and pure not-being?

We have.

Yes; and we had before agreed that anything of this kind which we might find was to be described as matter of opinion, and not as matter of knowledge; being the intermediate flux which is caught and detained by the intermediate faculty.

Quite true.

Then those who see the many beautiful, and who yet neither see absolute beauty, nor can follow any guide who points the way thither; who see the many just, and not absolute justice, and the like,—such persons may be said to have opinion but not knowledge?

That is certain.

But those who see the absolute and eternal and immutable may be said to know, and not to have opinion only?

Neither can that be denied.

The one love and embrace the subjects of knowledge, the other those of opinion? The latter are the same, as I dare say you will remember, who listened to sweet sounds and gazed upon fair colours, but would not tolerate the existence of absolute beauty.

Yes, I remember.

Shall we then be guilty of any impropriety in calling them lovers of opinion rather than lovers of wisdom, and will they be very angry with us for thus describing them?

I shall tell them not to be angry; no man should be angry at what is true.

But those who love the truth in each thing are to be called lovers of wisdom and not lovers of opinion.

Assuredly.</pre>
</div>
<div created="20150302203922363" modified="20150302213050089" tags="" title="Book VI (Jowett translation)">
<pre>And thus, Glaucon, after the argument has gone a weary way, the true and the false philosophers have at length appeared in view.

I do not think, he said, that the way could have been shortened.

I suppose not, I said; and yet I believe that we might have had a better view of both of them if the discussion could have been confined to this one subject and if there were not many other questions awaiting us, which he who desires to see in what respect the life of the just differs from that of the unjust must consider.

And what is the next question? he asked.

Surely, I said, the one which follows next in order. Inasmuch as philosophers only are able to grasp the eternal and unchangeable, and those who wander in the region of the many and variable are not philosophers, I must ask you which of the two classes should be the rulers of our State?

And how can we rightly answer that question?

Whichever of the two are best able to guard the laws and institutions of our State—let them be our guardians.

Very good.

Neither, I said, can there be any question that the guardian who is to keep anything should have eyes rather than no eyes?

There can be no question of that.

And are not those who are verily and indeed wanting in the knowledge of the true being of each thing, and who have in their souls no clear pattern, and are unable as with a painter's eye to look at the absolute truth and to that original to repair, and having perfect vision of the other world to order the laws about beauty, goodness, justice in this, if not already ordered, and to guard and preserve the order of them—are not such persons, I ask, simply blind?

Truly, he replied, they are much in that condition.

And shall they be our guardians when there are others who, besides being their equals in experience and falling short of them in no particular of virtue, also know the very truth of each thing?

There can be no reason, he said, for rejecting those who have this greatest of all great qualities; they must always have the first place unless they fail in some other respect.

Suppose then, I said, that we determine how far they can unite this and the other excellences.

By all means.

In the first place, as we began by observing, the nature of the philosopher has to be ascertained. We must come to an understanding about him, and, when we have done so, then, if I am not mistaken, we shall also acknowledge that such an union of qualities is possible, and that those in whom they are united, and those only, should be rulers in the State.

What do you mean?

Let us suppose that philosophical minds always love knowledge of a sort which shows them the eternal nature not varying from generation and corruption.

Agreed.

And further, I said, let us agree that they are lovers of all true being; there is no part whether greater or less, or more or less honourable, which they are willing to renounce; as we said before of the lover and the man of ambition.

True.

And if they are to be what we were describing, is there not another quality which they should also possess?

What quality?

Truthfulness: they will never intentionally receive into their mind falsehood, which is their detestation, and they will love the truth.

Yes, that may be safely affirmed of them.

'May be,' my friend, I replied, is not the word; say rather 'must be affirmed:' for he whose nature is amorous of anything cannot help loving all that belongs or is akin to the object of his affections.

Right, he said.

And is there anything more akin to wisdom than truth?

How can there be?

Can the same nature be a lover of wisdom and a lover of falsehood?

Never.

The true lover of learning then must from his earliest youth, as far as in him lies, desire all truth?

Assuredly.

But then again, as we know by experience, he whose desires are strong in one direction will have them weaker in others; they will be like a stream which has been drawn off into another channel.

True.

He whose desires are drawn towards knowledge in every form will be absorbed in the pleasures of the soul, and will hardly feel bodily pleasure—I mean, if he be a true philosopher and not a sham one.

That is most certain.

Such an one is sure to be temperate and the reverse of covetous; for the motives which make another man desirous of having and spending, have no place in his character.

Very true.

Another criterion of the philosophical nature has also to be considered.

What is that?

There should be no secret corner of illiberality; nothing can be more antagonistic than meanness to a soul which is ever longing after the whole of things both divine and human.

Most true, he replied.

Then how can he who has magnificence of mind and is the spectator of all time and all existence, think much of human life?

He cannot.

Or can such an one account death fearful?

No indeed.

Then the cowardly and mean nature has no part in true philosophy?

Certainly not.

Or again: can he who is harmoniously constituted, who is not covetous or mean, or a boaster, or a coward—can he, I say, ever be unjust or hard in his dealings?

Impossible.

Then you will soon observe whether a man is just and gentle, or rude and unsociable; these are the signs which distinguish even in youth the philosophical nature from the unphilosophical.

True.

There is another point which should be remarked.

What point?

Whether he has or has not a pleasure in learning; for no one will love that which gives him pain, and in which after much toil he makes little progress.

Certainly not.

And again, if he is forgetful and retains nothing of what he learns, will he not be an empty vessel?

That is certain.

Labouring in vain, he must end in hating himself and his fruitless occupation? Yes.

Then a soul which forgets cannot be ranked among genuine philosophic natures; we must insist that the philosopher should have a good memory?

Certainly.

And once more, the inharmonious and unseemly nature can only tend to disproportion?

Undoubtedly.

And do you consider truth to be akin to proportion or to disproportion?

To proportion.

Then, besides other qualities, we must try to find a naturally well-proportioned and gracious mind, which will move spontaneously towards the true being of everything.

Certainly.

Well, and do not all these qualities, which we have been enumerating, go together, and are they not, in a manner, necessary to a soul, which is to have a full and perfect participation of being?

They are absolutely necessary, he replied.

And must not that be a blameless study which he only can pursue who has the gift of a good memory, and is quick to learn,—noble, gracious, the friend of truth, justice, courage, temperance, who are his kindred?

The god of jealousy himself, he said, could find no fault with such a study.

And to men like him, I said, when perfected by years and education, and to these only you will entrust the State.

Here Adeimantus interposed and said: To these statements, Socrates, no one can offer a reply; but when you talk in this way, a strange feeling passes over the minds of your hearers: They fancy that they are led astray a little at each step in the argument, owing to their own want of skill in asking and answering questions; these littles accumulate, and at the end of the discussion they are found to have sustained a mighty overthrow and all their former notions appear to be turned upside down. And as unskilful players of draughts are at last shut up by their more skilful adversaries and have no piece to move, so they too find themselves shut up at last; for they have nothing to say in this new game of which words are the counters; and yet all the time they are in the right. The observation is suggested to me by what is now occurring. For any one of us might say, that although in words he is not able to meet you at each step of the argument, he sees as a fact that the votaries of philosophy, when they carry on the study, not only in youth as a part of education, but as the pursuit of their maturer years, most of them become strange monsters, not to say utter rogues, and that those who may be considered the best of them are made useless to the world by the very study which you extol.

Well, and do you think that those who say so are wrong?

I cannot tell, he replied; but I should like to know what is your opinion.

Hear my answer; I am of opinion that they are quite right.

Then how can you be justified in saying that cities will not cease from evil until philosophers rule in them, when philosophers are acknowledged by us to be of no use to them?

You ask a question, I said, to which a reply can only be given in a parable.

Yes, Socrates; and that is a way of speaking to which you are not at all accustomed, I suppose.

I perceive, I said, that you are vastly amused at having plunged me into such a hopeless discussion; but now hear the parable, and then you will be still more amused at the meagreness of my imagination: for the manner in which the best men are treated in their own States is so grievous that no single thing on earth is comparable to it; and therefore, if I am to plead their cause, I must have recourse to fiction, and put together a figure made up of many things, like the fabulous unions of goats and stags which are found in pictures. Imagine then a fleet or a ship in which there is a captain who is taller and stronger than any of the crew, but he is a little deaf and has a similar infirmity in sight, and his knowledge of navigation is not much better. The sailors are quarrelling with one another about the steering—every one is of opinion that he has a right to steer, though he has never learned the art of navigation and cannot tell who taught him or when he learned, and will further assert that it cannot be taught, and they are ready to cut in pieces any one who says the contrary. They throng about the captain, begging and praying him to commit the helm to them; and if at any time they do not prevail, but others are preferred to them, they kill the others or throw them overboard, and having first chained up the noble captain's senses with drink or some narcotic drug, they mutiny and take possession of the ship and make free with the stores; thus, eating and drinking, they proceed on their voyage in such manner as might be expected of them. Him who is their partisan and cleverly aids them in their plot for getting the ship out of the captain's hands into their own whether by force or persuasion, they compliment with the name of sailor, pilot, able seaman, and abuse the other sort of man, whom they call a good-for-nothing; but that the true pilot must pay attention to the year and seasons and sky and stars and winds, and whatever else belongs to his art, if he intends to be really qualified for the command of a ship, and that he must and will be the steerer, whether other people like or not—the possibility of this union of authority with the steerer's art has never seriously entered into their thoughts or been made part of their calling. Now in vessels which are in a state of mutiny and by sailors who are mutineers, how will the true pilot be regarded? Will he not be called by them a prater, a star-gazer, a good-for-nothing?

Of course, said Adeimantus.

Then you will hardly need, I said, to hear the interpretation of the figure, which describes the true philosopher in his relation to the State; for you understand already.

Certainly.

Then suppose you now take this parable to the gentleman who is surprised at finding that philosophers have no honour in their cities; explain it to him and try to convince him that their having honour would be far more extraordinary.

I will.

Say to him, that, in deeming the best votaries of philosophy to be useless to the rest of the world, he is right; but also tell him to attribute their uselessness to the fault of those who will not use them, and not to themselves. The pilot should not humbly beg the sailors to be commanded by him—that is not the order of nature; neither are 'the wise to go to the doors of the rich'—the ingenious author of this saying told a lie—but the truth is, that, when a man is ill, whether he be rich or poor, to the physician he must go, and he who wants to be governed, to him who is able to govern. The ruler who is good for anything ought not to beg his subjects to be ruled by him; although the present governors of mankind are of a different stamp; they may be justly compared to the mutinous sailors, and the true helmsmen to those who are called by them good-for-nothings and star-gazers.

Precisely so, he said.

For these reasons, and among men like these, philosophy, the noblest pursuit of all, is not likely to be much esteemed by those of the opposite faction; not that the greatest and most lasting injury is done to her by her opponents, but by her own professing followers, the same of whom you suppose the accuser to say, that the greater number of them are arrant rogues, and the best are useless; in which opinion I agreed.

Yes.

And the reason why the good are useless has now been explained?

True.

Then shall we proceed to show that the corruption of the majority is also unavoidable, and that this is not to be laid to the charge of philosophy any more than the other?

By all means.

And let us ask and answer in turn, first going back to the description of the gentle and noble nature. Truth, as you will remember, was his leader, whom he followed always and in all things; failing in this, he was an impostor, and had no part or lot in true philosophy.

Yes, that was said.

Well, and is not this one quality, to mention no others, greatly at variance with present notions of him?

Certainly, he said.

And have we not a right to say in his defence, that the true lover of knowledge is always striving after being—that is his nature; he will not rest in the multiplicity of individuals which is an appearance only, but will go on—the keen edge will not be blunted, nor the force of his desire abate until he have attained the knowledge of the true nature of every essence by a sympathetic and kindred power in the soul, and by that power drawing near and mingling and becoming incorporate with very being, having begotten mind and truth, he will have knowledge and will live and grow truly, and then, and not till then, will he cease from his travail.

Nothing, he said, can be more just than such a description of him.

And will the love of a lie be any part of a philosopher's nature? Will he not utterly hate a lie?

He will.

And when truth is the captain, we cannot suspect any evil of the band which he leads?

Impossible.

Justice and health of mind will be of the company, and temperance will follow after?

True, he replied.

Neither is there any reason why I should again set in array the philosopher's virtues, as you will doubtless remember that courage, magnificence, apprehension, memory, were his natural gifts. And you objected that, although no one could deny what I then said, still, if you leave words and look at facts, the persons who are thus described are some of them manifestly useless, and the greater number utterly depraved; we were then led to enquire into the grounds of these accusations, and have now arrived at the point of asking why are the majority bad, which question of necessity brought us back to the examination and definition of the true philosopher.

Exactly.

And we have next to consider the corruptions of the philosophic nature, why so many are spoiled and so few escape spoiling—I am speaking of those who were said to be useless but not wicked—and, when we have done with them, we will speak of the imitators of philosophy, what manner of men are they who aspire after a profession which is above them and of which they are unworthy, and then, by their manifold inconsistencies, bring upon philosophy, and upon all philosophers, that universal reprobation of which we speak.

What are these corruptions? he said.

I will see if I can explain them to you. Every one will admit that a nature having in perfection all the qualities which we required in a philosopher, is a rare plant which is seldom seen among men.

Rare indeed.

And what numberless and powerful causes tend to destroy these rare natures!

What causes?

In the first place there are their own virtues, their courage, temperance, and the rest of them, every one of which praiseworthy qualities (and this is a most singular circumstance) destroys and distracts from philosophy the soul which is the possessor of them.

That is very singular, he replied.

Then there are all the ordinary goods of life—beauty, wealth, strength, rank, and great connections in the State—you understand the sort of things—these also have a corrupting and distracting effect.

I understand; but I should like to know more precisely what you mean about them.

Grasp the truth as a whole, I said, and in the right way; you will then have no difficulty in apprehending the preceding remarks, and they will no longer appear strange to you.

And how am I to do so? he asked.

Why, I said, we know that all germs or seeds, whether vegetable or animal, when they fail to meet with proper nutriment or climate or soil, in proportion to their vigour, are all the more sensitive to the want of a suitable environment, for evil is a greater enemy to what is good than to what is not.

Very true.

There is reason in supposing that the finest natures, when under alien conditions, receive more injury than the inferior, because the contrast is greater.

Certainly.

And may we not say, Adeimantus, that the most gifted minds, when they are ill-educated, become pre-eminently bad? Do not great crimes and the spirit of pure evil spring out of a fulness of nature ruined by education rather than from any inferiority, whereas weak natures are scarcely capable of any very great good or very great evil?

There I think that you are right.

And our philosopher follows the same analogy—he is like a plant which, having proper nurture, must necessarily grow and mature into all virtue, but, if sown and planted in an alien soil, becomes the most noxious of all weeds, unless he be preserved by some divine power. Do you really think, as people so often say, that our youth are corrupted by Sophists, or that private teachers of the art corrupt them in any degree worth speaking of? Are not the public who say these things the greatest of all Sophists? And do they not educate to perfection young and old, men and women alike, and fashion them after their own hearts?

When is this accomplished? he said.

When they meet together, and the world sits down at an assembly, or in a court of law, or a theatre, or a camp, or in any other popular resort, and there is a great uproar, and they praise some things which are being said or done, and blame other things, equally exaggerating both, shouting and clapping their hands, and the echo of the rocks and the place in which they are assembled redoubles the sound of the praise or blame—at such a time will not a young man's heart, as they say, leap within him? Will any private training enable him to stand firm against the overwhelming flood of popular opinion? or will he be carried away by the stream? Will he not have the notions of good and evil which the public in general have—he will do as they do, and as they are, such will he be?

Yes, Socrates; necessity will compel him.

And yet, I said, there is a still greater necessity, which has not been mentioned.

What is that?

The gentle force of attainder or confiscation or death, which, as you are aware, these new Sophists and educators, who are the public, apply when their words are powerless.

Indeed they do; and in right good earnest.

Now what opinion of any other Sophist, or of any private person, can be expected to overcome in such an unequal contest?

None, he replied.

No, indeed, I said, even to make the attempt is a great piece of folly; there neither is, nor has been, nor is ever likely to be, any different type of character which has had no other training in virtue but that which is supplied by public opinion—I speak, my friend, of human virtue only; what is more than human, as the proverb says, is not included: for I would not have you ignorant that, in the present evil state of governments, whatever is saved and comes to good is saved by the power of God, as we may truly say.

I quite assent, he replied.

Then let me crave your assent also to a further observation.

What are you going to say?

Why, that all those mercenary individuals, whom the many call Sophists and whom they deem to be their adversaries, do, in fact, teach nothing but the opinion of the many, that is to say, the opinions of their assemblies; and this is their wisdom. I might compare them to a man who should study the tempers and desires of a mighty strong beast who is fed by him—he would learn how to approach and handle him, also at what times and from what causes he is dangerous or the reverse, and what is the meaning of his several cries, and by what sounds, when another utters them, he is soothed or infuriated; and you may suppose further, that when, by continually attending upon him, he has become perfect in all this, he calls his knowledge wisdom, and makes of it a system or art, which he proceeds to teach, although he has no real notion of what he means by the principles or passions of which he is speaking, but calls this honourable and that dishonourable, or good or evil, or just or unjust, all in accordance with the tastes and tempers of the great brute. Good he pronounces to be that in which the beast delights and evil to be that which he dislikes; and he can give no other account of them except that the just and noble are the necessary, having never himself seen, and having no power of explaining to others the nature of either, or the difference between them, which is immense. By heaven, would not such an one be a rare educator?

Indeed he would.

And in what way does he who thinks that wisdom is the discernment of the tempers and tastes of the motley multitude, whether in painting or music, or, finally, in politics, differ from him whom I have been describing? For when a man consorts with the many, and exhibits to them his poem or other work of art or the service which he has done the State, making them his judges when he is not obliged, the so-called necessity of Diomede will oblige him to produce whatever they praise. And yet the reasons are utterly ludicrous which they give in confirmation of their own notions about the honourable and good. Did you ever hear any of them which were not?

No, nor am I likely to hear.

You recognise the truth of what I have been saying? Then let me ask you to consider further whether the world will ever be induced to believe in the existence of absolute beauty rather than of the many beautiful, or of the absolute in each kind rather than of the many in each kind?

Certainly not.

Then the world cannot possibly be a philosopher?

Impossible.

And therefore philosophers must inevitably fall under the censure of the world?

They must.

And of individuals who consort with the mob and seek to please them?

That is evident.

Then, do you see any way in which the philosopher can be preserved in his calling to the end? and remember what we were saying of him, that he was to have quickness and memory and courage and magnificence—these were admitted by us to be the true philosopher's gifts.

Yes.

Will not such an one from his early childhood be in all things first among all, especially if his bodily endowments are like his mental ones?

Certainly, he said.

And his friends and fellow-citizens will want to use him as he gets older for their own purposes?

No question.

Falling at his feet, they will make requests to him and do him honour and flatter him, because they want to get into their hands now, the power which he will one day possess.

That often happens, he said.

And what will a man such as he is be likely to do under such circumstances, especially if he be a citizen of a great city, rich and noble, and a tall proper youth? Will he not be full of boundless aspirations, and fancy himself able to manage the affairs of Hellenes and of barbarians, and having got such notions into his head will he not dilate and elevate himself in the fulness of vain pomp and senseless pride?

To be sure he will.

Now, when he is in this state of mind, if some one gently comes to him and tells him that he is a fool and must get understanding, which can only be got by slaving for it, do you think that, under such adverse circumstances, he will be easily induced to listen?

Far otherwise.

And even if there be some one who through inherent goodness or natural reasonableness has had his eyes opened a little and is humbled and taken captive by philosophy, how will his friends behave when they think that they are likely to lose the advantage which they were hoping to reap from his companionship? Will they not do and say anything to prevent him from yielding to his better nature and to render his teacher powerless, using to this end private intrigues as well as public prosecutions?

There can be no doubt of it.

And how can one who is thus circumstanced ever become a philosopher?

Impossible.

Then were we not right in saying that even the very qualities which make a man a philosopher may, if he be ill-educated, divert him from philosophy, no less than riches and their accompaniments and the other so-called goods of life?

We were quite right.

Thus, my excellent friend, is brought about all that ruin and failure which I have been describing of the natures best adapted to the best of all pursuits; they are natures which we maintain to be rare at any time; this being the class out of which come the men who are the authors of the greatest evil to States and individuals; and also of the greatest good when the tide carries them in that direction; but a small man never was the doer of any great thing either to individuals or to States.

That is most true, he said.

And so philosophy is left desolate, with her marriage rite incomplete: for her own have fallen away and forsaken her, and while they are leading a false and unbecoming life, other unworthy persons, seeing that she has no kinsmen to be her protectors, enter in and dishonour her; and fasten upon her the reproaches which, as you say, her reprovers utter, who affirm of her votaries that some are good for nothing, and that the greater number deserve the severest punishment.

That is certainly what people say.

Yes; and what else would you expect, I said, when you think of the puny creatures who, seeing this land open to them—a land well stocked with fair names and showy titles—like prisoners running out of prison into a sanctuary, take a leap out of their trades into philosophy; those who do so being probably the cleverest hands at their own miserable crafts? For, although philosophy be in this evil case, still there remains a dignity about her which is not to be found in the arts. And many are thus attracted by her whose natures are imperfect and whose souls are maimed and disfigured by their meannesses, as their bodies are by their trades and crafts. Is not this unavoidable?

Yes.

Are they not exactly like a bald little tinker who has just got out of durance and come into a fortune; he takes a bath and puts on a new coat, and is decked out as a bridegroom going to marry his master's daughter, who is left poor and desolate?

A most exact parallel.

What will be the issue of such marriages? Will they not be vile and bastard?

There can be no question of it.

And when persons who are unworthy of education approach philosophy and make an alliance with her who is in a rank above them what sort of ideas and opinions are likely to be generated? Will they not be sophisms captivating to the ear, having nothing in them genuine, or worthy of or akin to true wisdom?

No doubt, he said.

Then, Adeimantus, I said, the worthy disciples of philosophy will be but a small remnant: perchance some noble and well-educated person, detained by exile in her service, who in the absence of corrupting influences remains devoted to her; or some lofty soul born in a mean city, the politics of which he contemns and neglects; and there may be a gifted few who leave the arts, which they justly despise, and come to her;—or peradventure there are some who are restrained by our friend Theages' bridle; for everything in the life of Theages conspired to divert him from philosophy; but ill-health kept him away from politics. My own case of the internal sign is hardly worth mentioning, for rarely, if ever, has such a monitor been given to any other man. Those who belong to this small class have tasted how sweet and blessed a possession philosophy is, and have also seen enough of the madness of the multitude; and they know that no politician is honest, nor is there any champion of justice at whose side they may fight and be saved. Such an one may be compared to a man who has fallen among wild beasts—he will not join in the wickedness of his fellows, but neither is he able singly to resist all their fierce natures, and therefore seeing that he would be of no use to the State or to his friends, and reflecting that he would have to throw away his life without doing any good either to himself or others, he holds his peace, and goes his own way. He is like one who, in the storm of dust and sleet which the driving wind hurries along, retires under the shelter of a wall; and seeing the rest of mankind full of wickedness, he is content, if only he can live his own life and be pure from evil or unrighteousness, and depart in peace and good-will, with bright hopes.

Yes, he said, and he will have done a great work before he departs.

A great work—yes; but not the greatest, unless he find a State suitable to him; for in a State which is suitable to him, he will have a larger growth and be the saviour of his country, as well as of himself.

The causes why philosophy is in such an evil name have now been sufficiently explained: the injustice of the charges against her has been shown—is there anything more which you wish to say?

Nothing more on that subject, he replied; but I should like to know which of the governments now existing is in your opinion the one adapted to her.

Not any of them, I said; and that is precisely the accusation which I bring against them—not one of them is worthy of the philosophic nature, and hence that nature is warped and estranged;—as the exotic seed which is sown in a foreign land becomes denaturalized, and is wont to be overpowered and to lose itself in the new soil, even so this growth of philosophy, instead of persisting, degenerates and receives another character. But if philosophy ever finds in the State that perfection which she herself is, then will be seen that she is in truth divine, and that all other things, whether natures of men or institutions, are but human;—and now, I know, that you are going to ask, What that State is:

No, he said; there you are wrong, for I was going to ask another question—whether it is the State of which we are the founders and inventors, or some other?

Yes, I replied, ours in most respects; but you may remember my saying before, that some living authority would always be required in the State having the same idea of the constitution which guided you when as legislator you were laying down the laws.

That was said, he replied.

Yes, but not in a satisfactory manner; you frightened us by interposing objections, which certainly showed that the discussion would be long and difficult; and what still remains is the reverse of easy.

What is there remaining?

The question how the study of philosophy may be so ordered as not to be the ruin of the State: All great attempts are attended with risk; 'hard is the good,' as men say.

Still, he said, let the point be cleared up, and the enquiry will then be complete.

I shall not be hindered, I said, by any want of will, but, if at all, by a want of power: my zeal you may see for yourselves; and please to remark in what I am about to say how boldly and unhesitatingly I declare that States should pursue philosophy, not as they do now, but in a different spirit.

In what manner?

At present, I said, the students of philosophy are quite young; beginning when they are hardly past childhood, they devote only the time saved from moneymaking and housekeeping to such pursuits; and even those of them who are reputed to have most of the philosophic spirit, when they come within sight of the great difficulty of the subject, I mean dialectic, take themselves off. In after life when invited by some one else, they may, perhaps, go and hear a lecture, and about this they make much ado, for philosophy is not considered by them to be their proper business: at last, when they grow old, in most cases they are extinguished more truly than Heracleitus' sun, inasmuch as they never light up again. (Heraclitus said that the sun was extinguished every evening and relighted every morning.)

But what ought to be their course?

Just the opposite. In childhood and youth their study, and what philosophy they learn, should be suited to their tender years: during this period while they are growing up towards manhood, the chief and special care should be given to their bodies that they may have them to use in the service of philosophy; as life advances and the intellect begins to mature, let them increase the gymnastics of the soul; but when the strength of our citizens fails and is past civil and military duties, then let them range at will and engage in no serious labour, as we intend them to live happily here, and to crown this life with a similar happiness in another.

How truly in earnest you are, Socrates! he said; I am sure of that; and yet most of your hearers, if I am not mistaken, are likely to be still more earnest in their opposition to you, and will never be convinced; Thrasymachus least of all.

Do not make a quarrel, I said, between Thrasymachus and me, who have recently become friends, although, indeed, we were never enemies; for I shall go on striving to the utmost until I either convert him and other men, or do something which may profit them against the day when they live again, and hold the like discourse in another state of existence.

You are speaking of a time which is not very near.

Rather, I replied, of a time which is as nothing in comparison with eternity. Nevertheless, I do not wonder that the many refuse to believe; for they have never seen that of which we are now speaking realized; they have seen only a conventional imitation of philosophy, consisting of words artificially brought together, not like these of ours having a natural unity. But a human being who in word and work is perfectly moulded, as far as he can be, into the proportion and likeness of virtue—such a man ruling in a city which bears the same image, they have never yet seen, neither one nor many of them—do you think that they ever did?

No indeed.

No, my friend, and they have seldom, if ever, heard free and noble sentiments; such as men utter when they are earnestly and by every means in their power seeking after truth for the sake of knowledge, while they look coldly on the subtleties of controversy, of which the end is opinion and strife, whether they meet with them in the courts of law or in society.

They are strangers, he said, to the words of which you speak.

And this was what we foresaw, and this was the reason why truth forced us to admit, not without fear and hesitation, that neither cities nor States nor individuals will ever attain perfection until the small class of philosophers whom we termed useless but not corrupt are providentially compelled, whether they will or not, to take care of the State, and until a like necessity be laid on the State to obey them; or until kings, or if not kings, the sons of kings or princes, are divinely inspired with a true love of true philosophy. That either or both of these alternatives are impossible, I see no reason to affirm: if they were so, we might indeed be justly ridiculed as dreamers and visionaries. Am I not right?

Quite right.

If then, in the countless ages of the past, or at the present hour in some foreign clime which is far away and beyond our ken, the perfected philosopher is or has been or hereafter shall be compelled by a superior power to have the charge of the State, we are ready to assert to the death, that this our constitution has been, and is—yea, and will be whenever the Muse of Philosophy is queen. There is no impossibility in all this; that there is a difficulty, we acknowledge ourselves.

My opinion agrees with yours, he said.

But do you mean to say that this is not the opinion of the multitude?

I should imagine not, he replied.

O my friend, I said, do not attack the multitude: they will change their minds, if, not in an aggressive spirit, but gently and with the view of soothing them and removing their dislike of over-education, you show them your philosophers as they really are and describe as you were just now doing their character and profession, and then mankind will see that he of whom you are speaking is not such as they supposed—if they view him in this new light, they will surely change their notion of him, and answer in another strain. Who can be at enmity with one who loves them, who that is himself gentle and free from envy will be jealous of one in whom there is no jealousy? Nay, let me answer for you, that in a few this harsh temper may be found but not in the majority of mankind.

I quite agree with you, he said.

And do you not also think, as I do, that the harsh feeling which the many entertain towards philosophy originates in the pretenders, who rush in uninvited, and are always abusing them, and finding fault with them, who make persons instead of things the theme of their conversation? and nothing can be more unbecoming in philosophers than this.

It is most unbecoming.

For he, Adeimantus, whose mind is fixed upon true being, has surely no time to look down upon the affairs of earth, or to be filled with malice and envy, contending against men; his eye is ever directed towards things fixed and immutable, which he sees neither injuring nor injured by one another, but all in order moving according to reason; these he imitates, and to these he will, as far as he can, conform himself. Can a man help imitating that with which he holds reverential converse?

Impossible.

And the philosopher holding converse with the divine order, becomes orderly and divine, as far as the nature of man allows; but like every one else, he will suffer from detraction.

Of course.

And if a necessity be laid upon him of fashioning, not only himself, but human nature generally, whether in States or individuals, into that which he beholds elsewhere, will he, think you, be an unskilful artificer of justice, temperance, and every civil virtue?

Anything but unskilful.

And if the world perceives that what we are saying about him is the truth, will they be angry with philosophy? Will they disbelieve us, when we tell them that no State can be happy which is not designed by artists who imitate the heavenly pattern?

They will not be angry if they understand, he said. But how will they draw out the plan of which you are speaking?

They will begin by taking the State and the manners of men, from which, as from a tablet, they will rub out the picture, and leave a clean surface. This is no easy task. But whether easy or not, herein will lie the difference between them and every other legislator,—they will have nothing to do either with individual or State, and will inscribe no laws, until they have either found, or themselves made, a clean surface.

They will be very right, he said.

Having effected this, they will proceed to trace an outline of the constitution?

No doubt.

And when they are filling in the work, as I conceive, they will often turn their eyes upwards and downwards: I mean that they will first look at absolute justice and beauty and temperance, and again at the human copy; and will mingle and temper the various elements of life into the image of a man; and this they will conceive according to that other image, which, when existing among men, Homer calls the form and likeness of God.

Very true, he said.

And one feature they will erase, and another they will put in, until they have made the ways of men, as far as possible, agreeable to the ways of God?

Indeed, he said, in no way could they make a fairer picture.

And now, I said, are we beginning to persuade those whom you described as rushing at us with might and main, that the painter of constitutions is such an one as we are praising; at whom they were so very indignant because to his hands we committed the State; and are they growing a little calmer at what they have just heard?

Much calmer, if there is any sense in them.

Why, where can they still find any ground for objection? Will they doubt that the philosopher is a lover of truth and being?

They would not be so unreasonable.

Or that his nature, being such as we have delineated, is akin to the highest good?

Neither can they doubt this.

But again, will they tell us that such a nature, placed under favourable circumstances, will not be perfectly good and wise if any ever was? Or will they prefer those whom we have rejected?

Surely not.

Then will they still be angry at our saying, that, until philosophers bear rule, States and individuals will have no rest from evil, nor will this our imaginary State ever be realized?

I think that they will be less angry.

Shall we assume that they are not only less angry but quite gentle, and that they have been converted and for very shame, if for no other reason, cannot refuse to come to terms?

By all means, he said.

Then let us suppose that the reconciliation has been effected. Will any one deny the other point, that there may be sons of kings or princes who are by nature philosophers?

Surely no man, he said.

And when they have come into being will any one say that they must of necessity be destroyed; that they can hardly be saved is not denied even by us; but that in the whole course of ages no single one of them can escape—who will venture to affirm this?

Who indeed!

But, said I, one is enough; let there be one man who has a city obedient to his will, and he might bring into existence the ideal polity about which the world is so incredulous.

Yes, one is enough.

The ruler may impose the laws and institutions which we have been describing, and the citizens may possibly be willing to obey them?

Certainly.

And that others should approve, of what we approve, is no miracle or impossibility?

I think not.

But we have sufficiently shown, in what has preceded, that all this, if only possible, is assuredly for the best.

We have.

And now we say not only that our laws, if they could be enacted, would be for the best, but also that the enactment of them, though difficult, is not impossible.

Very good.

And so with pain and toil we have reached the end of one subject, but more remains to be discussed;—how and by what studies and pursuits will the saviours of the constitution be created, and at what ages are they to apply themselves to their several studies?

Certainly.

I omitted the troublesome business of the possession of women, and the procreation of children, and the appointment of the rulers, because I knew that the perfect State would be eyed with jealousy and was difficult of attainment; but that piece of cleverness was not of much service to me, for I had to discuss them all the same. The women and children are now disposed of, but the other question of the rulers must be investigated from the very beginning. We were saying, as you will remember, that they were to be lovers of their country, tried by the test of pleasures and pains, and neither in hardships, nor in dangers, nor at any other critical moment were to lose their patriotism—he was to be rejected who failed, but he who always came forth pure, like gold tried in the refiner's fire, was to be made a ruler, and to receive honours and rewards in life and after death. This was the sort of thing which was being said, and then the argument turned aside and veiled her face; not liking to stir the question which has now arisen.

I perfectly remember, he said.

Yes, my friend, I said, and I then shrank from hazarding the bold word; but now let me dare to say—that the perfect guardian must be a philosopher.

Yes, he said, let that be affirmed.

And do not suppose that there will be many of them; for the gifts which were deemed by us to be essential rarely grow together; they are mostly found in shreds and patches.

What do you mean? he said.

You are aware, I replied, that quick intelligence, memory, sagacity, cleverness, and similar qualities, do not often grow together, and that persons who possess them and are at the same time high-spirited and magnanimous are not so constituted by nature as to live orderly and in a peaceful and settled manner; they are driven any way by their impulses, and all solid principle goes out of them.

Very true, he said.

On the other hand, those steadfast natures which can better be depended upon, which in a battle are impregnable to fear and immovable, are equally immovable when there is anything to be learned; they are always in a torpid state, and are apt to yawn and go to sleep over any intellectual toil.

Quite true.

And yet we were saying that both qualities were necessary in those to whom the higher education is to be imparted, and who are to share in any office or command.

Certainly, he said.

And will they be a class which is rarely found?

Yes, indeed.

Then the aspirant must not only be tested in those labours and dangers and pleasures which we mentioned before, but there is another kind of probation which we did not mention—he must be exercised also in many kinds of knowledge, to see whether the soul will be able to endure the highest of all, or will faint under them, as in any other studies and exercises.

Yes, he said, you are quite right in testing him. But what do you mean by the highest of all knowledge?

You may remember, I said, that we divided the soul into three parts; and distinguished the several natures of justice, temperance, courage, and wisdom?

Indeed, he said, if I had forgotten, I should not deserve to hear more.

And do you remember the word of caution which preceded the discussion of them?

To what do you refer?

We were saying, if I am not mistaken, that he who wanted to see them in their perfect beauty must take a longer and more circuitous way, at the end of which they would appear; but that we could add on a popular exposition of them on a level with the discussion which had preceded. And you replied that such an exposition would be enough for you, and so the enquiry was continued in what to me seemed to be a very inaccurate manner; whether you were satisfied or not, it is for you to say.

Yes, he said, I thought and the others thought that you gave us a fair measure of truth.

But, my friend, I said, a measure of such things which in any degree falls short of the whole truth is not fair measure; for nothing imperfect is the measure of anything, although persons are too apt to be contented and think that they need search no further.

Not an uncommon case when people are indolent.

Yes, I said; and there cannot be any worse fault in a guardian of the State and of the laws.

True.

The guardian then, I said, must be required to take the longer circuit, and toil at learning as well as at gymnastics, or he will never reach the highest knowledge of all which, as we were just now saying, is his proper calling.

What, he said, is there a knowledge still higher than this—higher than justice and the other virtues?

Yes, I said, there is. And of the virtues too we must behold not the outline merely, as at present—nothing short of the most finished picture should satisfy us. When little things are elaborated with an infinity of pains, in order that they may appear in their full beauty and utmost clearness, how ridiculous that we should not think the highest truths worthy of attaining the highest accuracy!

A right noble thought; but do you suppose that we shall refrain from asking you what is this highest knowledge?

Nay, I said, ask if you will; but I am certain that you have heard the answer many times, and now you either do not understand me or, as I rather think, you are disposed to be troublesome; for you have often been told that the idea of good is the highest knowledge, and that all other things become useful and advantageous only by their use of this. You can hardly be ignorant that of this I was about to speak, concerning which, as you have often heard me say, we know so little; and, without which, any other knowledge or possession of any kind will profit us nothing. Do you think that the possession of all other things is of any value if we do not possess the good? or the knowledge of all other things if we have no knowledge of beauty and goodness?

Assuredly not.

You are further aware that most people affirm pleasure to be the good, but the finer sort of wits say it is knowledge?

Yes.

And you are aware too that the latter cannot explain what they mean by knowledge, but are obliged after all to say knowledge of the good?

How ridiculous!

Yes, I said, that they should begin by reproaching us with our ignorance of the good, and then presume our knowledge of it—for the good they define to be knowledge of the good, just as if we understood them when they use the term 'good'—this is of course ridiculous.

Most true, he said.

And those who make pleasure their good are in equal perplexity; for they are compelled to admit that there are bad pleasures as well as good.

Certainly.

And therefore to acknowledge that bad and good are the same?

True.

There can be no doubt about the numerous difficulties in which this question is involved.

There can be none.

Further, do we not see that many are willing to do or to have or to seem to be what is just and honourable without the reality; but no one is satisfied with the appearance of good—the reality is what they seek; in the case of the good, appearance is despised by every one.

Very true, he said.

Of this then, which every soul of man pursues and makes the end of all his actions, having a presentiment that there is such an end, and yet hesitating because neither knowing the nature nor having the same assurance of this as of other things, and therefore losing whatever good there is in other things,—of a principle such and so great as this ought the best men in our State, to whom everything is entrusted, to be in the darkness of ignorance?

Certainly not, he said.

I am sure, I said, that he who does not know how the beautiful and the just are likewise good will be but a sorry guardian of them; and I suspect that no one who is ignorant of the good will have a true knowledge of them.

That, he said, is a shrewd suspicion of yours.

And if we only have a guardian who has this knowledge our State will be perfectly ordered?

Of course, he replied; but I wish that you would tell me whether you conceive this supreme principle of the good to be knowledge or pleasure, or different from either?

Aye, I said, I knew all along that a fastidious gentleman like you would not be contented with the thoughts of other people about these matters.

True, Socrates; but I must say that one who like you has passed a lifetime in the study of philosophy should not be always repeating the opinions of others, and never telling his own.

Well, but has any one a right to say positively what he does not know?

Not, he said, with the assurance of positive certainty; he has no right to do that: but he may say what he thinks, as a matter of opinion.

And do you not know, I said, that all mere opinions are bad, and the best of them blind? You would not deny that those who have any true notion without intelligence are only like blind men who feel their way along the road?

Very true.

And do you wish to behold what is blind and crooked and base, when others will tell you of brightness and beauty?

Still, I must implore you, Socrates, said Glaucon, not to turn away just as you are reaching the goal; if you will only give such an explanation of the good as you have already given of justice and temperance and the other virtues, we shall be satisfied.

Yes, my friend, and I shall be at least equally satisfied, but I cannot help fearing that I shall fail, and that my indiscreet zeal will bring ridicule upon me. No, sweet sirs, let us not at present ask what is the actual nature of the good, for to reach what is now in my thoughts would be an effort too great for me. But of the child of the good who is likest him, I would fain speak, if I could be sure that you wished to hear—otherwise, not.

By all means, he said, tell us about the child, and you shall remain in our debt for the account of the parent.

I do indeed wish, I replied, that I could pay, and you receive, the account of the parent, and not, as now, of the offspring only; take, however, this latter by way of interest, and at the same time have a care that I do not render a false account, although I have no intention of deceiving you.

Yes, we will take all the care that we can: proceed.

Yes, I said, but I must first come to an understanding with you, and remind you of what I have mentioned in the course of this discussion, and at many other times.

What?

The old story, that there is a many beautiful and a many good, and so of other things which we describe and define; to all of them the term 'many' is applied.

True, he said.

And there is an absolute beauty and an absolute good, and of other things to which the term 'many' is applied there is an absolute; for they may be brought under a single idea, which is called the essence of each.

Very true.

The many, as we say, are seen but not known, and the ideas are known but not seen.

Exactly.

And what is the organ with which we see the visible things?

The sight, he said.

And with the hearing, I said, we hear, and with the other senses perceive the other objects of sense?

True.

But have you remarked that sight is by far the most costly and complex piece of workmanship which the artificer of the senses ever contrived?

No, I never have, he said.

Then reflect; has the ear or voice need of any third or additional nature in order that the one may be able to hear and the other to be heard?

Nothing of the sort.

No, indeed, I replied; and the same is true of most, if not all, the other senses—you would not say that any of them requires such an addition?

Certainly not.

But you see that without the addition of some other nature there is no seeing or being seen?

How do you mean?

Sight being, as I conceive, in the eyes, and he who has eyes wanting to see; colour being also present in them, still unless there be a third nature specially adapted to the purpose, the owner of the eyes will see nothing and the colours will be invisible.

Of what nature are you speaking?

Of that which you term light, I replied.

True, he said.

Noble, then, is the bond which links together sight and visibility, and great beyond other bonds by no small difference of nature; for light is their bond, and light is no ignoble thing?

Nay, he said, the reverse of ignoble.

And which, I said, of the gods in heaven would you say was the lord of this element? Whose is that light which makes the eye to see perfectly and the visible to appear?

You mean the sun, as you and all mankind say.

May not the relation of sight to this deity be described as follows?

How?

Neither sight nor the eye in which sight resides is the sun?

No.

Yet of all the organs of sense the eye is the most like the sun?

By far the most like.

And the power which the eye possesses is a sort of effluence which is dispensed from the sun?

Exactly.

Then the sun is not sight, but the author of sight who is recognised by sight?

True, he said.

And this is he whom I call the child of the good, whom the good begat in his own likeness, to be in the visible world, in relation to sight and the things of sight, what the good is in the intellectual world in relation to mind and the things of mind:

Will you be a little more explicit? he said.

Why, you know, I said, that the eyes, when a person directs them towards objects on which the light of day is no longer shining, but the moon and stars only, see dimly, and are nearly blind; they seem to have no clearness of vision in them?

Very true.

But when they are directed towards objects on which the sun shines, they see clearly and there is sight in them?

Certainly.

And the soul is like the eye: when resting upon that on which truth and being shine, the soul perceives and understands, and is radiant with intelligence; but when turned towards the twilight of becoming and perishing, then she has opinion only, and goes blinking about, and is first of one opinion and then of another, and seems to have no intelligence?

Just so.

Now, that which imparts truth to the known and the power of knowing to the knower is what I would have you term the idea of good, and this you will deem to be the cause of science, and of truth in so far as the latter becomes the subject of knowledge; beautiful too, as are both truth and knowledge, you will be right in esteeming this other nature as more beautiful than either; and, as in the previous instance, light and sight may be truly said to be like the sun, and yet not to be the sun, so in this other sphere, science and truth may be deemed to be like the good, but not the good; the good has a place of honour yet higher.

What a wonder of beauty that must be, he said, which is the author of science and truth, and yet surpasses them in beauty; for you surely cannot mean to say that pleasure is the good?

God forbid, I replied; but may I ask you to consider the image in another point of view?

In what point of view?

You would say, would you not, that the sun is not only the author of visibility in all visible things, but of generation and nourishment and growth, though he himself is not generation?

Certainly.

In like manner the good may be said to be not only the author of knowledge to all things known, but of their being and essence, and yet the good is not essence, but far exceeds essence in dignity and power.

Glaucon said, with a ludicrous earnestness: By the light of heaven, how amazing!

Yes, I said, and the exaggeration may be set down to you; for you made me utter my fancies.

And pray continue to utter them; at any rate let us hear if there is anything more to be said about the similitude of the sun.

Yes, I said, there is a great deal more.

Then omit nothing, however slight.

I will do my best, I said; but I should think that a great deal will have to be omitted.

I hope not, he said.

You have to imagine, then, that there are two ruling powers, and that one of them is set over the intellectual world, the other over the visible. I do not say heaven, lest you should fancy that I am playing upon the name ('ourhanoz, orhatoz'). May I suppose that you have this distinction of the visible and intelligible fixed in your mind?

I have.

Now take a line which has been cut into two unequal parts, and divide each of them again in the same proportion, and suppose the two main divisions to answer, one to the visible and the other to the intelligible, and then compare the subdivisions in respect of their clearness and want of clearness, and you will find that the first section in the sphere of the visible consists of images. And by images I mean, in the first place, shadows, and in the second place, reflections in water and in solid, smooth and polished bodies and the like: Do you understand?

Yes, I understand.

Imagine, now, the other section, of which this is only the resemblance, to include the animals which we see, and everything that grows or is made.

Very good.

Would you not admit that both the sections of this division have different degrees of truth, and that the copy is to the original as the sphere of opinion is to the sphere of knowledge?

Most undoubtedly.

Next proceed to consider the manner in which the sphere of the intellectual is to be divided.

In what manner?

Thus:—There are two subdivisions, in the lower of which the soul uses the figures given by the former division as images; the enquiry can only be hypothetical, and instead of going upwards to a principle descends to the other end; in the higher of the two, the soul passes out of hypotheses, and goes up to a principle which is above hypotheses, making no use of images as in the former case, but proceeding only in and through the ideas themselves.

I do not quite understand your meaning, he said.

Then I will try again; you will understand me better when I have made some preliminary remarks. You are aware that students of geometry, arithmetic, and the kindred sciences assume the odd and the even and the figures and three kinds of angles and the like in their several branches of science; these are their hypotheses, which they and every body are supposed to know, and therefore they do not deign to give any account of them either to themselves or others; but they begin with them, and go on until they arrive at last, and in a consistent manner, at their conclusion?

Yes, he said, I know.

And do you not know also that although they make use of the visible forms and reason about them, they are thinking not of these, but of the ideals which they resemble; not of the figures which they draw, but of the absolute square and the absolute diameter, and so on—the forms which they draw or make, and which have shadows and reflections in water of their own, are converted by them into images, but they are really seeking to behold the things themselves, which can only be seen with the eye of the mind?

That is true.

And of this kind I spoke as the intelligible, although in the search after it the soul is compelled to use hypotheses; not ascending to a first principle, because she is unable to rise above the region of hypothesis, but employing the objects of which the shadows below are resemblances in their turn as images, they having in relation to the shadows and reflections of them a greater distinctness, and therefore a higher value.

I understand, he said, that you are speaking of the province of geometry and the sister arts.

And when I speak of the other division of the intelligible, you will understand me to speak of that other sort of knowledge which reason herself attains by the power of dialectic, using the hypotheses not as first principles, but only as hypotheses—that is to say, as steps and points of departure into a world which is above hypotheses, in order that she may soar beyond them to the first principle of the whole; and clinging to this and then to that which depends on this, by successive steps she descends again without the aid of any sensible object, from ideas, through ideas, and in ideas she ends.

I understand you, he replied; not perfectly, for you seem to me to be describing a task which is really tremendous; but, at any rate, I understand you to say that knowledge and being, which the science of dialectic contemplates, are clearer than the notions of the arts, as they are termed, which proceed from hypotheses only: these are also contemplated by the understanding, and not by the senses: yet, because they start from hypotheses and do not ascend to a principle, those who contemplate them appear to you not to exercise the higher reason upon them, although when a first principle is added to them they are cognizable by the higher reason. And the habit which is concerned with geometry and the cognate sciences I suppose that you would term understanding and not reason, as being intermediate between opinion and reason.

You have quite conceived my meaning, I said; and now, corresponding to these four divisions, let there be four faculties in the soul—reason answering to the highest, understanding to the second, faith (or conviction) to the third, and perception of shadows to the last—and let there be a scale of them, and let us suppose that the several faculties have clearness in the same degree that their objects have truth.

I understand, he replied, and give my assent, and accept your arrangement.</pre>
</div>
<div created="20150302204241249" modified="20150302213040066" tags="" title="Book VII (Jowett translation)">
<pre>And now, I said, let me show in a figure how far our nature is enlightened or unenlightened:—Behold! human beings living in a underground den, which has a mouth open towards the light and reaching all along the den; here they have been from their childhood, and have their legs and necks chained so that they cannot move, and can only see before them, being prevented by the chains from turning round their heads. Above and behind them a fire is blazing at a distance, and between the fire and the prisoners there is a raised way; and you will see, if you look, a low wall built along the way, like the screen which marionette players have in front of them, over which they show the puppets.

I see.

And do you see, I said, men passing along the wall carrying all sorts of vessels, and statues and figures of animals made of wood and stone and various materials, which appear over the wall? Some of them are talking, others silent.

You have shown me a strange image, and they are strange prisoners.

Like ourselves, I replied; and they see only their own shadows, or the shadows of one another, which the fire throws on the opposite wall of the cave?

True, he said; how could they see anything but the shadows if they were never allowed to move their heads?

And of the objects which are being carried in like manner they would only see the shadows?

Yes, he said.

And if they were able to converse with one another, would they not suppose that they were naming what was actually before them?

Very true.

And suppose further that the prison had an echo which came from the other side, would they not be sure to fancy when one of the passers-by spoke that the voice which they heard came from the passing shadow?

No question, he replied.

To them, I said, the truth would be literally nothing but the shadows of the images.

That is certain.

And now look again, and see what will naturally follow if the prisoners are released and disabused of their error. At first, when any of them is liberated and compelled suddenly to stand up and turn his neck round and walk and look towards the light, he will suffer sharp pains; the glare will distress him, and he will be unable to see the realities of which in his former state he had seen the shadows; and then conceive some one saying to him, that what he saw before was an illusion, but that now, when he is approaching nearer to being and his eye is turned towards more real existence, he has a clearer vision,—what will be his reply? And you may further imagine that his instructor is pointing to the objects as they pass and requiring him to name them,—will he not be perplexed? Will he not fancy that the shadows which he formerly saw are truer than the objects which are now shown to him?

Far truer.

And if he is compelled to look straight at the light, will he not have a pain in his eyes which will make him turn away to take refuge in the objects of vision which he can see, and which he will conceive to be in reality clearer than the things which are now being shown to him?

True, he said.

And suppose once more, that he is reluctantly dragged up a steep and rugged ascent, and held fast until he is forced into the presence of the sun himself, is he not likely to be pained and irritated? When he approaches the light his eyes will be dazzled, and he will not be able to see anything at all of what are now called realities.

Not all in a moment, he said.

He will require to grow accustomed to the sight of the upper world. And first he will see the shadows best, next the reflections of men and other objects in the water, and then the objects themselves; then he will gaze upon the light of the moon and the stars and the spangled heaven; and he will see the sky and the stars by night better than the sun or the light of the sun by day?

Certainly.

Last of all he will be able to see the sun, and not mere reflections of him in the water, but he will see him in his own proper place, and not in another; and he will contemplate him as he is.

Certainly.

He will then proceed to argue that this is he who gives the season and the years, and is the guardian of all that is in the visible world, and in a certain way the cause of all things which he and his fellows have been accustomed to behold?

Clearly, he said, he would first see the sun and then reason about him.

And when he remembered his old habitation, and the wisdom of the den and his fellow-prisoners, do you not suppose that he would felicitate himself on the change, and pity them?

Certainly, he would.

And if they were in the habit of conferring honours among themselves on those who were quickest to observe the passing shadows and to remark which of them went before, and which followed after, and which were together; and who were therefore best able to draw conclusions as to the future, do you think that he would care for such honours and glories, or envy the possessors of them? Would he not say with Homer,

'Better to be the poor servant of a poor master,'

and to endure anything, rather than think as they do and live after their manner?

Yes, he said, I think that he would rather suffer anything than entertain these false notions and live in this miserable manner.

Imagine once more, I said, such an one coming suddenly out of the sun to be replaced in his old situation; would he not be certain to have his eyes full of darkness?

To be sure, he said.

And if there were a contest, and he had to compete in measuring the shadows with the prisoners who had never moved out of the den, while his sight was still weak, and before his eyes had become steady (and the time which would be needed to acquire this new habit of sight might be very considerable), would he not be ridiculous? Men would say of him that up he went and down he came without his eyes; and that it was better not even to think of ascending; and if any one tried to loose another and lead him up to the light, let them only catch the offender, and they would put him to death.

No question, he said.

This entire allegory, I said, you may now append, dear Glaucon, to the previous argument; the prison-house is the world of sight, the light of the fire is the sun, and you will not misapprehend me if you interpret the journey upwards to be the ascent of the soul into the intellectual world according to my poor belief, which, at your desire, I have expressed—whether rightly or wrongly God knows. But, whether true or false, my opinion is that in the world of knowledge the idea of good appears last of all, and is seen only with an effort; and, when seen, is also inferred to be the universal author of all things beautiful and right, parent of light and of the lord of light in this visible world, and the immediate source of reason and truth in the intellectual; and that this is the power upon which he who would act rationally either in public or private life must have his eye fixed.

I agree, he said, as far as I am able to understand you.

Moreover, I said, you must not wonder that those who attain to this beatific vision are unwilling to descend to human affairs; for their souls are ever hastening into the upper world where they desire to dwell; which desire of theirs is very natural, if our allegory may be trusted.

Yes, very natural.

And is there anything surprising in one who passes from divine contemplations to the evil state of man, misbehaving himself in a ridiculous manner; if, while his eyes are blinking and before he has become accustomed to the surrounding darkness, he is compelled to fight in courts of law, or in other places, about the images or the shadows of images of justice, and is endeavouring to meet the conceptions of those who have never yet seen absolute justice?

Anything but surprising, he replied.

Any one who has common sense will remember that the bewilderments of the eyes are of two kinds, and arise from two causes, either from coming out of the light or from going into the light, which is true of the mind's eye, quite as much as of the bodily eye; and he who remembers this when he sees any one whose vision is perplexed and weak, will not be too ready to laugh; he will first ask whether that soul of man has come out of the brighter life, and is unable to see because unaccustomed to the dark, or having turned from darkness to the day is dazzled by excess of light. And he will count the one happy in his condition and state of being, and he will pity the other; or, if he have a mind to laugh at the soul which comes from below into the light, there will be more reason in this than in the laugh which greets him who returns from above out of the light into the den.

That, he said, is a very just distinction.

But then, if I am right, certain professors of education must be wrong when they say that they can put a knowledge into the soul which was not there before, like sight into blind eyes.

They undoubtedly say this, he replied.

Whereas, our argument shows that the power and capacity of learning exists in the soul already; and that just as the eye was unable to turn from darkness to light without the whole body, so too the instrument of knowledge can only by the movement of the whole soul be turned from the world of becoming into that of being, and learn by degrees to endure the sight of being, and of the brightest and best of being, or in other words, of the good.

Very true.

And must there not be some art which will effect conversion in the easiest and quickest manner; not implanting the faculty of sight, for that exists already, but has been turned in the wrong direction, and is looking away from the truth?

Yes, he said, such an art may be presumed.

And whereas the other so-called virtues of the soul seem to be akin to bodily qualities, for even when they are not originally innate they can be implanted later by habit and exercise, the virtue of wisdom more than anything else contains a divine element which always remains, and by this conversion is rendered useful and profitable; or, on the other hand, hurtful and useless. Did you never observe the narrow intelligence flashing from the keen eye of a clever rogue—how eager he is, how clearly his paltry soul sees the way to his end; he is the reverse of blind, but his keen eye-sight is forced into the service of evil, and he is mischievous in proportion to his cleverness?

Very true, he said.

But what if there had been a circumcision of such natures in the days of their youth; and they had been severed from those sensual pleasures, such as eating and drinking, which, like leaden weights, were attached to them at their birth, and which drag them down and turn the vision of their souls upon the things that are below—if, I say, they had been released from these impediments and turned in the opposite direction, the very same faculty in them would have seen the truth as keenly as they see what their eyes are turned to now.

Very likely.

Yes, I said; and there is another thing which is likely, or rather a necessary inference from what has preceded, that neither the uneducated and uninformed of the truth, nor yet those who never make an end of their education, will be able ministers of State; not the former, because they have no single aim of duty which is the rule of all their actions, private as well as public; nor the latter, because they will not act at all except upon compulsion, fancying that they are already dwelling apart in the islands of the blest.

Very true, he replied.

Then, I said, the business of us who are the founders of the State will be to compel the best minds to attain that knowledge which we have already shown to be the greatest of all—they must continue to ascend until they arrive at the good; but when they have ascended and seen enough we must not allow them to do as they do now.

What do you mean?

I mean that they remain in the upper world: but this must not be allowed; they must be made to descend again among the prisoners in the den, and partake of their labours and honours, whether they are worth having or not.

But is not this unjust? he said; ought we to give them a worse life, when they might have a better?

You have again forgotten, my friend, I said, the intention of the legislator, who did not aim at making any one class in the State happy above the rest; the happiness was to be in the whole State, and he held the citizens together by persuasion and necessity, making them benefactors of the State, and therefore benefactors of one another; to this end he created them, not to please themselves, but to be his instruments in binding up the State.

True, he said, I had forgotten.

Observe, Glaucon, that there will be no injustice in compelling our philosophers to have a care and providence of others; we shall explain to them that in other States, men of their class are not obliged to share in the toils of politics: and this is reasonable, for they grow up at their own sweet will, and the government would rather not have them. Being self-taught, they cannot be expected to show any gratitude for a culture which they have never received. But we have brought you into the world to be rulers of the hive, kings of yourselves and of the other citizens, and have educated you far better and more perfectly than they have been educated, and you are better able to share in the double duty. Wherefore each of you, when his turn comes, must go down to the general underground abode, and get the habit of seeing in the dark. When you have acquired the habit, you will see ten thousand times better than the inhabitants of the den, and you will know what the several images are, and what they represent, because you have seen the beautiful and just and good in their truth. And thus our State, which is also yours, will be a reality, and not a dream only, and will be administered in a spirit unlike that of other States, in which men fight with one another about shadows only and are distracted in the struggle for power, which in their eyes is a great good. Whereas the truth is that the State in which the rulers are most reluctant to govern is always the best and most quietly governed, and the State in which they are most eager, the worst.

Quite true, he replied.

And will our pupils, when they hear this, refuse to take their turn at the toils of State, when they are allowed to spend the greater part of their time with one another in the heavenly light?

Impossible, he answered; for they are just men, and the commands which we impose upon them are just; there can be no doubt that every one of them will take office as a stern necessity, and not after the fashion of our present rulers of State.

Yes, my friend, I said; and there lies the point. You must contrive for your future rulers another and a better life than that of a ruler, and then you may have a well-ordered State; for only in the State which offers this, will they rule who are truly rich, not in silver and gold, but in virtue and wisdom, which are the true blessings of life. Whereas if they go to the administration of public affairs, poor and hungering after their own private advantage, thinking that hence they are to snatch the chief good, order there can never be; for they will be fighting about office, and the civil and domestic broils which thus arise will be the ruin of the rulers themselves and of the whole State.

Most true, he replied.

And the only life which looks down upon the life of political ambition is that of true philosophy. Do you know of any other?

Indeed, I do not, he said.

And those who govern ought not to be lovers of the task? For, if they are, there will be rival lovers, and they will fight.

No question.

Who then are those whom we shall compel to be guardians? Surely they will be the men who are wisest about affairs of State, and by whom the State is best administered, and who at the same time have other honours and another and a better life than that of politics?

They are the men, and I will choose them, he replied.

And now shall we consider in what way such guardians will be produced, and how they are to be brought from darkness to light,—as some are said to have ascended from the world below to the gods?

By all means, he replied.

The process, I said, is not the turning over of an oyster-shell (In allusion to a game in which two parties fled or pursued according as an oyster-shell which was thrown into the air fell with the dark or light side uppermost.), but the turning round of a soul passing from a day which is little better than night to the true day of being, that is, the ascent from below, which we affirm to be true philosophy?

Quite so.

And should we not enquire what sort of knowledge has the power of effecting such a change?

Certainly.

What sort of knowledge is there which would draw the soul from becoming to being? And another consideration has just occurred to me: You will remember that our young men are to be warrior athletes?

Yes, that was said.

Then this new kind of knowledge must have an additional quality?

What quality?

Usefulness in war.

Yes, if possible.

There were two parts in our former scheme of education, were there not?

Just so.

There was gymnastic which presided over the growth and decay of the body, and may therefore be regarded as having to do with generation and corruption?

True.

Then that is not the knowledge which we are seeking to discover?

No.

But what do you say of music, which also entered to a certain extent into our former scheme?

Music, he said, as you will remember, was the counterpart of gymnastic, and trained the guardians by the influences of habit, by harmony making them harmonious, by rhythm rhythmical, but not giving them science; and the words, whether fabulous or possibly true, had kindred elements of rhythm and harmony in them. But in music there was nothing which tended to that good which you are now seeking.

You are most accurate, I said, in your recollection; in music there certainly was nothing of the kind. But what branch of knowledge is there, my dear Glaucon, which is of the desired nature; since all the useful arts were reckoned mean by us?

Undoubtedly; and yet if music and gymnastic are excluded, and the arts are also excluded, what remains?

Well, I said, there may be nothing left of our special subjects; and then we shall have to take something which is not special, but of universal application.

What may that be?

A something which all arts and sciences and intelligences use in common, and which every one first has to learn among the elements of education.

What is that?

The little matter of distinguishing one, two, and three—in a word, number and calculation:—do not all arts and sciences necessarily partake of them?

Yes.

Then the art of war partakes of them?

To be sure.

Then Palamedes, whenever he appears in tragedy, proves Agamemnon ridiculously unfit to be a general. Did you never remark how he declares that he had invented number, and had numbered the ships and set in array the ranks of the army at Troy; which implies that they had never been numbered before, and Agamemnon must be supposed literally to have been incapable of counting his own feet—how could he if he was ignorant of number? And if that is true, what sort of general must he have been?

I should say a very strange one, if this was as you say.

Can we deny that a warrior should have a knowledge of arithmetic?

Certainly he should, if he is to have the smallest understanding of military tactics, or indeed, I should rather say, if he is to be a man at all.

I should like to know whether you have the same notion which I have of this study?

What is your notion?

It appears to me to be a study of the kind which we are seeking, and which leads naturally to reflection, but never to have been rightly used; for the true use of it is simply to draw the soul towards being.

Will you explain your meaning? he said.

I will try, I said; and I wish you would share the enquiry with me, and say 'yes' or 'no' when I attempt to distinguish in my own mind what branches of knowledge have this attracting power, in order that we may have clearer proof that arithmetic is, as I suspect, one of them.

Explain, he said.

I mean to say that objects of sense are of two kinds; some of them do not invite thought because the sense is an adequate judge of them; while in the case of other objects sense is so untrustworthy that further enquiry is imperatively demanded.

You are clearly referring, he said, to the manner in which the senses are imposed upon by distance, and by painting in light and shade.

No, I said, that is not at all my meaning.

Then what is your meaning?

When speaking of uninviting objects, I mean those which do not pass from one sensation to the opposite; inviting objects are those which do; in this latter case the sense coming upon the object, whether at a distance or near, gives no more vivid idea of anything in particular than of its opposite. An illustration will make my meaning clearer:—here are three fingers—a little finger, a second finger, and a middle finger.

Very good.

You may suppose that they are seen quite close: And here comes the point.

What is it?

Each of them equally appears a finger, whether seen in the middle or at the extremity, whether white or black, or thick or thin—it makes no difference; a finger is a finger all the same. In these cases a man is not compelled to ask of thought the question what is a finger? for the sight never intimates to the mind that a finger is other than a finger.

True.

And therefore, I said, as we might expect, there is nothing here which invites or excites intelligence.

There is not, he said.

But is this equally true of the greatness and smallness of the fingers? Can sight adequately perceive them? and is no difference made by the circumstance that one of the fingers is in the middle and another at the extremity? And in like manner does the touch adequately perceive the qualities of thickness or thinness, of softness or hardness? And so of the other senses; do they give perfect intimations of such matters? Is not their mode of operation on this wise—the sense which is concerned with the quality of hardness is necessarily concerned also with the quality of softness, and only intimates to the soul that the same thing is felt to be both hard and soft?

You are quite right, he said.

And must not the soul be perplexed at this intimation which the sense gives of a hard which is also soft? What, again, is the meaning of light and heavy, if that which is light is also heavy, and that which is heavy, light?

Yes, he said, these intimations which the soul receives are very curious and require to be explained.

Yes, I said, and in these perplexities the soul naturally summons to her aid calculation and intelligence, that she may see whether the several objects announced to her are one or two.

True.

And if they turn out to be two, is not each of them one and different?

Certainly.

And if each is one, and both are two, she will conceive the two as in a state of division, for if there were undivided they could only be conceived of as one?

True.

The eye certainly did see both small and great, but only in a confused manner; they were not distinguished.

Yes.

Whereas the thinking mind, intending to light up the chaos, was compelled to reverse the process, and look at small and great as separate and not confused.

Very true.

Was not this the beginning of the enquiry 'What is great?' and 'What is small?'

Exactly so.

And thus arose the distinction of the visible and the intelligible.

Most true.

This was what I meant when I spoke of impressions which invited the intellect, or the reverse—those which are simultaneous with opposite impressions, invite thought; those which are not simultaneous do not.

I understand, he said, and agree with you.

And to which class do unity and number belong?

I do not know, he replied.

Think a little and you will see that what has preceded will supply the answer; for if simple unity could be adequately perceived by the sight or by any other sense, then, as we were saying in the case of the finger, there would be nothing to attract towards being; but when there is some contradiction always present, and one is the reverse of one and involves the conception of plurality, then thought begins to be aroused within us, and the soul perplexed and wanting to arrive at a decision asks 'What is absolute unity?' This is the way in which the study of the one has a power of drawing and converting the mind to the contemplation of true being.

And surely, he said, this occurs notably in the case of one; for we see the same thing to be both one and infinite in multitude?

Yes, I said; and this being true of one must be equally true of all number?

Certainly.

And all arithmetic and calculation have to do with number?

Yes.

And they appear to lead the mind towards truth?

Yes, in a very remarkable manner.

Then this is knowledge of the kind for which we are seeking, having a double use, military and philosophical; for the man of war must learn the art of number or he will not know how to array his troops, and the philosopher also, because he has to rise out of the sea of change and lay hold of true being, and therefore he must be an arithmetician.

That is true.

And our guardian is both warrior and philosopher?

Certainly.

Then this is a kind of knowledge which legislation may fitly prescribe; and we must endeavour to persuade those who are to be the principal men of our State to go and learn arithmetic, not as amateurs, but they must carry on the study until they see the nature of numbers with the mind only; nor again, like merchants or retail-traders, with a view to buying or selling, but for the sake of their military use, and of the soul herself; and because this will be the easiest way for her to pass from becoming to truth and being.

That is excellent, he said.

Yes, I said, and now having spoken of it, I must add how charming the science is! and in how many ways it conduces to our desired end, if pursued in the spirit of a philosopher, and not of a shopkeeper!

How do you mean?

I mean, as I was saying, that arithmetic has a very great and elevating effect, compelling the soul to reason about abstract number, and rebelling against the introduction of visible or tangible objects into the argument. You know how steadily the masters of the art repel and ridicule any one who attempts to divide absolute unity when he is calculating, and if you divide, they multiply (Meaning either (1) that they integrate the number because they deny the possibility of fractions; or (2) that division is regarded by them as a process of multiplication, for the fractions of one continue to be units.), taking care that one shall continue one and not become lost in fractions.

That is very true.

Now, suppose a person were to say to them: O my friends, what are these wonderful numbers about which you are reasoning, in which, as you say, there is a unity such as you demand, and each unit is equal, invariable, indivisible,—what would they answer?

They would answer, as I should conceive, that they were speaking of those numbers which can only be realized in thought.

Then you see that this knowledge may be truly called necessary, necessitating as it clearly does the use of the pure intelligence in the attainment of pure truth?

Yes; that is a marked characteristic of it.

And have you further observed, that those who have a natural talent for calculation are generally quick at every other kind of knowledge; and even the dull, if they have had an arithmetical training, although they may derive no other advantage from it, always become much quicker than they would otherwise have been.

Very true, he said.

And indeed, you will not easily find a more difficult study, and not many as difficult.

You will not.

And, for all these reasons, arithmetic is a kind of knowledge in which the best natures should be trained, and which must not be given up.

I agree.

Let this then be made one of our subjects of education. And next, shall we enquire whether the kindred science also concerns us?

You mean geometry?

Exactly so.

Clearly, he said, we are concerned with that part of geometry which relates to war; for in pitching a camp, or taking up a position, or closing or extending the lines of an army, or any other military manoeuvre, whether in actual battle or on a march, it will make all the difference whether a general is or is not a geometrician.

Yes, I said, but for that purpose a very little of either geometry or calculation will be enough; the question relates rather to the greater and more advanced part of geometry—whether that tends in any degree to make more easy the vision of the idea of good; and thither, as I was saying, all things tend which compel the soul to turn her gaze towards that place, where is the full perfection of being, which she ought, by all means, to behold.

True, he said.

Then if geometry compels us to view being, it concerns us; if becoming only, it does not concern us?

Yes, that is what we assert.

Yet anybody who has the least acquaintance with geometry will not deny that such a conception of the science is in flat contradiction to the ordinary language of geometricians.

How so?

They have in view practice only, and are always speaking, in a narrow and ridiculous manner, of squaring and extending and applying and the like—they confuse the necessities of geometry with those of daily life; whereas knowledge is the real object of the whole science.

Certainly, he said.

Then must not a further admission be made?

What admission?

That the knowledge at which geometry aims is knowledge of the eternal, and not of aught perishing and transient.

That, he replied, may be readily allowed, and is true.

Then, my noble friend, geometry will draw the soul towards truth, and create the spirit of philosophy, and raise up that which is now unhappily allowed to fall down.

Nothing will be more likely to have such an effect.

Then nothing should be more sternly laid down than that the inhabitants of your fair city should by all means learn geometry. Moreover the science has indirect effects, which are not small.

Of what kind? he said.

There are the military advantages of which you spoke, I said; and in all departments of knowledge, as experience proves, any one who has studied geometry is infinitely quicker of apprehension than one who has not.

Yes indeed, he said, there is an infinite difference between them.

Then shall we propose this as a second branch of knowledge which our youth will study?

Let us do so, he replied.

And suppose we make astronomy the third—what do you say?

I am strongly inclined to it, he said; the observation of the seasons and of months and years is as essential to the general as it is to the farmer or sailor.

I am amused, I said, at your fear of the world, which makes you guard against the appearance of insisting upon useless studies; and I quite admit the difficulty of believing that in every man there is an eye of the soul which, when by other pursuits lost and dimmed, is by these purified and re-illumined; and is more precious far than ten thousand bodily eyes, for by it alone is truth seen. Now there are two classes of persons: one class of those who will agree with you and will take your words as a revelation; another class to whom they will be utterly unmeaning, and who will naturally deem them to be idle tales, for they see no sort of profit which is to be obtained from them. And therefore you had better decide at once with which of the two you are proposing to argue. You will very likely say with neither, and that your chief aim in carrying on the argument is your own improvement; at the same time you do not grudge to others any benefit which they may receive.

I think that I should prefer to carry on the argument mainly on my own behalf.

Then take a step backward, for we have gone wrong in the order of the sciences.

What was the mistake? he said.

After plane geometry, I said, we proceeded at once to solids in revolution, instead of taking solids in themselves; whereas after the second dimension the third, which is concerned with cubes and dimensions of depth, ought to have followed.

That is true, Socrates; but so little seems to be known as yet about these subjects.

Why, yes, I said, and for two reasons:—in the first place, no government patronises them; this leads to a want of energy in the pursuit of them, and they are difficult; in the second place, students cannot learn them unless they have a director. But then a director can hardly be found, and even if he could, as matters now stand, the students, who are very conceited, would not attend to him. That, however, would be otherwise if the whole State became the director of these studies and gave honour to them; then disciples would want to come, and there would be continuous and earnest search, and discoveries would be made; since even now, disregarded as they are by the world, and maimed of their fair proportions, and although none of their votaries can tell the use of them, still these studies force their way by their natural charm, and very likely, if they had the help of the State, they would some day emerge into light.

Yes, he said, there is a remarkable charm in them. But I do not clearly understand the change in the order. First you began with a geometry of plane surfaces?

Yes, I said.

And you placed astronomy next, and then you made a step backward?

Yes, and I have delayed you by my hurry; the ludicrous state of solid geometry, which, in natural order, should have followed, made me pass over this branch and go on to astronomy, or motion of solids.

True, he said.

Then assuming that the science now omitted would come into existence if encouraged by the State, let us go on to astronomy, which will be fourth.

The right order, he replied. And now, Socrates, as you rebuked the vulgar manner in which I praised astronomy before, my praise shall be given in your own spirit. For every one, as I think, must see that astronomy compels the soul to look upwards and leads us from this world to another.

Every one but myself, I said; to every one else this may be clear, but not to me.

And what then would you say?

I should rather say that those who elevate astronomy into philosophy appear to me to make us look downwards and not upwards.

What do you mean? he asked.

You, I replied, have in your mind a truly sublime conception of our knowledge of the things above. And I dare say that if a person were to throw his head back and study the fretted ceiling, you would still think that his mind was the percipient, and not his eyes. And you are very likely right, and I may be a simpleton: but, in my opinion, that knowledge only which is of being and of the unseen can make the soul look upwards, and whether a man gapes at the heavens or blinks on the ground, seeking to learn some particular of sense, I would deny that he can learn, for nothing of that sort is matter of science; his soul is looking downwards, not upwards, whether his way to knowledge is by water or by land, whether he floats, or only lies on his back.

I acknowledge, he said, the justice of your rebuke. Still, I should like to ascertain how astronomy can be learned in any manner more conducive to that knowledge of which we are speaking?

I will tell you, I said: The starry heaven which we behold is wrought upon a visible ground, and therefore, although the fairest and most perfect of visible things, must necessarily be deemed inferior far to the true motions of absolute swiftness and absolute slowness, which are relative to each other, and carry with them that which is contained in them, in the true number and in every true figure. Now, these are to be apprehended by reason and intelligence, but not by sight.

True, he replied.

The spangled heavens should be used as a pattern and with a view to that higher knowledge; their beauty is like the beauty of figures or pictures excellently wrought by the hand of Daedalus, or some other great artist, which we may chance to behold; any geometrician who saw them would appreciate the exquisiteness of their workmanship, but he would never dream of thinking that in them he could find the true equal or the true double, or the truth of any other proportion.

No, he replied, such an idea would be ridiculous.

And will not a true astronomer have the same feeling when he looks at the movements of the stars? Will he not think that heaven and the things in heaven are framed by the Creator of them in the most perfect manner? But he will never imagine that the proportions of night and day, or of both to the month, or of the month to the year, or of the stars to these and to one another, and any other things that are material and visible can also be eternal and subject to no deviation—that would be absurd; and it is equally absurd to take so much pains in investigating their exact truth.

I quite agree, though I never thought of this before.

Then, I said, in astronomy, as in geometry, we should employ problems, and let the heavens alone if we would approach the subject in the right way and so make the natural gift of reason to be of any real use.

That, he said, is a work infinitely beyond our present astronomers.

Yes, I said; and there are many other things which must also have a similar extension given to them, if our legislation is to be of any value. But can you tell me of any other suitable study?

No, he said, not without thinking.

Motion, I said, has many forms, and not one only; two of them are obvious enough even to wits no better than ours; and there are others, as I imagine, which may be left to wiser persons.

But where are the two?

There is a second, I said, which is the counterpart of the one already named.

And what may that be?

The second, I said, would seem relatively to the ears to be what the first is to the eyes; for I conceive that as the eyes are designed to look up at the stars, so are the ears to hear harmonious motions; and these are sister sciences—as the Pythagoreans say, and we, Glaucon, agree with them?

Yes, he replied.

But this, I said, is a laborious study, and therefore we had better go and learn of them; and they will tell us whether there are any other applications of these sciences. At the same time, we must not lose sight of our own higher object.

What is that?

There is a perfection which all knowledge ought to reach, and which our pupils ought also to attain, and not to fall short of, as I was saying that they did in astronomy. For in the science of harmony, as you probably know, the same thing happens. The teachers of harmony compare the sounds and consonances which are heard only, and their labour, like that of the astronomers, is in vain.

Yes, by heaven! he said; and 'tis as good as a play to hear them talking about their condensed notes, as they call them; they put their ears close alongside of the strings like persons catching a sound from their neighbour's wall—one set of them declaring that they distinguish an intermediate note and have found the least interval which should be the unit of measurement; the others insisting that the two sounds have passed into the same—either party setting their ears before their understanding.

You mean, I said, those gentlemen who tease and torture the strings and rack them on the pegs of the instrument: I might carry on the metaphor and speak after their manner of the blows which the plectrum gives, and make accusations against the strings, both of backwardness and forwardness to sound; but this would be tedious, and therefore I will only say that these are not the men, and that I am referring to the Pythagoreans, of whom I was just now proposing to enquire about harmony. For they too are in error, like the astronomers; they investigate the numbers of the harmonies which are heard, but they never attain to problems—that is to say, they never reach the natural harmonies of number, or reflect why some numbers are harmonious and others not.

That, he said, is a thing of more than mortal knowledge.

A thing, I replied, which I would rather call useful; that is, if sought after with a view to the beautiful and good; but if pursued in any other spirit, useless.

Very true, he said.

Now, when all these studies reach the point of inter-communion and connection with one another, and come to be considered in their mutual affinities, then, I think, but not till then, will the pursuit of them have a value for our objects; otherwise there is no profit in them.

I suspect so; but you are speaking, Socrates, of a vast work.

What do you mean? I said; the prelude or what? Do you not know that all this is but the prelude to the actual strain which we have to learn? For you surely would not regard the skilled mathematician as a dialectician?

Assuredly not, he said; I have hardly ever known a mathematician who was capable of reasoning.

But do you imagine that men who are unable to give and take a reason will have the knowledge which we require of them?

Neither can this be supposed.

And so, Glaucon, I said, we have at last arrived at the hymn of dialectic. This is that strain which is of the intellect only, but which the faculty of sight will nevertheless be found to imitate; for sight, as you may remember, was imagined by us after a while to behold the real animals and stars, and last of all the sun himself. And so with dialectic; when a person starts on the discovery of the absolute by the light of reason only, and without any assistance of sense, and perseveres until by pure intelligence he arrives at the perception of the absolute good, he at last finds himself at the end of the intellectual world, as in the case of sight at the end of the visible.

Exactly, he said.

Then this is the progress which you call dialectic?

True.

But the release of the prisoners from chains, and their translation from the shadows to the images and to the light, and the ascent from the underground den to the sun, while in his presence they are vainly trying to look on animals and plants and the light of the sun, but are able to perceive even with their weak eyes the images in the water (which are divine), and are the shadows of true existence (not shadows of images cast by a light of fire, which compared with the sun is only an image)—this power of elevating the highest principle in the soul to the contemplation of that which is best in existence, with which we may compare the raising of that faculty which is the very light of the body to the sight of that which is brightest in the material and visible world—this power is given, as I was saying, by all that study and pursuit of the arts which has been described.

I agree in what you are saying, he replied, which may be hard to believe, yet, from another point of view, is harder still to deny. This, however, is not a theme to be treated of in passing only, but will have to be discussed again and again. And so, whether our conclusion be true or false, let us assume all this, and proceed at once from the prelude or preamble to the chief strain (A play upon the Greek word, which means both 'law' and 'strain.'), and describe that in like manner. Say, then, what is the nature and what are the divisions of dialectic, and what are the paths which lead thither; for these paths will also lead to our final rest.

Dear Glaucon, I said, you will not be able to follow me here, though I would do my best, and you should behold not an image only but the absolute truth, according to my notion. Whether what I told you would or would not have been a reality I cannot venture to say; but you would have seen something like reality; of that I am confident.

Doubtless, he replied.

But I must also remind you, that the power of dialectic alone can reveal this, and only to one who is a disciple of the previous sciences.

Of that assertion you may be as confident as of the last.

And assuredly no one will argue that there is any other method of comprehending by any regular process all true existence or of ascertaining what each thing is in its own nature; for the arts in general are concerned with the desires or opinions of men, or are cultivated with a view to production and construction, or for the preservation of such productions and constructions; and as to the mathematical sciences which, as we were saying, have some apprehension of true being—geometry and the like—they only dream about being, but never can they behold the waking reality so long as they leave the hypotheses which they use unexamined, and are unable to give an account of them. For when a man knows not his own first principle, and when the conclusion and intermediate steps are also constructed out of he knows not what, how can he imagine that such a fabric of convention can ever become science?

Impossible, he said.

Then dialectic, and dialectic alone, goes directly to the first principle and is the only science which does away with hypotheses in order to make her ground secure; the eye of the soul, which is literally buried in an outlandish slough, is by her gentle aid lifted upwards; and she uses as handmaids and helpers in the work of conversion, the sciences which we have been discussing. Custom terms them sciences, but they ought to have some other name, implying greater clearness than opinion and less clearness than science: and this, in our previous sketch, was called understanding. But why should we dispute about names when we have realities of such importance to consider?

Why indeed, he said, when any name will do which expresses the thought of the mind with clearness?

At any rate, we are satisfied, as before, to have four divisions; two for intellect and two for opinion, and to call the first division science, the second understanding, the third belief, and the fourth perception of shadows, opinion being concerned with becoming, and intellect with being; and so to make a proportion:—

As being is to becoming, so is pure intellect to opinion. And as intellect is to opinion, so is science to belief, and understanding to the perception of shadows.

But let us defer the further correlation and subdivision of the subjects of opinion and of intellect, for it will be a long enquiry, many times longer than this has been.

As far as I understand, he said, I agree.

And do you also agree, I said, in describing the dialectician as one who attains a conception of the essence of each thing? And he who does not possess and is therefore unable to impart this conception, in whatever degree he fails, may in that degree also be said to fail in intelligence? Will you admit so much?

Yes, he said; how can I deny it?

And you would say the same of the conception of the good? Until the person is able to abstract and define rationally the idea of good, and unless he can run the gauntlet of all objections, and is ready to disprove them, not by appeals to opinion, but to absolute truth, never faltering at any step of the argument—unless he can do all this, you would say that he knows neither the idea of good nor any other good; he apprehends only a shadow, if anything at all, which is given by opinion and not by science;—dreaming and slumbering in this life, before he is well awake here, he arrives at the world below, and has his final quietus.

In all that I should most certainly agree with you.

And surely you would not have the children of your ideal State, whom you are nurturing and educating—if the ideal ever becomes a reality—you would not allow the future rulers to be like posts (Literally 'lines,' probably the starting-point of a race-course.), having no reason in them, and yet to be set in authority over the highest matters?

Certainly not.

Then you will make a law that they shall have such an education as will enable them to attain the greatest skill in asking and answering questions?

Yes, he said, you and I together will make it.

Dialectic, then, as you will agree, is the coping-stone of the sciences, and is set over them; no other science can be placed higher—the nature of knowledge can no further go?

I agree, he said.

But to whom we are to assign these studies, and in what way they are to be assigned, are questions which remain to be considered.

Yes, clearly.

You remember, I said, how the rulers were chosen before?

Certainly, he said.

The same natures must still be chosen, and the preference again given to the surest and the bravest, and, if possible, to the fairest; and, having noble and generous tempers, they should also have the natural gifts which will facilitate their education.

And what are these?

Such gifts as keenness and ready powers of acquisition; for the mind more often faints from the severity of study than from the severity of gymnastics: the toil is more entirely the mind's own, and is not shared with the body.

Very true, he replied.

Further, he of whom we are in search should have a good memory, and be an unwearied solid man who is a lover of labour in any line; or he will never be able to endure the great amount of bodily exercise and to go through all the intellectual discipline and study which we require of him.

Certainly, he said; he must have natural gifts.

The mistake at present is, that those who study philosophy have no vocation, and this, as I was before saying, is the reason why she has fallen into disrepute: her true sons should take her by the hand and not bastards.

What do you mean?

In the first place, her votary should not have a lame or halting industry—I mean, that he should not be half industrious and half idle: as, for example, when a man is a lover of gymnastic and hunting, and all other bodily exercises, but a hater rather than a lover of the labour of learning or listening or enquiring. Or the occupation to which he devotes himself may be of an opposite kind, and he may have the other sort of lameness.

Certainly, he said.

And as to truth, I said, is not a soul equally to be deemed halt and lame which hates voluntary falsehood and is extremely indignant at herself and others when they tell lies, but is patient of involuntary falsehood, and does not mind wallowing like a swinish beast in the mire of ignorance, and has no shame at being detected?

To be sure.

And, again, in respect of temperance, courage, magnificence, and every other virtue, should we not carefully distinguish between the true son and the bastard? for where there is no discernment of such qualities states and individuals unconsciously err; and the state makes a ruler, and the individual a friend, of one who, being defective in some part of virtue, is in a figure lame or a bastard.

That is very true, he said.

All these things, then, will have to be carefully considered by us; and if only those whom we introduce to this vast system of education and training are sound in body and mind, justice herself will have nothing to say against us, and we shall be the saviours of the constitution and of the State; but, if our pupils are men of another stamp, the reverse will happen, and we shall pour a still greater flood of ridicule on philosophy than she has to endure at present.

That would not be creditable.

Certainly not, I said; and yet perhaps, in thus turning jest into earnest I am equally ridiculous.

In what respect?

I had forgotten, I said, that we were not serious, and spoke with too much excitement. For when I saw philosophy so undeservedly trampled under foot of men I could not help feeling a sort of indignation at the authors of her disgrace: and my anger made me too vehement.

Indeed! I was listening, and did not think so.

But I, who am the speaker, felt that I was. And now let me remind you that, although in our former selection we chose old men, we must not do so in this. Solon was under a delusion when he said that a man when he grows old may learn many things—for he can no more learn much than he can run much; youth is the time for any extraordinary toil.

Of course.

And, therefore, calculation and geometry and all the other elements of instruction, which are a preparation for dialectic, should be presented to the mind in childhood; not, however, under any notion of forcing our system of education.

Why not?

Because a freeman ought not to be a slave in the acquisition of knowledge of any kind. Bodily exercise, when compulsory, does no harm to the body; but knowledge which is acquired under compulsion obtains no hold on the mind.

Very true.

Then, my good friend, I said, do not use compulsion, but let early education be a sort of amusement; you will then be better able to find out the natural bent.

That is a very rational notion, he said.

Do you remember that the children, too, were to be taken to see the battle on horseback; and that if there were no danger they were to be brought close up and, like young hounds, have a taste of blood given them?

Yes, I remember.

The same practice may be followed, I said, in all these things—labours, lessons, dangers—and he who is most at home in all of them ought to be enrolled in a select number.

At what age?

At the age when the necessary gymnastics are over: the period whether of two or three years which passes in this sort of training is useless for any other purpose; for sleep and exercise are unpropitious to learning; and the trial of who is first in gymnastic exercises is one of the most important tests to which our youth are subjected.

Certainly, he replied.

After that time those who are selected from the class of twenty years old will be promoted to higher honour, and the sciences which they learned without any order in their early education will now be brought together, and they will be able to see the natural relationship of them to one another and to true being.

Yes, he said, that is the only kind of knowledge which takes lasting root.

Yes, I said; and the capacity for such knowledge is the great criterion of dialectical talent: the comprehensive mind is always the dialectical.

I agree with you, he said.

These, I said, are the points which you must consider; and those who have most of this comprehension, and who are most steadfast in their learning, and in their military and other appointed duties, when they have arrived at the age of thirty have to be chosen by you out of the select class, and elevated to higher honour; and you will have to prove them by the help of dialectic, in order to learn which of them is able to give up the use of sight and the other senses, and in company with truth to attain absolute being: And here, my friend, great caution is required.

Why great caution?

Do you not remark, I said, how great is the evil which dialectic has introduced?

What evil? he said.

The students of the art are filled with lawlessness.

Quite true, he said.

Do you think that there is anything so very unnatural or inexcusable in their case? or will you make allowance for them?

In what way make allowance?

I want you, I said, by way of parallel, to imagine a supposititious son who is brought up in great wealth; he is one of a great and numerous family, and has many flatterers. When he grows up to manhood, he learns that his alleged are not his real parents; but who the real are he is unable to discover. Can you guess how he will be likely to behave towards his flatterers and his supposed parents, first of all during the period when he is ignorant of the false relation, and then again when he knows? Or shall I guess for you?

If you please.

Then I should say, that while he is ignorant of the truth he will be likely to honour his father and his mother and his supposed relations more than the flatterers; he will be less inclined to neglect them when in need, or to do or say anything against them; and he will be less willing to disobey them in any important matter.

He will.

But when he has made the discovery, I should imagine that he would diminish his honour and regard for them, and would become more devoted to the flatterers; their influence over him would greatly increase; he would now live after their ways, and openly associate with them, and, unless he were of an unusually good disposition, he would trouble himself no more about his supposed parents or other relations.

Well, all that is very probable. But how is the image applicable to the disciples of philosophy?

In this way: you know that there are certain principles about justice and honour, which were taught us in childhood, and under their parental authority we have been brought up, obeying and honouring them.

That is true.

There are also opposite maxims and habits of pleasure which flatter and attract the soul, but do not influence those of us who have any sense of right, and they continue to obey and honour the maxims of their fathers.

True.

Now, when a man is in this state, and the questioning spirit asks what is fair or honourable, and he answers as the legislator has taught him, and then arguments many and diverse refute his words, until he is driven into believing that nothing is honourable any more than dishonourable, or just and good any more than the reverse, and so of all the notions which he most valued, do you think that he will still honour and obey them as before?

Impossible.

And when he ceases to think them honourable and natural as heretofore, and he fails to discover the true, can he be expected to pursue any life other than that which flatters his desires?

He cannot.

And from being a keeper of the law he is converted into a breaker of it?

Unquestionably.

Now all this is very natural in students of philosophy such as I have described, and also, as I was just now saying, most excusable.

Yes, he said; and, I may add, pitiable.

Therefore, that your feelings may not be moved to pity about our citizens who are now thirty years of age, every care must be taken in introducing them to dialectic.

Certainly.

There is a danger lest they should taste the dear delight too early; for youngsters, as you may have observed, when they first get the taste in their mouths, argue for amusement, and are always contradicting and refuting others in imitation of those who refute them; like puppy-dogs, they rejoice in pulling and tearing at all who come near them.

Yes, he said, there is nothing which they like better.

And when they have made many conquests and received defeats at the hands of many, they violently and speedily get into a way of not believing anything which they believed before, and hence, not only they, but philosophy and all that relates to it is apt to have a bad name with the rest of the world.

Too true, he said.

But when a man begins to get older, he will no longer be guilty of such insanity; he will imitate the dialectician who is seeking for truth, and not the eristic, who is contradicting for the sake of amusement; and the greater moderation of his character will increase instead of diminishing the honour of the pursuit.

Very true, he said.

And did we not make special provision for this, when we said that the disciples of philosophy were to be orderly and steadfast, not, as now, any chance aspirant or intruder?

Very true.

Suppose, I said, the study of philosophy to take the place of gymnastics and to be continued diligently and earnestly and exclusively for twice the number of years which were passed in bodily exercise—will that be enough?

Would you say six or four years? he asked.

Say five years, I replied; at the end of the time they must be sent down again into the den and compelled to hold any military or other office which young men are qualified to hold: in this way they will get their experience of life, and there will be an opportunity of trying whether, when they are drawn all manner of ways by temptation, they will stand firm or flinch.

And how long is this stage of their lives to last?

Fifteen years, I answered; and when they have reached fifty years of age, then let those who still survive and have distinguished themselves in every action of their lives and in every branch of knowledge come at last to their consummation: the time has now arrived at which they must raise the eye of the soul to the universal light which lightens all things, and behold the absolute good; for that is the pattern according to which they are to order the State and the lives of individuals, and the remainder of their own lives also; making philosophy their chief pursuit, but, when their turn comes, toiling also at politics and ruling for the public good, not as though they were performing some heroic action, but simply as a matter of duty; and when they have brought up in each generation others like themselves and left them in their place to be governors of the State, then they will depart to the Islands of the Blest and dwell there; and the city will give them public memorials and sacrifices and honour them, if the Pythian oracle consent, as demigods, but if not, as in any case blessed and divine.

You are a sculptor, Socrates, and have made statues of our governors faultless in beauty.

Yes, I said, Glaucon, and of our governesses too; for you must not suppose that what I have been saying applies to men only and not to women as far as their natures can go.

There you are right, he said, since we have made them to share in all things like the men.

Well, I said, and you would agree (would you not?) that what has been said about the State and the government is not a mere dream, and although difficult not impossible, but only possible in the way which has been supposed; that is to say, when the true philosopher kings are born in a State, one or more of them, despising the honours of this present world which they deem mean and worthless, esteeming above all things right and the honour that springs from right, and regarding justice as the greatest and most necessary of all things, whose ministers they are, and whose principles will be exalted by them when they set in order their own city?

How will they proceed?

They will begin by sending out into the country all the inhabitants of the city who are more than ten years old, and will take possession of their children, who will be unaffected by the habits of their parents; these they will train in their own habits and laws, I mean in the laws which we have given them: and in this way the State and constitution of which we were speaking will soonest and most easily attain happiness, and the nation which has such a constitution will gain most.

Yes, that will be the best way. And I think, Socrates, that you have very well described how, if ever, such a constitution might come into being.

Enough then of the perfect State, and of the man who bears its image—there is no difficulty in seeing how we shall describe him.

There is no difficulty, he replied; and I agree with you in thinking that nothing more need be said.</pre>
</div>
<div created="20150302204518081" modified="20150302213032097" tags="" title="Book VIII (Jowett translation)">
<pre>And so, Glaucon, we have arrived at the conclusion that in the perfect State wives and children are to be in common; and that all education and the pursuits of war and peace are also to be common, and the best philosophers and the bravest warriors are to be their kings?

That, replied Glaucon, has been acknowledged.

Yes, I said; and we have further acknowledged that the governors, when appointed themselves, will take their soldiers and place them in houses such as we were describing, which are common to all, and contain nothing private, or individual; and about their property, you remember what we agreed?

Yes, I remember that no one was to have any of the ordinary possessions of mankind; they were to be warrior athletes and guardians, receiving from the other citizens, in lieu of annual payment, only their maintenance, and they were to take care of themselves and of the whole State.

True, I said; and now that this division of our task is concluded, let us find the point at which we digressed, that we may return into the old path.

There is no difficulty in returning; you implied, then as now, that you had finished the description of the State: you said that such a State was good, and that the man was good who answered to it, although, as now appears, you had more excellent things to relate both of State and man. And you said further, that if this was the true form, then the others were false; and of the false forms, you said, as I remember, that there were four principal ones, and that their defects, and the defects of the individuals corresponding to them, were worth examining. When we had seen all the individuals, and finally agreed as to who was the best and who was the worst of them, we were to consider whether the best was not also the happiest, and the worst the most miserable. I asked you what were the four forms of government of which you spoke, and then Polemarchus and Adeimantus put in their word; and you began again, and have found your way to the point at which we have now arrived.

Your recollection, I said, is most exact.

Then, like a wrestler, he replied, you must put yourself again in the same position; and let me ask the same questions, and do you give me the same answer which you were about to give me then.

Yes, if I can, I will, I said.

I shall particularly wish to hear what were the four constitutions of which you were speaking.

That question, I said, is easily answered: the four governments of which I spoke, so far as they have distinct names, are, first, those of Crete and Sparta, which are generally applauded; what is termed oligarchy comes next; this is not equally approved, and is a form of government which teems with evils: thirdly, democracy, which naturally follows oligarchy, although very different: and lastly comes tyranny, great and famous, which differs from them all, and is the fourth and worst disorder of a State. I do not know, do you? of any other constitution which can be said to have a distinct character. There are lordships and principalities which are bought and sold, and some other intermediate forms of government. But these are nondescripts and may be found equally among Hellenes and among barbarians.

Yes, he replied, we certainly hear of many curious forms of government which exist among them.

Do you know, I said, that governments vary as the dispositions of men vary, and that there must be as many of the one as there are of the other? For we cannot suppose that States are made of 'oak and rock,' and not out of the human natures which are in them, and which in a figure turn the scale and draw other things after them?

Yes, he said, the States are as the men are; they grow out of human characters.

Then if the constitutions of States are five, the dispositions of individual minds will also be five?

Certainly.

Him who answers to aristocracy, and whom we rightly call just and good, we have already described.

We have.

Then let us now proceed to describe the inferior sort of natures, being the contentious and ambitious, who answer to the Spartan polity; also the oligarchical, democratical, and tyrannical. Let us place the most just by the side of the most unjust, and when we see them we shall be able to compare the relative happiness or unhappiness of him who leads a life of pure justice or pure injustice. The enquiry will then be completed. And we shall know whether we ought to pursue injustice, as Thrasymachus advises, or in accordance with the conclusions of the argument to prefer justice.

Certainly, he replied, we must do as you say.

Shall we follow our old plan, which we adopted with a view to clearness, of taking the State first and then proceeding to the individual, and begin with the government of honour?—I know of no name for such a government other than timocracy, or perhaps timarchy. We will compare with this the like character in the individual; and, after that, consider oligarchy and the oligarchical man; and then again we will turn our attention to democracy and the democratical man; and lastly, we will go and view the city of tyranny, and once more take a look into the tyrant's soul, and try to arrive at a satisfactory decision.

That way of viewing and judging of the matter will be very suitable.

First, then, I said, let us enquire how timocracy (the government of honour) arises out of aristocracy (the government of the best). Clearly, all political changes originate in divisions of the actual governing power; a government which is united, however small, cannot be moved.

Very true, he said.

In what way, then, will our city be moved, and in what manner will the two classes of auxiliaries and rulers disagree among themselves or with one another? Shall we, after the manner of Homer, pray the Muses to tell us 'how discord first arose'? Shall we imagine them in solemn mockery, to play and jest with us as if we were children, and to address us in a lofty tragic vein, making believe to be in earnest?

How would they address us?

After this manner:—A city which is thus constituted can hardly be shaken; but, seeing that everything which has a beginning has also an end, even a constitution such as yours will not last for ever, but will in time be dissolved. And this is the dissolution:—In plants that grow in the earth, as well as in animals that move on the earth's surface, fertility and sterility of soul and body occur when the circumferences of the circles of each are completed, which in short-lived existences pass over a short space, and in long-lived ones over a long space. But to the knowledge of human fecundity and sterility all the wisdom and education of your rulers will not attain; the laws which regulate them will not be discovered by an intelligence which is alloyed with sense, but will escape them, and they will bring children into the world when they ought not. Now that which is of divine birth has a period which is contained in a perfect number (i.e. a cyclical number, such as 6, which is equal to the sum of its divisors 1, 2, 3, so that when the circle or time represented by 6 is completed, the lesser times or rotations represented by 1, 2, 3 are also completed.), but the period of human birth is comprehended in a number in which first increments by involution and evolution (or squared and cubed) obtaining three intervals and four terms of like and unlike, waxing and waning numbers, make all the terms commensurable and agreeable to one another. (Probably the numbers 3, 4, 5, 6 of which the three first = the sides of the Pythagorean triangle. The terms will then be 3 cubed, 4 cubed, 5 cubed, which together = 6 cubed = 216.) The base of these (3) with a third added (4) when combined with five (20) and raised to the third power furnishes two harmonies; the first a square which is a hundred times as great (400 = 4 x 100) (Or the first a square which is 100 x 100 = 10,000. The whole number will then be 17,500 = a square of 100, and an oblong of 100 by 75.), and the other a figure having one side equal to the former, but oblong, consisting of a hundred numbers squared upon rational diameters of a square (i.e. omitting fractions), the side of which is five (7 x 7 = 49 x 100 = 4900), each of them being less by one (than the perfect square which includes the fractions, sc. 50) or less by (Or, 'consisting of two numbers squared upon irrational diameters,' etc. = 100. For other explanations of the passage see Introduction.) two perfect squares of irrational diameters (of a square the side of which is five = 50 + 50 = 100); and a hundred cubes of three (27 x 100 = 2700 + 4900 + 400 = 8000). Now this number represents a geometrical figure which has control over the good and evil of births. For when your guardians are ignorant of the law of births, and unite bride and bridegroom out of season, the children will not be goodly or fortunate. And though only the best of them will be appointed by their predecessors, still they will be unworthy to hold their fathers' places, and when they come into power as guardians, they will soon be found to fail in taking care of us, the Muses, first by under-valuing music; which neglect will soon extend to gymnastic; and hence the young men of your State will be less cultivated. In the succeeding generation rulers will be appointed who have lost the guardian power of testing the metal of your different races, which, like Hesiod's, are of gold and silver and brass and iron. And so iron will be mingled with silver, and brass with gold, and hence there will arise dissimilarity and inequality and irregularity, which always and in all places are causes of hatred and war. This the Muses affirm to be the stock from which discord has sprung, wherever arising; and this is their answer to us.

Yes, and we may assume that they answer truly.

Why, yes, I said, of course they answer truly; how can the Muses speak falsely?

And what do the Muses say next?

When discord arose, then the two races were drawn different ways: the iron and brass fell to acquiring money and land and houses and gold and silver; but the gold and silver races, not wanting money but having the true riches in their own nature, inclined towards virtue and the ancient order of things. There was a battle between them, and at last they agreed to distribute their land and houses among individual owners; and they enslaved their friends and maintainers, whom they had formerly protected in the condition of freemen, and made of them subjects and servants; and they themselves were engaged in war and in keeping a watch against them.

I believe that you have rightly conceived the origin of the change.

And the new government which thus arises will be of a form intermediate between oligarchy and aristocracy?

Very true.

Such will be the change, and after the change has been made, how will they proceed? Clearly, the new State, being in a mean between oligarchy and the perfect State, will partly follow one and partly the other, and will also have some peculiarities.

True, he said.

In the honour given to rulers, in the abstinence of the warrior class from agriculture, handicrafts, and trade in general, in the institution of common meals, and in the attention paid to gymnastics and military training—in all these respects this State will resemble the former.

True.

But in the fear of admitting philosophers to power, because they are no longer to be had simple and earnest, but are made up of mixed elements; and in turning from them to passionate and less complex characters, who are by nature fitted for war rather than peace; and in the value set by them upon military stratagems and contrivances, and in the waging of everlasting wars—this State will be for the most part peculiar.

Yes.

Yes, I said; and men of this stamp will be covetous of money, like those who live in oligarchies; they will have, a fierce secret longing after gold and silver, which they will hoard in dark places, having magazines and treasuries of their own for the deposit and concealment of them; also castles which are just nests for their eggs, and in which they will spend large sums on their wives, or on any others whom they please.

That is most true, he said.

And they are miserly because they have no means of openly acquiring the money which they prize; they will spend that which is another man's on the gratification of their desires, stealing their pleasures and running away like children from the law, their father: they have been schooled not by gentle influences but by force, for they have neglected her who is the true Muse, the companion of reason and philosophy, and have honoured gymnastic more than music.

Undoubtedly, he said, the form of government which you describe is a mixture of good and evil.

Why, there is a mixture, I said; but one thing, and one thing only, is predominantly seen,—the spirit of contention and ambition; and these are due to the prevalence of the passionate or spirited element.

Assuredly, he said.

Such is the origin and such the character of this State, which has been described in outline only; the more perfect execution was not required, for a sketch is enough to show the type of the most perfectly just and most perfectly unjust; and to go through all the States and all the characters of men, omitting none of them, would be an interminable labour.

Very true, he replied.

Now what man answers to this form of government-how did he come into being, and what is he like?

I think, said Adeimantus, that in the spirit of contention which characterises him, he is not unlike our friend Glaucon.

Perhaps, I said, he may be like him in that one point; but there are other respects in which he is very different.

In what respects?

He should have more of self-assertion and be less cultivated, and yet a friend of culture; and he should be a good listener, but no speaker. Such a person is apt to be rough with slaves, unlike the educated man, who is too proud for that; and he will also be courteous to freemen, and remarkably obedient to authority; he is a lover of power and a lover of honour; claiming to be a ruler, not because he is eloquent, or on any ground of that sort, but because he is a soldier and has performed feats of arms; he is also a lover of gymnastic exercises and of the chase.

Yes, that is the type of character which answers to timocracy.

Such an one will despise riches only when he is young; but as he gets older he will be more and more attracted to them, because he has a piece of the avaricious nature in him, and is not single-minded towards virtue, having lost his best guardian.

Who was that? said Adeimantus.

Philosophy, I said, tempered with music, who comes and takes up her abode in a man, and is the only saviour of his virtue throughout life.

Good, he said.

Such, I said, is the timocratical youth, and he is like the timocratical State.

Exactly.

His origin is as follows:—He is often the young son of a brave father, who dwells in an ill-governed city, of which he declines the honours and offices, and will not go to law, or exert himself in any way, but is ready to waive his rights in order that he may escape trouble.

And how does the son come into being?

The character of the son begins to develope when he hears his mother complaining that her husband has no place in the government, of which the consequence is that she has no precedence among other women. Further, when she sees her husband not very eager about money, and instead of battling and railing in the law courts or assembly, taking whatever happens to him quietly; and when she observes that his thoughts always centre in himself, while he treats her with very considerable indifference, she is annoyed, and says to her son that his father is only half a man and far too easy-going: adding all the other complaints about her own ill-treatment which women are so fond of rehearsing.

Yes, said Adeimantus, they give us plenty of them, and their complaints are so like themselves.

And you know, I said, that the old servants also, who are supposed to be attached to the family, from time to time talk privately in the same strain to the son; and if they see any one who owes money to his father, or is wronging him in any way, and he fails to prosecute them, they tell the youth that when he grows up he must retaliate upon people of this sort, and be more of a man than his father. He has only to walk abroad and he hears and sees the same sort of thing: those who do their own business in the city are called simpletons, and held in no esteem, while the busy-bodies are honoured and applauded. The result is that the young man, hearing and seeing all these things—hearing, too, the words of his father, and having a nearer view of his way of life, and making comparisons of him and others—is drawn opposite ways: while his father is watering and nourishing the rational principle in his soul, the others are encouraging the passionate and appetitive; and he being not originally of a bad nature, but having kept bad company, is at last brought by their joint influence to a middle point, and gives up the kingdom which is within him to the middle principle of contentiousness and passion, and becomes arrogant and ambitious.

You seem to me to have described his origin perfectly.

Then we have now, I said, the second form of government and the second type of character?

We have.

Next, let us look at another man who, as Aeschylus says,

'Is set over against another State;'

or rather, as our plan requires, begin with the State.

By all means.

I believe that oligarchy follows next in order.

And what manner of government do you term oligarchy?

A government resting on a valuation of property, in which the rich have power and the poor man is deprived of it.

I understand, he replied.

Ought I not to begin by describing how the change from timocracy to oligarchy arises?

Yes.

Well, I said, no eyes are required in order to see how the one passes into the other.

How?

The accumulation of gold in the treasury of private individuals is the ruin of timocracy; they invent illegal modes of expenditure; for what do they or their wives care about the law?

Yes, indeed.

And then one, seeing another grow rich, seeks to rival him, and thus the great mass of the citizens become lovers of money.

Likely enough.

And so they grow richer and richer, and the more they think of making a fortune the less they think of virtue; for when riches and virtue are placed together in the scales of the balance, the one always rises as the other falls.

True.

And in proportion as riches and rich men are honoured in the State, virtue and the virtuous are dishonoured.

Clearly.

And what is honoured is cultivated, and that which has no honour is neglected.

That is obvious.

And so at last, instead of loving contention and glory, men become lovers of trade and money; they honour and look up to the rich man, and make a ruler of him, and dishonour the poor man.

They do so.

They next proceed to make a law which fixes a sum of money as the qualification of citizenship; the sum is higher in one place and lower in another, as the oligarchy is more or less exclusive; and they allow no one whose property falls below the amount fixed to have any share in the government. These changes in the constitution they effect by force of arms, if intimidation has not already done their work.

Very true.

And this, speaking generally, is the way in which oligarchy is established.

Yes, he said; but what are the characteristics of this form of government, and what are the defects of which we were speaking?

First of all, I said, consider the nature of the qualification. Just think what would happen if pilots were to be chosen according to their property, and a poor man were refused permission to steer, even though he were a better pilot?

You mean that they would shipwreck?

Yes; and is not this true of the government of anything?

I should imagine so.

Except a city?—or would you include a city?

Nay, he said, the case of a city is the strongest of all, inasmuch as the rule of a city is the greatest and most difficult of all.

This, then, will be the first great defect of oligarchy?

Clearly.

And here is another defect which is quite as bad.

What defect?

The inevitable division: such a State is not one, but two States, the one of poor, the other of rich men; and they are living on the same spot and always conspiring against one another.

That, surely, is at least as bad.

Another discreditable feature is, that, for a like reason, they are incapable of carrying on any war. Either they arm the multitude, and then they are more afraid of them than of the enemy; or, if they do not call them out in the hour of battle, they are oligarchs indeed, few to fight as they are few to rule. And at the same time their fondness for money makes them unwilling to pay taxes.

How discreditable!

And, as we said before, under such a constitution the same persons have too many callings—they are husbandmen, tradesmen, warriors, all in one. Does that look well?

Anything but well.

There is another evil which is, perhaps, the greatest of all, and to which this State first begins to be liable.

What evil?

A man may sell all that he has, and another may acquire his property; yet after the sale he may dwell in the city of which he is no longer a part, being neither trader, nor artisan, nor horseman, nor hoplite, but only a poor, helpless creature.

Yes, that is an evil which also first begins in this State.

The evil is certainly not prevented there; for oligarchies have both the extremes of great wealth and utter poverty.

True.

But think again: In his wealthy days, while he was spending his money, was a man of this sort a whit more good to the State for the purposes of citizenship? Or did he only seem to be a member of the ruling body, although in truth he was neither ruler nor subject, but just a spendthrift?

As you say, he seemed to be a ruler, but was only a spendthrift.

May we not say that this is the drone in the house who is like the drone in the honeycomb, and that the one is the plague of the city as the other is of the hive?

Just so, Socrates.

And God has made the flying drones, Adeimantus, all without stings, whereas of the walking drones he has made some without stings but others have dreadful stings; of the stingless class are those who in their old age end as paupers; of the stingers come all the criminal class, as they are termed.

Most true, he said.

Clearly then, whenever you see paupers in a State, somewhere in that neighborhood there are hidden away thieves, and cut-purses and robbers of temples, and all sorts of malefactors.

Clearly.

Well, I said, and in oligarchical States do you not find paupers?

Yes, he said; nearly everybody is a pauper who is not a ruler.

And may we be so bold as to affirm that there are also many criminals to be found in them, rogues who have stings, and whom the authorities are careful to restrain by force?

Certainly, we may be so bold.

The existence of such persons is to be attributed to want of education, ill-training, and an evil constitution of the State?

True.

Such, then, is the form and such are the evils of oligarchy; and there may be many other evils.

Very likely.

Then oligarchy, or the form of government in which the rulers are elected for their wealth, may now be dismissed. Let us next proceed to consider the nature and origin of the individual who answers to this State.

By all means.

Does not the timocratical man change into the oligarchical on this wise?

How?

A time arrives when the representative of timocracy has a son: at first he begins by emulating his father and walking in his footsteps, but presently he sees him of a sudden foundering against the State as upon a sunken reef, and he and all that he has is lost; he may have been a general or some other high officer who is brought to trial under a prejudice raised by informers, and either put to death, or exiled, or deprived of the privileges of a citizen, and all his property taken from him.

Nothing more likely.

And the son has seen and known all this—he is a ruined man, and his fear has taught him to knock ambition and passion headforemost from his bosom's throne; humbled by poverty he takes to money-making and by mean and miserly savings and hard work gets a fortune together. Is not such an one likely to seat the concupiscent and covetous element on the vacant throne and to suffer it to play the great king within him, girt with tiara and chain and scimitar?

Most true, he replied.

And when he has made reason and spirit sit down on the ground obediently on either side of their sovereign, and taught them to know their place, he compels the one to think only of how lesser sums may be turned into larger ones, and will not allow the other to worship and admire anything but riches and rich men, or to be ambitious of anything so much as the acquisition of wealth and the means of acquiring it.

Of all changes, he said, there is none so speedy or so sure as the conversion of the ambitious youth into the avaricious one.

And the avaricious, I said, is the oligarchical youth?

Yes, he said; at any rate the individual out of whom he came is like the State out of which oligarchy came.

Let us then consider whether there is any likeness between them.

Very good.

First, then, they resemble one another in the value which they set upon wealth?

Certainly.

Also in their penurious, laborious character; the individual only satisfies his necessary appetites, and confines his expenditure to them; his other desires he subdues, under the idea that they are unprofitable.

True.

He is a shabby fellow, who saves something out of everything and makes a purse for himself; and this is the sort of man whom the vulgar applaud. Is he not a true image of the State which he represents?

He appears to me to be so; at any rate money is highly valued by him as well as by the State.

You see that he is not a man of cultivation, I said.

I imagine not, he said; had he been educated he would never have made a blind god director of his chorus, or given him chief honour.

Excellent! I said. Yet consider: Must we not further admit that owing to this want of cultivation there will be found in him dronelike desires as of pauper and rogue, which are forcibly kept down by his general habit of life?

True.

Do you know where you will have to look if you want to discover his rogueries?

Where must I look?

You should see him where he has some great opportunity of acting dishonestly, as in the guardianship of an orphan.

Aye.

It will be clear enough then that in his ordinary dealings which give him a reputation for honesty he coerces his bad passions by an enforced virtue; not making them see that they are wrong, or taming them by reason, but by necessity and fear constraining them, and because he trembles for his possessions.

To be sure.

Yes, indeed, my dear friend, but you will find that the natural desires of the drone commonly exist in him all the same whenever he has to spend what is not his own.

Yes, and they will be strong in him too.

The man, then, will be at war with himself; he will be two men, and not one; but, in general, his better desires will be found to prevail over his inferior ones.

True.

For these reasons such an one will be more respectable than most people; yet the true virtue of a unanimous and harmonious soul will flee far away and never come near him.

I should expect so.

And surely, the miser individually will be an ignoble competitor in a State for any prize of victory, or other object of honourable ambition; he will not spend his money in the contest for glory; so afraid is he of awakening his expensive appetites and inviting them to help and join in the struggle; in true oligarchical fashion he fights with a small part only of his resources, and the result commonly is that he loses the prize and saves his money.

Very true.

Can we any longer doubt, then, that the miser and money-maker answers to the oligarchical State?

There can be no doubt.

Next comes democracy; of this the origin and nature have still to be considered by us; and then we will enquire into the ways of the democratic man, and bring him up for judgment.

That, he said, is our method.

Well, I said, and how does the change from oligarchy into democracy arise? Is it not on this wise?—The good at which such a State aims is to become as rich as possible, a desire which is insatiable?

What then?

The rulers, being aware that their power rests upon their wealth, refuse to curtail by law the extravagance of the spendthrift youth because they gain by their ruin; they take interest from them and buy up their estates and thus increase their own wealth and importance?

To be sure.

There can be no doubt that the love of wealth and the spirit of moderation cannot exist together in citizens of the same state to any considerable extent; one or the other will be disregarded.

That is tolerably clear.

And in oligarchical States, from the general spread of carelessness and extravagance, men of good family have often been reduced to beggary?

Yes, often.

And still they remain in the city; there they are, ready to sting and fully armed, and some of them owe money, some have forfeited their citizenship; a third class are in both predicaments; and they hate and conspire against those who have got their property, and against everybody else, and are eager for revolution.

That is true.

On the other hand, the men of business, stooping as they walk, and pretending not even to see those whom they have already ruined, insert their sting—that is, their money—into some one else who is not on his guard against them, and recover the parent sum many times over multiplied into a family of children: and so they make drone and pauper to abound in the State.

Yes, he said, there are plenty of them—that is certain.

The evil blazes up like a fire; and they will not extinguish it, either by restricting a man's use of his own property, or by another remedy:

What other?

One which is the next best, and has the advantage of compelling the citizens to look to their characters:—Let there be a general rule that every one shall enter into voluntary contracts at his own risk, and there will be less of this scandalous money-making, and the evils of which we were speaking will be greatly lessened in the State.

Yes, they will be greatly lessened.

At present the governors, induced by the motives which I have named, treat their subjects badly; while they and their adherents, especially the young men of the governing class, are habituated to lead a life of luxury and idleness both of body and mind; they do nothing, and are incapable of resisting either pleasure or pain.

Very true.

They themselves care only for making money, and are as indifferent as the pauper to the cultivation of virtue.

Yes, quite as indifferent.

Such is the state of affairs which prevails among them. And often rulers and their subjects may come in one another's way, whether on a journey or on some other occasion of meeting, on a pilgrimage or a march, as fellow-soldiers or fellow-sailors; aye and they may observe the behaviour of each other in the very moment of danger—for where danger is, there is no fear that the poor will be despised by the rich—and very likely the wiry sunburnt poor man may be placed in battle at the side of a wealthy one who has never spoilt his complexion and has plenty of superfluous flesh—when he sees such an one puffing and at his wits'-end, how can he avoid drawing the conclusion that men like him are only rich because no one has the courage to despoil them? And when they meet in private will not people be saying to one another 'Our warriors are not good for much'?

Yes, he said, I am quite aware that this is their way of talking.

And, as in a body which is diseased the addition of a touch from without may bring on illness, and sometimes even when there is no external provocation a commotion may arise within—in the same way wherever there is weakness in the State there is also likely to be illness, of which the occasion may be very slight, the one party introducing from without their oligarchical, the other their democratical allies, and then the State falls sick, and is at war with herself; and may be at times distracted, even when there is no external cause.

Yes, surely.

And then democracy comes into being after the poor have conquered their opponents, slaughtering some and banishing some, while to the remainder they give an equal share of freedom and power; and this is the form of government in which the magistrates are commonly elected by lot.

Yes, he said, that is the nature of democracy, whether the revolution has been effected by arms, or whether fear has caused the opposite party to withdraw.

And now what is their manner of life, and what sort of a government have they? for as the government is, such will be the man.

Clearly, he said.

In the first place, are they not free; and is not the city full of freedom and frankness—a man may say and do what he likes?

'Tis said so, he replied.

And where freedom is, the individual is clearly able to order for himself his own life as he pleases?

Clearly.

Then in this kind of State there will be the greatest variety of human natures?

There will.

This, then, seems likely to be the fairest of States, being like an embroidered robe which is spangled with every sort of flower. And just as women and children think a variety of colours to be of all things most charming, so there are many men to whom this State, which is spangled with the manners and characters of mankind, will appear to be the fairest of States.

Yes.

Yes, my good Sir, and there will be no better in which to look for a government.

Why?

Because of the liberty which reigns there—they have a complete assortment of constitutions; and he who has a mind to establish a State, as we have been doing, must go to a democracy as he would to a bazaar at which they sell them, and pick out the one that suits him; then, when he has made his choice, he may found his State.

He will be sure to have patterns enough.

And there being no necessity, I said, for you to govern in this State, even if you have the capacity, or to be governed, unless you like, or go to war when the rest go to war, or to be at peace when others are at peace, unless you are so disposed—there being no necessity also, because some law forbids you to hold office or be a dicast, that you should not hold office or be a dicast, if you have a fancy—is not this a way of life which for the moment is supremely delightful?

For the moment, yes.

And is not their humanity to the condemned in some cases quite charming? Have you not observed how, in a democracy, many persons, although they have been sentenced to death or exile, just stay where they are and walk about the world—the gentleman parades like a hero, and nobody sees or cares?

Yes, he replied, many and many a one.

See too, I said, the forgiving spirit of democracy, and the 'don't care' about trifles, and the disregard which she shows of all the fine principles which we solemnly laid down at the foundation of the city—as when we said that, except in the case of some rarely gifted nature, there never will be a good man who has not from his childhood been used to play amid things of beauty and make of them a joy and a study—how grandly does she trample all these fine notions of ours under her feet, never giving a thought to the pursuits which make a statesman, and promoting to honour any one who professes to be the people's friend.

Yes, she is of a noble spirit.

These and other kindred characteristics are proper to democracy, which is a charming form of government, full of variety and disorder, and dispensing a sort of equality to equals and unequals alike.

We know her well.

Consider now, I said, what manner of man the individual is, or rather consider, as in the case of the State, how he comes into being.

Very good, he said.

Is not this the way—he is the son of the miserly and oligarchical father who has trained him in his own habits?

Exactly.

And, like his father, he keeps under by force the pleasures which are of the spending and not of the getting sort, being those which are called unnecessary?

Obviously.

Would you like, for the sake of clearness, to distinguish which are the necessary and which are the unnecessary pleasures?

I should.

Are not necessary pleasures those of which we cannot get rid, and of which the satisfaction is a benefit to us? And they are rightly called so, because we are framed by nature to desire both what is beneficial and what is necessary, and cannot help it.

True.

We are not wrong therefore in calling them necessary?

We are not.

And the desires of which a man may get rid, if he takes pains from his youth upwards—of which the presence, moreover, does no good, and in some cases the reverse of good—shall we not be right in saying that all these are unnecessary?

Yes, certainly.

Suppose we select an example of either kind, in order that we may have a general notion of them?

Very good.

Will not the desire of eating, that is, of simple food and condiments, in so far as they are required for health and strength, be of the necessary class?

That is what I should suppose.

The pleasure of eating is necessary in two ways; it does us good and it is essential to the continuance of life?

Yes.

But the condiments are only necessary in so far as they are good for health?

Certainly.

And the desire which goes beyond this, of more delicate food, or other luxuries, which might generally be got rid of, if controlled and trained in youth, and is hurtful to the body, and hurtful to the soul in the pursuit of wisdom and virtue, may be rightly called unnecessary?

Very true.

May we not say that these desires spend, and that the others make money because they conduce to production?

Certainly.

And of the pleasures of love, and all other pleasures, the same holds good?

True.

And the drone of whom we spoke was he who was surfeited in pleasures and desires of this sort, and was the slave of the unnecessary desires, whereas he who was subject to the necessary only was miserly and oligarchical?

Very true.

Again, let us see how the democratical man grows out of the oligarchical: the following, as I suspect, is commonly the process.

What is the process?

When a young man who has been brought up as we were just now describing, in a vulgar and miserly way, has tasted drones' honey and has come to associate with fierce and crafty natures who are able to provide for him all sorts of refinements and varieties of pleasure—then, as you may imagine, the change will begin of the oligarchical principle within him into the democratical?

Inevitably.

And as in the city like was helping like, and the change was effected by an alliance from without assisting one division of the citizens, so too the young man is changed by a class of desires coming from without to assist the desires within him, that which is akin and alike again helping that which is akin and alike?

Certainly.

And if there be any ally which aids the oligarchical principle within him, whether the influence of a father or of kindred, advising or rebuking him, then there arises in his soul a faction and an opposite faction, and he goes to war with himself.

It must be so.

And there are times when the democratical principle gives way to the oligarchical, and some of his desires die, and others are banished; a spirit of reverence enters into the young man's soul and order is restored.

Yes, he said, that sometimes happens.

And then, again, after the old desires have been driven out, fresh ones spring up, which are akin to them, and because he their father does not know how to educate them, wax fierce and numerous.

Yes, he said, that is apt to be the way.

They draw him to his old associates, and holding secret intercourse with them, breed and multiply in him.

Very true.

At length they seize upon the citadel of the young man's soul, which they perceive to be void of all accomplishments and fair pursuits and true words, which make their abode in the minds of men who are dear to the gods, and are their best guardians and sentinels.

None better.

False and boastful conceits and phrases mount upwards and take their place.

They are certain to do so.

And so the young man returns into the country of the lotus-eaters, and takes up his dwelling there in the face of all men; and if any help be sent by his friends to the oligarchical part of him, the aforesaid vain conceits shut the gate of the king's fastness; and they will neither allow the embassy itself to enter, nor if private advisers offer the fatherly counsel of the aged will they listen to them or receive them. There is a battle and they gain the day, and then modesty, which they call silliness, is ignominiously thrust into exile by them, and temperance, which they nickname unmanliness, is trampled in the mire and cast forth; they persuade men that moderation and orderly expenditure are vulgarity and meanness, and so, by the help of a rabble of evil appetites, they drive them beyond the border.

Yes, with a will.

And when they have emptied and swept clean the soul of him who is now in their power and who is being initiated by them in great mysteries, the next thing is to bring back to their house insolence and anarchy and waste and impudence in bright array having garlands on their heads, and a great company with them, hymning their praises and calling them by sweet names; insolence they term breeding, and anarchy liberty, and waste magnificence, and impudence courage. And so the young man passes out of his original nature, which was trained in the school of necessity, into the freedom and libertinism of useless and unnecessary pleasures.

Yes, he said, the change in him is visible enough.

After this he lives on, spending his money and labour and time on unnecessary pleasures quite as much as on necessary ones; but if he be fortunate, and is not too much disordered in his wits, when years have elapsed, and the heyday of passion is over—supposing that he then re-admits into the city some part of the exiled virtues, and does not wholly give himself up to their successors—in that case he balances his pleasures and lives in a sort of equilibrium, putting the government of himself into the hands of the one which comes first and wins the turn; and when he has had enough of that, then into the hands of another; he despises none of them but encourages them all equally.

Very true, he said.

Neither does he receive or let pass into the fortress any true word of advice; if any one says to him that some pleasures are the satisfactions of good and noble desires, and others of evil desires, and that he ought to use and honour some and chastise and master the others—whenever this is repeated to him he shakes his head and says that they are all alike, and that one is as good as another.

Yes, he said; that is the way with him.

Yes, I said, he lives from day to day indulging the appetite of the hour; and sometimes he is lapped in drink and strains of the flute; then he becomes a water-drinker, and tries to get thin; then he takes a turn at gymnastics; sometimes idling and neglecting everything, then once more living the life of a philosopher; often he is busy with politics, and starts to his feet and says and does whatever comes into his head; and, if he is emulous of any one who is a warrior, off he is in that direction, or of men of business, once more in that. His life has neither law nor order; and this distracted existence he terms joy and bliss and freedom; and so he goes on.

Yes, he replied, he is all liberty and equality.

Yes, I said; his life is motley and manifold and an epitome of the lives of many;—he answers to the State which we described as fair and spangled. And many a man and many a woman will take him for their pattern, and many a constitution and many an example of manners is contained in him.

Just so.

Let him then be set over against democracy; he may truly be called the democratic man.

Let that be his place, he said.

Last of all comes the most beautiful of all, man and State alike, tyranny and the tyrant; these we have now to consider.

Quite true, he said.

Say then, my friend, In what manner does tyranny arise?—that it has a democratic origin is evident.

Clearly.

And does not tyranny spring from democracy in the same manner as democracy from oligarchy—I mean, after a sort?

How?

The good which oligarchy proposed to itself and the means by which it was maintained was excess of wealth—am I not right?

Yes.

And the insatiable desire of wealth and the neglect of all other things for the sake of money-getting was also the ruin of oligarchy?

True.

And democracy has her own good, of which the insatiable desire brings her to dissolution?

What good?

Freedom, I replied; which, as they tell you in a democracy, is the glory of the State—and that therefore in a democracy alone will the freeman of nature deign to dwell.

Yes; the saying is in every body's mouth.

I was going to observe, that the insatiable desire of this and the neglect of other things introduces the change in democracy, which occasions a demand for tyranny.

How so?

When a democracy which is thirsting for freedom has evil cup-bearers presiding over the feast, and has drunk too deeply of the strong wine of freedom, then, unless her rulers are very amenable and give a plentiful draught, she calls them to account and punishes them, and says that they are cursed oligarchs.

Yes, he replied, a very common occurrence.

Yes, I said; and loyal citizens are insultingly termed by her slaves who hug their chains and men of naught; she would have subjects who are like rulers, and rulers who are like subjects: these are men after her own heart, whom she praises and honours both in private and public. Now, in such a State, can liberty have any limit?

Certainly not.

By degrees the anarchy finds a way into private houses, and ends by getting among the animals and infecting them.

How do you mean?

I mean that the father grows accustomed to descend to the level of his sons and to fear them, and the son is on a level with his father, he having no respect or reverence for either of his parents; and this is his freedom, and the metic is equal with the citizen and the citizen with the metic, and the stranger is quite as good as either.

Yes, he said, that is the way.

And these are not the only evils, I said—there are several lesser ones: In such a state of society the master fears and flatters his scholars, and the scholars despise their masters and tutors; young and old are all alike; and the young man is on a level with the old, and is ready to compete with him in word or deed; and old men condescend to the young and are full of pleasantry and gaiety; they are loth to be thought morose and authoritative, and therefore they adopt the manners of the young.

Quite true, he said.

The last extreme of popular liberty is when the slave bought with money, whether male or female, is just as free as his or her purchaser; nor must I forget to tell of the liberty and equality of the two sexes in relation to each other.

Why not, as Aeschylus says, utter the word which rises to our lips?

That is what I am doing, I replied; and I must add that no one who does not know would believe, how much greater is the liberty which the animals who are under the dominion of man have in a democracy than in any other State: for truly, the she-dogs, as the proverb says, are as good as their she-mistresses, and the horses and asses have a way of marching along with all the rights and dignities of freemen; and they will run at any body who comes in their way if he does not leave the road clear for them: and all things are just ready to burst with liberty.

When I take a country walk, he said, I often experience what you describe. You and I have dreamed the same thing.

And above all, I said, and as the result of all, see how sensitive the citizens become; they chafe impatiently at the least touch of authority, and at length, as you know, they cease to care even for the laws, written or unwritten; they will have no one over them.

Yes, he said, I know it too well.

Such, my friend, I said, is the fair and glorious beginning out of which springs tyranny.

Glorious indeed, he said. But what is the next step?

The ruin of oligarchy is the ruin of democracy; the same disease magnified and intensified by liberty overmasters democracy—the truth being that the excessive increase of anything often causes a reaction in the opposite direction; and this is the case not only in the seasons and in vegetable and animal life, but above all in forms of government.

True.

The excess of liberty, whether in States or individuals, seems only to pass into excess of slavery.

Yes, the natural order.

And so tyranny naturally arises out of democracy, and the most aggravated form of tyranny and slavery out of the most extreme form of liberty?

As we might expect.

That, however, was not, as I believe, your question—you rather desired to know what is that disorder which is generated alike in oligarchy and democracy, and is the ruin of both?

Just so, he replied.

Well, I said, I meant to refer to the class of idle spendthrifts, of whom the more courageous are the leaders and the more timid the followers, the same whom we were comparing to drones, some stingless, and others having stings.

A very just comparison.

These two classes are the plagues of every city in which they are generated, being what phlegm and bile are to the body. And the good physician and lawgiver of the State ought, like the wise bee-master, to keep them at a distance and prevent, if possible, their ever coming in; and if they have anyhow found a way in, then he should have them and their cells cut out as speedily as possible.

Yes, by all means, he said.

Then, in order that we may see clearly what we are doing, let us imagine democracy to be divided, as indeed it is, into three classes; for in the first place freedom creates rather more drones in the democratic than there were in the oligarchical State.

That is true.

And in the democracy they are certainly more intensified.

How so?

Because in the oligarchical State they are disqualified and driven from office, and therefore they cannot train or gather strength; whereas in a democracy they are almost the entire ruling power, and while the keener sort speak and act, the rest keep buzzing about the bema and do not suffer a word to be said on the other side; hence in democracies almost everything is managed by the drones.

Very true, he said.

Then there is another class which is always being severed from the mass.

What is that?

They are the orderly class, which in a nation of traders is sure to be the richest.

Naturally so.

They are the most squeezable persons and yield the largest amount of honey to the drones.

Why, he said, there is little to be squeezed out of people who have little.

And this is called the wealthy class, and the drones feed upon them.

That is pretty much the case, he said.

The people are a third class, consisting of those who work with their own hands; they are not politicians, and have not much to live upon. This, when assembled, is the largest and most powerful class in a democracy.

True, he said; but then the multitude is seldom willing to congregate unless they get a little honey.

And do they not share? I said. Do not their leaders deprive the rich of their estates and distribute them among the people; at the same time taking care to reserve the larger part for themselves?

Why, yes, he said, to that extent the people do share.

And the persons whose property is taken from them are compelled to defend themselves before the people as they best can?

What else can they do?

And then, although they may have no desire of change, the others charge them with plotting against the people and being friends of oligarchy?

True.

And the end is that when they see the people, not of their own accord, but through ignorance, and because they are deceived by informers, seeking to do them wrong, then at last they are forced to become oligarchs in reality; they do not wish to be, but the sting of the drones torments them and breeds revolution in them.

That is exactly the truth.

Then come impeachments and judgments and trials of one another.

True.

The people have always some champion whom they set over them and nurse into greatness.

Yes, that is their way.

This and no other is the root from which a tyrant springs; when he first appears above ground he is a protector.

Yes, that is quite clear.

How then does a protector begin to change into a tyrant? Clearly when he does what the man is said to do in the tale of the Arcadian temple of Lycaean Zeus.

What tale?

The tale is that he who has tasted the entrails of a single human victim minced up with the entrails of other victims is destined to become a wolf. Did you never hear it?

Oh, yes.

And the protector of the people is like him; having a mob entirely at his disposal, he is not restrained from shedding the blood of kinsmen; by the favourite method of false accusation he brings them into court and murders them, making the life of man to disappear, and with unholy tongue and lips tasting the blood of his fellow citizens; some he kills and others he banishes, at the same time hinting at the abolition of debts and partition of lands: and after this, what will be his destiny? Must he not either perish at the hands of his enemies, or from being a man become a wolf—that is, a tyrant?

Inevitably.

This, I said, is he who begins to make a party against the rich?

The same.

After a while he is driven out, but comes back, in spite of his enemies, a tyrant full grown.

That is clear.

And if they are unable to expel him, or to get him condemned to death by a public accusation, they conspire to assassinate him.

Yes, he said, that is their usual way.

Then comes the famous request for a body-guard, which is the device of all those who have got thus far in their tyrannical career—'Let not the people's friend,' as they say, 'be lost to them.'

Exactly.

The people readily assent; all their fears are for him—they have none for themselves.

Very true.

And when a man who is wealthy and is also accused of being an enemy of the people sees this, then, my friend, as the oracle said to Croesus,

'By pebbly Hermus' shore he flees and rests not, and is not ashamed to be a coward.'

And quite right too, said he, for if he were, he would never be ashamed again.

But if he is caught he dies.

Of course.

And he, the protector of whom we spoke, is to be seen, not 'larding the plain' with his bulk, but himself the overthrower of many, standing up in the chariot of State with the reins in his hand, no longer protector, but tyrant absolute.

No doubt, he said.

And now let us consider the happiness of the man, and also of the State in which a creature like him is generated.

Yes, he said, let us consider that.

At first, in the early days of his power, he is full of smiles, and he salutes every one whom he meets;—he to be called a tyrant, who is making promises in public and also in private! liberating debtors, and distributing land to the people and his followers, and wanting to be so kind and good to every one!

Of course, he said.

But when he has disposed of foreign enemies by conquest or treaty, and there is nothing to fear from them, then he is always stirring up some war or other, in order that the people may require a leader.

To be sure.

Has he not also another object, which is that they may be impoverished by payment of taxes, and thus compelled to devote themselves to their daily wants and therefore less likely to conspire against him?

Clearly.

And if any of them are suspected by him of having notions of freedom, and of resistance to his authority, he will have a good pretext for destroying them by placing them at the mercy of the enemy; and for all these reasons the tyrant must be always getting up a war.

He must.

Now he begins to grow unpopular.

A necessary result.

Then some of those who joined in setting him up, and who are in power, speak their minds to him and to one another, and the more courageous of them cast in his teeth what is being done.

Yes, that may be expected.

And the tyrant, if he means to rule, must get rid of them; he cannot stop while he has a friend or an enemy who is good for anything.

He cannot.

And therefore he must look about him and see who is valiant, who is high-minded, who is wise, who is wealthy; happy man, he is the enemy of them all, and must seek occasion against them whether he will or no, until he has made a purgation of the State.

Yes, he said, and a rare purgation.

Yes, I said, not the sort of purgation which the physicians make of the body; for they take away the worse and leave the better part, but he does the reverse.

If he is to rule, I suppose that he cannot help himself.

What a blessed alternative, I said:—to be compelled to dwell only with the many bad, and to be by them hated, or not to live at all!

Yes, that is the alternative.

And the more detestable his actions are to the citizens the more satellites and the greater devotion in them will he require?

Certainly.

And who are the devoted band, and where will he procure them?

They will flock to him, he said, of their own accord, if he pays them.

By the dog! I said, here are more drones, of every sort and from every land.

Yes, he said, there are.

But will he not desire to get them on the spot?

How do you mean?

He will rob the citizens of their slaves; he will then set them free and enrol them in his body-guard.

To be sure, he said; and he will be able to trust them best of all.

What a blessed creature, I said, must this tyrant be; he has put to death the others and has these for his trusted friends.

Yes, he said; they are quite of his sort.

Yes, I said, and these are the new citizens whom he has called into existence, who admire him and are his companions, while the good hate and avoid him.

Of course.

Verily, then, tragedy is a wise thing and Euripides a great tragedian.

Why so?

Why, because he is the author of the pregnant saying,

'Tyrants are wise by living with the wise;'

and he clearly meant to say that they are the wise whom the tyrant makes his companions.

Yes, he said, and he also praises tyranny as godlike; and many other things of the same kind are said by him and by the other poets.

And therefore, I said, the tragic poets being wise men will forgive us and any others who live after our manner if we do not receive them into our State, because they are the eulogists of tyranny.

Yes, he said, those who have the wit will doubtless forgive us.

But they will continue to go to other cities and attract mobs, and hire voices fair and loud and persuasive, and draw the cities over to tyrannies and democracies.

Very true.

Moreover, they are paid for this and receive honour—the greatest honour, as might be expected, from tyrants, and the next greatest from democracies; but the higher they ascend our constitution hill, the more their reputation fails, and seems unable from shortness of breath to proceed further.

True.

But we are wandering from the subject: Let us therefore return and enquire how the tyrant will maintain that fair and numerous and various and ever-changing army of his.

If, he said, there are sacred treasures in the city, he will confiscate and spend them; and in so far as the fortunes of attainted persons may suffice, he will be able to diminish the taxes which he would otherwise have to impose upon the people.

And when these fail?

Why, clearly, he said, then he and his boon companions, whether male or female, will be maintained out of his father's estate.

You mean to say that the people, from whom he has derived his being, will maintain him and his companions?

Yes, he said; they cannot help themselves.

But what if the people fly into a passion, and aver that a grown-up son ought not to be supported by his father, but that the father should be supported by the son? The father did not bring him into being, or settle him in life, in order that when his son became a man he should himself be the servant of his own servants and should support him and his rabble of slaves and companions; but that his son should protect him, and that by his help he might be emancipated from the government of the rich and aristocratic, as they are termed. And so he bids him and his companions depart, just as any other father might drive out of the house a riotous son and his undesirable associates.

By heaven, he said, then the parent will discover what a monster he has been fostering in his bosom; and, when he wants to drive him out, he will find that he is weak and his son strong.

Why, you do not mean to say that the tyrant will use violence? What! beat his father if he opposes him?

Yes, he will, having first disarmed him.

Then he is a parricide, and a cruel guardian of an aged parent; and this is real tyranny, about which there can be no longer a mistake: as the saying is, the people who would escape the smoke which is the slavery of freemen, has fallen into the fire which is the tyranny of slaves. Thus liberty, getting out of all order and reason, passes into the harshest and bitterest form of slavery.

True, he said.

Very well; and may we not rightly say that we have sufficiently discussed the nature of tyranny, and the manner of the transition from democracy to tyranny?

Yes, quite enough, he said.</pre>
</div>
<div created="20150302205627172" modified="20150302213003881" tags="" title="Book X (Jowett translation)">
<pre>Of the many excellences which I perceive in the order of our State, there is none which upon reflection pleases me better than the rule about poetry.

To what do you refer?

To the rejection of imitative poetry, which certainly ought not to be received; as I see far more clearly now that the parts of the soul have been distinguished.

What do you mean?

Speaking in confidence, for I should not like to have my words repeated to the tragedians and the rest of the imitative tribe—but I do not mind saying to you, that all poetical imitations are ruinous to the understanding of the hearers, and that the knowledge of their true nature is the only antidote to them.

Explain the purport of your remark.

Well, I will tell you, although I have always from my earliest youth had an awe and love of Homer, which even now makes the words falter on my lips, for he is the great captain and teacher of the whole of that charming tragic company; but a man is not to be reverenced more than the truth, and therefore I will speak out.

Very good, he said.

Listen to me then, or rather, answer me.

Put your question.

Can you tell me what imitation is? for I really do not know.

A likely thing, then, that I should know.

Why not? for the duller eye may often see a thing sooner than the keener.

Very true, he said; but in your presence, even if I had any faint notion, I could not muster courage to utter it. Will you enquire yourself?

Well then, shall we begin the enquiry in our usual manner: Whenever a number of individuals have a common name, we assume them to have also a corresponding idea or form:—do you understand me?

I do.

Let us take any common instance; there are beds and tables in the world—plenty of them, are there not?

Yes.

But there are only two ideas or forms of them—one the idea of a bed, the other of a table.

True.

And the maker of either of them makes a bed or he makes a table for our use, in accordance with the idea—that is our way of speaking in this and similar instances—but no artificer makes the ideas themselves: how could he?

Impossible.

And there is another artist,—I should like to know what you would say of him.

Who is he?

One who is the maker of all the works of all other workmen.

What an extraordinary man!

Wait a little, and there will be more reason for your saying so. For this is he who is able to make not only vessels of every kind, but plants and animals, himself and all other things—the earth and heaven, and the things which are in heaven or under the earth; he makes the gods also.

He must be a wizard and no mistake.

Oh! you are incredulous, are you? Do you mean that there is no such maker or creator, or that in one sense there might be a maker of all these things but in another not? Do you see that there is a way in which you could make them all yourself?

What way?

An easy way enough; or rather, there are many ways in which the feat might be quickly and easily accomplished, none quicker than that of turning a mirror round and round—you would soon enough make the sun and the heavens, and the earth and yourself, and other animals and plants, and all the other things of which we were just now speaking, in the mirror.

Yes, he said; but they would be appearances only.

Very good, I said, you are coming to the point now. And the painter too is, as I conceive, just such another—a creator of appearances, is he not?

Of course.

But then I suppose you will say that what he creates is untrue. And yet there is a sense in which the painter also creates a bed?

Yes, he said, but not a real bed.

And what of the maker of the bed? were you not saying that he too makes, not the idea which, according to our view, is the essence of the bed, but only a particular bed?

Yes, I did.

Then if he does not make that which exists he cannot make true existence, but only some semblance of existence; and if any one were to say that the work of the maker of the bed, or of any other workman, has real existence, he could hardly be supposed to be speaking the truth.

At any rate, he replied, philosophers would say that he was not speaking the truth.

No wonder, then, that his work too is an indistinct expression of truth.

No wonder.

Suppose now that by the light of the examples just offered we enquire who this imitator is?

If you please.

Well then, here are three beds: one existing in nature, which is made by God, as I think that we may say—for no one else can be the maker?

No.

There is another which is the work of the carpenter?

Yes.

And the work of the painter is a third?

Yes.

Beds, then, are of three kinds, and there are three artists who superintend them: God, the maker of the bed, and the painter?

Yes, there are three of them.

God, whether from choice or from necessity, made one bed in nature and one only; two or more such ideal beds neither ever have been nor ever will be made by God.

Why is that?

Because even if He had made but two, a third would still appear behind them which both of them would have for their idea, and that would be the ideal bed and not the two others.

Very true, he said.

God knew this, and He desired to be the real maker of a real bed, not a particular maker of a particular bed, and therefore He created a bed which is essentially and by nature one only.

So we believe.

Shall we, then, speak of Him as the natural author or maker of the bed?

Yes, he replied; inasmuch as by the natural process of creation He is the author of this and of all other things.

And what shall we say of the carpenter—is not he also the maker of the bed?

Yes.

But would you call the painter a creator and maker?

Certainly not.

Yet if he is not the maker, what is he in relation to the bed?

I think, he said, that we may fairly designate him as the imitator of that which the others make.

Good, I said; then you call him who is third in the descent from nature an imitator?

Certainly, he said.

And the tragic poet is an imitator, and therefore, like all other imitators, he is thrice removed from the king and from the truth?

That appears to be so.

Then about the imitator we are agreed. And what about the painter?—I would like to know whether he may be thought to imitate that which originally exists in nature, or only the creations of artists?

The latter.

As they are or as they appear? you have still to determine this.

What do you mean?

I mean, that you may look at a bed from different points of view, obliquely or directly or from any other point of view, and the bed will appear different, but there is no difference in reality. And the same of all things.

Yes, he said, the difference is only apparent.

Now let me ask you another question: Which is the art of painting designed to be—an imitation of things as they are, or as they appear—of appearance or of reality?

Of appearance.

Then the imitator, I said, is a long way off the truth, and can do all things because he lightly touches on a small part of them, and that part an image. For example: A painter will paint a cobbler, carpenter, or any other artist, though he knows nothing of their arts; and, if he is a good artist, he may deceive children or simple persons, when he shows them his picture of a carpenter from a distance, and they will fancy that they are looking at a real carpenter.

Certainly.

And whenever any one informs us that he has found a man who knows all the arts, and all things else that anybody knows, and every single thing with a higher degree of accuracy than any other man—whoever tells us this, I think that we can only imagine him to be a simple creature who is likely to have been deceived by some wizard or actor whom he met, and whom he thought all-knowing, because he himself was unable to analyse the nature of knowledge and ignorance and imitation.

Most true.

And so, when we hear persons saying that the tragedians, and Homer, who is at their head, know all the arts and all things human, virtue as well as vice, and divine things too, for that the good poet cannot compose well unless he knows his subject, and that he who has not this knowledge can never be a poet, we ought to consider whether here also there may not be a similar illusion. Perhaps they may have come across imitators and been deceived by them; they may not have remembered when they saw their works that these were but imitations thrice removed from the truth, and could easily be made without any knowledge of the truth, because they are appearances only and not realities? Or, after all, they may be in the right, and poets do really know the things about which they seem to the many to speak so well?

The question, he said, should by all means be considered.

Now do you suppose that if a person were able to make the original as well as the image, he would seriously devote himself to the image-making branch? Would he allow imitation to be the ruling principle of his life, as if he had nothing higher in him?

I should say not.

The real artist, who knew what he was imitating, would be interested in realities and not in imitations; and would desire to leave as memorials of himself works many and fair; and, instead of being the author of encomiums, he would prefer to be the theme of them.

Yes, he said, that would be to him a source of much greater honour and profit.

Then, I said, we must put a question to Homer; not about medicine, or any of the arts to which his poems only incidentally refer: we are not going to ask him, or any other poet, whether he has cured patients like Asclepius, or left behind him a school of medicine such as the Asclepiads were, or whether he only talks about medicine and other arts at second-hand; but we have a right to know respecting military tactics, politics, education, which are the chiefest and noblest subjects of his poems, and we may fairly ask him about them. 'Friend Homer,' then we say to him, 'if you are only in the second remove from truth in what you say of virtue, and not in the third—not an image maker or imitator—and if you are able to discern what pursuits make men better or worse in private or public life, tell us what State was ever better governed by your help? The good order of Lacedaemon is due to Lycurgus, and many other cities great and small have been similarly benefited by others; but who says that you have been a good legislator to them and have done them any good? Italy and Sicily boast of Charondas, and there is Solon who is renowned among us; but what city has anything to say about you?' Is there any city which he might name?

I think not, said Glaucon; not even the Homerids themselves pretend that he was a legislator.

Well, but is there any war on record which was carried on successfully by him, or aided by his counsels, when he was alive?

There is not.

Or is there any invention of his, applicable to the arts or to human life, such as Thales the Milesian or Anacharsis the Scythian, and other ingenious men have conceived, which is attributed to him?

There is absolutely nothing of the kind.

But, if Homer never did any public service, was he privately a guide or teacher of any? Had he in his lifetime friends who loved to associate with him, and who handed down to posterity an Homeric way of life, such as was established by Pythagoras who was so greatly beloved for his wisdom, and whose followers are to this day quite celebrated for the order which was named after him?

Nothing of the kind is recorded of him. For surely, Socrates, Creophylus, the companion of Homer, that child of flesh, whose name always makes us laugh, might be more justly ridiculed for his stupidity, if, as is said, Homer was greatly neglected by him and others in his own day when he was alive?

Yes, I replied, that is the tradition. But can you imagine, Glaucon, that if Homer had really been able to educate and improve mankind—if he had possessed knowledge and not been a mere imitator—can you imagine, I say, that he would not have had many followers, and been honoured and loved by them? Protagoras of Abdera, and Prodicus of Ceos, and a host of others, have only to whisper to their contemporaries: 'You will never be able to manage either your own house or your own State until you appoint us to be your ministers of education'—and this ingenious device of theirs has such an effect in making men love them that their companions all but carry them about on their shoulders. And is it conceivable that the contemporaries of Homer, or again of Hesiod, would have allowed either of them to go about as rhapsodists, if they had really been able to make mankind virtuous? Would they not have been as unwilling to part with them as with gold, and have compelled them to stay at home with them? Or, if the master would not stay, then the disciples would have followed him about everywhere, until they had got education enough?

Yes, Socrates, that, I think, is quite true.

Then must we not infer that all these poetical individuals, beginning with Homer, are only imitators; they copy images of virtue and the like, but the truth they never reach? The poet is like a painter who, as we have already observed, will make a likeness of a cobbler though he understands nothing of cobbling; and his picture is good enough for those who know no more than he does, and judge only by colours and figures.

Quite so.

In like manner the poet with his words and phrases may be said to lay on the colours of the several arts, himself understanding their nature only enough to imitate them; and other people, who are as ignorant as he is, and judge only from his words, imagine that if he speaks of cobbling, or of military tactics, or of anything else, in metre and harmony and rhythm, he speaks very well—such is the sweet influence which melody and rhythm by nature have. And I think that you must have observed again and again what a poor appearance the tales of poets make when stripped of the colours which music puts upon them, and recited in simple prose.

Yes, he said.

They are like faces which were never really beautiful, but only blooming; and now the bloom of youth has passed away from them?

Exactly.

Here is another point: The imitator or maker of the image knows nothing of true existence; he knows appearances only. Am I not right?

Yes.

Then let us have a clear understanding, and not be satisfied with half an explanation.

Proceed.

Of the painter we say that he will paint reins, and he will paint a bit?

Yes.

And the worker in leather and brass will make them?

Certainly.

But does the painter know the right form of the bit and reins? Nay, hardly even the workers in brass and leather who make them; only the horseman who knows how to use them—he knows their right form.

Most true.

And may we not say the same of all things?

What?

That there are three arts which are concerned with all things: one which uses, another which makes, a third which imitates them?

Yes.

And the excellence or beauty or truth of every structure, animate or inanimate, and of every action of man, is relative to the use for which nature or the artist has intended them.

True.

Then the user of them must have the greatest experience of them, and he must indicate to the maker the good or bad qualities which develop themselves in use; for example, the flute-player will tell the flute-maker which of his flutes is satisfactory to the performer; he will tell him how he ought to make them, and the other will attend to his instructions?

Of course.

The one knows and therefore speaks with authority about the goodness and badness of flutes, while the other, confiding in him, will do what he is told by him?

True.

The instrument is the same, but about the excellence or badness of it the maker will only attain to a correct belief; and this he will gain from him who knows, by talking to him and being compelled to hear what he has to say, whereas the user will have knowledge?

True.

But will the imitator have either? Will he know from use whether or no his drawing is correct or beautiful? or will he have right opinion from being compelled to associate with another who knows and gives him instructions about what he should draw?

Neither.

Then he will no more have true opinion than he will have knowledge about the goodness or badness of his imitations?

I suppose not.

The imitative artist will be in a brilliant state of intelligence about his own creations?

Nay, very much the reverse.

And still he will go on imitating without knowing what makes a thing good or bad, and may be expected therefore to imitate only that which appears to be good to the ignorant multitude?

Just so.

Thus far then we are pretty well agreed that the imitator has no knowledge worth mentioning of what he imitates. Imitation is only a kind of play or sport, and the tragic poets, whether they write in Iambic or in Heroic verse, are imitators in the highest degree?

Very true.

And now tell me, I conjure you, has not imitation been shown by us to be concerned with that which is thrice removed from the truth?

Certainly.

And what is the faculty in man to which imitation is addressed?

What do you mean?

I will explain: The body which is large when seen near, appears small when seen at a distance?

True.

And the same object appears straight when looked at out of the water, and crooked when in the water; and the concave becomes convex, owing to the illusion about colours to which the sight is liable. Thus every sort of confusion is revealed within us; and this is that weakness of the human mind on which the art of conjuring and of deceiving by light and shadow and other ingenious devices imposes, having an effect upon us like magic.

True.

And the arts of measuring and numbering and weighing come to the rescue of the human understanding—there is the beauty of them—and the apparent greater or less, or more or heavier, no longer have the mastery over us, but give way before calculation and measure and weight?

Most true.

And this, surely, must be the work of the calculating and rational principle in the soul?

To be sure.

And when this principle measures and certifies that some things are equal, or that some are greater or less than others, there occurs an apparent contradiction?

True.

But were we not saying that such a contradiction is impossible—the same faculty cannot have contrary opinions at the same time about the same thing?

Very true.

Then that part of the soul which has an opinion contrary to measure is not the same with that which has an opinion in accordance with measure?

True.

And the better part of the soul is likely to be that which trusts to measure and calculation?

Certainly.

And that which is opposed to them is one of the inferior principles of the soul?

No doubt.

This was the conclusion at which I was seeking to arrive when I said that painting or drawing, and imitation in general, when doing their own proper work, are far removed from truth, and the companions and friends and associates of a principle within us which is equally removed from reason, and that they have no true or healthy aim.

Exactly.

The imitative art is an inferior who marries an inferior, and has inferior offspring.

Very true.

And is this confined to the sight only, or does it extend to the hearing also, relating in fact to what we term poetry?

Probably the same would be true of poetry.

Do not rely, I said, on a probability derived from the analogy of painting; but let us examine further and see whether the faculty with which poetical imitation is concerned is good or bad.

By all means.

We may state the question thus:—Imitation imitates the actions of men, whether voluntary or involuntary, on which, as they imagine, a good or bad result has ensued, and they rejoice or sorrow accordingly. Is there anything more?

No, there is nothing else.

But in all this variety of circumstances is the man at unity with himself—or rather, as in the instance of sight there was confusion and opposition in his opinions about the same things, so here also is there not strife and inconsistency in his life? Though I need hardly raise the question again, for I remember that all this has been already admitted; and the soul has been acknowledged by us to be full of these and ten thousand similar oppositions occurring at the same moment?

And we were right, he said.

Yes, I said, thus far we were right; but there was an omission which must now be supplied.

What was the omission?

Were we not saying that a good man, who has the misfortune to lose his son or anything else which is most dear to him, will bear the loss with more equanimity than another?

Yes.

But will he have no sorrow, or shall we say that although he cannot help sorrowing, he will moderate his sorrow?

The latter, he said, is the truer statement.

Tell me: will he be more likely to struggle and hold out against his sorrow when he is seen by his equals, or when he is alone?

It will make a great difference whether he is seen or not.

When he is by himself he will not mind saying or doing many things which he would be ashamed of any one hearing or seeing him do?

True.

There is a principle of law and reason in him which bids him resist, as well as a feeling of his misfortune which is forcing him to indulge his sorrow?

True.

But when a man is drawn in two opposite directions, to and from the same object, this, as we affirm, necessarily implies two distinct principles in him?

Certainly.

One of them is ready to follow the guidance of the law?

How do you mean?

The law would say that to be patient under suffering is best, and that we should not give way to impatience, as there is no knowing whether such things are good or evil; and nothing is gained by impatience; also, because no human thing is of serious importance, and grief stands in the way of that which at the moment is most required.

What is most required? he asked.

That we should take counsel about what has happened, and when the dice have been thrown order our affairs in the way which reason deems best; not, like children who have had a fall, keeping hold of the part struck and wasting time in setting up a howl, but always accustoming the soul forthwith to apply a remedy, raising up that which is sickly and fallen, banishing the cry of sorrow by the healing art.

Yes, he said, that is the true way of meeting the attacks of fortune.

Yes, I said; and the higher principle is ready to follow this suggestion of reason?

Clearly.

And the other principle, which inclines us to recollection of our troubles and to lamentation, and can never have enough of them, we may call irrational, useless, and cowardly?

Indeed, we may.

And does not the latter—I mean the rebellious principle—furnish a great variety of materials for imitation? Whereas the wise and calm temperament, being always nearly equable, is not easy to imitate or to appreciate when imitated, especially at a public festival when a promiscuous crowd is assembled in a theatre. For the feeling represented is one to which they are strangers.

Certainly.

Then the imitative poet who aims at being popular is not by nature made, nor is his art intended, to please or to affect the rational principle in the soul; but he will prefer the passionate and fitful temper, which is easily imitated?

Clearly.

And now we may fairly take him and place him by the side of the painter, for he is like him in two ways: first, inasmuch as his creations have an inferior degree of truth—in this, I say, he is like him; and he is also like him in being concerned with an inferior part of the soul; and therefore we shall be right in refusing to admit him into a well-ordered State, because he awakens and nourishes and strengthens the feelings and impairs the reason. As in a city when the evil are permitted to have authority and the good are put out of the way, so in the soul of man, as we maintain, the imitative poet implants an evil constitution, for he indulges the irrational nature which has no discernment of greater and less, but thinks the same thing at one time great and at another small—he is a manufacturer of images and is very far removed from the truth.

Exactly.

But we have not yet brought forward the heaviest count in our accusation:—the power which poetry has of harming even the good (and there are very few who are not harmed), is surely an awful thing?

Yes, certainly, if the effect is what you say.

Hear and judge: The best of us, as I conceive, when we listen to a passage of Homer, or one of the tragedians, in which he represents some pitiful hero who is drawling out his sorrows in a long oration, or weeping, and smiting his breast—the best of us, you know, delight in giving way to sympathy, and are in raptures at the excellence of the poet who stirs our feelings most.

Yes, of course I know.

But when any sorrow of our own happens to us, then you may observe that we pride ourselves on the opposite quality—we would fain be quiet and patient; this is the manly part, and the other which delighted us in the recitation is now deemed to be the part of a woman.

Very true, he said.

Now can we be right in praising and admiring another who is doing that which any one of us would abominate and be ashamed of in his own person?

No, he said, that is certainly not reasonable.

Nay, I said, quite reasonable from one point of view.

What point of view?

If you consider, I said, that when in misfortune we feel a natural hunger and desire to relieve our sorrow by weeping and lamentation, and that this feeling which is kept under control in our own calamities is satisfied and delighted by the poets;—the better nature in each of us, not having been sufficiently trained by reason or habit, allows the sympathetic element to break loose because the sorrow is another's; and the spectator fancies that there can be no disgrace to himself in praising and pitying any one who comes telling him what a good man he is, and making a fuss about his troubles; he thinks that the pleasure is a gain, and why should he be supercilious and lose this and the poem too? Few persons ever reflect, as I should imagine, that from the evil of other men something of evil is communicated to themselves. And so the feeling of sorrow which has gathered strength at the sight of the misfortunes of others is with difficulty repressed in our own.

How very true!

And does not the same hold also of the ridiculous? There are jests which you would be ashamed to make yourself, and yet on the comic stage, or indeed in private, when you hear them, you are greatly amused by them, and are not at all disgusted at their unseemliness;—the case of pity is repeated;—there is a principle in human nature which is disposed to raise a laugh, and this which you once restrained by reason, because you were afraid of being thought a buffoon, is now let out again; and having stimulated the risible faculty at the theatre, you are betrayed unconsciously to yourself into playing the comic poet at home.

Quite true, he said.

And the same may be said of lust and anger and all the other affections, of desire and pain and pleasure, which are held to be inseparable from every action—in all of them poetry feeds and waters the passions instead of drying them up; she lets them rule, although they ought to be controlled, if mankind are ever to increase in happiness and virtue.

I cannot deny it.

Therefore, Glaucon, I said, whenever you meet with any of the eulogists of Homer declaring that he has been the educator of Hellas, and that he is profitable for education and for the ordering of human things, and that you should take him up again and again and get to know him and regulate your whole life according to him, we may love and honour those who say these things—they are excellent people, as far as their lights extend; and we are ready to acknowledge that Homer is the greatest of poets and first of tragedy writers; but we must remain firm in our conviction that hymns to the gods and praises of famous men are the only poetry which ought to be admitted into our State. For if you go beyond this and allow the honeyed muse to enter, either in epic or lyric verse, not law and the reason of mankind, which by common consent have ever been deemed best, but pleasure and pain will be the rulers in our State.

That is most true, he said.

And now since we have reverted to the subject of poetry, let this our defence serve to show the reasonableness of our former judgment in sending away out of our State an art having the tendencies which we have described; for reason constrained us. But that she may not impute to us any harshness or want of politeness, let us tell her that there is an ancient quarrel between philosophy and poetry; of which there are many proofs, such as the saying of 'the yelping hound howling at her lord,' or of one 'mighty in the vain talk of fools,' and 'the mob of sages circumventing Zeus,' and the 'subtle thinkers who are beggars after all'; and there are innumerable other signs of ancient enmity between them. Notwithstanding this, let us assure our sweet friend and the sister arts of imitation, that if she will only prove her title to exist in a well-ordered State we shall be delighted to receive her—we are very conscious of her charms; but we may not on that account betray the truth. I dare say, Glaucon, that you are as much charmed by her as I am, especially when she appears in Homer?

Yes, indeed, I am greatly charmed.

Shall I propose, then, that she be allowed to return from exile, but upon this condition only—that she make a defence of herself in lyrical or some other metre?

Certainly.

And we may further grant to those of her defenders who are lovers of poetry and yet not poets the permission to speak in prose on her behalf: let them show not only that she is pleasant but also useful to States and to human life, and we will listen in a kindly spirit; for if this can be proved we shall surely be the gainers—I mean, if there is a use in poetry as well as a delight?

Certainly, he said, we shall be the gainers.

If her defence fails, then, my dear friend, like other persons who are enamoured of something, but put a restraint upon themselves when they think their desires are opposed to their interests, so too must we after the manner of lovers give her up, though not without a struggle. We too are inspired by that love of poetry which the education of noble States has implanted in us, and therefore we would have her appear at her best and truest; but so long as she is unable to make good her defence, this argument of ours shall be a charm to us, which we will repeat to ourselves while we listen to her strains; that we may not fall away into the childish love of her which captivates the many. At all events we are well aware that poetry being such as we have described is not to be regarded seriously as attaining to the truth; and he who listens to her, fearing for the safety of the city which is within him, should be on his guard against her seductions and make our words his law.

Yes, he said, I quite agree with you.

Yes, I said, my dear Glaucon, for great is the issue at stake, greater than appears, whether a man is to be good or bad. And what will any one be profited if under the influence of honour or money or power, aye, or under the excitement of poetry, he neglect justice and virtue?

Yes, he said; I have been convinced by the argument, as I believe that any one else would have been.

And yet no mention has been made of the greatest prizes and rewards which await virtue.

What, are there any greater still? If there are, they must be of an inconceivable greatness.

Why, I said, what was ever great in a short time? The whole period of three score years and ten is surely but a little thing in comparison with eternity?

Say rather 'nothing,' he replied.

And should an immortal being seriously think of this little space rather than of the whole?

Of the whole, certainly. But why do you ask?

Are you not aware, I said, that the soul of man is immortal and imperishable?

He looked at me in astonishment, and said: No, by heaven: And are you really prepared to maintain this?

Yes, I said, I ought to be, and you too—there is no difficulty in proving it.

I see a great difficulty; but I should like to hear you state this argument of which you make so light.

Listen then.

I am attending.

There is a thing which you call good and another which you call evil?

Yes, he replied.

Would you agree with me in thinking that the corrupting and destroying element is the evil, and the saving and improving element the good?

Yes.

And you admit that every thing has a good and also an evil; as ophthalmia is the evil of the eyes and disease of the whole body; as mildew is of corn, and rot of timber, or rust of copper and iron: in everything, or in almost everything, there is an inherent evil and disease?

Yes, he said.

And anything which is infected by any of these evils is made evil, and at last wholly dissolves and dies?

True.

The vice and evil which is inherent in each is the destruction of each; and if this does not destroy them there is nothing else that will; for good certainly will not destroy them, nor again, that which is neither good nor evil.

Certainly not.

If, then, we find any nature which having this inherent corruption cannot be dissolved or destroyed, we may be certain that of such a nature there is no destruction?

That may be assumed.

Well, I said, and is there no evil which corrupts the soul?

Yes, he said, there are all the evils which we were just now passing in review: unrighteousness, intemperance, cowardice, ignorance.

But does any of these dissolve or destroy her?—and here do not let us fall into the error of supposing that the unjust and foolish man, when he is detected, perishes through his own injustice, which is an evil of the soul. Take the analogy of the body: The evil of the body is a disease which wastes and reduces and annihilates the body; and all the things of which we were just now speaking come to annihilation through their own corruption attaching to them and inhering in them and so destroying them. Is not this true?

Yes.

Consider the soul in like manner. Does the injustice or other evil which exists in the soul waste and consume her? Do they by attaching to the soul and inhering in her at last bring her to death, and so separate her from the body?

Certainly not.

And yet, I said, it is unreasonable to suppose that anything can perish from without through affection of external evil which could not be destroyed from within by a corruption of its own?

It is, he replied.

Consider, I said, Glaucon, that even the badness of food, whether staleness, decomposition, or any other bad quality, when confined to the actual food, is not supposed to destroy the body; although, if the badness of food communicates corruption to the body, then we should say that the body has been destroyed by a corruption of itself, which is disease, brought on by this; but that the body, being one thing, can be destroyed by the badness of food, which is another, and which does not engender any natural infection—this we shall absolutely deny?

Very true.

And, on the same principle, unless some bodily evil can produce an evil of the soul, we must not suppose that the soul, which is one thing, can be dissolved by any merely external evil which belongs to another?

Yes, he said, there is reason in that.

Either, then, let us refute this conclusion, or, while it remains unrefuted, let us never say that fever, or any other disease, or the knife put to the throat, or even the cutting up of the whole body into the minutest pieces, can destroy the soul, until she herself is proved to become more unholy or unrighteous in consequence of these things being done to the body; but that the soul, or anything else if not destroyed by an internal evil, can be destroyed by an external one, is not to be affirmed by any man.

And surely, he replied, no one will ever prove that the souls of men become more unjust in consequence of death.

But if some one who would rather not admit the immortality of the soul boldly denies this, and says that the dying do really become more evil and unrighteous, then, if the speaker is right, I suppose that injustice, like disease, must be assumed to be fatal to the unjust, and that those who take this disorder die by the natural inherent power of destruction which evil has, and which kills them sooner or later, but in quite another way from that in which, at present, the wicked receive death at the hands of others as the penalty of their deeds?

Nay, he said, in that case injustice, if fatal to the unjust, will not be so very terrible to him, for he will be delivered from evil. But I rather suspect the opposite to be the truth, and that injustice which, if it have the power, will murder others, keeps the murderer alive—aye, and well awake too; so far removed is her dwelling-place from being a house of death.

True, I said; if the inherent natural vice or evil of the soul is unable to kill or destroy her, hardly will that which is appointed to be the destruction of some other body, destroy a soul or anything else except that of which it was appointed to be the destruction.

Yes, that can hardly be.

But the soul which cannot be destroyed by an evil, whether inherent or external, must exist for ever, and if existing for ever, must be immortal?

Certainly.

That is the conclusion, I said; and, if a true conclusion, then the souls must always be the same, for if none be destroyed they will not diminish in number. Neither will they increase, for the increase of the immortal natures must come from something mortal, and all things would thus end in immortality.

Very true.

But this we cannot believe—reason will not allow us—any more than we can believe the soul, in her truest nature, to be full of variety and difference and dissimilarity.

What do you mean? he said.

The soul, I said, being, as is now proven, immortal, must be the fairest of compositions and cannot be compounded of many elements?

Certainly not.

Her immortality is demonstrated by the previous argument, and there are many other proofs; but to see her as she really is, not as we now behold her, marred by communion with the body and other miseries, you must contemplate her with the eye of reason, in her original purity; and then her beauty will be revealed, and justice and injustice and all the things which we have described will be manifested more clearly. Thus far, we have spoken the truth concerning her as she appears at present, but we must remember also that we have seen her only in a condition which may be compared to that of the sea-god Glaucus, whose original image can hardly be discerned because his natural members are broken off and crushed and damaged by the waves in all sorts of ways, and incrustations have grown over them of seaweed and shells and stones, so that he is more like some monster than he is to his own natural form. And the soul which we behold is in a similar condition, disfigured by ten thousand ills. But not there, Glaucon, not there must we look.

Where then?

At her love of wisdom. Let us see whom she affects, and what society and converse she seeks in virtue of her near kindred with the immortal and eternal and divine; also how different she would become if wholly following this superior principle, and borne by a divine impulse out of the ocean in which she now is, and disengaged from the stones and shells and things of earth and rock which in wild variety spring up around her because she feeds upon earth, and is overgrown by the good things of this life as they are termed: then you would see her as she is, and know whether she have one shape only or many, or what her nature is. Of her affections and of the forms which she takes in this present life I think that we have now said enough.

True, he replied.

And thus, I said, we have fulfilled the conditions of the argument; we have not introduced the rewards and glories of justice, which, as you were saying, are to be found in Homer and Hesiod; but justice in her own nature has been shown to be best for the soul in her own nature. Let a man do what is just, whether he have the ring of Gyges or not, and even if in addition to the ring of Gyges he put on the helmet of Hades.

Very true.

And now, Glaucon, there will be no harm in further enumerating how many and how great are the rewards which justice and the other virtues procure to the soul from gods and men, both in life and after death.

Certainly not, he said.

Will you repay me, then, what you borrowed in the argument?

What did I borrow?

The assumption that the just man should appear unjust and the unjust just: for you were of opinion that even if the true state of the case could not possibly escape the eyes of gods and men, still this admission ought to be made for the sake of the argument, in order that pure justice might be weighed against pure injustice. Do you remember?

I should be much to blame if I had forgotten.

Then, as the cause is decided, I demand on behalf of justice that the estimation in which she is held by gods and men and which we acknowledge to be her due should now be restored to her by us; since she has been shown to confer reality, and not to deceive those who truly possess her, let what has been taken from her be given back, that so she may win that palm of appearance which is hers also, and which she gives to her own.

The demand, he said, is just.

In the first place, I said—and this is the first thing which you will have to give back—the nature both of the just and unjust is truly known to the gods.

Granted.

And if they are both known to them, one must be the friend and the other the enemy of the gods, as we admitted from the beginning?

True.

And the friend of the gods may be supposed to receive from them all things at their best, excepting only such evil as is the necessary consequence of former sins?

Certainly.

Then this must be our notion of the just man, that even when he is in poverty or sickness, or any other seeming misfortune, all things will in the end work together for good to him in life and death: for the gods have a care of any one whose desire is to become just and to be like God, as far as man can attain the divine likeness, by the pursuit of virtue?

Yes, he said; if he is like God he will surely not be neglected by him.

And of the unjust may not the opposite be supposed?

Certainly.

Such, then, are the palms of victory which the gods give the just?

That is my conviction.

And what do they receive of men? Look at things as they really are, and you will see that the clever unjust are in the case of runners, who run well from the starting-place to the goal but not back again from the goal: they go off at a great pace, but in the end only look foolish, slinking away with their ears draggling on their shoulders, and without a crown; but the true runner comes to the finish and receives the prize and is crowned. And this is the way with the just; he who endures to the end of every action and occasion of his entire life has a good report and carries off the prize which men have to bestow.

True.

And now you must allow me to repeat of the just the blessings which you were attributing to the fortunate unjust. I shall say of them, what you were saying of the others, that as they grow older, they become rulers in their own city if they care to be; they marry whom they like and give in marriage to whom they will; all that you said of the others I now say of these. And, on the other hand, of the unjust I say that the greater number, even though they escape in their youth, are found out at last and look foolish at the end of their course, and when they come to be old and miserable are flouted alike by stranger and citizen; they are beaten and then come those things unfit for ears polite, as you truly term them; they will be racked and have their eyes burned out, as you were saying. And you may suppose that I have repeated the remainder of your tale of horrors. But will you let me assume, without reciting them, that these things are true?

Certainly, he said, what you say is true.

These, then, are the prizes and rewards and gifts which are bestowed upon the just by gods and men in this present life, in addition to the other good things which justice of herself provides.

Yes, he said; and they are fair and lasting.

And yet, I said, all these are as nothing either in number or greatness in comparison with those other recompenses which await both just and unjust after death. And you ought to hear them, and then both just and unjust will have received from us a full payment of the debt which the argument owes to them.

Speak, he said; there are few things which I would more gladly hear.

Well, I said, I will tell you a tale; not one of the tales which Odysseus tells to the hero Alcinous, yet this too is a tale of a hero, Er the son of Armenius, a Pamphylian by birth. He was slain in battle, and ten days afterwards, when the bodies of the dead were taken up already in a state of corruption, his body was found unaffected by decay, and carried away home to be buried. And on the twelfth day, as he was lying on the funeral pile, he returned to life and told them what he had seen in the other world. He said that when his soul left the body he went on a journey with a great company, and that they came to a mysterious place at which there were two openings in the earth; they were near together, and over against them were two other openings in the heaven above. In the intermediate space there were judges seated, who commanded the just, after they had given judgment on them and had bound their sentences in front of them, to ascend by the heavenly way on the right hand; and in like manner the unjust were bidden by them to descend by the lower way on the left hand; these also bore the symbols of their deeds, but fastened on their backs. He drew near, and they told him that he was to be the messenger who would carry the report of the other world to men, and they bade him hear and see all that was to be heard and seen in that place. Then he beheld and saw on one side the souls departing at either opening of heaven and earth when sentence had been given on them; and at the two other openings other souls, some ascending out of the earth dusty and worn with travel, some descending out of heaven clean and bright. And arriving ever and anon they seemed to have come from a long journey, and they went forth with gladness into the meadow, where they encamped as at a festival; and those who knew one another embraced and conversed, the souls which came from earth curiously enquiring about the things above, and the souls which came from heaven about the things beneath. And they told one another of what had happened by the way, those from below weeping and sorrowing at the remembrance of the things which they had endured and seen in their journey beneath the earth (now the journey lasted a thousand years), while those from above were describing heavenly delights and visions of inconceivable beauty. The story, Glaucon, would take too long to tell; but the sum was this:—He said that for every wrong which they had done to any one they suffered tenfold; or once in a hundred years—such being reckoned to be the length of man's life, and the penalty being thus paid ten times in a thousand years. If, for example, there were any who had been the cause of many deaths, or had betrayed or enslaved cities or armies, or been guilty of any other evil behaviour, for each and all of their offences they received punishment ten times over, and the rewards of beneficence and justice and holiness were in the same proportion. I need hardly repeat what he said concerning young children dying almost as soon as they were born. Of piety and impiety to gods and parents, and of murderers, there were retributions other and greater far which he described. He mentioned that he was present when one of the spirits asked another, 'Where is Ardiaeus the Great?' (Now this Ardiaeus lived a thousand years before the time of Er: he had been the tyrant of some city of Pamphylia, and had murdered his aged father and his elder brother, and was said to have committed many other abominable crimes.) The answer of the other spirit was: 'He comes not hither and will never come. And this,' said he, 'was one of the dreadful sights which we ourselves witnessed. We were at the mouth of the cavern, and, having completed all our experiences, were about to reascend, when of a sudden Ardiaeus appeared and several others, most of whom were tyrants; and there were also besides the tyrants private individuals who had been great criminals: they were just, as they fancied, about to return into the upper world, but the mouth, instead of admitting them, gave a roar, whenever any of these incurable sinners or some one who had not been sufficiently punished tried to ascend; and then wild men of fiery aspect, who were standing by and heard the sound, seized and carried them off; and Ardiaeus and others they bound head and foot and hand, and threw them down and flayed them with scourges, and dragged them along the road at the side, carding them on thorns like wool, and declaring to the passers-by what were their crimes, and that they were being taken away to be cast into hell.' And of all the many terrors which they had endured, he said that there was none like the terror which each of them felt at that moment, lest they should hear the voice; and when there was silence, one by one they ascended with exceeding joy. These, said Er, were the penalties and retributions, and there were blessings as great.

Now when the spirits which were in the meadow had tarried seven days, on the eighth they were obliged to proceed on their journey, and, on the fourth day after, he said that they came to a place where they could see from above a line of light, straight as a column, extending right through the whole heaven and through the earth, in colour resembling the rainbow, only brighter and purer; another day's journey brought them to the place, and there, in the midst of the light, they saw the ends of the chains of heaven let down from above: for this light is the belt of heaven, and holds together the circle of the universe, like the under-girders of a trireme. From these ends is extended the spindle of Necessity, on which all the revolutions turn. The shaft and hook of this spindle are made of steel, and the whorl is made partly of steel and also partly of other materials. Now the whorl is in form like the whorl used on earth; and the description of it implied that there is one large hollow whorl which is quite scooped out, and into this is fitted another lesser one, and another, and another, and four others, making eight in all, like vessels which fit into one another; the whorls show their edges on the upper side, and on their lower side all together form one continuous whorl. This is pierced by the spindle, which is driven home through the centre of the eighth. The first and outermost whorl has the rim broadest, and the seven inner whorls are narrower, in the following proportions—the sixth is next to the first in size, the fourth next to the sixth; then comes the eighth; the seventh is fifth, the fifth is sixth, the third is seventh, last and eighth comes the second. The largest (or fixed stars) is spangled, and the seventh (or sun) is brightest; the eighth (or moon) coloured by the reflected light of the seventh; the second and fifth (Saturn and Mercury) are in colour like one another, and yellower than the preceding; the third (Venus) has the whitest light; the fourth (Mars) is reddish; the sixth (Jupiter) is in whiteness second. Now the whole spindle has the same motion; but, as the whole revolves in one direction, the seven inner circles move slowly in the other, and of these the swiftest is the eighth; next in swiftness are the seventh, sixth, and fifth, which move together; third in swiftness appeared to move according to the law of this reversed motion the fourth; the third appeared fourth and the second fifth. The spindle turns on the knees of Necessity; and on the upper surface of each circle is a siren, who goes round with them, hymning a single tone or note. The eight together form one harmony; and round about, at equal intervals, there is another band, three in number, each sitting upon her throne: these are the Fates, daughters of Necessity, who are clothed in white robes and have chaplets upon their heads, Lachesis and Clotho and Atropos, who accompany with their voices the harmony of the sirens—Lachesis singing of the past, Clotho of the present, Atropos of the future; Clotho from time to time assisting with a touch of her right hand the revolution of the outer circle of the whorl or spindle, and Atropos with her left hand touching and guiding the inner ones, and Lachesis laying hold of either in turn, first with one hand and then with the other.

When Er and the spirits arrived, their duty was to go at once to Lachesis; but first of all there came a prophet who arranged them in order; then he took from the knees of Lachesis lots and samples of lives, and having mounted a high pulpit, spoke as follows: 'Hear the word of Lachesis, the daughter of Necessity. Mortal souls, behold a new cycle of life and mortality. Your genius will not be allotted to you, but you will choose your genius; and let him who draws the first lot have the first choice, and the life which he chooses shall be his destiny. Virtue is free, and as a man honours or dishonours her he will have more or less of her; the responsibility is with the chooser—God is justified.' When the Interpreter had thus spoken he scattered lots indifferently among them all, and each of them took up the lot which fell near him, all but Er himself (he was not allowed), and each as he took his lot perceived the number which he had obtained. Then the Interpreter placed on the ground before them the samples of lives; and there were many more lives than the souls present, and they were of all sorts. There were lives of every animal and of man in every condition. And there were tyrannies among them, some lasting out the tyrant's life, others which broke off in the middle and came to an end in poverty and exile and beggary; and there were lives of famous men, some who were famous for their form and beauty as well as for their strength and success in games, or, again, for their birth and the qualities of their ancestors; and some who were the reverse of famous for the opposite qualities. And of women likewise; there was not, however, any definite character in them, because the soul, when choosing a new life, must of necessity become different. But there was every other quality, and the all mingled with one another, and also with elements of wealth and poverty, and disease and health; and there were mean states also. And here, my dear Glaucon, is the supreme peril of our human state; and therefore the utmost care should be taken. Let each one of us leave every other kind of knowledge and seek and follow one thing only, if peradventure he may be able to learn and may find some one who will make him able to learn and discern between good and evil, and so to choose always and everywhere the better life as he has opportunity. He should consider the bearing of all these things which have been mentioned severally and collectively upon virtue; he should know what the effect of beauty is when combined with poverty or wealth in a particular soul, and what are the good and evil consequences of noble and humble birth, of private and public station, of strength and weakness, of cleverness and dullness, and of all the natural and acquired gifts of the soul, and the operation of them when conjoined; he will then look at the nature of the soul, and from the consideration of all these qualities he will be able to determine which is the better and which is the worse; and so he will choose, giving the name of evil to the life which will make his soul more unjust, and good to the life which will make his soul more just; all else he will disregard. For we have seen and know that this is the best choice both in life and after death. A man must take with him into the world below an adamantine faith in truth and right, that there too he may be undazzled by the desire of wealth or the other allurements of evil, lest, coming upon tyrannies and similar villainies, he do irremediable wrongs to others and suffer yet worse himself; but let him know how to choose the mean and avoid the extremes on either side, as far as possible, not only in this life but in all that which is to come. For this is the way of happiness.

And according to the report of the messenger from the other world this was what the prophet said at the time: 'Even for the last comer, if he chooses wisely and will live diligently, there is appointed a happy and not undesirable existence. Let not him who chooses first be careless, and let not the last despair.' And when he had spoken, he who had the first choice came forward and in a moment chose the greatest tyranny; his mind having been darkened by folly and sensuality, he had not thought out the whole matter before he chose, and did not at first sight perceive that he was fated, among other evils, to devour his own children. But when he had time to reflect, and saw what was in the lot, he began to beat his breast and lament over his choice, forgetting the proclamation of the prophet; for, instead of throwing the blame of his misfortune on himself, he accused chance and the gods, and everything rather than himself. Now he was one of those who came from heaven, and in a former life had dwelt in a well-ordered State, but his virtue was a matter of habit only, and he had no philosophy. And it was true of others who were similarly overtaken, that the greater number of them came from heaven and therefore they had never been schooled by trial, whereas the pilgrims who came from earth having themselves suffered and seen others suffer, were not in a hurry to choose. And owing to this inexperience of theirs, and also because the lot was a chance, many of the souls exchanged a good destiny for an evil or an evil for a good. For if a man had always on his arrival in this world dedicated himself from the first to sound philosophy, and had been moderately fortunate in the number of the lot, he might, as the messenger reported, be happy here, and also his journey to another life and return to this, instead of being rough and underground, would be smooth and heavenly. Most curious, he said, was the spectacle—sad and laughable and strange; for the choice of the souls was in most cases based on their experience of a previous life. There he saw the soul which had once been Orpheus choosing the life of a swan out of enmity to the race of women, hating to be born of a woman because they had been his murderers; he beheld also the soul of Thamyras choosing the life of a nightingale; birds, on the other hand, like the swan and other musicians, wanting to be men. The soul which obtained the twentieth lot chose the life of a lion, and this was the soul of Ajax the son of Telamon, who would not be a man, remembering the injustice which was done him in the judgment about the arms. The next was Agamemnon, who took the life of an eagle, because, like Ajax, he hated human nature by reason of his sufferings. About the middle came the lot of Atalanta; she, seeing the great fame of an athlete, was unable to resist the temptation: and after her there followed the soul of Epeus the son of Panopeus passing into the nature of a woman cunning in the arts; and far away among the last who chose, the soul of the jester Thersites was putting on the form of a monkey. There came also the soul of Odysseus having yet to make a choice, and his lot happened to be the last of them all. Now the recollection of former toils had disenchanted him of ambition, and he went about for a considerable time in search of the life of a private man who had no cares; he had some difficulty in finding this, which was lying about and had been neglected by everybody else; and when he saw it, he said that he would have done the same had his lot been first instead of last, and that he was delighted to have it. And not only did men pass into animals, but I must also mention that there were animals tame and wild who changed into one another and into corresponding human natures—the good into the gentle and the evil into the savage, in all sorts of combinations.

All the souls had now chosen their lives, and they went in the order of their choice to Lachesis, who sent with them the genius whom they had severally chosen, to be the guardian of their lives and the fulfiller of the choice: this genius led the souls first to Clotho, and drew them within the revolution of the spindle impelled by her hand, thus ratifying the destiny of each; and then, when they were fastened to this, carried them to Atropos, who spun the threads and made them irreversible, whence without turning round they passed beneath the throne of Necessity; and when they had all passed, they marched on in a scorching heat to the plain of Forgetfulness, which was a barren waste destitute of trees and verdure; and then towards evening they encamped by the river of Unmindfulness, whose water no vessel can hold; of this they were all obliged to drink a certain quantity, and those who were not saved by wisdom drank more than was necessary; and each one as he drank forgot all things. Now after they had gone to rest, about the middle of the night there was a thunderstorm and earthquake, and then in an instant they were driven upwards in all manner of ways to their birth, like stars shooting. He himself was hindered from drinking the water. But in what manner or by what means he returned to the body he could not say; only, in the morning, awaking suddenly, he found himself lying on the pyre.

And thus, Glaucon, the tale has been saved and has not perished, and will save us if we are obedient to the word spoken; and we shall pass safely over the river of Forgetfulness and our soul will not be defiled. Wherefore my counsel is, that we hold fast ever to the heavenly way and follow after justice and virtue always, considering that the soul is immortal and able to endure every sort of good and every sort of evil. Thus shall we live dear to one another and to the gods, both while remaining here and when, like conquerors in the games who go round to gather gifts, we receive our reward. And it shall be well with us both in this life and in the pilgrimage of a thousand years which we have been describing.</pre>
</div>
<div created="20150203201733929" creator="D.F." modified="20150302214946666" modifier="D.F." tags="$:/tags/SideBar" title="Help" type="application/x-tiddler">
<pre>Republic: Personal Wiki by [[David Fisco|http://www.davidfisco.com]]

* [[Republic Personal Wiki Homepage|http://personal-wikis.davidfisco.com/republic]]
* Feedback: [[Email David Fisco|mailto:bulkmail@davidfisco.com?subject=Republic+Personal+Wiki+Feedback]]
* [[TiddlyWiki Homepage|http://tiddlywiki.com/]]
* [[TiddlyWiki Markdown|http://tiddlywiki.com/#WikiText]]</pre>
</div>
<div created="20150302192148912" modified="20150302214745194" tags="" title="Introduction and Analysis by Benjamin Jowett">
<pre>The Republic of Plato is the longest of his works with the exception of the Laws, and is certainly the greatest of them. There are nearer approaches to modern metaphysics in the Philebus and in the Sophist; the Politicus or Statesman is more ideal; the form and institutions of the State are more clearly drawn out in the Laws; as works of art, the Symposium and the Protagoras are of higher excellence. But no other Dialogue of Plato has the same largeness of view and the same perfection of style; no other shows an equal knowledge of the world, or contains more of those thoughts which are new as well as old, and not of one age only but of all. Nowhere in Plato is there a deeper irony or a greater wealth of humour or imagery, or more dramatic power. Nor in any other of his writings is the attempt made to interweave life and speculation, or to connect politics with philosophy. The Republic is the centre around which the other Dialogues may be grouped; here philosophy reaches the highest point (cp, especially in Books V, VI, VII) to which ancient thinkers ever attained. Plato among the Greeks, like Bacon among the moderns, was the first who conceived a method of knowledge, although neither of them always distinguished the bare outline or form from the substance of truth; and both of them had to be content with an abstraction of science which was not yet realized. He was the greatest metaphysical genius whom the world has seen; and in him, more than in any other ancient thinker, the germs of future knowledge are contained. The sciences of logic and psychology, which have supplied so many instruments of thought to after-ages, are based upon the analyses of Socrates and Plato. The principles of definition, the law of contradiction, the fallacy of arguing in a circle, the distinction between the essence and accidents of a thing or notion, between means and ends, between causes and conditions; also the division of the mind into the rational, concupiscent, and irascible elements, or of pleasures and desires into necessary and unnecessary—these and other great forms of thought are all of them to be found in the Republic, and were probably first invented by Plato. The greatest of all logical truths, and the one of which writers on philosophy are most apt to lose sight, the difference between words and things, has been most strenuously insisted on by him (cp. Rep.; Polit.; Cratyl), although he has not always avoided the confusion of them in his own writings (e.g. Rep.). But he does not bind up truth in logical formulae,—logic is still veiled in metaphysics; and the science which he imagines to 'contemplate all truth and all existence' is very unlike the doctrine of the syllogism which Aristotle claims to have discovered (Soph. Elenchi).

Neither must we forget that the Republic is but the third part of a still larger design which was to have included an ideal history of Athens, as well as a political and physical philosophy. The fragment of the Critias has given birth to a world-famous fiction, second only in importance to the tale of Troy and the legend of Arthur; and is said as a fact to have inspired some of the early navigators of the sixteenth century. This mythical tale, of which the subject was a history of the wars of the Athenians against the Island of Atlantis, is supposed to be founded upon an unfinished poem of Solon, to which it would have stood in the same relation as the writings of the logographers to the poems of Homer. It would have told of a struggle for Liberty (cp. Tim.), intended to represent the conflict of Persia and Hellas. We may judge from the noble commencement of the Timaeus, from the fragment of the Critias itself, and from the third book of the Laws, in what manner Plato would have treated this high argument. We can only guess why the great design was abandoned; perhaps because Plato became sensible of some incongruity in a fictitious history, or because he had lost his interest in it, or because advancing years forbade the completion of it; and we may please ourselves with the fancy that had this imaginary narrative ever been finished, we should have found Plato himself sympathising with the struggle for Hellenic independence (cp. Laws), singing a hymn of triumph over Marathon and Salamis, perhaps making the reflection of Herodotus where he contemplates the growth of the Athenian empire—'How brave a thing is freedom of speech, which has made the Athenians so far exceed every other state of Hellas in greatness!' or, more probably, attributing the victory to the ancient good order of Athens and to the favor of Apollo and Athene (cp. Introd. to Critias).

Again, Plato may be regarded as the 'captain' ('arhchegoz') or leader of a goodly band of followers; for in the Republic is to be found the original of Cicero's De Republica, of St. Augustine's City of God, of the Utopia of Sir Thomas More, and of the numerous other imaginary States which are framed upon the same model. The extent to which Aristotle or the Aristotelian school were indebted to him in the Politics has been little recognised, and the recognition is the more necessary because it is not made by Aristotle himself. The two philosophers had more in common than they were conscious of; and probably some elements of Plato remain still undetected in Aristotle. In English philosophy too, many affinities may be traced, not only in the works of the Cambridge Platonists, but in great original writers like Berkeley or Coleridge, to Plato and his ideas. That there is a truth higher than experience, of which the mind bears witness to herself, is a conviction which in our own generation has been enthusiastically asserted, and is perhaps gaining ground. Of the Greek authors who at the Renaissance brought a new life into the world Plato has had the greatest influence. The Republic of Plato is also the first treatise upon education, of which the writings of Milton and Locke, Rousseau, Jean Paul, and Goethe are the legitimate descendants. Like Dante or Bunyan, he has a revelation of another life; like Bacon, he is profoundly impressed with the unity of knowledge; in the early Church he exercised a real influence on theology, and at the Revival of Literature on politics. Even the fragments of his words when 'repeated at second-hand' (Symp.) have in all ages ravished the hearts of men, who have seen reflected in them their own higher nature. He is the father of idealism in philosophy, in politics, in literature. And many of the latest conceptions of modern thinkers and statesmen, such as the unity of knowledge, the reign of law, and the equality of the sexes, have been anticipated in a dream by him.

The argument of the Republic is the search after Justice, the nature of which is first hinted at by Cephalus, the just and blameless old man—then discussed on the basis of proverbial morality by Socrates and Polemarchus—then caricatured by Thrasymachus and partially explained by Socrates—reduced to an abstraction by Glaucon and Adeimantus, and having become invisible in the individual reappears at length in the ideal State which is constructed by Socrates. The first care of the rulers is to be education, of which an outline is drawn after the old Hellenic model, providing only for an improved religion and morality, and more simplicity in music and gymnastic, a manlier strain of poetry, and greater harmony of the individual and the State. We are thus led on to the conception of a higher State, in which 'no man calls anything his own,' and in which there is neither 'marrying nor giving in marriage,' and 'kings are philosophers' and 'philosophers are kings;' and there is another and higher education, intellectual as well as moral and religious, of science as well as of art, and not of youth only but of the whole of life. Such a State is hardly to be realized in this world and quickly degenerates. To the perfect ideal succeeds the government of the soldier and the lover of honour, this again declining into democracy, and democracy into tyranny, in an imaginary but regular order having not much resemblance to the actual facts. When 'the wheel has come full circle' we do not begin again with a new period of human life; but we have passed from the best to the worst, and there we end. The subject is then changed and the old quarrel of poetry and philosophy which had been more lightly treated in the earlier books of the Republic is now resumed and fought out to a conclusion. Poetry is discovered to be an imitation thrice removed from the truth, and Homer, as well as the dramatic poets, having been condemned as an imitator, is sent into banishment along with them. And the idea of the State is supplemented by the revelation of a future life.

The division into books, like all similar divisions (Cp. Sir G.C. Lewis in the Classical Museum.), is probably later than the age of Plato. The natural divisions are five in number;—(1) Book I and the first half of Book II down to the paragraph beginning, 'I had always admired the genius of Glaucon and Adeimantus,' which is introductory; the first book containing a refutation of the popular and sophistical notions of justice, and concluding, like some of the earlier Dialogues, without arriving at any definite result. To this is appended a restatement of the nature of justice according to common opinion, and an answer is demanded to the question—What is justice, stripped of appearances? The second division (2) includes the remainder of the second and the whole of the third and fourth books, which are mainly occupied with the construction of the first State and the first education. The third division (3) consists of the fifth, sixth, and seventh books, in which philosophy rather than justice is the subject of enquiry, and the second State is constructed on principles of communism and ruled by philosophers, and the contemplation of the idea of good takes the place of the social and political virtues. In the eighth and ninth books (4) the perversions of States and of the individuals who correspond to them are reviewed in succession; and the nature of pleasure and the principle of tyranny are further analysed in the individual man. The tenth book (5) is the conclusion of the whole, in which the relations of philosophy to poetry are finally determined, and the happiness of the citizens in this life, which has now been assured, is crowned by the vision of another.

Or a more general division into two parts may be adopted; the first (Books I - IV) containing the description of a State framed generally in accordance with Hellenic notions of religion and morality, while in the second (Books V - X) the Hellenic State is transformed into an ideal kingdom of philosophy, of which all other governments are the perversions. These two points of view are really opposed, and the opposition is only veiled by the genius of Plato. The Republic, like the Phaedrus (see Introduction to Phaedrus), is an imperfect whole; the higher light of philosophy breaks through the regularity of the Hellenic temple, which at last fades away into the heavens. Whether this imperfection of structure arises from an enlargement of the plan; or from the imperfect reconcilement in the writer's own mind of the struggling elements of thought which are now first brought together by him; or, perhaps, from the composition of the work at different times—are questions, like the similar question about the Iliad and the Odyssey, which are worth asking, but which cannot have a distinct answer. In the age of Plato there was no regular mode of publication, and an author would have the less scruple in altering or adding to a work which was known only to a few of his friends. There is no absurdity in supposing that he may have laid his labours aside for a time, or turned from one work to another; and such interruptions would be more likely to occur in the case of a long than of a short writing. In all attempts to determine the chronological order of the Platonic writings on internal evidence, this uncertainty about any single Dialogue being composed at one time is a disturbing element, which must be admitted to affect longer works, such as the Republic and the Laws, more than shorter ones. But, on the other hand, the seeming discrepancies of the Republic may only arise out of the discordant elements which the philosopher has attempted to unite in a single whole, perhaps without being himself able to recognise the inconsistency which is obvious to us. For there is a judgment of after ages which few great writers have ever been able to anticipate for themselves. They do not perceive the want of connexion in their own writings, or the gaps in their systems which are visible enough to those who come after them. In the beginnings of literature and philosophy, amid the first efforts of thought and language, more inconsistencies occur than now, when the paths of speculation are well worn and the meaning of words precisely defined. For consistency, too, is the growth of time; and some of the greatest creations of the human mind have been wanting in unity. Tried by this test, several of the Platonic Dialogues, according to our modern ideas, appear to be defective, but the deficiency is no proof that they were composed at different times or by different hands. And the supposition that the Republic was written uninterruptedly and by a continuous effort is in some degree confirmed by the numerous references from one part of the work to another.

The second title, 'Concerning Justice,' is not the one by which the Republic is quoted, either by Aristotle or generally in antiquity, and, like the other second titles of the Platonic Dialogues, may therefore be assumed to be of later date. Morgenstern and others have asked whether the definition of justice, which is the professed aim, or the construction of the State is the principal argument of the work. The answer is, that the two blend in one, and are two faces of the same truth; for justice is the order of the State, and the State is the visible embodiment of justice under the conditions of human society. The one is the soul and the other is the body, and the Greek ideal of the State, as of the individual, is a fair mind in a fair body. In Hegelian phraseology the state is the reality of which justice is the idea. Or, described in Christian language, the kingdom of God is within, and yet developes into a Church or external kingdom; 'the house not made with hands, eternal in the heavens,' is reduced to the proportions of an earthly building. Or, to use a Platonic image, justice and the State are the warp and the woof which run through the whole texture. And when the constitution of the State is completed, the conception of justice is not dismissed, but reappears under the same or different names throughout the work, both as the inner law of the individual soul, and finally as the principle of rewards and punishments in another life. The virtues are based on justice, of which common honesty in buying and selling is the shadow, and justice is based on the idea of good, which is the harmony of the world, and is reflected both in the institutions of states and in motions of the heavenly bodies (cp. Tim.). The Timaeus, which takes up the political rather than the ethical side of the Republic, and is chiefly occupied with hypotheses concerning the outward world, yet contains many indications that the same law is supposed to reign over the State, over nature, and over man.

Too much, however, has been made of this question both in ancient and modern times. There is a stage of criticism in which all works, whether of nature or of art, are referred to design. Now in ancient writings, and indeed in literature generally, there remains often a large element which was not comprehended in the original design. For the plan grows under the author's hand; new thoughts occur to him in the act of writing; he has not worked out the argument to the end before he begins. The reader who seeks to find some one idea under which the whole may be conceived, must necessarily seize on the vaguest and most general. Thus Stallbaum, who is dissatisfied with the ordinary explanations of the argument of the Republic, imagines himself to have found the true argument 'in the representation of human life in a State perfected by justice, and governed according to the idea of good.' There may be some use in such general descriptions, but they can hardly be said to express the design of the writer. The truth is, that we may as well speak of many designs as of one; nor need anything be excluded from the plan of a great work to which the mind is naturally led by the association of ideas, and which does not interfere with the general purpose. What kind or degree of unity is to be sought after in a building, in the plastic arts, in poetry, in prose, is a problem which has to be determined relatively to the subject-matter. To Plato himself, the enquiry 'what was the intention of the writer,' or 'what was the principal argument of the Republic' would have been hardly intelligible, and therefore had better be at once dismissed (cp. the Introduction to the Phaedrus).

Is not the Republic the vehicle of three or four great truths which, to Plato's own mind, are most naturally represented in the form of the State? Just as in the Jewish prophets the reign of Messiah, or 'the day of the Lord,' or the suffering Servant or people of God, or the 'Sun of righteousness with healing in his wings' only convey, to us at least, their great spiritual ideals, so through the Greek State Plato reveals to us his own thoughts about divine perfection, which is the idea of good—like the sun in the visible world;—about human perfection, which is justice—about education beginning in youth and continuing in later years—about poets and sophists and tyrants who are the false teachers and evil rulers of mankind—about 'the world' which is the embodiment of them—about a kingdom which exists nowhere upon earth but is laid up in heaven to be the pattern and rule of human life. No such inspired creation is at unity with itself, any more than the clouds of heaven when the sun pierces through them. Every shade of light and dark, of truth, and of fiction which is the veil of truth, is allowable in a work of philosophical imagination. It is not all on the same plane; it easily passes from ideas to myths and fancies, from facts to figures of speech. It is not prose but poetry, at least a great part of it, and ought not to be judged by the rules of logic or the probabilities of history. The writer is not fashioning his ideas into an artistic whole; they take possession of him and are too much for him. We have no need therefore to discuss whether a State such as Plato has conceived is practicable or not, or whether the outward form or the inward life came first into the mind of the writer. For the practicability of his ideas has nothing to do with their truth; and the highest thoughts to which he attains may be truly said to bear the greatest 'marks of design'—justice more than the external frame-work of the State, the idea of good more than justice. The great science of dialectic or the organisation of ideas has no real content; but is only a type of the method or spirit in which the higher knowledge is to be pursued by the spectator of all time and all existence. It is in the fifth, sixth, and seventh books that Plato reaches the 'summit of speculation,' and these, although they fail to satisfy the requirements of a modern thinker, may therefore be regarded as the most important, as they are also the most original, portions of the work.

It is not necessary to discuss at length a minor question which has been raised by Boeckh, respecting the imaginary date at which the conversation was held (the year 411 B.C. which is proposed by him will do as well as any other); for a writer of fiction, and especially a writer who, like Plato, is notoriously careless of chronology (cp. Rep., Symp., etc.), only aims at general probability. Whether all the persons mentioned in the Republic could ever have met at any one time is not a difficulty which would have occurred to an Athenian reading the work forty years later, or to Plato himself at the time of writing (any more than to Shakespeare respecting one of his own dramas); and need not greatly trouble us now. Yet this may be a question having no answer 'which is still worth asking,' because the investigation shows that we cannot argue historically from the dates in Plato; it would be useless therefore to waste time in inventing far-fetched reconcilements of them in order to avoid chronological difficulties, such, for example, as the conjecture of C.F. Hermann, that Glaucon and Adeimantus are not the brothers but the uncles of Plato (cp. Apol.), or the fancy of Stallbaum that Plato intentionally left anachronisms indicating the dates at which some of his Dialogues were written.

The principal characters in the Republic are Cephalus, Polemarchus, Thrasymachus, Socrates, Glaucon, and Adeimantus. Cephalus appears in the introduction only, Polemarchus drops at the end of the first argument, and Thrasymachus is reduced to silence at the close of the first book. The main discussion is carried on by Socrates, Glaucon, and Adeimantus. Among the company are Lysias (the orator) and Euthydemus, the sons of Cephalus and brothers of Polemarchus, an unknown Charmantides—these are mute auditors; also there is Cleitophon, who once interrupts, where, as in the Dialogue which bears his name, he appears as the friend and ally of Thrasymachus.

Cephalus, the patriarch of the house, has been appropriately engaged in offering a sacrifice. He is the pattern of an old man who has almost done with life, and is at peace with himself and with all mankind. He feels that he is drawing nearer to the world below, and seems to linger around the memory of the past. He is eager that Socrates should come to visit him, fond of the poetry of the last generation, happy in the consciousness of a well-spent life, glad at having escaped from the tyranny of youthful lusts. His love of conversation, his affection, his indifference to riches, even his garrulity, are interesting traits of character. He is not one of those who have nothing to say, because their whole mind has been absorbed in making money. Yet he acknowledges that riches have the advantage of placing men above the temptation to dishonesty or falsehood. The respectful attention shown to him by Socrates, whose love of conversation, no less than the mission imposed upon him by the Oracle, leads him to ask questions of all men, young and old alike, should also be noted. Who better suited to raise the question of justice than Cephalus, whose life might seem to be the expression of it? The moderation with which old age is pictured by Cephalus as a very tolerable portion of existence is characteristic, not only of him, but of Greek feeling generally, and contrasts with the exaggeration of Cicero in the De Senectute. The evening of life is described by Plato in the most expressive manner, yet with the fewest possible touches. As Cicero remarks (Ep. ad Attic.), the aged Cephalus would have been out of place in the discussion which follows, and which he could neither have understood nor taken part in without a violation of dramatic propriety (cp. Lysimachus in the Laches).

His 'son and heir' Polemarchus has the frankness and impetuousness of youth; he is for detaining Socrates by force in the opening scene, and will not 'let him off' on the subject of women and children. Like Cephalus, he is limited in his point of view, and represents the proverbial stage of morality which has rules of life rather than principles; and he quotes Simonides (cp. Aristoph. Clouds) as his father had quoted Pindar. But after this he has no more to say; the answers which he makes are only elicited from him by the dialectic of Socrates. He has not yet experienced the influence of the Sophists like Glaucon and Adeimantus, nor is he sensible of the necessity of refuting them; he belongs to the pre-Socratic or pre-dialectical age. He is incapable of arguing, and is bewildered by Socrates to such a degree that he does not know what he is saying. He is made to admit that justice is a thief, and that the virtues follow the analogy of the arts. From his brother Lysias (contra Eratosth.) we learn that he fell a victim to the Thirty Tyrants, but no allusion is here made to his fate, nor to the circumstance that Cephalus and his family were of Syracusan origin, and had migrated from Thurii to Athens.

The 'Chalcedonian giant,' Thrasymachus, of whom we have already heard in the Phaedrus, is the personification of the Sophists, according to Plato's conception of them, in some of their worst characteristics. He is vain and blustering, refusing to discourse unless he is paid, fond of making an oration, and hoping thereby to escape the inevitable Socrates; but a mere child in argument, and unable to foresee that the next 'move' (to use a Platonic expression) will 'shut him up.' He has reached the stage of framing general notions, and in this respect is in advance of Cephalus and Polemarchus. But he is incapable of defending them in a discussion, and vainly tries to cover his confusion with banter and insolence. Whether such doctrines as are attributed to him by Plato were really held either by him or by any other Sophist is uncertain; in the infancy of philosophy serious errors about morality might easily grow up—they are certainly put into the mouths of speakers in Thucydides; but we are concerned at present with Plato's description of him, and not with the historical reality. The inequality of the contest adds greatly to the humour of the scene. The pompous and empty Sophist is utterly helpless in the hands of the great master of dialectic, who knows how to touch all the springs of vanity and weakness in him. He is greatly irritated by the irony of Socrates, but his noisy and imbecile rage only lays him more and more open to the thrusts of his assailant. His determination to cram down their throats, or put 'bodily into their souls' his own words, elicits a cry of horror from Socrates. The state of his temper is quite as worthy of remark as the process of the argument. Nothing is more amusing than his complete submission when he has been once thoroughly beaten. At first he seems to continue the discussion with reluctance, but soon with apparent good-will, and he even testifies his interest at a later stage by one or two occasional remarks. When attacked by Glaucon he is humorously protected by Socrates 'as one who has never been his enemy and is now his friend.' From Cicero and Quintilian and from Aristotle's Rhetoric we learn that the Sophist whom Plato has made so ridiculous was a man of note whose writings were preserved in later ages. The play on his name which was made by his contemporary Herodicus (Aris. Rhet.), 'thou wast ever bold in battle,' seems to show that the description of him is not devoid of verisimilitude.

When Thrasymachus has been silenced, the two principal respondents, Glaucon and Adeimantus, appear on the scene: here, as in Greek tragedy (cp. Introd. to Phaedo), three actors are introduced. At first sight the two sons of Ariston may seem to wear a family likeness, like the two friends Simmias and Cebes in the Phaedo. But on a nearer examination of them the similarity vanishes, and they are seen to be distinct characters. Glaucon is the impetuous youth who can 'just never have enough of fechting' (cp. the character of him in Xen. Mem. iii. 6); the man of pleasure who is acquainted with the mysteries of love; the 'juvenis qui gaudet canibus,' and who improves the breed of animals; the lover of art and music who has all the experiences of youthful life. He is full of quickness and penetration, piercing easily below the clumsy platitudes of Thrasymachus to the real difficulty; he turns out to the light the seamy side of human life, and yet does not lose faith in the just and true. It is Glaucon who seizes what may be termed the ludicrous relation of the philosopher to the world, to whom a state of simplicity is 'a city of pigs,' who is always prepared with a jest when the argument offers him an opportunity, and who is ever ready to second the humour of Socrates and to appreciate the ridiculous, whether in the connoisseurs of music, or in the lovers of theatricals, or in the fantastic behaviour of the citizens of democracy. His weaknesses are several times alluded to by Socrates, who, however, will not allow him to be attacked by his brother Adeimantus. He is a soldier, and, like Adeimantus, has been distinguished at the battle of Megara (anno 456?)...The character of Adeimantus is deeper and graver, and the profounder objections are commonly put into his mouth. Glaucon is more demonstrative, and generally opens the game. Adeimantus pursues the argument further. Glaucon has more of the liveliness and quick sympathy of youth; Adeimantus has the maturer judgment of a grown-up man of the world. In the second book, when Glaucon insists that justice and injustice shall be considered without regard to their consequences, Adeimantus remarks that they are regarded by mankind in general only for the sake of their consequences; and in a similar vein of reflection he urges at the beginning of the fourth book that Socrates fails in making his citizens happy, and is answered that happiness is not the first but the second thing, not the direct aim but the indirect consequence of the good government of a State. In the discussion about religion and mythology, Adeimantus is the respondent, but Glaucon breaks in with a slight jest, and carries on the conversation in a lighter tone about music and gymnastic to the end of the book. It is Adeimantus again who volunteers the criticism of common sense on the Socratic method of argument, and who refuses to let Socrates pass lightly over the question of women and children. It is Adeimantus who is the respondent in the more argumentative, as Glaucon in the lighter and more imaginative portions of the Dialogue. For example, throughout the greater part of the sixth book, the causes of the corruption of philosophy and the conception of the idea of good are discussed with Adeimantus. Glaucon resumes his place of principal respondent; but he has a difficulty in apprehending the higher education of Socrates, and makes some false hits in the course of the discussion. Once more Adeimantus returns with the allusion to his brother Glaucon whom he compares to the contentious State; in the next book he is again superseded, and Glaucon continues to the end.

Thus in a succession of characters Plato represents the successive stages of morality, beginning with the Athenian gentleman of the olden time, who is followed by the practical man of that day regulating his life by proverbs and saws; to him succeeds the wild generalization of the Sophists, and lastly come the young disciples of the great teacher, who know the sophistical arguments but will not be convinced by them, and desire to go deeper into the nature of things. These too, like Cephalus, Polemarchus, Thrasymachus, are clearly distinguished from one another. Neither in the Republic, nor in any other Dialogue of Plato, is a single character repeated.

The delineation of Socrates in the Republic is not wholly consistent. In the first book we have more of the real Socrates, such as he is depicted in the Memorabilia of Xenophon, in the earliest Dialogues of Plato, and in the Apology. He is ironical, provoking, questioning, the old enemy of the Sophists, ready to put on the mask of Silenus as well as to argue seriously. But in the sixth book his enmity towards the Sophists abates; he acknowledges that they are the representatives rather than the corrupters of the world. He also becomes more dogmatic and constructive, passing beyond the range either of the political or the speculative ideas of the real Socrates. In one passage Plato himself seems to intimate that the time had now come for Socrates, who had passed his whole life in philosophy, to give his own opinion and not to be always repeating the notions of other men. There is no evidence that either the idea of good or the conception of a perfect state were comprehended in the Socratic teaching, though he certainly dwelt on the nature of the universal and of final causes (cp. Xen. Mem.; Phaedo); and a deep thinker like him, in his thirty or forty years of public teaching, could hardly have failed to touch on the nature of family relations, for which there is also some positive evidence in the Memorabilia (Mem.) The Socratic method is nominally retained; and every inference is either put into the mouth of the respondent or represented as the common discovery of him and Socrates. But any one can see that this is a mere form, of which the affectation grows wearisome as the work advances. The method of enquiry has passed into a method of teaching in which by the help of interlocutors the same thesis is looked at from various points of view. The nature of the process is truly characterized by Glaucon, when he describes himself as a companion who is not good for much in an investigation, but can see what he is shown, and may, perhaps, give the answer to a question more fluently than another.

Neither can we be absolutely certain that Socrates himself taught the immortality of the soul, which is unknown to his disciple Glaucon in the Republic (cp. Apol.); nor is there any reason to suppose that he used myths or revelations of another world as a vehicle of instruction, or that he would have banished poetry or have denounced the Greek mythology. His favorite oath is retained, and a slight mention is made of the daemonium, or internal sign, which is alluded to by Socrates as a phenomenon peculiar to himself. A real element of Socratic teaching, which is more prominent in the Republic than in any of the other Dialogues of Plato, is the use of example and illustration (Greek): 'Let us apply the test of common instances.' 'You,' says Adeimantus, ironically, in the sixth book, 'are so unaccustomed to speak in images.' And this use of examples or images, though truly Socratic in origin, is enlarged by the genius of Plato into the form of an allegory or parable, which embodies in the concrete what has been already described, or is about to be described, in the abstract. Thus the figure of the cave in Book VII is a recapitulation of the divisions of knowledge in Book VI. The composite animal in Book IX is an allegory of the parts of the soul. The noble captain and the ship and the true pilot in Book VI are a figure of the relation of the people to the philosophers in the State which has been described. Other figures, such as the dog, or the marriage of the portionless maiden, or the drones and wasps in the eighth and ninth books, also form links of connexion in long passages, or are used to recall previous discussions.

Plato is most true to the character of his master when he describes him as 'not of this world.' And with this representation of him the ideal state and the other paradoxes of the Republic are quite in accordance, though they cannot be shown to have been speculations of Socrates. To him, as to other great teachers both philosophical and religious, when they looked upward, the world seemed to be the embodiment of error and evil. The common sense of mankind has revolted against this view, or has only partially admitted it. And even in Socrates himself the sterner judgement of the multitude at times passes into a sort of ironical pity or love. Men in general are incapable of philosophy, and are therefore at enmity with the philosopher; but their misunderstanding of him is unavoidable: for they have never seen him as he truly is in his own image; they are only acquainted with artificial systems possessing no native force of truth—words which admit of many applications. Their leaders have nothing to measure with, and are therefore ignorant of their own stature. But they are to be pitied or laughed at, not to be quarrelled with; they mean well with their nostrums, if they could only learn that they are cutting off a Hydra's head. This moderation towards those who are in error is one of the most characteristic features of Socrates in the Republic. In all the different representations of Socrates, whether of Xenophon or Plato, and amid the differences of the earlier or later Dialogues, he always retains the character of the unwearied and disinterested seeker after truth, without which he would have ceased to be Socrates.

Leaving the characters we may now analyse the contents of the Republic, and then proceed to consider (1) The general aspects of this Hellenic ideal of the State, (2) The modern lights in which the thoughts of Plato may be read.

BOOK I. The Republic opens with a truly Greek scene—a festival in honour of the goddess Bendis which is held in the Piraeus; to this is added the promise of an equestrian torch-race in the evening. The whole work is supposed to be recited by Socrates on the day after the festival to a small party, consisting of Critias, Timaeus, Hermocrates, and another; this we learn from the first words of the Timaeus.

When the rhetorical advantage of reciting the Dialogue has been gained, the attention is not distracted by any reference to the audience; nor is the reader further reminded of the extraordinary length of the narrative. Of the numerous company, three only take any serious part in the discussion; nor are we informed whether in the evening they went to the torch-race, or talked, as in the Symposium, through the night. The manner in which the conversation has arisen is described as follows:—Socrates and his companion Glaucon are about to leave the festival when they are detained by a message from Polemarchus, who speedily appears accompanied by Adeimantus, the brother of Glaucon, and with playful violence compels them to remain, promising them not only the torch-race, but the pleasure of conversation with the young, which to Socrates is a far greater attraction. They return to the house of Cephalus, Polemarchus' father, now in extreme old age, who is found sitting upon a cushioned seat crowned for a sacrifice. 'You should come to me oftener, Socrates, for I am too old to go to you; and at my time of life, having lost other pleasures, I care the more for conversation.' Socrates asks him what he thinks of age, to which the old man replies, that the sorrows and discontents of age are to be attributed to the tempers of men, and that age is a time of peace in which the tyranny of the passions is no longer felt. Yes, replies Socrates, but the world will say, Cephalus, that you are happy in old age because you are rich. 'And there is something in what they say, Socrates, but not so much as they imagine—as Themistocles replied to the Seriphian, &quot;Neither you, if you had been an Athenian, nor I, if I had been a Seriphian, would ever have been famous,&quot; I might in like manner reply to you, Neither a good poor man can be happy in age, nor yet a bad rich man.' Socrates remarks that Cephalus appears not to care about riches, a quality which he ascribes to his having inherited, not acquired them, and would like to know what he considers to be the chief advantage of them. Cephalus answers that when you are old the belief in the world below grows upon you, and then to have done justice and never to have been compelled to do injustice through poverty, and never to have deceived anyone, are felt to be unspeakable blessings. Socrates, who is evidently preparing for an argument, next asks, What is the meaning of the word justice? To tell the truth and pay your debts? No more than this? Or must we admit exceptions? Ought I, for example, to put back into the hands of my friend, who has gone mad, the sword which I borrowed of him when he was in his right mind? 'There must be exceptions.' 'And yet,' says Polemarchus, 'the definition which has been given has the authority of Simonides.' Here Cephalus retires to look after the sacrifices, and bequeaths, as Socrates facetiously remarks, the possession of the argument to his heir, Polemarchus...

The description of old age is finished, and Plato, as his manner is, has touched the key-note of the whole work in asking for the definition of justice, first suggesting the question which Glaucon afterwards pursues respecting external goods, and preparing for the concluding mythus of the world below in the slight allusion of Cephalus. The portrait of the just man is a natural frontispiece or introduction to the long discourse which follows, and may perhaps imply that in all our perplexity about the nature of justice, there is no difficulty in discerning 'who is a just man.' The first explanation has been supported by a saying of Simonides; and now Socrates has a mind to show that the resolution of justice into two unconnected precepts, which have no common principle, fails to satisfy the demands of dialectic.

...He proceeds: What did Simonides mean by this saying of his? Did he mean that I was to give back arms to a madman? 'No, not in that case, not if the parties are friends, and evil would result. He meant that you were to do what was proper, good to friends and harm to enemies.' Every act does something to somebody; and following this analogy, Socrates asks, What is this due and proper thing which justice does, and to whom? He is answered that justice does good to friends and harm to enemies. But in what way good or harm? 'In making alliances with the one, and going to war with the other.' Then in time of peace what is the good of justice? The answer is that justice is of use in contracts, and contracts are money partnerships. Yes; but how in such partnerships is the just man of more use than any other man? 'When you want to have money safely kept and not used.' Then justice will be useful when money is useless. And there is another difficulty: justice, like the art of war or any other art, must be of opposites, good at attack as well as at defence, at stealing as well as at guarding. But then justice is a thief, though a hero notwithstanding, like Autolycus, the Homeric hero, who was 'excellent above all men in theft and perjury'—to such a pass have you and Homer and Simonides brought us; though I do not forget that the thieving must be for the good of friends and the harm of enemies. And still there arises another question: Are friends to be interpreted as real or seeming; enemies as real or seeming? And are our friends to be only the good, and our enemies to be the evil? The answer is, that we must do good to our seeming and real good friends, and evil to our seeming and real evil enemies—good to the good, evil to the evil. But ought we to render evil for evil at all, when to do so will only make men more evil? Can justice produce injustice any more than the art of horsemanship can make bad horsemen, or heat produce cold? The final conclusion is, that no sage or poet ever said that the just return evil for evil; this was a maxim of some rich and mighty man, Periander, Perdiccas, or Ismenias the Theban (about B.C. 398-381)...

Thus the first stage of aphoristic or unconscious morality is shown to be inadequate to the wants of the age; the authority of the poets is set aside, and through the winding mazes of dialectic we make an approach to the Christian precept of forgiveness of injuries. Similar words are applied by the Persian mystic poet to the Divine being when the questioning spirit is stirred within him:—'If because I do evil, Thou punishest me by evil, what is the difference between Thee and me?' In this both Plato and Kheyam rise above the level of many Christian (?) theologians. The first definition of justice easily passes into the second; for the simple words 'to speak the truth and pay your debts' is substituted the more abstract 'to do good to your friends and harm to your enemies.' Either of these explanations gives a sufficient rule of life for plain men, but they both fall short of the precision of philosophy. We may note in passing the antiquity of casuistry, which not only arises out of the conflict of established principles in particular cases, but also out of the effort to attain them, and is prior as well as posterior to our fundamental notions of morality. The 'interrogation' of moral ideas; the appeal to the authority of Homer; the conclusion that the maxim, 'Do good to your friends and harm to your enemies,' being erroneous, could not have been the word of any great man, are all of them very characteristic of the Platonic Socrates.

...Here Thrasymachus, who has made several attempts to interrupt, but has hitherto been kept in order by the company, takes advantage of a pause and rushes into the arena, beginning, like a savage animal, with a roar. 'Socrates,' he says, 'what folly is this?—Why do you agree to be vanquished by one another in a pretended argument?' He then prohibits all the ordinary definitions of justice; to which Socrates replies that he cannot tell how many twelve is, if he is forbidden to say 2 x 6, or 3 x 4, or 6 x 2, or 4 x 3. At first Thrasymachus is reluctant to argue; but at length, with a promise of payment on the part of the company and of praise from Socrates, he is induced to open the game. 'Listen,' he says, 'my answer is that might is right, justice the interest of the stronger: now praise me.' Let me understand you first. Do you mean that because Polydamas the wrestler, who is stronger than we are, finds the eating of beef for his interest, the eating of beef is also for our interest, who are not so strong? Thrasymachus is indignant at the illustration, and in pompous words, apparently intended to restore dignity to the argument, he explains his meaning to be that the rulers make laws for their own interests. But suppose, says Socrates, that the ruler or stronger makes a mistake—then the interest of the stronger is not his interest. Thrasymachus is saved from this speedy downfall by his disciple Cleitophon, who introduces the word 'thinks;'—not the actual interest of the ruler, but what he thinks or what seems to be his interest, is justice. The contradiction is escaped by the unmeaning evasion: for though his real and apparent interests may differ, what the ruler thinks to be his interest will always remain what he thinks to be his interest.

Of course this was not the original assertion, nor is the new interpretation accepted by Thrasymachus himself. But Socrates is not disposed to quarrel about words, if, as he significantly insinuates, his adversary has changed his mind. In what follows Thrasymachus does in fact withdraw his admission that the ruler may make a mistake, for he affirms that the ruler as a ruler is infallible. Socrates is quite ready to accept the new position, which he equally turns against Thrasymachus by the help of the analogy of the arts. Every art or science has an interest, but this interest is to be distinguished from the accidental interest of the artist, and is only concerned with the good of the things or persons which come under the art. And justice has an interest which is the interest not of the ruler or judge, but of those who come under his sway.

Thrasymachus is on the brink of the inevitable conclusion, when he makes a bold diversion. 'Tell me, Socrates,' he says, 'have you a nurse?' What a question! Why do you ask? 'Because, if you have, she neglects you and lets you go about drivelling, and has not even taught you to know the shepherd from the sheep. For you fancy that shepherds and rulers never think of their own interest, but only of their sheep or subjects, whereas the truth is that they fatten them for their use, sheep and subjects alike. And experience proves that in every relation of life the just man is the loser and the unjust the gainer, especially where injustice is on the grand scale, which is quite another thing from the petty rogueries of swindlers and burglars and robbers of temples. The language of men proves this—our 'gracious' and 'blessed' tyrant and the like—all which tends to show (1) that justice is the interest of the stronger; and (2) that injustice is more profitable and also stronger than justice.'

Thrasymachus, who is better at a speech than at a close argument, having deluged the company with words, has a mind to escape. But the others will not let him go, and Socrates adds a humble but earnest request that he will not desert them at such a crisis of their fate. 'And what can I do more for you?' he says; 'would you have me put the words bodily into your souls?' God forbid! replies Socrates; but we want you to be consistent in the use of terms, and not to employ 'physician' in an exact sense, and then again 'shepherd' or 'ruler' in an inexact,—if the words are strictly taken, the ruler and the shepherd look only to the good of their people or flocks and not to their own: whereas you insist that rulers are solely actuated by love of office. 'No doubt about it,' replies Thrasymachus. Then why are they paid? Is not the reason, that their interest is not comprehended in their art, and is therefore the concern of another art, the art of pay, which is common to the arts in general, and therefore not identical with any one of them? Nor would any man be a ruler unless he were induced by the hope of reward or the fear of punishment;—the reward is money or honour, the punishment is the necessity of being ruled by a man worse than himself. And if a State (or Church) were composed entirely of good men, they would be affected by the last motive only; and there would be as much 'nolo episcopari' as there is at present of the opposite...

The satire on existing governments is heightened by the simple and apparently incidental manner in which the last remark is introduced. There is a similar irony in the argument that the governors of mankind do not like being in office, and that therefore they demand pay.

...Enough of this: the other assertion of Thrasymachus is far more important—that the unjust life is more gainful than the just. Now, as you and I, Glaucon, are not convinced by him, we must reply to him; but if we try to compare their respective gains we shall want a judge to decide for us; we had better therefore proceed by making mutual admissions of the truth to one another.

Thrasymachus had asserted that perfect injustice was more gainful than perfect justice, and after a little hesitation he is induced by Socrates to admit the still greater paradox that injustice is virtue and justice vice. Socrates praises his frankness, and assumes the attitude of one whose only wish is to understand the meaning of his opponents. At the same time he is weaving a net in which Thrasymachus is finally enclosed. The admission is elicited from him that the just man seeks to gain an advantage over the unjust only, but not over the just, while the unjust would gain an advantage over either. Socrates, in order to test this statement, employs once more the favourite analogy of the arts. The musician, doctor, skilled artist of any sort, does not seek to gain more than the skilled, but only more than the unskilled (that is to say, he works up to a rule, standard, law, and does not exceed it), whereas the unskilled makes random efforts at excess. Thus the skilled falls on the side of the good, and the unskilled on the side of the evil, and the just is the skilled, and the unjust is the unskilled.

There was great difficulty in bringing Thrasymachus to the point; the day was hot and he was streaming with perspiration, and for the first time in his life he was seen to blush. But his other thesis that injustice was stronger than justice has not yet been refuted, and Socrates now proceeds to the consideration of this, which, with the assistance of Thrasymachus, he hopes to clear up; the latter is at first churlish, but in the judicious hands of Socrates is soon restored to good-humour: Is there not honour among thieves? Is not the strength of injustice only a remnant of justice? Is not absolute injustice absolute weakness also? A house that is divided against itself cannot stand; two men who quarrel detract from one another's strength, and he who is at war with himself is the enemy of himself and the gods. Not wickedness therefore, but semi-wickedness flourishes in states,—a remnant of good is needed in order to make union in action possible,—there is no kingdom of evil in this world.

Another question has not been answered: Is the just or the unjust the happier? To this we reply, that every art has an end and an excellence or virtue by which the end is accomplished. And is not the end of the soul happiness, and justice the excellence of the soul by which happiness is attained? Justice and happiness being thus shown to be inseparable, the question whether the just or the unjust is the happier has disappeared.

Thrasymachus replies: 'Let this be your entertainment, Socrates, at the festival of Bendis.' Yes; and a very good entertainment with which your kindness has supplied me, now that you have left off scolding. And yet not a good entertainment—but that was my own fault, for I tasted of too many things. First of all the nature of justice was the subject of our enquiry, and then whether justice is virtue and wisdom, or evil and folly; and then the comparative advantages of just and unjust: and the sum of all is that I know not what justice is; how then shall I know whether the just is happy or not?...

Thus the sophistical fabric has been demolished, chiefly by appealing to the analogy of the arts. 'Justice is like the arts (1) in having no external interest, and (2) in not aiming at excess, and (3) justice is to happiness what the implement of the workman is to his work.' At this the modern reader is apt to stumble, because he forgets that Plato is writing in an age when the arts and the virtues, like the moral and intellectual faculties, were still undistinguished. Among early enquirers into the nature of human action the arts helped to fill up the void of speculation; and at first the comparison of the arts and the virtues was not perceived by them to be fallacious. They only saw the points of agreement in them and not the points of difference. Virtue, like art, must take means to an end; good manners are both an art and a virtue; character is naturally described under the image of a statue; and there are many other figures of speech which are readily transferred from art to morals. The next generation cleared up these perplexities; or at least supplied after ages with a further analysis of them. The contemporaries of Plato were in a state of transition, and had not yet fully realized the common-sense distinction of Aristotle, that 'virtue is concerned with action, art with production' (Nic. Eth.), or that 'virtue implies intention and constancy of purpose,' whereas 'art requires knowledge only'. And yet in the absurdities which follow from some uses of the analogy, there seems to be an intimation conveyed that virtue is more than art. This is implied in the reductio ad absurdum that 'justice is a thief,' and in the dissatisfaction which Socrates expresses at the final result.

The expression 'an art of pay' which is described as 'common to all the arts' is not in accordance with the ordinary use of language. Nor is it employed elsewhere either by Plato or by any other Greek writer. It is suggested by the argument, and seems to extend the conception of art to doing as well as making. Another flaw or inaccuracy of language may be noted in the words 'men who are injured are made more unjust.' For those who are injured are not necessarily made worse, but only harmed or ill-treated.

The second of the three arguments, 'that the just does not aim at excess,' has a real meaning, though wrapped up in an enigmatical form. That the good is of the nature of the finite is a peculiarly Hellenic sentiment, which may be compared with the language of those modern writers who speak of virtue as fitness, and of freedom as obedience to law. The mathematical or logical notion of limit easily passes into an ethical one, and even finds a mythological expression in the conception of envy (Greek). Ideas of measure, equality, order, unity, proportion, still linger in the writings of moralists; and the true spirit of the fine arts is better conveyed by such terms than by superlatives.

&lt;&lt;&lt;
'When workmen strive to do better than well,&lt;br&gt;They do confound their skill in covetousness.'  (King John.)
&lt;&lt;&lt;

The harmony of the soul and body, and of the parts of the soul with one another, a harmony 'fairer than that of musical notes,' is the true Hellenic mode of conceiving the perfection of human nature.

In what may be called the epilogue of the discussion with Thrasymachus, Plato argues that evil is not a principle of strength, but of discord and dissolution, just touching the question which has been often treated in modern times by theologians and philosophers, of the negative nature of evil. In the last argument we trace the germ of the Aristotelian doctrine of an end and a virtue directed towards the end, which again is suggested by the arts. The final reconcilement of justice and happiness and the identity of the individual and the State are also intimated. Socrates reassumes the character of a 'know-nothing;' at the same time he appears to be not wholly satisfied with the manner in which the argument has been conducted. Nothing is concluded; but the tendency of the dialectical process, here as always, is to enlarge our conception of ideas, and to widen their application to human life.

BOOK II. Thrasymachus is pacified, but the intrepid Glaucon insists on continuing the argument. He is not satisfied with the indirect manner in which, at the end of the last book, Socrates had disposed of the question 'Whether the just or the unjust is the happier.' He begins by dividing goods into three classes:—first, goods desirable in themselves; secondly, goods desirable in themselves and for their results; thirdly, goods desirable for their results only. He then asks Socrates in which of the three classes he would place justice. In the second class, replies Socrates, among goods desirable for themselves and also for their results. 'Then the world in general are of another mind, for they say that justice belongs to the troublesome class of goods which are desirable for their results only. Socrates answers that this is the doctrine of Thrasymachus which he rejects. Glaucon thinks that Thrasymachus was too ready to listen to the voice of the charmer, and proposes to consider the nature of justice and injustice in themselves and apart from the results and rewards of them which the world is always dinning in his ears. He will first of all speak of the nature and origin of justice; secondly, of the manner in which men view justice as a necessity and not a good; and thirdly, he will prove the reasonableness of this view.

'To do injustice is said to be a good; to suffer injustice an evil. As the evil is discovered by experience to be greater than the good, the sufferers, who cannot also be doers, make a compact that they will have neither, and this compact or mean is called justice, but is really the impossibility of doing injustice. No one would observe such a compact if he were not obliged. Let us suppose that the just and unjust have two rings, like that of Gyges in the well-known story, which make them invisible, and then no difference will appear in them, for every one will do evil if he can. And he who abstains will be regarded by the world as a fool for his pains. Men may praise him in public out of fear for themselves, but they will laugh at him in their hearts (Cp. Gorgias.)

'And now let us frame an ideal of the just and unjust. Imagine the unjust man to be master of his craft, seldom making mistakes and easily correcting them; having gifts of money, speech, strength—the greatest villain bearing the highest character: and at his side let us place the just in his nobleness and simplicity—being, not seeming—without name or reward—clothed in his justice only—the best of men who is thought to be the worst, and let him die as he has lived. I might add (but I would rather put the rest into the mouth of the panegyrists of injustice—they will tell you) that the just man will be scourged, racked, bound, will have his eyes put out, and will at last be crucified (literally impaled)—and all this because he ought to have preferred seeming to being. How different is the case of the unjust who clings to appearance as the true reality! His high character makes him a ruler; he can marry where he likes, trade where he likes, help his friends and hurt his enemies; having got rich by dishonesty he can worship the gods better, and will therefore be more loved by them than the just.'

I was thinking what to answer, when Adeimantus joined in the already unequal fray. He considered that the most important point of all had been omitted:—'Men are taught to be just for the sake of rewards; parents and guardians make reputation the incentive to virtue. And other advantages are promised by them of a more solid kind, such as wealthy marriages and high offices. There are the pictures in Homer and Hesiod of fat sheep and heavy fleeces, rich corn-fields and trees toppling with fruit, which the gods provide in this life for the just. And the Orphic poets add a similar picture of another. The heroes of Musaeus and Eumolpus lie on couches at a festival, with garlands on their heads, enjoying as the meed of virtue a paradise of immortal drunkenness. Some go further, and speak of a fair posterity in the third and fourth generation. But the wicked they bury in a slough and make them carry water in a sieve: and in this life they attribute to them the infamy which Glaucon was assuming to be the lot of the just who are supposed to be unjust.

'Take another kind of argument which is found both in poetry and prose:—&quot;Virtue,&quot; as Hesiod says, &quot;is honourable but difficult, vice is easy and profitable.&quot; You may often see the wicked in great prosperity and the righteous afflicted by the will of heaven. And mendicant prophets knock at rich men's doors, promising to atone for the sins of themselves or their fathers in an easy fashion with sacrifices and festive games, or with charms and invocations to get rid of an enemy good or bad by divine help and at a small charge;—they appeal to books professing to be written by Musaeus and Orpheus, and carry away the minds of whole cities, and promise to &quot;get souls out of purgatory;&quot; and if we refuse to listen to them, no one knows what will happen to us.

'When a lively-minded ingenuous youth hears all this, what will be his conclusion? &quot;Will he,&quot; in the language of Pindar, &quot;make justice his high tower, or fortify himself with crooked deceit?&quot; Justice, he reflects, without the appearance of justice, is misery and ruin; injustice has the promise of a glorious life. Appearance is master of truth and lord of happiness. To appearance then I will turn,—I will put on the show of virtue and trail behind me the fox of Archilochus. I hear some one saying that &quot;wickedness is not easily concealed,&quot; to which I reply that &quot;nothing great is easy.&quot; Union and force and rhetoric will do much; and if men say that they cannot prevail over the gods, still how do we know that there are gods? Only from the poets, who acknowledge that they may be appeased by sacrifices. Then why not sin and pay for indulgences out of your sin? For if the righteous are only unpunished, still they have no further reward, while the wicked may be unpunished and have the pleasure of sinning too. But what of the world below? Nay, says the argument, there are atoning powers who will set that matter right, as the poets, who are the sons of the gods, tell us; and this is confirmed by the authority of the State.

'How can we resist such arguments in favour of injustice? Add good manners, and, as the wise tell us, we shall make the best of both worlds. Who that is not a miserable caitiff will refrain from smiling at the praises of justice? Even if a man knows the better part he will not be angry with others; for he knows also that more than human virtue is needed to save a man, and that he only praises justice who is incapable of injustice.

'The origin of the evil is that all men from the beginning, heroes, poets, instructors of youth, have always asserted &quot;the temporal dispensation,&quot; the honours and profits of justice. Had we been taught in early youth the power of justice and injustice inherent in the soul, and unseen by any human or divine eye, we should not have needed others to be our guardians, but every one would have been the guardian of himself. This is what I want you to show, Socrates;—other men use arguments which rather tend to strengthen the position of Thrasymachus that &quot;might is right;&quot; but from you I expect better things. And please, as Glaucon said, to exclude reputation; let the just be thought unjust and the unjust just, and do you still prove to us the superiority of justice'...

The thesis, which for the sake of argument has been maintained by Glaucon, is the converse of that of Thrasymachus—not right is the interest of the stronger, but right is the necessity of the weaker. Starting from the same premises he carries the analysis of society a step further back;—might is still right, but the might is the weakness of the many combined against the strength of the few.

There have been theories in modern as well as in ancient times which have a family likeness to the speculations of Glaucon; e.g. that power is the foundation of right; or that a monarch has a divine right to govern well or ill; or that virtue is self-love or the love of power; or that war is the natural state of man; or that private vices are public benefits. All such theories have a kind of plausibility from their partial agreement with experience. For human nature oscillates between good and evil, and the motives of actions and the origin of institutions may be explained to a certain extent on either hypothesis according to the character or point of view of a particular thinker. The obligation of maintaining authority under all circumstances and sometimes by rather questionable means is felt strongly and has become a sort of instinct among civilized men. The divine right of kings, or more generally of governments, is one of the forms under which this natural feeling is expressed. Nor again is there any evil which has not some accompaniment of good or pleasure; nor any good which is free from some alloy of evil; nor any noble or generous thought which may not be attended by a shadow or the ghost of a shadow of self-interest or of self-love. We know that all human actions are imperfect; but we do not therefore attribute them to the worse rather than to the better motive or principle. Such a philosophy is both foolish and false, like that opinion of the clever rogue who assumes all other men to be like himself. And theories of this sort do not represent the real nature of the State, which is based on a vague sense of right gradually corrected and enlarged by custom and law (although capable also of perversion), any more than they describe the origin of society, which is to be sought in the family and in the social and religious feelings of man. Nor do they represent the average character of individuals, which cannot be explained simply on a theory of evil, but has always a counteracting element of good. And as men become better such theories appear more and more untruthful to them, because they are more conscious of their own disinterestedness. A little experience may make a man a cynic; a great deal will bring him back to a truer and kindlier view of the mixed nature of himself and his fellow men.

The two brothers ask Socrates to prove to them that the just is happy when they have taken from him all that in which happiness is ordinarily supposed to consist. Not that there is (1) any absurdity in the attempt to frame a notion of justice apart from circumstances. For the ideal must always be a paradox when compared with the ordinary conditions of human life. Neither the Stoical ideal nor the Christian ideal is true as a fact, but they may serve as a basis of education, and may exercise an ennobling influence. An ideal is none the worse because 'some one has made the discovery' that no such ideal was ever realized. And in a few exceptional individuals who are raised above the ordinary level of humanity, the ideal of happiness may be realized in death and misery. This may be the state which the reason deliberately approves, and which the utilitarian as well as every other moralist may be bound in certain cases to prefer.

Nor again, (2) must we forget that Plato, though he agrees generally with the view implied in the argument of the two brothers, is not expressing his own final conclusion, but rather seeking to dramatize one of the aspects of ethical truth. He is developing his idea gradually in a series of positions or situations. He is exhibiting Socrates for the first time undergoing the Socratic interrogation. Lastly, (3) the word 'happiness' involves some degree of confusion because associated in the language of modern philosophy with conscious pleasure or satisfaction, which was not equally present to his mind.

Glaucon has been drawing a picture of the misery of the just and the happiness of the unjust, to which the misery of the tyrant in Book IX is the answer and parallel. And still the unjust must appear just; that is 'the homage which vice pays to virtue.' But now Adeimantus, taking up the hint which had been already given by Glaucon, proceeds to show that in the opinion of mankind justice is regarded only for the sake of rewards and reputation, and points out the advantage which is given to such arguments as those of Thrasymachus and Glaucon by the conventional morality of mankind. He seems to feel the difficulty of 'justifying the ways of God to man.' Both the brothers touch upon the question, whether the morality of actions is determined by their consequences; and both of them go beyond the position of Socrates, that justice belongs to the class of goods not desirable for themselves only, but desirable for themselves and for their results, to which he recalls them. In their attempt to view justice as an internal principle, and in their condemnation of the poets, they anticipate him. The common life of Greece is not enough for them; they must penetrate deeper into the nature of things.

It has been objected that justice is honesty in the sense of Glaucon and Adeimantus, but is taken by Socrates to mean all virtue. May we not more truly say that the old-fashioned notion of justice is enlarged by Socrates, and becomes equivalent to universal order or well-being, first in the State, and secondly in the individual? He has found a new answer to his old question (Protag.), 'whether the virtues are one or many,' viz. that one is the ordering principle of the three others. In seeking to establish the purely internal nature of justice, he is met by the fact that man is a social being, and he tries to harmonise the two opposite theses as well as he can. There is no more inconsistency in this than was inevitable in his age and country; there is no use in turning upon him the cross lights of modern philosophy, which, from some other point of view, would appear equally inconsistent. Plato does not give the final solution of philosophical questions for us; nor can he be judged of by our standard.

The remainder of the Republic is developed out of the question of the sons of Ariston. Three points are deserving of remark in what immediately follows:—First, that the answer of Socrates is altogether indirect. He does not say that happiness consists in the contemplation of the idea of justice, and still less will he be tempted to affirm the Stoical paradox that the just man can be happy on the rack. But first he dwells on the difficulty of the problem and insists on restoring man to his natural condition, before he will answer the question at all. He too will frame an ideal, but his ideal comprehends not only abstract justice, but the whole relations of man. Under the fanciful illustration of the large letters he implies that he will only look for justice in society, and that from the State he will proceed to the individual. His answer in substance amounts to this,—that under favourable conditions, i.e. in the perfect State, justice and happiness will coincide, and that when justice has been once found, happiness may be left to take care of itself. That he falls into some degree of inconsistency, when in the tenth book he claims to have got rid of the rewards and honours of justice, may be admitted; for he has left those which exist in the perfect State. And the philosopher 'who retires under the shelter of a wall' can hardly have been esteemed happy by him, at least not in this world. Still he maintains the true attitude of moral action. Let a man do his duty first, without asking whether he will be happy or not, and happiness will be the inseparable accident which attends him. 'Seek ye first the kingdom of God and his righteousness, and all these things shall be added unto you.'

Secondly, it may be remarked that Plato preserves the genuine character of Greek thought in beginning with the State and in going on to the individual. First ethics, then politics—this is the order of ideas to us; the reverse is the order of history. Only after many struggles of thought does the individual assert his right as a moral being. In early ages he is not ONE, but one of many, the citizen of a State which is prior to him; and he has no notion of good or evil apart from the law of his country or the creed of his church. And to this type he is constantly tending to revert, whenever the influence of custom, or of party spirit, or the recollection of the past becomes too strong for him.

Thirdly, we may observe the confusion or identification of the individual and the State, of ethics and politics, which pervades early Greek speculation, and even in modern times retains a certain degree of influence. The subtle difference between the collective and individual action of mankind seems to have escaped early thinkers, and we too are sometimes in danger of forgetting the conditions of united human action, whenever we either elevate politics into ethics, or lower ethics to the standard of politics. The good man and the good citizen only coincide in the perfect State; and this perfection cannot be attained by legislation acting upon them from without, but, if at all, by education fashioning them from within.

...Socrates praises the sons of Ariston, 'inspired offspring of the renowned hero,' as the elegiac poet terms them; but he does not understand how they can argue so eloquently on behalf of injustice while their character shows that they are uninfluenced by their own arguments. He knows not how to answer them, although he is afraid of deserting justice in the hour of need. He therefore makes a condition, that having weak eyes he shall be allowed to read the large letters first and then go on to the smaller, that is, he must look for justice in the State first, and will then proceed to the individual. Accordingly he begins to construct the State.

Society arises out of the wants of man. His first want is food; his second a house; his third a coat. The sense of these needs and the possibility of satisfying them by exchange, draw individuals together on the same spot; and this is the beginning of a State, which we take the liberty to invent, although necessity is the real inventor. There must be first a husbandman, secondly a builder, thirdly a weaver, to which may be added a cobbler. Four or five citizens at least are required to make a city. Now men have different natures, and one man will do one thing better than many; and business waits for no man. Hence there must be a division of labour into different employments; into wholesale and retail trade; into workers, and makers of workmen's tools; into shepherds and husbandmen. A city which includes all this will have far exceeded the limit of four or five, and yet not be very large. But then again imports will be required, and imports necessitate exports, and this implies variety of produce in order to attract the taste of purchasers; also merchants and ships. In the city too we must have a market and money and retail trades; otherwise buyers and sellers will never meet, and the valuable time of the producers will be wasted in vain efforts at exchange. If we add hired servants the State will be complete. And we may guess that somewhere in the intercourse of the citizens with one another justice and injustice will appear.

Here follows a rustic picture of their way of life. They spend their days in houses which they have built for themselves; they make their own clothes and produce their own corn and wine. Their principal food is meal and flour, and they drink in moderation. They live on the best of terms with each other, and take care not to have too many children. 'But,' said Glaucon, interposing, 'are they not to have a relish?' Certainly; they will have salt and olives and cheese, vegetables and fruits, and chestnuts to roast at the fire. 'Tis a city of pigs, Socrates.' Why, I replied, what do you want more? 'Only the comforts of life,—sofas and tables, also sauces and sweets.' I see; you want not only a State, but a luxurious State; and possibly in the more complex frame we may sooner find justice and injustice. Then the fine arts must go to work—every conceivable instrument and ornament of luxury will be wanted. There will be dancers, painters, sculptors, musicians, cooks, barbers, tire-women, nurses, artists; swineherds and neatherds too for the animals, and physicians to cure the disorders of which luxury is the source. To feed all these superfluous mouths we shall need a part of our neighbour's land, and they will want a part of ours. And this is the origin of war, which may be traced to the same causes as other political evils. Our city will now require the slight addition of a camp, and the citizen will be converted into a soldier. But then again our old doctrine of the division of labour must not be forgotten. The art of war cannot be learned in a day, and there must be a natural aptitude for military duties. There will be some warlike natures who have this aptitude—dogs keen of scent, swift of foot to pursue, and strong of limb to fight. And as spirit is the foundation of courage, such natures, whether of men or animals, will be full of spirit. But these spirited natures are apt to bite and devour one another; the union of gentleness to friends and fierceness against enemies appears to be an impossibility, and the guardian of a State requires both qualities. Who then can be a guardian? The image of the dog suggests an answer. For dogs are gentle to friends and fierce to strangers. Your dog is a philosopher who judges by the rule of knowing or not knowing; and philosophy, whether in man or beast, is the parent of gentleness. The human watchdogs must be philosophers or lovers of learning which will make them gentle. And how are they to be learned without education?

But what shall their education be? Is any better than the old-fashioned sort which is comprehended under the name of music and gymnastic? Music includes literature, and literature is of two kinds, true and false. 'What do you mean?' he said. I mean that children hear stories before they learn gymnastics, and that the stories are either untrue, or have at most one or two grains of truth in a bushel of falsehood. Now early life is very impressible, and children ought not to learn what they will have to unlearn when they grow up; we must therefore have a censorship of nursery tales, banishing some and keeping others. Some of them are very improper, as we may see in the great instances of Homer and Hesiod, who not only tell lies but bad lies; stories about Uranus and Saturn, which are immoral as well as false, and which should never be spoken of to young persons, or indeed at all; or, if at all, then in a mystery, after the sacrifice, not of an Eleusinian pig, but of some unprocurable animal. Shall our youth be encouraged to beat their fathers by the example of Zeus, or our citizens be incited to quarrel by hearing or seeing representations of strife among the gods? Shall they listen to the narrative of Hephaestus binding his mother, and of Zeus sending him flying for helping her when she was beaten? Such tales may possibly have a mystical interpretation, but the young are incapable of understanding allegory. If any one asks what tales are to be allowed, we will answer that we are legislators and not book-makers; we only lay down the principles according to which books are to be written; to write them is the duty of others.

And our first principle is, that God must be represented as he is; not as the author of all things, but of good only. We will not suffer the poets to say that he is the steward of good and evil, or that he has two casks full of destinies;—or that Athene and Zeus incited Pandarus to break the treaty; or that God caused the sufferings of Niobe, or of Pelops, or the Trojan war; or that he makes men sin when he wishes to destroy them. Either these were not the actions of the gods, or God was just, and men were the better for being punished. But that the deed was evil, and God the author, is a wicked, suicidal fiction which we will allow no one, old or young, to utter. This is our first and great principle—God is the author of good only.

And the second principle is like unto it:—With God is no variableness or change of form. Reason teaches us this; for if we suppose a change in God, he must be changed either by another or by himself. By another?—but the best works of nature and art and the noblest qualities of mind are least liable to be changed by any external force. By himself?—but he cannot change for the better; he will hardly change for the worse. He remains for ever fairest and best in his own image. Therefore we refuse to listen to the poets who tell us of Here begging in the likeness of a priestess or of other deities who prowl about at night in strange disguises; all that blasphemous nonsense with which mothers fool the manhood out of their children must be suppressed. But some one will say that God, who is himself unchangeable, may take a form in relation to us. Why should he? For gods as well as men hate the lie in the soul, or principle of falsehood; and as for any other form of lying which is used for a purpose and is regarded as innocent in certain exceptional cases—what need have the gods of this? For they are not ignorant of antiquity like the poets, nor are they afraid of their enemies, nor is any madman a friend of theirs. God then is true, he is absolutely true; he changes not, he deceives not, by day or night, by word or sign. This is our second great principle—God is true. Away with the lying dream of Agamemnon in Homer, and the accusation of Thetis against Apollo in Aeschylus...

In order to give clearness to his conception of the State, Plato proceeds to trace the first principles of mutual need and of division of labour in an imaginary community of four or five citizens. Gradually this community increases; the division of labour extends to countries; imports necessitate exports; a medium of exchange is required, and retailers sit in the market-place to save the time of the producers. These are the steps by which Plato constructs the first or primitive State, introducing the elements of political economy by the way. As he is going to frame a second or civilized State, the simple naturally comes before the complex. He indulges, like Rousseau, in a picture of primitive life—an idea which has indeed often had a powerful influence on the imagination of mankind, but he does not seriously mean to say that one is better than the other (Politicus); nor can any inference be drawn from the description of the first state taken apart from the second, such as Aristotle appears to draw in the Politics. We should not interpret a Platonic dialogue any more than a poem or a parable in too literal or matter-of-fact a style. On the other hand, when we compare the lively fancy of Plato with the dried-up abstractions of modern treatises on philosophy, we are compelled to say with Protagoras, that the 'mythus is more interesting' (Protag.)

Several interesting remarks which in modern times would have a place in a treatise on Political Economy are scattered up and down the writings of Plato: especially Laws, Population; Free Trade; Adulteration; Wills and Bequests; Begging; Eryxias, (though not Plato's), Value and Demand; Republic, Division of Labour. The last subject, and also the origin of Retail Trade, is treated with admirable lucidity in the second book of the Republic. But Plato never combined his economic ideas into a system, and never seems to have recognized that Trade is one of the great motive powers of the State and of the world. He would make retail traders only of the inferior sort of citizens (Rep., Laws), though he remarks, quaintly enough (Laws), that 'if only the best men and the best women everywhere were compelled to keep taverns for a time or to carry on retail trade, etc., then we should knew how pleasant and agreeable all these things are.'

The disappointment of Glaucon at the 'city of pigs,' the ludicrous description of the ministers of luxury in the more refined State, and the afterthought of the necessity of doctors, the illustration of the nature of the guardian taken from the dog, the desirableness of offering some almost unprocurable victim when impure mysteries are to be celebrated, the behaviour of Zeus to his father and of Hephaestus to his mother, are touches of humour which have also a serious meaning. In speaking of education Plato rather startles us by affirming that a child must be trained in falsehood first and in truth afterwards. Yet this is not very different from saying that children must be taught through the medium of imagination as well as reason; that their minds can only develope gradually, and that there is much which they must learn without understanding. This is also the substance of Plato's view, though he must be acknowledged to have drawn the line somewhat differently from modern ethical writers, respecting truth and falsehood. To us, economies or accommodations would not be allowable unless they were required by the human faculties or necessary for the communication of knowledge to the simple and ignorant. We should insist that the word was inseparable from the intention, and that we must not be 'falsely true,' i.e. speak or act falsely in support of what was right or true. But Plato would limit the use of fictions only by requiring that they should have a good moral effect, and that such a dangerous weapon as falsehood should be employed by the rulers alone and for great objects.

A Greek in the age of Plato attached no importance to the question whether his religion was an historical fact. He was just beginning to be conscious that the past had a history; but he could see nothing beyond Homer and Hesiod. Whether their narratives were true or false did not seriously affect the political or social life of Hellas. Men only began to suspect that they were fictions when they recognised them to be immoral. And so in all religions: the consideration of their morality comes first, afterwards the truth of the documents in which they are recorded, or of the events natural or supernatural which are told of them. But in modern times, and in Protestant countries perhaps more than in Catholic, we have been too much inclined to identify the historical with the moral; and some have refused to believe in religion at all, unless a superhuman accuracy was discernible in every part of the record. The facts of an ancient or religious history are amongst the most important of all facts; but they are frequently uncertain, and we only learn the true lesson which is to be gathered from them when we place ourselves above them. These reflections tend to show that the difference between Plato and ourselves, though not unimportant, is not so great as might at first sight appear. For we should agree with him in placing the moral before the historical truth of religion; and, generally, in disregarding those errors or misstatements of fact which necessarily occur in the early stages of all religions. We know also that changes in the traditions of a country cannot be made in a day; and are therefore tolerant of many things which science and criticism would condemn.

We note in passing that the allegorical interpretation of mythology, said to have been first introduced as early as the sixth century before Christ by Theagenes of Rhegium, was well established in the age of Plato, and here, as in the Phaedrus, though for a different reason, was rejected by him. That anachronisms whether of religion or law, when men have reached another stage of civilization, should be got rid of by fictions is in accordance with universal experience. Great is the art of interpretation; and by a natural process, which when once discovered was always going on, what could not be altered was explained away. And so without any palpable inconsistency there existed side by side two forms of religion, the tradition inherited or invented by the poets and the customary worship of the temple; on the other hand, there was the religion of the philosopher, who was dwelling in the heaven of ideas, but did not therefore refuse to offer a cock to Aesculapius, or to be seen saying his prayers at the rising of the sun. At length the antagonism between the popular and philosophical religion, never so great among the Greeks as in our own age, disappeared, and was only felt like the difference between the religion of the educated and uneducated among ourselves. The Zeus of Homer and Hesiod easily passed into the 'royal mind' of Plato (Philebus); the giant Heracles became the knight-errant and benefactor of mankind. These and still more wonderful transformations were readily effected by the ingenuity of Stoics and neo-Platonists in the two or three centuries before and after Christ. The Greek and Roman religions were gradually permeated by the spirit of philosophy; having lost their ancient meaning, they were resolved into poetry and morality; and probably were never purer than at the time of their decay, when their influence over the world was waning.

A singular conception which occurs towards the end of the book is the lie in the soul; this is connected with the Platonic and Socratic doctrine that involuntary ignorance is worse than voluntary. The lie in the soul is a true lie, the corruption of the highest truth, the deception of the highest part of the soul, from which he who is deceived has no power of delivering himself. For example, to represent God as false or immoral, or, according to Plato, as deluding men with appearances or as the author of evil; or again, to affirm with Protagoras that 'knowledge is sensation,' or that 'being is becoming,' or with Thrasymachus 'that might is right,' would have been regarded by Plato as a lie of this hateful sort. The greatest unconsciousness of the greatest untruth, e.g. if, in the language of the Gospels (John), 'he who was blind' were to say 'I see,' is another aspect of the state of mind which Plato is describing. The lie in the soul may be further compared with the sin against the Holy Ghost (Luke), allowing for the difference between Greek and Christian modes of speaking. To this is opposed the lie in words, which is only such a deception as may occur in a play or poem, or allegory or figure of speech, or in any sort of accommodation,—which though useless to the gods may be useful to men in certain cases. Socrates is here answering the question which he had himself raised about the propriety of deceiving a madman; and he is also contrasting the nature of God and man. For God is Truth, but mankind can only be true by appearing sometimes to be partial, or false. Reserving for another place the greater questions of religion or education, we may note further, (1) the approval of the old traditional education of Greece; (2) the preparation which Plato is making for the attack on Homer and the poets; (3) the preparation which he is also making for the use of economies in the State; (4) the contemptuous and at the same time euphemistic manner in which here as below he alludes to the 'Chronique Scandaleuse' of the gods.

BOOK III. There is another motive in purifying religion, which is to banish fear; for no man can be courageous who is afraid of death, or who believes the tales which are repeated by the poets concerning the world below. They must be gently requested not to abuse hell; they may be reminded that their stories are both untrue and discouraging. Nor must they be angry if we expunge obnoxious passages, such as the depressing words of Achilles—'I would rather be a serving-man than rule over all the dead;' and the verses which tell of the squalid mansions, the senseless shadows, the flitting soul mourning over lost strength and youth, the soul with a gibber going beneath the earth like smoke, or the souls of the suitors which flutter about like bats. The terrors and horrors of Cocytus and Styx, ghosts and sapless shades, and the rest of their Tartarean nomenclature, must vanish. Such tales may have their use; but they are not the proper food for soldiers. As little can we admit the sorrows and sympathies of the Homeric heroes:—Achilles, the son of Thetis, in tears, throwing ashes on his head, or pacing up and down the sea-shore in distraction; or Priam, the cousin of the gods, crying aloud, rolling in the mire. A good man is not prostrated at the loss of children or fortune. Neither is death terrible to him; and therefore lamentations over the dead should not be practised by men of note; they should be the concern of inferior persons only, whether women or men. Still worse is the attribution of such weakness to the gods; as when the goddesses say, 'Alas! my travail!' and worst of all, when the king of heaven himself laments his inability to save Hector, or sorrows over the impending doom of his dear Sarpedon. Such a character of God, if not ridiculed by our young men, is likely to be imitated by them. Nor should our citizens be given to excess of laughter—'Such violent delights' are followed by a violent re-action. The description in the Iliad of the gods shaking their sides at the clumsiness of Hephaestus will not be admitted by us. 'Certainly not.'

Truth should have a high place among the virtues, for falsehood, as we were saying, is useless to the gods, and only useful to men as a medicine. But this employment of falsehood must remain a privilege of state; the common man must not in return tell a lie to the ruler; any more than the patient would tell a lie to his physician, or the sailor to his captain.

In the next place our youth must be temperate, and temperance consists in self-control and obedience to authority. That is a lesson which Homer teaches in some places: 'The Achaeans marched on breathing prowess, in silent awe of their leaders;'—but a very different one in other places: 'O heavy with wine, who hast the eyes of a dog, but the heart of a stag.' Language of the latter kind will not impress self-control on the minds of youth. The same may be said about his praises of eating and drinking and his dread of starvation; also about the verses in which he tells of the rapturous loves of Zeus and Here, or of how Hephaestus once detained Ares and Aphrodite in a net on a similar occasion. There is a nobler strain heard in the words:—'Endure, my soul, thou hast endured worse.' Nor must we allow our citizens to receive bribes, or to say, 'Gifts persuade the gods, gifts reverend kings;' or to applaud the ignoble advice of Phoenix to Achilles that he should get money out of the Greeks before he assisted them; or the meanness of Achilles himself in taking gifts from Agamemnon; or his requiring a ransom for the body of Hector; or his cursing of Apollo; or his insolence to the river-god Scamander; or his dedication to the dead Patroclus of his own hair which had been already dedicated to the other river-god Spercheius; or his cruelty in dragging the body of Hector round the walls, and slaying the captives at the pyre: such a combination of meanness and cruelty in Cheiron's pupil is inconceivable. The amatory exploits of Peirithous and Theseus are equally unworthy. Either these so-called sons of gods were not the sons of gods, or they were not such as the poets imagine them, any more than the gods themselves are the authors of evil. The youth who believes that such things are done by those who have the blood of heaven flowing in their veins will be too ready to imitate their example.

Enough of gods and heroes;—what shall we say about men? What the poets and story-tellers say—that the wicked prosper and the righteous are afflicted, or that justice is another's gain? Such misrepresentations cannot be allowed by us. But in this we are anticipating the definition of justice, and had therefore better defer the enquiry.

The subjects of poetry have been sufficiently treated; next follows style. Now all poetry is a narrative of events past, present, or to come; and narrative is of three kinds, the simple, the imitative, and a composition of the two. An instance will make my meaning clear. The first scene in Homer is of the last or mixed kind, being partly description and partly dialogue. But if you throw the dialogue into the 'oratio obliqua,' the passage will run thus: The priest came and prayed Apollo that the Achaeans might take Troy and have a safe return if Agamemnon would only give him back his daughter; and the other Greeks assented, but Agamemnon was wroth, and so on—The whole then becomes descriptive, and the poet is the only speaker left; or, if you omit the narrative, the whole becomes dialogue. These are the three styles—which of them is to be admitted into our State? 'Do you ask whether tragedy and comedy are to be admitted?' Yes, but also something more—Is it not doubtful whether our guardians are to be imitators at all? Or rather, has not the question been already answered, for we have decided that one man cannot in his life play many parts, any more than he can act both tragedy and comedy, or be rhapsodist and actor at once? Human nature is coined into very small pieces, and as our guardians have their own business already, which is the care of freedom, they will have enough to do without imitating. If they imitate they should imitate, not any meanness or baseness, but the good only; for the mask which the actor wears is apt to become his face. We cannot allow men to play the parts of women, quarrelling, weeping, scolding, or boasting against the gods,—least of all when making love or in labour. They must not represent slaves, or bullies, or cowards, drunkards, or madmen, or blacksmiths, or neighing horses, or bellowing bulls, or sounding rivers, or a raging sea. A good or wise man will be willing to perform good and wise actions, but he will be ashamed to play an inferior part which he has never practised; and he will prefer to employ the descriptive style with as little imitation as possible. The man who has no self-respect, on the contrary, will imitate anybody and anything; sounds of nature and cries of animals alike; his whole performance will be imitation of gesture and voice. Now in the descriptive style there are few changes, but in the dramatic there are a great many. Poets and musicians use either, or a compound of both, and this compound is very attractive to youth and their teachers as well as to the vulgar. But our State in which one man plays one part only is not adapted for complexity. And when one of these polyphonous pantomimic gentlemen offers to exhibit himself and his poetry we will show him every observance of respect, but at the same time tell him that there is no room for his kind in our State; we prefer the rough, honest poet, and will not depart from our original models (Laws).

Next as to the music. A song or ode has three parts,—the subject, the harmony, and the rhythm; of which the two last are dependent upon the first. As we banished strains of lamentation, so we may now banish the mixed Lydian harmonies, which are the harmonies of lamentation; and as our citizens are to be temperate, we may also banish convivial harmonies, such as the Ionian and pure Lydian. Two remain—the Dorian and Phrygian, the first for war, the second for peace; the one expressive of courage, the other of obedience or instruction or religious feeling. And as we reject varieties of harmony, we shall also reject the many-stringed, variously-shaped instruments which give utterance to them, and in particular the flute, which is more complex than any of them. The lyre and the harp may be permitted in the town, and the Pan's-pipe in the fields. Thus we have made a purgation of music, and will now make a purgation of metres. These should be like the harmonies, simple and suitable to the occasion. There are four notes of the tetrachord, and there are three ratios of metre, 3/2, 2/2, 2/1, which have all their characteristics, and the feet have different characteristics as well as the rhythms. But about this you and I must ask Damon, the great musician, who speaks, if I remember rightly, of a martial measure as well as of dactylic, trochaic, and iambic rhythms, which he arranges so as to equalize the syllables with one another, assigning to each the proper quantity. We only venture to affirm the general principle that the style is to conform to the subject and the metre to the style; and that the simplicity and harmony of the soul should be reflected in them all. This principle of simplicity has to be learnt by every one in the days of his youth, and may be gathered anywhere, from the creative and constructive arts, as well as from the forms of plants and animals.

Other artists as well as poets should be warned against meanness or unseemliness. Sculpture and painting equally with music must conform to the law of simplicity. He who violates it cannot be allowed to work in our city, and to corrupt the taste of our citizens. For our guardians must grow up, not amid images of deformity which will gradually poison and corrupt their souls, but in a land of health and beauty where they will drink in from every object sweet and harmonious influences. And of all these influences the greatest is the education given by music, which finds a way into the innermost soul and imparts to it the sense of beauty and of deformity. At first the effect is unconscious; but when reason arrives, then he who has been thus trained welcomes her as the friend whom he always knew. As in learning to read, first we acquire the elements or letters separately, and afterwards their combinations, and cannot recognize reflections of them until we know the letters themselves;—in like manner we must first attain the elements or essential forms of the virtues, and then trace their combinations in life and experience. There is a music of the soul which answers to the harmony of the world; and the fairest object of a musical soul is the fair mind in the fair body. Some defect in the latter may be excused, but not in the former. True love is the daughter of temperance, and temperance is utterly opposed to the madness of bodily pleasure. Enough has been said of music, which makes a fair ending with love.

Next we pass on to gymnastics; about which I would remark, that the soul is related to the body as a cause to an effect, and therefore if we educate the mind we may leave the education of the body in her charge, and need only give a general outline of the course to be pursued. In the first place the guardians must abstain from strong drink, for they should be the last persons to lose their wits. Whether the habits of the palaestra are suitable to them is more doubtful, for the ordinary gymnastic is a sleepy sort of thing, and if left off suddenly is apt to endanger health. But our warrior athletes must be wide-awake dogs, and must also be inured to all changes of food and climate. Hence they will require a simpler kind of gymnastic, akin to their simple music; and for their diet a rule may be found in Homer, who feeds his heroes on roast meat only, and gives them no fish although they are living at the sea-side, nor boiled meats which involve an apparatus of pots and pans; and, if I am not mistaken, he nowhere mentions sweet sauces. Sicilian cookery and Attic confections and Corinthian courtezans, which are to gymnastic what Lydian and Ionian melodies are to music, must be forbidden. Where gluttony and intemperance prevail the town quickly fills with doctors and pleaders; and law and medicine give themselves airs as soon as the freemen of a State take an interest in them. But what can show a more disgraceful state of education than to have to go abroad for justice because you have none of your own at home? And yet there IS a worse stage of the same disease—when men have learned to take a pleasure and pride in the twists and turns of the law; not considering how much better it would be for them so to order their lives as to have no need of a nodding justice. And there is a like disgrace in employing a physician, not for the cure of wounds or epidemic disorders, but because a man has by laziness and luxury contracted diseases which were unknown in the days of Asclepius. How simple is the Homeric practice of medicine. Eurypylus after he has been wounded drinks a posset of Pramnian wine, which is of a heating nature; and yet the sons of Asclepius blame neither the damsel who gives him the drink, nor Patroclus who is attending on him. The truth is that this modern system of nursing diseases was introduced by Herodicus the trainer; who, being of a sickly constitution, by a compound of training and medicine tortured first himself and then a good many other people, and lived a great deal longer than he had any right. But Asclepius would not practise this art, because he knew that the citizens of a well-ordered State have no leisure to be ill, and therefore he adopted the 'kill or cure' method, which artisans and labourers employ. 'They must be at their business,' they say, 'and have no time for coddling: if they recover, well; if they don't, there is an end of them.' Whereas the rich man is supposed to be a gentleman who can afford to be ill. Do you know a maxim of Phocylides—that 'when a man begins to be rich' (or, perhaps, a little sooner) 'he should practise virtue'? But how can excessive care of health be inconsistent with an ordinary occupation, and yet consistent with that practice of virtue which Phocylides inculcates? When a student imagines that philosophy gives him a headache, he never does anything; he is always unwell. This was the reason why Asclepius and his sons practised no such art. They were acting in the interest of the public, and did not wish to preserve useless lives, or raise up a puny offspring to wretched sires. Honest diseases they honestly cured; and if a man was wounded, they applied the proper remedies, and then let him eat and drink what he liked. But they declined to treat intemperate and worthless subjects, even though they might have made large fortunes out of them. As to the story of Pindar, that Asclepius was slain by a thunderbolt for restoring a rich man to life, that is a lie—following our old rule we must say either that he did not take bribes, or that he was not the son of a god.

Glaucon then asks Socrates whether the best physicians and the best judges will not be those who have had severally the greatest experience of diseases and of crimes. Socrates draws a distinction between the two professions. The physician should have had experience of disease in his own body, for he cures with his mind and not with his body. But the judge controls mind by mind; and therefore his mind should not be corrupted by crime. Where then is he to gain experience? How is he to be wise and also innocent? When young a good man is apt to be deceived by evil-doers, because he has no pattern of evil in himself; and therefore the judge should be of a certain age; his youth should have been innocent, and he should have acquired insight into evil not by the practice of it, but by the observation of it in others. This is the ideal of a judge; the criminal turned detective is wonderfully suspicious, but when in company with good men who have experience, he is at fault, for he foolishly imagines that every one is as bad as himself. Vice may be known of virtue, but cannot know virtue. This is the sort of medicine and this the sort of law which will prevail in our State; they will be healing arts to better natures; but the evil body will be left to die by the one, and the evil soul will be put to death by the other. And the need of either will be greatly diminished by good music which will give harmony to the soul, and good gymnastic which will give health to the body. Not that this division of music and gymnastic really corresponds to soul and body; for they are both equally concerned with the soul, which is tamed by the one and aroused and sustained by the other. The two together supply our guardians with their twofold nature. The passionate disposition when it has too much gymnastic is hardened and brutalized, the gentle or philosophic temper which has too much music becomes enervated. While a man is allowing music to pour like water through the funnel of his ears, the edge of his soul gradually wears away, and the passionate or spirited element is melted out of him. Too little spirit is easily exhausted; too much quickly passes into nervous irritability. So, again, the athlete by feeding and training has his courage doubled, but he soon grows stupid; he is like a wild beast, ready to do everything by blows and nothing by counsel or policy. There are two principles in man, reason and passion, and to these, not to the soul and body, the two arts of music and gymnastic correspond. He who mingles them in harmonious concord is the true musician,—he shall be the presiding genius of our State.

The next question is, Who are to be our rulers? First, the elder must rule the younger; and the best of the elders will be the best guardians. Now they will be the best who love their subjects most, and think that they have a common interest with them in the welfare of the state. These we must select; but they must be watched at every epoch of life to see whether they have retained the same opinions and held out against force and enchantment. For time and persuasion and the love of pleasure may enchant a man into a change of purpose, and the force of grief and pain may compel him. And therefore our guardians must be men who have been tried by many tests, like gold in the refiner's fire, and have been passed first through danger, then through pleasure, and at every age have come out of such trials victorious and without stain, in full command of themselves and their principles; having all their faculties in harmonious exercise for their country's good. These shall receive the highest honours both in life and death. (It would perhaps be better to confine the term 'guardians' to this select class: the younger men may be called 'auxiliaries.')

And now for one magnificent lie, in the belief of which, Oh that we could train our rulers!—at any rate let us make the attempt with the rest of the world. What I am going to tell is only another version of the legend of Cadmus; but our unbelieving generation will be slow to accept such a story. The tale must be imparted, first to the rulers, then to the soldiers, lastly to the people. We will inform them that their youth was a dream, and that during the time when they seemed to be undergoing their education they were really being fashioned in the earth, who sent them up when they were ready; and that they must protect and cherish her whose children they are, and regard each other as brothers and sisters. 'I do not wonder at your being ashamed to propound such a fiction.' There is more behind. These brothers and sisters have different natures, and some of them God framed to rule, whom he fashioned of gold; others he made of silver, to be auxiliaries; others again to be husbandmen and craftsmen, and these were formed by him of brass and iron. But as they are all sprung from a common stock, a golden parent may have a silver son, or a silver parent a golden son, and then there must be a change of rank; the son of the rich must descend, and the child of the artisan rise, in the social scale; for an oracle says 'that the State will come to an end if governed by a man of brass or iron.' Will our citizens ever believe all this? 'Not in the present generation, but in the next, perhaps, Yes.'

Now let the earthborn men go forth under the command of their rulers, and look about and pitch their camp in a high place, which will be safe against enemies from without, and likewise against insurrections from within. There let them sacrifice and set up their tents; for soldiers they are to be and not shopkeepers, the watchdogs and guardians of the sheep; and luxury and avarice will turn them into wolves and tyrants. Their habits and their dwellings should correspond to their education. They should have no property; their pay should only meet their expenses; and they should have common meals. Gold and silver we will tell them that they have from God, and this divine gift in their souls they must not alloy with that earthly dross which passes under the name of gold. They only of the citizens may not touch it, or be under the same roof with it, or drink from it; it is the accursed thing. Should they ever acquire houses or lands or money of their own, they will become householders and tradesmen instead of guardians, enemies and tyrants instead of helpers, and the hour of ruin, both to themselves and the rest of the State, will be at hand.

The religious and ethical aspect of Plato's education will hereafter be considered under a separate head. Some lesser points may be more conveniently noticed in this place.

1. The constant appeal to the authority of Homer, whom, with grave irony, Plato, after the manner of his age, summons as a witness about ethics and psychology, as well as about diet and medicine; attempting to distinguish the better lesson from the worse, sometimes altering the text from design; more than once quoting or alluding to Homer inaccurately, after the manner of the early logographers turning the Iliad into prose, and delighting to draw far-fetched inferences from his words, or to make ludicrous applications of them. He does not, like Heracleitus, get into a rage with Homer and Archilochus (Heracl.), but uses their words and expressions as vehicles of a higher truth; not on a system like Theagenes of Rhegium or Metrodorus, or in later times the Stoics, but as fancy may dictate. And the conclusions drawn from them are sound, although the premises are fictitious. These fanciful appeals to Homer add a charm to Plato's style, and at the same time they have the effect of a satire on the follies of Homeric interpretation. To us (and probably to himself), although they take the form of arguments, they are really figures of speech. They may be compared with modern citations from Scripture, which have often a great rhetorical power even when the original meaning of the words is entirely lost sight of. The real, like the Platonic Socrates, as we gather from the Memorabilia of Xenophon, was fond of making similar adaptations. Great in all ages and countries, in religion as well as in law and literature, has been the art of interpretation.

2. 'The style is to conform to the subject and the metre to the style.' Notwithstanding the fascination which the word 'classical' exercises over us, we can hardly maintain that this rule is observed in all the Greek poetry which has come down to us. We cannot deny that the thought often exceeds the power of lucid expression in Aeschylus and Pindar; or that rhetoric gets the better of the thought in the Sophist-poet Euripides. Only perhaps in Sophocles is there a perfect harmony of the two; in him alone do we find a grace of language like the beauty of a Greek statue, in which there is nothing to add or to take away; at least this is true of single plays or of large portions of them. The connection in the Tragic Choruses and in the Greek lyric poets is not unfrequently a tangled thread which in an age before logic the poet was unable to draw out. Many thoughts and feelings mingled in his mind, and he had no power of disengaging or arranging them. For there is a subtle influence of logic which requires to be transferred from prose to poetry, just as the music and perfection of language are infused by poetry into prose. In all ages the poet has been a bad judge of his own meaning (Apol.); for he does not see that the word which is full of associations to his own mind is difficult and unmeaning to that of another; or that the sequence which is clear to himself is puzzling to others. There are many passages in some of our greatest modern poets which are far too obscure; in which there is no proportion between style and subject, in which any half-expressed figure, any harsh construction, any distorted collocation of words, any remote sequence of ideas is admitted; and there is no voice 'coming sweetly from nature,' or music adding the expression of feeling to thought. As if there could be poetry without beauty, or beauty without ease and clearness. The obscurities of early Greek poets arose necessarily out of the state of language and logic which existed in their age. They are not examples to be followed by us; for the use of language ought in every generation to become clearer and clearer. Like Shakespere, they were great in spite, not in consequence, of their imperfections of expression. But there is no reason for returning to the necessary obscurity which prevailed in the infancy of literature. The English poets of the last century were certainly not obscure; and we have no excuse for losing what they had gained, or for going back to the earlier or transitional age which preceded them. The thought of our own times has not out-stripped language; a want of Plato's 'art of measuring' is the rule cause of the disproportion between them.

3. In the third book of the Republic a nearer approach is made to a theory of art than anywhere else in Plato. His views may be summed up as follows:—True art is not fanciful and imitative, but simple and ideal,—the expression of the highest moral energy, whether in action or repose. To live among works of plastic art which are of this noble and simple character, or to listen to such strains, is the best of influences,—the true Greek atmosphere, in which youth should be brought up. That is the way to create in them a natural good taste, which will have a feeling of truth and beauty in all things. For though the poets are to be expelled, still art is recognized as another aspect of reason—like love in the Symposium, extending over the same sphere, but confined to the preliminary education, and acting through the power of habit; and this conception of art is not limited to strains of music or the forms of plastic art, but pervades all nature and has a wide kindred in the world. The Republic of Plato, like the Athens of Pericles, has an artistic as well as a political side.

There is hardly any mention in Plato of the creative arts; only in two or three passages does he even allude to them (Rep.; Soph.). He is not lost in rapture at the great works of Phidias, the Parthenon, the Propylea, the statues of Zeus or Athene. He would probably have regarded any abstract truth of number or figure as higher than the greatest of them. Yet it is hard to suppose that some influence, such as he hopes to inspire in youth, did not pass into his own mind from the works of art which he saw around him. We are living upon the fragments of them, and find in a few broken stones the standard of truth and beauty. But in Plato this feeling has no expression; he nowhere says that beauty is the object of art; he seems to deny that wisdom can take an external form (Phaedrus); he does not distinguish the fine from the mechanical arts. Whether or no, like some writers, he felt more than he expressed, it is at any rate remarkable that the greatest perfection of the fine arts should coincide with an almost entire silence about them. In one very striking passage he tells us that a work of art, like the State, is a whole; and this conception of a whole and the love of the newly-born mathematical sciences may be regarded, if not as the inspiring, at any rate as the regulating principles of Greek art (Xen. Mem.; and Sophist).

4. Plato makes the true and subtle remark that the physician had better not be in robust health; and should have known what illness is in his own person. But the judge ought to have had no similar experience of evil; he is to be a good man who, having passed his youth in innocence, became acquainted late in life with the vices of others. And therefore, according to Plato, a judge should not be young, just as a young man according to Aristotle is not fit to be a hearer of moral philosophy. The bad, on the other hand, have a knowledge of vice, but no knowledge of virtue. It may be doubted, however, whether this train of reflection is well founded. In a remarkable passage of the Laws it is acknowledged that the evil may form a correct estimate of the good. The union of gentleness and courage in Book ii. at first seemed to be a paradox, yet was afterwards ascertained to be a truth. And Plato might also have found that the intuition of evil may be consistent with the abhorrence of it. There is a directness of aim in virtue which gives an insight into vice. And the knowledge of character is in some degree a natural sense independent of any special experience of good or evil.

5. One of the most remarkable conceptions of Plato, because un-Greek and also very different from anything which existed at all in his age of the world, is the transposition of ranks. In the Spartan state there had been enfranchisement of Helots and degradation of citizens under special circumstances. And in the ancient Greek aristocracies, merit was certainly recognized as one of the elements on which government was based. The founders of states were supposed to be their benefactors, who were raised by their great actions above the ordinary level of humanity; at a later period, the services of warriors and legislators were held to entitle them and their descendants to the privileges of citizenship and to the first rank in the state. And although the existence of an ideal aristocracy is slenderly proven from the remains of early Greek history, and we have a difficulty in ascribing such a character, however the idea may be defined, to any actual Hellenic state—or indeed to any state which has ever existed in the world—still the rule of the best was certainly the aspiration of philosophers, who probably accommodated a good deal their views of primitive history to their own notions of good government. Plato further insists on applying to the guardians of his state a series of tests by which all those who fell short of a fixed standard were either removed from the governing body, or not admitted to it; and this 'academic' discipline did to a certain extent prevail in Greek states, especially in Sparta. He also indicates that the system of caste, which existed in a great part of the ancient, and is by no means extinct in the modern European world, should be set aside from time to time in favour of merit. He is aware how deeply the greater part of mankind resent any interference with the order of society, and therefore he proposes his novel idea in the form of what he himself calls a 'monstrous fiction.' (Compare the ceremony of preparation for the two 'great waves' in Book v.) Two principles are indicated by him: first, that there is a distinction of ranks dependent on circumstances prior to the individual: second, that this distinction is and ought to be broken through by personal qualities. He adapts mythology like the Homeric poems to the wants of the state, making 'the Phoenician tale' the vehicle of his ideas. Every Greek state had a myth respecting its own origin; the Platonic republic may also have a tale of earthborn men. The gravity and verisimilitude with which the tale is told, and the analogy of Greek tradition, are a sufficient verification of the 'monstrous falsehood.' Ancient poetry had spoken of a gold and silver and brass and iron age succeeding one another, but Plato supposes these differences in the natures of men to exist together in a single state. Mythology supplies a figure under which the lesson may be taught (as Protagoras says, 'the myth is more interesting'), and also enables Plato to touch lightly on new principles without going into details. In this passage he shadows forth a general truth, but he does not tell us by what steps the transposition of ranks is to be effected. Indeed throughout the Republic he allows the lower ranks to fade into the distance. We do not know whether they are to carry arms, and whether in the fifth book they are or are not included in the communistic regulations respecting property and marriage. Nor is there any use in arguing strictly either from a few chance words, or from the silence of Plato, or in drawing inferences which were beyond his vision. Aristotle, in his criticism on the position of the lower classes, does not perceive that the poetical creation is 'like the air, invulnerable,' and cannot be penetrated by the shafts of his logic (Pol.).

6. Two paradoxes which strike the modern reader as in the highest degree fanciful and ideal, and which suggest to him many reflections, are to be found in the third book of the Republic: first, the great power of music, so much beyond any influence which is experienced by us in modern times, when the art or science has been far more developed, and has found the secret of harmony, as well as of melody; secondly, the indefinite and almost absolute control which the soul is supposed to exercise over the body.

In the first we suspect some degree of exaggeration, such as we may also observe among certain masters of the art, not unknown to us, at the present day. With this natural enthusiasm, which is felt by a few only, there seems to mingle in Plato a sort of Pythagorean reverence for numbers and numerical proportion to which Aristotle is a stranger. Intervals of sound and number are to him sacred things which have a law of their own, not dependent on the variations of sense. They rise above sense, and become a connecting link with the world of ideas. But it is evident that Plato is describing what to him appears to be also a fact. The power of a simple and characteristic melody on the impressible mind of the Greek is more than we can easily appreciate. The effect of national airs may bear some comparison with it. And, besides all this, there is a confusion between the harmony of musical notes and the harmony of soul and body, which is so potently inspired by them.

The second paradox leads up to some curious and interesting questions—How far can the mind control the body? Is the relation between them one of mutual antagonism or of mutual harmony? Are they two or one, and is either of them the cause of the other? May we not at times drop the opposition between them, and the mode of describing them, which is so familiar to us, and yet hardly conveys any precise meaning, and try to view this composite creature, man, in a more simple manner? Must we not at any rate admit that there is in human nature a higher and a lower principle, divided by no distinct line, which at times break asunder and take up arms against one another? Or again, they are reconciled and move together, either unconsciously in the ordinary work of life, or consciously in the pursuit of some noble aim, to be attained not without an effort, and for which every thought and nerve are strained. And then the body becomes the good friend or ally, or servant or instrument of the mind. And the mind has often a wonderful and almost superhuman power of banishing disease and weakness and calling out a hidden strength. Reason and the desires, the intellect and the senses are brought into harmony and obedience so as to form a single human being. They are ever parting, ever meeting; and the identity or diversity of their tendencies or operations is for the most part unnoticed by us. When the mind touches the body through the appetites, we acknowledge the responsibility of the one to the other. There is a tendency in us which says 'Drink.' There is another which says, 'Do not drink; it is not good for you.' And we all of us know which is the rightful superior. We are also responsible for our health, although into this sphere there enter some elements of necessity which may be beyond our control. Still even in the management of health, care and thought, continued over many years, may make us almost free agents, if we do not exact too much of ourselves, and if we acknowledge that all human freedom is limited by the laws of nature and of mind.

We are disappointed to find that Plato, in the general condemnation which he passes on the practice of medicine prevailing in his own day, depreciates the effects of diet. He would like to have diseases of a definite character and capable of receiving a definite treatment. He is afraid of invalidism interfering with the business of life. He does not recognize that time is the great healer both of mental and bodily disorders; and that remedies which are gradual and proceed little by little are safer than those which produce a sudden catastrophe. Neither does he see that there is no way in which the mind can more surely influence the body than by the control of eating and drinking; or any other action or occasion of human life on which the higher freedom of the will can be more simple or truly asserted.

7. Lesser matters of style may be remarked.

(1) The affected ignorance of music, which is Plato's way of expressing that he is passing lightly over the subject.

(2) The tentative manner in which here, as in the second book, he proceeds with the construction of the State.

(3) The description of the State sometimes as a reality, and then again as a work of imagination only; these are the arts by which he sustains the reader's interest.

(4) Connecting links, or the preparation for the entire expulsion of the poets in Book X.

(5) The companion pictures of the lover of litigation and the valetudinarian, the satirical jest about the maxim of Phocylides, the manner in which the image of the gold and silver citizens is taken up into the subject, and the argument from the practice of Asclepius, should not escape notice.

BOOK IV. Adeimantus said: 'Suppose a person to argue, Socrates, that you make your citizens miserable, and this by their own free-will; they are the lords of the city, and yet instead of having, like other men, lands and houses and money of their own, they live as mercenaries and are always mounting guard.' You may add, I replied, that they receive no pay but only their food, and have no money to spend on a journey or a mistress. 'Well, and what answer do you give?' My answer is, that our guardians may or may not be the happiest of men,—I should not be surprised to find in the long-run that they were,—but this is not the aim of our constitution, which was designed for the good of the whole and not of any one part. If I went to a sculptor and blamed him for having painted the eye, which is the noblest feature of the face, not purple but black, he would reply: 'The eye must be an eye, and you should look at the statue as a whole.' 'Now I can well imagine a fool's paradise, in which everybody is eating and drinking, clothed in purple and fine linen, and potters lie on sofas and have their wheel at hand, that they may work a little when they please; and cobblers and all the other classes of a State lose their distinctive character. And a State may get on without cobblers; but when the guardians degenerate into boon companions, then the ruin is complete. Remember that we are not talking of peasants keeping holiday, but of a State in which every man is expected to do his own work. The happiness resides not in this or that class, but in the State as a whole. I have another remark to make:—A middle condition is best for artisans; they should have money enough to buy tools, and not enough to be independent of business. And will not the same condition be best for our citizens? If they are poor, they will be mean; if rich, luxurious and lazy; and in neither case contented. 'But then how will our poor city be able to go to war against an enemy who has money?' There may be a difficulty in fighting against one enemy; against two there will be none. In the first place, the contest will be carried on by trained warriors against well-to-do citizens: and is not a regular athlete an easy match for two stout opponents at least? Suppose also, that before engaging we send ambassadors to one of the two cities, saying, 'Silver and gold we have not; do you help us and take our share of the spoil;'—who would fight against the lean, wiry dogs, when they might join with them in preying upon the fatted sheep? 'But if many states join their resources, shall we not be in danger?' I am amused to hear you use the word 'state' of any but our own State. They are 'states,' but not 'a state'—many in one. For in every state there are two hostile nations, rich and poor, which you may set one against the other. But our State, while she remains true to her principles, will be in very deed the mightiest of Hellenic states.

To the size of the state there is no limit but the necessity of unity; it must be neither too large nor too small to be one. This is a matter of secondary importance, like the principle of transposition which was intimated in the parable of the earthborn men. The meaning there implied was that every man should do that for which he was fitted, and be at one with himself, and then the whole city would be united. But all these things are secondary, if education, which is the great matter, be duly regarded. When the wheel has once been set in motion, the speed is always increasing; and each generation improves upon the preceding, both in physical and moral qualities. The care of the governors should be directed to preserve music and gymnastic from innovation; alter the songs of a country, Damon says, and you will soon end by altering its laws. The change appears innocent at first, and begins in play; but the evil soon becomes serious, working secretly upon the characters of individuals, then upon social and commercial relations, and lastly upon the institutions of a state; and there is ruin and confusion everywhere. But if education remains in the established form, there will be no danger. A restorative process will be always going on; the spirit of law and order will raise up what has fallen down. Nor will any regulations be needed for the lesser matters of life—rules of deportment or fashions of dress. Like invites like for good or for evil. Education will correct deficiencies and supply the power of self-government. Far be it from us to enter into the particulars of legislation; let the guardians take care of education, and education will take care of all other things.

But without education they may patch and mend as they please; they will make no progress, any more than a patient who thinks to cure himself by some favourite remedy and will not give up his luxurious mode of living. If you tell such persons that they must first alter their habits, then they grow angry; they are charming people. 'Charming,—nay, the very reverse.' Evidently these gentlemen are not in your good graces, nor the state which is like them. And such states there are which first ordain under penalty of death that no one shall alter the constitution, and then suffer themselves to be flattered into and out of anything; and he who indulges them and fawns upon them, is their leader and saviour. 'Yes, the men are as bad as the states.' But do you not admire their cleverness? 'Nay, some of them are stupid enough to believe what the people tell them.' And when all the world is telling a man that he is six feet high, and he has no measure, how can he believe anything else? But don't get into a passion: to see our statesmen trying their nostrums, and fancying that they can cut off at a blow the Hydra-like rogueries of mankind, is as good as a play. Minute enactments are superfluous in good states, and are useless in bad ones.

And now what remains of the work of legislation? Nothing for us; but to Apollo the god of Delphi we leave the ordering of the greatest of all things—that is to say, religion. Only our ancestral deity sitting upon the centre and navel of the earth will be trusted by us if we have any sense, in an affair of such magnitude. No foreign god shall be supreme in our realms...

Here, as Socrates would say, let us 'reflect on' (Greek) what has preceded: thus far we have spoken not of the happiness of the citizens, but only of the well-being of the State. They may be the happiest of men, but our principal aim in founding the State was not to make them happy. They were to be guardians, not holiday-makers. In this pleasant manner is presented to us the famous question both of ancient and modern philosophy, touching the relation of duty to happiness, of right to utility.

First duty, then happiness, is the natural order of our moral ideas. The utilitarian principle is valuable as a corrective of error, and shows to us a side of ethics which is apt to be neglected. It may be admitted further that right and utility are co-extensive, and that he who makes the happiness of mankind his object has one of the highest and noblest motives of human action. But utility is not the historical basis of morality; nor the aspect in which moral and religious ideas commonly occur to the mind. The greatest happiness of all is, as we believe, the far-off result of the divine government of the universe. The greatest happiness of the individual is certainly to be found in a life of virtue and goodness. But we seem to be more assured of a law of right than we can be of a divine purpose, that 'all mankind should be saved;' and we infer the one from the other. And the greatest happiness of the individual may be the reverse of the greatest happiness in the ordinary sense of the term, and may be realised in a life of pain, or in a voluntary death. Further, the word 'happiness' has several ambiguities; it may mean either pleasure or an ideal life, happiness subjective or objective, in this world or in another, of ourselves only or of our neighbours and of all men everywhere. By the modern founder of Utilitarianism the self-regarding and disinterested motives of action are included under the same term, although they are commonly opposed by us as benevolence and self-love. The word happiness has not the definiteness or the sacredness of 'truth' and 'right'; it does not equally appeal to our higher nature, and has not sunk into the conscience of mankind. It is associated too much with the comforts and conveniences of life; too little with 'the goods of the soul which we desire for their own sake.' In a great trial, or danger, or temptation, or in any great and heroic action, it is scarcely thought of. For these reasons 'the greatest happiness' principle is not the true foundation of ethics. But though not the first principle, it is the second, which is like unto it, and is often of easier application. For the larger part of human actions are neither right nor wrong, except in so far as they tend to the happiness of mankind (Introd. to Gorgias and Philebus).

The same question reappears in politics, where the useful or expedient seems to claim a larger sphere and to have a greater authority. For concerning political measures, we chiefly ask: How will they affect the happiness of mankind? Yet here too we may observe that what we term expediency is merely the law of right limited by the conditions of human society. Right and truth are the highest aims of government as well as of individuals; and we ought not to lose sight of them because we cannot directly enforce them. They appeal to the better mind of nations; and sometimes they are too much for merely temporal interests to resist. They are the watchwords which all men use in matters of public policy, as well as in their private dealings; the peace of Europe may be said to depend upon them. In the most commercial and utilitarian states of society the power of ideas remains. And all the higher class of statesmen have in them something of that idealism which Pericles is said to have gathered from the teaching of Anaxagoras. They recognise that the true leader of men must be above the motives of ambition, and that national character is of greater value than material comfort and prosperity. And this is the order of thought in Plato; first, he expects his citizens to do their duty, and then under favourable circumstances, that is to say, in a well-ordered State, their happiness is assured. That he was far from excluding the modern principle of utility in politics is sufficiently evident from other passages; in which 'the most beneficial is affirmed to be the most honourable', and also 'the most sacred'.

We may note

(1) The manner in which the objection of Adeimantus here, is designed to draw out and deepen the argument of Socrates.

(2) The conception of a whole as lying at the foundation both of politics and of art, in the latter supplying the only principle of criticism, which, under the various names of harmony, symmetry, measure, proportion, unity, the Greek seems to have applied to works of art.

(3) The requirement that the State should be limited in size, after the traditional model of a Greek state; as in the Politics of Aristotle, the fact that the cities of Hellas were small is converted into a principle.

(4) The humorous pictures of the lean dogs and the fatted sheep, of the light active boxer upsetting two stout gentlemen at least, of the 'charming' patients who are always making themselves worse; or again, the playful assumption that there is no State but our own; or the grave irony with which the statesman is excused who believes that he is six feet high because he is told so, and having nothing to measure with is to be pardoned for his ignorance—he is too amusing for us to be seriously angry with him.

(5) The light and superficial manner in which religion is passed over when provision has been made for two great principles,—first, that religion shall be based on the highest conception of the gods, secondly, that the true national or Hellenic type shall be maintained...

Socrates proceeds: But where amid all this is justice? Son of Ariston, tell me where. Light a candle and search the city, and get your brother and the rest of our friends to help in seeking for her. 'That won't do,' replied Glaucon, 'you yourself promised to make the search and talked about the impiety of deserting justice.' Well, I said, I will lead the way, but do you follow. My notion is, that our State being perfect will contain all the four virtues—wisdom, courage, temperance, justice. If we eliminate the three first, the unknown remainder will be justice.

First then, of wisdom: the State which we have called into being will be wise because politic. And policy is one among many kinds of skill,—not the skill of the carpenter, or of the worker in metal, or of the husbandman, but the skill of him who advises about the interests of the whole State. Of such a kind is the skill of the guardians, who are a small class in number, far smaller than the blacksmiths; but in them is concentrated the wisdom of the State. And if this small ruling class have wisdom, then the whole State will be wise.

Our second virtue is courage, which we have no difficulty in finding in another class—that of soldiers. Courage may be defined as a sort of salvation—the never-failing salvation of the opinions which law and education have prescribed concerning dangers. You know the way in which dyers first prepare the white ground and then lay on the dye of purple or of any other colour. Colours dyed in this way become fixed, and no soap or lye will ever wash them out. Now the ground is education, and the laws are the colours; and if the ground is properly laid, neither the soap of pleasure nor the lye of pain or fear will ever wash them out. This power which preserves right opinion about danger I would ask you to call 'courage,' adding the epithet 'political' or 'civilized' in order to distinguish it from mere animal courage and from a higher courage which may hereafter be discussed.

Two virtues remain; temperance and justice. More than the preceding virtues temperance suggests the idea of harmony. Some light is thrown upon the nature of this virtue by the popular description of a man as 'master of himself'—which has an absurd sound, because the master is also the servant. The expression really means that the better principle in a man masters the worse. There are in cities whole classes—women, slaves and the like—who correspond to the worse, and a few only to the better; and in our State the former class are held under control by the latter. Now to which of these classes does temperance belong? 'To both of them.' And our State if any will be the abode of temperance; and we were right in describing this virtue as a harmony which is diffused through the whole, making the dwellers in the city to be of one mind, and attuning the upper and middle and lower classes like the strings of an instrument, whether you suppose them to differ in wisdom, strength or wealth.

And now we are near the spot; let us draw in and surround the cover and watch with all our eyes, lest justice should slip away and escape. Tell me, if you see the thicket move first. 'Nay, I would have you lead.' Well then, offer up a prayer and follow. The way is dark and difficult; but we must push on. I begin to see a track. 'Good news.' Why, Glaucon, our dulness of scent is quite ludicrous! While we are straining our eyes into the distance, justice is tumbling out at our feet. We are as bad as people looking for a thing which they have in their hands. Have you forgotten our old principle of the division of labour, or of every man doing his own business, concerning which we spoke at the foundation of the State—what but this was justice? Is there any other virtue remaining which can compete with wisdom and temperance and courage in the scale of political virtue? For 'every one having his own' is the great object of government; and the great object of trade is that every man should do his own business. Not that there is much harm in a carpenter trying to be a cobbler, or a cobbler transforming himself into a carpenter; but great evil may arise from the cobbler leaving his last and turning into a guardian or legislator, or when a single individual is trainer, warrior, legislator, all in one. And this evil is injustice, or every man doing another's business. I do not say that as yet we are in a condition to arrive at a final conclusion. For the definition which we believe to hold good in states has still to be tested by the individual. Having read the large letters we will now come back to the small. From the two together a brilliant light may be struck out...

Socrates proceeds to discover the nature of justice by a method of residues. Each of the first three virtues corresponds to one of the three parts of the soul and one of the three classes in the State, although the third, temperance, has more of the nature of a harmony than the first two. If there be a fourth virtue, that can only be sought for in the relation of the three parts in the soul or classes in the State to one another. It is obvious and simple, and for that very reason has not been found out. The modern logician will be inclined to object that ideas cannot be separated like chemical substances, but that they run into one another and may be only different aspects or names of the same thing, and such in this instance appears to be the case. For the definition here given of justice is verbally the same as one of the definitions of temperance given by Socrates in the Charmides, which however is only provisional, and is afterwards rejected. And so far from justice remaining over when the other virtues are eliminated, the justice and temperance of the Republic can with difficulty be distinguished. Temperance appears to be the virtue of a part only, and one of three, whereas justice is a universal virtue of the whole soul. Yet on the other hand temperance is also described as a sort of harmony, and in this respect is akin to justice. Justice seems to differ from temperance in degree rather than in kind; whereas temperance is the harmony of discordant elements, justice is the perfect order by which all natures and classes do their own business, the right man in the right place, the division and co-operation of all the citizens. Justice, again, is a more abstract notion than the other virtues, and therefore, from Plato's point of view, the foundation of them, to which they are referred and which in idea precedes them. The proposal to omit temperance is a mere trick of style intended to avoid monotony.

There is a famous question discussed in one of the earlier Dialogues of Plato (Protagoras; Arist. Nic. Ethics), 'Whether the virtues are one or many?' This receives an answer which is to the effect that there are four cardinal virtues (now for the first time brought together in ethical philosophy), and one supreme over the rest, which is not like Aristotle's conception of universal justice, virtue relative to others, but the whole of virtue relative to the parts. To this universal conception of justice or order in the first education and in the moral nature of man, the still more universal conception of the good in the second education and in the sphere of speculative knowledge seems to succeed. Both might be equally described by the terms 'law,' 'order,' 'harmony;' but while the idea of good embraces 'all time and all existence,' the conception of justice is not extended beyond man.

...Socrates is now going to identify the individual and the State. But first he must prove that there are three parts of the individual soul. His argument is as follows:—Quantity makes no difference in quality. The word 'just,' whether applied to the individual or to the State, has the same meaning. And the term 'justice' implied that the same three principles in the State and in the individual were doing their own business. But are they really three or one? The question is difficult, and one which can hardly be solved by the methods which we are now using; but the truer and longer way would take up too much of our time. 'The shorter will satisfy me.' Well then, you would admit that the qualities of states mean the qualities of the individuals who compose them? The Scythians and Thracians are passionate, our own race intellectual, and the Egyptians and Phoenicians covetous, because the individual members of each have such and such a character; the difficulty is to determine whether the several principles are one or three; whether, that is to say, we reason with one part of our nature, desire with another, are angry with another, or whether the whole soul comes into play in each sort of action. This enquiry, however, requires a very exact definition of terms. The same thing in the same relation cannot be affected in two opposite ways. But there is no impossibility in a man standing still, yet moving his arms, or in a top which is fixed on one spot going round upon its axis. There is no necessity to mention all the possible exceptions; let us provisionally assume that opposites cannot do or be or suffer opposites in the same relation. And to the class of opposites belong assent and dissent, desire and avoidance. And one form of desire is thirst and hunger: and here arises a new point—thirst is thirst of drink, hunger is hunger of food; not of warm drink or of a particular kind of food, with the single exception of course that the very fact of our desiring anything implies that it is good. When relative terms have no attributes, their correlatives have no attributes; when they have attributes, their correlatives also have them. For example, the term 'greater' is simply relative to 'less,' and knowledge refers to a subject of knowledge. But on the other hand, a particular knowledge is of a particular subject. Again, every science has a distinct character, which is defined by an object; medicine, for example, is the science of health, although not to be confounded with health. Having cleared our ideas thus far, let us return to the original instance of thirst, which has a definite object—drink. Now the thirsty soul may feel two distinct impulses; the animal one saying 'Drink;' the rational one, which says 'Do not drink.' The two impulses are contradictory; and therefore we may assume that they spring from distinct principles in the soul. But is passion a third principle, or akin to desire? There is a story of a certain Leontius which throws some light on this question. He was coming up from the Piraeus outside the north wall, and he passed a spot where there were dead bodies lying by the executioner. He felt a longing desire to see them and also an abhorrence of them; at first he turned away and shut his eyes, then, suddenly tearing them open, he said,—'Take your fill, ye wretches, of the fair sight.' Now is there not here a third principle which is often found to come to the assistance of reason against desire, but never of desire against reason? This is passion or spirit, of the separate existence of which we may further convince ourselves by putting the following case:—When a man suffers justly, if he be of a generous nature he is not indignant at the hardships which he undergoes: but when he suffers unjustly, his indignation is his great support; hunger and thirst cannot tame him; the spirit within him must do or die, until the voice of the shepherd, that is, of reason, bidding his dog bark no more, is heard within. This shows that passion is the ally of reason. Is passion then the same with reason? No, for the former exists in children and brutes; and Homer affords a proof of the distinction between them when he says, 'He smote his breast, and thus rebuked his soul.'

And now, at last, we have reached firm ground, and are able to infer that the virtues of the State and of the individual are the same. For wisdom and courage and justice in the State are severally the wisdom and courage and justice in the individuals who form the State. Each of the three classes will do the work of its own class in the State, and each part in the individual soul; reason, the superior, and passion, the inferior, will be harmonized by the influence of music and gymnastic. The counsellor and the warrior, the head and the arm, will act together in the town of Mansoul, and keep the desires in proper subjection. The courage of the warrior is that quality which preserves a right opinion about dangers in spite of pleasures and pains. The wisdom of the counsellor is that small part of the soul which has authority and reason. The virtue of temperance is the friendship of the ruling and the subject principles, both in the State and in the individual. Of justice we have already spoken; and the notion already given of it may be confirmed by common instances. Will the just state or the just individual steal, lie, commit adultery, or be guilty of impiety to gods and men? 'No.' And is not the reason of this that the several principles, whether in the state or in the individual, do their own business? And justice is the quality which makes just men and just states. Moreover, our old division of labour, which required that there should be one man for one use, was a dream or anticipation of what was to follow; and that dream has now been realized in justice, which begins by binding together the three chords of the soul, and then acts harmoniously in every relation of life. And injustice, which is the insubordination and disobedience of the inferior elements in the soul, is the opposite of justice, and is inharmonious and unnatural, being to the soul what disease is to the body; for in the soul as well as in the body, good or bad actions produce good or bad habits. And virtue is the health and beauty and well-being of the soul, and vice is the disease and weakness and deformity of the soul.

Again the old question returns upon us: Is justice or injustice the more profitable? The question has become ridiculous. For injustice, like mortal disease, makes life not worth having. Come up with me to the hill which overhangs the city and look down upon the single form of virtue, and the infinite forms of vice, among which are four special ones, characteristic both of states and of individuals. And the state which corresponds to the single form of virtue is that which we have been describing, wherein reason rules under one of two names—monarchy and aristocracy. Thus there are five forms in all, both of states and of souls...

In attempting to prove that the soul has three separate faculties, Plato takes occasion to discuss what makes difference of faculties. And the criterion which he proposes is difference in the working of the faculties. The same faculty cannot produce contradictory effects. But the path of early reasoners is beset by thorny entanglements, and he will not proceed a step without first clearing the ground. This leads him into a tiresome digression, which is intended to explain the nature of contradiction. First, the contradiction must be at the same time and in the same relation. Secondly, no extraneous word must be introduced into either of the terms in which the contradictory proposition is expressed: for example, thirst is of drink, not of warm drink. He implies, what he does not say, that if, by the advice of reason, or by the impulse of anger, a man is restrained from drinking, this proves that thirst, or desire under which thirst is included, is distinct from anger and reason. But suppose that we allow the term 'thirst' or 'desire' to be modified, and say an 'angry thirst,' or a 'revengeful desire,' then the two spheres of desire and anger overlap and become confused. This case therefore has to be excluded. And still there remains an exception to the rule in the use of the term 'good,' which is always implied in the object of desire. These are the discussions of an age before logic; and any one who is wearied by them should remember that they are necessary to the clearing up of ideas in the first development of the human faculties.

The psychology of Plato extends no further than the division of the soul into the rational, irascible, and concupiscent elements, which, as far as we know, was first made by him, and has been retained by Aristotle and succeeding ethical writers. The chief difficulty in this early analysis of the mind is to define exactly the place of the irascible faculty (Greek), which may be variously described under the terms righteous indignation, spirit, passion. It is the foundation of courage, which includes in Plato moral courage, the courage of enduring pain, and of surmounting intellectual difficulties, as well as of meeting dangers in war. Though irrational, it inclines to side with the rational: it cannot be aroused by punishment when justly inflicted: it sometimes takes the form of an enthusiasm which sustains a man in the performance of great actions. It is the 'lion heart' with which the reason makes a treaty. On the other hand it is negative rather than positive; it is indignant at wrong or falsehood, but does not, like Love in the Symposium and Phaedrus, aspire to the vision of Truth or Good. It is the peremptory military spirit which prevails in the government of honour. It differs from anger (Greek), this latter term having no accessory notion of righteous indignation. Although Aristotle has retained the word, yet we may observe that 'passion' (Greek) has with him lost its affinity to the rational and has become indistinguishable from 'anger' (Greek). And to this vernacular use Plato himself in the Laws seems to revert, though not always. By modern philosophy too, as well as in our ordinary conversation, the words anger or passion are employed almost exclusively in a bad sense; there is no connotation of a just or reasonable cause by which they are aroused. The feeling of 'righteous indignation' is too partial and accidental to admit of our regarding it as a separate virtue or habit. We are tempted also to doubt whether Plato is right in supposing that an offender, however justly condemned, could be expected to acknowledge the justice of his sentence; this is the spirit of a philosopher or martyr rather than of a criminal.

We may observe how nearly Plato approaches Aristotle's famous thesis, that 'good actions produce good habits.' The words 'as healthy practices (Greek) produce health, so do just practices produce justice,' have a sound very like the Nicomachean Ethics. But we note also that an incidental remark in Plato has become a far-reaching principle in Aristotle, and an inseparable part of a great Ethical system.

There is a difficulty in understanding what Plato meant by 'the longer way': he seems to intimate some metaphysic of the future which will not be satisfied with arguing from the principle of contradiction. In the sixth and seventh books (compare Sophist and Parmenides) he has given us a sketch of such a metaphysic; but when Glaucon asks for the final revelation of the idea of good, he is put off with the declaration that he has not yet studied the preliminary sciences. How he would have filled up the sketch, or argued about such questions from a higher point of view, we can only conjecture. Perhaps he hoped to find some a priori method of developing the parts out of the whole; or he might have asked which of the ideas contains the other ideas, and possibly have stumbled on the Hegelian identity of the 'ego' and the 'universal.' Or he may have imagined that ideas might be constructed in some manner analogous to the construction of figures and numbers in the mathematical sciences. The most certain and necessary truth was to Plato the universal; and to this he was always seeking to refer all knowledge or opinion, just as in modern times we seek to rest them on the opposite pole of induction and experience. The aspirations of metaphysicians have always tended to pass beyond the limits of human thought and language: they seem to have reached a height at which they are 'moving about in worlds unrealized,' and their conceptions, although profoundly affecting their own minds, become invisible or unintelligible to others. We are not therefore surprized to find that Plato himself has nowhere clearly explained his doctrine of ideas; or that his school in a later generation, like his contemporaries Glaucon and Adeimantus, were unable to follow him in this region of speculation. In the Sophist, where he is refuting the scepticism which maintained either that there was no such thing as predication, or that all might be predicated of all, he arrives at the conclusion that some ideas combine with some, but not all with all. But he makes only one or two steps forward on this path; he nowhere attains to any connected system of ideas, or even to a knowledge of the most elementary relations of the sciences to one another.

BOOK V. I was going to enumerate the four forms of vice or decline in states, when Polemarchus—he was sitting a little farther from me than Adeimantus—taking him by the coat and leaning towards him, said something in an undertone, of which I only caught the words, 'Shall we let him off?' 'Certainly not,' said Adeimantus, raising his voice. Whom, I said, are you not going to let off? 'You,' he said. Why? 'Because we think that you are not dealing fairly with us in omitting women and children, of whom you have slily disposed under the general formula that friends have all things in common.' And was I not right? 'Yes,' he replied, 'but there are many sorts of communism or community, and we want to know which of them is right. The company, as you have just heard, are resolved to have a further explanation.' Thrasymachus said, 'Do you think that we have come hither to dig for gold, or to hear you discourse?' Yes, I said; but the discourse should be of a reasonable length. Glaucon added, 'Yes, Socrates, and there is reason in spending the whole of life in such discussions; but pray, without more ado, tell us how this community is to be carried out, and how the interval between birth and education is to be filled up.' Well, I said, the subject has several difficulties—What is possible? is the first question. What is desirable? is the second. 'Fear not,' he replied, 'for you are speaking among friends.' That, I replied, is a sorry consolation; I shall destroy my friends as well as myself. Not that I mind a little innocent laughter; but he who kills the truth is a murderer. 'Then,' said Glaucon, laughing, 'in case you should murder us we will acquit you beforehand, and you shall be held free from the guilt of deceiving us.'

Socrates proceeds:—The guardians of our state are to be watch-dogs, as we have already said. Now dogs are not divided into hes and shes—we do not take the masculine gender out to hunt and leave the females at home to look after their puppies. They have the same employments—the only difference between them is that the one sex is stronger and the other weaker. But if women are to have the same employments as men, they must have the same education—they must be taught music and gymnastics, and the art of war. I know that a great joke will be made of their riding on horseback and carrying weapons; the sight of the naked old wrinkled women showing their agility in the palaestra will certainly not be a vision of beauty, and may be expected to become a famous jest. But we must not mind the wits; there was a time when they might have laughed at our present gymnastics. All is habit: people have at last found out that the exposure is better than the concealment of the person, and now they laugh no more. Evil only should be the subject of ridicule.

The first question is, whether women are able either wholly or partially to share in the employments of men. And here we may be charged with inconsistency in making the proposal at all. For we started originally with the division of labour; and the diversity of employments was based on the difference of natures. But is there no difference between men and women? Nay, are they not wholly different? THERE was the difficulty, Glaucon, which made me unwilling to speak of family relations. However, when a man is out of his depth, whether in a pool or in an ocean, he can only swim for his life; and we must try to find a way of escape, if we can.

The argument is, that different natures have different uses, and the natures of men and women are said to differ. But this is only a verbal opposition. We do not consider that the difference may be purely nominal and accidental; for example, a bald man and a hairy man are opposed in a single point of view, but you cannot infer that because a bald man is a cobbler a hairy man ought not to be a cobbler. Now why is such an inference erroneous? Simply because the opposition between them is partial only, like the difference between a male physician and a female physician, not running through the whole nature, like the difference between a physician and a carpenter. And if the difference of the sexes is only that the one beget and the other bear children, this does not prove that they ought to have distinct educations. Admitting that women differ from men in capacity, do not men equally differ from one another? Has not nature scattered all the qualities which our citizens require indifferently up and down among the two sexes? and even in their peculiar pursuits, are not women often, though in some cases superior to men, ridiculously enough surpassed by them? Women are the same in kind as men, and have the same aptitude or want of aptitude for medicine or gymnastic or war, but in a less degree. One woman will be a good guardian, another not; and the good must be chosen to be the colleagues of our guardians. If however their natures are the same, the inference is that their education must also be the same; there is no longer anything unnatural or impossible in a woman learning music and gymnastic. And the education which we give them will be the very best, far superior to that of cobblers, and will train up the very best women, and nothing can be more advantageous to the State than this. Therefore let them strip, clothed in their chastity, and share in the toils of war and in the defence of their country; he who laughs at them is a fool for his pains.

The first wave is past, and the argument is compelled to admit that men and women have common duties and pursuits. A second and greater wave is rolling in—community of wives and children; is this either expedient or possible? The expediency I do not doubt; I am not so sure of the possibility. 'Nay, I think that a considerable doubt will be entertained on both points.' I meant to have escaped the trouble of proving the first, but as you have detected the little stratagem I must even submit. Only allow me to feed my fancy like the solitary in his walks, with a dream of what might be, and then I will return to the question of what can be.

In the first place our rulers will enforce the laws and make new ones where they are wanted, and their allies or ministers will obey. You, as legislator, have already selected the men; and now you shall select the women. After the selection has been made, they will dwell in common houses and have their meals in common, and will be brought together by a necessity more certain than that of mathematics. But they cannot be allowed to live in licentiousness; that is an unholy thing, which the rulers are determined to prevent. For the avoidance of this, holy marriage festivals will be instituted, and their holiness will be in proportion to their usefulness. And here, Glaucon, I should like to ask (as I know that you are a breeder of birds and animals), Do you not take the greatest care in the mating? 'Certainly.' And there is no reason to suppose that less care is required in the marriage of human beings. But then our rulers must be skilful physicians of the State, for they will often need a strong dose of falsehood in order to bring about desirable unions between their subjects. The good must be paired with the good, and the bad with the bad, and the offspring of the one must be reared, and of the other destroyed; in this way the flock will be preserved in prime condition. Hymeneal festivals will be celebrated at times fixed with an eye to population, and the brides and bridegrooms will meet at them; and by an ingenious system of lots the rulers will contrive that the brave and the fair come together, and that those of inferior breed are paired with inferiors—the latter will ascribe to chance what is really the invention of the rulers. And when children are born, the offspring of the brave and fair will be carried to an enclosure in a certain part of the city, and there attended by suitable nurses; the rest will be hurried away to places unknown. The mothers will be brought to the fold and will suckle the children; care however must be taken that none of them recognise their own offspring; and if necessary other nurses may also be hired. The trouble of watching and getting up at night will be transferred to attendants. 'Then the wives of our guardians will have a fine easy time when they are having children.' And quite right too, I said, that they should.

The parents ought to be in the prime of life, which for a man may be reckoned at thirty years—from twenty-five, when he has 'passed the point at which the speed of life is greatest,' to fifty-five; and at twenty years for a woman—from twenty to forty. Any one above or below those ages who partakes in the hymeneals shall be guilty of impiety; also every one who forms a marriage connexion at other times without the consent of the rulers. This latter regulation applies to those who are within the specified ages, after which they may range at will, provided they avoid the prohibited degrees of parents and children, or of brothers and sisters, which last, however, are not absolutely prohibited, if a dispensation be procured. 'But how shall we know the degrees of affinity, when all things are common?' The answer is, that brothers and sisters are all such as are born seven or nine months after the espousals, and their parents those who are then espoused, and every one will have many children and every child many parents.

Socrates proceeds: I have now to prove that this scheme is advantageous and also consistent with our entire polity. The greatest good of a State is unity; the greatest evil, discord and distraction. And there will be unity where there are no private pleasures or pains or interests—where if one member suffers all the members suffer, if one citizen is touched all are quickly sensitive; and the least hurt to the little finger of the State runs through the whole body and vibrates to the soul. For the true State, like an individual, is injured as a whole when any part is affected. Every State has subjects and rulers, who in a democracy are called rulers, and in other States masters: but in our State they are called saviours and allies; and the subjects who in other States are termed slaves, are by us termed nurturers and paymasters, and those who are termed comrades and colleagues in other places, are by us called fathers and brothers. And whereas in other States members of the same government regard one of their colleagues as a friend and another as an enemy, in our State no man is a stranger to another; for every citizen is connected with every other by ties of blood, and these names and this way of speaking will have a corresponding reality—brother, father, sister, mother, repeated from infancy in the ears of children, will not be mere words. Then again the citizens will have all things in common, in having common property they will have common pleasures and pains.

Can there be strife and contention among those who are of one mind; or lawsuits about property when men have nothing but their bodies which they call their own; or suits about violence when every one is bound to defend himself? The permission to strike when insulted will be an 'antidote' to the knife and will prevent disturbances in the State. But no younger man will strike an elder; reverence will prevent him from laying hands on his kindred, and he will fear that the rest of the family may retaliate. Moreover, our citizens will be rid of the lesser evils of life; there will be no flattery of the rich, no sordid household cares, no borrowing and not paying. Compared with the citizens of other States, ours will be Olympic victors, and crowned with blessings greater still—they and their children having a better maintenance during life, and after death an honourable burial. Nor has the happiness of the individual been sacrificed to the happiness of the State; our Olympic victor has not been turned into a cobbler, but he has a happiness beyond that of any cobbler. At the same time, if any conceited youth begins to dream of appropriating the State to himself, he must be reminded that 'half is better than the whole.' 'I should certainly advise him to stay where he is when he has the promise of such a brave life.'

But is such a community possible?—as among the animals, so also among men; and if possible, in what way possible? About war there is no difficulty; the principle of communism is adapted to military service. Parents will take their children to look on at a battle, just as potters' boys are trained to the business by looking on at the wheel. And to the parents themselves, as to other animals, the sight of their young ones will prove a great incentive to bravery. Young warriors must learn, but they must not run into danger, although a certain degree of risk is worth incurring when the benefit is great. The young creatures should be placed under the care of experienced veterans, and they should have wings—that is to say, swift and tractable steeds on which they may fly away and escape. One of the first things to be done is to teach a youth to ride.

Cowards and deserters shall be degraded to the class of husbandmen; gentlemen who allow themselves to be taken prisoners, may be presented to the enemy. But what shall be done to the hero? First of all he shall be crowned by all the youths in the army; secondly, he shall receive the right hand of fellowship; and thirdly, do you think that there is any harm in his being kissed? We have already determined that he shall have more wives than others, in order that he may have as many children as possible. And at a feast he shall have more to eat; we have the authority of Homer for honouring brave men with 'long chines,' which is an appropriate compliment, because meat is a very strengthening thing. Fill the bowl then, and give the best seats and meats to the brave—may they do them good! And he who dies in battle will be at once declared to be of the golden race, and will, as we believe, become one of Hesiod's guardian angels. He shall be worshipped after death in the manner prescribed by the oracle; and not only he, but all other benefactors of the State who die in any other way, shall be admitted to the same honours.

The next question is, How shall we treat our enemies? Shall Hellenes be enslaved? No; for there is too great a risk of the whole race passing under the yoke of the barbarians. Or shall the dead be despoiled? Certainly not; for that sort of thing is an excuse for skulking, and has been the ruin of many an army. There is meanness and feminine malice in making an enemy of the dead body, when the soul which was the owner has fled—like a dog who cannot reach his assailants, and quarrels with the stones which are thrown at him instead. Again, the arms of Hellenes should not be offered up in the temples of the Gods; they are a pollution, for they are taken from brethren. And on similar grounds there should be a limit to the devastation of Hellenic territory—the houses should not be burnt, nor more than the annual produce carried off. For war is of two kinds, civil and foreign; the first of which is properly termed 'discord,' and only the second 'war;' and war between Hellenes is in reality civil war—a quarrel in a family, which is ever to be regarded as unpatriotic and unnatural, and ought to be prosecuted with a view to reconciliation in a true phil-Hellenic spirit, as of those who would chasten but not utterly enslave. The war is not against a whole nation who are a friendly multitude of men, women, and children, but only against a few guilty persons; when they are punished peace will be restored. That is the way in which Hellenes should war against one another—and against barbarians, as they war against one another now.

'But, my dear Socrates, you are forgetting the main question: Is such a State possible? I grant all and more than you say about the blessedness of being one family—fathers, brothers, mothers, daughters, going out to war together; but I want to ascertain the possibility of this ideal State.' You are too unmerciful. The first wave and the second wave I have hardly escaped, and now you will certainly drown me with the third. When you see the towering crest of the wave, I expect you to take pity. 'Not a whit.'

Well, then, we were led to form our ideal polity in the search after justice, and the just man answered to the just State. Is this ideal at all the worse for being impracticable? Would the picture of a perfectly beautiful man be any the worse because no such man ever lived? Can any reality come up to the idea? Nature will not allow words to be fully realized; but if I am to try and realize the ideal of the State in a measure, I think that an approach may be made to the perfection of which I dream by one or two, I do not say slight, but possible changes in the present constitution of States. I would reduce them to a single one—the great wave, as I call it. Until, then, kings are philosophers, or philosophers are kings, cities will never cease from ill: no, nor the human race; nor will our ideal polity ever come into being. I know that this is a hard saying, which few will be able to receive. 'Socrates, all the world will take off his coat and rush upon you with sticks and stones, and therefore I would advise you to prepare an answer.' You got me into the scrape, I said. 'And I was right,' he replied; 'however, I will stand by you as a sort of do-nothing, well-meaning ally.' Having the help of such a champion, I will do my best to maintain my position. And first, I must explain of whom I speak and what sort of natures these are who are to be philosophers and rulers. As you are a man of pleasure, you will not have forgotten how indiscriminate lovers are in their attachments; they love all, and turn blemishes into beauties. The snub-nosed youth is said to have a winning grace; the beak of another has a royal look; the featureless are faultless; the dark are manly, the fair angels; the sickly have a new term of endearment invented expressly for them, which is 'honey-pale.' Lovers of wine and lovers of ambition also desire the objects of their affection in every form. Now here comes the point:—The philosopher too is a lover of knowledge in every form; he has an insatiable curiosity. 'But will curiosity make a philosopher? Are the lovers of sights and sounds, who let out their ears to every chorus at the Dionysiac festivals, to be called philosophers?' They are not true philosophers, but only an imitation. 'Then how are we to describe the true?'

You would acknowledge the existence of abstract ideas, such as justice, beauty, good, evil, which are severally one, yet in their various combinations appear to be many. Those who recognize these realities are philosophers; whereas the other class hear sounds and see colours, and understand their use in the arts, but cannot attain to the true or waking vision of absolute justice or beauty or truth; they have not the light of knowledge, but of opinion, and what they see is a dream only. Perhaps he of whom we say the last will be angry with us; can we pacify him without revealing the disorder of his mind? Suppose we say that, if he has knowledge we rejoice to hear it, but knowledge must be of something which is, as ignorance is of something which is not; and there is a third thing, which both is and is not, and is matter of opinion only. Opinion and knowledge, then, having distinct objects, must also be distinct faculties. And by faculties I mean powers unseen and distinguishable only by the difference in their objects, as opinion and knowledge differ, since the one is liable to err, but the other is unerring and is the mightiest of all our faculties. If being is the object of knowledge, and not-being of ignorance, and these are the extremes, opinion must lie between them, and may be called darker than the one and brighter than the other. This intermediate or contingent matter is and is not at the same time, and partakes both of existence and of non-existence. Now I would ask my good friend, who denies abstract beauty and justice, and affirms a many beautiful and a many just, whether everything he sees is not in some point of view different—the beautiful ugly, the pious impious, the just unjust? Is not the double also the half, and are not heavy and light relative terms which pass into one another? Everything is and is not, as in the old riddle—'A man and not a man shot and did not shoot a bird and not a bird with a stone and not a stone.' The mind cannot be fixed on either alternative; and these ambiguous, intermediate, erring, half-lighted objects, which have a disorderly movement in the region between being and not-being, are the proper matter of opinion, as the immutable objects are the proper matter of knowledge. And he who grovels in the world of sense, and has only this uncertain perception of things, is not a philosopher, but a lover of opinion only...

The fifth book is the new beginning of the Republic, in which the community of property and of family are first maintained, and the transition is made to the kingdom of philosophers. For both of these Plato, after his manner, has been preparing in some chance words of Book IV, which fall unperceived on the reader's mind, as they are supposed at first to have fallen on the ear of Glaucon and Adeimantus. The 'paradoxes,' as Morgenstern terms them, of this book of the Republic will be reserved for another place; a few remarks on the style, and some explanations of difficulties, may be briefly added.

First, there is the image of the waves, which serves for a sort of scheme or plan of the book. The first wave, the second wave, the third and greatest wave come rolling in, and we hear the roar of them. All that can be said of the extravagance of Plato's proposals is anticipated by himself. Nothing is more admirable than the hesitation with which he proposes the solemn text, 'Until kings are philosophers,' etc.; or the reaction from the sublime to the ridiculous, when Glaucon describes the manner in which the new truth will be received by mankind.

Some defects and difficulties may be noted in the execution of the communistic plan. Nothing is told us of the application of communism to the lower classes; nor is the table of prohibited degrees capable of being made out. It is quite possible that a child born at one hymeneal festival may marry one of its own brothers or sisters, or even one of its parents, at another. Plato is afraid of incestuous unions, but at the same time he does not wish to bring before us the fact that the city would be divided into families of those born seven and nine months after each hymeneal festival. If it were worth while to argue seriously about such fancies, we might remark that while all the old affinities are abolished, the newly prohibited affinity rests not on any natural or rational principle, but only upon the accident of children having been born in the same month and year. Nor does he explain how the lots could be so manipulated by the legislature as to bring together the fairest and best. The singular expression which is employed to describe the age of five-and-twenty may perhaps be taken from some poet.

In the delineation of the philosopher, the illustrations of the nature of philosophy derived from love are more suited to the apprehension of Glaucon, the Athenian man of pleasure, than to modern tastes or feelings. They are partly facetious, but also contain a germ of truth. That science is a whole, remains a true principle of inductive as well as of metaphysical philosophy; and the love of universal knowledge is still the characteristic of the philosopher in modern as well as in ancient times.

At the end of the fifth book Plato introduces the figment of contingent matter, which has exercised so great an influence both on the Ethics and Theology of the modern world, and which occurs here for the first time in the history of philosophy. He did not remark that the degrees of knowledge in the subject have nothing corresponding to them in the object. With him a word must answer to an idea; and he could not conceive of an opinion which was an opinion about nothing. The influence of analogy led him to invent 'parallels and conjugates' and to overlook facts. To us some of his difficulties are puzzling only from their simplicity: we do not perceive that the answer to them 'is tumbling out at our feet.' To the mind of early thinkers, the conception of not-being was dark and mysterious; they did not see that this terrible apparition which threatened destruction to all knowledge was only a logical determination. The common term under which, through the accidental use of language, two entirely different ideas were included was another source of confusion. Thus through the ambiguity of (Greek) Plato, attempting to introduce order into the first chaos of human thought, seems to have confused perception and opinion, and to have failed to distinguish the contingent from the relative. In the Theaetetus the first of these difficulties begins to clear up; in the Sophist the second; and for this, as well as for other reasons, both these dialogues are probably to be regarded as later than the Republic.

BOOK VI. Having determined that the many have no knowledge of true being, and have no clear patterns in their minds of justice, beauty, truth, and that philosophers have such patterns, we have now to ask whether they or the many shall be rulers in our State. But who can doubt that philosophers should be chosen, if they have the other qualities which are required in a ruler? For they are lovers of the knowledge of the eternal and of all truth; they are haters of falsehood; their meaner desires are absorbed in the interests of knowledge; they are spectators of all time and all existence; and in the magnificence of their contemplation the life of man is as nothing to them, nor is death fearful. Also they are of a social, gracious disposition, equally free from cowardice and arrogance. They learn and remember easily; they have harmonious, well-regulated minds; truth flows to them sweetly by nature. Can the god of Jealousy himself find any fault with such an assemblage of good qualities?

Here Adeimantus interposes:—'No man can answer you, Socrates; but every man feels that this is owing to his own deficiency in argument. He is driven from one position to another, until he has nothing more to say, just as an unskilful player at draughts is reduced to his last move by a more skilled opponent. And yet all the time he may be right. He may know, in this very instance, that those who make philosophy the business of their lives, generally turn out rogues if they are bad men, and fools if they are good. What do you say?' I should say that he is quite right. 'Then how is such an admission reconcileable with the doctrine that philosophers should be kings?'

I shall answer you in a parable which will also let you see how poor a hand I am at the invention of allegories. The relation of good men to their governments is so peculiar, that in order to defend them I must take an illustration from the world of fiction. Conceive the captain of a ship, taller by a head and shoulders than any of the crew, yet a little deaf, a little blind, and rather ignorant of the seaman's art. The sailors want to steer, although they know nothing of the art; and they have a theory that it cannot be learned. If the helm is refused them, they drug the captain's posset, bind him hand and foot, and take possession of the ship. He who joins in the mutiny is termed a good pilot and what not; they have no conception that the true pilot must observe the winds and the stars, and must be their master, whether they like it or not;—such an one would be called by them fool, prater, star-gazer. This is my parable; which I will beg you to interpret for me to those gentlemen who ask why the philosopher has such an evil name, and to explain to them that not he, but those who will not use him, are to blame for his uselessness. The philosopher should not beg of mankind to be put in authority over them. The wise man should not seek the rich, as the proverb bids, but every man, whether rich or poor, must knock at the door of the physician when he has need of him. Now the pilot is the philosopher—he whom in the parable they call star-gazer, and the mutinous sailors are the mob of politicians by whom he is rendered useless. Not that these are the worst enemies of philosophy, who is far more dishonoured by her own professing sons when they are corrupted by the world. Need I recall the original image of the philosopher? Did we not say of him just now, that he loved truth and hated falsehood, and that he could not rest in the multiplicity of phenomena, but was led by a sympathy in his own nature to the contemplation of the absolute? All the virtues as well as truth, who is the leader of them, took up their abode in his soul. But as you were observing, if we turn aside to view the reality, we see that the persons who were thus described, with the exception of a small and useless class, are utter rogues.

The point which has to be considered, is the origin of this corruption in nature. Every one will admit that the philosopher, in our description of him, is a rare being. But what numberless causes tend to destroy these rare beings! There is no good thing which may not be a cause of evil—health, wealth, strength, rank, and the virtues themselves, when placed under unfavourable circumstances. For as in the animal or vegetable world the strongest seeds most need the accompaniment of good air and soil, so the best of human characters turn out the worst when they fall upon an unsuitable soil; whereas weak natures hardly ever do any considerable good or harm; they are not the stuff out of which either great criminals or great heroes are made. The philosopher follows the same analogy: he is either the best or the worst of all men. Some persons say that the Sophists are the corrupters of youth; but is not public opinion the real Sophist who is everywhere present—in those very persons, in the assembly, in the courts, in the camp, in the applauses and hisses of the theatre re-echoed by the surrounding hills? Will not a young man's heart leap amid these discordant sounds? and will any education save him from being carried away by the torrent? Nor is this all. For if he will not yield to opinion, there follows the gentle compulsion of exile or death. What principle of rival Sophists or anybody else can overcome in such an unequal contest? Characters there may be more than human, who are exceptions—God may save a man, but not his own strength. Further, I would have you consider that the hireling Sophist only gives back to the world their own opinions; he is the keeper of the monster, who knows how to flatter or anger him, and observes the meaning of his inarticulate grunts. Good is what pleases him, evil what he dislikes; truth and beauty are determined only by the taste of the brute. Such is the Sophist's wisdom, and such is the condition of those who make public opinion the test of truth, whether in art or in morals. The curse is laid upon them of being and doing what it approves, and when they attempt first principles the failure is ludicrous. Think of all this and ask yourself whether the world is more likely to be a believer in the unity of the idea, or in the multiplicity of phenomena. And the world if not a believer in the idea cannot be a philosopher, and must therefore be a persecutor of philosophers. There is another evil:—the world does not like to lose the gifted nature, and so they flatter the young (Alcibiades) into a magnificent opinion of his own capacity; the tall, proper youth begins to expand, and is dreaming of kingdoms and empires. If at this instant a friend whispers to him, 'Now the gods lighten thee; thou art a great fool' and must be educated—do you think that he will listen? Or suppose a better sort of man who is attracted towards philosophy, will they not make Herculean efforts to spoil and corrupt him? Are we not right in saying that the love of knowledge, no less than riches, may divert him? Men of this class (Critias) often become politicians—they are the authors of great mischief in states, and sometimes also of great good. And thus philosophy is deserted by her natural protectors, and others enter in and dishonour her. Vulgar little minds see the land open and rush from the prisons of the arts into her temple. A clever mechanic having a soul coarse as his body, thinks that he will gain caste by becoming her suitor. For philosophy, even in her fallen estate, has a dignity of her own—and he, like a bald little blacksmith's apprentice as he is, having made some money and got out of durance, washes and dresses himself as a bridegroom and marries his master's daughter. What will be the issue of such marriages? Will they not be vile and bastard, devoid of truth and nature? 'They will.' Small, then, is the remnant of genuine philosophers; there may be a few who are citizens of small states, in which politics are not worth thinking of, or who have been detained by Theages' bridle of ill health; for my own case of the oracular sign is almost unique, and too rare to be worth mentioning. And these few when they have tasted the pleasures of philosophy, and have taken a look at that den of thieves and place of wild beasts, which is human life, will stand aside from the storm under the shelter of a wall, and try to preserve their own innocence and to depart in peace. 'A great work, too, will have been accomplished by them.' Great, yes, but not the greatest; for man is a social being, and can only attain his highest development in the society which is best suited to him.

Enough, then, of the causes why philosophy has such an evil name. Another question is, Which of existing states is suited to her? Not one of them; at present she is like some exotic seed which degenerates in a strange soil; only in her proper state will she be shown to be of heavenly growth. 'And is her proper state ours or some other?' Ours in all points but one, which was left undetermined. You may remember our saying that some living mind or witness of the legislator was needed in states. But we were afraid to enter upon a subject of such difficulty, and now the question recurs and has not grown easier:—How may philosophy be safely studied? Let us bring her into the light of day, and make an end of the inquiry.

In the first place, I say boldly that nothing can be worse than the present mode of study. Persons usually pick up a little philosophy in early youth, and in the intervals of business, but they never master the real difficulty, which is dialectic. Later, perhaps, they occasionally go to a lecture on philosophy. Years advance, and the sun of philosophy, unlike that of Heracleitus, sets never to rise again. This order of education should be reversed; it should begin with gymnastics in youth, and as the man strengthens, he should increase the gymnastics of his soul. Then, when active life is over, let him finally return to philosophy. 'You are in earnest, Socrates, but the world will be equally earnest in withstanding you—no more than Thrasymachus.' Do not make a quarrel between Thrasymachus and me, who were never enemies and are now good friends enough. And I shall do my best to convince him and all mankind of the truth of my words, or at any rate to prepare for the future when, in another life, we may again take part in similar discussions. 'That will be a long time hence.' Not long in comparison with eternity. The many will probably remain incredulous, for they have never seen the natural unity of ideas, but only artificial juxtapositions; not free and generous thoughts, but tricks of controversy and quips of law;—a perfect man ruling in a perfect state, even a single one they have not known. And we foresaw that there was no chance of perfection either in states or individuals until a necessity was laid upon philosophers—not the rogues, but those whom we called the useless class—of holding office; or until the sons of kings were inspired with a true love of philosophy. Whether in the infinity of past time there has been, or is in some distant land, or ever will be hereafter, an ideal such as we have described, we stoutly maintain that there has been, is, and will be such a state whenever the Muse of philosophy rules. Will you say that the world is of another mind? O, my friend, do not revile the world! They will soon change their opinion if they are gently entreated, and are taught the true nature of the philosopher. Who can hate a man who loves him? Or be jealous of one who has no jealousy? Consider, again, that the many hate not the true but the false philosophers—the pretenders who force their way in without invitation, and are always speaking of persons and not of principles, which is unlike the spirit of philosophy. For the true philosopher despises earthly strife; his eye is fixed on the eternal order in accordance with which he moulds himself into the Divine image (and not himself only, but other men), and is the creator of the virtues private as well as public. When mankind see that the happiness of states is only to be found in that image, will they be angry with us for attempting to delineate it? 'Certainly not. But what will be the process of delineation?' The artist will do nothing until he has made a tabula rasa; on this he will inscribe the constitution of a state, glancing often at the divine truth of nature, and from that deriving the godlike among men, mingling the two elements, rubbing out and painting in, until there is a perfect harmony or fusion of the divine and human. But perhaps the world will doubt the existence of such an artist. What will they doubt? That the philosopher is a lover of truth, having a nature akin to the best?—and if they admit this will they still quarrel with us for making philosophers our kings? 'They will be less disposed to quarrel.' Let us assume then that they are pacified. Still, a person may hesitate about the probability of the son of a king being a philosopher. And we do not deny that they are very liable to be corrupted; but yet surely in the course of ages there might be one exception—and one is enough. If one son of a king were a philosopher, and had obedient citizens, he might bring the ideal polity into being. Hence we conclude that our laws are not only the best, but that they are also possible, though not free from difficulty.

I gained nothing by evading the troublesome questions which arose concerning women and children. I will be wiser now and acknowledge that we must go to the bottom of another question: What is to be the education of our guardians? It was agreed that they were to be lovers of their country, and were to be tested in the refiner's fire of pleasures and pains, and those who came forth pure and remained fixed in their principles were to have honours and rewards in life and after death. But at this point, the argument put on her veil and turned into another path. I hesitated to make the assertion which I now hazard,—that our guardians must be philosophers. You remember all the contradictory elements, which met in the philosopher—how difficult to find them all in a single person! Intelligence and spirit are not often combined with steadiness; the stolid, fearless, nature is averse to intellectual toil. And yet these opposite elements are all necessary, and therefore, as we were saying before, the aspirant must be tested in pleasures and dangers; and also, as we must now further add, in the highest branches of knowledge. You will remember, that when we spoke of the virtues mention was made of a longer road, which you were satisfied to leave unexplored. 'Enough seemed to have been said.' Enough, my friend; but what is enough while anything remains wanting? Of all men the guardian must not faint in the search after truth; he must be prepared to take the longer road, or he will never reach that higher region which is above the four virtues; and of the virtues too he must not only get an outline, but a clear and distinct vision. (Strange that we should be so precise about trifles, so careless about the highest truths!) 'And what are the highest?' You to pretend unconsciousness, when you have so often heard me speak of the idea of good, about which we know so little, and without which though a man gain the world he has no profit of it! Some people imagine that the good is wisdom; but this involves a circle,—the good, they say, is wisdom, wisdom has to do with the good. According to others the good is pleasure; but then comes the absurdity that good is bad, for there are bad pleasures as well as good. Again, the good must have reality; a man may desire the appearance of virtue, but he will not desire the appearance of good. Ought our guardians then to be ignorant of this supreme principle, of which every man has a presentiment, and without which no man has any real knowledge of anything? 'But, Socrates, what is this supreme principle, knowledge or pleasure, or what? You may think me troublesome, but I say that you have no business to be always repeating the doctrines of others instead of giving us your own.' Can I say what I do not know? 'You may offer an opinion.' And will the blindness and crookedness of opinion content you when you might have the light and certainty of science? 'I will only ask you to give such an explanation of the good as you have given already of temperance and justice.' I wish that I could, but in my present mood I cannot reach to the height of the knowledge of the good. To the parent or principal I cannot introduce you, but to the child begotten in his image, which I may compare with the interest on the principal, I will. (Audit the account, and do not let me give you a false statement of the debt.) You remember our old distinction of the many beautiful and the one beautiful, the particular and the universal, the objects of sight and the objects of thought? Did you ever consider that the objects of sight imply a faculty of sight which is the most complex and costly of our senses, requiring not only objects of sense, but also a medium, which is light; without which the sight will not distinguish between colours and all will be a blank? For light is the noble bond between the perceiving faculty and the thing perceived, and the god who gives us light is the sun, who is the eye of the day, but is not to be confounded with the eye of man. This eye of the day or sun is what I call the child of the good, standing in the same relation to the visible world as the good to the intellectual. When the sun shines the eye sees, and in the intellectual world where truth is, there is sight and light. Now that which is the sun of intelligent natures, is the idea of good, the cause of knowledge and truth, yet other and fairer than they are, and standing in the same relation to them in which the sun stands to light. O inconceivable height of beauty, which is above knowledge and above truth! ('You cannot surely mean pleasure,' he said. Peace, I replied.) And this idea of good, like the sun, is also the cause of growth, and the author not of knowledge only, but of being, yet greater far than either in dignity and power. 'That is a reach of thought more than human; but, pray, go on with the image, for I suspect that there is more behind.' There is, I said; and bearing in mind our two suns or principles, imagine further their corresponding worlds—one of the visible, the other of the intelligible; you may assist your fancy by figuring the distinction under the image of a line divided into two unequal parts, and may again subdivide each part into two lesser segments representative of the stages of knowledge in either sphere. The lower portion of the lower or visible sphere will consist of shadows and reflections, and its upper and smaller portion will contain real objects in the world of nature or of art. The sphere of the intelligible will also have two divisions,—one of mathematics, in which there is no ascent but all is descent; no inquiring into premises, but only drawing of inferences. In this division the mind works with figures and numbers, the images of which are taken not from the shadows, but from the objects, although the truth of them is seen only with the mind's eye; and they are used as hypotheses without being analysed. Whereas in the other division reason uses the hypotheses as stages or steps in the ascent to the idea of good, to which she fastens them, and then again descends, walking firmly in the region of ideas, and of ideas only, in her ascent as well as descent, and finally resting in them. 'I partly understand,' he replied; 'you mean that the ideas of science are superior to the hypothetical, metaphorical conceptions of geometry and the other arts or sciences, whichever is to be the name of them; and the latter conceptions you refuse to make subjects of pure intellect, because they have no first principle, although when resting on a first principle, they pass into the higher sphere.' You understand me very well, I said. And now to those four divisions of knowledge you may assign four corresponding faculties—pure intelligence to the highest sphere; active intelligence to the second; to the third, faith; to the fourth, the perception of shadows—and the clearness of the several faculties will be in the same ratio as the truth of the objects to which they are related...

Like Socrates, we may recapitulate the virtues of the philosopher. In language which seems to reach beyond the horizon of that age and country, he is described as 'the spectator of all time and all existence.' He has the noblest gifts of nature, and makes the highest use of them. All his desires are absorbed in the love of wisdom, which is the love of truth. None of the graces of a beautiful soul are wanting in him; neither can he fear death, or think much of human life. The ideal of modern times hardly retains the simplicity of the antique; there is not the same originality either in truth or error which characterized the Greeks. The philosopher is no longer living in the unseen, nor is he sent by an oracle to convince mankind of ignorance; nor does he regard knowledge as a system of ideas leading upwards by regular stages to the idea of good. The eagerness of the pursuit has abated; there is more division of labour and less of comprehensive reflection upon nature and human life as a whole; more of exact observation and less of anticipation and inspiration. Still, in the altered conditions of knowledge, the parallel is not wholly lost; and there may be a use in translating the conception of Plato into the language of our own age. The philosopher in modern times is one who fixes his mind on the laws of nature in their sequence and connexion, not on fragments or pictures of nature; on history, not on controversy; on the truths which are acknowledged by the few, not on the opinions of the many. He is aware of the importance of 'classifying according to nature,' and will try to 'separate the limbs of science without breaking them' (Phaedr.). There is no part of truth, whether great or small, which he will dishonour; and in the least things he will discern the greatest (Parmen.). Like the ancient philosopher he sees the world pervaded by analogies, but he can also tell 'why in some cases a single instance is sufficient for an induction' (Mill's Logic), while in other cases a thousand examples would prove nothing. He inquires into a portion of knowledge only, because the whole has grown too vast to be embraced by a single mind or life. He has a clearer conception of the divisions of science and of their relation to the mind of man than was possible to the ancients. Like Plato, he has a vision of the unity of knowledge, not as the beginning of philosophy to be attained by a study of elementary mathematics, but as the far-off result of the working of many minds in many ages. He is aware that mathematical studies are preliminary to almost every other; at the same time, he will not reduce all varieties of knowledge to the type of mathematics. He too must have a nobility of character, without which genius loses the better half of greatness. Regarding the world as a point in immensity, and each individual as a link in a never-ending chain of existence, he will not think much of his own life, or be greatly afraid of death.

Adeimantus objects first of all to the form of the Socratic reasoning, thus showing that Plato is aware of the imperfection of his own method. He brings the accusation against himself which might be brought against him by a modern logician—that he extracts the answer because he knows how to put the question. In a long argument words are apt to change their meaning slightly, or premises may be assumed or conclusions inferred with rather too much certainty or universality; the variation at each step may be unobserved, and yet at last the divergence becomes considerable. Hence the failure of attempts to apply arithmetical or algebraic formulae to logic. The imperfection, or rather the higher and more elastic nature of language, does not allow words to have the precision of numbers or of symbols. And this quality in language impairs the force of an argument which has many steps.

The objection, though fairly met by Socrates in this particular instance, may be regarded as implying a reflection upon the Socratic mode of reasoning. And here, as elsewhere, Plato seems to intimate that the time had come when the negative and interrogative method of Socrates must be superseded by a positive and constructive one, of which examples are given in some of the later dialogues. Adeimantus further argues that the ideal is wholly at variance with facts; for experience proves philosophers to be either useless or rogues. Contrary to all expectation Socrates has no hesitation in admitting the truth of this, and explains the anomaly in an allegory, first characteristically depreciating his own inventive powers. In this allegory the people are distinguished from the professional politicians, and, as elsewhere, are spoken of in a tone of pity rather than of censure under the image of 'the noble captain who is not very quick in his perceptions.'

The uselessness of philosophers is explained by the circumstance that mankind will not use them. The world in all ages has been divided between contempt and fear of those who employ the power of ideas and know no other weapons. Concerning the false philosopher, Socrates argues that the best is most liable to corruption; and that the finer nature is more likely to suffer from alien conditions. We too observe that there are some kinds of excellence which spring from a peculiar delicacy of constitution; as is evidently true of the poetical and imaginative temperament, which often seems to depend on impressions, and hence can only breathe or live in a certain atmosphere. The man of genius has greater pains and greater pleasures, greater powers and greater weaknesses, and often a greater play of character than is to be found in ordinary men. He can assume the disguise of virtue or disinterestedness without having them, or veil personal enmity in the language of patriotism and philosophy,—he can say the word which all men are thinking, he has an insight which is terrible into the follies and weaknesses of his fellow-men. An Alcibiades, a Mirabeau, or a Napoleon the First, are born either to be the authors of great evils in states, or 'of great good, when they are drawn in that direction.'

Yet the thesis, 'corruptio optimi pessima,' cannot be maintained generally or without regard to the kind of excellence which is corrupted. The alien conditions which are corrupting to one nature, may be the elements of culture to another. In general a man can only receive his highest development in a congenial state or family, among friends or fellow-workers. But also he may sometimes be stirred by adverse circumstances to such a degree that he rises up against them and reforms them. And while weaker or coarser characters will extract good out of evil, say in a corrupt state of the church or of society, and live on happily, allowing the evil to remain, the finer or stronger natures may be crushed or spoiled by surrounding influences—may become misanthrope and philanthrope by turns; or in a few instances, like the founders of the monastic orders, or the Reformers, owing to some peculiarity in themselves or in their age, may break away entirely from the world and from the church, sometimes into great good, sometimes into great evil, sometimes into both. And the same holds in the lesser sphere of a convent, a school, a family.

Plato would have us consider how easily the best natures are overpowered by public opinion, and what efforts the rest of mankind will make to get possession of them. The world, the church, their own profession, any political or party organization, are always carrying them off their legs and teaching them to apply high and holy names to their own prejudices and interests. The 'monster' corporation to which they belong judges right and truth to be the pleasure of the community. The individual becomes one with his order; or, if he resists, the world is too much for him, and will sooner or later be revenged on him. This is, perhaps, a one-sided but not wholly untrue picture of the maxims and practice of mankind when they 'sit down together at an assembly,' either in ancient or modern times.

When the higher natures are corrupted by politics, the lower take possession of the vacant place of philosophy. This is described in one of those continuous images in which the argument, to use a Platonic expression, 'veils herself,' and which is dropped and reappears at intervals. The question is asked,—Why are the citizens of states so hostile to philosophy? The answer is, that they do not know her. And yet there is also a better mind of the many; they would believe if they were taught. But hitherto they have only known a conventional imitation of philosophy, words without thoughts, systems which have no life in them; a (divine) person uttering the words of beauty and freedom, the friend of man holding communion with the Eternal, and seeking to frame the state in that image, they have never known. The same double feeling respecting the mass of mankind has always existed among men. The first thought is that the people are the enemies of truth and right; the second, that this only arises out of an accidental error and confusion, and that they do not really hate those who love them, if they could be educated to know them.

In the latter part of the sixth book, three questions have to be considered: 1st, the nature of the longer and more circuitous way, which is contrasted with the shorter and more imperfect method of Book IV; 2nd, the heavenly pattern or idea of the state; 3rd, the relation of the divisions of knowledge to one another and to the corresponding faculties of the soul:

1. Of the higher method of knowledge in Plato we have only a glimpse. Neither here nor in the Phaedrus or Symposium, nor yet in the Philebus or Sophist, does he give any clear explanation of his meaning. He would probably have described his method as proceeding by regular steps to a system of universal knowledge, which inferred the parts from the whole rather than the whole from the parts. This ideal logic is not practised by him in the search after justice, or in the analysis of the parts of the soul; there, like Aristotle in the Nicomachean Ethics, he argues from experience and the common use of language. But at the end of the sixth book he conceives another and more perfect method, in which all ideas are only steps or grades or moments of thought, forming a connected whole which is self-supporting, and in which consistency is the test of truth. He does not explain to us in detail the nature of the process. Like many other thinkers both in ancient and modern times his mind seems to be filled with a vacant form which he is unable to realize. He supposes the sciences to have a natural order and connexion in an age when they can hardly be said to exist. He is hastening on to the 'end of the intellectual world' without even making a beginning of them.

In modern times we hardly need to be reminded that the process of acquiring knowledge is here confused with the contemplation of absolute knowledge. In all science a priori and a posteriori truths mingle in various proportions. The a priori part is that which is derived from the most universal experience of men, or is universally accepted by them; the a posteriori is that which grows up around the more general principles and becomes imperceptibly one with them. But Plato erroneously imagines that the synthesis is separable from the analysis, and that the method of science can anticipate science. In entertaining such a vision of a priori knowledge he is sufficiently justified, or at least his meaning may be sufficiently explained by the similar attempts of Descartes, Kant, Hegel, and even of Bacon himself, in modern philosophy. Anticipations or divinations, or prophetic glimpses of truths whether concerning man or nature, seem to stand in the same relation to ancient philosophy which hypotheses bear to modern inductive science. These 'guesses at truth' were not made at random; they arose from a superficial impression of uniformities and first principles in nature which the genius of the Greek, contemplating the expanse of heaven and earth, seemed to recognize in the distance. Nor can we deny that in ancient times knowledge must have stood still, and the human mind been deprived of the very instruments of thought, if philosophy had been strictly confined to the results of experience.

2. Plato supposes that when the tablet has been made blank the artist will fill in the lineaments of the ideal state. Is this a pattern laid up in heaven, or mere vacancy on which he is supposed to gaze with wondering eye? The answer is, that such ideals are framed partly by the omission of particulars, partly by imagination perfecting the form which experience supplies (Phaedo). Plato represents these ideals in a figure as belonging to another world; and in modern times the idea will sometimes seem to precede, at other times to co-operate with the hand of the artist. As in science, so also in creative art, there is a synthetical as well as an analytical method. One man will have the whole in his mind before he begins; to another the processes of mind and hand will be simultaneous.

3. There is no difficulty in seeing that Plato's divisions of knowledge are based, first, on the fundamental antithesis of sensible and intellectual which pervades the whole pre-Socratic philosophy; in which is implied also the opposition of the permanent and transient, of the universal and particular. But the age of philosophy in which he lived seemed to require a further distinction;—numbers and figures were beginning to separate from ideas. The world could no longer regard justice as a cube, and was learning to see, though imperfectly, that the abstractions of sense were distinct from the abstractions of mind. Between the Eleatic being or essence and the shadows of phenomena, the Pythagorean principle of number found a place, and was, as Aristotle remarks, a conducting medium from one to the other. Hence Plato is led to introduce a third term which had not hitherto entered into the scheme of his philosophy. He had observed the use of mathematics in education; they were the best preparation for higher studies. The subjective relation between them further suggested an objective one; although the passage from one to the other is really imaginary (Metaph.). For metaphysical and moral philosophy has no connexion with mathematics; number and figure are the abstractions of time and space, not the expressions of purely intellectual conceptions. When divested of metaphor, a straight line or a square has no more to do with right and justice than a crooked line with vice. The figurative association was mistaken for a real one; and thus the three latter divisions of the Platonic proportion were constructed.

There is more difficulty in comprehending how he arrived at the first term of the series, which is nowhere else mentioned, and has no reference to any other part of his system. Nor indeed does the relation of shadows to objects correspond to the relation of numbers to ideas. Probably Plato has been led by the love of analogy (Timaeus) to make four terms instead of three, although the objects perceived in both divisions of the lower sphere are equally objects of sense. He is also preparing the way, as his manner is, for the shadows of images at the beginning of the seventh book, and the imitation of an imitation in the tenth. The line may be regarded as reaching from unity to infinity, and is divided into two unequal parts, and subdivided into two more; each lower sphere is the multiplication of the preceding. Of the four faculties, faith in the lower division has an intermediate position (cp. for the use of the word faith or belief, (Greek), Timaeus), contrasting equally with the vagueness of the perception of shadows (Greek) and the higher certainty of understanding (Greek) and reason (Greek).

The difference between understanding and mind or reason (Greek) is analogous to the difference between acquiring knowledge in the parts and the contemplation of the whole. True knowledge is a whole, and is at rest; consistency and universality are the tests of truth. To this self-evidencing knowledge of the whole the faculty of mind is supposed to correspond. But there is a knowledge of the understanding which is incomplete and in motion always, because unable to rest in the subordinate ideas. Those ideas are called both images and hypotheses—images because they are clothed in sense, hypotheses because they are assumptions only, until they are brought into connexion with the idea of good.

The general meaning of the passage, 'Noble, then, is the bond which links together sight...And of this kind I spoke as the intelligible...' so far as the thought contained in it admits of being translated into the terms of modern philosophy, may be described or explained as follows:—There is a truth, one and self-existent, to which by the help of a ladder let down from above, the human intelligence may ascend. This unity is like the sun in the heavens, the light by which all things are seen, the being by which they are created and sustained. It is the IDEA of good. And the steps of the ladder leading up to this highest or universal existence are the mathematical sciences, which also contain in themselves an element of the universal. These, too, we see in a new manner when we connect them with the idea of good. They then cease to be hypotheses or pictures, and become essential parts of a higher truth which is at once their first principle and their final cause.

We cannot give any more precise meaning to this remarkable passage, but we may trace in it several rudiments or vestiges of thought which are common to us and to Plato: such as (1) the unity and correlation of the sciences, or rather of science, for in Plato's time they were not yet parted off or distinguished; (2) the existence of a Divine Power, or life or idea or cause or reason, not yet conceived or no longer conceived as in the Timaeus and elsewhere under the form of a person; (3) the recognition of the hypothetical and conditional character of the mathematical sciences, and in a measure of every science when isolated from the rest; (4) the conviction of a truth which is invisible, and of a law, though hardly a law of nature, which permeates the intellectual rather than the visible world.

The method of Socrates is hesitating and tentative, awaiting the fuller explanation of the idea of good, and of the nature of dialectic in the seventh book. The imperfect intelligence of Glaucon, and the reluctance of Socrates to make a beginning, mark the difficulty of the subject. The allusion to Theages' bridle, and to the internal oracle, or demonic sign, of Socrates, which here, as always in Plato, is only prohibitory; the remark that the salvation of any remnant of good in the present evil state of the world is due to God only; the reference to a future state of existence, which is unknown to Glaucon in the tenth book, and in which the discussions of Socrates and his disciples would be resumed; the surprise in the answers; the fanciful irony of Socrates, where he pretends that he can only describe the strange position of the philosopher in a figure of speech; the original observation that the Sophists, after all, are only the representatives and not the leaders of public opinion; the picture of the philosopher standing aside in the shower of sleet under a wall; the figure of 'the great beast' followed by the expression of good-will towards the common people who would not have rejected the philosopher if they had known him; the 'right noble thought' that the highest truths demand the greatest exactness; the hesitation of Socrates in returning once more to his well-worn theme of the idea of good; the ludicrous earnestness of Glaucon; the comparison of philosophy to a deserted maiden who marries beneath her—are some of the most interesting characteristics of the sixth book.

Yet a few more words may be added, on the old theme, which was so oft discussed in the Socratic circle, of which we, like Glaucon and Adeimantus, would fain, if possible, have a clearer notion. Like them, we are dissatisfied when we are told that the idea of good can only be revealed to a student of the mathematical sciences, and we are inclined to think that neither we nor they could have been led along that path to any satisfactory goal. For we have learned that differences of quantity cannot pass into differences of quality, and that the mathematical sciences can never rise above themselves into the sphere of our higher thoughts, although they may sometimes furnish symbols and expressions of them, and may train the mind in habits of abstraction and self-concentration. The illusion which was natural to an ancient philosopher has ceased to be an illusion to us. But if the process by which we are supposed to arrive at the idea of good be really imaginary, may not the idea itself be also a mere abstraction? We remark, first, that in all ages, and especially in primitive philosophy, words such as being, essence, unity, good, have exerted an extraordinary influence over the minds of men. The meagreness or negativeness of their content has been in an inverse ratio to their power. They have become the forms under which all things were comprehended. There was a need or instinct in the human soul which they satisfied; they were not ideas, but gods, and to this new mythology the men of a later generation began to attach the powers and associations of the elder deities.

The idea of good is one of those sacred words or forms of thought, which were beginning to take the place of the old mythology. It meant unity, in which all time and all existence were gathered up. It was the truth of all things, and also the light in which they shone forth, and became evident to intelligences human and divine. It was the cause of all things, the power by which they were brought into being. It was the universal reason divested of a human personality. It was the life as well as the light of the world, all knowledge and all power were comprehended in it. The way to it was through the mathematical sciences, and these too were dependent on it. To ask whether God was the maker of it, or made by it, would be like asking whether God could be conceived apart from goodness, or goodness apart from God. The God of the Timaeus is not really at variance with the idea of good; they are aspects of the same, differing only as the personal from the impersonal, or the masculine from the neuter, the one being the expression or language of mythology, the other of philosophy.

This, or something like this, is the meaning of the idea of good as conceived by Plato. Ideas of number, order, harmony, development may also be said to enter into it. The paraphrase which has just been given of it goes beyond the actual words of Plato. We have perhaps arrived at the stage of philosophy which enables us to understand what he is aiming at, better than he did himself. We are beginning to realize what he saw darkly and at a distance. But if he could have been told that this, or some conception of the same kind, but higher than this, was the truth at which he was aiming, and the need which he sought to supply, he would gladly have recognized that more was contained in his own thoughts than he himself knew. As his words are few and his manner reticent and tentative, so must the style of his interpreter be. We should not approach his meaning more nearly by attempting to define it further. In translating him into the language of modern thought, we might insensibly lose the spirit of ancient philosophy. It is remarkable that although Plato speaks of the idea of good as the first principle of truth and being, it is nowhere mentioned in his writings except in this passage. Nor did it retain any hold upon the minds of his disciples in a later generation; it was probably unintelligible to them. Nor does the mention of it in Aristotle appear to have any reference to this or any other passage in his extant writings.

BOOK VII. And now I will describe in a figure the enlightenment or unenlightenment of our nature:—Imagine human beings living in an underground den which is open towards the light; they have been there from childhood, having their necks and legs chained, and can only see into the den. At a distance there is a fire, and between the fire and the prisoners a raised way, and a low wall is built along the way, like the screen over which marionette players show their puppets. Behind the wall appear moving figures, who hold in their hands various works of art, and among them images of men and animals, wood and stone, and some of the passers-by are talking and others silent. 'A strange parable,' he said, 'and strange captives.' They are ourselves, I replied; and they see only the shadows of the images which the fire throws on the wall of the den; to these they give names, and if we add an echo which returns from the wall, the voices of the passengers will seem to proceed from the shadows. Suppose now that you suddenly turn them round and make them look with pain and grief to themselves at the real images; will they believe them to be real? Will not their eyes be dazzled, and will they not try to get away from the light to something which they are able to behold without blinking? And suppose further, that they are dragged up a steep and rugged ascent into the presence of the sun himself, will not their sight be darkened with the excess of light? Some time will pass before they get the habit of perceiving at all; and at first they will be able to perceive only shadows and reflections in the water; then they will recognize the moon and the stars, and will at length behold the sun in his own proper place as he is. Last of all they will conclude:—This is he who gives us the year and the seasons, and is the author of all that we see. How will they rejoice in passing from darkness to light! How worthless to them will seem the honours and glories of the den! But now imagine further, that they descend into their old habitations;—in that underground dwelling they will not see as well as their fellows, and will not be able to compete with them in the measurement of the shadows on the wall; there will be many jokes about the man who went on a visit to the sun and lost his eyes, and if they find anybody trying to set free and enlighten one of their number, they will put him to death, if they can catch him. Now the cave or den is the world of sight, the fire is the sun, the way upwards is the way to knowledge, and in the world of knowledge the idea of good is last seen and with difficulty, but when seen is inferred to be the author of good and right—parent of the lord of light in this world, and of truth and understanding in the other. He who attains to the beatific vision is always going upwards; he is unwilling to descend into political assemblies and courts of law; for his eyes are apt to blink at the images or shadows of images which they behold in them—he cannot enter into the ideas of those who have never in their lives understood the relation of the shadow to the substance. But blindness is of two kinds, and may be caused either by passing out of darkness into light or out of light into darkness, and a man of sense will distinguish between them, and will not laugh equally at both of them, but the blindness which arises from fulness of light he will deem blessed, and pity the other; or if he laugh at the puzzled soul looking at the sun, he will have more reason to laugh than the inhabitants of the den at those who descend from above. There is a further lesson taught by this parable of ours. Some persons fancy that instruction is like giving eyes to the blind, but we say that the faculty of sight was always there, and that the soul only requires to be turned round towards the light. And this is conversion; other virtues are almost like bodily habits, and may be acquired in the same manner, but intelligence has a diviner life, and is indestructible, turning either to good or evil according to the direction given. Did you never observe how the mind of a clever rogue peers out of his eyes, and the more clearly he sees, the more evil he does? Now if you take such an one, and cut away from him those leaden weights of pleasure and desire which bind his soul to earth, his intelligence will be turned round, and he will behold the truth as clearly as he now discerns his meaner ends. And have we not decided that our rulers must neither be so uneducated as to have no fixed rule of life, nor so over-educated as to be unwilling to leave their paradise for the business of the world? We must choose out therefore the natures who are most likely to ascend to the light and knowledge of the good; but we must not allow them to remain in the region of light; they must be forced down again among the captives in the den to partake of their labours and honours. 'Will they not think this a hardship?' You should remember that our purpose in framing the State was not that our citizens should do what they like, but that they should serve the State for the common good of all. May we not fairly say to our philosopher,—Friend, we do you no wrong; for in other States philosophy grows wild, and a wild plant owes nothing to the gardener, but you have been trained by us to be the rulers and kings of our hive, and therefore we must insist on your descending into the den. You must, each of you, take your turn, and become able to use your eyes in the dark, and with a little practice you will see far better than those who quarrel about the shadows, whose knowledge is a dream only, whilst yours is a waking reality. It may be that the saint or philosopher who is best fitted, may also be the least inclined to rule, but necessity is laid upon him, and he must no longer live in the heaven of ideas. And this will be the salvation of the State. For those who rule must not be those who are desirous to rule; and, if you can offer to our citizens a better life than that of rulers generally is, there will be a chance that the rich, not only in this world's goods, but in virtue and wisdom, may bear rule. And the only life which is better than the life of political ambition is that of philosophy, which is also the best preparation for the government of a State.

Then now comes the question,—How shall we create our rulers; what way is there from darkness to light? The change is effected by philosophy; it is not the turning over of an oyster-shell, but the conversion of a soul from night to day, from becoming to being. And what training will draw the soul upwards? Our former education had two branches, gymnastic, which was occupied with the body, and music, the sister art, which infused a natural harmony into mind and literature; but neither of these sciences gave any promise of doing what we want. Nothing remains to us but that universal or primary science of which all the arts and sciences are partakers, I mean number or calculation. 'Very true.' Including the art of war? 'Yes, certainly.' Then there is something ludicrous about Palamedes in the tragedy, coming in and saying that he had invented number, and had counted the ranks and set them in order. For if Agamemnon could not count his feet (and without number how could he?) he must have been a pretty sort of general indeed. No man should be a soldier who cannot count, and indeed he is hardly to be called a man. But I am not speaking of these practical applications of arithmetic, for number, in my view, is rather to be regarded as a conductor to thought and being. I will explain what I mean by the last expression:—Things sensible are of two kinds; the one class invite or stimulate the mind, while in the other the mind acquiesces. Now the stimulating class are the things which suggest contrast and relation. For example, suppose that I hold up to the eyes three fingers—a fore finger, a middle finger, a little finger—the sight equally recognizes all three fingers, but without number cannot further distinguish them. Or again, suppose two objects to be relatively great and small, these ideas of greatness and smallness are supplied not by the sense, but by the mind. And the perception of their contrast or relation quickens and sets in motion the mind, which is puzzled by the confused intimations of sense, and has recourse to number in order to find out whether the things indicated are one or more than one. Number replies that they are two and not one, and are to be distinguished from one another. Again, the sight beholds great and small, but only in a confused chaos, and not until they are distinguished does the question arise of their respective natures; we are thus led on to the distinction between the visible and intelligible. That was what I meant when I spoke of stimulants to the intellect; I was thinking of the contradictions which arise in perception. The idea of unity, for example, like that of a finger, does not arouse thought unless involving some conception of plurality; but when the one is also the opposite of one, the contradiction gives rise to reflection; an example of this is afforded by any object of sight. All number has also an elevating effect; it raises the mind out of the foam and flux of generation to the contemplation of being, having lesser military and retail uses also. The retail use is not required by us; but as our guardian is to be a soldier as well as a philosopher, the military one may be retained. And to our higher purpose no science can be better adapted; but it must be pursued in the spirit of a philosopher, not of a shopkeeper. It is concerned, not with visible objects, but with abstract truth; for numbers are pure abstractions—the true arithmetician indignantly denies that his unit is capable of division. When you divide, he insists that you are only multiplying; his 'one' is not material or resolvable into fractions, but an unvarying and absolute equality; and this proves the purely intellectual character of his study. Note also the great power which arithmetic has of sharpening the wits; no other discipline is equally severe, or an equal test of general ability, or equally improving to a stupid person.

Let our second branch of education be geometry. 'I can easily see,' replied Glaucon, 'that the skill of the general will be doubled by his knowledge of geometry.' That is a small matter; the use of geometry, to which I refer, is the assistance given by it in the contemplation of the idea of good, and the compelling the mind to look at true being, and not at generation only. Yet the present mode of pursuing these studies, as any one who is the least of a mathematician is aware, is mean and ridiculous; they are made to look downwards to the arts, and not upwards to eternal existence. The geometer is always talking of squaring, subtending, apposing, as if he had in view action; whereas knowledge is the real object of the study. It should elevate the soul, and create the mind of philosophy; it should raise up what has fallen down, not to speak of lesser uses in war and military tactics, and in the improvement of the faculties.

Shall we propose, as a third branch of our education, astronomy? 'Very good,' replied Glaucon; 'the knowledge of the heavens is necessary at once for husbandry, navigation, military tactics.' I like your way of giving useful reasons for everything in order to make friends of the world. And there is a difficulty in proving to mankind that education is not only useful information but a purification of the eye of the soul, which is better than the bodily eye, for by this alone is truth seen. Now, will you appeal to mankind in general or to the philosopher? or would you prefer to look to yourself only? 'Every man is his own best friend.' Then take a step backward, for we are out of order, and insert the third dimension which is of solids, after the second which is of planes, and then you may proceed to solids in motion. But solid geometry is not popular and has not the patronage of the State, nor is the use of it fully recognized; the difficulty is great, and the votaries of the study are conceited and impatient. Still the charm of the pursuit wins upon men, and, if government would lend a little assistance, there might be great progress made. 'Very true,' replied Glaucon; 'but do I understand you now to begin with plane geometry, and to place next geometry of solids, and thirdly, astronomy, or the motion of solids?' Yes, I said; my hastiness has only hindered us.

'Very good, and now let us proceed to astronomy, about which I am willing to speak in your lofty strain. No one can fail to see that the contemplation of the heavens draws the soul upwards.' I am an exception, then; astronomy as studied at present appears to me to draw the soul not upwards, but downwards. Star-gazing is just looking up at the ceiling—no better; a man may lie on his back on land or on water—he may look up or look down, but there is no science in that. The vision of knowledge of which I speak is seen not with the eyes, but with the mind. All the magnificence of the heavens is but the embroidery of a copy which falls far short of the divine Original, and teaches nothing about the absolute harmonies or motions of things. Their beauty is like the beauty of figures drawn by the hand of Daedalus or any other great artist, which may be used for illustration, but no mathematician would seek to obtain from them true conceptions of equality or numerical relations. How ridiculous then to look for these in the map of the heavens, in which the imperfection of matter comes in everywhere as a disturbing element, marring the symmetry of day and night, of months and years, of the sun and stars in their courses. Only by problems can we place astronomy on a truly scientific basis. Let the heavens alone, and exert the intellect.

Still, mathematics admit of other applications, as the Pythagoreans say, and we agree. There is a sister science of harmonical motion, adapted to the ear as astronomy is to the eye, and there may be other applications also. Let us inquire of the Pythagoreans about them, not forgetting that we have an aim higher than theirs, which is the relation of these sciences to the idea of good. The error which pervades astronomy also pervades harmonics. The musicians put their ears in the place of their minds. 'Yes,' replied Glaucon, 'I like to see them laying their ears alongside of their neighbours' faces—some saying, &quot;That's a new note,&quot; others declaring that the two notes are the same.' Yes, I said; but you mean the empirics who are always twisting and torturing the strings of the lyre, and quarrelling about the tempers of the strings; I am referring rather to the Pythagorean harmonists, who are almost equally in error. For they investigate only the numbers of the consonances which are heard, and ascend no higher,—of the true numerical harmony which is unheard, and is only to be found in problems, they have not even a conception. 'That last,' he said, 'must be a marvellous thing.' A thing, I replied, which is only useful if pursued with a view to the good.

All these sciences are the prelude of the strain, and are profitable if they are regarded in their natural relations to one another. 'I dare say, Socrates,' said Glaucon; 'but such a study will be an endless business.' What study do you mean—of the prelude, or what? For all these things are only the prelude, and you surely do not suppose that a mere mathematician is also a dialectician? 'Certainly not. I have hardly ever known a mathematician who could reason.' And yet, Glaucon, is not true reasoning that hymn of dialectic which is the music of the intellectual world, and which was by us compared to the effort of sight, when from beholding the shadows on the wall we arrived at last at the images which gave the shadows? Even so the dialectical faculty withdrawing from sense arrives by the pure intellect at the contemplation of the idea of good, and never rests but at the very end of the intellectual world. And the royal road out of the cave into the light, and the blinking of the eyes at the sun and turning to contemplate the shadows of reality, not the shadows of an image only—this progress and gradual acquisition of a new faculty of sight by the help of the mathematical sciences, is the elevation of the soul to the contemplation of the highest ideal of being.

'So far, I agree with you. But now, leaving the prelude, let us proceed to the hymn. What, then, is the nature of dialectic, and what are the paths which lead thither?' Dear Glaucon, you cannot follow me here. There can be no revelation of the absolute truth to one who has not been disciplined in the previous sciences. But that there is a science of absolute truth, which is attained in some way very different from those now practised, I am confident. For all other arts or sciences are relative to human needs and opinions; and the mathematical sciences are but a dream or hypothesis of true being, and never analyse their own principles. Dialectic alone rises to the principle which is above hypotheses, converting and gently leading the eye of the soul out of the barbarous slough of ignorance into the light of the upper world, with the help of the sciences which we have been describing—sciences, as they are often termed, although they require some other name, implying greater clearness than opinion and less clearness than science, and this in our previous sketch was understanding. And so we get four names—two for intellect, and two for opinion,—reason or mind, understanding, faith, perception of shadows—which make a proportion— being:becoming::intellect:opinion—and science:belief::understanding: perception of shadows. Dialectic may be further described as that science which defines and explains the essence or being of each nature, which distinguishes and abstracts the good, and is ready to do battle against all opponents in the cause of good. To him who is not a dialectician life is but a sleepy dream; and many a man is in his grave before his is well waked up. And would you have the future rulers of your ideal State intelligent beings, or stupid as posts? 'Certainly not the latter.' Then you must train them in dialectic, which will teach them to ask and answer questions, and is the coping-stone of the sciences.

I dare say that you have not forgotten how our rulers were chosen; and the process of selection may be carried a step further:—As before, they must be constant and valiant, good-looking, and of noble manners, but now they must also have natural ability which education will improve; that is to say, they must be quick at learning, capable of mental toil, retentive, solid, diligent natures, who combine intellectual with moral virtues; not lame and one-sided, diligent in bodily exercise and indolent in mind, or conversely; not a maimed soul, which hates falsehood and yet unintentionally is always wallowing in the mire of ignorance; not a bastard or feeble person, but sound in wind and limb, and in perfect condition for the great gymnastic trial of the mind. Justice herself can find no fault with natures such as these; and they will be the saviours of our State; disciples of another sort would only make philosophy more ridiculous than she is at present. Forgive my enthusiasm; I am becoming excited; but when I see her trampled underfoot, I am angry at the authors of her disgrace. 'I did not notice that you were more excited than you ought to have been.' But I felt that I was. Now do not let us forget another point in the selection of our disciples—that they must be young and not old. For Solon is mistaken in saying that an old man can be always learning; youth is the time of study, and here we must remember that the mind is free and dainty, and, unlike the body, must not be made to work against the grain. Learning should be at first a sort of play, in which the natural bent is detected. As in training them for war, the young dogs should at first only taste blood; but when the necessary gymnastics are over which during two or three years divide life between sleep and bodily exercise, then the education of the soul will become a more serious matter. At twenty years of age, a selection must be made of the more promising disciples, with whom a new epoch of education will begin. The sciences which they have hitherto learned in fragments will now be brought into relation with each other and with true being; for the power of combining them is the test of speculative and dialectical ability. And afterwards at thirty a further selection shall be made of those who are able to withdraw from the world of sense into the abstraction of ideas. But at this point, judging from present experience, there is a danger that dialectic may be the source of many evils. The danger may be illustrated by a parallel case:—Imagine a person who has been brought up in wealth and luxury amid a crowd of flatterers, and who is suddenly informed that he is a supposititious son. He has hitherto honoured his reputed parents and disregarded the flatterers, and now he does the reverse. This is just what happens with a man's principles. There are certain doctrines which he learnt at home and which exercised a parental authority over him. Presently he finds that imputations are cast upon them; a troublesome querist comes and asks, 'What is the just and good?' or proves that virtue is vice and vice virtue, and his mind becomes unsettled, and he ceases to love, honour, and obey them as he has hitherto done. He is seduced into the life of pleasure, and becomes a lawless person and a rogue. The case of such speculators is very pitiable, and, in order that our thirty years' old pupils may not require this pity, let us take every possible care that young persons do not study philosophy too early. For a young man is a sort of puppy who only plays with an argument; and is reasoned into and out of his opinions every day; he soon begins to believe nothing, and brings himself and philosophy into discredit. A man of thirty does not run on in this way; he will argue and not merely contradict, and adds new honour to philosophy by the sobriety of his conduct. What time shall we allow for this second gymnastic training of the soul?—say, twice the time required for the gymnastics of the body; six, or perhaps five years, to commence at thirty, and then for fifteen years let the student go down into the den, and command armies, and gain experience of life. At fifty let him return to the end of all things, and have his eyes uplifted to the idea of good, and order his life after that pattern; if necessary, taking his turn at the helm of State, and training up others to be his successors. When his time comes he shall depart in peace to the islands of the blest. He shall be honoured with sacrifices, and receive such worship as the Pythian oracle approves.

'You are a statuary, Socrates, and have made a perfect image of our governors.' Yes, and of our governesses, for the women will share in all things with the men. And you will admit that our State is not a mere aspiration, but may really come into being when there shall arise philosopher-kings, one or more, who will despise earthly vanities, and will be the servants of justice only. 'And how will they begin their work?' Their first act will be to send away into the country all those who are more than ten years of age, and to proceed with those who are left...

At the commencement of the sixth book, Plato anticipated his explanation of the relation of the philosopher to the world in an allegory, in this, as in other passages, following the order which he prescribes in education, and proceeding from the concrete to the abstract. At the commencement of Book VII, under the figure of a cave having an opening towards a fire and a way upwards to the true light, he returns to view the divisions of knowledge, exhibiting familiarly, as in a picture, the result which had been hardly won by a great effort of thought in the previous discussion; at the same time casting a glance onward at the dialectical process, which is represented by the way leading from darkness to light. The shadows, the images, the reflection of the sun and stars in the water, the stars and sun themselves, severally correspond,—the first, to the realm of fancy and poetry,—the second, to the world of sense,—the third, to the abstractions or universals of sense, of which the mathematical sciences furnish the type,—the fourth and last to the same abstractions, when seen in the unity of the idea, from which they derive a new meaning and power. The true dialectical process begins with the contemplation of the real stars, and not mere reflections of them, and ends with the recognition of the sun, or idea of good, as the parent not only of light but of warmth and growth. To the divisions of knowledge the stages of education partly answer:—first, there is the early education of childhood and youth in the fancies of the poets, and in the laws and customs of the State;—then there is the training of the body to be a warrior athlete, and a good servant of the mind;—and thirdly, after an interval follows the education of later life, which begins with mathematics and proceeds to philosophy in general.

There seem to be two great aims in the philosophy of Plato,—first, to realize abstractions; secondly, to connect them. According to him, the true education is that which draws men from becoming to being, and to a comprehensive survey of all being. He desires to develop in the human mind the faculty of seeing the universal in all things; until at last the particulars of sense drop away and the universal alone remains. He then seeks to combine the universals which he has disengaged from sense, not perceiving that the correlation of them has no other basis but the common use of language. He never understands that abstractions, as Hegel says, are 'mere abstractions'—of use when employed in the arrangement of facts, but adding nothing to the sum of knowledge when pursued apart from them, or with reference to an imaginary idea of good. Still the exercise of the faculty of abstraction apart from facts has enlarged the mind, and played a great part in the education of the human race. Plato appreciated the value of this faculty, and saw that it might be quickened by the study of number and relation. All things in which there is opposition or proportion are suggestive of reflection. The mere impression of sense evokes no power of thought or of mind, but when sensible objects ask to be compared and distinguished, then philosophy begins. The science of arithmetic first suggests such distinctions. The follow in order the other sciences of plain and solid geometry, and of solids in motion, one branch of which is astronomy or the harmony of the spheres,—to this is appended the sister science of the harmony of sounds. Plato seems also to hint at the possibility of other applications of arithmetical or mathematical proportions, such as we employ in chemistry and natural philosophy, such as the Pythagoreans and even Aristotle make use of in Ethics and Politics, e.g. his distinction between arithmetical and geometrical proportion in the Ethics (Book V), or between numerical and proportional equality in the Politics.

The modern mathematician will readily sympathise with Plato's delight in the properties of pure mathematics. He will not be disinclined to say with him:—Let alone the heavens, and study the beauties of number and figure in themselves. He too will be apt to depreciate their application to the arts. He will observe that Plato has a conception of geometry, in which figures are to be dispensed with; thus in a distant and shadowy way seeming to anticipate the possibility of working geometrical problems by a more general mode of analysis. He will remark with interest on the backward state of solid geometry, which, alas! was not encouraged by the aid of the State in the age of Plato; and he will recognize the grasp of Plato's mind in his ability to conceive of one science of solids in motion including the earth as well as the heavens,—not forgetting to notice the intimation to which allusion has been already made, that besides astronomy and harmonics the science of solids in motion may have other applications. Still more will he be struck with the comprehensiveness of view which led Plato, at a time when these sciences hardly existed, to say that they must be studied in relation to one another, and to the idea of good, or common principle of truth and being. But he will also see (and perhaps without surprise) that in that stage of physical and mathematical knowledge, Plato has fallen into the error of supposing that he can construct the heavens a priori by mathematical problems, and determine the principles of harmony irrespective of the adaptation of sounds to the human ear. The illusion was a natural one in that age and country. The simplicity and certainty of astronomy and harmonics seemed to contrast with the variation and complexity of the world of sense; hence the circumstance that there was some elementary basis of fact, some measurement of distance or time or vibrations on which they must ultimately rest, was overlooked by him. The modern predecessors of Newton fell into errors equally great; and Plato can hardly be said to have been very far wrong, or may even claim a sort of prophetic insight into the subject, when we consider that the greater part of astronomy at the present day consists of abstract dynamics, by the help of which most astronomical discoveries have been made.

The metaphysical philosopher from his point of view recognizes mathematics as an instrument of education,—which strengthens the power of attention, developes the sense of order and the faculty of construction, and enables the mind to grasp under simple formulae the quantitative differences of physical phenomena. But while acknowledging their value in education, he sees also that they have no connexion with our higher moral and intellectual ideas. In the attempt which Plato makes to connect them, we easily trace the influences of ancient Pythagorean notions. There is no reason to suppose that he is speaking of the ideal numbers; but he is describing numbers which are pure abstractions, to which he assigns a real and separate existence, which, as 'the teachers of the art' (meaning probably the Pythagoreans) would have affirmed, repel all attempts at subdivision, and in which unity and every other number are conceived of as absolute. The truth and certainty of numbers, when thus disengaged from phenomena, gave them a kind of sacredness in the eyes of an ancient philosopher. Nor is it easy to say how far ideas of order and fixedness may have had a moral and elevating influence on the minds of men, 'who,' in the words of the Timaeus, 'might learn to regulate their erring lives according to them.' It is worthy of remark that the old Pythagorean ethical symbols still exist as figures of speech among ourselves. And those who in modern times see the world pervaded by universal law, may also see an anticipation of this last word of modern philosophy in the Platonic idea of good, which is the source and measure of all things, and yet only an abstraction (Philebus).

Two passages seem to require more particular explanations. First, that which relates to the analysis of vision. The difficulty in this passage may be explained, like many others, from differences in the modes of conception prevailing among ancient and modern thinkers. To us, the perceptions of sense are inseparable from the act of the mind which accompanies them. The consciousness of form, colour, distance, is indistinguishable from the simple sensation, which is the medium of them. Whereas to Plato sense is the Heraclitean flux of sense, not the vision of objects in the order in which they actually present themselves to the experienced sight, but as they may be imagined to appear confused and blurred to the half-awakened eye of the infant. The first action of the mind is aroused by the attempt to set in order this chaos, and the reason is required to frame distinct conceptions under which the confused impressions of sense may be arranged. Hence arises the question, 'What is great, what is small?' and thus begins the distinction of the visible and the intelligible.

The second difficulty relates to Plato's conception of harmonics. Three classes of harmonists are distinguished by him:—first, the Pythagoreans, whom he proposes to consult as in the previous discussion on music he was to consult Damon—they are acknowledged to be masters in the art, but are altogether deficient in the knowledge of its higher import and relation to the good; secondly, the mere empirics, whom Glaucon appears to confuse with them, and whom both he and Socrates ludicrously describe as experimenting by mere auscultation on the intervals of sounds. Both of these fall short in different degrees of the Platonic idea of harmony, which must be studied in a purely abstract way, first by the method of problems, and secondly as a part of universal knowledge in relation to the idea of good.

The allegory has a political as well as a philosophical meaning. The den or cave represents the narrow sphere of politics or law (compare the description of the philosopher and lawyer in the Theaetetus), and the light of the eternal ideas is supposed to exercise a disturbing influence on the minds of those who return to this lower world. In other words, their principles are too wide for practical application; they are looking far away into the past and future, when their business is with the present. The ideal is not easily reduced to the conditions of actual life, and may often be at variance with them. And at first, those who return are unable to compete with the inhabitants of the den in the measurement of the shadows, and are derided and persecuted by them; but after a while they see the things below in far truer proportions than those who have never ascended into the upper world. The difference between the politician turned into a philosopher and the philosopher turned into a politician, is symbolized by the two kinds of disordered eyesight, the one which is experienced by the captive who is transferred from darkness to day, the other, of the heavenly messenger who voluntarily for the good of his fellow-men descends into the den. In what way the brighter light is to dawn on the inhabitants of the lower world, or how the idea of good is to become the guiding principle of politics, is left unexplained by Plato. Like the nature and divisions of dialectic, of which Glaucon impatiently demands to be informed, perhaps he would have said that the explanation could not be given except to a disciple of the previous sciences. (Symposium.)

Many illustrations of this part of the Republic may be found in modern Politics and in daily life. For among ourselves, too, there have been two sorts of Politicians or Statesmen, whose eyesight has become disordered in two different ways. First, there have been great men who, in the language of Burke, 'have been too much given to general maxims,' who, like J.S. Mill or Burke himself, have been theorists or philosophers before they were politicians, or who, having been students of history, have allowed some great historical parallel, such as the English Revolution of 1688, or possibly Athenian democracy or Roman Imperialism, to be the medium through which they viewed contemporary events. Or perhaps the long projecting shadow of some existing institution may have darkened their vision. The Church of the future, the Commonwealth of the future, the Society of the future, have so absorbed their minds, that they are unable to see in their true proportions the Politics of to-day. They have been intoxicated with great ideas, such as liberty, or equality, or the greatest happiness of the greatest number, or the brotherhood of humanity, and they no longer care to consider how these ideas must be limited in practice or harmonized with the conditions of human life. They are full of light, but the light to them has become only a sort of luminous mist or blindness. Almost every one has known some enthusiastic half-educated person, who sees everything at false distances, and in erroneous proportions.

With this disorder of eyesight may be contrasted another—of those who see not far into the distance, but what is near only; who have been engaged all their lives in a trade or a profession; who are limited to a set or sect of their own. Men of this kind have no universal except their own interests or the interests of their class, no principle but the opinion of persons like themselves, no knowledge of affairs beyond what they pick up in the streets or at their club. Suppose them to be sent into a larger world, to undertake some higher calling, from being tradesmen to turn generals or politicians, from being schoolmasters to become philosophers:—or imagine them on a sudden to receive an inward light which reveals to them for the first time in their lives a higher idea of God and the existence of a spiritual world, by this sudden conversion or change is not their daily life likely to be upset; and on the other hand will not many of their old prejudices and narrownesses still adhere to them long after they have begun to take a more comprehensive view of human things? From familiar examples like these we may learn what Plato meant by the eyesight which is liable to two kinds of disorders.

Nor have we any difficulty in drawing a parallel between the young Athenian in the fifth century before Christ who became unsettled by new ideas, and the student of a modern University who has been the subject of a similar 'aufklarung.' We too observe that when young men begin to criticise customary beliefs, or to analyse the constitution of human nature, they are apt to lose hold of solid principle (Greek). They are like trees which have been frequently transplanted. The earth about them is loose, and they have no roots reaching far into the soil. They 'light upon every flower,' following their own wayward wills, or because the wind blows them. They catch opinions, as diseases are caught—when they are in the air. Borne hither and thither, 'they speedily fall into beliefs' the opposite of those in which they were brought up. They hardly retain the distinction of right and wrong; they seem to think one thing as good as another. They suppose themselves to be searching after truth when they are playing the game of 'follow my leader.' They fall in love 'at first sight' with paradoxes respecting morality, some fancy about art, some novelty or eccentricity in religion, and like lovers they are so absorbed for a time in their new notion that they can think of nothing else. The resolution of some philosophical or theological question seems to them more interesting and important than any substantial knowledge of literature or science or even than a good life. Like the youth in the Philebus, they are ready to discourse to any one about a new philosophy. They are generally the disciples of some eminent professor or sophist, whom they rather imitate than understand. They may be counted happy if in later years they retain some of the simple truths which they acquired in early education, and which they may, perhaps, find to be worth all the rest. Such is the picture which Plato draws and which we only reproduce, partly in his own words, of the dangers which beset youth in times of transition, when old opinions are fading away and the new are not yet firmly established. Their condition is ingeniously compared by him to that of a supposititious son, who has made the discovery that his reputed parents are not his real ones, and, in consequence, they have lost their authority over him.

The distinction between the mathematician and the dialectician is also noticeable. Plato is very well aware that the faculty of the mathematician is quite distinct from the higher philosophical sense which recognizes and combines first principles. The contempt which he expresses for distinctions of words, the danger of involuntary falsehood, the apology which Socrates makes for his earnestness of speech, are highly characteristic of the Platonic style and mode of thought. The quaint notion that if Palamedes was the inventor of number Agamemnon could not have counted his feet; the art by which we are made to believe that this State of ours is not a dream only; the gravity with which the first step is taken in the actual creation of the State, namely, the sending out of the city all who had arrived at ten years of age, in order to expedite the business of education by a generation, are also truly Platonic. (For the last, compare the passage at the end of the third book, in which he expects the lie about the earthborn men to be believed in the second generation.)

BOOK VIII. And so we have arrived at the conclusion, that in the perfect State wives and children are to be in common; and the education and pursuits of men and women, both in war and peace, are to be common, and kings are to be philosophers and warriors, and the soldiers of the State are to live together, having all things in common; and they are to be warrior athletes, receiving no pay but only their food, from the other citizens. Now let us return to the point at which we digressed. 'That is easily done,' he replied: 'You were speaking of the State which you had constructed, and of the individual who answered to this, both of whom you affirmed to be good; and you said that of inferior States there were four forms and four individuals corresponding to them, which although deficient in various degrees, were all of them worth inspecting with a view to determining the relative happiness or misery of the best or worst man. Then Polemarchus and Adeimantus interrupted you, and this led to another argument,—and so here we are.' Suppose that we put ourselves again in the same position, and do you repeat your question. 'I should like to know of what constitutions you were speaking?' Besides the perfect State there are only four of any note in Hellas:—first, the famous Lacedaemonian or Cretan commonwealth; secondly, oligarchy, a State full of evils; thirdly, democracy, which follows next in order; fourthly, tyranny, which is the disease or death of all government. Now, States are not made of 'oak and rock,' but of flesh and blood; and therefore as there are five States there must be five human natures in individuals, which correspond to them. And first, there is the ambitious nature, which answers to the Lacedaemonian State; secondly, the oligarchical nature; thirdly, the democratical; and fourthly, the tyrannical. This last will have to be compared with the perfectly just, which is the fifth, that we may know which is the happier, and then we shall be able to determine whether the argument of Thrasymachus or our own is the more convincing. And as before we began with the State and went on to the individual, so now, beginning with timocracy, let us go on to the timocratical man, and then proceed to the other forms of government, and the individuals who answer to them.

But how did timocracy arise out of the perfect State? Plainly, like all changes of government, from division in the rulers. But whence came division? 'Sing, heavenly Muses,' as Homer says;—let them condescend to answer us, as if we were children, to whom they put on a solemn face in jest. 'And what will they say?' They will say that human things are fated to decay, and even the perfect State will not escape from this law of destiny, when 'the wheel comes full circle' in a period short or long. Plants or animals have times of fertility and sterility, which the intelligence of rulers because alloyed by sense will not enable them to ascertain, and children will be born out of season. For whereas divine creations are in a perfect cycle or number, the human creation is in a number which declines from perfection, and has four terms and three intervals of numbers, increasing, waning, assimilating, dissimilating, and yet perfectly commensurate with each other. The base of the number with a fourth added (or which is 3:4), multiplied by five and cubed, gives two harmonies:—the first a square number, which is a hundred times the base (or a hundred times a hundred); the second, an oblong, being a hundred squares of the rational diameter of a figure the side of which is five, subtracting one from each square or two perfect squares from all, and adding a hundred cubes of three. This entire number is geometrical and contains the rule or law of generation. When this law is neglected marriages will be unpropitious; the inferior offspring who are then born will in time become the rulers; the State will decline, and education fall into decay; gymnastic will be preferred to music, and the gold and silver and brass and iron will form a chaotic mass—thus division will arise. Such is the Muses' answer to our question. 'And a true answer, of course:—but what more have they to say?' They say that the two races, the iron and brass, and the silver and gold, will draw the State different ways;—the one will take to trade and moneymaking, and the others, having the true riches and not caring for money, will resist them: the contest will end in a compromise; they will agree to have private property, and will enslave their fellow-citizens who were once their friends and nurturers. But they will retain their warlike character, and will be chiefly occupied in fighting and exercising rule. Thus arises timocracy, which is intermediate between aristocracy and oligarchy.

The new form of government resembles the ideal in obedience to rulers and contempt for trade, and having common meals, and in devotion to warlike and gymnastic exercises. But corruption has crept into philosophy, and simplicity of character, which was once her note, is now looked for only in the military class. Arts of war begin to prevail over arts of peace; the ruler is no longer a philosopher; as in oligarchies, there springs up among them an extravagant love of gain—get another man's and save your own, is their principle; and they have dark places in which they hoard their gold and silver, for the use of their women and others; they take their pleasures by stealth, like boys who are running away from their father—the law; and their education is not inspired by the Muse, but imposed by the strong arm of power. The leading characteristic of this State is party spirit and ambition.

And what manner of man answers to such a State? 'In love of contention,' replied Adeimantus, 'he will be like our friend Glaucon.' In that respect, perhaps, but not in others. He is self-asserting and ill-educated, yet fond of literature, although not himself a speaker,—fierce with slaves, but obedient to rulers, a lover of power and honour, which he hopes to gain by deeds of arms,—fond, too, of gymnastics and of hunting. As he advances in years he grows avaricious, for he has lost philosophy, which is the only saviour and guardian of men. His origin is as follows:—His father is a good man dwelling in an ill-ordered State, who has retired from politics in order that he may lead a quiet life. His mother is angry at her loss of precedence among other women; she is disgusted at her husband's selfishness, and she expatiates to her son on the unmanliness and indolence of his father. The old family servant takes up the tale, and says to the youth:—'When you grow up you must be more of a man than your father.' All the world are agreed that he who minds his own business is an idiot, while a busybody is highly honoured and esteemed. The young man compares this spirit with his father's words and ways, and as he is naturally well disposed, although he has suffered from evil influences, he rests at a middle point and becomes ambitious and a lover of honour.

And now let us set another city over against another man. The next form of government is oligarchy, in which the rule is of the rich only; nor is it difficult to see how such a State arises. The decline begins with the possession of gold and silver; illegal modes of expenditure are invented; one draws another on, and the multitude are infected; riches outweigh virtue; lovers of money take the place of lovers of honour; misers of politicians; and, in time, political privileges are confined by law to the rich, who do not shrink from violence in order to effect their purposes.

Thus much of the origin,—let us next consider the evils of oligarchy. Would a man who wanted to be safe on a voyage take a bad pilot because he was rich, or refuse a good one because he was poor? And does not the analogy apply still more to the State? And there are yet greater evils: two nations are struggling together in one—the rich and the poor; and the rich dare not put arms into the hands of the poor, and are unwilling to pay for defenders out of their own money. And have we not already condemned that State in which the same persons are warriors as well as shopkeepers? The greatest evil of all is that a man may sell his property and have no place in the State; while there is one class which has enormous wealth, the other is entirely destitute. But observe that these destitutes had not really any more of the governing nature in them when they were rich than now that they are poor; they were miserable spendthrifts always. They are the drones of the hive; only whereas the actual drone is unprovided by nature with a sting, the two-legged things whom we call drones are some of them without stings and some of them have dreadful stings; in other words, there are paupers and there are rogues. These are never far apart; and in oligarchical cities, where nearly everybody is a pauper who is not a ruler, you will find abundance of both. And this evil state of society originates in bad education and bad government.

Like State, like man,—the change in the latter begins with the representative of timocracy; he walks at first in the ways of his father, who may have been a statesman, or general, perhaps; and presently he sees him 'fallen from his high estate,' the victim of informers, dying in prison or exile, or by the hand of the executioner. The lesson which he thus receives, makes him cautious; he leaves politics, represses his pride, and saves pence. Avarice is enthroned as his bosom's lord, and assumes the style of the Great King; the rational and spirited elements sit humbly on the ground at either side, the one immersed in calculation, the other absorbed in the admiration of wealth. The love of honour turns to love of money; the conversion is instantaneous. The man is mean, saving, toiling, the slave of one passion which is the master of the rest: Is he not the very image of the State? He has had no education, or he would never have allowed the blind god of riches to lead the dance within him. And being uneducated he will have many slavish desires, some beggarly, some knavish, breeding in his soul. If he is the trustee of an orphan, and has the power to defraud, he will soon prove that he is not without the will, and that his passions are only restrained by fear and not by reason. Hence he leads a divided existence; in which the better desires mostly prevail. But when he is contending for prizes and other distinctions, he is afraid to incur a loss which is to be repaid only by barren honour; in time of war he fights with a small part of his resources, and usually keeps his money and loses the victory.

Next comes democracy and the democratic man, out of oligarchy and the oligarchical man. Insatiable avarice is the ruling passion of an oligarchy; and they encourage expensive habits in order that they may gain by the ruin of extravagant youth. Thus men of family often lose their property or rights of citizenship; but they remain in the city, full of hatred against the new owners of their estates and ripe for revolution. The usurer with stooping walk pretends not to see them; he passes by, and leaves his sting—that is, his money—in some other victim; and many a man has to pay the parent or principal sum multiplied into a family of children, and is reduced into a state of dronage by him. The only way of diminishing the evil is either to limit a man in his use of his property, or to insist that he shall lend at his own risk. But the ruling class do not want remedies; they care only for money, and are as careless of virtue as the poorest of the citizens. Now there are occasions on which the governors and the governed meet together,—at festivals, on a journey, voyaging or fighting. The sturdy pauper finds that in the hour of danger he is not despised; he sees the rich man puffing and panting, and draws the conclusion which he privately imparts to his companions,—'that our people are not good for much;' and as a sickly frame is made ill by a mere touch from without, or sometimes without external impulse is ready to fall to pieces of itself, so from the least cause, or with none at all, the city falls ill and fights a battle for life or death. And democracy comes into power when the poor are the victors, killing some and exiling some, and giving equal shares in the government to all the rest.

The manner of life in such a State is that of democrats; there is freedom and plainness of speech, and every man does what is right in his own eyes, and has his own way of life. Hence arise the most various developments of character; the State is like a piece of embroidery of which the colours and figures are the manners of men, and there are many who, like women and children, prefer this variety to real beauty and excellence. The State is not one but many, like a bazaar at which you can buy anything. The great charm is, that you may do as you like; you may govern if you like, let it alone if you like; go to war and make peace if you feel disposed, and all quite irrespective of anybody else. When you condemn men to death they remain alive all the same; a gentleman is desired to go into exile, and he stalks about the streets like a hero; and nobody sees him or cares for him. Observe, too, how grandly Democracy sets her foot upon all our fine theories of education,—how little she cares for the training of her statesmen! The only qualification which she demands is the profession of patriotism. Such is democracy;—a pleasing, lawless, various sort of government, distributing equality to equals and unequals alike.

Let us now inspect the individual democrat; and first, as in the case of the State, we will trace his antecedents. He is the son of a miserly oligarch, and has been taught by him to restrain the love of unnecessary pleasures. Perhaps I ought to explain this latter term:—Necessary pleasures are those which are good, and which we cannot do without; unnecessary pleasures are those which do no good, and of which the desire might be eradicated by early training. For example, the pleasures of eating and drinking are necessary and healthy, up to a certain point; beyond that point they are alike hurtful to body and mind, and the excess may be avoided. When in excess, they may be rightly called expensive pleasures, in opposition to the useful ones. And the drone, as we called him, is the slave of these unnecessary pleasures and desires, whereas the miserly oligarch is subject only to the necessary.

The oligarch changes into the democrat in the following manner:—The youth who has had a miserly bringing up, gets a taste of the drone's honey; he meets with wild companions, who introduce him to every new pleasure. As in the State, so in the individual, there are allies on both sides, temptations from without and passions from within; there is reason also and external influences of parents and friends in alliance with the oligarchical principle; and the two factions are in violent conflict with one another. Sometimes the party of order prevails, but then again new desires and new disorders arise, and the whole mob of passions gets possession of the Acropolis, that is to say, the soul, which they find void and unguarded by true words and works. Falsehoods and illusions ascend to take their place; the prodigal goes back into the country of the Lotophagi or drones, and openly dwells there. And if any offer of alliance or parley of individual elders comes from home, the false spirits shut the gates of the castle and permit no one to enter,—there is a battle, and they gain the victory; and straightway making alliance with the desires, they banish modesty, which they call folly, and send temperance over the border. When the house has been swept and garnished, they dress up the exiled vices, and, crowning them with garlands, bring them back under new names. Insolence they call good breeding, anarchy freedom, waste magnificence, impudence courage. Such is the process by which the youth passes from the necessary pleasures to the unnecessary. After a while he divides his time impartially between them; and perhaps, when he gets older and the violence of passion has abated, he restores some of the exiles and lives in a sort of equilibrium, indulging first one pleasure and then another; and if reason comes and tells him that some pleasures are good and honourable, and others bad and vile, he shakes his head and says that he can make no distinction between them. Thus he lives in the fancy of the hour; sometimes he takes to drink, and then he turns abstainer; he practises in the gymnasium or he does nothing at all; then again he would be a philosopher or a politician; or again, he would be a warrior or a man of business; he is

&lt;&lt;&lt;
'Every thing by starts and nothing long.'
&lt;&lt;&lt;

There remains still the finest and fairest of all men and all States—tyranny and the tyrant. Tyranny springs from democracy much as democracy springs from oligarchy. Both arise from excess; the one from excess of wealth, the other from excess of freedom. 'The great natural good of life,' says the democrat, 'is freedom.' And this exclusive love of freedom and regardlessness of everything else, is the cause of the change from democracy to tyranny. The State demands the strong wine of freedom, and unless her rulers give her a plentiful draught, punishes and insults them; equality and fraternity of governors and governed is the approved principle. Anarchy is the law, not of the State only, but of private houses, and extends even to the animals. Father and son, citizen and foreigner, teacher and pupil, old and young, are all on a level; fathers and teachers fear their sons and pupils, and the wisdom of the young man is a match for the elder, and the old imitate the jaunty manners of the young because they are afraid of being thought morose. Slaves are on a level with their masters and mistresses, and there is no difference between men and women. Nay, the very animals in a democratic State have a freedom which is unknown in other places. The she-dogs are as good as their she-mistresses, and horses and asses march along with dignity and run their noses against anybody who comes in their way. 'That has often been my experience.' At last the citizens become so sensitive that they cannot endure the yoke of laws, written or unwritten; they would have no man call himself their master. Such is the glorious beginning of things out of which tyranny springs. 'Glorious, indeed; but what is to follow?' The ruin of oligarchy is the ruin of democracy; for there is a law of contraries; the excess of freedom passes into the excess of slavery, and the greater the freedom the greater the slavery. You will remember that in the oligarchy were found two classes—rogues and paupers, whom we compared to drones with and without stings. These two classes are to the State what phlegm and bile are to the human body; and the State-physician, or legislator, must get rid of them, just as the bee-master keeps the drones out of the hive. Now in a democracy, too, there are drones, but they are more numerous and more dangerous than in the oligarchy; there they are inert and unpractised, here they are full of life and animation; and the keener sort speak and act, while the others buzz about the bema and prevent their opponents from being heard. And there is another class in democratic States, of respectable, thriving individuals, who can be squeezed when the drones have need of their possessions; there is moreover a third class, who are the labourers and the artisans, and they make up the mass of the people. When the people meet, they are omnipotent, but they cannot be brought together unless they are attracted by a little honey; and the rich are made to supply the honey, of which the demagogues keep the greater part themselves, giving a taste only to the mob. Their victims attempt to resist; they are driven mad by the stings of the drones, and so become downright oligarchs in self-defence. Then follow informations and convictions for treason. The people have some protector whom they nurse into greatness, and from this root the tree of tyranny springs. The nature of the change is indicated in the old fable of the temple of Zeus Lycaeus, which tells how he who tastes human flesh mixed up with the flesh of other victims will turn into a wolf. Even so the protector, who tastes human blood, and slays some and exiles others with or without law, who hints at abolition of debts and division of lands, must either perish or become a wolf—that is, a tyrant. Perhaps he is driven out, but he soon comes back from exile; and then if his enemies cannot get rid of him by lawful means, they plot his assassination. Thereupon the friend of the people makes his well-known request to them for a body-guard, which they readily grant, thinking only of his danger and not of their own. Now let the rich man make to himself wings, for he will never run away again if he does not do so then. And the Great Protector, having crushed all his rivals, stands proudly erect in the chariot of State, a full-blown tyrant: Let us enquire into the nature of his happiness.

In the early days of his tyranny he smiles and beams upon everybody; he is not a 'dominus,' no, not he: he has only come to put an end to debt and the monopoly of land. Having got rid of foreign enemies, he makes himself necessary to the State by always going to war. He is thus enabled to depress the poor by heavy taxes, and so keep them at work; and he can get rid of bolder spirits by handing them over to the enemy. Then comes unpopularity; some of his old associates have the courage to oppose him. The consequence is, that he has to make a purgation of the State; but, unlike the physician who purges away the bad, he must get rid of the high-spirited, the wise and the wealthy; for he has no choice between death and a life of shame and dishonour. And the more hated he is, the more he will require trusty guards; but how will he obtain them? 'They will come flocking like birds—for pay.' Will he not rather obtain them on the spot? He will take the slaves from their owners and make them his body-guard; these are his trusted friends, who admire and look up to him. Are not the tragic poets wise who magnify and exalt the tyrant, and say that he is wise by association with the wise? And are not their praises of tyranny alone a sufficient reason why we should exclude them from our State? They may go to other cities, and gather the mob about them with fine words, and change commonwealths into tyrannies and democracies, receiving honours and rewards for their services; but the higher they and their friends ascend constitution hill, the more their honour will fail and become 'too asthmatic to mount.' To return to the tyrant—How will he support that rare army of his? First, by robbing the temples of their treasures, which will enable him to lighten the taxes; then he will take all his father's property, and spend it on his companions, male or female. Now his father is the demus, and if the demus gets angry, and says that a great hulking son ought not to be a burden on his parents, and bids him and his riotous crew begone, then will the parent know what a monster he has been nurturing, and that the son whom he would fain expel is too strong for him. 'You do not mean to say that he will beat his father?' Yes, he will, after having taken away his arms. 'Then he is a parricide and a cruel, unnatural son.' And the people have jumped from the fear of slavery into slavery, out of the smoke into the fire. Thus liberty, when out of all order and reason, passes into the worst form of servitude...

In the previous books Plato has described the ideal State; now he returns to the perverted or declining forms, on which he had lightly touched at the end of Book IV. These he describes in a succession of parallels between the individuals and the States, tracing the origin of either in the State or individual which has preceded them. He begins by asking the point at which he digressed; and is thus led shortly to recapitulate the substance of the three former books, which also contain a parallel of the philosopher and the State.

Of the first decline he gives no intelligible account; he would not have liked to admit the most probable causes of the fall of his ideal State, which to us would appear to be the impracticability of communism or the natural antagonism of the ruling and subject classes. He throws a veil of mystery over the origin of the decline, which he attributes to ignorance of the law of population. Of this law the famous geometrical figure or number is the expression. Like the ancients in general, he had no idea of the gradual perfectibility of man or of the education of the human race. His ideal was not to be attained in the course of ages, but was to spring in full armour from the head of the legislator. When good laws had been given, he thought only of the manner in which they were likely to be corrupted, or of how they might be filled up in detail or restored in accordance with their original spirit. He appears not to have reflected upon the full meaning of his own words, 'In the brief space of human life, nothing great can be accomplished'; or again, as he afterwards says in the Laws, 'Infinite time is the maker of cities.' The order of constitutions which is adopted by him represents an order of thought rather than a succession of time, and may be considered as the first attempt to frame a philosophy of history.

The first of these declining States is timocracy, or the government of soldiers and lovers of honour, which answers to the Spartan State; this is a government of force, in which education is not inspired by the Muses, but imposed by the law, and in which all the finer elements of organization have disappeared. The philosopher himself has lost the love of truth, and the soldier, who is of a simpler and honester nature, rules in his stead. The individual who answers to timocracy has some noticeable qualities. He is described as ill educated, but, like the Spartan, a lover of literature; and although he is a harsh master to his servants he has no natural superiority over them. His character is based upon a reaction against the circumstances of his father, who in a troubled city has retired from politics; and his mother, who is dissatisfied at her own position, is always urging him towards the life of political ambition. Such a character may have had this origin, and indeed Livy attributes the Licinian laws to a feminine jealousy of a similar kind. But there is obviously no connection between the manner in which the timocratic State springs out of the ideal, and the mere accident by which the timocratic man is the son of a retired statesman.

The two next stages in the decline of constitutions have even less historical foundation. For there is no trace in Greek history of a polity like the Spartan or Cretan passing into an oligarchy of wealth, or of the oligarchy of wealth passing into a democracy. The order of history appears to be different; first, in the Homeric times there is the royal or patriarchal form of government, which a century or two later was succeeded by an oligarchy of birth rather than of wealth, and in which wealth was only the accident of the hereditary possession of land and power. Sometimes this oligarchical government gave way to a government based upon a qualification of property, which, according to Aristotle's mode of using words, would have been called a timocracy; and this in some cities, as at Athens, became the conducting medium to democracy. But such was not the necessary order of succession in States; nor, indeed, can any order be discerned in the endless fluctuation of Greek history (like the tides in the Euripus), except, perhaps, in the almost uniform tendency from monarchy to aristocracy in the earliest times. At first sight there appears to be a similar inversion in the last step of the Platonic succession; for tyranny, instead of being the natural end of democracy, in early Greek history appears rather as a stage leading to democracy; the reign of Peisistratus and his sons is an episode which comes between the legislation of Solon and the constitution of Cleisthenes; and some secret cause common to them all seems to have led the greater part of Hellas at her first appearance in the dawn of history, e.g. Athens, Argos, Corinth, Sicyon, and nearly every State with the exception of Sparta, through a similar stage of tyranny which ended either in oligarchy or democracy. But then we must remember that Plato is describing rather the contemporary governments of the Sicilian States, which alternated between democracy and tyranny, than the ancient history of Athens or Corinth.

The portrait of the tyrant himself is just such as the later Greek delighted to draw of Phalaris and Dionysius, in which, as in the lives of mediaeval saints or mythic heroes, the conduct and actions of one were attributed to another in order to fill up the outline. There was no enormity which the Greek was not today to believe of them; the tyrant was the negation of government and law; his assassination was glorious; there was no crime, however unnatural, which might not with probability be attributed to him. In this, Plato was only following the common thought of his countrymen, which he embellished and exaggerated with all the power of his genius. There is no need to suppose that he drew from life; or that his knowledge of tyrants is derived from a personal acquaintance with Dionysius. The manner in which he speaks of them would rather tend to render doubtful his ever having 'consorted' with them, or entertained the schemes, which are attributed to him in the Epistles, of regenerating Sicily by their help.

Plato in a hyperbolical and serio-comic vein exaggerates the follies of democracy which he also sees reflected in social life. To him democracy is a state of individualism or dissolution; in which every one is doing what is right in his own eyes. Of a people animated by a common spirit of liberty, rising as one man to repel the Persian host, which is the leading idea of democracy in Herodotus and Thucydides, he never seems to think. But if he is not a believer in liberty, still less is he a lover of tyranny. His deeper and more serious condemnation is reserved for the tyrant, who is the ideal of wickedness and also of weakness, and who in his utter helplessness and suspiciousness is leading an almost impossible existence, without that remnant of good which, in Plato's opinion, was required to give power to evil (Book I). This ideal of wickedness living in helpless misery, is the reverse of that other portrait of perfect injustice ruling in happiness and splendour, which first of all Thrasymachus, and afterwards the sons of Ariston had drawn, and is also the reverse of the king whose rule of life is the good of his subjects.

Each of these governments and individuals has a corresponding ethical gradation: the ideal State is under the rule of reason, not extinguishing but harmonizing the passions, and training them in virtue; in the timocracy and the timocratic man the constitution, whether of the State or of the individual, is based, first, upon courage, and secondly, upon the love of honour; this latter virtue, which is hardly to be esteemed a virtue, has superseded all the rest. In the second stage of decline the virtues have altogether disappeared, and the love of gain has succeeded to them; in the third stage, or democracy, the various passions are allowed to have free play, and the virtues and vices are impartially cultivated. But this freedom, which leads to many curious extravagances of character, is in reality only a state of weakness and dissipation. At last, one monster passion takes possession of the whole nature of man—this is tyranny. In all of them excess—the excess first of wealth and then of freedom, is the element of decay.

The eighth book of the Republic abounds in pictures of life and fanciful allusions; the use of metaphorical language is carried to a greater extent than anywhere else in Plato. We may remark,

(1), the description of the two nations in one, which become more and more divided in the Greek Republics, as in feudal times, and perhaps also in our own;

(2), the notion of democracy expressed in a sort of Pythagorean formula as equality among unequals;

(3), the free and easy ways of men and animals, which are characteristic of liberty, as foreign mercenaries and universal mistrust are of the tyrant;

(4), the proposal that mere debts should not be recoverable by law is a speculation which has often been entertained by reformers of the law in modern times, and is in harmony with the tendencies of modern legislation. Debt and land were the two great difficulties of the ancient lawgiver: in modern times we may be said to have almost, if not quite, solved the first of these difficulties, but hardly the second.

Still more remarkable are the corresponding portraits of individuals: there is the family picture of the father and mother and the old servant of the timocratical man, and the outward respectability and inherent meanness of the oligarchical; the uncontrolled licence and freedom of the democrat, in which the young Alcibiades seems to be depicted, doing right or wrong as he pleases, and who at last, like the prodigal, goes into a far country (note here the play of language by which the democratic man is himself represented under the image of a State having a citadel and receiving embassies); and there is the wild-beast nature, which breaks loose in his successor. The hit about the tyrant being a parricide; the representation of the tyrant's life as an obscene dream; the rhetorical surprise of a more miserable than the most miserable of men in Book IX; the hint to the poets that if they are the friends of tyrants there is no place for them in a constitutional State, and that they are too clever not to see the propriety of their own expulsion; the continuous image of the drones who are of two kinds, swelling at last into the monster drone having wings (Book IX),—are among Plato's happiest touches.

There remains to be considered the great difficulty of this book of the Republic, the so-called number of the State. This is a puzzle almost as great as the Number of the Beast in the Book of Revelation, and though apparently known to Aristotle, is referred to by Cicero as a proverb of obscurity (Ep. ad Att.). And some have imagined that there is no answer to the puzzle, and that Plato has been practising upon his readers. But such a deception as this is inconsistent with the manner in which Aristotle speaks of the number (Pol.), and would have been ridiculous to any reader of the Republic who was acquainted with Greek mathematics. As little reason is there for supposing that Plato intentionally used obscure expressions; the obscurity arises from our want of familiarity with the subject. On the other hand, Plato himself indicates that he is not altogether serious, and in describing his number as a solemn jest of the Muses, he appears to imply some degree of satire on the symbolical use of number. (Compare Cratylus; Protag.)

Our hope of understanding the passage depends principally on an accurate study of the words themselves; on which a faint light is thrown by the parallel passage in the ninth book. Another help is the allusion in Aristotle, who makes the important remark that the latter part of the passage (Greek) describes a solid figure. (Pol.—'He only says that nothing is abiding, but that all things change in a certain cycle; and that the origin of the change is a base of numbers which are in the ratio of 4:3; and this when combined with a figure of five gives two harmonies; he means when the number of this figure becomes solid.') Some further clue may be gathered from the appearance of the Pythagorean triangle, which is denoted by the numbers 3, 4, 5, and in which, as in every right-angled triangle, the squares of the two lesser sides equal the square of the hypotenuse (9 + 16 = 25).

Plato begins by speaking of a perfect or cyclical number (Tim.), i.e. a number in which the sum of the divisors equals the whole; this is the divine or perfect number in which all lesser cycles or revolutions are complete. He also speaks of a human or imperfect number, having four terms and three intervals of numbers which are related to one another in certain proportions; these he converts into figures, and finds in them when they have been raised to the third power certain elements of number, which give two 'harmonies,' the one square, the other oblong; but he does not say that the square number answers to the divine, or the oblong number to the human cycle; nor is any intimation given that the first or divine number represents the period of the world, the second the period of the state, or of the human race as Zeller supposes; nor is the divine number afterwards mentioned (Arist.). The second is the number of generations or births, and presides over them in the same mysterious manner in which the stars preside over them, or in which, according to the Pythagoreans, opportunity, justice, marriage, are represented by some number or figure. This is probably the number 216.

The explanation given in the text supposes the two harmonies to make up the number 8000. This explanation derives a certain plausibility from the circumstance that 8000 is the ancient number of the Spartan citizens (Herod.), and would be what Plato might have called 'a number which nearly concerns the population of a city'; the mysterious disappearance of the Spartan population may possibly have suggested to him the first cause of his decline of States. The lesser or square 'harmony,' of 400, might be a symbol of the guardians,—the larger or oblong 'harmony,' of the people, and the numbers 3, 4, 5 might refer respectively to the three orders in the State or parts of the soul, the four virtues, the five forms of government. The harmony of the musical scale, which is elsewhere used as a symbol of the harmony of the state, is also indicated. For the numbers 3, 4, 5, which represent the sides of the Pythagorean triangle, also denote the intervals of the scale.

The terms used in the statement of the problem may be explained as follows. A perfect number (Greek), as already stated, is one which is equal to the sum of its divisors. Thus 6, which is the first perfect or cyclical number, = 1 + 2 + 3. The words (Greek), 'terms' or 'notes,' and (Greek), 'intervals,' are applicable to music as well as to number and figure. (Greek) is the 'base' on which the whole calculation depends, or the 'lowest term' from which it can be worked out. The words (Greek) have been variously translated—'squared and cubed' (Donaldson), 'equalling and equalled in power' (Weber), 'by involution and evolution,' i.e. by raising the power and extracting the root (as in the translation). Numbers are called 'like and unlike' (Greek) when the factors or the sides of the planes and cubes which they represent are or are not in the same ratio: e.g. 8 and 27 = 2 cubed and 3 cubed; and conversely. 'Waxing' (Greek) numbers, called also 'increasing' (Greek), are those which are exceeded by the sum of their divisors: e.g. 12 and 18 are less than 16 and 21. 'Waning' (Greek) numbers, called also 'decreasing' (Greek) are those which succeed the sum of their divisors: e.g. 8 and 27 exceed 7 and 13. The words translated 'commensurable and agreeable to one another' (Greek) seem to be different ways of describing the same relation, with more or less precision. They are equivalent to 'expressible in terms having the same relation to one another,' like the series 8, 12, 18, 27, each of which numbers is in the relation of (1 and 1/2) to the preceding. The 'base,' or 'fundamental number, which has 1/3 added to it' (1 and 1/3) = 4/3 or a musical fourth. (Greek) is a 'proportion' of numbers as of musical notes, applied either to the parts or factors of a single number or to the relation of one number to another. The first harmony is a 'square' number (Greek); the second harmony is an 'oblong' number (Greek), i.e. a number representing a figure of which the opposite sides only are equal. (Greek) = 'numbers squared from' or 'upon diameters'; (Greek) = 'rational,' i.e. omitting fractions, (Greek), 'irrational,' i.e. including fractions; e.g. 49 is a square of the rational diameter of a figure the side of which = 5: 50, of an irrational diameter of the same. For several of the explanations here given and for a good deal besides I am indebted to an excellent article on the Platonic Number by Dr. Donaldson (Proc. of the Philol. Society).

The conclusions which he draws from these data are summed up by him as follows. Having assumed that the number of the perfect or divine cycle is the number of the world, and the number of the imperfect cycle the number of the state, he proceeds: 'The period of the world is defined by the perfect number 6, that of the state by the cube of that number or 216, which is the product of the last pair of terms in the Platonic Tetractys (a series of seven terms, 1, 2, 3, 4, 9, 8, 27); and if we take this as the basis of our computation, we shall have two cube numbers (Greek), viz. 8 and 27; and the mean proportionals between these, viz. 12 and 18, will furnish three intervals and four terms, and these terms and intervals stand related to one another in the sesqui-altera ratio, i.e. each term is to the preceding as 3/2. Now if we remember that the number 216 = 8 x 27 = 3 cubed + 4 cubed + 5 cubed, and 3 squared + 4 squared = 5 squared, we must admit that this number implies the numbers 3, 4, 5, to which musicians attach so much importance. And if we combine the ratio 4/3 with the number 5, or multiply the ratios of the sides by the hypotenuse, we shall by first squaring and then cubing obtain two expressions, which denote the ratio of the two last pairs of terms in the Platonic Tetractys, the former multiplied by the square, the latter by the cube of the number 10, the sum of the first four digits which constitute the Platonic Tetractys.' The two (Greek) he elsewhere explains as follows: 'The first (Greek) is (Greek), in other words (4/3 x 5) all squared = 100 x 2 squared over 3 squared. The second (Greek), a cube of the same root, is described as 100 multiplied (alpha) by the rational diameter of 5 diminished by unity, i.e., as shown above, 48: (beta) by two incommensurable diameters, i.e. the two first irrationals, or 2 and 3: and (gamma) by the cube of 3, or 27. Thus we have (48 + 5 + 27) 100 = 1000 x 2 cubed. This second harmony is to be the cube of the number of which the former harmony is the square, and therefore must be divided by the cube of 3. In other words, the whole expression will be: (1), for the first harmony, 400/9: (2), for the second harmony, 8000/27.'

The reasons which have inclined me to agree with Dr. Donaldson and also with Schleiermacher in supposing that 216 is the Platonic number of births are: (1) that it coincides with the description of the number given in the first part of the passage (Greek...): (2) that the number 216 with its permutations would have been familiar to a Greek mathematician, though unfamiliar to us: (3) that 216 is the cube of 6, and also the sum of 3 cubed, 4 cubed, 5 cubed, the numbers 3, 4, 5 representing the Pythagorean triangle, of which the sides when squared equal the square of the hypotenuse (9 + 16 = 25): (4) that it is also the period of the Pythagorean Metempsychosis: (5) the three ultimate terms or bases (3, 4, 5) of which 216 is composed answer to the third, fourth, fifth in the musical scale: (6) that the number 216 is the product of the cubes of 2 and 3, which are the two last terms in the Platonic Tetractys: (7) that the Pythagorean triangle is said by Plutarch (de Is. et Osir.), Proclus (super prima Eucl.), and Quintilian (de Musica) to be contained in this passage, so that the tradition of the school seems to point in the same direction: (8) that the Pythagorean triangle is called also the figure of marriage (Greek).

But though agreeing with Dr. Donaldson thus far, I see no reason for supposing, as he does, that the first or perfect number is the world, the human or imperfect number the state; nor has he given any proof that the second harmony is a cube. Nor do I think that (Greek) can mean 'two incommensurables,' which he arbitrarily assumes to be 2 and 3, but rather, as the preceding clause implies, (Greek), i.e. two square numbers based upon irrational diameters of a figure the side of which is 5 = 50 x 2.

The greatest objection to the translation is the sense given to the words (Greek), 'a base of three with a third added to it, multiplied by 5.' In this somewhat forced manner Plato introduces once more the numbers of the Pythagorean triangle. But the coincidences in the numbers which follow are in favour of the explanation. The first harmony of 400, as has been already remarked, probably represents the rulers; the second and oblong harmony of 7600, the people.

And here we take leave of the difficulty. The discovery of the riddle would be useless, and would throw no light on ancient mathematics. The point of interest is that Plato should have used such a symbol, and that so much of the Pythagorean spirit should have prevailed in him. His general meaning is that divine creation is perfect, and is represented or presided over by a perfect or cyclical number; human generation is imperfect, and represented or presided over by an imperfect number or series of numbers. The number 5040, which is the number of the citizens in the Laws, is expressly based by him on utilitarian grounds, namely, the convenience of the number for division; it is also made up of the first seven digits multiplied by one another. The contrast of the perfect and imperfect number may have been easily suggested by the corrections of the cycle, which were made first by Meton and secondly by Callippus; (the latter is said to have been a pupil of Plato). Of the degree of importance or of exactness to be attributed to the problem, the number of the tyrant in Book IX (729 = 365 x 2), and the slight correction of the error in the number 5040/12 (Laws), may furnish a criterion. There is nothing surprising in the circumstance that those who were seeking for order in nature and had found order in number, should have imagined one to give law to the other. Plato believes in a power of number far beyond what he could see realized in the world around him, and he knows the great influence which 'the little matter of 1, 2, 3' exercises upon education. He may even be thought to have a prophetic anticipation of the discoveries of Quetelet and others, that numbers depend upon numbers; e.g.—in population, the numbers of births and the respective numbers of children born of either sex, on the respective ages of parents, i.e. on other numbers.

BOOK IX. Last of all comes the tyrannical man, about whom we have to enquire, Whence is he, and how does he live—in happiness or in misery? There is, however, a previous question of the nature and number of the appetites, which I should like to consider first. Some of them are unlawful, and yet admit of being chastened and weakened in various degrees by the power of reason and law. 'What appetites do you mean?' I mean those which are awake when the reasoning powers are asleep, which get up and walk about naked without any self-respect or shame; and there is no conceivable folly or crime, however cruel or unnatural, of which, in imagination, they may not be guilty. 'True,' he said; 'very true.' But when a man's pulse beats temperately; and he has supped on a feast of reason and come to a knowledge of himself before going to rest, and has satisfied his desires just enough to prevent their perturbing his reason, which remains clear and luminous, and when he is free from quarrel and heat,—the visions which he has on his bed are least irregular and abnormal. Even in good men there is such an irregular wild-beast nature, which peers out in sleep.

To return:—You remember what was said of the democrat; that he was the son of a miserly father, who encouraged the saving desires and repressed the ornamental and expensive ones; presently the youth got into fine company, and began to entertain a dislike to his father's narrow ways; and being a better man than the corrupters of his youth, he came to a mean, and led a life, not of lawless or slavish passion, but of regular and successive indulgence. Now imagine that the youth has become a father, and has a son who is exposed to the same temptations, and has companions who lead him into every sort of iniquity, and parents and friends who try to keep him right. The counsellors of evil find that their only chance of retaining him is to implant in his soul a monster drone, or love; while other desires buzz around him and mystify him with sweet sounds and scents, this monster love takes possession of him, and puts an end to every true or modest thought or wish. Love, like drunkenness and madness, is a tyranny; and the tyrannical man, whether made by nature or habit, is just a drinking, lusting, furious sort of animal.

And how does such an one live? 'Nay, that you must tell me.' Well then, I fancy that he will live amid revelries and harlotries, and love will be the lord and master of the house. Many desires require much money, and so he spends all that he has and borrows more; and when he has nothing the young ravens are still in the nest in which they were hatched, crying for food. Love urges them on; and they must be gratified by force or fraud, or if not, they become painful and troublesome; and as the new pleasures succeed the old ones, so will the son take possession of the goods of his parents; if they show signs of refusing, he will defraud and deceive them; and if they openly resist, what then? 'I can only say, that I should not much like to be in their place.' But, O heavens, Adeimantus, to think that for some new-fangled and unnecessary love he will give up his old father and mother, best and dearest of friends, or enslave them to the fancies of the hour! Truly a tyrannical son is a blessing to his father and mother! When there is no more to be got out of them, he turns burglar or pickpocket, or robs a temple. Love overmasters the thoughts of his youth, and he becomes in sober reality the monster that he was sometimes in sleep. He waxes strong in all violence and lawlessness; and is ready for any deed of daring that will supply the wants of his rabble-rout. In a well-ordered State there are only a few such, and these in time of war go out and become the mercenaries of a tyrant. But in time of peace they stay at home and do mischief; they are the thieves, footpads, cut-purses, man-stealers of the community; or if they are able to speak, they turn false-witnesses and informers. 'No small catalogue of crimes truly, even if the perpetrators are few.' Yes, I said; but small and great are relative terms, and no crimes which are committed by them approach those of the tyrant, whom this class, growing strong and numerous, create out of themselves. If the people yield, well and good, but, if they resist, then, as before he beat his father and mother, so now he beats his fatherland and motherland, and places his mercenaries over them. Such men in their early days live with flatterers, and they themselves flatter others, in order to gain their ends; but they soon discard their followers when they have no longer any need of them; they are always either masters or servants,—the joys of friendship are unknown to them. And they are utterly treacherous and unjust, if the nature of justice be at all understood by us. They realize our dream; and he who is the most of a tyrant by nature, and leads the life of a tyrant for the longest time, will be the worst of them, and being the worst of them, will also be the most miserable.

Like man, like State,—the tyrannical man will answer to tyranny, which is the extreme opposite of the royal State; for one is the best and the other the worst. But which is the happier? Great and terrible as the tyrant may appear enthroned amid his satellites, let us not be afraid to go in and ask; and the answer is, that the monarchical is the happiest, and the tyrannical the most miserable of States. And may we not ask the same question about the men themselves, requesting some one to look into them who is able to penetrate the inner nature of man, and will not be panic-struck by the vain pomp of tyranny? I will suppose that he is one who has lived with him, and has seen him in family life, or perhaps in the hour of trouble and danger.

Assuming that we ourselves are the impartial judge for whom we seek, let us begin by comparing the individual and State, and ask first of all, whether the State is likely to be free or enslaved—Will there not be a little freedom and a great deal of slavery? And the freedom is of the bad, and the slavery of the good; and this applies to the man as well as to the State; for his soul is full of meanness and slavery, and the better part is enslaved to the worse. He cannot do what he would, and his mind is full of confusion; he is the very reverse of a freeman. The State will be poor and full of misery and sorrow; and the man's soul will also be poor and full of sorrows, and he will be the most miserable of men. No, not the most miserable, for there is yet a more miserable. 'Who is that?' The tyrannical man who has the misfortune also to become a public tyrant. 'There I suspect that you are right.' Say rather, 'I am sure;' conjecture is out of place in an enquiry of this nature. He is like a wealthy owner of slaves, only he has more of them than any private individual. You will say, 'The owners of slaves are not generally in any fear of them.' But why? Because the whole city is in a league which protects the individual. Suppose however that one of these owners and his household is carried off by a god into a wilderness, where there are no freemen to help him—will he not be in an agony of terror?—will he not be compelled to flatter his slaves and to promise them many things sore against his will? And suppose the same god who carried him off were to surround him with neighbours who declare that no man ought to have slaves, and that the owners of them should be punished with death. 'Still worse and worse! He will be in the midst of his enemies.' And is not our tyrant such a captive soul, who is tormented by a swarm of passions which he cannot indulge; living indoors always like a woman, and jealous of those who can go out and see the world?

Having so many evils, will not the most miserable of men be still more miserable in a public station? Master of others when he is not master of himself; like a sick man who is compelled to be an athlete; the meanest of slaves and the most abject of flatterers; wanting all things, and never able to satisfy his desires; always in fear and distraction, like the State of which he is the representative. His jealous, hateful, faithless temper grows worse with command; he is more and more faithless, envious, unrighteous,—the most wretched of men, a misery to himself and to others. And so let us have a final trial and proclamation; need we hire a herald, or shall I proclaim the result? 'Made the proclamation yourself.' The son of Ariston (the best) is of opinion that the best and justest of men is also the happiest, and that this is he who is the most royal master of himself; and that the unjust man is he who is the greatest tyrant of himself and of his State. And I add further—'seen or unseen by gods or men.'

This is our first proof. The second is derived from the three kinds of pleasure, which answer to the three elements of the soul—reason, passion, desire; under which last is comprehended avarice as well as sensual appetite, while passion includes ambition, party-feeling, love of reputation. Reason, again, is solely directed to the attainment of truth, and careless of money and reputation. In accordance with the difference of men's natures, one of these three principles is in the ascendant, and they have their several pleasures corresponding to them. Interrogate now the three natures, and each one will be found praising his own pleasures and depreciating those of others. The money-maker will contrast the vanity of knowledge with the solid advantages of wealth. The ambitious man will despise knowledge which brings no honour; whereas the philosopher will regard only the fruition of truth, and will call other pleasures necessary rather than good. Now, how shall we decide between them? Is there any better criterion than experience and knowledge? And which of the three has the truest knowledge and the widest experience? The experience of youth makes the philosopher acquainted with the two kinds of desire, but the avaricious and the ambitious man never taste the pleasures of truth and wisdom. Honour he has equally with them; they are 'judged of him,' but he is 'not judged of them,' for they never attain to the knowledge of true being. And his instrument is reason, whereas their standard is only wealth and honour; and if by reason we are to judge, his good will be the truest. And so we arrive at the result that the pleasure of the rational part of the soul, and a life passed in such pleasure is the pleasantest. He who has a right to judge judges thus. Next comes the life of ambition, and, in the third place, that of money-making.

Twice has the just man overthrown the unjust—once more, as in an Olympian contest, first offering up a prayer to the saviour Zeus, let him try a fall. A wise man whispers to me that the pleasures of the wise are true and pure; all others are a shadow only. Let us examine this: Is not pleasure opposed to pain, and is there not a mean state which is neither? When a man is sick, nothing is more pleasant to him than health. But this he never found out while he was well. In pain he desires only to cease from pain; on the other hand, when he is in an ecstasy of pleasure, rest is painful to him. Thus rest or cessation is both pleasure and pain. But can that which is neither become both? Again, pleasure and pain are motions, and the absence of them is rest; but if so, how can the absence of either of them be the other? Thus we are led to infer that the contradiction is an appearance only, and witchery of the senses. And these are not the only pleasures, for there are others which have no preceding pains. Pure pleasure then is not the absence of pain, nor pure pain the absence of pleasure; although most of the pleasures which reach the mind through the body are reliefs of pain, and have not only their reactions when they depart, but their anticipations before they come. They can be best described in a simile. There is in nature an upper, lower, and middle region, and he who passes from the lower to the middle imagines that he is going up and is already in the upper world; and if he were taken back again would think, and truly think, that he was descending. All this arises out of his ignorance of the true upper, middle, and lower regions. And a like confusion happens with pleasure and pain, and with many other things. The man who compares grey with black, calls grey white; and the man who compares absence of pain with pain, calls the absence of pain pleasure. Again, hunger and thirst are inanitions of the body, ignorance and folly of the soul; and food is the satisfaction of the one, knowledge of the other. Now which is the purer satisfaction—that of eating and drinking, or that of knowledge? Consider the matter thus: The satisfaction of that which has more existence is truer than of that which has less. The invariable and immortal has a more real existence than the variable and mortal, and has a corresponding measure of knowledge and truth. The soul, again, has more existence and truth and knowledge than the body, and is therefore more really satisfied and has a more natural pleasure. Those who feast only on earthly food, are always going at random up to the middle and down again; but they never pass into the true upper world, or have a taste of true pleasure. They are like fatted beasts, full of gluttony and sensuality, and ready to kill one another by reason of their insatiable lust; for they are not filled with true being, and their vessel is leaky (Gorgias). Their pleasures are mere shadows of pleasure, mixed with pain, coloured and intensified by contrast, and therefore intensely desired; and men go fighting about them, as Stesichorus says that the Greeks fought about the shadow of Helen at Troy, because they know not the truth.

The same may be said of the passionate element:—the desires of the ambitious soul, as well as of the covetous, have an inferior satisfaction. Only when under the guidance of reason do either of the other principles do their own business or attain the pleasure which is natural to them. When not attaining, they compel the other parts of the soul to pursue a shadow of pleasure which is not theirs. And the more distant they are from philosophy and reason, the more distant they will be from law and order, and the more illusive will be their pleasures. The desires of love and tyranny are the farthest from law, and those of the king are nearest to it. There is one genuine pleasure, and two spurious ones: the tyrant goes beyond even the latter; he has run away altogether from law and reason. Nor can the measure of his inferiority be told, except in a figure. The tyrant is the third removed from the oligarch, and has therefore, not a shadow of his pleasure, but the shadow of a shadow only. The oligarch, again, is thrice removed from the king, and thus we get the formula 3 x 3, which is the number of a surface, representing the shadow which is the tyrant's pleasure, and if you like to cube this 'number of the beast,' you will find that the measure of the difference amounts to 729; the king is 729 times more happy than the tyrant. And this extraordinary number is NEARLY equal to the number of days and nights in a year (365 x 2 = 730); and is therefore concerned with human life. This is the interval between a good and bad man in happiness only: what must be the difference between them in comeliness of life and virtue!

Perhaps you may remember some one saying at the beginning of our discussion that the unjust man was profited if he had the reputation of justice. Now that we know the nature of justice and injustice, let us make an image of the soul, which will personify his words. First of all, fashion a multitudinous beast, having a ring of heads of all manner of animals, tame and wild, and able to produce and change them at pleasure. Suppose now another form of a lion, and another of a man; the second smaller than the first, the third than the second; join them together and cover them with a human skin, in which they are completely concealed. When this has been done, let us tell the supporter of injustice that he is feeding up the beasts and starving the man. The maintainer of justice, on the other hand, is trying to strengthen the man; he is nourishing the gentle principle within him, and making an alliance with the lion heart, in order that he may be able to keep down the many-headed hydra, and bring all into unity with each other and with themselves. Thus in every point of view, whether in relation to pleasure, honour, or advantage, the just man is right, and the unjust wrong.

But now, let us reason with the unjust, who is not intentionally in error. Is not the noble that which subjects the beast to the man, or rather to the God in man; the ignoble, that which subjects the man to the beast? And if so, who would receive gold on condition that he was to degrade the noblest part of himself under the worst?—who would sell his son or daughter into the hands of brutal and evil men, for any amount of money? And will he sell his own fairer and diviner part without any compunction to the most godless and foul? Would he not be worse than Eriphyle, who sold her husband's life for a necklace? And intemperance is the letting loose of the multiform monster, and pride and sullenness are the growth and increase of the lion and serpent element, while luxury and effeminacy are caused by a too great relaxation of spirit. Flattery and meanness again arise when the spirited element is subjected to avarice, and the lion is habituated to become a monkey. The real disgrace of handicraft arts is, that those who are engaged in them have to flatter, instead of mastering their desires; therefore we say that they should be placed under the control of the better principle in another because they have none in themselves; not, as Thrasymachus imagined, to the injury of the subjects, but for their good. And our intention in educating the young, is to give them self-control; the law desires to nurse up in them a higher principle, and when they have acquired this, they may go their ways.

'What, then, shall a man profit, if he gain the whole world' and become more and more wicked? Or what shall he profit by escaping discovery, if the concealment of evil prevents the cure? If he had been punished, the brute within him would have been silenced, and the gentler element liberated; and he would have united temperance, justice, and wisdom in his soul—a union better far than any combination of bodily gifts. The man of understanding will honour knowledge above all; in the next place he will keep under his body, not only for the sake of health and strength, but in order to attain the most perfect harmony of body and soul. In the acquisition of riches, too, he will aim at order and harmony; he will not desire to heap up wealth without measure, but he will fear that the increase of wealth will disturb the constitution of his own soul. For the same reason he will only accept such honours as will make him a better man; any others he will decline. 'In that case,' said he, 'he will never be a politician.' Yes, but he will, in his own city; though probably not in his native country, unless by some divine accident. 'You mean that he will be a citizen of the ideal city, which has no place upon earth.' But in heaven, I replied, there is a pattern of such a city, and he who wishes may order his life after that image. Whether such a state is or ever will be matters not; he will act according to that pattern and no other...

The most noticeable points in the 9th Book of the Republic are:—(1) the account of pleasure; (2) the number of the interval which divides the king from the tyrant; (3) the pattern which is in heaven.

1. Plato's account of pleasure is remarkable for moderation, and in this respect contrasts with the later Platonists and the views which are attributed to them by Aristotle. He is not, like the Cynics, opposed to all pleasure, but rather desires that the several parts of the soul shall have their natural satisfaction; he even agrees with the Epicureans in describing pleasure as something more than the absence of pain. This is proved by the circumstance that there are pleasures which have no antecedent pains (as he also remarks in the Philebus), such as the pleasures of smell, and also the pleasures of hope and anticipation. In the previous book he had made the distinction between necessary and unnecessary pleasure, which is repeated by Aristotle, and he now observes that there are a further class of 'wild beast' pleasures, corresponding to Aristotle's (Greek). He dwells upon the relative and unreal character of sensual pleasures and the illusion which arises out of the contrast of pleasure and pain, pointing out the superiority of the pleasures of reason, which are at rest, over the fleeting pleasures of sense and emotion. The pre-eminence of royal pleasure is shown by the fact that reason is able to form a judgment of the lower pleasures, while the two lower parts of the soul are incapable of judging the pleasures of reason. Thus, in his treatment of pleasure, as in many other subjects, the philosophy of Plato is 'sawn up into quantities' by Aristotle; the analysis which was originally made by him became in the next generation the foundation of further technical distinctions. Both in Plato and Aristotle we note the illusion under which the ancients fell of regarding the transience of pleasure as a proof of its unreality, and of confounding the permanence of the intellectual pleasures with the unchangeableness of the knowledge from which they are derived. Neither do we like to admit that the pleasures of knowledge, though more elevating, are not more lasting than other pleasures, and are almost equally dependent on the accidents of our bodily state (Introduction to Philebus).

2. The number of the interval which separates the king from the tyrant, and royal from tyrannical pleasures, is 729, the cube of 9. Which Plato characteristically designates as a number concerned with human life, because NEARLY equivalent to the number of days and nights in the year. He is desirous of proclaiming that the interval between them is immeasurable, and invents a formula to give expression to his idea. Those who spoke of justice as a cube, of virtue as an art of measuring (Prot.), saw no inappropriateness in conceiving the soul under the figure of a line, or the pleasure of the tyrant as separated from the pleasure of the king by the numerical interval of 729. And in modern times we sometimes use metaphorically what Plato employed as a philosophical formula. 'It is not easy to estimate the loss of the tyrant, except perhaps in this way,' says Plato. So we might say, that although the life of a good man is not to be compared to that of a bad man, yet you may measure the difference between them by valuing one minute of the one at an hour of the other ('One day in thy courts is better than a thousand'), or you might say that 'there is an infinite difference.' But this is not so much as saying, in homely phrase, 'They are a thousand miles asunder.' And accordingly Plato finds the natural vehicle of his thoughts in a progression of numbers; this arithmetical formula he draws out with the utmost seriousness, and both here and in the number of generation seems to find an additional proof of the truth of his speculation in forming the number into a geometrical figure; just as persons in our own day are apt to fancy that a statement is verified when it has been only thrown into an abstract form. In speaking of the number 729 as proper to human life, he probably intended to intimate that one year of the tyrannical = 12 hours of the royal life.

The simple observation that the comparison of two similar solids is effected by the comparison of the cubes of their sides, is the mathematical groundwork of this fanciful expression. There is some difficulty in explaining the steps by which the number 729 is obtained; the oligarch is removed in the third degree from the royal and aristocratical, and the tyrant in the third degree from the oligarchical; but we have to arrange the terms as the sides of a square and to count the oligarch twice over, thus reckoning them not as = 5 but as = 9. The square of 9 is passed lightly over as only a step towards the cube.

3. Towards the close of the Republic, Plato seems to be more and more convinced of the ideal character of his own speculations. At the end of the 9th Book the pattern which is in heaven takes the place of the city of philosophers on earth. The vision which has received form and substance at his hands, is now discovered to be at a distance. And yet this distant kingdom is also the rule of man's life. ('Say not lo! here, or lo! there, for the kingdom of God is within you.') Thus a note is struck which prepares for the revelation of a future life in the following Book. But the future life is present still; the ideal of politics is to be realized in the individual.

BOOK X. Many things pleased me in the order of our State, but there was nothing which I liked better than the regulation about poetry. The division of the soul throws a new light on our exclusion of imitation. I do not mind telling you in confidence that all poetry is an outrage on the understanding, unless the hearers have that balm of knowledge which heals error. I have loved Homer ever since I was a boy, and even now he appears to me to be the great master of tragic poetry. But much as I love the man, I love truth more, and therefore I must speak out: and first of all, will you explain what is imitation, for really I do not understand? 'How likely then that I should understand!' That might very well be, for the duller often sees better than the keener eye. 'True, but in your presence I can hardly venture to say what I think.' Then suppose that we begin in our old fashion, with the doctrine of universals. Let us assume the existence of beds and tables. There is one idea of a bed, or of a table, which the maker of each had in his mind when making them; he did not make the ideas of beds and tables, but he made beds and tables according to the ideas. And is there not a maker of the works of all workmen, who makes not only vessels but plants and animals, himself, the earth and heaven, and things in heaven and under the earth? He makes the Gods also. 'He must be a wizard indeed!' But do you not see that there is a sense in which you could do the same? You have only to take a mirror, and catch the reflection of the sun, and the earth, or anything else—there now you have made them. 'Yes, but only in appearance.' Exactly so; and the painter is such a creator as you are with the mirror, and he is even more unreal than the carpenter; although neither the carpenter nor any other artist can be supposed to make the absolute bed. 'Not if philosophers may be believed.' Nor need we wonder that his bed has but an imperfect relation to the truth. Reflect:—Here are three beds; one in nature, which is made by God; another, which is made by the carpenter; and the third, by the painter. God only made one, nor could he have made more than one; for if there had been two, there would always have been a third—more absolute and abstract than either, under which they would have been included. We may therefore conceive God to be the natural maker of the bed, and in a lower sense the carpenter is also the maker; but the painter is rather the imitator of what the other two make; he has to do with a creation which is thrice removed from reality. And the tragic poet is an imitator, and, like every other imitator, is thrice removed from the king and from the truth. The painter imitates not the original bed, but the bed made by the carpenter. And this, without being really different, appears to be different, and has many points of view, of which only one is caught by the painter, who represents everything because he represents a piece of everything, and that piece an image. And he can paint any other artist, although he knows nothing of their arts; and this with sufficient skill to deceive children or simple people. Suppose now that somebody came to us and told us, how he had met a man who knew all that everybody knows, and better than anybody:—should we not infer him to be a simpleton who, having no discernment of truth and falsehood, had met with a wizard or enchanter, whom he fancied to be all-wise? And when we hear persons saying that Homer and the tragedians know all the arts and all the virtues, must we not infer that they are under a similar delusion? they do not see that the poets are imitators, and that their creations are only imitations. 'Very true.' But if a person could create as well as imitate, he would rather leave some permanent work and not an imitation only; he would rather be the receiver than the giver of praise? 'Yes, for then he would have more honour and advantage.'

Let us now interrogate Homer and the poets. Friend Homer, say I to him, I am not going to ask you about medicine, or any art to which your poems incidentally refer, but about their main subjects—war, military tactics, politics. If you are only twice and not thrice removed from the truth—not an imitator or an image-maker, please to inform us what good you have ever done to mankind? Is there any city which professes to have received laws from you, as Sicily and Italy have from Charondas, Sparta from Lycurgus, Athens from Solon? Or was any war ever carried on by your counsels? or is any invention attributed to you, as there is to Thales and Anacharsis? Or is there any Homeric way of life, such as the Pythagorean was, in which you instructed men, and which is called after you? 'No, indeed; and Creophylus (Flesh-child) was even more unfortunate in his breeding than he was in his name, if, as tradition says, Homer in his lifetime was allowed by him and his other friends to starve.' Yes, but could this ever have happened if Homer had really been the educator of Hellas? Would he not have had many devoted followers? If Protagoras and Prodicus can persuade their contemporaries that no one can manage house or State without them, is it likely that Homer and Hesiod would have been allowed to go about as beggars—I mean if they had really been able to do the world any good?—would not men have compelled them to stay where they were, or have followed them about in order to get education? But they did not; and therefore we may infer that Homer and all the poets are only imitators, who do but imitate the appearances of things. For as a painter by a knowledge of figure and colour can paint a cobbler without any practice in cobbling, so the poet can delineate any art in the colours of language, and give harmony and rhythm to the cobbler and also to the general; and you know how mere narration, when deprived of the ornaments of metre, is like a face which has lost the beauty of youth and never had any other. Once more, the imitator has no knowledge of reality, but only of appearance. The painter paints, and the artificer makes a bridle and reins, but neither understands the use of them—the knowledge of this is confined to the horseman; and so of other things. Thus we have three arts: one of use, another of invention, a third of imitation; and the user furnishes the rule to the two others. The flute-player will know the good and bad flute, and the maker will put faith in him; but the imitator will neither know nor have faith—neither science nor true opinion can be ascribed to him. Imitation, then, is devoid of knowledge, being only a kind of play or sport, and the tragic and epic poets are imitators in the highest degree.

And now let us enquire, what is the faculty in man which answers to imitation. Allow me to explain my meaning: Objects are differently seen when in the water and when out of the water, when near and when at a distance; and the painter or juggler makes use of this variation to impose upon us. And the art of measuring and weighing and calculating comes in to save our bewildered minds from the power of appearance; for, as we were saying, two contrary opinions of the same about the same and at the same time, cannot both of them be true. But which of them is true is determined by the art of calculation; and this is allied to the better faculty in the soul, as the arts of imitation are to the worse. And the same holds of the ear as well as of the eye, of poetry as well as painting. The imitation is of actions voluntary or involuntary, in which there is an expectation of a good or bad result, and present experience of pleasure and pain. But is a man in harmony with himself when he is the subject of these conflicting influences? Is there not rather a contradiction in him? Let me further ask, whether he is more likely to control sorrow when he is alone or when he is in company. 'In the latter case.' Feeling would lead him to indulge his sorrow, but reason and law control him and enjoin patience; since he cannot know whether his affliction is good or evil, and no human thing is of any great consequence, while sorrow is certainly a hindrance to good counsel. For when we stumble, we should not, like children, make an uproar; we should take the measures which reason prescribes, not raising a lament, but finding a cure. And the better part of us is ready to follow reason, while the irrational principle is full of sorrow and distraction at the recollection of our troubles. Unfortunately, however, this latter furnishes the chief materials of the imitative arts. Whereas reason is ever in repose and cannot easily be displayed, especially to a mixed multitude who have no experience of her. Thus the poet is like the painter in two ways: first he paints an inferior degree of truth, and secondly, he is concerned with an inferior part of the soul. He indulges the feelings, while he enfeebles the reason; and we refuse to allow him to have authority over the mind of man; for he has no measure of greater and less, and is a maker of images and very far gone from truth.

But we have not yet mentioned the heaviest count in the indictment—the power which poetry has of injuriously exciting the feelings. When we hear some passage in which a hero laments his sufferings at tedious length, you know that we sympathize with him and praise the poet; and yet in our own sorrows such an exhibition of feeling is regarded as effeminate and unmanly (Ion). Now, ought a man to feel pleasure in seeing another do what he hates and abominates in himself? Is he not giving way to a sentiment which in his own case he would control?—he is off his guard because the sorrow is another's; and he thinks that he may indulge his feelings without disgrace, and will be the gainer by the pleasure. But the inevitable consequence is that he who begins by weeping at the sorrows of others, will end by weeping at his own. The same is true of comedy,—you may often laugh at buffoonery which you would be ashamed to utter, and the love of coarse merriment on the stage will at last turn you into a buffoon at home. Poetry feeds and waters the passions and desires; she lets them rule instead of ruling them. And therefore, when we hear the encomiasts of Homer affirming that he is the educator of Hellas, and that all life should be regulated by his precepts, we may allow the excellence of their intentions, and agree with them in thinking Homer a great poet and tragedian. But we shall continue to prohibit all poetry which goes beyond hymns to the Gods and praises of famous men. Not pleasure and pain, but law and reason shall rule in our State.

These are our grounds for expelling poetry; but lest she should charge us with discourtesy, let us also make an apology to her. We will remind her that there is an ancient quarrel between poetry and philosophy, of which there are many traces in the writings of the poets, such as the saying of 'the she-dog, yelping at her mistress,' and 'the philosophers who are ready to circumvent Zeus,' and 'the philosophers who are paupers.' Nevertheless we bear her no ill-will, and will gladly allow her to return upon condition that she makes a defence of herself in verse; and her supporters who are not poets may speak in prose. We confess her charms; but if she cannot show that she is useful as well as delightful, like rational lovers, we must renounce our love, though endeared to us by early associations. Having come to years of discretion, we know that poetry is not truth, and that a man should be careful how he introduces her to that state or constitution which he himself is; for there is a mighty issue at stake—no less than the good or evil of a human soul. And it is not worth while to forsake justice and virtue for the attractions of poetry, any more than for the sake of honour or wealth. 'I agree with you.'

And yet the rewards of virtue are greater far than I have described. 'And can we conceive things greater still?' Not, perhaps, in this brief span of life: but should an immortal being care about anything short of eternity? 'I do not understand what you mean?' Do you not know that the soul is immortal? 'Surely you are not prepared to prove that?' Indeed I am. 'Then let me hear this argument, of which you make so light.'

You would admit that everything has an element of good and of evil. In all things there is an inherent corruption; and if this cannot destroy them, nothing else will. The soul too has her own corrupting principles, which are injustice, intemperance, cowardice, and the like. But none of these destroy the soul in the same sense that disease destroys the body. The soul may be full of all iniquities, but is not, by reason of them, brought any nearer to death. Nothing which was not destroyed from within ever perished by external affection of evil. The body, which is one thing, cannot be destroyed by food, which is another, unless the badness of the food is communicated to the body. Neither can the soul, which is one thing, be corrupted by the body, which is another, unless she herself is infected. And as no bodily evil can infect the soul, neither can any bodily evil, whether disease or violence, or any other destroy the soul, unless it can be shown to render her unholy and unjust. But no one will ever prove that the souls of men become more unjust when they die. If a person has the audacity to say the contrary, the answer is—Then why do criminals require the hand of the executioner, and not die of themselves? 'Truly,' he said, 'injustice would not be very terrible if it brought a cessation of evil; but I rather believe that the injustice which murders others may tend to quicken and stimulate the life of the unjust.' You are quite right. If sin which is her own natural and inherent evil cannot destroy the soul, hardly will anything else destroy her. But the soul which cannot be destroyed either by internal or external evil must be immortal and everlasting. And if this be true, souls will always exist in the same number. They cannot diminish, because they cannot be destroyed; nor yet increase, for the increase of the immortal must come from something mortal, and so all would end in immortality. Neither is the soul variable and diverse; for that which is immortal must be of the fairest and simplest composition. If we would conceive her truly, and so behold justice and injustice in their own nature, she must be viewed by the light of reason pure as at birth, or as she is reflected in philosophy when holding converse with the divine and immortal and eternal. In her present condition we see her only like the sea-god Glaucus, bruised and maimed in the sea which is the world, and covered with shells and stones which are incrusted upon her from the entertainments of earth.

Thus far, as the argument required, we have said nothing of the rewards and honours which the poets attribute to justice; we have contented ourselves with showing that justice in herself is best for the soul in herself, even if a man should put on a Gyges' ring and have the helmet of Hades too. And now you shall repay me what you borrowed; and I will enumerate the rewards of justice in life and after death. I granted, for the sake of argument, as you will remember, that evil might perhaps escape the knowledge of Gods and men, although this was really impossible. And since I have shown that justice has reality, you must grant me also that she has the palm of appearance. In the first place, the just man is known to the Gods, and he is therefore the friend of the Gods, and he will receive at their hands every good, always excepting such evil as is the necessary consequence of former sins. All things end in good to him, either in life or after death, even what appears to be evil; for the Gods have a care of him who desires to be in their likeness. And what shall we say of men? Is not honesty the best policy? The clever rogue makes a great start at first, but breaks down before he reaches the goal, and slinks away in dishonour; whereas the true runner perseveres to the end, and receives the prize. And you must allow me to repeat all the blessings which you attributed to the fortunate unjust—they bear rule in the city, they marry and give in marriage to whom they will; and the evils which you attributed to the unfortunate just, do really fall in the end on the unjust, although, as you implied, their sufferings are better veiled in silence.

But all the blessings of this present life are as nothing when compared with those which await good men after death. 'I should like to hear about them.' Come, then, and I will tell you the story of Er, the son of Armenius, a valiant man. He was supposed to have died in battle, but ten days afterwards his body was found untouched by corruption and sent home for burial. On the twelfth day he was placed on the funeral pyre and there he came to life again, and told what he had seen in the world below. He said that his soul went with a great company to a place, in which there were two chasms near together in the earth beneath, and two corresponding chasms in the heaven above. And there were judges sitting in the intermediate space, bidding the just ascend by the heavenly way on the right hand, having the seal of their judgment set upon them before, while the unjust, having the seal behind, were bidden to descend by the way on the left hand. Him they told to look and listen, as he was to be their messenger to men from the world below. And he beheld and saw the souls departing after judgment at either chasm; some who came from earth, were worn and travel-stained; others, who came from heaven, were clean and bright. They seemed glad to meet and rest awhile in the meadow; here they discoursed with one another of what they had seen in the other world. Those who came from earth wept at the remembrance of their sorrows, but the spirits from above spoke of glorious sights and heavenly bliss. He said that for every evil deed they were punished tenfold—now the journey was of a thousand years' duration, because the life of man was reckoned as a hundred years—and the rewards of virtue were in the same proportion. He added something hardly worth repeating about infants dying almost as soon as they were born. Of parricides and other murderers he had tortures still more terrible to narrate. He was present when one of the spirits asked—Where is Ardiaeus the Great? (This Ardiaeus was a cruel tyrant, who had murdered his father, and his elder brother, a thousand years before.) Another spirit answered, 'He comes not hither, and will never come. And I myself,' he added, 'actually saw this terrible sight. At the entrance of the chasm, as we were about to reascend, Ardiaeus appeared, and some other sinners—most of whom had been tyrants, but not all—and just as they fancied that they were returning to life, the chasm gave a roar, and then wild, fiery-looking men who knew the meaning of the sound, seized him and several others, and bound them hand and foot and threw them down, and dragged them along at the side of the road, lacerating them and carding them like wool, and explaining to the passers-by, that they were going to be cast into hell.' The greatest terror of the pilgrims ascending was lest they should hear the voice, and when there was silence one by one they passed up with joy. To these sufferings there were corresponding delights.

On the eighth day the souls of the pilgrims resumed their journey, and in four days came to a spot whence they looked down upon a line of light, in colour like a rainbow, only brighter and clearer. One day more brought them to the place, and they saw that this was the column of light which binds together the whole universe. The ends of the column were fastened to heaven, and from them hung the distaff of Necessity, on which all the heavenly bodies turned—the hook and spindle were of adamant, and the whorl of a mixed substance. The whorl was in form like a number of boxes fitting into one another with their edges turned upwards, making together a single whorl which was pierced by the spindle. The outermost had the rim broadest, and the inner whorls were smaller and smaller, and had their rims narrower. The largest (the fixed stars) was spangled—the seventh (the sun) was brightest—the eighth (the moon) shone by the light of the seventh—the second and fifth (Saturn and Mercury) were most like one another and yellower than the eighth—the third (Jupiter) had the whitest light—the fourth (Mars) was red—the sixth (Venus) was in whiteness second. The whole had one motion, but while this was revolving in one direction the seven inner circles were moving in the opposite, with various degrees of swiftness and slowness. The spindle turned on the knees of Necessity, and a Siren stood hymning upon each circle, while Lachesis, Clotho, and Atropos, the daughters of Necessity, sat on thrones at equal intervals, singing of past, present, and future, responsive to the music of the Sirens; Clotho from time to time guiding the outer circle with a touch of her right hand; Atropos with her left hand touching and guiding the inner circles; Lachesis in turn putting forth her hand from time to time to guide both of them. On their arrival the pilgrims went to Lachesis, and there was an interpreter who arranged them, and taking from her knees lots, and samples of lives, got up into a pulpit and said: 'Mortal souls, hear the words of Lachesis, the daughter of Necessity. A new period of mortal life has begun, and you may choose what divinity you please; the responsibility of choosing is with you—God is blameless.' After speaking thus, he cast the lots among them and each one took up the lot which fell near him. He then placed on the ground before them the samples of lives, many more than the souls present; and there were all sorts of lives, of men and of animals. There were tyrannies ending in misery and exile, and lives of men and women famous for their different qualities; and also mixed lives, made up of wealth and poverty, sickness and health. Here, Glaucon, is the great risk of human life, and therefore the whole of education should be directed to the acquisition of such a knowledge as will teach a man to refuse the evil and choose the good. He should know all the combinations which occur in life—of beauty with poverty or with wealth,—of knowledge with external goods,—and at last choose with reference to the nature of the soul, regarding that only as the better life which makes men better, and leaving the rest. And a man must take with him an iron sense of truth and right into the world below, that there too he may remain undazzled by wealth or the allurements of evil, and be determined to avoid the extremes and choose the mean. For this, as the messenger reported the interpreter to have said, is the true happiness of man; and any one, as he proclaimed, may, if he choose with understanding, have a good lot, even though he come last. 'Let not the first be careless in his choice, nor the last despair.' He spoke; and when he had spoken, he who had drawn the first lot chose a tyranny: he did not see that he was fated to devour his own children—and when he discovered his mistake, he wept and beat his breast, blaming chance and the Gods and anybody rather than himself. He was one of those who had come from heaven, and in his previous life had been a citizen of a well-ordered State, but he had only habit and no philosophy. Like many another, he made a bad choice, because he had no experience of life; whereas those who came from earth and had seen trouble were not in such a hurry to choose. But if a man had followed philosophy while upon earth, and had been moderately fortunate in his lot, he might not only be happy here, but his pilgrimage both from and to this world would be smooth and heavenly. Nothing was more curious than the spectacle of the choice, at once sad and laughable and wonderful; most of the souls only seeking to avoid their own condition in a previous life. He saw the soul of Orpheus changing into a swan because he would not be born of a woman; there was Thamyras becoming a nightingale; musical birds, like the swan, choosing to be men; the twentieth soul, which was that of Ajax, preferring the life of a lion to that of a man, in remembrance of the injustice which was done to him in the judgment of the arms; and Agamemnon, from a like enmity to human nature, passing into an eagle. About the middle was the soul of Atalanta choosing the honours of an athlete, and next to her Epeus taking the nature of a workwoman; among the last was Thersites, who was changing himself into a monkey. Thither, the last of all, came Odysseus, and sought the lot of a private man, which lay neglected and despised, and when he found it he went away rejoicing, and said that if he had been first instead of last, his choice would have been the same. Men, too, were seen passing into animals, and wild and tame animals changing into one another.

When all the souls had chosen they went to Lachesis, who sent with each of them their genius or attendant to fulfil their lot. He first of all brought them under the hand of Clotho, and drew them within the revolution of the spindle impelled by her hand; from her they were carried to Atropos, who made the threads irreversible; whence, without turning round, they passed beneath the throne of Necessity; and when they had all passed, they moved on in scorching heat to the plain of Forgetfulness and rested at evening by the river Unmindful, whose water could not be retained in any vessel; of this they had all to drink a certain quantity—some of them drank more than was required, and he who drank forgot all things. Er himself was prevented from drinking. When they had gone to rest, about the middle of the night there were thunderstorms and earthquakes, and suddenly they were all driven divers ways, shooting like stars to their birth. Concerning his return to the body, he only knew that awaking suddenly in the morning he found himself lying on the pyre.

Thus, Glaucon, the tale has been saved, and will be our salvation, if we believe that the soul is immortal, and hold fast to the heavenly way of Justice and Knowledge. So shall we pass undefiled over the river of Forgetfulness, and be dear to ourselves and to the Gods, and have a crown of reward and happiness both in this world and also in the millennial pilgrimage of the other.

The Tenth Book of the Republic of Plato falls into two divisions: first, resuming an old thread which has been interrupted, Socrates assails the poets, who, now that the nature of the soul has been analyzed, are seen to be very far gone from the truth; and secondly, having shown the reality of the happiness of the just, he demands that appearance shall be restored to him, and then proceeds to prove the immortality of the soul. The argument, as in the Phaedo and Gorgias, is supplemented by the vision of a future life.

Why Plato, who was himself a poet, and whose dialogues are poems and dramas, should have been hostile to the poets as a class, and especially to the dramatic poets; why he should not have seen that truth may be embodied in verse as well as in prose, and that there are some indefinable lights and shadows of human life which can only be expressed in poetry—some elements of imagination which always entwine with reason; why he should have supposed epic verse to be inseparably associated with the impurities of the old Hellenic mythology; why he should try Homer and Hesiod by the unfair and prosaic test of utility,—are questions which have always been debated amongst students of Plato. Though unable to give a complete answer to them, we may show—first, that his views arose naturally out of the circumstances of his age; and secondly, we may elicit the truth as well as the error which is contained in them.

He is the enemy of the poets because poetry was declining in his own lifetime, and a theatrocracy, as he says in the Laws, had taken the place of an intellectual aristocracy. Euripides exhibited the last phase of the tragic drama, and in him Plato saw the friend and apologist of tyrants, and the Sophist of tragedy. The old comedy was almost extinct; the new had not yet arisen. Dramatic and lyric poetry, like every other branch of Greek literature, was falling under the power of rhetoric. There was no 'second or third' to Aeschylus and Sophocles in the generation which followed them. Aristophanes, in one of his later comedies (Frogs), speaks of 'thousands of tragedy-making prattlers,' whose attempts at poetry he compares to the chirping of swallows; 'their garrulity went far beyond Euripides,'—'they appeared once upon the stage, and there was an end of them.' To a man of genius who had a real appreciation of the godlike Aeschylus and the noble and gentle Sophocles, though disagreeing with some parts of their 'theology' (Rep.), these 'minor poets' must have been contemptible and intolerable. There is no feeling stronger in the dialogues of Plato than a sense of the decline and decay both in literature and in politics which marked his own age. Nor can he have been expected to look with favour on the licence of Aristophanes, now at the end of his career, who had begun by satirizing Socrates in the Clouds, and in a similar spirit forty years afterwards had satirized the founders of ideal commonwealths in his Eccleziazusae, or Female Parliament (Laws).

There were other reasons for the antagonism of Plato to poetry. The profession of an actor was regarded by him as a degradation of human nature, for 'one man in his life' cannot 'play many parts;' the characters which the actor performs seem to destroy his own character, and to leave nothing which can be truly called himself. Neither can any man live his life and act it. The actor is the slave of his art, not the master of it. Taking this view Plato is more decided in his expulsion of the dramatic than of the epic poets, though he must have known that the Greek tragedians afforded noble lessons and examples of virtue and patriotism, to which nothing in Homer can be compared. But great dramatic or even great rhetorical power is hardly consistent with firmness or strength of mind, and dramatic talent is often incidentally associated with a weak or dissolute character.

In the Tenth Book Plato introduces a new series of objections. First, he says that the poet or painter is an imitator, and in the third degree removed from the truth. His creations are not tested by rule and measure; they are only appearances. In modern times we should say that art is not merely imitation, but rather the expression of the ideal in forms of sense. Even adopting the humble image of Plato, from which his argument derives a colour, we should maintain that the artist may ennoble the bed which he paints by the folds of the drapery, or by the feeling of home which he introduces; and there have been modern painters who have imparted such an ideal interest to a blacksmith's or a carpenter's shop. The eye or mind which feels as well as sees can give dignity and pathos to a ruined mill, or a straw-built shed (Rembrandt), to the hull of a vessel 'going to its last home' (Turner). Still more would this apply to the greatest works of art, which seem to be the visible embodiment of the divine. Had Plato been asked whether the Zeus or Athene of Pheidias was the imitation of an imitation only, would he not have been compelled to admit that something more was to be found in them than in the form of any mortal; and that the rule of proportion to which they conformed was 'higher far than any geometry or arithmetic could express?' (Statesman.)

Again, Plato objects to the imitative arts that they express the emotional rather than the rational part of human nature. He does not admit Aristotle's theory, that tragedy or other serious imitations are a purgation of the passions by pity and fear; to him they appear only to afford the opportunity of indulging them. Yet we must acknowledge that we may sometimes cure disordered emotions by giving expression to them; and that they often gain strength when pent up within our own breast. It is not every indulgence of the feelings which is to be condemned. For there may be a gratification of the higher as well as of the lower—thoughts which are too deep or too sad to be expressed by ourselves, may find an utterance in the words of poets. Every one would acknowledge that there have been times when they were consoled and elevated by beautiful music or by the sublimity of architecture or by the peacefulness of nature. Plato has himself admitted, in the earlier part of the Republic, that the arts might have the effect of harmonizing as well as of enervating the mind; but in the Tenth Book he regards them through a Stoic or Puritan medium. He asks only 'What good have they done?' and is not satisfied with the reply, that 'They have given innocent pleasure to mankind.'

He tells us that he rejoices in the banishment of the poets, since he has found by the analysis of the soul that they are concerned with the inferior faculties. He means to say that the higher faculties have to do with universals, the lower with particulars of sense. The poets are on a level with their own age, but not on a level with Socrates and Plato; and he was well aware that Homer and Hesiod could not be made a rule of life by any process of legitimate interpretation; his ironical use of them is in fact a denial of their authority; he saw, too, that the poets were not critics—as he says in the Apology, 'Any one was a better interpreter of their writings than they were themselves. He himself ceased to be a poet when he became a disciple of Socrates; though, as he tells us of Solon, 'he might have been one of the greatest of them, if he had not been deterred by other pursuits' (Tim.) Thus from many points of view there is an antagonism between Plato and the poets, which was foreshadowed to him in the old quarrel between philosophy and poetry. The poets, as he says in the Protagoras, were the Sophists of their day; and his dislike of the one class is reflected on the other. He regards them both as the enemies of reasoning and abstraction, though in the case of Euripides more with reference to his immoral sentiments about tyrants and the like. For Plato is the prophet who 'came into the world to convince men'—first of the fallibility of sense and opinion, and secondly of the reality of abstract ideas. Whatever strangeness there may be in modern times in opposing philosophy to poetry, which to us seem to have so many elements in common, the strangeness will disappear if we conceive of poetry as allied to sense, and of philosophy as equivalent to thought and abstraction. Unfortunately the very word 'idea,' which to Plato is expressive of the most real of all things, is associated in our minds with an element of subjectiveness and unreality. We may note also how he differs from Aristotle who declares poetry to be truer than history, for the opposite reason, because it is concerned with universals, not like history, with particulars (Poet).

The things which are seen are opposed in Scripture to the things which are unseen—they are equally opposed in Plato to universals and ideas. To him all particulars appear to be floating about in a world of sense; they have a taint of error or even of evil. There is no difficulty in seeing that this is an illusion; for there is no more error or variation in an individual man, horse, bed, etc., than in the class man, horse, bed, etc.; nor is the truth which is displayed in individual instances less certain than that which is conveyed through the medium of ideas. But Plato, who is deeply impressed with the real importance of universals as instruments of thought, attributes to them an essential truth which is imaginary and unreal; for universals may be often false and particulars true. Had he attained to any clear conception of the individual, which is the synthesis of the universal and the particular; or had he been able to distinguish between opinion and sensation, which the ambiguity of the words (Greek) and the like, tended to confuse, he would not have denied truth to the particulars of sense.

But the poets are also the representatives of falsehood and feigning in all departments of life and knowledge, like the sophists and rhetoricians of the Gorgias and Phaedrus; they are the false priests, false prophets, lying spirits, enchanters of the world. There is another count put into the indictment against them by Plato, that they are the friends of the tyrant, and bask in the sunshine of his patronage. Despotism in all ages has had an apparatus of false ideas and false teachers at its service—in the history of Modern Europe as well as of Greece and Rome. For no government of men depends solely upon force; without some corruption of literature and morals—some appeal to the imagination of the masses—some pretence to the favour of heaven—some element of good giving power to evil, tyranny, even for a short time, cannot be maintained. The Greek tyrants were not insensible to the importance of awakening in their cause a Pseudo-Hellenic feeling; they were proud of successes at the Olympic games; they were not devoid of the love of literature and art. Plato is thinking in the first instance of Greek poets who had graced the courts of Dionysius or Archelaus: and the old spirit of freedom is roused within him at their prostitution of the Tragic Muse in the praises of tyranny. But his prophetic eye extends beyond them to the false teachers of other ages who are the creatures of the government under which they live. He compares the corruption of his contemporaries with the idea of a perfect society, and gathers up into one mass of evil the evils and errors of mankind; to him they are personified in the rhetoricians, sophists, poets, rulers who deceive and govern the world.

A further objection which Plato makes to poetry and the imitative arts is that they excite the emotions. Here the modern reader will be disposed to introduce a distinction which appears to have escaped him. For the emotions are neither bad nor good in themselves, and are not most likely to be controlled by the attempt to eradicate them, but by the moderate indulgence of them. And the vocation of art is to present thought in the form of feeling, to enlist the feelings on the side of reason, to inspire even for a moment courage or resignation; perhaps to suggest a sense of infinity and eternity in a way which mere language is incapable of attaining. True, the same power which in the purer age of art embodies gods and heroes only, may be made to express the voluptuous image of a Corinthian courtezan. But this only shows that art, like other outward things, may be turned to good and also to evil, and is not more closely connected with the higher than with the lower part of the soul. All imitative art is subject to certain limitations, and therefore necessarily partakes of the nature of a compromise. Something of ideal truth is sacrificed for the sake of the representation, and something in the exactness of the representation is sacrificed to the ideal. Still, works of art have a permanent element; they idealize and detain the passing thought, and are the intermediates between sense and ideas.

In the present stage of the human mind, poetry and other forms of fiction may certainly be regarded as a good. But we can also imagine the existence of an age in which a severer conception of truth has either banished or transformed them. At any rate we must admit that they hold a different place at different periods of the world's history. In the infancy of mankind, poetry, with the exception of proverbs, is the whole of literature, and the only instrument of intellectual culture; in modern times she is the shadow or echo of her former self, and appears to have a precarious existence. Milton in his day doubted whether an epic poem was any longer possible. At the same time we must remember, that what Plato would have called the charms of poetry have been partly transferred to prose; he himself (Statesman) admits rhetoric to be the handmaiden of Politics, and proposes to find in the strain of law (Laws) a substitute for the old poets. Among ourselves the creative power seems often to be growing weaker, and scientific fact to be more engrossing and overpowering to the mind than formerly. The illusion of the feelings commonly called love, has hitherto been the inspiring influence of modern poetry and romance, and has exercised a humanizing if not a strengthening influence on the world. But may not the stimulus which love has given to fancy be some day exhausted? The modern English novel which is the most popular of all forms of reading is not more than a century or two old: will the tale of love a hundred years hence, after so many thousand variations of the same theme, be still received with unabated interest?

Art cannot claim to be on a level with philosophy or religion, and may often corrupt them. It is possible to conceive a mental state in which all artistic representations are regarded as a false and imperfect expression, either of the religious ideal or of the philosophical ideal. The fairest forms may be revolting in certain moods of mind, as is proved by the fact that the Mahometans, and many sects of Christians, have renounced the use of pictures and images. The beginning of a great religion, whether Christian or Gentile, has not been 'wood or stone,' but a spirit moving in the hearts of men. The disciples have met in a large upper room or in 'holes and caves of the earth'; in the second or third generation, they have had mosques, temples, churches, monasteries. And the revival or reform of religions, like the first revelation of them, has come from within and has generally disregarded external ceremonies and accompaniments.

But poetry and art may also be the expression of the highest truth and the purest sentiment. Plato himself seems to waver between two opposite views—when, as in the third Book, he insists that youth should be brought up amid wholesome imagery; and again in Book X, when he banishes the poets from his Republic. Admitting that the arts, which some of us almost deify, have fallen short of their higher aim, we must admit on the other hand that to banish imagination wholly would be suicidal as well as impossible. For nature too is a form of art; and a breath of the fresh air or a single glance at the varying landscape would in an instant revive and reillumine the extinguished spark of poetry in the human breast. In the lower stages of civilization imagination more than reason distinguishes man from the animals; and to banish art would be to banish thought, to banish language, to banish the expression of all truth. No religion is wholly devoid of external forms; even the Mahometan who renounces the use of pictures and images has a temple in which he worships the Most High, as solemn and beautiful as any Greek or Christian building. Feeling too and thought are not really opposed; for he who thinks must feel before he can execute. And the highest thoughts, when they become familiarized to us, are always tending to pass into the form of feeling.

Plato does not seriously intend to expel poets from life and society. But he feels strongly the unreality of their writings; he is protesting against the degeneracy of poetry in his own day as we might protest against the want of serious purpose in modern fiction, against the unseemliness or extravagance of some of our poets or novelists, against the time-serving of preachers or public writers, against the regardlessness of truth which to the eye of the philosopher seems to characterize the greater part of the world. For we too have reason to complain that our poets and novelists 'paint inferior truth' and 'are concerned with the inferior part of the soul'; that the readers of them become what they read and are injuriously affected by them. And we look in vain for that healthy atmosphere of which Plato speaks,—'the beauty which meets the sense like a breeze and imperceptibly draws the soul, even in childhood, into harmony with the beauty of reason.'

For there might be a poetry which would be the hymn of divine perfection, the harmony of goodness and truth among men: a strain which should renew the youth of the world, and bring back the ages in which the poet was man's only teacher and best friend,—which would find materials in the living present as well as in the romance of the past, and might subdue to the fairest forms of speech and verse the intractable materials of modern civilisation,—which might elicit the simple principles, or, as Plato would have called them, the essential forms, of truth and justice out of the variety of opinion and the complexity of modern society,—which would preserve all the good of each generation and leave the bad unsung,—which should be based not on vain longings or faint imaginings, but on a clear insight into the nature of man. Then the tale of love might begin again in poetry or prose, two in one, united in the pursuit of knowledge, or the service of God and man; and feelings of love might still be the incentive to great thoughts and heroic deeds as in the days of Dante or Petrarch; and many types of manly and womanly beauty might appear among us, rising above the ordinary level of humanity, and many lives which were like poems (Laws), be not only written, but lived by us. A few such strains have been heard among men in the tragedies of Aeschylus and Sophocles, whom Plato quotes, not, as Homer is quoted by him, in irony, but with deep and serious approval,—in the poetry of Milton and Wordsworth, and in passages of other English poets,—first and above all in the Hebrew prophets and psalmists. Shakespeare has taught us how great men should speak and act; he has drawn characters of a wonderful purity and depth; he has ennobled the human mind, but, like Homer (Rep.), he 'has left no way of life.' The next greatest poet of modern times, Goethe, is concerned with 'a lower degree of truth'; he paints the world as a stage on which 'all the men and women are merely players'; he cultivates life as an art, but he furnishes no ideals of truth and action. The poet may rebel against any attempt to set limits to his fancy; and he may argue truly that moralizing in verse is not poetry. Possibly, like Mephistopheles in Faust, he may retaliate on his adversaries. But the philosopher will still be justified in asking, 'How may the heavenly gift of poesy be devoted to the good of mankind?'

Returning to Plato, we may observe that a similar mixture of truth and error appears in other parts of the argument. He is aware of the absurdity of mankind framing their whole lives according to Homer; just as in the Phaedrus he intimates the absurdity of interpreting mythology upon rational principles; both these were the modern tendencies of his own age, which he deservedly ridicules. On the other hand, his argument that Homer, if he had been able to teach mankind anything worth knowing, would not have been allowed by them to go about begging as a rhapsodist, is both false and contrary to the spirit of Plato (Rep.). It may be compared with those other paradoxes of the Gorgias, that 'No statesman was ever unjustly put to death by the city of which he was the head'; and that 'No Sophist was ever defrauded by his pupils' (Gorg.)...

The argument for immortality seems to rest on the absolute dualism of soul and body. Admitting the existence of the soul, we know of no force which is able to put an end to her. Vice is her own proper evil; and if she cannot be destroyed by that, she cannot be destroyed by any other. Yet Plato has acknowledged that the soul may be so overgrown by the incrustations of earth as to lose her original form; and in the Timaeus he recognizes more strongly than in the Republic the influence which the body has over the mind, denying even the voluntariness of human actions, on the ground that they proceed from physical states (Tim.). In the Republic, as elsewhere, he wavers between the original soul which has to be restored, and the character which is developed by training and education...

The vision of another world is ascribed to Er, the son of Armenius, who is said by Clement of Alexandria to have been Zoroaster. The tale has certainly an oriental character, and may be compared with the pilgrimages of the soul in the Zend Avesta (Haug, Avesta). But no trace of acquaintance with Zoroaster is found elsewhere in Plato's writings, and there is no reason for giving him the name of Er the Pamphylian. The philosophy of Heracleitus cannot be shown to be borrowed from Zoroaster, and still less the myths of Plato.

The local arrangement of the vision is less distinct than that of the Phaedrus and Phaedo. Astronomy is mingled with symbolism and mythology; the great sphere of heaven is represented under the symbol of a cylinder or box, containing the seven orbits of the planets and the fixed stars; this is suspended from an axis or spindle which turns on the knees of Necessity; the revolutions of the seven orbits contained in the cylinder are guided by the fates, and their harmonious motion produces the music of the spheres. Through the innermost or eighth of these, which is the moon, is passed the spindle; but it is doubtful whether this is the continuation of the column of light, from which the pilgrims contemplate the heavens; the words of Plato imply that they are connected, but not the same. The column itself is clearly not of adamant. The spindle (which is of adamant) is fastened to the ends of the chains which extend to the middle of the column of light—this column is said to hold together the heaven; but whether it hangs from the spindle, or is at right angles to it, is not explained. The cylinder containing the orbits of the stars is almost as much a symbol as the figure of Necessity turning the spindle;—for the outermost rim is the sphere of the fixed stars, and nothing is said about the intervals of space which divide the paths of the stars in the heavens. The description is both a picture and an orrery, and therefore is necessarily inconsistent with itself. The column of light is not the Milky Way—which is neither straight, nor like a rainbow—but the imaginary axis of the earth. This is compared to the rainbow in respect not of form but of colour, and not to the undergirders of a trireme, but to the straight rope running from prow to stern in which the undergirders meet.

The orrery or picture of the heavens given in the Republic differs in its mode of representation from the circles of the same and of the other in the Timaeus. In both the fixed stars are distinguished from the planets, and they move in orbits without them, although in an opposite direction: in the Republic as in the Timaeus they are all moving round the axis of the world. But we are not certain that in the former they are moving round the earth. No distinct mention is made in the Republic of the circles of the same and other; although both in the Timaeus and in the Republic the motion of the fixed stars is supposed to coincide with the motion of the whole. The relative thickness of the rims is perhaps designed to express the relative distances of the planets. Plato probably intended to represent the earth, from which Er and his companions are viewing the heavens, as stationary in place; but whether or not herself revolving, unless this is implied in the revolution of the axis, is uncertain (Timaeus). The spectator may be supposed to look at the heavenly bodies, either from above or below. The earth is a sort of earth and heaven in one, like the heaven of the Phaedrus, on the back of which the spectator goes out to take a peep at the stars and is borne round in the revolution. There is no distinction between the equator and the ecliptic. But Plato is no doubt led to imagine that the planets have an opposite motion to that of the fixed stars, in order to account for their appearances in the heavens. In the description of the meadow, and the retribution of the good and evil after death, there are traces of Homer.

The description of the axis as a spindle, and of the heavenly bodies as forming a whole, partly arises out of the attempt to connect the motions of the heavenly bodies with the mythological image of the web, or weaving of the Fates. The giving of the lots, the weaving of them, and the making of them irreversible, which are ascribed to the three Fates—Lachesis, Clotho, Atropos, are obviously derived from their names. The element of chance in human life is indicated by the order of the lots. But chance, however adverse, may be overcome by the wisdom of man, if he knows how to choose aright; there is a worse enemy to man than chance; this enemy is himself. He who was moderately fortunate in the number of the lot—even the very last comer—might have a good life if he chose with wisdom. And as Plato does not like to make an assertion which is unproven, he more than confirms this statement a few sentences afterwards by the example of Odysseus, who chose last. But the virtue which is founded on habit is not sufficient to enable a man to choose; he must add to virtue knowledge, if he is to act rightly when placed in new circumstances. The routine of good actions and good habits is an inferior sort of goodness; and, as Coleridge says, 'Common sense is intolerable which is not based on metaphysics,' so Plato would have said, 'Habit is worthless which is not based upon philosophy.'

The freedom of the will to refuse the evil and to choose the good is distinctly asserted. 'Virtue is free, and as a man honours or dishonours her he will have more or less of her.' The life of man is 'rounded' by necessity; there are circumstances prior to birth which affect him (Pol.). But within the walls of necessity there is an open space in which he is his own master, and can study for himself the effects which the variously compounded gifts of nature or fortune have upon the soul, and act accordingly. All men cannot have the first choice in everything. But the lot of all men is good enough, if they choose wisely and will live diligently.

The verisimilitude which is given to the pilgrimage of a thousand years, by the intimation that Ardiaeus had lived a thousand years before; the coincidence of Er coming to life on the twelfth day after he was supposed to have been dead with the seven days which the pilgrims passed in the meadow, and the four days during which they journeyed to the column of light; the precision with which the soul is mentioned who chose the twentieth lot; the passing remarks that there was no definite character among the souls, and that the souls which had chosen ill blamed any one rather than themselves; or that some of the souls drank more than was necessary of the waters of Forgetfulness, while Er himself was hindered from drinking; the desire of Odysseus to rest at last, unlike the conception of him in Dante and Tennyson; the feigned ignorance of how Er returned to the body, when the other souls went shooting like stars to their birth,—add greatly to the probability of the narrative. They are such touches of nature as the art of Defoe might have introduced when he wished to win credibility for marvels and apparitions.

------------------------------------------------------------------------

There still remain to be considered some points which have been intentionally reserved to the end: (1) the Janus-like character of the Republic, which presents two faces—one an Hellenic state, the other a kingdom of philosophers. Connected with the latter of the two aspects are (2) the paradoxes of the Republic, as they have been termed by Morgenstern: (a) the community of property; (b) of families; (c) the rule of philosophers; (d) the analogy of the individual and the State, which, like some other analogies in the Republic, is carried too far. We may then proceed to consider (3) the subject of education as conceived by Plato, bringing together in a general view the education of youth and the education of after-life; (4) we may note further some essential differences between ancient and modern politics which are suggested by the Republic; (5) we may compare the Politicus and the Laws; (6) we may observe the influence exercised by Plato on his imitators; and (7) take occasion to consider the nature and value of political, and (8) of religious ideals.

1. Plato expressly says that he is intending to found an Hellenic State (Book V). Many of his regulations are characteristically Spartan; such as the prohibition of gold and silver, the common meals of the men, the military training of the youth, the gymnastic exercises of the women. The life of Sparta was the life of a camp (Laws), enforced even more rigidly in time of peace than in war; the citizens of Sparta, like Plato's, were forbidden to trade—they were to be soldiers and not shopkeepers. Nowhere else in Greece was the individual so completely subjected to the State; the time when he was to marry, the education of his children, the clothes which he was to wear, the food which he was to eat, were all prescribed by law. Some of the best enactments in the Republic, such as the reverence to be paid to parents and elders, and some of the worst, such as the exposure of deformed children, are borrowed from the practice of Sparta. The encouragement of friendships between men and youths, or of men with one another, as affording incentives to bravery, is also Spartan; in Sparta too a nearer approach was made than in any other Greek State to equality of the sexes, and to community of property; and while there was probably less of licentiousness in the sense of immorality, the tie of marriage was regarded more lightly than in the rest of Greece. The 'suprema lex' was the preservation of the family, and the interest of the State. The coarse strength of a military government was not favourable to purity and refinement; and the excessive strictness of some regulations seems to have produced a reaction. Of all Hellenes the Spartans were most accessible to bribery; several of the greatest of them might be described in the words of Plato as having a 'fierce secret longing after gold and silver.' Though not in the strict sense communists, the principle of communism was maintained among them in their division of lands, in their common meals, in their slaves, and in the free use of one another's goods. Marriage was a public institution: and the women were educated by the State, and sang and danced in public with the men.

Many traditions were preserved at Sparta of the severity with which the magistrates had maintained the primitive rule of music and poetry; as in the Republic of Plato, the new-fangled poet was to be expelled. Hymns to the Gods, which are the only kind of music admitted into the ideal State, were the only kind which was permitted at Sparta. The Spartans, though an unpoetical race, were nevertheless lovers of poetry; they had been stirred by the Elegiac strains of Tyrtaeus, they had crowded around Hippias to hear his recitals of Homer; but in this they resembled the citizens of the timocratic rather than of the ideal State. The council of elder men also corresponds to the Spartan gerousia; and the freedom with which they are permitted to judge about matters of detail agrees with what we are told of that institution. Once more, the military rule of not spoiling the dead or offering arms at the temples; the moderation in the pursuit of enemies; the importance attached to the physical well-being of the citizens; the use of warfare for the sake of defence rather than of aggression—are features probably suggested by the spirit and practice of Sparta.

To the Spartan type the ideal State reverts in the first decline; and the character of the individual timocrat is borrowed from the Spartan citizen. The love of Lacedaemon not only affected Plato and Xenophon, but was shared by many undistinguished Athenians; there they seemed to find a principle which was wanting in their own democracy. The (Greek) of the Spartans attracted them, that is to say, not the goodness of their laws, but the spirit of order and loyalty which prevailed. Fascinated by the idea, citizens of Athens would imitate the Lacedaemonians in their dress and manners; they were known to the contemporaries of Plato as 'the persons who had their ears bruised,' like the Roundheads of the Commonwealth. The love of another church or country when seen at a distance only, the longing for an imaginary simplicity in civilized times, the fond desire of a past which never has been, or of a future which never will be,—these are aspirations of the human mind which are often felt among ourselves. Such feelings meet with a response in the Republic of Plato.

But there are other features of the Platonic Republic, as, for example, the literary and philosophical education, and the grace and beauty of life, which are the reverse of Spartan. Plato wishes to give his citizens a taste of Athenian freedom as well as of Lacedaemonian discipline. His individual genius is purely Athenian, although in theory he is a lover of Sparta; and he is something more than either—he has also a true Hellenic feeling. He is desirous of humanizing the wars of Hellenes against one another; he acknowledges that the Delphian God is the grand hereditary interpreter of all Hellas. The spirit of harmony and the Dorian mode are to prevail, and the whole State is to have an external beauty which is the reflex of the harmony within. But he has not yet found out the truth which he afterwards enunciated in the Laws—that he was a better legislator who made men to be of one mind, than he who trained them for war. The citizens, as in other Hellenic States, democratic as well as aristocratic, are really an upper class; for, although no mention is made of slaves, the lower classes are allowed to fade away into the distance, and are represented in the individual by the passions. Plato has no idea either of a social State in which all classes are harmonized, or of a federation of Hellas or the world in which different nations or States have a place. His city is equipped for war rather than for peace, and this would seem to be justified by the ordinary condition of Hellenic States. The myth of the earth-born men is an embodiment of the orthodox tradition of Hellas, and the allusion to the four ages of the world is also sanctioned by the authority of Hesiod and the poets. Thus we see that the Republic is partly founded on the ideal of the old Greek polis, partly on the actual circumstances of Hellas in that age. Plato, like the old painters, retains the traditional form, and like them he has also a vision of a city in the clouds.

There is yet another thread which is interwoven in the texture of the work; for the Republic is not only a Dorian State, but a Pythagorean league. The 'way of life' which was connected with the name of Pythagoras, like the Catholic monastic orders, showed the power which the mind of an individual might exercise over his contemporaries, and may have naturally suggested to Plato the possibility of reviving such 'mediaeval institutions.' The Pythagoreans, like Plato, enforced a rule of life and a moral and intellectual training. The influence ascribed to music, which to us seems exaggerated, is also a Pythagorean feature; it is not to be regarded as representing the real influence of music in the Greek world. More nearly than any other government of Hellas, the Pythagorean league of three hundred was an aristocracy of virtue. For once in the history of mankind the philosophy of order or (Greek), expressing and consequently enlisting on its side the combined endeavours of the better part of the people, obtained the management of public affairs and held possession of it for a considerable time (until about B.C. 500). Probably only in States prepared by Dorian institutions would such a league have been possible. The rulers, like Plato's (Greek), were required to submit to a severe training in order to prepare the way for the education of the other members of the community. Long after the dissolution of the Order, eminent Pythagoreans, such as Archytas of Tarentum, retained their political influence over the cities of Magna Graecia. There was much here that was suggestive to the kindred spirit of Plato, who had doubtless meditated deeply on the 'way of life of Pythagoras' (Rep.) and his followers. Slight traces of Pythagoreanism are to be found in the mystical number of the State, in the number which expresses the interval between the king and the tyrant, in the doctrine of transmigration, in the music of the spheres, as well as in the great though secondary importance ascribed to mathematics in education.

But as in his philosophy, so also in the form of his State, he goes far beyond the old Pythagoreans. He attempts a task really impossible, which is to unite the past of Greek history with the future of philosophy, analogous to that other impossibility, which has often been the dream of Christendom, the attempt to unite the past history of Europe with the kingdom of Christ. Nothing actually existing in the world at all resembles Plato's ideal State; nor does he himself imagine that such a State is possible. This he repeats again and again; e.g. in the Republic, or in the Laws where, casting a glance back on the Republic, he admits that the perfect state of communism and philosophy was impossible in his own age, though still to be retained as a pattern. The same doubt is implied in the earnestness with which he argues in the Republic that ideals are none the worse because they cannot be realized in fact, and in the chorus of laughter, which like a breaking wave will, as he anticipates, greet the mention of his proposals; though like other writers of fiction, he uses all his art to give reality to his inventions. When asked how the ideal polity can come into being, he answers ironically, 'When one son of a king becomes a philosopher'; he designates the fiction of the earth-born men as 'a noble lie'; and when the structure is finally complete, he fairly tells you that his Republic is a vision only, which in some sense may have reality, but not in the vulgar one of a reign of philosophers upon earth. It has been said that Plato flies as well as walks, but this falls short of the truth; for he flies and walks at the same time, and is in the air and on firm ground in successive instants.

Niebuhr has asked a trifling question, which may be briefly noticed in this place—Was Plato a good citizen? If by this is meant, Was he loyal to Athenian institutions?—he can hardly be said to be the friend of democracy: but neither is he the friend of any other existing form of government; all of them he regarded as 'states of faction' (Laws); none attained to his ideal of a voluntary rule over voluntary subjects, which seems indeed more nearly to describe democracy than any other; and the worst of them is tyranny. The truth is, that the question has hardly any meaning when applied to a great philosopher whose writings are not meant for a particular age and country, but for all time and all mankind. The decline of Athenian politics was probably the motive which led Plato to frame an ideal State, and the Republic may be regarded as reflecting the departing glory of Hellas. As well might we complain of St. Augustine, whose great work 'The City of God' originated in a similar motive, for not being loyal to the Roman Empire. Even a nearer parallel might be afforded by the first Christians, who cannot fairly be charged with being bad citizens because, though 'subject to the higher powers,' they were looking forward to a city which is in heaven.

2. The idea of the perfect State is full of paradox when judged of according to the ordinary notions of mankind. The paradoxes of one age have been said to become the commonplaces of the next; but the paradoxes of Plato are at least as paradoxical to us as they were to his contemporaries. The modern world has either sneered at them as absurd, or denounced them as unnatural and immoral; men have been pleased to find in Aristotle's criticisms of them the anticipation of their own good sense. The wealthy and cultivated classes have disliked and also dreaded them; they have pointed with satisfaction to the failure of efforts to realize them in practice. Yet since they are the thoughts of one of the greatest of human intelligences, and of one who had done most to elevate morality and religion, they seem to deserve a better treatment at our hands. We may have to address the public, as Plato does poetry, and assure them that we mean no harm to existing institutions. There are serious errors which have a side of truth and which therefore may fairly demand a careful consideration: there are truths mixed with error of which we may indeed say, 'The half is better than the whole.' Yet 'the half' may be an important contribution to the study of human nature.

(a) The first paradox is the community of goods, which is mentioned slightly at the end of the third Book, and seemingly, as Aristotle observes, is confined to the guardians; at least no mention is made of the other classes. But the omission is not of any real significance, and probably arises out of the plan of the work, which prevents the writer from entering into details.

Aristotle censures the community of property much in the spirit of modern political economy, as tending to repress industry, and as doing away with the spirit of benevolence. Modern writers almost refuse to consider the subject, which is supposed to have been long ago settled by the common opinion of mankind. But it must be remembered that the sacredness of property is a notion far more fixed in modern than in ancient times. The world has grown older, and is therefore more conservative. Primitive society offered many examples of land held in common, either by a tribe or by a township, and such may probably have been the original form of landed tenure. Ancient legislators had invented various modes of dividing and preserving the divisions of land among the citizens; according to Aristotle there were nations who held the land in common and divided the produce, and there were others who divided the land and stored the produce in common. The evils of debt and the inequality of property were far greater in ancient than in modern times, and the accidents to which property was subject from war, or revolution, or taxation, or other legislative interference, were also greater. All these circumstances gave property a less fixed and sacred character. The early Christians are believed to have held their property in common, and the principle is sanctioned by the words of Christ himself, and has been maintained as a counsel of perfection in almost all ages of the Church. Nor have there been wanting instances of modern enthusiasts who have made a religion of communism; in every age of religious excitement notions like Wycliffe's 'inheritance of grace' have tended to prevail. A like spirit, but fiercer and more violent, has appeared in politics. 'The preparation of the Gospel of peace' soon becomes the red flag of Republicanism.

We can hardly judge what effect Plato's views would have upon his own contemporaries; they would perhaps have seemed to them only an exaggeration of the Spartan commonwealth. Even modern writers would acknowledge that the right of private property is based on expediency, and may be interfered with in a variety of ways for the public good. Any other mode of vesting property which was found to be more advantageous, would in time acquire the same basis of right; 'the most useful,' in Plato's words, 'would be the most sacred.' The lawyers and ecclesiastics of former ages would have spoken of property as a sacred institution. But they only meant by such language to oppose the greatest amount of resistance to any invasion of the rights of individuals and of the Church.

When we consider the question, without any fear of immediate application to practice, in the spirit of Plato's Republic, are we quite sure that the received notions of property are the best? Is the distribution of wealth which is customary in civilized countries the most favourable that can be conceived for the education and development of the mass of mankind? Can 'the spectator of all time and all existence' be quite convinced that one or two thousand years hence, great changes will not have taken place in the rights of property, or even that the very notion of property, beyond what is necessary for personal maintenance, may not have disappeared? This was a distinction familiar to Aristotle, though likely to be laughed at among ourselves. Such a change would not be greater than some other changes through which the world has passed in the transition from ancient to modern society, for example, the emancipation of the serfs in Russia, or the abolition of slavery in America and the West Indies; and not so great as the difference which separates the Eastern village community from the Western world. To accomplish such a revolution in the course of a few centuries, would imply a rate of progress not more rapid than has actually taken place during the last fifty or sixty years. The kingdom of Japan underwent more change in five or six years than Europe in five or six hundred. Many opinions and beliefs which have been cherished among ourselves quite as strongly as the sacredness of property have passed away; and the most untenable propositions respecting the right of bequests or entail have been maintained with as much fervour as the most moderate. Some one will be heard to ask whether a state of society can be final in which the interests of thousands are perilled on the life or character of a single person. And many will indulge the hope that our present condition may, after all, be only transitional, and may conduct to a higher, in which property, besides ministering to the enjoyment of the few, may also furnish the means of the highest culture to all, and will be a greater benefit to the public generally, and also more under the control of public authority. There may come a time when the saying, 'Have I not a right to do what I will with my own?' will appear to be a barbarous relic of individualism;—when the possession of a part may be a greater blessing to each and all than the possession of the whole is now to any one.

Such reflections appear visionary to the eye of the practical statesman, but they are within the range of possibility to the philosopher. He can imagine that in some distant age or clime, and through the influence of some individual, the notion of common property may or might have sunk as deep into the heart of a race, and have become as fixed to them, as private property is to ourselves. He knows that this latter institution is not more than four or five thousand years old: may not the end revert to the beginning? In our own age even Utopias affect the spirit of legislation, and an abstract idea may exercise a great influence on practical politics.

The objections that would be generally urged against Plato's community of property, are the old ones of Aristotle, that motives for exertion would be taken away, and that disputes would arise when each was dependent upon all. Every man would produce as little and consume as much as he liked. The experience of civilized nations has hitherto been adverse to Socialism. The effort is too great for human nature; men try to live in common, but the personal feeling is always breaking in. On the other hand it may be doubted whether our present notions of property are not conventional, for they differ in different countries and in different states of society. We boast of an individualism which is not freedom, but rather an artificial result of the industrial state of modern Europe. The individual is nominally free, but he is also powerless in a world bound hand and foot in the chains of economic necessity. Even if we cannot expect the mass of mankind to become disinterested, at any rate we observe in them a power of organization which fifty years ago would never have been suspected. The same forces which have revolutionized the political system of Europe, may effect a similar change in the social and industrial relations of mankind. And if we suppose the influence of some good as well as neutral motives working in the community, there will be no absurdity in expecting that the mass of mankind having power, and becoming enlightened about the higher possibilities of human life, when they learn how much more is attainable for all than is at present the possession of a favoured few, may pursue the common interest with an intelligence and persistency which mankind have hitherto never seen.

Now that the world has once been set in motion, and is no longer held fast under the tyranny of custom and ignorance; now that criticism has pierced the veil of tradition and the past no longer overpowers the present,—the progress of civilization may be expected to be far greater and swifter than heretofore. Even at our present rate of speed the point at which we may arrive in two or three generations is beyond the power of imagination to foresee. There are forces in the world which work, not in an arithmetical, but in a geometrical ratio of increase. Education, to use the expression of Plato, moves like a wheel with an ever-multiplying rapidity. Nor can we say how great may be its influence, when it becomes universal,—when it has been inherited by many generations,—when it is freed from the trammels of superstition and rightly adapted to the wants and capacities of different classes of men and women. Neither do we know how much more the co-operation of minds or of hands may be capable of accomplishing, whether in labour or in study. The resources of the natural sciences are not half-developed as yet; the soil of the earth, instead of growing more barren, may become many times more fertile than hitherto; the uses of machinery far greater, and also more minute than at present. New secrets of physiology may be revealed, deeply affecting human nature in its innermost recesses. The standard of health may be raised and the lives of men prolonged by sanitary and medical knowledge. There may be peace, there may be leisure, there may be innocent refreshments of many kinds. The ever-increasing power of locomotion may join the extremes of earth. There may be mysterious workings of the human mind, such as occur only at great crises of history. The East and the West may meet together, and all nations may contribute their thoughts and their experience to the common stock of humanity. Many other elements enter into a speculation of this kind. But it is better to make an end of them. For such reflections appear to the majority far-fetched, and to men of science, commonplace.

(b) Neither to the mind of Plato nor of Aristotle did the doctrine of community of property present at all the same difficulty, or appear to be the same violation of the common Hellenic sentiment, as the community of wives and children. This paradox he prefaces by another proposal, that the occupations of men and women shall be the same, and that to this end they shall have a common training and education. Male and female animals have the same pursuits—why not also the two sexes of man?

But have we not here fallen into a contradiction? for we were saying that different natures should have different pursuits. How then can men and women have the same? And is not the proposal inconsistent with our notion of the division of labour?—These objections are no sooner raised than answered; for, according to Plato, there is no organic difference between men and women, but only the accidental one that men beget and women bear children. Following the analogy of the other animals, he contends that all natural gifts are scattered about indifferently among both sexes, though there may be a superiority of degree on the part of the men. The objection on the score of decency to their taking part in the same gymnastic exercises, is met by Plato's assertion that the existing feeling is a matter of habit.

That Plato should have emancipated himself from the ideas of his own country and from the example of the East, shows a wonderful independence of mind. He is conscious that women are half the human race, in some respects the more important half (Laws); and for the sake both of men and women he desires to raise the woman to a higher level of existence. He brings, not sentiment, but philosophy to bear upon a question which both in ancient and modern times has been chiefly regarded in the light of custom or feeling. The Greeks had noble conceptions of womanhood in the goddesses Athene and Artemis, and in the heroines Antigone and Andromache. But these ideals had no counterpart in actual life. The Athenian woman was in no way the equal of her husband; she was not the entertainer of his guests or the mistress of his house, but only his housekeeper and the mother of his children. She took no part in military or political matters; nor is there any instance in the later ages of Greece of a woman becoming famous in literature. 'Hers is the greatest glory who has the least renown among men,' is the historian's conception of feminine excellence. A very different ideal of womanhood is held up by Plato to the world; she is to be the companion of the man, and to share with him in the toils of war and in the cares of government. She is to be similarly trained both in bodily and mental exercises. She is to lose as far as possible the incidents of maternity and the characteristics of the female sex.

The modern antagonist of the equality of the sexes would argue that the differences between men and women are not confined to the single point urged by Plato; that sensibility, gentleness, grace, are the qualities of women, while energy, strength, higher intelligence, are to be looked for in men. And the criticism is just: the differences affect the whole nature, and are not, as Plato supposes, confined to a single point. But neither can we say how far these differences are due to education and the opinions of mankind, or physically inherited from the habits and opinions of former generations. Women have been always taught, not exactly that they are slaves, but that they are in an inferior position, which is also supposed to have compensating advantages; and to this position they have conformed. It is also true that the physical form may easily change in the course of generations through the mode of life; and the weakness or delicacy, which was once a matter of opinion, may become a physical fact. The characteristics of sex vary greatly in different countries and ranks of society, and at different ages in the same individuals. Plato may have been right in denying that there was any ultimate difference in the sexes of man other than that which exists in animals, because all other differences may be conceived to disappear in other states of society, or under different circumstances of life and training.

The first wave having been passed, we proceed to the second—community of wives and children. 'Is it possible? Is it desirable?' For as Glaucon intimates, and as we far more strongly insist, 'Great doubts may be entertained about both these points.' Any free discussion of the question is impossible, and mankind are perhaps right in not allowing the ultimate bases of social life to be examined. Few of us can safely enquire into the things which nature hides, any more than we can dissect our own bodies. Still, the manner in which Plato arrived at his conclusions should be considered. For here, as Mr. Grote has remarked, is a wonderful thing, that one of the wisest and best of men should have entertained ideas of morality which are wholly at variance with our own. And if we would do Plato justice, we must examine carefully the character of his proposals. First, we may observe that the relations of the sexes supposed by him are the reverse of licentious: he seems rather to aim at an impossible strictness. Secondly, he conceives the family to be the natural enemy of the state; and he entertains the serious hope that an universal brotherhood may take the place of private interests—an aspiration which, although not justified by experience, has possessed many noble minds. On the other hand, there is no sentiment or imagination in the connections which men and women are supposed by him to form; human beings return to the level of the animals, neither exalting to heaven, nor yet abusing the natural instincts. All that world of poetry and fancy which the passion of love has called forth in modern literature and romance would have been banished by Plato. The arrangements of marriage in the Republic are directed to one object—the improvement of the race. In successive generations a great development both of bodily and mental qualities might be possible. The analogy of animals tends to show that mankind can within certain limits receive a change of nature. And as in animals we should commonly choose the best for breeding, and destroy the others, so there must be a selection made of the human beings whose lives are worthy to be preserved.

We start back horrified from this Platonic ideal, in the belief, first, that the higher feelings of humanity are far too strong to be crushed out; secondly, that if the plan could be carried into execution we should be poorly recompensed by improvements in the breed for the loss of the best things in life. The greatest regard for the weakest and meanest of human beings—the infant, the criminal, the insane, the idiot, truly seems to us one of the noblest results of Christianity. We have learned, though as yet imperfectly, that the individual man has an endless value in the sight of God, and that we honour Him when we honour the darkened and disfigured image of Him (Laws). This is the lesson which Christ taught in a parable when He said, 'Their angels do always behold the face of My Father which is in heaven.' Such lessons are only partially realized in any age; they were foreign to the age of Plato, as they have very different degrees of strength in different countries or ages of the Christian world. To the Greek the family was a religious and customary institution binding the members together by a tie inferior in strength to that of friendship, and having a less solemn and sacred sound than that of country. The relationship which existed on the lower level of custom, Plato imagined that he was raising to the higher level of nature and reason; while from the modern and Christian point of view we regard him as sanctioning murder and destroying the first principles of morality.

The great error in these and similar speculations is that the difference between man and the animals is forgotten in them. The human being is regarded with the eye of a dog- or bird-fancier, or at best of a slave-owner; the higher or human qualities are left out. The breeder of animals aims chiefly at size or speed or strength; in a few cases at courage or temper; most often the fitness of the animal for food is the great desideratum. But mankind are not bred to be eaten, nor yet for their superiority in fighting or in running or in drawing carts. Neither does the improvement of the human race consist merely in the increase of the bones and flesh, but in the growth and enlightenment of the mind. Hence there must be 'a marriage of true minds' as well as of bodies, of imagination and reason as well as of lusts and instincts. Men and women without feeling or imagination are justly called brutes; yet Plato takes away these qualities and puts nothing in their place, not even the desire of a noble offspring, since parents are not to know their own children. The most important transaction of social life, he who is the idealist philosopher converts into the most brutal. For the pair are to have no relation to one another, except at the hymeneal festival; their children are not theirs, but the state's; nor is any tie of affection to unite them. Yet here the analogy of the animals might have saved Plato from a gigantic error, if he had 'not lost sight of his own illustration.' For the 'nobler sort of birds and beasts' nourish and protect their offspring and are faithful to one another.

An eminent physiologist thinks it worth while 'to try and place life on a physical basis.' But should not life rest on the moral rather than upon the physical? The higher comes first, then the lower, first the human and rational, afterwards the animal. Yet they are not absolutely divided; and in times of sickness or moments of self-indulgence they seem to be only different aspects of a common human nature which includes them both. Neither is the moral the limit of the physical, but the expansion and enlargement of it,—the highest form which the physical is capable of receiving. As Plato would say, the body does not take care of the body, and still less of the mind, but the mind takes care of both. In all human action not that which is common to man and the animals is the characteristic element, but that which distinguishes him from them. Even if we admit the physical basis, and resolve all virtue into health of body 'la facon que notre sang circule,' still on merely physical grounds we must come back to ideas. Mind and reason and duty and conscience, under these or other names, are always reappearing. There cannot be health of body without health of mind; nor health of mind without the sense of duty and the love of truth (Charm).

That the greatest of ancient philosophers should in his regulations about marriage have fallen into the error of separating body and mind, does indeed appear surprising. Yet the wonder is not so much that Plato should have entertained ideas of morality which to our own age are revolting, but that he should have contradicted himself to an extent which is hardly credible, falling in an instant from the heaven of idealism into the crudest animalism. Rejoicing in the newly found gift of reflection, he appears to have thought out a subject about which he had better have followed the enlightened feeling of his own age. The general sentiment of Hellas was opposed to his monstrous fancy. The old poets, and in later time the tragedians, showed no want of respect for the family, on which much of their religion was based. But the example of Sparta, and perhaps in some degree the tendency to defy public opinion, seems to have misled him. He will make one family out of all the families of the state. He will select the finest specimens of men and women and breed from these only.

Yet because the illusion is always returning (for the animal part of human nature will from time to time assert itself in the disguise of philosophy as well as of poetry), and also because any departure from established morality, even where this is not intended, is apt to be unsettling, it may be worth while to draw out a little more at length the objections to the Platonic marriage. In the first place, history shows that wherever polygamy has been largely allowed the race has deteriorated. One man to one woman is the law of God and nature. Nearly all the civilized peoples of the world at some period before the age of written records, have become monogamists; and the step when once taken has never been retraced. The exceptions occurring among Brahmins or Mahometans or the ancient Persians, are of that sort which may be said to prove the rule. The connexions formed between superior and inferior races hardly ever produce a noble offspring, because they are licentious; and because the children in such cases usually despise the mother and are neglected by the father who is ashamed of them. Barbarous nations when they are introduced by Europeans to vice die out; polygamist peoples either import and adopt children from other countries, or dwindle in numbers, or both. Dynasties and aristocracies which have disregarded the laws of nature have decreased in numbers and degenerated in stature; 'mariages de convenance' leave their enfeebling stamp on the offspring of them (King Lear). The marriage of near relations, or the marrying in and in of the same family tends constantly to weakness or idiocy in the children, sometimes assuming the form as they grow older of passionate licentiousness. The common prostitute rarely has any offspring. By such unmistakable evidence is the authority of morality asserted in the relations of the sexes: and so many more elements enter into this 'mystery' than are dreamed of by Plato and some other philosophers.

Recent enquirers have indeed arrived at the conclusion that among primitive tribes there existed a community of wives as of property, and that the captive taken by the spear was the only wife or slave whom any man was permitted to call his own. The partial existence of such customs among some of the lower races of man, and the survival of peculiar ceremonies in the marriages of some civilized nations, are thought to furnish a proof of similar institutions having been once universal. There can be no question that the study of anthropology has considerably changed our views respecting the first appearance of man upon the earth. We know more about the aborigines of the world than formerly, but our increasing knowledge shows above all things how little we know. With all the helps which written monuments afford, we do but faintly realize the condition of man two thousand or three thousand years ago. Of what his condition was when removed to a distance 200,000 or 300,000 years, when the majority of mankind were lower and nearer the animals than any tribe now existing upon the earth, we cannot even entertain conjecture. Plato (Laws) and Aristotle (Metaph.) may have been more right than we imagine in supposing that some forms of civilisation were discovered and lost several times over. If we cannot argue that all barbarism is a degraded civilization, neither can we set any limits to the depth of degradation to which the human race may sink through war, disease, or isolation. And if we are to draw inferences about the origin of marriage from the practice of barbarous nations, we should also consider the remoter analogy of the animals. Many birds and animals, especially the carnivorous, have only one mate, and the love and care of offspring which seems to be natural is inconsistent with the primitive theory of marriage. If we go back to an imaginary state in which men were almost animals and the companions of them, we have as much right to argue from what is animal to what is human as from the barbarous to the civilized man. The record of animal life on the globe is fragmentary,—the connecting links are wanting and cannot be supplied; the record of social life is still more fragmentary and precarious. Even if we admit that our first ancestors had no such institution as marriage, still the stages by which men passed from outer barbarism to the comparative civilization of China, Assyria, and Greece, or even of the ancient Germans, are wholly unknown to us.

Such speculations are apt to be unsettling, because they seem to show that an institution which was thought to be a revelation from heaven, is only the growth of history and experience. We ask what is the origin of marriage, and we are told that like the right of property, after many wars and contests, it has gradually arisen out of the selfishness of barbarians. We stand face to face with human nature in its primitive nakedness. We are compelled to accept, not the highest, but the lowest account of the origin of human society. But on the other hand we may truly say that every step in human progress has been in the same direction, and that in the course of ages the idea of marriage and of the family has been more and more defined and consecrated. The civilized East is immeasurably in advance of any savage tribes; the Greeks and Romans have improved upon the East; the Christian nations have been stricter in their views of the marriage relation than any of the ancients. In this as in so many other things, instead of looking back with regret to the past, we should look forward with hope to the future. We must consecrate that which we believe to be the most holy, and that 'which is the most holy will be the most useful.' There is more reason for maintaining the sacredness of the marriage tie, when we see the benefit of it, than when we only felt a vague religious horror about the violation of it. But in all times of transition, when established beliefs are being undermined, there is a danger that in the passage from the old to the new we may insensibly let go the moral principle, finding an excuse for listening to the voice of passion in the uncertainty of knowledge, or the fluctuations of opinion. And there are many persons in our own day who, enlightened by the study of anthropology, and fascinated by what is new and strange, some using the language of fear, others of hope, are inclined to believe that a time will come when through the self-assertion of women, or the rebellious spirit of children, by the analysis of human relations, or by the force of outward circumstances, the ties of family life may be broken or greatly relaxed. They point to societies in America and elsewhere which tend to show that the destruction of the family need not necessarily involve the overthrow of all morality. Wherever we may think of such speculations, we can hardly deny that they have been more rife in this generation than in any other; and whither they are tending, who can predict?

To the doubts and queries raised by these 'social reformers' respecting the relation of the sexes and the moral nature of man, there is a sufficient answer, if any is needed. The difference about them and us is really one of fact. They are speaking of man as they wish or fancy him to be, but we are speaking of him as he is. They isolate the animal part of his nature; we regard him as a creature having many sides, or aspects, moving between good and evil, striving to rise above himself and to become 'a little lower than the angels.' We also, to use a Platonic formula, are not ignorant of the dissatisfactions and incompatibilities of family life, of the meannesses of trade, of the flatteries of one class of society by another, of the impediments which the family throws in the way of lofty aims and aspirations. But we are conscious that there are evils and dangers in the background greater still, which are not appreciated, because they are either concealed or suppressed. What a condition of man would that be, in which human passions were controlled by no authority, divine or human, in which there was no shame or decency, no higher affection overcoming or sanctifying the natural instincts, but simply a rule of health! Is it for this that we are asked to throw away the civilization which is the growth of ages?

For strength and health are not the only qualities to be desired; there are the more important considerations of mind and character and soul. We know how human nature may be degraded; we do not know how by artificial means any improvement in the breed can be effected. The problem is a complex one, for if we go back only four steps (and these at least enter into the composition of a child), there are commonly thirty progenitors to be taken into account. Many curious facts, rarely admitting of proof, are told us respecting the inheritance of disease or character from a remote ancestor. We can trace the physical resemblances of parents and children in the same family—

'Sic oculos, sic ille manus, sic ora ferebat';

but scarcely less often the differences which distinguish children both from their parents and from one another. We are told of similar mental peculiarities running in families, and again of a tendency, as in the animals, to revert to a common or original stock. But we have a difficulty in distinguishing what is a true inheritance of genius or other qualities, and what is mere imitation or the result of similar circumstances. Great men and great women have rarely had great fathers and mothers. Nothing that we know of in the circumstances of their birth or lineage will explain their appearance. Of the English poets of the last and two preceding centuries scarcely a descendant remains,—none have ever been distinguished. So deeply has nature hidden her secret, and so ridiculous is the fancy which has been entertained by some that we might in time by suitable marriage arrangements or, as Plato would have said, 'by an ingenious system of lots,' produce a Shakespeare or a Milton. Even supposing that we could breed men having the tenacity of bulldogs, or, like the Spartans, 'lacking the wit to run away in battle,' would the world be any the better? Many of the noblest specimens of the human race have been among the weakest physically. Tyrtaeus or Aesop, or our own Newton, would have been exposed at Sparta; and some of the fairest and strongest men and women have been among the wickedest and worst. Not by the Platonic device of uniting the strong and fair with the strong and fair, regardless of sentiment and morality, nor yet by his other device of combining dissimilar natures (Statesman), have mankind gradually passed from the brutality and licentiousness of primitive marriage to marriage Christian and civilized.

Few persons would deny that we bring into the world an inheritance of mental and physical qualities derived first from our parents, or through them from some remoter ancestor, secondly from our race, thirdly from the general condition of mankind into which we are born. Nothing is commoner than the remark, that 'So and so is like his father or his uncle'; and an aged person may not unfrequently note a resemblance in a youth to a long-forgotten ancestor, observing that 'Nature sometimes skips a generation.' It may be true also, that if we knew more about our ancestors, these similarities would be even more striking to us. Admitting the facts which are thus described in a popular way, we may however remark that there is no method of difference by which they can be defined or estimated, and that they constitute only a small part of each individual. The doctrine of heredity may seem to take out of our hands the conduct of our own lives, but it is the idea, not the fact, which is really terrible to us. For what we have received from our ancestors is only a fraction of what we are, or may become. The knowledge that drunkenness or insanity has been prevalent in a family may be the best safeguard against their recurrence in a future generation. The parent will be most awake to the vices or diseases in his child of which he is most sensible within himself. The whole of life may be directed to their prevention or cure. The traces of consumption may become fainter, or be wholly effaced: the inherent tendency to vice or crime may be eradicated. And so heredity, from being a curse, may become a blessing. We acknowledge that in the matter of our birth, as in our nature generally, there are previous circumstances which affect us. But upon this platform of circumstances or within this wall of necessity, we have still the power of creating a life for ourselves by the informing energy of the human will.

There is another aspect of the marriage question to which Plato is a stranger. All the children born in his state are foundlings. It never occurred to him that the greater part of them, according to universal experience, would have perished. For children can only be brought up in families. There is a subtle sympathy between the mother and the child which cannot be supplied by other mothers, or by 'strong nurses one or more' (Laws). If Plato's 'pen' was as fatal as the Creches of Paris, or the foundling hospital of Dublin, more than nine-tenths of his children would have perished. There would have been no need to expose or put out of the way the weaklier children, for they would have died of themselves. So emphatically does nature protest against the destruction of the family.

What Plato had heard or seen of Sparta was applied by him in a mistaken way to his ideal commonwealth. He probably observed that both the Spartan men and women were superior in form and strength to the other Greeks; and this superiority he was disposed to attribute to the laws and customs relating to marriage. He did not consider that the desire of a noble offspring was a passion among the Spartans, or that their physical superiority was to be attributed chiefly, not to their marriage customs, but to their temperance and training. He did not reflect that Sparta was great, not in consequence of the relaxation of morality, but in spite of it, by virtue of a political principle stronger far than existed in any other Grecian state. Least of all did he observe that Sparta did not really produce the finest specimens of the Greek race. The genius, the political inspiration of Athens, the love of liberty—all that has made Greece famous with posterity, were wanting among the Spartans. They had no Themistocles, or Pericles, or Aeschylus, or Sophocles, or Socrates, or Plato. The individual was not allowed to appear above the state; the laws were fixed, and he had no business to alter or reform them. Yet whence has the progress of cities and nations arisen, if not from remarkable individuals, coming into the world we know not how, and from causes over which we have no control? Something too much may have been said in modern times of the value of individuality. But we can hardly condemn too strongly a system which, instead of fostering the scattered seeds or sparks of genius and character, tends to smother and extinguish them.

Still, while condemning Plato, we must acknowledge that neither Christianity, nor any other form of religion and society, has hitherto been able to cope with this most difficult of social problems, and that the side from which Plato regarded it is that from which we turn away. Population is the most untameable force in the political and social world. Do we not find, especially in large cities, that the greatest hindrance to the amelioration of the poor is their improvidence in marriage?—a small fault truly, if not involving endless consequences. There are whole countries too, such as India, or, nearer home, Ireland, in which a right solution of the marriage question seems to lie at the foundation of the happiness of the community. There are too many people on a given space, or they marry too early and bring into the world a sickly and half-developed offspring; or owing to the very conditions of their existence, they become emaciated and hand on a similar life to their descendants. But who can oppose the voice of prudence to the 'mightiest passions of mankind' (Laws), especially when they have been licensed by custom and religion? In addition to the influences of education, we seem to require some new principles of right and wrong in these matters, some force of opinion, which may indeed be already heard whispering in private, but has never affected the moral sentiments of mankind in general. We unavoidably lose sight of the principle of utility, just in that action of our lives in which we have the most need of it. The influences which we can bring to bear upon this question are chiefly indirect. In a generation or two, education, emigration, improvements in agriculture and manufactures, may have provided the solution. The state physician hardly likes to probe the wound: it is beyond his art; a matter which he cannot safely let alone, but which he dare not touch:

'We do but skin and film the ulcerous place.'

When again in private life we see a whole family one by one dropping into the grave under the Ate of some inherited malady, and the parents perhaps surviving them, do our minds ever go back silently to that day twenty-five or thirty years before on which under the fairest auspices, amid the rejoicings of friends and acquaintances, a bride and bridegroom joined hands with one another? In making such a reflection we are not opposing physical considerations to moral, but moral to physical; we are seeking to make the voice of reason heard, which drives us back from the extravagance of sentimentalism on common sense. The late Dr. Combe is said by his biographer to have resisted the temptation to marriage, because he knew that he was subject to hereditary consumption. One who deserved to be called a man of genius, a friend of my youth, was in the habit of wearing a black ribbon on his wrist, in order to remind him that, being liable to outbreaks of insanity, he must not give way to the natural impulses of affection: he died unmarried in a lunatic asylum. These two little facts suggest the reflection that a very few persons have done from a sense of duty what the rest of mankind ought to have done under like circumstances, if they had allowed themselves to think of all the misery which they were about to bring into the world. If we could prevent such marriages without any violation of feeling or propriety, we clearly ought; and the prohibition in the course of time would be protected by a 'horror naturalis' similar to that which, in all civilized ages and countries, has prevented the marriage of near relations by blood. Mankind would have been the happier, if some things which are now allowed had from the beginning been denied to them; if the sanction of religion could have prohibited practices inimical to health; if sanitary principles could in early ages have been invested with a superstitious awe. But, living as we do far on in the world's history, we are no longer able to stamp at once with the impress of religion a new prohibition. A free agent cannot have his fancies regulated by law; and the execution of the law would be rendered impossible, owing to the uncertainty of the cases in which marriage was to be forbidden. Who can weigh virtue, or even fortune against health, or moral and mental qualities against bodily? Who can measure probabilities against certainties? There has been some good as well as evil in the discipline of suffering; and there are diseases, such as consumption, which have exercised a refining and softening influence on the character. Youth is too inexperienced to balance such nice considerations; parents do not often think of them, or think of them too late. They are at a distance and may probably be averted; change of place, a new state of life, the interests of a home may be the cure of them. So persons vainly reason when their minds are already made up and their fortunes irrevocably linked together. Nor is there any ground for supposing that marriages are to any great extent influenced by reflections of this sort, which seem unable to make any head against the irresistible impulse of individual attachment.

Lastly, no one can have observed the first rising flood of the passions in youth, the difficulty of regulating them, and the effects on the whole mind and nature which follow from them, the stimulus which is given to them by the imagination, without feeling that there is something unsatisfactory in our method of treating them. That the most important influence on human life should be wholly left to chance or shrouded in mystery, and instead of being disciplined or understood, should be required to conform only to an external standard of propriety—cannot be regarded by the philosopher as a safe or satisfactory condition of human things. And still those who have the charge of youth may find a way by watchfulness, by affection, by the manliness and innocence of their own lives, by occasional hints, by general admonitions which every one can apply for himself, to mitigate this terrible evil which eats out the heart of individuals and corrupts the moral sentiments of nations. In no duty towards others is there more need of reticence and self-restraint. So great is the danger lest he who would be the counsellor of another should reveal the secret prematurely, lest he should get another too much into his power; or fix the passing impression of evil by demanding the confession of it.

Nor is Plato wrong in asserting that family attachments may interfere with higher aims. If there have been some who 'to party gave up what was meant for mankind,' there have certainly been others who to family gave up what was meant for mankind or for their country. The cares of children, the necessity of procuring money for their support, the flatteries of the rich by the poor, the exclusiveness of caste, the pride of birth or wealth, the tendency of family life to divert men from the pursuit of the ideal or the heroic, are as lowering in our own age as in that of Plato. And if we prefer to look at the gentle influences of home, the development of the affections, the amenities of society, the devotion of one member of a family for the good of the others, which form one side of the picture, we must not quarrel with him, or perhaps ought rather to be grateful to him, for having presented to us the reverse. Without attempting to defend Plato on grounds of morality, we may allow that there is an aspect of the world which has not unnaturally led him into error.

We hardly appreciate the power which the idea of the State, like all other abstract ideas, exercised over the mind of Plato. To us the State seems to be built up out of the family, or sometimes to be the framework in which family and social life is contained. But to Plato in his present mood of mind the family is only a disturbing influence which, instead of filling up, tends to disarrange the higher unity of the State. No organization is needed except a political, which, regarded from another point of view, is a military one. The State is all-sufficing for the wants of man, and, like the idea of the Church in later ages, absorbs all other desires and affections. In time of war the thousand citizens are to stand like a rampart impregnable against the world or the Persian host; in time of peace the preparation for war and their duties to the State, which are also their duties to one another, take up their whole life and time. The only other interest which is allowed to them besides that of war, is the interest of philosophy. When they are too old to be soldiers they are to retire from active life and to have a second novitiate of study and contemplation. There is an element of monasticism even in Plato's communism. If he could have done without children, he might have converted his Republic into a religious order. Neither in the Laws, when the daylight of common sense breaks in upon him, does he retract his error. In the state of which he would be the founder, there is no marrying or giving in marriage: but because of the infirmity of mankind, he condescends to allow the law of nature to prevail.

(c) But Plato has an equal, or, in his own estimation, even greater paradox in reserve, which is summed up in the famous text, 'Until kings are philosophers or philosophers are kings, cities will never cease from ill.' And by philosophers he explains himself to mean those who are capable of apprehending ideas, especially the idea of good. To the attainment of this higher knowledge the second education is directed. Through a process of training which has already made them good citizens they are now to be made good legislators. We find with some surprise (not unlike the feeling which Aristotle in a well-known passage describes the hearers of Plato's lectures as experiencing, when they went to a discourse on the idea of good, expecting to be instructed in moral truths, and received instead of them arithmetical and mathematical formulae) that Plato does not propose for his future legislators any study of finance or law or military tactics, but only of abstract mathematics, as a preparation for the still more abstract conception of good. We ask, with Aristotle, What is the use of a man knowing the idea of good, if he does not know what is good for this individual, this state, this condition of society? We cannot understand how Plato's legislators or guardians are to be fitted for their work of statesmen by the study of the five mathematical sciences. We vainly search in Plato's own writings for any explanation of this seeming absurdity.

The discovery of a great metaphysical conception seems to ravish the mind with a prophetic consciousness which takes away the power of estimating its value. No metaphysical enquirer has ever fairly criticised his own speculations; in his own judgment they have been above criticism; nor has he understood that what to him seemed to be absolute truth may reappear in the next generation as a form of logic or an instrument of thought. And posterity have also sometimes equally misapprehended the real value of his speculations. They appear to them to have contributed nothing to the stock of human knowledge. The IDEA of good is apt to be regarded by the modern thinker as an unmeaning abstraction; but he forgets that this abstraction is waiting ready for use, and will hereafter be filled up by the divisions of knowledge. When mankind do not as yet know that the world is subject to law, the introduction of the mere conception of law or design or final cause, and the far-off anticipation of the harmony of knowledge, are great steps onward. Even the crude generalization of the unity of all things leads men to view the world with different eyes, and may easily affect their conception of human life and of politics, and also their own conduct and character (Tim). We can imagine how a great mind like that of Pericles might derive elevation from his intercourse with Anaxagoras (Phaedr.). To be struggling towards a higher but unattainable conception is a more favourable intellectual condition than to rest satisfied in a narrow portion of ascertained fact. And the earlier, which have sometimes been the greater ideas of science, are often lost sight of at a later period. How rarely can we say of any modern enquirer in the magnificent language of Plato, that 'He is the spectator of all time and of all existence!'

Nor is there anything unnatural in the hasty application of these vast metaphysical conceptions to practical and political life. In the first enthusiasm of ideas men are apt to see them everywhere, and to apply them in the most remote sphere. They do not understand that the experience of ages is required to enable them to fill up 'the intermediate axioms.' Plato himself seems to have imagined that the truths of psychology, like those of astronomy and harmonics, would be arrived at by a process of deduction, and that the method which he has pursued in the Fourth Book, of inferring them from experience and the use of language, was imperfect and only provisional. But when, after having arrived at the idea of good, which is the end of the science of dialectic, he is asked, What is the nature, and what are the divisions of the science? He refuses to answer, as if intending by the refusal to intimate that the state of knowledge which then existed was not such as would allow the philosopher to enter into his final rest. The previous sciences must first be studied, and will, we may add, continue to be studied tell the end of time, although in a sense different from any which Plato could have conceived. But we may observe, that while he is aware of the vacancy of his own ideal, he is full of enthusiasm in the contemplation of it. Looking into the orb of light, he sees nothing, but he is warmed and elevated. The Hebrew prophet believed that faith in God would enable him to govern the world; the Greek philosopher imagined that contemplation of the good would make a legislator. There is as much to be filled up in the one case as in the other, and the one mode of conception is to the Israelite what the other is to the Greek. Both find a repose in a divine perfection, which, whether in a more personal or impersonal form, exists without them and independently of them, as well as within them.

There is no mention of the idea of good in the Timaeus, nor of the divine Creator of the world in the Republic; and we are naturally led to ask in what relation they stand to one another. Is God above or below the idea of good? Or is the Idea of Good another mode of conceiving God? The latter appears to be the truer answer. To the Greek philosopher the perfection and unity of God was a far higher conception than his personality, which he hardly found a word to express, and which to him would have seemed to be borrowed from mythology. To the Christian, on the other hand, or to the modern thinker in general, it is difficult, if not impossible, to attach reality to what he terms mere abstraction; while to Plato this very abstraction is the truest and most real of all things. Hence, from a difference in forms of thought, Plato appears to be resting on a creation of his own mind only. But if we may be allowed to paraphrase the idea of good by the words 'intelligent principle of law and order in the universe, embracing equally man and nature,' we begin to find a meeting-point between him and ourselves.

The question whether the ruler or statesman should be a philosopher is one that has not lost interest in modern times. In most countries of Europe and Asia there has been some one in the course of ages who has truly united the power of command with the power of thought and reflection, as there have been also many false combinations of these qualities. Some kind of speculative power is necessary both in practical and political life; like the rhetorician in the Phaedrus, men require to have a conception of the varieties of human character, and to be raised on great occasions above the commonplaces of ordinary life. Yet the idea of the philosopher-statesman has never been popular with the mass of mankind; partly because he cannot take the world into his confidence or make them understand the motives from which he acts; and also because they are jealous of a power which they do not understand. The revolution which human nature desires to effect step by step in many ages is likely to be precipitated by him in a single year or life. They are afraid that in the pursuit of his greater aims he may disregard the common feelings of humanity, he is too apt to be looking into the distant future or back into the remote past, and unable to see actions or events which, to use an expression of Plato's 'are tumbling out at his feet.' Besides, as Plato would say, there are other corruptions of these philosophical statesmen. Either 'the native hue of resolution is sicklied o'er with the pale cast of thought,' and at the moment when action above all things is required he is undecided, or general principles are enunciated by him in order to cover some change of policy; or his ignorance of the world has made him more easily fall a prey to the arts of others; or in some cases he has been converted into a courtier, who enjoys the luxury of holding liberal opinions, but was never known to perform a liberal action. No wonder that mankind have been in the habit of calling statesmen of this class pedants, sophisters, doctrinaires, visionaries. For, as we may be allowed to say, a little parodying the words of Plato, 'they have seen bad imitations of the philosopher-statesman.' But a man in whom the power of thought and action are perfectly balanced, equal to the present, reaching forward to the future, 'such a one,' ruling in a constitutional state, 'they have never seen.'

But as the philosopher is apt to fail in the routine of political life, so the ordinary statesman is also apt to fail in extraordinary crises. When the face of the world is beginning to alter, and thunder is heard in the distance, he is still guided by his old maxims, and is the slave of his inveterate party prejudices; he cannot perceive the signs of the times; instead of looking forward he looks back; he learns nothing and forgets nothing; with 'wise saws and modern instances' he would stem the rising tide of revolution. He lives more and more within the circle of his own party, as the world without him becomes stronger. This seems to be the reason why the old order of things makes so poor a figure when confronted with the new, why churches can never reform, why most political changes are made blindly and convulsively. The great crises in the history of nations have often been met by an ecclesiastical positiveness, and a more obstinate reassertion of principles which have lost their hold upon a nation. The fixed ideas of a reactionary statesman may be compared to madness; they grow upon him, and he becomes possessed by them; no judgement of others is ever admitted by him to be weighed in the balance against his own.

(d) Plato, labouring under what, to modern readers, appears to have been a confusion of ideas, assimilates the state to the individual, and fails to distinguish Ethics from Politics. He thinks that to be most of a state which is most like one man, and in which the citizens have the greatest uniformity of character. He does not see that the analogy is partly fallacious, and that the will or character of a state or nation is really the balance or rather the surplus of individual wills, which are limited by the condition of having to act in common. The movement of a body of men can never have the pliancy or facility of a single man; the freedom of the individual, which is always limited, becomes still more straitened when transferred to a nation. The powers of action and feeling are necessarily weaker and more balanced when they are diffused through a community; whence arises the often discussed question, 'Can a nation, like an individual, have a conscience?' We hesitate to say that the characters of nations are nothing more than the sum of the characters of the individuals who compose them; because there may be tendencies in individuals which react upon one another. A whole nation may be wiser than any one man in it; or may be animated by some common opinion or feeling which could not equally have affected the mind of a single person, or may have been inspired by a leader of genius to perform acts more than human. Plato does not appear to have analysed the complications which arise out of the collective action of mankind. Neither is he capable of seeing that analogies, though specious as arguments, may often have no foundation in fact, or of distinguishing between what is intelligible or vividly present to the mind, and what is true. In this respect he is far below Aristotle, who is comparatively seldom imposed upon by false analogies. He cannot disentangle the arts from the virtues—at least he is always arguing from one to the other. His notion of music is transferred from harmony of sounds to harmony of life: in this he is assisted by the ambiguities of language as well as by the prevalence of Pythagorean notions. And having once assimilated the state to the individual, he imagines that he will find the succession of states paralleled in the lives of individuals.

Still, through this fallacious medium, a real enlargement of ideas is attained. When the virtues as yet presented no distinct conception to the mind, a great advance was made by the comparison of them with the arts; for virtue is partly art, and has an outward form as well as an inward principle. The harmony of music affords a lively image of the harmonies of the world and of human life, and may be regarded as a splendid illustration which was naturally mistaken for a real analogy. In the same way the identification of ethics with politics has a tendency to give definiteness to ethics, and also to elevate and ennoble men's notions of the aims of government and of the duties of citizens; for ethics from one point of view may be conceived as an idealized law and politics; and politics, as ethics reduced to the conditions of human society. There have been evils which have arisen out of the attempt to identify them, and this has led to the separation or antagonism of them, which has been introduced by modern political writers. But we may likewise feel that something has been lost in their separation, and that the ancient philosophers who estimated the moral and intellectual wellbeing of mankind first, and the wealth of nations and individuals second, may have a salutary influence on the speculations of modern times. Many political maxims originate in a reaction against an opposite error; and when the errors against which they were directed have passed away, they in turn become errors.

3. Plato's views of education are in several respects remarkable; like the rest of the Republic they are partly Greek and partly ideal, beginning with the ordinary curriculum of the Greek youth, and extending to after-life. Plato is the first writer who distinctly says that education is to comprehend the whole of life, and to be a preparation for another in which education begins again. This is the continuous thread which runs through the Republic, and which more than any other of his ideas admits of an application to modern life.

He has long given up the notion that virtue cannot be taught; and he is disposed to modify the thesis of the Protagoras, that the virtues are one and not many. He is not unwilling to admit the sensible world into his scheme of truth. Nor does he assert in the Republic the involuntariness of vice, which is maintained by him in the Timaeus, Sophist, and Laws (Protag., Apol., Gorg.). Nor do the so-called Platonic ideas recovered from a former state of existence affect his theory of mental improvement. Still we observe in him the remains of the old Socratic doctrine, that true knowledge must be elicited from within, and is to be sought for in ideas, not in particulars of sense. Education, as he says, will implant a principle of intelligence which is better than ten thousand eyes. The paradox that the virtues are one, and the kindred notion that all virtue is knowledge, are not entirely renounced; the first is seen in the supremacy given to justice over the rest; the second in the tendency to absorb the moral virtues in the intellectual, and to centre all goodness in the contemplation of the idea of good. The world of sense is still depreciated and identified with opinion, though admitted to be a shadow of the true. In the Republic he is evidently impressed with the conviction that vice arises chiefly from ignorance and may be cured by education; the multitude are hardly to be deemed responsible for what they do. A faint allusion to the doctrine of reminiscence occurs in the Tenth Book; but Plato's views of education have no more real connection with a previous state of existence than our own; he only proposes to elicit from the mind that which is there already. Education is represented by him, not as the filling of a vessel, but as the turning the eye of the soul towards the light.

He treats first of music or literature, which he divides into true and false, and then goes on to gymnastics; of infancy in the Republic he takes no notice, though in the Laws he gives sage counsels about the nursing of children and the management of the mothers, and would have an education which is even prior to birth. But in the Republic he begins with the age at which the child is capable of receiving ideas, and boldly asserts, in language which sounds paradoxical to modern ears, that he must be taught the false before he can learn the true. The modern and ancient philosophical world are not agreed about truth and falsehood; the one identifies truth almost exclusively with fact, the other with ideas. This is the difference between ourselves and Plato, which is, however, partly a difference of words. For we too should admit that a child must receive many lessons which he imperfectly understands; he must be taught some things in a figure only, some too which he can hardly be expected to believe when he grows older; but we should limit the use of fiction by the necessity of the case. Plato would draw the line differently; according to him the aim of early education is not truth as a matter of fact, but truth as a matter of principle; the child is to be taught first simple religious truths, and then simple moral truths, and insensibly to learn the lesson of good manners and good taste. He would make an entire reformation of the old mythology; like Xenophanes and Heracleitus he is sensible of the deep chasm which separates his own age from Homer and Hesiod, whom he quotes and invests with an imaginary authority, but only for his own purposes. The lusts and treacheries of the gods are to be banished; the terrors of the world below are to be dispelled; the misbehaviour of the Homeric heroes is not to be a model for youth. But there is another strain heard in Homer which may teach our youth endurance; and something may be learnt in medicine from the simple practice of the Homeric age. The principles on which religion is to be based are two only: first, that God is true; secondly, that he is good. Modern and Christian writers have often fallen short of these; they can hardly be said to have gone beyond them.

The young are to be brought up in happy surroundings, out of the way of sights or sounds which may hurt the character or vitiate the taste. They are to live in an atmosphere of health; the breeze is always to be wafting to them the impressions of truth and goodness. Could such an education be realized, or if our modern religious education could be bound up with truth and virtue and good manners and good taste, that would be the best hope of human improvement. Plato, like ourselves, is looking forward to changes in the moral and religious world, and is preparing for them. He recognizes the danger of unsettling young men's minds by sudden changes of laws and principles, by destroying the sacredness of one set of ideas when there is nothing else to take their place. He is afraid too of the influence of the drama, on the ground that it encourages false sentiment, and therefore he would not have his children taken to the theatre; he thinks that the effect on the spectators is bad, and on the actors still worse. His idea of education is that of harmonious growth, in which are insensibly learnt the lessons of temperance and endurance, and the body and mind develope in equal proportions. The first principle which runs through all art and nature is simplicity; this also is to be the rule of human life.

The second stage of education is gymnastic, which answers to the period of muscular growth and development. The simplicity which is enforced in music is extended to gymnastic; Plato is aware that the training of the body may be inconsistent with the training of the mind, and that bodily exercise may be easily overdone. Excessive training of the body is apt to give men a headache or to render them sleepy at a lecture on philosophy, and this they attribute not to the true cause, but to the nature of the subject. Two points are noticeable in Plato's treatment of gymnastic:—First, that the time of training is entirely separated from the time of literary education. He seems to have thought that two things of an opposite and different nature could not be learnt at the same time. Here we can hardly agree with him; and, if we may judge by experience, the effect of spending three years between the ages of fourteen and seventeen in mere bodily exercise would be far from improving to the intellect. Secondly, he affirms that music and gymnastic are not, as common opinion is apt to imagine, intended, the one for the cultivation of the mind and the other of the body, but that they are both equally designed for the improvement of the mind. The body, in his view, is the servant of the mind; the subjection of the lower to the higher is for the advantage of both. And doubtless the mind may exercise a very great and paramount influence over the body, if exerted not at particular moments and by fits and starts, but continuously, in making preparation for the whole of life. Other Greek writers saw the mischievous tendency of Spartan discipline (Arist. Pol; Thuc.). But only Plato recognized the fundamental error on which the practice was based.

The subject of gymnastic leads Plato to the sister subject of medicine, which he further illustrates by the parallel of law. The modern disbelief in medicine has led in this, as in some other departments of knowledge, to a demand for greater simplicity; physicians are becoming aware that they often make diseases 'greater and more complicated' by their treatment of them (Rep.). In two thousand years their art has made but slender progress; what they have gained in the analysis of the parts is in a great degree lost by their feebler conception of the human frame as a whole. They have attended more to the cure of diseases than to the conditions of health; and the improvements in medicine have been more than counterbalanced by the disuse of regular training. Until lately they have hardly thought of air and water, the importance of which was well understood by the ancients; as Aristotle remarks, 'Air and water, being the elements which we most use, have the greatest effect upon health' (Polit.). For ages physicians have been under the dominion of prejudices which have only recently given way; and now there are as many opinions in medicine as in theology, and an equal degree of scepticism and some want of toleration about both. Plato has several good notions about medicine; according to him, 'the eye cannot be cured without the rest of the body, nor the body without the mind' (Charm.). No man of sense, he says in the Timaeus, would take physic; and we heartily sympathize with him in the Laws when he declares that 'the limbs of the rustic worn with toil will derive more benefit from warm baths than from the prescriptions of a not over wise doctor.' But we can hardly praise him when, in obedience to the authority of Homer, he depreciates diet, or approve of the inhuman spirit in which he would get rid of invalid and useless lives by leaving them to die. He does not seem to have considered that the 'bridle of Theages' might be accompanied by qualities which were of far more value to the State than the health or strength of the citizens; or that the duty of taking care of the helpless might be an important element of education in a State. The physician himself (this is a delicate and subtle observation) should not be a man in robust health; he should have, in modern phraseology, a nervous temperament; he should have experience of disease in his own person, in order that his powers of observation may be quickened in the case of others.

The perplexity of medicine is paralleled by the perplexity of law; in which, again, Plato would have men follow the golden rule of simplicity. Greater matters are to be determined by the legislator or by the oracle of Delphi, lesser matters are to be left to the temporary regulation of the citizens themselves. Plato is aware that laissez faire is an important element of government. The diseases of a State are like the heads of a hydra; they multiply when they are cut off. The true remedy for them is not extirpation but prevention. And the way to prevent them is to take care of education, and education will take care of all the rest. So in modern times men have often felt that the only political measure worth having—the only one which would produce any certain or lasting effect, was a measure of national education. And in our own more than in any previous age the necessity has been recognized of restoring the ever-increasing confusion of law to simplicity and common sense.

When the training in music and gymnastic is completed, there follows the first stage of active and public life. But soon education is to begin again from a new point of view. In the interval between the Fourth and Seventh Books we have discussed the nature of knowledge, and have thence been led to form a higher conception of what was required of us. For true knowledge, according to Plato, is of abstractions, and has to do, not with particulars or individuals, but with universals only; not with the beauties of poetry, but with the ideas of philosophy. And the great aim of education is the cultivation of the habit of abstraction. This is to be acquired through the study of the mathematical sciences. They alone are capable of giving ideas of relation, and of arousing the dormant energies of thought.

Mathematics in the age of Plato comprehended a very small part of that which is now included in them; but they bore a much larger proportion to the sum of human knowledge. They were the only organon of thought which the human mind at that time possessed, and the only measure by which the chaos of particulars could be reduced to rule and order. The faculty which they trained was naturally at war with the poetical or imaginative; and hence to Plato, who is everywhere seeking for abstractions and trying to get rid of the illusions of sense, nearly the whole of education is contained in them. They seemed to have an inexhaustible application, partly because their true limits were not yet understood. These Plato himself is beginning to investigate; though not aware that number and figure are mere abstractions of sense, he recognizes that the forms used by geometry are borrowed from the sensible world. He seeks to find the ultimate ground of mathematical ideas in the idea of good, though he does not satisfactorily explain the connexion between them; and in his conception of the relation of ideas to numbers, he falls very far short of the definiteness attributed to him by Aristotle (Met.). But if he fails to recognize the true limits of mathematics, he also reaches a point beyond them; in his view, ideas of number become secondary to a higher conception of knowledge. The dialectician is as much above the mathematician as the mathematician is above the ordinary man. The one, the self-proving, the good which is the higher sphere of dialectic, is the perfect truth to which all things ascend, and in which they finally repose.

This self-proving unity or idea of good is a mere vision of which no distinct explanation can be given, relative only to a particular stage in Greek philosophy. It is an abstraction under which no individuals are comprehended, a whole which has no parts (Arist., Nic. Eth.). The vacancy of such a form was perceived by Aristotle, but not by Plato. Nor did he recognize that in the dialectical process are included two or more methods of investigation which are at variance with each other. He did not see that whether he took the longer or the shorter road, no advance could be made in this way. And yet such visions often have an immense effect; for although the method of science cannot anticipate science, the idea of science, not as it is, but as it will be in the future, is a great and inspiring principle. In the pursuit of knowledge we are always pressing forward to something beyond us; and as a false conception of knowledge, for example the scholastic philosophy, may lead men astray during many ages, so the true ideal, though vacant, may draw all their thoughts in a right direction. It makes a great difference whether the general expectation of knowledge, as this indefinite feeling may be termed, is based upon a sound judgment. For mankind may often entertain a true conception of what knowledge ought to be when they have but a slender experience of facts. The correlation of the sciences, the consciousness of the unity of nature, the idea of classification, the sense of proportion, the unwillingness to stop short of certainty or to confound probability with truth, are important principles of the higher education. Although Plato could tell us nothing, and perhaps knew that he could tell us nothing, of the absolute truth, he has exercised an influence on the human mind which even at the present day is not exhausted; and political and social questions may yet arise in which the thoughts of Plato may be read anew and receive a fresh meaning.

The Idea of good is so called only in the Republic, but there are traces of it in other dialogues of Plato. It is a cause as well as an idea, and from this point of view may be compared with the creator of the Timaeus, who out of his goodness created all things. It corresponds to a certain extent with the modern conception of a law of nature, or of a final cause, or of both in one, and in this regard may be connected with the measure and symmetry of the Philebus. It is represented in the Symposium under the aspect of beauty, and is supposed to be attained there by stages of initiation, as here by regular gradations of knowledge. Viewed subjectively, it is the process or science of dialectic. This is the science which, according to the Phaedrus, is the true basis of rhetoric, which alone is able to distinguish the natures and classes of men and things; which divides a whole into the natural parts, and reunites the scattered parts into a natural or organized whole; which defines the abstract essences or universal ideas of all things, and connects them; which pierces the veil of hypotheses and reaches the final cause or first principle of all; which regards the sciences in relation to the idea of good. This ideal science is the highest process of thought, and may be described as the soul conversing with herself or holding communion with eternal truth and beauty, and in another form is the everlasting question and answer—the ceaseless interrogative of Socrates. The dialogues of Plato are themselves examples of the nature and method of dialectic. Viewed objectively, the idea of good is a power or cause which makes the world without us correspond with the world within. Yet this world without us is still a world of ideas. With Plato the investigation of nature is another department of knowledge, and in this he seeks to attain only probable conclusions (Timaeus).

If we ask whether this science of dialectic which Plato only half explains to us is more akin to logic or to metaphysics, the answer is that in his mind the two sciences are not as yet distinguished, any more than the subjective and objective aspects of the world and of man, which German philosophy has revealed to us. Nor has he determined whether his science of dialectic is at rest or in motion, concerned with the contemplation of absolute being, or with a process of development and evolution. Modern metaphysics may be described as the science of abstractions, or as the science of the evolution of thought; modern logic, when passing beyond the bounds of mere Aristotelian forms, may be defined as the science of method. The germ of both of them is contained in the Platonic dialectic; all metaphysicians have something in common with the ideas of Plato; all logicians have derived something from the method of Plato. The nearest approach in modern philosophy to the universal science of Plato, is to be found in the Hegelian 'succession of moments in the unity of the idea.' Plato and Hegel alike seem to have conceived the world as the correlation of abstractions; and not impossibly they would have understood one another better than any of their commentators understand them (Swift's Voyage to Laputa. 'Having a desire to see those ancients who were most renowned for wit and learning, I set apart one day on purpose. I proposed that Homer and Aristotle might appear at the head of all their commentators; but these were so numerous that some hundreds were forced to attend in the court and outward rooms of the palace. I knew, and could distinguish these two heroes, at first sight, not only from the crowd, but from each other. Homer was the taller and comelier person of the two, walked very erect for one of his age, and his eyes were the most quick and piercing I ever beheld. Aristotle stooped much, and made use of a staff. His visage was meagre, his hair lank and thin, and his voice hollow. I soon discovered that both of them were perfect strangers to the rest of the company, and had never seen or heard of them before. And I had a whisper from a ghost, who shall be nameless, &quot;That these commentators always kept in the most distant quarters from their principals, in the lower world, through a consciousness of shame and guilt, because they had so horribly misrepresented the meaning of these authors to posterity.&quot; I introduced Didymus and Eustathius to Homer, and prevailed on him to treat them better than perhaps they deserved, for he soon found they wanted a genius to enter into the spirit of a poet. But Aristotle was out of all patience with the account I gave him of Scotus and Ramus, as I presented them to him; and he asked them &quot;whether the rest of the tribe were as great dunces as themselves?&quot;'). There is, however, a difference between them: for whereas Hegel is thinking of all the minds of men as one mind, which developes the stages of the idea in different countries or at different times in the same country, with Plato these gradations are regarded only as an order of thought or ideas; the history of the human mind had not yet dawned upon him.

Many criticisms may be made on Plato's theory of education. While in some respects he unavoidably falls short of modern thinkers, in others he is in advance of them. He is opposed to the modes of education which prevailed in his own time; but he can hardly be said to have discovered new ones. He does not see that education is relative to the characters of individuals; he only desires to impress the same form of the state on the minds of all. He has no sufficient idea of the effect of literature on the formation of the mind, and greatly exaggerates that of mathematics. His aim is above all things to train the reasoning faculties; to implant in the mind the spirit and power of abstraction; to explain and define general notions, and, if possible, to connect them. No wonder that in the vacancy of actual knowledge his followers, and at times even he himself, should have fallen away from the doctrine of ideas, and have returned to that branch of knowledge in which alone the relation of the one and many can be truly seen—the science of number. In his views both of teaching and training he might be styled, in modern language, a doctrinaire; after the Spartan fashion he would have his citizens cast in one mould; he does not seem to consider that some degree of freedom, 'a little wholesome neglect,' is necessary to strengthen and develope the character and to give play to the individual nature. His citizens would not have acquired that knowledge which in the vision of Er is supposed to be gained by the pilgrims from their experience of evil.

On the other hand, Plato is far in advance of modern philosophers and theologians when he teaches that education is to be continued through life and will begin again in another. He would never allow education of some kind to cease; although he was aware that the proverbial saying of Solon, 'I grow old learning many things,' cannot be applied literally. Himself ravished with the contemplation of the idea of good, and delighting in solid geometry (Rep.), he has no difficulty in imagining that a lifetime might be passed happily in such pursuits. We who know how many more men of business there are in the world than real students or thinkers, are not equally sanguine. The education which he proposes for his citizens is really the ideal life of the philosopher or man of genius, interrupted, but only for a time, by practical duties,—a life not for the many, but for the few.

Yet the thought of Plato may not be wholly incapable of application to our own times. Even if regarded as an ideal which can never be realized, it may have a great effect in elevating the characters of mankind, and raising them above the routine of their ordinary occupation or profession. It is the best form under which we can conceive the whole of life. Nevertheless the idea of Plato is not easily put into practice. For the education of after life is necessarily the education which each one gives himself. Men and women cannot be brought together in schools or colleges at forty or fifty years of age; and if they could the result would be disappointing. The destination of most men is what Plato would call 'the Den' for the whole of life, and with that they are content. Neither have they teachers or advisers with whom they can take counsel in riper years. There is no 'schoolmaster abroad' who will tell them of their faults, or inspire them with the higher sense of duty, or with the ambition of a true success in life; no Socrates who will convict them of ignorance; no Christ, or follower of Christ, who will reprove them of sin. Hence they have a difficulty in receiving the first element of improvement, which is self-knowledge. The hopes of youth no longer stir them; they rather wish to rest than to pursue high objects. A few only who have come across great men and women, or eminent teachers of religion and morality, have received a second life from them, and have lighted a candle from the fire of their genius.

The want of energy is one of the main reasons why so few persons continue to improve in later years. They have not the will, and do not know the way. They 'never try an experiment,' or look up a point of interest for themselves; they make no sacrifices for the sake of knowledge; their minds, like their bodies, at a certain age become fixed. Genius has been defined as 'the power of taking pains'; but hardly any one keeps up his interest in knowledge throughout a whole life. The troubles of a family, the business of making money, the demands of a profession destroy the elasticity of the mind. The waxen tablet of the memory which was once capable of receiving 'true thoughts and clear impressions' becomes hard and crowded; there is not room for the accumulations of a long life (Theaet.). The student, as years advance, rather makes an exchange of knowledge than adds to his stores. There is no pressing necessity to learn; the stock of Classics or History or Natural Science which was enough for a man at twenty-five is enough for him at fifty. Neither is it easy to give a definite answer to any one who asks how he is to improve. For self-education consists in a thousand things, commonplace in themselves,—in adding to what we are by nature something of what we are not; in learning to see ourselves as others see us; in judging, not by opinion, but by the evidence of facts; in seeking out the society of superior minds; in a study of lives and writings of great men; in observation of the world and character; in receiving kindly the natural influence of different times of life; in any act or thought which is raised above the practice or opinions of mankind; in the pursuit of some new or original enquiry; in any effort of mind which calls forth some latent power.

If any one is desirous of carrying out in detail the Platonic education of after-life, some such counsels as the following may be offered to him:—That he shall choose the branch of knowledge to which his own mind most distinctly inclines, and in which he takes the greatest delight, either one which seems to connect with his own daily employment, or, perhaps, furnishes the greatest contrast to it. He may study from the speculative side the profession or business in which he is practically engaged. He may make Homer, Dante, Shakespeare, Plato, Bacon the friends and companions of his life. He may find opportunities of hearing the living voice of a great teacher. He may select for enquiry some point of history or some unexplained phenomenon of nature. An hour a day passed in such scientific or literary pursuits will furnish as many facts as the memory can retain, and will give him 'a pleasure not to be repented of' (Timaeus). Only let him beware of being the slave of crotchets, or of running after a Will o' the Wisp in his ignorance, or in his vanity of attributing to himself the gifts of a poet or assuming the air of a philosopher. He should know the limits of his own powers. Better to build up the mind by slow additions, to creep on quietly from one thing to another, to gain insensibly new powers and new interests in knowledge, than to form vast schemes which are never destined to be realized. But perhaps, as Plato would say, 'This is part of another subject' (Tim.); though we may also defend our digression by his example (Theaet.).

4. We remark with surprise that the progress of nations or the natural growth of institutions which fill modern treatises on political philosophy seem hardly ever to have attracted the attention of Plato and Aristotle. The ancients were familiar with the mutability of human affairs; they could moralize over the ruins of cities and the fall of empires (Plato, Statesman, and Sulpicius' Letter to Cicero); by them fate and chance were deemed to be real powers, almost persons, and to have had a great share in political events. The wiser of them like Thucydides believed that 'what had been would be again,' and that a tolerable idea of the future could be gathered from the past. Also they had dreams of a Golden Age which existed once upon a time and might still exist in some unknown land, or might return again in the remote future. But the regular growth of a state enlightened by experience, progressing in knowledge, improving in the arts, of which the citizens were educated by the fulfilment of political duties, appears never to have come within the range of their hopes and aspirations. Such a state had never been seen, and therefore could not be conceived by them. Their experience (Aristot. Metaph.; Plato, Laws) led them to conclude that there had been cycles of civilization in which the arts had been discovered and lost many times over, and cities had been overthrown and rebuilt again and again, and deluges and volcanoes and other natural convulsions had altered the face of the earth. Tradition told them of many destructions of mankind and of the preservation of a remnant. The world began again after a deluge and was reconstructed out of the fragments of itself. Also they were acquainted with empires of unknown antiquity, like the Egyptian or Assyrian; but they had never seen them grow, and could not imagine, any more than we can, the state of man which preceded them. They were puzzled and awestricken by the Egyptian monuments, of which the forms, as Plato says, not in a figure, but literally, were ten thousand years old (Laws), and they contrasted the antiquity of Egypt with their own short memories.

The early legends of Hellas have no real connection with the later history: they are at a distance, and the intermediate region is concealed from view; there is no road or path which leads from one to the other. At the beginning of Greek history, in the vestibule of the temple, is seen standing first of all the figure of the legislator, himself the interpreter and servant of the God. The fundamental laws which he gives are not supposed to change with time and circumstances. The salvation of the state is held rather to depend on the inviolable maintenance of them. They were sanctioned by the authority of heaven, and it was deemed impiety to alter them. The desire to maintain them unaltered seems to be the origin of what at first sight is very surprising to us—the intolerant zeal of Plato against innovators in religion or politics (Laws); although with a happy inconsistency he is also willing that the laws of other countries should be studied and improvements in legislation privately communicated to the Nocturnal Council (Laws). The additions which were made to them in later ages in order to meet the increasing complexity of affairs were still ascribed by a fiction to the original legislator; and the words of such enactments at Athens were disputed over as if they had been the words of Solon himself. Plato hopes to preserve in a later generation the mind of the legislator; he would have his citizens remain within the lines which he has laid down for them. He would not harass them with minute regulations, he would have allowed some changes in the laws: but not changes which would affect the fundamental institutions of the state, such for example as would convert an aristocracy into a timocracy, or a timocracy into a popular form of government.

Passing from speculations to facts, we observe that progress has been the exception rather than the law of human history. And therefore we are not surprised to find that the idea of progress is of modern rather than of ancient date; and, like the idea of a philosophy of history, is not more than a century or two old. It seems to have arisen out of the impression left on the human mind by the growth of the Roman Empire and of the Christian Church, and to be due to the political and social improvements which they introduced into the world; and still more in our own century to the idealism of the first French Revolution and the triumph of American Independence; and in a yet greater degree to the vast material prosperity and growth of population in England and her colonies and in America. It is also to be ascribed in a measure to the greater study of the philosophy of history. The optimist temperament of some great writers has assisted the creation of it, while the opposite character has led a few to regard the future of the world as dark. The 'spectator of all time and of all existence' sees more of 'the increasing purpose which through the ages ran' than formerly: but to the inhabitant of a small state of Hellas the vision was necessarily limited like the valley in which he dwelt. There was no remote past on which his eye could rest, nor any future from which the veil was partly lifted up by the analogy of history. The narrowness of view, which to ourselves appears so singular, was to him natural, if not unavoidable.

5. For the relation of the Republic to the Statesman and the Laws, and the two other works of Plato which directly treat of politics, see the Introductions to the two latter; a few general points of comparison may be touched upon in this place.

And first of the Laws.

(1) The Republic, though probably written at intervals, yet speaking generally and judging by the indications of thought and style, may be reasonably ascribed to the middle period of Plato's life: the Laws are certainly the work of his declining years, and some portions of them at any rate seem to have been written in extreme old age.

(2) The Republic is full of hope and aspiration: the Laws bear the stamp of failure and disappointment. The one is a finished work which received the last touches of the author: the other is imperfectly executed, and apparently unfinished. The one has the grace and beauty of youth: the other has lost the poetical form, but has more of the severity and knowledge of life which is characteristic of old age.

(3) The most conspicuous defect of the Laws is the failure of dramatic power, whereas the Republic is full of striking contrasts of ideas and oppositions of character.

(4) The Laws may be said to have more the nature of a sermon, the Republic of a poem; the one is more religious, the other more intellectual.

(5) Many theories of Plato, such as the doctrine of ideas, the government of the world by philosophers, are not found in the Laws; the immortality of the soul is first mentioned in xii; the person of Socrates has altogether disappeared. The community of women and children is renounced; the institution of common or public meals for women (Laws) is for the first time introduced (Ar. Pol.).

(6) There remains in the Laws the old enmity to the poets, who are ironically saluted in high-flown terms, and, at the same time, are peremptorily ordered out of the city, if they are not willing to submit their poems to the censorship of the magistrates (Rep.).

(7) Though the work is in most respects inferior, there are a few passages in the Laws, such as the honour due to the soul, the evils of licentious or unnatural love, the whole of Book x. (religion), the dishonesty of retail trade, and bequests, which come more home to us, and contain more of what may be termed the modern element in Plato than almost anything in the Republic.

The relation of the two works to one another is very well given:

(1) by Aristotle in the Politics from the side of the Laws:—

'The same, or nearly the same, objections apply to Plato's later work, the Laws, and therefore we had better examine briefly the constitution which is therein described. In the Republic, Socrates has definitely settled in all a few questions only; such as the community of women and children, the community of property, and the constitution of the state. The population is divided into two classes—one of husbandmen, and the other of warriors; from this latter is taken a third class of counsellors and rulers of the state. But Socrates has not determined whether the husbandmen and artists are to have a share in the government, and whether they too are to carry arms and share in military service or not. He certainly thinks that the women ought to share in the education of the guardians, and to fight by their side. The remainder of the work is filled up with digressions foreign to the main subject, and with discussions about the education of the guardians. In the Laws there is hardly anything but laws; not much is said about the constitution. This, which he had intended to make more of the ordinary type, he gradually brings round to the other or ideal form. For with the exception of the community of women and property, he supposes everything to be the same in both states; there is to be the same education; the citizens of both are to live free from servile occupations, and there are to be common meals in both. The only difference is that in the Laws the common meals are extended to women, and the warriors number about 5000, but in the Republic only 1000.'

(2) by Plato in the Laws (Book v.), from the side of the Republic:—

'The first and highest form of the state and of the government and of the law is that in which there prevails most widely the ancient saying that &quot;Friends have all things in common.&quot; Whether there is now, or ever will be, this communion of women and children and of property, in which the private and individual is altogether banished from life, and things which are by nature private, such as eyes and ears and hands, have become common, and all men express praise and blame, and feel joy and sorrow, on the same occasions, and the laws unite the city to the utmost,—whether all this is possible or not, I say that no man, acting upon any other principle, will ever constitute a state more exalted in virtue, or truer or better than this. Such a state, whether inhabited by Gods or sons of Gods, will make them blessed who dwell therein; and therefore to this we are to look for the pattern of the state, and to cling to this, and, as far as possible, to seek for one which is like this. The state which we have now in hand, when created, will be nearest to immortality and unity in the next degree; and after that, by the grace of God, we will complete the third one. And we will begin by speaking of the nature and origin of the second.'

The comparatively short work called the Statesman or Politicus in its style and manner is more akin to the Laws, while in its idealism it rather resembles the Republic. As far as we can judge by various indications of language and thought, it must be later than the one and of course earlier than the other. In both the Republic and Statesman a close connection is maintained between Politics and Dialectic. In the Statesman, enquiries into the principles of Method are interspersed with discussions about Politics. The comparative advantages of the rule of law and of a person are considered, and the decision given in favour of a person (Arist. Pol.). But much may be said on the other side, nor is the opposition necessary; for a person may rule by law, and law may be so applied as to be the living voice of the legislator. As in the Republic, there is a myth, describing, however, not a future, but a former existence of mankind. The question is asked, 'Whether the state of innocence which is described in the myth, or a state like our own which possesses art and science and distinguishes good from evil, is the preferable condition of man.' To this question of the comparative happiness of civilized and primitive life, which was so often discussed in the last century and in our own, no answer is given. The Statesman, though less perfect in style than the Republic and of far less range, may justly be regarded as one of the greatest of Plato's dialogues.

6. Others as well as Plato have chosen an ideal Republic to be the vehicle of thoughts which they could not definitely express, or which went beyond their own age. The classical writing which approaches most nearly to the Republic of Plato is the 'De Republica' of Cicero; but neither in this nor in any other of his dialogues does he rival the art of Plato. The manners are clumsy and inferior; the hand of the rhetorician is apparent at every turn. Yet noble sentiments are constantly recurring: the true note of Roman patriotism—'We Romans are a great people'—resounds through the whole work. Like Socrates, Cicero turns away from the phenomena of the heavens to civil and political life. He would rather not discuss the 'two Suns' of which all Rome was talking, when he can converse about 'the two nations in one' which had divided Rome ever since the days of the Gracchi. Like Socrates again, speaking in the person of Scipio, he is afraid lest he should assume too much the character of a teacher, rather than of an equal who is discussing among friends the two sides of a question. He would confine the terms King or State to the rule of reason and justice, and he will not concede that title either to a democracy or to a monarchy. But under the rule of reason and justice he is willing to include the natural superior ruling over the natural inferior, which he compares to the soul ruling over the body. He prefers a mixture of forms of government to any single one. The two portraits of the just and the unjust, which occur in the second book of the Republic, are transferred to the state—Philus, one of the interlocutors, maintaining against his will the necessity of injustice as a principle of government, while the other, Laelius, supports the opposite thesis. His views of language and number are derived from Plato; like him he denounces the drama. He also declares that if his life were to be twice as long he would have no time to read the lyric poets. The picture of democracy is translated by him word for word, though he had hardly shown himself able to 'carry the jest' of Plato. He converts into a stately sentence the humorous fancy about the animals, who 'are so imbued with the spirit of democracy that they make the passers-by get out of their way.' His description of the tyrant is imitated from Plato, but is far inferior. The second book is historical, and claims for the Roman constitution (which is to him the ideal) a foundation of fact such as Plato probably intended to have given to the Republic in the Critias. His most remarkable imitation of Plato is the adaptation of the vision of Er, which is converted by Cicero into the 'Somnium Scipionis'; he has 'romanized' the myth of the Republic, adding an argument for the immortality of the soul taken from the Phaedrus, and some other touches derived from the Phaedo and the Timaeus. Though a beautiful tale and containing splendid passages, the 'Somnium Scipionis; is very inferior to the vision of Er; it is only a dream, and hardly allows the reader to suppose that the writer believes in his own creation. Whether his dialogues were framed on the model of the lost dialogues of Aristotle, as he himself tells us, or of Plato, to which they bear many superficial resemblances, he is still the Roman orator; he is not conversing, but making speeches, and is never able to mould the intractable Latin to the grace and ease of the Greek Platonic dialogue. But if he is defective in form, much more is he inferior to the Greek in matter; he nowhere in his philosophical writings leaves upon our minds the impression of an original thinker.

Plato's Republic has been said to be a church and not a state; and such an ideal of a city in the heavens has always hovered over the Christian world, and is embodied in St. Augustine's 'De Civitate Dei,' which is suggested by the decay and fall of the Roman Empire, much in the same manner in which we may imagine the Republic of Plato to have been influenced by the decline of Greek politics in the writer's own age. The difference is that in the time of Plato the degeneracy, though certain, was gradual and insensible: whereas the taking of Rome by the Goths stirred like an earthquake the age of St. Augustine. Men were inclined to believe that the overthrow of the city was to be ascribed to the anger felt by the old Roman deities at the neglect of their worship. St. Augustine maintains the opposite thesis; he argues that the destruction of the Roman Empire is due, not to the rise of Christianity, but to the vices of Paganism. He wanders over Roman history, and over Greek philosophy and mythology, and finds everywhere crime, impiety and falsehood. He compares the worst parts of the Gentile religions with the best elements of the faith of Christ. He shows nothing of the spirit which led others of the early Christian Fathers to recognize in the writings of the Greek philosophers the power of the divine truth. He traces the parallel of the kingdom of God, that is, the history of the Jews, contained in their scriptures, and of the kingdoms of the world, which are found in gentile writers, and pursues them both into an ideal future. It need hardly be remarked that his use both of Greek and of Roman historians and of the sacred writings of the Jews is wholly uncritical. The heathen mythology, the Sybilline oracles, the myths of Plato, the dreams of Neo-Platonists are equally regarded by him as matter of fact. He must be acknowledged to be a strictly polemical or controversial writer who makes the best of everything on one side and the worst of everything on the other. He has no sympathy with the old Roman life as Plato has with Greek life, nor has he any idea of the ecclesiastical kingdom which was to arise out of the ruins of the Roman empire. He is not blind to the defects of the Christian Church, and looks forward to a time when Christian and Pagan shall be alike brought before the judgment-seat, and the true City of God shall appear...The work of St. Augustine is a curious repertory of antiquarian learning and quotations, deeply penetrated with Christian ethics, but showing little power of reasoning, and a slender knowledge of the Greek literature and language. He was a great genius, and a noble character, yet hardly capable of feeling or understanding anything external to his own theology. Of all the ancient philosophers he is most attracted by Plato, though he is very slightly acquainted with his writings. He is inclined to believe that the idea of creation in the Timaeus is derived from the narrative in Genesis; and he is strangely taken with the coincidence (?) of Plato's saying that 'the philosopher is the lover of God,' and the words of the Book of Exodus in which God reveals himself to Moses (Exod.) He dwells at length on miracles performed in his own day, of which the evidence is regarded by him as irresistible. He speaks in a very interesting manner of the beauty and utility of nature and of the human frame, which he conceives to afford a foretaste of the heavenly state and of the resurrection of the body. The book is not really what to most persons the title of it would imply, and belongs to an age which has passed away. But it contains many fine passages and thoughts which are for all time.

The short treatise de Monarchia of Dante is by far the most remarkable of mediaeval ideals, and bears the impress of the great genius in whom Italy and the Middle Ages are so vividly reflected. It is the vision of an Universal Empire, which is supposed to be the natural and necessary government of the world, having a divine authority distinct from the Papacy, yet coextensive with it. It is not 'the ghost of the dead Roman Empire sitting crowned upon the grave thereof,' but the legitimate heir and successor of it, justified by the ancient virtues of the Romans and the beneficence of their rule. Their right to be the governors of the world is also confirmed by the testimony of miracles, and acknowledged by St. Paul when he appealed to Caesar, and even more emphatically by Christ Himself, Who could not have made atonement for the sins of men if He had not been condemned by a divinely authorized tribunal. The necessity for the establishment of an Universal Empire is proved partly by a priori arguments such as the unity of God and the unity of the family or nation; partly by perversions of Scripture and history, by false analogies of nature, by misapplied quotations from the classics, and by odd scraps and commonplaces of logic, showing a familiar but by no means exact knowledge of Aristotle (of Plato there is none). But a more convincing argument still is the miserable state of the world, which he touchingly describes. He sees no hope of happiness or peace for mankind until all nations of the earth are comprehended in a single empire. The whole treatise shows how deeply the idea of the Roman Empire was fixed in the minds of his contemporaries. Not much argument was needed to maintain the truth of a theory which to his own contemporaries seemed so natural and congenial. He speaks, or rather preaches, from the point of view, not of the ecclesiastic, but of the layman, although, as a good Catholic, he is willing to acknowledge that in certain respects the Empire must submit to the Church. The beginning and end of all his noble reflections and of his arguments, good and bad, is the aspiration 'that in this little plot of earth belonging to mortal man life may pass in freedom and peace.' So inextricably is his vision of the future bound up with the beliefs and circumstances of his own age.

The 'Utopia' of Sir Thomas More is a surprising monument of his genius, and shows a reach of thought far beyond his contemporaries. The book was written by him at the age of about 34 or 35, and is full of the generous sentiments of youth. He brings the light of Plato to bear upon the miserable state of his own country. Living not long after the Wars of the Roses, and in the dregs of the Catholic Church in England, he is indignant at the corruption of the clergy, at the luxury of the nobility and gentry, at the sufferings of the poor, at the calamities caused by war. To the eye of More the whole world was in dissolution and decay; and side by side with the misery and oppression which he has described in the First Book of the Utopia, he places in the Second Book the ideal state which by the help of Plato he had constructed. The times were full of stir and intellectual interest. The distant murmur of the Reformation was beginning to be heard. To minds like More's, Greek literature was a revelation: there had arisen an art of interpretation, and the New Testament was beginning to be understood as it had never been before, and has not often been since, in its natural sense. The life there depicted appeared to him wholly unlike that of Christian commonwealths, in which 'he saw nothing but a certain conspiracy of rich men procuring their own commodities under the name and title of the Commonwealth.' He thought that Christ, like Plato, 'instituted all things common,' for which reason, he tells us, the citizens of Utopia were the more willing to receive his doctrines ('Howbeit, I think this was no small help and furtherance in the matter, that they heard us say that Christ instituted among his, all things common, and that the same community doth yet remain in the rightest Christian communities' (Utopia).). The community of property is a fixed idea with him, though he is aware of the arguments which may be urged on the other side ('These things (I say), when I consider with myself, I hold well with Plato, and do nothing marvel that he would make no laws for them that refused those laws, whereby all men should have and enjoy equal portions of riches and commodities. For the wise men did easily foresee this to be the one and only way to the wealth of a community, if equality of all things should be brought in and established' (Utopia).). We wonder how in the reign of Henry VIII, though veiled in another language and published in a foreign country, such speculations could have been endured.

He is gifted with far greater dramatic invention than any one who succeeded him, with the exception of Swift. In the art of feigning he is a worthy disciple of Plato. Like him, starting from a small portion of fact, he founds his tale with admirable skill on a few lines in the Latin narrative of the voyages of Amerigo Vespucci. He is very precise about dates and facts, and has the power of making us believe that the narrator of the tale must have been an eyewitness. We are fairly puzzled by his manner of mixing up real and imaginary persons; his boy John Clement and Peter Giles, citizen of Antwerp, with whom he disputes about the precise words which are supposed to have been used by the (imaginary) Portuguese traveller, Raphael Hythloday. 'I have the more cause,' says Hythloday, 'to fear that my words shall not be believed, for that I know how difficultly and hardly I myself would have believed another man telling the same, if I had not myself seen it with mine own eyes.' Or again: 'If you had been with me in Utopia, and had presently seen their fashions and laws as I did which lived there five years and more, and would never have come thence, but only to make the new land known here,' etc. More greatly regrets that he forgot to ask Hythloday in what part of the world Utopia is situated; he 'would have spent no small sum of money rather than it should have escaped him,' and he begs Peter Giles to see Hythloday or write to him and obtain an answer to the question. After this we are not surprised to hear that a Professor of Divinity (perhaps 'a late famous vicar of Croydon in Surrey,' as the translator thinks) is desirous of being sent thither as a missionary by the High Bishop, 'yea, and that he may himself be made Bishop of Utopia, nothing doubting that he must obtain this Bishopric with suit; and he counteth that a godly suit which proceedeth not of the desire of honour or lucre, but only of a godly zeal.' The design may have failed through the disappearance of Hythloday, concerning whom we have 'very uncertain news' after his departure. There is no doubt, however, that he had told More and Giles the exact situation of the island, but unfortunately at the same moment More's attention, as he is reminded in a letter from Giles, was drawn off by a servant, and one of the company from a cold caught on shipboard coughed so loud as to prevent Giles from hearing. And 'the secret has perished' with him; to this day the place of Utopia remains unknown.

The words of Phaedrus, 'O Socrates, you can easily invent Egyptians or anything,' are recalled to our mind as we read this lifelike fiction. Yet the greater merit of the work is not the admirable art, but the originality of thought. More is as free as Plato from the prejudices of his age, and far more tolerant. The Utopians do not allow him who believes not in the immortality of the soul to share in the administration of the state (Laws), 'howbeit they put him to no punishment, because they be persuaded that it is in no man's power to believe what he list'; and 'no man is to be blamed for reasoning in support of his own religion ('One of our company in my presence was sharply punished. He, as soon as he was baptised, began, against our wills, with more earnest affection than wisdom, to reason of Christ's religion, and began to wax so hot in his matter, that he did not only prefer our religion before all other, but also did despise and condemn all other, calling them profane, and the followers of them wicked and devilish, and the children of everlasting damnation. When he had thus long reasoned the matter, they laid hold on him, accused him, and condemned him into exile, not as a despiser of religion, but as a seditious person and a raiser up of dissension among the people').' In the public services 'no prayers be used, but such as every man may boldly pronounce without giving offence to any sect.' He says significantly, 'There be that give worship to a man that was once of excellent virtue or of famous glory, not only as God, but also the chiefest and highest God. But the most and the wisest part, rejecting all these, believe that there is a certain godly power unknown, far above the capacity and reach of man's wit, dispersed throughout all the world, not in bigness, but in virtue and power. Him they call the Father of all. To Him alone they attribute the beginnings, the increasings, the proceedings, the changes, and the ends of all things. Neither give they any divine honours to any other than him.' So far was More from sharing the popular beliefs of his time. Yet at the end he reminds us that he does not in all respects agree with the customs and opinions of the Utopians which he describes. And we should let him have the benefit of this saving clause, and not rudely withdraw the veil behind which he has been pleased to conceal himself.

Nor is he less in advance of popular opinion in his political and moral speculations. He would like to bring military glory into contempt; he would set all sorts of idle people to profitable occupation, including in the same class, priests, women, noblemen, gentlemen, and 'sturdy and valiant beggars,' that the labour of all may be reduced to six hours a day. His dislike of capital punishment, and plans for the reformation of offenders; his detestation of priests and lawyers (Compare his satirical observation: 'They (the Utopians) have priests of exceeding holiness, and therefore very few.); his remark that 'although every one may hear of ravenous dogs and wolves and cruel man-eaters, it is not easy to find states that are well and wisely governed,' are curiously at variance with the notions of his age and indeed with his own life. There are many points in which he shows a modern feeling and a prophetic insight like Plato. He is a sanitary reformer; he maintains that civilized states have a right to the soil of waste countries; he is inclined to the opinion which places happiness in virtuous pleasures, but herein, as he thinks, not disagreeing from those other philosophers who define virtue to be a life according to nature. He extends the idea of happiness so as to include the happiness of others; and he argues ingeniously, 'All men agree that we ought to make others happy; but if others, how much more ourselves!' And still he thinks that there may be a more excellent way, but to this no man's reason can attain unless heaven should inspire him with a higher truth. His ceremonies before marriage; his humane proposal that war should be carried on by assassinating the leaders of the enemy, may be compared to some of the paradoxes of Plato. He has a charming fancy, like the affinities of Greeks and barbarians in the Timaeus, that the Utopians learnt the language of the Greeks with the more readiness because they were originally of the same race with them. He is penetrated with the spirit of Plato, and quotes or adapts many thoughts both from the Republic and from the Timaeus. He prefers public duties to private, and is somewhat impatient of the importunity of relations. His citizens have no silver or gold of their own, but are ready enough to pay them to their mercenaries. There is nothing of which he is more contemptuous than the love of money. Gold is used for fetters of criminals, and diamonds and pearls for children's necklaces (When the ambassadors came arrayed in gold and peacocks' feathers 'to the eyes of all the Utopians except very few, which had been in other countries for some reasonable cause, all that gorgeousness of apparel seemed shameful and reproachful. In so much that they most reverently saluted the vilest and most abject of them for lords—passing over the ambassadors themselves without any honour, judging them by their wearing of golden chains to be bondmen. You should have seen children also, that had cast away their pearls and precious stones, when they saw the like sticking upon the ambassadors' caps, dig and push their mothers under the sides, saying thus to them—&quot;Look, though he were a little child still.&quot; But the mother; yea and that also in good earnest: &quot;Peace, son,&quot; saith she, &quot;I think he be some of the ambassadors' fools.&quot;')

Like Plato he is full of satirical reflections on governments and princes; on the state of the world and of knowledge. The hero of his discourse (Hythloday) is very unwilling to become a minister of state, considering that he would lose his independence and his advice would never be heeded (Compare an exquisite passage, of which the conclusion is as follows: 'And verily it is naturally given...suppressed and ended.') He ridicules the new logic of his time; the Utopians could never be made to understand the doctrine of Second Intentions ('For they have not devised one of all those rules of restrictions, amplifications, and suppositions, very wittily invented in the small Logicals, which here our children in every place do learn. Furthermore, they were never yet able to find out the second intentions; insomuch that none of them all could ever see man himself in common, as they call him, though he be (as you know) bigger than was ever any giant, yea, and pointed to of us even with our finger.') He is very severe on the sports of the gentry; the Utopians count 'hunting the lowest, the vilest, and the most abject part of butchery.' He quotes the words of the Republic in which the philosopher is described 'standing out of the way under a wall until the driving storm of sleet and rain be overpast,' which admit of a singular application to More's own fate; although, writing twenty years before (about the year 1514), he can hardly be supposed to have foreseen this. There is no touch of satire which strikes deeper than his quiet remark that the greater part of the precepts of Christ are more at variance with the lives of ordinary Christians than the discourse of Utopia ('And yet the most part of them is more dissident from the manners of the world now a days, than my communication was. But preachers, sly and wily men, following your counsel (as I suppose) because they saw men evil-willing to frame their manners to Christ's rule, they have wrested and wried his doctrine, and, like a rule of lead, have applied it to men's manners, that by some means at the least way, they might agree together.')

The 'New Atlantis' is only a fragment, and far inferior in merit to the 'Utopia.' The work is full of ingenuity, but wanting in creative fancy, and by no means impresses the reader with a sense of credibility. In some places Lord Bacon is characteristically different from Sir Thomas More, as, for example, in the external state which he attributes to the governor of Solomon's House, whose dress he minutely describes, while to Sir Thomas More such trappings appear simple ridiculous. Yet, after this programme of dress, Bacon adds the beautiful trait, 'that he had a look as though he pitied men.' Several things are borrowed by him from the Timaeus; but he has injured the unity of style by adding thoughts and passages which are taken from the Hebrew Scriptures.

The 'City of the Sun' written by Campanella (1568-1639), a Dominican friar, several years after the 'New Atlantis' of Bacon, has many resemblances to the Republic of Plato. The citizens have wives and children in common; their marriages are of the same temporary sort, and are arranged by the magistrates from time to time. They do not, however, adopt his system of lots, but bring together the best natures, male and female, 'according to philosophical rules.' The infants until two years of age are brought up by their mothers in public temples; and since individuals for the most part educate their children badly, at the beginning of their third year they are committed to the care of the State, and are taught at first, not out of books, but from paintings of all kinds, which are emblazoned on the walls of the city. The city has six interior circuits of walls, and an outer wall which is the seventh. On this outer wall are painted the figures of legislators and philosophers, and on each of the interior walls the symbols or forms of some one of the sciences are delineated. The women are, for the most part, trained, like the men, in warlike and other exercises; but they have two special occupations of their own. After a battle, they and the boys soothe and relieve the wounded warriors; also they encourage them with embraces and pleasant words. Some elements of the Christian or Catholic religion are preserved among them. The life of the Apostles is greatly admired by this people because they had all things in common; and the short prayer which Jesus Christ taught men is used in their worship. It is a duty of the chief magistrates to pardon sins, and therefore the whole people make secret confession of them to the magistrates, and they to their chief, who is a sort of Rector Metaphysicus; and by this means he is well informed of all that is going on in the minds of men. After confession, absolution is granted to the citizens collectively, but no one is mentioned by name. There also exists among them a practice of perpetual prayer, performed by a succession of priests, who change every hour. Their religion is a worship of God in Trinity, that is of Wisdom, Love and Power, but without any distinction of persons. They behold in the sun the reflection of His glory; mere graven images they reject, refusing to fall under the 'tyranny' of idolatry.

Many details are given about their customs of eating and drinking, about their mode of dressing, their employments, their wars. Campanella looks forward to a new mode of education, which is to be a study of nature, and not of Aristotle. He would not have his citizens waste their time in the consideration of what he calls 'the dead signs of things.' He remarks that he who knows one science only, does not really know that one any more than the rest, and insists strongly on the necessity of a variety of knowledge. More scholars are turned out in the City of the Sun in one year than by contemporary methods in ten or fifteen. He evidently believes, like Bacon, that henceforward natural science will play a great part in education, a hope which seems hardly to have been realized, either in our own or in any former age; at any rate the fulfilment of it has been long deferred.

There is a good deal of ingenuity and even originality in this work, and a most enlightened spirit pervades it. But it has little or no charm of style, and falls very far short of the 'New Atlantis' of Bacon, and still more of the 'Utopia' of Sir Thomas More. It is full of inconsistencies, and though borrowed from Plato, shows but a superficial acquaintance with his writings. It is a work such as one might expect to have been written by a philosopher and man of genius who was also a friar, and who had spent twenty-seven years of his life in a prison of the Inquisition. The most interesting feature of the book, common to Plato and Sir Thomas More, is the deep feeling which is shown by the writer, of the misery and ignorance prevailing among the lower classes in his own time. Campanella takes note of Aristotle's answer to Plato's community of property, that in a society where all things are common, no individual would have any motive to work (Arist. Pol.): he replies, that his citizens being happy and contented in themselves (they are required to work only four hours a day), will have greater regard for their fellows than exists among men at present. He thinks, like Plato, that if he abolishes private feelings and interests, a great public feeling will take their place.

Other writings on ideal states, such as the 'Oceana' of Harrington, in which the Lord Archon, meaning Cromwell, is described, not as he was, but as he ought to have been; or the 'Argenis' of Barclay, which is an historical allegory of his own time, are too unlike Plato to be worth mentioning. More interesting than either of these, and far more Platonic in style and thought, is Sir John Eliot's 'Monarchy of Man,' in which the prisoner of the Tower, no longer able 'to be a politician in the land of his birth,' turns away from politics to view 'that other city which is within him,' and finds on the very threshold of the grave that the secret of human happiness is the mastery of self. The change of government in the time of the English Commonwealth set men thinking about first principles, and gave rise to many works of this class...The great original genius of Swift owes nothing to Plato; nor is there any trace in the conversation or in the works of Dr. Johnson of any acquaintance with his writings. He probably would have refuted Plato without reading him, in the same fashion in which he supposed himself to have refuted Bishop Berkeley's theory of the non-existence of matter. If we except the so-called English Platonists, or rather Neo-Platonists, who never understood their master, and the writings of Coleridge, who was to some extent a kindred spirit, Plato has left no permanent impression on English literature.

7. Human life and conduct are affected by ideals in the same way that they are affected by the examples of eminent men. Neither the one nor the other are immediately applicable to practice, but there is a virtue flowing from them which tends to raise individuals above the common routine of society or trade, and to elevate States above the mere interests of commerce or the necessities of self-defence. Like the ideals of art they are partly framed by the omission of particulars; they require to be viewed at a certain distance, and are apt to fade away if we attempt to approach them. They gain an imaginary distinctness when embodied in a State or in a system of philosophy, but they still remain the visions of 'a world unrealized.' More striking and obvious to the ordinary mind are the examples of great men, who have served their own generation and are remembered in another. Even in our own family circle there may have been some one, a woman, or even a child, in whose face has shone forth a goodness more than human. The ideal then approaches nearer to us, and we fondly cling to it. The ideal of the past, whether of our own past lives or of former states of society, has a singular fascination for the minds of many. Too late we learn that such ideals cannot be recalled, though the recollection of them may have a humanizing influence on other times. But the abstractions of philosophy are to most persons cold and vacant; they give light without warmth; they are like the full moon in the heavens when there are no stars appearing. Men cannot live by thought alone; the world of sense is always breaking in upon them. They are for the most part confined to a corner of earth, and see but a little way beyond their own home or place of abode; they 'do not lift up their eyes to the hills'; they are not awake when the dawn appears. But in Plato we have reached a height from which a man may look into the distance and behold the future of the world and of philosophy. The ideal of the State and of the life of the philosopher; the ideal of an education continuing through life and extending equally to both sexes; the ideal of the unity and correlation of knowledge; the faith in good and immortality—are the vacant forms of light on which Plato is seeking to fix the eye of mankind.

8. Two other ideals, which never appeared above the horizon in Greek Philosophy, float before the minds of men in our own day: one seen more clearly than formerly, as though each year and each generation brought us nearer to some great change; the other almost in the same degree retiring from view behind the laws of nature, as if oppressed by them, but still remaining a silent hope of we know not what hidden in the heart of man. The first ideal is the future of the human race in this world; the second the future of the individual in another. The first is the more perfect realization of our own present life; the second, the abnegation of it: the one, limited by experience, the other, transcending it. Both of them have been and are powerful motives of action; there are a few in whom they have taken the place of all earthly interests. The hope of a future for the human race at first sight seems to be the more disinterested, the hope of individual existence the more egotistical, of the two motives. But when men have learned to resolve their hope of a future either for themselves or for the world into the will of God—'not my will but Thine,' the difference between them falls away; and they may be allowed to make either of them the basis of their lives, according to their own individual character or temperament. There is as much faith in the willingness to work for an unseen future in this world as in another. Neither is it inconceivable that some rare nature may feel his duty to another generation, or to another century, almost as strongly as to his own, or that living always in the presence of God, he may realize another world as vividly as he does this.

The greatest of all ideals may, or rather must be conceived by us under similitudes derived from human qualities; although sometimes, like the Jewish prophets, we may dash away these figures of speech and describe the nature of God only in negatives. These again by degrees acquire a positive meaning. It would be well, if when meditating on the higher truths either of philosophy or religion, we sometimes substituted one form of expression for another, lest through the necessities of language we should become the slaves of mere words.

There is a third ideal, not the same, but akin to these, which has a place in the home and heart of every believer in the religion of Christ, and in which men seem to find a nearer and more familiar truth, the Divine man, the Son of Man, the Saviour of mankind, Who is the first-born and head of the whole family in heaven and earth, in Whom the Divine and human, that which is without and that which is within the range of our earthly faculties, are indissolubly united. Neither is this divine form of goodness wholly separable from the ideal of the Christian Church, which is said in the New Testament to be 'His body,' or at variance with those other images of good which Plato sets before us. We see Him in a figure only, and of figures of speech we select but a few, and those the simplest, to be the expression of Him. We behold Him in a picture, but He is not there. We gather up the fragments of His discourses, but neither do they represent Him as He truly was. His dwelling is neither in heaven nor earth, but in the heart of man. This is that image which Plato saw dimly in the distance, which, when existing among men, he called, in the language of Homer, 'the likeness of God,' the likeness of a nature which in all ages men have felt to be greater and better than themselves, and which in endless forms, whether derived from Scripture or nature, from the witness of history or from the human heart, regarded as a person or not as a person, with or without parts or passions, existing in space or not in space, is and will always continue to be to mankind the Idea of Good.</pre>
</div>
<div created="20150302211028466" modified="20150302215042010" tags="" title="Plato's Republic">
<pre>PERSONS OF THE DIALOGUE:

* Socrates, who is the narrator.
* Glaucon.
* Adeimantus.
* Polemarchus.
* Cephalus.
* Thrasymachus.
* Cleitophon.
* And others who are mute auditors.

The scene is laid in the house of Cephalus at the Piraeus; and the whole
dialogue is narrated by Socrates the day after it actually took place to
Timaeus, Hermocrates, Critias, and a nameless person, who are introduced
in the Timaeus.

''Introductions''

* [[Introduction and Analysis by Benjamin Jowett]]

{{Book List}}</pre>
</div>

</div>


<!--~~ Library modules ~~-->
<div id="libraryModules" style="display:none;">
<script data-tiddler-library="yes" data-tiddler-title="$:/library/sjcl.js" data-tiddler-type="application/javascript" type="text/javascript">"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};
if(typeof module!="undefined"&&module.exports)module.exports=sjcl;
sjcl.cipher.aes=function(a){this.h[0][0][0]||this.z();var b,c,d,e,f=this.h[0][4],g=this.h[1];b=a.length;var h=1;if(b!==4&&b!==6&&b!==8)throw new sjcl.exception.invalid("invalid aes key size");this.a=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(a%b===0||b===8&&a%b===4){c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255];if(a%b===0){c=c<<8^c>>>24^h<<24;h=h<<1^(h>>7)*283}}d[a]=d[a-b]^c}for(b=0;a;b++,a--){c=d[b&3?a:a-4];e[b]=a<=4||b<4?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^
g[3][f[c&255]]}};
sjcl.cipher.aes.prototype={encrypt:function(a){return this.I(a,0)},decrypt:function(a){return this.I(a,1)},h:[[[],[],[],[],[]],[[],[],[],[],[]]],z:function(){var a=this.h[0],b=this.h[1],c=a[4],d=b[4],e,f,g,h=[],i=[],k,j,l,m;for(e=0;e<0x100;e++)i[(h[e]=e<<1^(e>>7)*283)^e]=e;for(f=g=0;!c[f];f^=k||1,g=i[g]||1){l=g^g<<1^g<<2^g<<3^g<<4;l=l>>8^l&255^99;c[f]=l;d[l]=f;j=h[e=h[k=h[f]]];m=j*0x1010101^e*0x10001^k*0x101^f*0x1010100;j=h[l]*0x101^l*0x1010100;for(e=0;e<4;e++){a[e][f]=j=j<<24^j>>>8;b[e][l]=m=m<<24^m>>>8}}for(e=
0;e<5;e++){a[e]=a[e].slice(0);b[e]=b[e].slice(0)}},I:function(a,b){if(a.length!==4)throw new sjcl.exception.invalid("invalid aes block size");var c=this.a[b],d=a[0]^c[0],e=a[b?3:1]^c[1],f=a[2]^c[2];a=a[b?1:3]^c[3];var g,h,i,k=c.length/4-2,j,l=4,m=[0,0,0,0];g=this.h[b];var n=g[0],o=g[1],p=g[2],q=g[3],r=g[4];for(j=0;j<k;j++){g=n[d>>>24]^o[e>>16&255]^p[f>>8&255]^q[a&255]^c[l];h=n[e>>>24]^o[f>>16&255]^p[a>>8&255]^q[d&255]^c[l+1];i=n[f>>>24]^o[a>>16&255]^p[d>>8&255]^q[e&255]^c[l+2];a=n[a>>>24]^o[d>>16&
255]^p[e>>8&255]^q[f&255]^c[l+3];l+=4;d=g;e=h;f=i}for(j=0;j<4;j++){m[b?3&-j:j]=r[d>>>24]<<24^r[e>>16&255]<<16^r[f>>8&255]<<8^r[a&255]^c[l++];g=d;d=e;e=f;f=a;a=g}return m}};
sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.P(a.slice(b/32),32-(b&31)).slice(1);return c===undefined?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(a.length===0||b.length===0)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return d===32?a.concat(b):sjcl.bitArray.P(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;
if(b===0)return 0;return(b-1)*32+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(a.length*32<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b&=31;if(c>0&&b)a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1);return a},partial:function(a,b,c){if(a===32)return b;return(c?b|0:b<<32-a)+a*0x10000000000},getPartial:function(a){return Math.round(a/0x10000000000)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return false;var c=0,d;for(d=0;d<a.length;d++)c|=
a[d]^b[d];return c===0},P:function(a,b,c,d){var e;e=0;if(d===undefined)d=[];for(;b>=32;b-=32){d.push(c);c=0}if(b===0)return d.concat(a);for(e=0;e<a.length;e++){d.push(c|a[e]>>>b);c=a[e]<<32-b}e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,b+a>32?c:d.pop(),1));return d},k:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}};
sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++){if((d&3)===0)e=a[d/4];b+=String.fromCharCode(e>>>24);e<<=8}return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++){d=d<<8|a.charCodeAt(c);if((c&3)===3){b.push(d);d=0}}c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};
sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\s|0x/g,"");d=a.length;a+="00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,d*4)}};
sjcl.codec.base64={F:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjcl.codec.base64.F,g=0,h=sjcl.bitArray.bitLength(a);if(c)f=f.substr(0,62)+"-_";for(c=0;d.length*6<h;){d+=f.charAt((g^a[c]>>>e)>>>26);if(e<6){g=a[c]<<6-e;e+=26;c++}else{g<<=6;e-=6}}for(;d.length&3&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\s|=/g,"");var c=[],d=0,e=sjcl.codec.base64.F,f=0,g;if(b)e=e.substr(0,62)+"-_";for(b=0;b<a.length;b++){g=e.indexOf(a.charAt(b));
if(g<0)throw new sjcl.exception.invalid("this isn't base64!");if(d>26){d-=26;c.push(f^g>>>d);f=g<<32-d}else{d+=6;f^=g<<32-d}}d&56&&c.push(sjcl.bitArray.partial(d&56,f,1));return c}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.hash.sha256=function(a){this.a[0]||this.z();if(a){this.n=a.n.slice(0);this.i=a.i.slice(0);this.e=a.e}else this.reset()};sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256).update(a).finalize()};
sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.n=this.N.slice(0);this.i=[];this.e=0;return this},update:function(a){if(typeof a==="string")a=sjcl.codec.utf8String.toBits(a);var b,c=this.i=sjcl.bitArray.concat(this.i,a);b=this.e;a=this.e=b+sjcl.bitArray.bitLength(a);for(b=512+b&-512;b<=a;b+=512)this.D(c.splice(0,16));return this},finalize:function(){var a,b=this.i,c=this.n;b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.e/
4294967296));for(b.push(this.e|0);b.length;)this.D(b.splice(0,16));this.reset();return c},N:[],a:[],z:function(){function a(e){return(e-Math.floor(e))*0x100000000|0}var b=0,c=2,d;a:for(;b<64;c++){for(d=2;d*d<=c;d++)if(c%d===0)continue a;if(b<8)this.N[b]=a(Math.pow(c,0.5));this.a[b]=a(Math.pow(c,1/3));b++}},D:function(a){var b,c,d=a.slice(0),e=this.n,f=this.a,g=e[0],h=e[1],i=e[2],k=e[3],j=e[4],l=e[5],m=e[6],n=e[7];for(a=0;a<64;a++){if(a<16)b=d[a];else{b=d[a+1&15];c=d[a+14&15];b=d[a&15]=(b>>>7^b>>>18^
b>>>3^b<<25^b<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+d[a&15]+d[a+9&15]|0}b=b+n+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(m^j&(l^m))+f[a];n=m;m=l;l=j;j=k+b|0;k=i;i=h;h=g;g=b+(h&i^k&(h^i))+(h>>>2^h>>>13^h>>>22^h<<30^h<<19^h<<10)|0}e[0]=e[0]+g|0;e[1]=e[1]+h|0;e[2]=e[2]+i|0;e[3]=e[3]+k|0;e[4]=e[4]+j|0;e[5]=e[5]+l|0;e[6]=e[6]+m|0;e[7]=e[7]+n|0}};
sjcl.mode.ccm={name:"ccm",encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,i=h.bitLength(c)/8,k=h.bitLength(g)/8;e=e||64;d=d||[];if(i<7)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;f<4&&k>>>8*f;f++);if(f<15-i)f=15-i;c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.H(a,b,c,d,e,f);g=sjcl.mode.ccm.J(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),i=f.clamp(b,h-e),k=f.bitSlice(b,
h-e);h=(h-e)/8;if(g<7)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;b<4&&h>>>8*b;b++);if(b<15-g)b=15-g;c=f.clamp(c,8*(15-b));i=sjcl.mode.ccm.J(a,i,c,k,e,b);a=sjcl.mode.ccm.H(a,i.data,c,d,e,b);if(!f.equal(i.tag,a))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return i.data},H:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,i=h.k;e/=8;if(e%2||e<4||e>16)throw new sjcl.exception.invalid("ccm: invalid tag length");if(d.length>0xffffffff||b.length>0xffffffff)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");
f=[h.partial(8,(d.length?64:0)|e-2<<2|f-1)];f=h.concat(f,c);f[3]|=h.bitLength(b)/8;f=a.encrypt(f);if(d.length){c=h.bitLength(d)/8;if(c<=65279)g=[h.partial(16,c)];else if(c<=0xffffffff)g=h.concat([h.partial(16,65534)],[c]);g=h.concat(g,d);for(d=0;d<g.length;d+=4)f=a.encrypt(i(f,g.slice(d,d+4).concat([0,0,0])))}for(d=0;d<b.length;d+=4)f=a.encrypt(i(f,b.slice(d,d+4).concat([0,0,0])));return h.clamp(f,e*8)},J:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.k;var i=b.length,k=h.bitLength(b);c=h.concat([h.partial(8,
f-1)],c).concat([0,0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!i)return{tag:d,data:[]};for(g=0;g<i;g+=4){c[3]++;e=a.encrypt(c);b[g]^=e[0];b[g+1]^=e[1];b[g+2]^=e[2];b[g+3]^=e[3]}return{tag:d,data:h.clamp(b,k)}}};
sjcl.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){if(sjcl.bitArray.bitLength(c)!==128)throw new sjcl.exception.invalid("ocb iv must be 128 bits");var g,h=sjcl.mode.ocb2.B,i=sjcl.bitArray,k=i.k,j=[0,0,0,0];c=h(a.encrypt(c));var l,m=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4){l=b.slice(g,g+4);j=k(j,l);m=m.concat(k(c,a.encrypt(k(c,l))));c=h(c)}l=b.slice(g);b=i.bitLength(l);g=a.encrypt(k(c,[0,0,0,b]));l=i.clamp(k(l.concat([0,0,0]),g),b);j=k(j,k(l.concat([0,0,0]),g));j=a.encrypt(k(j,k(c,h(c))));
if(d.length)j=k(j,f?d:sjcl.mode.ocb2.pmac(a,d));return m.concat(i.concat(l,i.clamp(j,e)))},decrypt:function(a,b,c,d,e,f){if(sjcl.bitArray.bitLength(c)!==128)throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var g=sjcl.mode.ocb2.B,h=sjcl.bitArray,i=h.k,k=[0,0,0,0],j=g(a.encrypt(c)),l,m,n=sjcl.bitArray.bitLength(b)-e,o=[];d=d||[];for(c=0;c+4<n/32;c+=4){l=i(j,a.decrypt(i(j,b.slice(c,c+4))));k=i(k,l);o=o.concat(l);j=g(j)}m=n-c*32;l=a.encrypt(i(j,[0,0,0,m]));l=i(l,h.clamp(b.slice(c),
m).concat([0,0,0]));k=i(k,l);k=a.encrypt(i(k,i(j,g(j))));if(d.length)k=i(k,f?d:sjcl.mode.ocb2.pmac(a,d));if(!h.equal(h.clamp(k,e),h.bitSlice(b,n)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return o.concat(h.clamp(l,m))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.B,e=sjcl.bitArray,f=e.k,g=[0,0,0,0],h=a.encrypt([0,0,0,0]);h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4){h=d(h);g=f(g,a.encrypt(f(h,b.slice(c,c+4))))}b=b.slice(c);if(e.bitLength(b)<128){h=f(h,d(h));b=e.concat(b,[2147483648|0,0,
0,0])}g=f(g,b);return a.encrypt(f(d(f(h,d(h))),g))},B:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^(a[0]>>>31)*135]}};sjcl.misc.hmac=function(a,b){this.M=b=b||sjcl.hash.sha256;var c=[[],[]],d=b.prototype.blockSize/32;this.l=[new b,new b];if(a.length>d)a=b.hash(a);for(b=0;b<d;b++){c[0][b]=a[b]^909522486;c[1][b]=a[b]^1549556828}this.l[0].update(c[0]);this.l[1].update(c[1])};
sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a,b){a=(new this.M(this.l[0])).update(a,b).finalize();return(new this.M(this.l[1])).update(a).finalize()};
sjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1E3;if(d<0||c<0)throw sjcl.exception.invalid("invalid params to pbkdf2");if(typeof a==="string")a=sjcl.codec.utf8String.toBits(a);e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,i,k=[],j=sjcl.bitArray;for(i=1;32*k.length<(d||1);i++){e=f=a.encrypt(j.concat(b,[i]));for(g=1;g<c;g++){f=a.encrypt(f);for(h=0;h<f.length;h++)e[h]^=f[h]}k=k.concat(e)}if(d)k=j.clamp(k,d);return k};
sjcl.random={randomWords:function(a,b){var c=[];b=this.isReady(b);var d;if(b===0)throw new sjcl.exception.notReady("generator isn't seeded");else b&2&&this.U(!(b&1));for(b=0;b<a;b+=4){(b+1)%0x10000===0&&this.L();d=this.w();c.push(d[0],d[1],d[2],d[3])}this.L();return c.slice(0,a)},setDefaultParanoia:function(a){this.t=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=(new Date).valueOf(),g=this.q[c],h=this.isReady(),i=0;d=this.G[c];if(d===undefined)d=this.G[c]=this.R++;if(g===undefined)g=this.q[c]=
0;this.q[c]=(this.q[c]+1)%this.b.length;switch(typeof a){case "number":if(b===undefined)b=1;this.b[g].update([d,this.u++,1,b,f,1,a|0]);break;case "object":c=Object.prototype.toString.call(a);if(c==="[object Uint32Array]"){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else{if(c!=="[object Array]")i=1;for(c=0;c<a.length&&!i;c++)if(typeof a[c]!="number")i=1}if(!i){if(b===undefined)for(c=b=0;c<a.length;c++)for(e=a[c];e>0;){b++;e>>>=1}this.b[g].update([d,this.u++,2,b,f,a.length].concat(a))}break;case "string":if(b===
undefined)b=a.length;this.b[g].update([d,this.u++,3,b,f,a.length]);this.b[g].update(a);break;default:i=1}if(i)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.j[g]+=b;this.f+=b;if(h===0){this.isReady()!==0&&this.K("seeded",Math.max(this.g,this.f));this.K("progress",this.getProgress())}},isReady:function(a){a=this.C[a!==undefined?a:this.t];return this.g&&this.g>=a?this.j[0]>80&&(new Date).valueOf()>this.O?3:1:this.f>=a?2:0},getProgress:function(a){a=
this.C[a?a:this.t];return this.g>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.m){if(window.addEventListener){window.addEventListener("load",this.o,false);window.addEventListener("mousemove",this.p,false)}else if(document.attachEvent){document.attachEvent("onload",this.o);document.attachEvent("onmousemove",this.p)}else throw new sjcl.exception.bug("can't attach event");this.m=true}},stopCollectors:function(){if(this.m){if(window.removeEventListener){window.removeEventListener("load",
this.o,false);window.removeEventListener("mousemove",this.p,false)}else if(window.detachEvent){window.detachEvent("onload",this.o);window.detachEvent("onmousemove",this.p)}this.m=false}},addEventListener:function(a,b){this.r[a][this.Q++]=b},removeEventListener:function(a,b){var c;a=this.r[a];var d=[];for(c in a)a.hasOwnProperty(c)&&a[c]===b&&d.push(c);for(b=0;b<d.length;b++){c=d[b];delete a[c]}},b:[new sjcl.hash.sha256],j:[0],A:0,q:{},u:0,G:{},R:0,g:0,f:0,O:0,a:[0,0,0,0,0,0,0,0],d:[0,0,0,0],s:undefined,
t:6,m:false,r:{progress:{},seeded:{}},Q:0,C:[0,48,64,96,128,192,0x100,384,512,768,1024],w:function(){for(var a=0;a<4;a++){this.d[a]=this.d[a]+1|0;if(this.d[a])break}return this.s.encrypt(this.d)},L:function(){this.a=this.w().concat(this.w());this.s=new sjcl.cipher.aes(this.a)},T:function(a){this.a=sjcl.hash.sha256.hash(this.a.concat(a));this.s=new sjcl.cipher.aes(this.a);for(a=0;a<4;a++){this.d[a]=this.d[a]+1|0;if(this.d[a])break}},U:function(a){var b=[],c=0,d;this.O=b[0]=(new Date).valueOf()+3E4;for(d=
0;d<16;d++)b.push(Math.random()*0x100000000|0);for(d=0;d<this.b.length;d++){b=b.concat(this.b[d].finalize());c+=this.j[d];this.j[d]=0;if(!a&&this.A&1<<d)break}if(this.A>=1<<this.b.length){this.b.push(new sjcl.hash.sha256);this.j.push(0)}this.f-=c;if(c>this.g)this.g=c;this.A++;this.T(b)},p:function(a){sjcl.random.addEntropy([a.x||a.clientX||a.offsetX||0,a.y||a.clientY||a.offsetY||0],2,"mouse")},o:function(){sjcl.random.addEntropy((new Date).valueOf(),2,"loadtime")},K:function(a,b){var c;a=sjcl.random.r[a];
var d=[];for(c in a)a.hasOwnProperty(c)&&d.push(a[c]);for(c=0;c<d.length;c++)d[c](b)}};try{var s=new Uint32Array(32);crypto.getRandomValues(s);sjcl.random.addEntropy(s,1024,"crypto['getRandomValues']")}catch(t){}
sjcl.json={defaults:{v:1,iter:1E3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.c({iv:sjcl.random.randomWords(4,0)},e.defaults),g;e.c(f,c);c=f.adata;if(typeof f.salt==="string")f.salt=sjcl.codec.base64.toBits(f.salt);if(typeof f.iv==="string")f.iv=sjcl.codec.base64.toBits(f.iv);if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||typeof a==="string"&&f.iter<=100||f.ts!==64&&f.ts!==96&&f.ts!==128||f.ks!==128&&f.ks!==192&&f.ks!==0x100||f.iv.length<
2||f.iv.length>4)throw new sjcl.exception.invalid("json encrypt: invalid parameters");if(typeof a==="string"){g=sjcl.misc.cachedPbkdf2(a,f);a=g.key.slice(0,f.ks/32);f.salt=g.salt}if(typeof b==="string")b=sjcl.codec.utf8String.toBits(b);if(typeof c==="string")c=sjcl.codec.utf8String.toBits(c);g=new sjcl.cipher[f.cipher](a);e.c(d,f);d.key=a;f.ct=sjcl.mode[f.mode].encrypt(g,b,f.iv,c,f.ts);return e.encode(f)},decrypt:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.c(e.c(e.c({},e.defaults),e.decode(b)),
c,true);var f;c=b.adata;if(typeof b.salt==="string")b.salt=sjcl.codec.base64.toBits(b.salt);if(typeof b.iv==="string")b.iv=sjcl.codec.base64.toBits(b.iv);if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||typeof a==="string"&&b.iter<=100||b.ts!==64&&b.ts!==96&&b.ts!==128||b.ks!==128&&b.ks!==192&&b.ks!==0x100||!b.iv||b.iv.length<2||b.iv.length>4)throw new sjcl.exception.invalid("json decrypt: invalid parameters");if(typeof a==="string"){f=sjcl.misc.cachedPbkdf2(a,b);a=f.key.slice(0,b.ks/32);b.salt=f.salt}if(typeof c===
"string")c=sjcl.codec.utf8String.toBits(c);f=new sjcl.cipher[b.cipher](a);c=sjcl.mode[b.mode].decrypt(f,b.ct,b.iv,c,b.ts);e.c(d,b);d.key=a;return sjcl.codec.utf8String.fromBits(c)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");c+=d+'"'+b+'":';d=",";switch(typeof a[b]){case "number":case "boolean":c+=a[b];break;case "string":c+='"'+escape(a[b])+'"';break;case "object":c+='"'+
sjcl.codec.base64.fromBits(a[b],1)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type");}}return c+"}"},decode:function(a){a=a.replace(/\s/g,"");if(!a.match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");a=a.replace(/^\{|\}$/g,"").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){if(!(d=a[c].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");b[d[2]]=
d[3]?parseInt(d[3],10):d[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(d[4]):unescape(d[4])}return b},c:function(a,b,c){if(a===undefined)a={};if(b===undefined)return a;var d;for(d in b)if(b.hasOwnProperty(d)){if(c&&a[d]!==undefined&&a[d]!==b[d])throw new sjcl.exception.invalid("required parameter overridden");a[d]=b[d]}return a},W:function(a,b){var c={},d;for(d in a)if(a.hasOwnProperty(d)&&a[d]!==b[d])c[d]=a[d];return c},V:function(a,b){var c={},d;for(d=0;d<b.length;d++)if(a[b[d]]!==undefined)c[b[d]]=
a[b[d]];return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.S={};sjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.S,d;b=b||{};d=b.iter||1E3;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=b.salt===undefined?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d[c].slice(0),salt:c.slice(0)}};</script>
</div>
<!--~~ Boot kernel prologue ~~-->
<div id="bootKernelPrefix" style="display:none;">
<script data-tiddler-title="$:/boot/bootprefix.js" data-tiddler-type="application/javascript" type="text/javascript">/*\
title: $:/boot/bootprefix.js
type: application/javascript

This file sets up the globals that need to be available when JavaScript modules are executed in the browser. The overall sequence is:

# BootPrefix.js
# <module definitions>
# Boot.js

See Boot.js for further details of the boot process.

\*/

var _bootprefix = (function($tw) {

"use strict";

$tw = $tw || Object.create(null);
$tw.boot = $tw.boot || Object.create(null);

// Detect platforms
$tw.browser = typeof(window) !== "undefined" ? {} : null;
$tw.node = typeof(process) === "object" ? {} : null;
$tw.nodeWebKit = $tw.node && global.window && global.window.nwDispatcher ? {} : null;

// Set default boot tasks
$tw.boot.tasks = {
	trapErrors: !!($tw.browser && !$tw.node),
	readBrowserTiddlers: !!($tw.browser && !$tw.node)
};

/*
Information about each module is kept in an object with these members:
	moduleType: type of module
	definition: object, function or string defining the module; see below
	exports: exports of the module, filled in after execution

The `definition` can be of several types:

* An object can be used to directly specify the exports of the module
* A function with the arguments `module,require,exports` that returns `exports`
* A string function body with the same arguments

Each moduleInfo object is stored in two hashmaps: $tw.modules.titles and $tw.modules.types. The first is indexed by title and the second is indexed by type and then title
*/
$tw.modules = {
	titles: {}, // hashmap by module name of moduleInfo
	types: {} // hashmap by module type and then name of moduleInfo
};

/*
Define a JavaScript tiddler module for later execution
	moduleName: name of module being defined
	moduleType: type of module
	definition: module definition; see discussion above
*/
$tw.modules.define = function(moduleName,moduleType,definition) {
	// Create the moduleInfo
	var moduleInfo = {
		moduleType: moduleType,
		definition: definition,
		exports: undefined
	};
	// If the definition is already an object we can use it as the exports
	if(typeof moduleInfo.definition === "object") {
		moduleInfo.exports = definition;
	}
	// Store the module in the titles hashmap
	if(Object.prototype.hasOwnProperty.call($tw.modules.titles,moduleName)) {
		console.log("Warning: Redefined module - " + moduleName);
	}
	$tw.modules.titles[moduleName] = moduleInfo;
	// Store the module in the types hashmap
	if(!Object.prototype.hasOwnProperty.call($tw.modules.types,moduleType)) {
		$tw.modules.types[moduleType] = {};
	}
	if(Object.prototype.hasOwnProperty.call($tw.modules.types[moduleType],moduleName)) {
		console.log("Warning: Redefined module - " + moduleName);
	}
	$tw.modules.types[moduleType][moduleName] = moduleInfo;
};

/*
External JavaScript can populate this array before calling boot.js in order to preload tiddlers
*/
$tw.preloadTiddlers = $tw.preloadTiddlers || [];

/*
Convenience function for pushing a tiddler onto the preloading array
*/
$tw.preloadTiddler = function(fields) {
	$tw.preloadTiddlers.push(fields);
};

return $tw

});

if(typeof(exports) === "undefined") {
	// Set up $tw global for the browser
	window.$tw = _bootprefix(window.$tw);
} else {
	// Export functionality as a module
	exports.bootprefix = _bootprefix;
}
</script>
</div>
<!--~~ Boot kernel ~~-->
<div id="bootKernel" style="display:none;">
<script data-tiddler-title="$:/boot/boot.js" data-tiddler-type="application/javascript" type="text/javascript">/*\
title: $:/boot/boot.js
type: application/javascript

The main boot kernel for TiddlyWiki. This single file creates a barebones TW environment that is just sufficient to bootstrap the modules containing the main logic of the application.

On the server this file is executed directly to boot TiddlyWiki. In the browser, this file is packed into a single HTML file.

\*/

var _boot = (function($tw) {

/*jslint node: true, browser: true */
/*global modules: false, $tw: false */
"use strict";

// Include bootprefix if we're not given module data
if(!$tw) {
	$tw = require("./bootprefix.js").bootprefix();
}

$tw.utils = $tw.utils || Object.create(null);

/////////////////////////// Standard node.js libraries

var fs, path, vm;
if($tw.node) {
	fs = require("fs");
	path = require("path");
	vm = require("vm");
}

/////////////////////////// Utility functions

$tw.boot.log = function(str) {
	$tw.boot.logMessages = $tw.boot.logMessages || [];
	$tw.boot.logMessages.push(str);
}

/*
Check if an object has a property
*/
$tw.utils.hop = function(object,property) {
	return object ? Object.prototype.hasOwnProperty.call(object,property) : false;
};

/*
Determine if a value is an array
*/
$tw.utils.isArray = function(value) {
	return Object.prototype.toString.call(value) == "[object Array]";
};

/*
Determine if a value is a date
*/
$tw.utils.isDate = function(value) {
	return Object.prototype.toString.call(value) === "[object Date]";
};

/*
Iterate through all the own properties of an object or array. Callback is invoked with (element,title,object)
*/
$tw.utils.each = function(object,callback) {
	var next,f;
	if(object) {
		if(Object.prototype.toString.call(object) == "[object Array]") {
			for (f=0; f<object.length; f++) {
				next = callback(object[f],f,object);
				if(next === false) {
					break;
				}
		    }
		} else {
			for(f in object) {
				if(Object.prototype.hasOwnProperty.call(object,f)) {
					next = callback(object[f],f,object);
					if(next === false) {
						break;
					}
				}
			}
		}
	}
};

/*
Helper for making DOM elements
tag: tag name
options: see below
Options include:
attributes: hashmap of attribute values
text: text to add as a child node
children: array of further child nodes
innerHTML: optional HTML for element
class: class name(s)
document: defaults to current document
eventListeners: array of event listeners (this option won't work until $tw.utils.addEventListeners() has been loaded)
*/
$tw.utils.domMaker = function(tag,options) {
	var doc = options.document || document;
	var element = doc.createElement(tag);
	if(options["class"]) {
		element.className = options["class"];
	}
	if(options.text) {
		element.appendChild(doc.createTextNode(options.text));
	}
	$tw.utils.each(options.children,function(child) {
		element.appendChild(child);
	});
	if(options.innerHTML) {
		element.innerHTML = options.innerHTML;
	}
	$tw.utils.each(options.attributes,function(attribute,name) {
		element.setAttribute(name,attribute);
	});
	if(options.eventListeners) {
		$tw.utils.addEventListeners(element,options.eventListeners);
	}
	return element;
};

/*
Display an error and exit
*/
$tw.utils.error = function(err) {
	// Prepare the error message
	var errHeading = "Internal JavaScript Error",
		promptMsg = "Well, this is embarrassing. It is recommended that you restart TiddlyWiki by refreshing your browser";
	// Log the error to the console
	console.error($tw.node ? "\x1b[1;31m" + err + "\x1b[0m" : err);
	if($tw.browser && !$tw.node) {
		// Display an error message to the user
		var dm = $tw.utils.domMaker,
			heading = dm("h1",{text: errHeading}),
			prompt = dm("div",{text: promptMsg, "class": "tc-error-prompt"}),
			message = dm("div",{text: err}),
			button = dm("button",{text: "close"}),
			form = dm("form",{children: [heading,prompt,message,button], "class": "tc-error-form"});
		document.body.insertBefore(form,document.body.firstChild);
		form.addEventListener("submit",function(event) {
			document.body.removeChild(form);
			event.preventDefault();
			return false;
		},true);
		return null;
	} else if(!$tw.browser) {
		// Exit if we're under node.js
		process.exit(1);
	}
};

/*
Use our custom error handler if we're in the browser
*/
if($tw.boot.tasks.trapErrors) {
	window.onerror = function(errorMsg,url,lineNumber) {
		$tw.utils.error(errorMsg);
		return false;
	};
}

/*
Extend an object with the properties from a list of source objects
*/
$tw.utils.extend = function(object /*, sourceObjectList */) {
	$tw.utils.each(Array.prototype.slice.call(arguments,1),function(source) {
		if(source) {
			for (var p in source) {
				object[p] = source[p];
			}
		}
	});
	return object;
};

/*
Fill in any null or undefined properties of an object with the properties from a list of source objects. Each property that is an object is called recursively
*/
$tw.utils.deepDefaults = function(object /*, sourceObjectList */) {
	$tw.utils.each(Array.prototype.slice.call(arguments,1),function(source) {
		if(source) {
			for (var p in source) {
				if(object[p] === null || object[p] === undefined) {
					object[p] = source[p];
				}
				if(typeof object[p] === "object" && typeof source[p] === "object") {
					$tw.utils.deepDefaults(object[p],source[p]);
				}
			}
		}
	});
	return object;
};

/*
Convert "&amp;" to &, "&nbsp;" to nbsp, "&lt;" to <, "&gt;" to > and "&quot;" to "
*/
$tw.utils.htmlDecode = function(s) {
	return s.toString().replace(/&lt;/mg,"<").replace(/&nbsp;/mg,"\xA0").replace(/&gt;/mg,">").replace(/&quot;/mg,"\"").replace(/&amp;/mg,"&");
};

/*
Get the browser location.hash. We don't use location.hash because of the way that Firefox auto-urldecodes it (see http://stackoverflow.com/questions/1703552/encoding-of-window-location-hash)
*/
$tw.utils.getLocationHash = function() {
	var parts = window.location.href.split('#');
	return "#" + (parts.length > 1 ? parts[1] : "");
};

/*
Pad a string to a given length with "0"s. Length defaults to 2
*/
$tw.utils.pad = function(value,length) {
	length = length || 2;
	var s = value.toString();
	if(s.length < length) {
		s = "000000000000000000000000000".substr(0,length - s.length) + s;
	}
	return s;
};

// Convert a date into UTC YYYYMMDDHHMMSSmmm format
$tw.utils.stringifyDate = function(value) {
	return value.getUTCFullYear() +
			$tw.utils.pad(value.getUTCMonth() + 1) +
			$tw.utils.pad(value.getUTCDate()) +
			$tw.utils.pad(value.getUTCHours()) +
			$tw.utils.pad(value.getUTCMinutes()) +
			$tw.utils.pad(value.getUTCSeconds()) +
			$tw.utils.pad(value.getUTCMilliseconds(),3);
};

// Parse a date from a UTC YYYYMMDDHHMMSSmmm format string
$tw.utils.parseDate = function(value) {
	if(typeof value === "string") {
		return new Date(Date.UTC(parseInt(value.substr(0,4),10),
				parseInt(value.substr(4,2),10)-1,
				parseInt(value.substr(6,2),10),
				parseInt(value.substr(8,2)||"00",10),
				parseInt(value.substr(10,2)||"00",10),
				parseInt(value.substr(12,2)||"00",10),
				parseInt(value.substr(14,3)||"000",10)));
	} else if($tw.utils.isDate(value)) {
		return value;
	} else {
		return null;
	}
};

// Stringify an array of tiddler titles into a list string
$tw.utils.stringifyList = function(value) {
	var result = [];
	for(var t=0; t<value.length; t++) {
		if(value[t].indexOf(" ") !== -1) {
			result.push("[[" + value[t] + "]]");
		} else {
			result.push(value[t]);
		}
	}
	return result.join(" ");
};

// Parse a string array from a bracketted list. For example "OneTiddler [[Another Tiddler]] LastOne"
$tw.utils.parseStringArray = function(value) {
	if(typeof value === "string") {
		var memberRegExp = /(?:^|[^\S\xA0])(?:\[\[(.*?)\]\])(?=[^\S\xA0]|$)|([\S\xA0]+)/mg,
			results = [],
			match;
		do {
			match = memberRegExp.exec(value);
			if(match) {
				var item = match[1] || match[2];
				if(item !== undefined && results.indexOf(item) === -1) {
					results.push(item);
				}
			}
		} while(match);
		return results;
	} else if($tw.utils.isArray(value)) {
		return value;
	} else {
		return null;
	}
};

// Parse a block of name:value fields. The `fields` object is used as the basis for the return value
$tw.utils.parseFields = function(text,fields) {
	fields = fields || Object.create(null);
	text.split(/\r?\n/mg).forEach(function(line) {
		if(line.charAt(0) !== "#") {
			var p = line.indexOf(":");
			if(p !== -1) {
				var field = line.substr(0, p).trim(),
					value = line.substr(p+1).trim();
				fields[field] = value;
			}
		}
	});
	return fields;
};

/*
Resolves a source filepath delimited with `/` relative to a specified absolute root filepath.
In relative paths, the special folder name `..` refers to immediate parent directory, and the
name `.` refers to the current directory
*/
$tw.utils.resolvePath = function(sourcepath,rootpath) {
	// If the source path starts with ./ or ../ then it is relative to the root
	if(sourcepath.substr(0,2) === "./" || sourcepath.substr(0,3) === "../" ) {
		var src = sourcepath.split("/"),
			root = rootpath.split("/");
		// Remove the filename part of the root
		root.splice(root.length-1,1);
		// Process the source path bit by bit onto the end of the root path
		while(src.length > 0) {
			var c = src.shift();
			if(c === "..") { // Slice off the last root entry for a double dot
				if(root.length > 0) {
					root.splice(root.length-1,1);
				}
			} else if(c !== ".") { // Ignore dots
				root.push(c); // Copy other elements across
			}
		}
		return root.join("/");
	} else {
		// If it isn't relative, just return the path
		if(rootpath) {
			var root = rootpath.split("/");
			// Remove the filename part of the root
			root.splice(root.length - 1, 1);
			return root.join("/") + "/" + sourcepath;
		} else {
			return sourcepath;
		}
	}
};

/*
Parse a semantic version string into its constituent parts
*/
$tw.utils.parseVersion = function(version) {
	var match = /^((\d+)\.(\d+)\.(\d+))(?:-([\dA-Za-z\-]+(?:\.[\dA-Za-z\-]+)*))?(?:\+([\dA-Za-z\-]+(?:\.[\dA-Za-z\-]+)*))?$/.exec(version);
	if(match) {
		return {
			version: match[1],
			major: parseInt(match[2],10),
			minor: parseInt(match[3],10),
			patch: parseInt(match[4],10),
			prerelease: match[5],
			build: match[6]
		};
	} else {
		return null;
	}
};

/*
Returns true if the version string A is greater than the version string B. Returns true if the versions are the same
*/
$tw.utils.checkVersions = function(versionStringA,versionStringB) {
	var defaultVersion = {
			major: 0,
			minor: 0,
			patch: 0
		},
		versionA = $tw.utils.parseVersion(versionStringA) || defaultVersion,
		versionB = $tw.utils.parseVersion(versionStringB) || defaultVersion,
		diff = [
			versionA.major - versionB.major,
			versionA.minor - versionB.minor,
			versionA.patch - versionB.patch
		];
	return (diff[0] > 0) ||
		(diff[0] === 0 && diff[1] > 0) ||
		(diff[0] === 0 && diff[1] === 0 && diff[2] > 0) ||
		(diff[0] === 0 && diff[1] === 0 && diff[2] === 0);
};

/*
Register file type information
options: {flags: flags,deserializerType: deserializerType}
	flags:"image" for image types
	deserializerType: defaults to type if not specified
*/
$tw.utils.registerFileType = function(type,encoding,extension,options) {
	options = options || {};
	if($tw.utils.isArray(extension)) {
		$tw.utils.each(extension,function(extension) {
			$tw.config.fileExtensionInfo[extension] = {type: type};
		});
		extension = extension[0];
	} else {
		$tw.config.fileExtensionInfo[extension] = {type: type};
	}
	$tw.config.contentTypeInfo[type] = {encoding: encoding, extension: extension, flags: options.flags || [], deserializerType: options.deserializerType || type};
};

/*
Given an extension, get the correct encoding for that file.
defaults to utf8
*/
$tw.utils.getTypeEncoding = function(ext) {
	var extensionInfo = $tw.config.fileExtensionInfo[ext],
		type = extensionInfo ? extensionInfo.type : null,
		typeInfo = type ? $tw.config.contentTypeInfo[type] : null;
	return typeInfo ? typeInfo.encoding : "utf8";
};

/*
Run code globally with specified context variables in scope
*/
$tw.utils.evalGlobal = function(code,context,filename) {
	var contextCopy = $tw.utils.extend(Object.create(null),context);
	// Get the context variables as a pair of arrays of names and values
	var contextNames = [], contextValues = [];
	$tw.utils.each(contextCopy,function(value,name) {
		contextNames.push(name);
		contextValues.push(value);
	});
	// Add the code prologue and epilogue
	code = "(function(" + contextNames.join(",") + ") {(function(){\n" + code + "\n;})();\nreturn exports;\n})\n";
	// Compile the code into a function
	var fn;
	if($tw.browser) {
		fn = window["eval"](code + "\n\n//# sourceURL=" + filename);
	} else {
		fn = vm.runInThisContext(code,filename);
	}
	// Call the function and return the exports
	return fn.apply(null,contextValues);
};

/*
Run code in a sandbox with only the specified context variables in scope
*/
$tw.utils.evalSandboxed = $tw.browser ? $tw.utils.evalGlobal : function(code,context,filename) {
	var sandbox = $tw.utils.extend(Object.create(null),context);
	vm.runInNewContext(code,sandbox,filename);
	return sandbox.exports;
};

/*
Creates a PasswordPrompt object
*/
$tw.utils.PasswordPrompt = function() {
	// Store of pending password prompts
	this.passwordPrompts = [];
	// Create the wrapper
	this.promptWrapper = $tw.utils.domMaker("div",{"class":"tc-password-wrapper"});
	document.body.appendChild(this.promptWrapper);
	// Hide the empty wrapper
	this.setWrapperDisplay();
};

/*
Hides or shows the wrapper depending on whether there are any outstanding prompts
*/
$tw.utils.PasswordPrompt.prototype.setWrapperDisplay = function() {
	if(this.passwordPrompts.length) {
		this.promptWrapper.style.display = "block";
	} else {
		this.promptWrapper.style.display = "none";
	}
};

/*
Adds a new password prompt. Options are:
submitText: text to use for submit button (defaults to "Login")
serviceName: text of the human readable service name
noUserName: set true to disable username prompt
canCancel: set true to enable a cancel button (callback called with null)
repeatPassword: set true to prompt for the password twice
callback: function to be called on submission with parameter of object {username:,password:}. Callback must return `true` to remove the password prompt
*/
$tw.utils.PasswordPrompt.prototype.createPrompt = function(options) {
	// Create and add the prompt to the DOM
	var self = this,
		submitText = options.submitText || "Login",
		dm = $tw.utils.domMaker,
		children = [dm("h1",{text: options.serviceName})];
	if(!options.noUserName) {
		children.push(dm("input",{
			attributes: {type: "text", name: "username", placeholder: "Username"}
		}));
	}
	children.push(dm("input",{
		attributes: {type: "password", name: "password", placeholder: "Password"}
	}));
	if(options.repeatPassword) {
		children.push(dm("input",{
			attributes: {type: "password", name: "password2", placeholder: "Repeat password"}
		}));
	}
	if(options.canCancel) {
		children.push(dm("button",{
			text: "Cancel",
			eventListeners: [{
					name: "click",
					handlerFunction: function(event) {
						self.removePrompt(promptInfo);
						options.callback(null);
					}
				}]
		}));
	}
	children.push(dm("button",{
		attributes: {type: "submit"},
		text: submitText
	}));
	var form = dm("form",{
		attributes: {autocomplete: "off"},
		children: children
	});
	this.promptWrapper.appendChild(form);
	window.setTimeout(function() {
		form.elements[0].focus();
	},10);
	// Add a submit event handler
	var self = this;
	form.addEventListener("submit",function(event) {
		// Collect the form data
		var data = {},t;
		$tw.utils.each(form.elements,function(element) {
			if(element.name && element.value) {
				data[element.name] = element.value;
			}
		});
		// Check that the passwords match
		if(options.repeatPassword && data.password !== data.password2) {
			alert("Passwords do not match");
		} else {
			// Call the callback
			if(options.callback(data)) {
				// Remove the prompt if the callback returned true
				self.removePrompt(promptInfo);
			} else {
				// Clear the password if the callback returned false
				$tw.utils.each(form.elements,function(element) {
					if(element.name === "password" || element.name === "password2") {
						element.value = "";
					}
				});
			}
		} 
		event.preventDefault();
		return false;
	},true);
	// Add the prompt to the list
	var promptInfo = {
		serviceName: options.serviceName,
		callback: options.callback,
		form: form
	};
	this.passwordPrompts.push(promptInfo);
	// Make sure the wrapper is displayed
	this.setWrapperDisplay();
};

$tw.utils.PasswordPrompt.prototype.removePrompt = function(promptInfo) {
	var i = this.passwordPrompts.indexOf(promptInfo);
	if(i !== -1) {
		this.passwordPrompts.splice(i,1);
		promptInfo.form.parentNode.removeChild(promptInfo.form);
		this.setWrapperDisplay();
	}
}

/*
Crypto helper object for encrypted content. It maintains the password text in a closure, and provides methods to change
the password, and to encrypt/decrypt a block of text
*/
$tw.utils.Crypto = function() {
	var sjcl = $tw.node ? require("./sjcl.js") : window.sjcl,
		currentPassword = null,
		callSjcl = function(method,inputText,password) {
			password = password || currentPassword;
			var outputText;
			try {
				if(password) {
					outputText = sjcl[method](password,inputText);
				}
			} catch(ex) {
				console.log("Crypto error:" + ex);
				outputText = null;
			}
			return outputText;
		};
	this.setPassword = function(newPassword) {
		currentPassword = newPassword;
		this.updateCryptoStateTiddler();
	};
	this.updateCryptoStateTiddler = function() {
		if($tw.wiki) {
			var state = currentPassword ? "yes" : "no",
				tiddler = $tw.wiki.getTiddler("$:/isEncrypted");
			if(!tiddler || tiddler.fields.text !== state) {
				$tw.wiki.addTiddler(new $tw.Tiddler({title: "$:/isEncrypted", text: state}));
			}
		}
	};
	this.hasPassword = function() {
		return !!currentPassword;
	}
	this.encrypt = function(text,password) {
		return callSjcl("encrypt",text,password);
	};
	this.decrypt = function(text,password) {
		return callSjcl("decrypt",text,password);
	};
};

/////////////////////////// Module mechanism

/*
Execute the module named 'moduleName'. The name can optionally be relative to the module named 'moduleRoot'
*/
$tw.modules.execute = function(moduleName,moduleRoot) {
	var name = moduleName[0] === "." ? $tw.utils.resolvePath(moduleName,moduleRoot) : moduleName,
		moduleInfo = $tw.modules.titles[name] || $tw.modules.titles[name + ".js"] || $tw.modules.titles[moduleName] || $tw.modules.titles[moduleName + ".js"] ,
		tiddler = $tw.wiki.getTiddler(name) || $tw.wiki.getTiddler(name + ".js") || $tw.wiki.getTiddler(moduleName) || $tw.wiki.getTiddler(moduleName + ".js") ,
		_exports = {},
		sandbox = {
			module: {exports: _exports},
			//moduleInfo: moduleInfo,
			exports: _exports,
			console: console,
			setInterval: setInterval,
			clearInterval: clearInterval,
			setTimeout: setTimeout,
			clearTimeout: clearTimeout,
			Buffer: $tw.browser ? {} : Buffer,
			$tw: $tw,
			require: function(title) {
				return $tw.modules.execute(title, name);
			}
		};

	Object.defineProperty(sandbox.module, "id", {
		value: name,
		writable: false,
		enumerable: true,
		configurable: false
	});

	if(!$tw.browser) {
		$tw.utils.extend(sandbox,{
			process: process
		});
	} else {
		/*
		CommonJS optional require.main property:
		 In a browser we offer a fake main module which points back to the boot function
		 (Theoretically, this may allow TW to eventually load itself as a module in the browser)
		*/
		Object.defineProperty(sandbox.require, "main", {
			value: (typeof(require) !== "undefined") ? require.main : {TiddlyWiki: _boot},
			writable: false,
			enumerable: true,
			configurable: false
		});
	}
	if(!moduleInfo) {
		// We could not find the module on this path
		// Try to defer to browserify etc, or node
		var deferredModule;
		if($tw.browser) {
			if(window.require) {
				try {
					return window.require(moduleName);
				} catch(e) {}
			}
			throw "Cannot find module named '" + moduleName + "' required by module '" + moduleRoot + "', resolved to " + name;
		} else {
			// If we don't have a module with that name, let node.js try to find it
			return require(moduleName);
		}
	}
	// Execute the module if we haven't already done so
	if(!moduleInfo.exports) {
		try {
			// Check the type of the definition
			if(typeof moduleInfo.definition === "function") { // Function
				moduleInfo.exports = _exports;
				moduleInfo.definition(moduleInfo,moduleInfo.exports,sandbox.require);
			} else if(typeof moduleInfo.definition === "string") { // String
				moduleInfo.exports = _exports;
				$tw.utils.evalSandboxed(moduleInfo.definition,sandbox,tiddler.fields.title);
				if(sandbox.module.exports) {
					moduleInfo.exports = sandbox.module.exports; //more codemirror workaround
				}
			} else { // Object
				moduleInfo.exports = moduleInfo.definition;
			}
		} catch(e) {
			$tw.utils.error("Error executing boot module " + name + ":\n" + e.stack);
		}
	}
	// Return the exports of the module
	return moduleInfo.exports;
};

/*
Apply a callback to each module of a particular type
	moduleType: type of modules to enumerate
	callback: function called as callback(title,moduleExports) for each module
*/
$tw.modules.forEachModuleOfType = function(moduleType,callback) {
	var modules = $tw.modules.types[moduleType];
	$tw.utils.each(modules,function(element,title) {
		callback(title,$tw.modules.execute(title));
	});
};

/*
Get all the modules of a particular type in a hashmap by their `name` field
*/
$tw.modules.getModulesByTypeAsHashmap = function(moduleType,nameField) {
	nameField = nameField || "name";
	var results = Object.create(null);
	$tw.modules.forEachModuleOfType(moduleType,function(title,module) {
		results[module[nameField]] = module;
	});
	return results;
};

/*
Apply the exports of the modules of a particular type to a target object
*/
$tw.modules.applyMethods = function(moduleType,targetObject) {
	if(!targetObject) {
		targetObject = Object.create(null);
	}
	$tw.modules.forEachModuleOfType(moduleType,function(title,module) {
		$tw.utils.each(module,function(element,title,object) {
			targetObject[title] = module[title];
		});
	});
	return targetObject;
};

/*
Return an array of classes created from the modules of a specified type. Each module should export the properties to be added to those of the optional base class
*/
$tw.modules.createClassesFromModules = function(moduleType,subType,baseClass) {
	var classes = Object.create(null);
	$tw.modules.forEachModuleOfType(moduleType,function(title,moduleExports) {
		if(!subType || moduleExports.types[subType]) {
			var newClass = function() {};
			if(baseClass) {
				newClass.prototype = new baseClass();
				newClass.prototype.constructor = baseClass;
			}
			$tw.utils.extend(newClass.prototype,moduleExports);
			classes[moduleExports.name] = newClass;
		}
	});
	return classes;
};

/////////////////////////// Barebones tiddler object

/*
Construct a tiddler object from a hashmap of tiddler fields. If multiple hasmaps are provided they are merged,
taking precedence to the right
*/
$tw.Tiddler = function(/* [fields,] fields */) {
	this.fields = Object.create(null);
	for(var c=0; c<arguments.length; c++) {
		var arg = arguments[c],
			src = (arg instanceof $tw.Tiddler) ? arg.fields : arg;
		for(var t in src) {
			if(src[t] === undefined || src[t] === null) {
				if(t in this.fields) {
					delete this.fields[t]; // If we get a field that's undefined, delete any previous field value
				}
			} else {
				// Parse the field with the associated field module (if any)
				var fieldModule = $tw.Tiddler.fieldModules[t],
					value;
				if(fieldModule && fieldModule.parse) {
					value = fieldModule.parse.call(this,src[t]);
				} else {
					value = src[t];
				}
				// Freeze the field to keep it immutable
				if(typeof value === "object") {
					Object.freeze(value);
				}
				this.fields[t] = value;
			}
		}
	}
	// Freeze the tiddler against modification
	Object.freeze(this.fields);
};

$tw.Tiddler.prototype.hasField = function(field) {
	return $tw.utils.hop(this.fields,field);
};

/*
Register and install the built in tiddler field modules
*/
$tw.modules.define("$:/boot/tiddlerfields/modified","tiddlerfield",{
	name: "modified",
	parse: $tw.utils.parseDate,
	stringify: $tw.utils.stringifyDate
});
$tw.modules.define("$:/boot/tiddlerfields/created","tiddlerfield",{
	name: "created",
	parse: $tw.utils.parseDate,
	stringify: $tw.utils.stringifyDate
});
$tw.modules.define("$:/boot/tiddlerfields/color","tiddlerfield",{
	name: "color",
	editTag: "input",
	editType: "color"
});
$tw.modules.define("$:/boot/tiddlerfields/tags","tiddlerfield",{
	name: "tags",
	parse: $tw.utils.parseStringArray,
	stringify: $tw.utils.stringifyList
});
$tw.modules.define("$:/boot/tiddlerfields/list","tiddlerfield",{
	name: "list",
	parse: $tw.utils.parseStringArray,
	stringify: $tw.utils.stringifyList
});

/////////////////////////// Barebones wiki store

/*
Wiki constructor. State is stored in private members that only a small number of privileged accessor methods have direct access. Methods added via the prototype have to use these accessors and cannot access the state data directly.
options include:
shadowTiddlers: Array of shadow tiddlers to be added
*/
$tw.Wiki = function(options) {
	options = options || {};
	var self = this,
		tiddlers = Object.create(null), // Hashmap of tiddlers
		pluginTiddlers = [], // Array of tiddlers containing registered plugins, ordered by priority
		pluginInfo = Object.create(null), // Hashmap of parsed plugin content
		shadowTiddlers = options.shadowTiddlers || Object.create(null); // Hashmap by title of {source:, tiddler:}

	// Add a tiddler to the store
	this.addTiddler = function(tiddler) {
		if(!(tiddler instanceof $tw.Tiddler)) {
			tiddler = new $tw.Tiddler(tiddler);
		}
		// Save the tiddler
		if(tiddler) {
			var title = tiddler.fields.title;
			if(title) {
				tiddlers[title] = tiddler;
				this.clearCache(title);
				this.clearGlobalCache();
				this.enqueueTiddlerEvent(title);
			}
		}
	};

	// Delete a tiddler
	this.deleteTiddler = function(title) {
		delete tiddlers[title];
		this.clearCache(title);
		this.clearGlobalCache();
		this.enqueueTiddlerEvent(title,true);
	};

	// Get a tiddler from the store
	this.getTiddler = function(title) {
		var t = tiddlers[title];
		if(t instanceof $tw.Tiddler) {
			return t;
		} else if(title !== undefined && Object.prototype.hasOwnProperty.call(shadowTiddlers,title)) {
			return shadowTiddlers[title].tiddler;
		} else {
			return undefined;
		}
	};

	// Get an array of all tiddler titles
	this.allTitles = function() {
		return Object.keys(tiddlers);
	};

	// Iterate through all tiddler titles
	this.each = function(callback) {
		for(var title in tiddlers) {
			callback(tiddlers[title],title);
		}
	};

	// Get an array of all shadow tiddler titles
	this.allShadowTitles = function() {
		return Object.keys(shadowTiddlers);
	};

	// Iterate through all shadow tiddler titles
	this.eachShadow = function(callback) {
		for(var title in shadowTiddlers) {
			var shadowInfo = shadowTiddlers[title];
			callback(shadowInfo.tiddler,title);
		}
	};

	// Iterate through all tiddlers and then the shadows
	this.eachTiddlerPlusShadows = function(callback) {
		for(var title in tiddlers) {
			callback(tiddlers[title],title);
		}
		for(var title in shadowTiddlers) {
			if(!Object.prototype.hasOwnProperty.call(tiddlers,title)) {
				var shadowInfo = shadowTiddlers[title];
				callback(shadowInfo.tiddler,title);
			}
		}
	};

	// Iterate through all the shadows and then the tiddlers
	this.eachShadowPlusTiddlers = function(callback) {
		for(var title in shadowTiddlers) {
			if(Object.prototype.hasOwnProperty.call(tiddlers,title)) {
				callback(tiddlers[title],title);
			} else {
				var shadowInfo = shadowTiddlers[title];
				callback(shadowInfo.tiddler,title);
			}
		}
		for(var title in tiddlers) {
			if(!Object.prototype.hasOwnProperty.call(shadowTiddlers,title)) {
				callback(tiddlers[title],title);
			}
		}

	};

	// Test for the existence of a tiddler (excludes shadow tiddlers)
	this.tiddlerExists = function(title) {
		return !!$tw.utils.hop(tiddlers,title);
	};

	// Determines if a tiddler is a shadow tiddler, regardless of whether it has been overridden by a real tiddler
	this.isShadowTiddler = function(title) {
		return $tw.utils.hop(shadowTiddlers,title);
	};

	this.getShadowSource = function(title) {
		if($tw.utils.hop(shadowTiddlers,title)) {
			return shadowTiddlers[title].source;
		}
		return null;
	};

	// Read plugin info for all plugins
	this.readPluginInfo = function() {
		for(var title in tiddlers) {
			var tiddler = tiddlers[title];
			if(tiddler.fields.type === "application/json" && tiddler.hasField("plugin-type")) {
				pluginInfo[tiddler.fields.title] = JSON.parse(tiddler.fields.text);
			}

		}
	};

	// Get plugin info for a plugin
	this.getPluginInfo = function(title) {
		return pluginInfo[title];
	};

	// Register the plugin tiddlers of a particular type, optionally restricting registration to an array of tiddler titles. Return the array of titles affected
	this.registerPluginTiddlers = function(pluginType,titles) {
		var self = this,
			registeredTitles = [],
			checkTiddler = function(tiddler,title) {
				if(tiddler && tiddler.fields.type === "application/json" && tiddler.fields["plugin-type"] === pluginType) {
					var disablingTiddler = self.getTiddler("$:/config/Plugins/Disabled/" + title);
					if(title === "$:/core" || !disablingTiddler || (disablingTiddler.fields.text || "").trim() !== "yes") {
						pluginTiddlers.push(tiddler);
						registeredTitles.push(tiddler.fields.title);
					}
				}
			};
		if(titles) {
			$tw.utils.each(titles,function(title) {
				checkTiddler(self.getTiddler(title),title);
			});
		} else {
			this.each(function(tiddler,title) {
				checkTiddler(tiddler,title);
			});
		}
		return registeredTitles;
	};

	// Unregister the plugin tiddlers of a particular type, returning an array of the titles affected
	this.unregisterPluginTiddlers = function(pluginType) {
		var self = this,
			titles = [];
		// Remove any previous registered plugins of this type
		for(var t=pluginTiddlers.length-1; t>=0; t--) {
			var tiddler = pluginTiddlers[t];
			if(tiddler.fields["plugin-type"] === pluginType) {
				titles.push(tiddler.fields.title);
				pluginTiddlers.splice(t,1);
			}
		}
		return titles;
	};

	// Unpack the currently registered plugins, creating shadow tiddlers for their constituent tiddlers
	this.unpackPluginTiddlers = function() {
		var self = this;
		// Sort the plugin titles by the `plugin-priority` field
		pluginTiddlers.sort(function(a,b) {
			if("plugin-priority" in a.fields && "plugin-priority" in b.fields) {
				return a.fields["plugin-priority"] - b.fields["plugin-priority"];
			} else if("plugin-priority" in a.fields) {
				return -1;
			} else if("plugin-priority" in b.fields) {
				return +1;
			} else if(a.fields.title < b.fields.title) {
				return -1;
			} else if(a.fields.title === b.fields.title) {
				return 0;
			} else {
				return +1;
			}
		});
		// Now go through the plugins in ascending order and assign the shadows
		shadowTiddlers = Object.create(null);
		$tw.utils.each(pluginTiddlers,function(tiddler) {
			// Extract the constituent tiddlers
			if($tw.utils.hop(pluginInfo,tiddler.fields.title)) {
				$tw.utils.each(pluginInfo[tiddler.fields.title].tiddlers,function(constituentTiddler,constituentTitle) {
					// Save the tiddler object
					if(constituentTitle) {
						shadowTiddlers[constituentTitle] = {
							source: tiddler.fields.title,
							tiddler: new $tw.Tiddler(constituentTiddler,{title: constituentTitle})
						};
					}
				});
			}
		});
	};

};

// Dummy methods that will be filled in after boot
$tw.Wiki.prototype.clearCache =
$tw.Wiki.prototype.clearGlobalCache =
$tw.Wiki.prototype.enqueueTiddlerEvent = function() {};

// Add an array of tiddlers
$tw.Wiki.prototype.addTiddlers = function(tiddlers) {
	for(var t=0; t<tiddlers.length; t++) {
		this.addTiddler(tiddlers[t]);
	}
};

/*
Define all modules stored in ordinary tiddlers
*/
$tw.Wiki.prototype.defineTiddlerModules = function() {
	this.each(function(tiddler,title) {
		if(tiddler.hasField("module-type")) {
			switch (tiddler.fields.type) {
				case "application/javascript":
					// We only define modules that haven't already been defined, because in the browser modules in system tiddlers are defined in inline script
					if(!$tw.utils.hop($tw.modules.titles,tiddler.fields.title)) {
						$tw.modules.define(tiddler.fields.title,tiddler.fields["module-type"],tiddler.fields.text);
					}
					break;
				case "application/json":
					$tw.modules.define(tiddler.fields.title,tiddler.fields["module-type"],JSON.parse(tiddler.fields.text));
					break;
				case "application/x-tiddler-dictionary":
					$tw.modules.define(tiddler.fields.title,tiddler.fields["module-type"],$tw.utils.parseFields(tiddler.fields.text));
					break;
			}
		}
	});
};

/*
Register all the module tiddlers that have a module type
*/
$tw.Wiki.prototype.defineShadowModules = function() {
	var self = this;
	this.eachShadow(function(tiddler,title) {
		// Don't define the module if it is overidden by an ordinary tiddler
		if(!self.tiddlerExists(title) && tiddler.hasField("module-type")) {
			// Define the module
			$tw.modules.define(tiddler.fields.title,tiddler.fields["module-type"],tiddler.fields.text);
		}
	});
};

/*
Enable safe mode by deleting any tiddlers that override a shadow tiddler
*/
$tw.Wiki.prototype.processSafeMode = function() {
	var self = this,
		overrides = [];
	// Find the overriding tiddlers
	this.each(function(tiddler,title) {
		if(self.isShadowTiddler(title)) {
			console.log(title);
			overrides.push(title);
		}
	});
	// Assemble a report tiddler
	var titleReportTiddler = "TiddlyWiki Safe Mode",
		report = [];
	report.push("TiddlyWiki has been started in [[safe mode|http://tiddlywiki.com/static/SafeMode.html]]. All plugins are temporarily disabled. Most customisations have been disabled by renaming the following tiddlers:")
	// Delete the overrides
	overrides.forEach(function(title) {
		var tiddler = self.getTiddler(title),
			newTitle = "SAFE: " + title;
		self.deleteTiddler(title);
		self.addTiddler(new $tw.Tiddler(tiddler, {title: newTitle}));
		report.push("* [[" + title + "|" + newTitle + "]]");
	});
	report.push()
	this.addTiddler(new $tw.Tiddler({title: titleReportTiddler, text: report.join("\n\n")}));
	// Set $:/DefaultTiddlers to point to our report
	this.addTiddler(new $tw.Tiddler({title: "$:/DefaultTiddlers", text: "[[" + titleReportTiddler + "]]"}));
};

/*
Extracts tiddlers from a typed block of text, specifying default field values
*/
$tw.Wiki.prototype.deserializeTiddlers = function(type,text,srcFields) {
	srcFields = srcFields || Object.create(null);
	var deserializer = $tw.Wiki.tiddlerDeserializerModules[type],
		fields = Object.create(null);
	if(!deserializer && $tw.config.fileExtensionInfo[type]) {
		// If we didn't find the serializer, try converting it from an extension to a content type
		type = $tw.config.fileExtensionInfo[type].type;
		deserializer = $tw.Wiki.tiddlerDeserializerModules[type];
	}
	if(!deserializer && $tw.config.contentTypeInfo[type]) {
		// see if this type has a different deserializer registered with it
		type = $tw.config.contentTypeInfo[type].deserializerType;
		deserializer = $tw.Wiki.tiddlerDeserializerModules[type];
	}
	if(!deserializer) {
		// If we still don't have a deserializer, treat it as plain text
		deserializer = $tw.Wiki.tiddlerDeserializerModules["text/plain"];
	}
	for(var f in srcFields) {
		fields[f] = srcFields[f];
	}
	if(deserializer) {
		return deserializer.call(this,text,fields,type);
	} else {
		// Return a raw tiddler for unknown types
		fields.text = text;
		return [fields];
	}
};

/*
Register the built in tiddler deserializer modules
*/
$tw.modules.define("$:/boot/tiddlerdeserializer/js","tiddlerdeserializer",{
	"application/javascript": function(text,fields) {
		var headerCommentRegExp = new RegExp($tw.config.jsModuleHeaderRegExpString,"mg"),
			match = headerCommentRegExp.exec(text);
		fields.text = text;
		if(match) {
			fields = $tw.utils.parseFields(match[1].split(/\r?\n\r?\n/mg)[0],fields);
		}
		return [fields];
	}
});
$tw.modules.define("$:/boot/tiddlerdeserializer/tid","tiddlerdeserializer",{
	"application/x-tiddler": function(text,fields) {
		var split = text.split(/\r?\n\r?\n/mg);
		if(split.length >= 1) {
			fields = $tw.utils.parseFields(split[0],fields);
		}
		if(split.length >= 2) {
			fields.text = split.slice(1).join("\n\n");
		}
		return [fields];
	}
});
$tw.modules.define("$:/boot/tiddlerdeserializer/tids","tiddlerdeserializer",{
	"application/x-tiddlers": function(text,fields) {
		var titles = [],
			tiddlers = [],
			match = /\r?\n\r?\n/mg.exec(text);
		if(match) {
			fields = $tw.utils.parseFields(text.substr(0,match.index),fields);
			var lines = text.substr(match.index + match[0].length).split(/\r?\n/mg);
			for(var t=0; t<lines.length; t++) {
				var line = lines[t];
				if(line.charAt(0) !== "#") {
					var colonPos= line.indexOf(": ");
					if(colonPos !== -1) {
						var tiddler = $tw.utils.extend(Object.create(null),fields);
						tiddler.title = (tiddler.title || "") + line.substr(0,colonPos);
						if(titles.indexOf(tiddler.title) !== -1) {
							console.log("Warning: .multids file contains multiple definitions for " + tiddler.title);
						}
						titles.push(tiddler.title);
						tiddler.text = line.substr(colonPos + 2);
						tiddlers.push(tiddler);
					}
				}
			}
		}
		return tiddlers;
	}
});
$tw.modules.define("$:/boot/tiddlerdeserializer/txt","tiddlerdeserializer",{
	"text/plain": function(text,fields,type) {
		fields.text = text;
		fields.type = type || "text/plain";
		return [fields];
	}
});
$tw.modules.define("$:/boot/tiddlerdeserializer/html","tiddlerdeserializer",{
	"text/html": function(text,fields) {
		fields.text = text;
		fields.type = "text/html";
		return [fields];
	}
});
$tw.modules.define("$:/boot/tiddlerdeserializer/json","tiddlerdeserializer",{
	"application/json": function(text,fields) {
		var tiddlers = JSON.parse(text);
		return tiddlers;
	}
});

/////////////////////////// Browser definitions

if($tw.browser && !$tw.node) {

/*
Decrypt any tiddlers stored within the element with the ID "encryptedArea". The function is asynchronous to allow the user to be prompted for a password
	callback: function to be called the decryption is complete
*/
$tw.boot.decryptEncryptedTiddlers = function(callback) {
	var encryptedArea = document.getElementById("encryptedStoreArea");
	if(encryptedArea) {
		var encryptedText = encryptedArea.innerHTML,
			prompt = "Enter a password to decrypt this TiddlyWiki";
		// Prompt for the password
		if($tw.utils.hop($tw.boot,"encryptionPrompts")) {
			prompt = $tw.boot.encryptionPrompts.decrypt;
		}
		$tw.passwordPrompt.createPrompt({
			serviceName: prompt,
			noUserName: true,
			submitText: "Decrypt",
			callback: function(data) {
				// Attempt to decrypt the tiddlers
				$tw.crypto.setPassword(data.password);
				var decryptedText = $tw.crypto.decrypt(encryptedText);
				if(decryptedText) {
					var json = JSON.parse(decryptedText);
					for(var title in json) {
						$tw.preloadTiddler(json[title]);
					}
					// Call the callback
					callback();
					// Exit and remove the password prompt
					return true;
				} else {
					// We didn't decrypt everything, so continue to prompt for password
					return false;
				}
			}
		});
	} else {
		// Just invoke the callback straight away if there weren't any encrypted tiddlers
		callback();
	}
};

/*
Register a deserializer that can extract tiddlers from the DOM
*/
$tw.modules.define("$:/boot/tiddlerdeserializer/dom","tiddlerdeserializer",{
	"(DOM)": function(node) {
		var extractTextTiddlers = function(node) {
				var e = node.firstChild;
				while(e && e.nodeName.toLowerCase() !== "pre") {
					e = e.nextSibling;
				}
				var title = node.getAttribute ? node.getAttribute("title") : null;
				if(e && title) {
					var attrs = node.attributes,
						tiddler = {
							text: $tw.utils.htmlDecode(e.innerHTML)
						};
					for(var i=attrs.length-1; i >= 0; i--) {
						tiddler[attrs[i].name] = attrs[i].value;
					}
					return [tiddler];
				} else {
					return null;
				}
			},
			extractModuleTiddlers = function(node) {
				if(node.hasAttribute && node.hasAttribute("data-tiddler-title")) {
					var text = node.innerHTML,
						s = text.indexOf("{"),
						e = text.lastIndexOf("}");
					if(node.hasAttribute("data-module") && s !== -1 && e !== -1) {
						text = text.substring(s+1,e);
					}
					var fields = {text: text},
						attributes = node.attributes;
					for(var a=0; a<attributes.length; a++) {
						if(attributes[a].nodeName.substr(0,13) === "data-tiddler-") {
							fields[attributes[a].nodeName.substr(13)] = attributes[a].value;
						}
					}
					return [fields];
				} else {
					return null;
				}
			},
			t,result = [];
		if(node) {
			for(t = 0; t < node.childNodes.length; t++) {
					var childNode = node.childNodes[t],
						tiddlers = extractTextTiddlers(childNode);
					tiddlers = tiddlers || extractModuleTiddlers(childNode);
					if(tiddlers) {
						result.push.apply(result,tiddlers);
					}
			}
		}
		return result;
	}
});

$tw.loadTiddlersBrowser = function() {
	// In the browser, we load tiddlers from certain elements
	var containerIds = [
		"libraryModules",
		"modules",
		"bootKernelPrefix",
		"bootKernel",
		"styleArea",
		"storeArea",
		"systemArea"
	];
	for(var t=0; t<containerIds.length; t++) {
		$tw.wiki.addTiddlers($tw.wiki.deserializeTiddlers("(DOM)",document.getElementById(containerIds[t])));
	}
	// Load any preloaded tiddlers
	if($tw.preloadTiddlers) {
		$tw.wiki.addTiddlers($tw.preloadTiddlers);
	}
};

} else {

/////////////////////////// Server definitions

/*
Get any encrypted tiddlers
*/
$tw.boot.decryptEncryptedTiddlers = function(callback) {
	// Storing encrypted tiddlers on the server isn't supported yet
	callback();
};

} // End of if($tw.browser && !$tw.node)

/////////////////////////// Node definitions

if($tw.node) {

/*
Load the tiddlers contained in a particular file (and optionally extract fields from the accompanying .meta file) returned as {filepath:,type:,tiddlers:[],hasMetaFile:}
*/
$tw.loadTiddlersFromFile = function(filepath,fields) {
	var ext = path.extname(filepath),
		extensionInfo = $tw.config.fileExtensionInfo[ext],
		type = extensionInfo ? extensionInfo.type : null,
		typeInfo = type ? $tw.config.contentTypeInfo[type] : null,
		data = fs.readFileSync(filepath,typeInfo ? typeInfo.encoding : "utf8"),
		tiddlers = $tw.wiki.deserializeTiddlers(ext,data,fields),
		metafile = filepath + ".meta",
		metadata;
	if(ext !== ".json" && tiddlers.length === 1 && fs.existsSync(metafile)) {
		metadata = fs.readFileSync(metafile,"utf8");
		if(metadata) {
			tiddlers = [$tw.utils.parseFields(metadata,tiddlers[0])];
		}
	}
	return {filepath: filepath, type: type, tiddlers: tiddlers, hasMetaFile: !!metadata};
};

/*
A default set of files for TiddlyWiki to ignore during load.
This matches what NPM ignores, and adds "*.meta" to ignore tiddler
metadata files.
*/
$tw.boot.excludeRegExp = /^\.DS_Store$|^.*\.meta$|^\..*\.swp$|^\._.*$|^\.git$|^\.hg$|^\.lock-wscript$|^\.svn$|^\.wafpickle-.*$|^CVS$|^npm-debug\.log$/;

/*
Load all the tiddlers recursively from a directory, including honouring `tiddlywiki.files` files for drawing in external files. Returns an array of {filepath:,type:,tiddlers: [{..fields...}],hasMetaFile:}. Note that no file information is returned for externally loaded tiddlers, just the `tiddlers` property.
*/
$tw.loadTiddlersFromPath = function(filepath,excludeRegExp) {
	excludeRegExp = excludeRegExp || $tw.boot.excludeRegExp;
	var tiddlers = [];
	if(fs.existsSync(filepath)) {
		var stat = fs.statSync(filepath);
		if(stat.isDirectory()) {
			var files = fs.readdirSync(filepath);
			// Look for a tiddlywiki.files file
			if(files.indexOf("tiddlywiki.files") !== -1) {
				// If so, process the files it describes
				var filesInfo = JSON.parse(fs.readFileSync(filepath + path.sep + "tiddlywiki.files","utf8"));
				$tw.utils.each(filesInfo.tiddlers,function(tidInfo) {
					var typeInfo = $tw.config.contentTypeInfo[tidInfo.fields.type || "text/plain"],
						pathname = path.resolve(filepath,tidInfo.file),
						text = fs.readFileSync(pathname,typeInfo ? typeInfo.encoding : "utf8");
					if(tidInfo.prefix) {
						text = tidInfo.prefix + text;
					}
					if(tidInfo.suffix) {
						text = text + tidInfo.suffix;
					}
					tidInfo.fields.text = text;
					tiddlers.push({tiddlers: [tidInfo.fields]});
				});
			} else {
				// If not, read all the files in the directory
				$tw.utils.each(files,function(file) {
					if(!excludeRegExp.test(file) && file !== "plugin.info") {
						tiddlers.push.apply(tiddlers,$tw.loadTiddlersFromPath(filepath + path.sep + file,excludeRegExp));
					}
				});
			}
		} else if(stat.isFile()) {
			tiddlers.push($tw.loadTiddlersFromFile(filepath));
		}
	}
	return tiddlers;
};

/*
Load the tiddlers from a plugin folder, and package them up into a proper JSON plugin tiddler
*/
$tw.loadPluginFolder = function(filepath,excludeRegExp) {
	excludeRegExp = excludeRegExp || $tw.boot.excludeRegExp;
	if(fs.existsSync(filepath) && fs.statSync(filepath).isDirectory()) {
		// Read the plugin information
		var pluginInfo = JSON.parse(fs.readFileSync(filepath + path.sep + "plugin.info","utf8"));
		// Read the plugin files
		var pluginFiles = $tw.loadTiddlersFromPath(filepath,excludeRegExp);
		// Save the plugin tiddlers into the plugin info
		pluginInfo.tiddlers = pluginInfo.tiddlers || Object.create(null);
		for(var f=0; f<pluginFiles.length; f++) {
			var tiddlers = pluginFiles[f].tiddlers;
			for(var t=0; t<tiddlers.length; t++) {
				var tiddler= tiddlers[t];
				if(tiddler.title) {
					pluginInfo.tiddlers[tiddler.title] = tiddler;
				}
			}
		}
		// Give the plugin the same version number as the core if it doesn't have one
		if(!("version" in pluginInfo)) {
			pluginInfo.version = $tw.packageInfo.version;
		}
		// Use "plugin" as the plugin-type if we don't have one
		if(!("plugin-type" in pluginInfo)) {
			pluginInfo["plugin-type"] = "plugin";
		}
		pluginInfo.dependents = pluginInfo.dependents || [];
		pluginInfo.type = "application/json";
		// Set plugin text
		pluginInfo.text = JSON.stringify({tiddlers: pluginInfo.tiddlers},null,4);
		delete pluginInfo.tiddlers;
		// Deserialise array fields (currently required for the dependents field)
		for(var field in pluginInfo) {
			if($tw.utils.isArray(pluginInfo[field])) {
				pluginInfo[field] = $tw.utils.stringifyList(pluginInfo[field]);
			}
		}
		return pluginInfo;
	} else {
			return null;
	}
};

/*
name: Name of the plugin to find
paths: array of file paths to search for it
Returns the path of the plugin folder
*/
$tw.findLibraryItem = function(name,paths) {
	var pathIndex = 0;
	do {
		var pluginPath = path.resolve(paths[pathIndex],"./" + name)
		if(fs.existsSync(pluginPath) && fs.statSync(pluginPath).isDirectory()) {
			return pluginPath;
		}
	} while(++pathIndex < paths.length);
	return null;
};

/*
name: Name of the plugin to load
paths: array of file paths to search for it
*/
$tw.loadPlugin = function(name,paths) {
	var pluginPath = $tw.findLibraryItem(name,paths);
	if(pluginPath) {
		var pluginFields = $tw.loadPluginFolder(pluginPath);
		if(pluginFields) {
			$tw.wiki.addTiddler(pluginFields);
		}
	}
};

/*
libraryPath: Path of library folder for these plugins (relative to core path)
envVar: Environment variable name for these plugins
Returns an array of search paths
*/
$tw.getLibraryItemSearchPaths = function(libraryPath,envVar) {
	var pluginPaths = [path.resolve($tw.boot.corePath,libraryPath)],
		env = process.env[envVar];
	if(env) {
		Array.prototype.push.apply(pluginPaths,env.split(path.delimiter));
	}
	return pluginPaths;
};

/*
plugins: Array of names of plugins (eg, "tiddlywiki/filesystemadaptor")
libraryPath: Path of library folder for these plugins (relative to core path)
envVar: Environment variable name for these plugins
*/
$tw.loadPlugins = function(plugins,libraryPath,envVar) {
	if(plugins) {
		var pluginPaths = $tw.getLibraryItemSearchPaths(libraryPath,envVar);
		for(var t=0; t<plugins.length; t++) {
			$tw.loadPlugin(plugins[t],pluginPaths);
		}
	}
};

/*
path: path of wiki directory
options:
	parentPaths: array of parent paths that we mustn't recurse into
	readOnly: true if the tiddler file paths should not be retained
*/
$tw.loadWikiTiddlers = function(wikiPath,options) {
	options = options || {};
	var parentPaths = options.parentPaths || [],
		wikiInfoPath = path.resolve(wikiPath,$tw.config.wikiInfo),
		wikiInfo,
		pluginFields;
	// Bail if we don't have a wiki info file
	if(fs.existsSync(wikiInfoPath)) {
		wikiInfo = JSON.parse(fs.readFileSync(wikiInfoPath,"utf8"));
	} else {
		return null;
	}
	// Load any parent wikis
	if(wikiInfo.includeWikis) {
		parentPaths = parentPaths.slice(0);
		parentPaths.push(wikiPath);
		$tw.utils.each(wikiInfo.includeWikis,function(info) {
			if(typeof info === "string") {
				info = {path: info};
			}
			var resolvedIncludedWikiPath = path.resolve(wikiPath,info.path);
			if(parentPaths.indexOf(resolvedIncludedWikiPath) === -1) {
				var subWikiInfo = $tw.loadWikiTiddlers(resolvedIncludedWikiPath,{
					parentPaths: parentPaths,
					readOnly: info["read-only"]
				});
				// Merge the build targets
				wikiInfo.build = $tw.utils.extend([],subWikiInfo.build,wikiInfo.build);
			} else {
				$tw.utils.error("Cannot recursively include wiki " + resolvedIncludedWikiPath);
			}
		});
	}
	// Load any plugins, themes and languages listed in the wiki info file
	$tw.loadPlugins(wikiInfo.plugins,$tw.config.pluginsPath,$tw.config.pluginsEnvVar);
	$tw.loadPlugins(wikiInfo.themes,$tw.config.themesPath,$tw.config.themesEnvVar);
	$tw.loadPlugins(wikiInfo.languages,$tw.config.languagesPath,$tw.config.languagesEnvVar);
	// Load the wiki files, registering them as writable
	var resolvedWikiPath = path.resolve(wikiPath,$tw.config.wikiTiddlersSubDir);
	$tw.utils.each($tw.loadTiddlersFromPath(resolvedWikiPath),function(tiddlerFile) {
		if(!options.readOnly && tiddlerFile.filepath) {
			$tw.utils.each(tiddlerFile.tiddlers,function(tiddler) {
				$tw.boot.files[tiddler.title] = {
					filepath: tiddlerFile.filepath,
					type: tiddlerFile.type,
					hasMetaFile: tiddlerFile.hasMetaFile
				};
			});
		}
		$tw.wiki.addTiddlers(tiddlerFile.tiddlers);
	});
	// Save the original tiddler file locations if requested
	var config = wikiInfo.config || {};
	if(config["retain-original-tiddler-path"]) {
		var output = {};
		for(var title in $tw.boot.files) {
			output[title] = path.relative(resolvedWikiPath,$tw.boot.files[title].filepath);
		}
		$tw.wiki.addTiddler({title: "$:/config/OriginalTiddlerPaths", type: "application/json", text: JSON.stringify(output)});
	}
	// Save the path to the tiddlers folder for the filesystemadaptor
	$tw.boot.wikiTiddlersPath = path.resolve($tw.boot.wikiPath,config["default-tiddler-location"] || $tw.config.wikiTiddlersSubDir);
	// Load any plugins within the wiki folder
	var wikiPluginsPath = path.resolve(wikiPath,$tw.config.wikiPluginsSubDir);
	if(fs.existsSync(wikiPluginsPath)) {
		var pluginFolders = fs.readdirSync(wikiPluginsPath);
		for(var t=0; t<pluginFolders.length; t++) {
			pluginFields = $tw.loadPluginFolder(path.resolve(wikiPluginsPath,"./" + pluginFolders[t]));
			if(pluginFields) {
				$tw.wiki.addTiddler(pluginFields);
			}
		}
	}
	// Load any themes within the wiki folder
	var wikiThemesPath = path.resolve(wikiPath,$tw.config.wikiThemesSubDir);
	if(fs.existsSync(wikiThemesPath)) {
		var themeFolders = fs.readdirSync(wikiThemesPath);
		for(var t=0; t<themeFolders.length; t++) {
			pluginFields = $tw.loadPluginFolder(path.resolve(wikiThemesPath,"./" + themeFolders[t]));
			if(pluginFields) {
				$tw.wiki.addTiddler(pluginFields);
			}
		}
	}
	// Load any languages within the wiki folder
	var wikiLanguagesPath = path.resolve(wikiPath,$tw.config.wikiLanguagesSubDir);
	if(fs.existsSync(wikiLanguagesPath)) {
		var languageFolders = fs.readdirSync(wikiLanguagesPath);
		for(var t=0; t<languageFolders.length; t++) {
			pluginFields = $tw.loadPluginFolder(path.resolve(wikiLanguagesPath,"./" + languageFolders[t]));
			if(pluginFields) {
				$tw.wiki.addTiddler(pluginFields);
			}
		}
	}
	return wikiInfo;
};

$tw.loadTiddlersNode = function() {
	// Load the boot tiddlers
	$tw.utils.each($tw.loadTiddlersFromPath($tw.boot.bootPath),function(tiddlerFile) {
		$tw.wiki.addTiddlers(tiddlerFile.tiddlers);
	});
	// Load the core tiddlers
	$tw.wiki.addTiddler($tw.loadPluginFolder($tw.boot.corePath));
	// Load the tiddlers from the wiki directory
	if($tw.boot.wikiPath) {
		$tw.boot.wikiInfo = $tw.loadWikiTiddlers($tw.boot.wikiPath);
	}
};

// End of if($tw.node)
}

/////////////////////////// Main startup function called once tiddlers have been decrypted

/*
Startup TiddlyWiki
*/
$tw.boot.startup = function(options) {
	options = options || {};
	// Get the URL hash and check for safe mode
	$tw.locationHash = "#";
	if($tw.browser && !$tw.node) {
		if(location.hash === "#:safe") {
			$tw.safeMode = true;
		} else {
			$tw.locationHash = $tw.utils.getLocationHash();
		}
	}
	// Initialise some more $tw properties
	$tw.utils.deepDefaults($tw,{
		modules: { // Information about each module
			titles: Object.create(null), // hashmap by module title of {fn:, exports:, moduleType:}
			types: {} // hashmap by module type of hashmap of exports
		},
		config: { // Configuration overridables
			pluginsPath: "../plugins/",
			themesPath: "../themes/",
			languagesPath: "../languages/",
			editionsPath: "../editions/",
			wikiInfo: "./tiddlywiki.info",
			wikiPluginsSubDir: "./plugins",
			wikiThemesSubDir: "./themes",
			wikiLanguagesSubDir: "./languages",
			wikiTiddlersSubDir: "./tiddlers",
			wikiOutputSubDir: "./output",
			jsModuleHeaderRegExpString: "^\\/\\*\\\\(?:\\r?\\n)((?:^[^\\r\\n]*(?:\\r?\\n))+?)(^\\\\\\*\\/$(?:\\r?\\n)?)",
			fileExtensionInfo: Object.create(null), // Map file extension to {type:}
			contentTypeInfo: Object.create(null), // Map type to {encoding:,extension:}
			pluginsEnvVar: "TIDDLYWIKI_PLUGIN_PATH",
			themesEnvVar: "TIDDLYWIKI_THEME_PATH",
			languagesEnvVar: "TIDDLYWIKI_LANGUAGE_PATH",
			editionsEnvVar: "TIDDLYWIKI_EDITION_PATH"
		},
		log: {} // Log flags
	});
	if(!$tw.boot.tasks.readBrowserTiddlers) {
		// For writable tiddler files, a hashmap of title to {filepath:,type:,hasMetaFile:}
		$tw.boot.files = Object.create(null);
		// System paths and filenames
		$tw.boot.bootPath = path.dirname(module.filename);
		$tw.boot.corePath = path.resolve($tw.boot.bootPath,"../core");
		// If there's no arguments then default to `--help`
		if($tw.boot.argv.length === 0) {
			$tw.boot.argv = ["--help"];
		}
		// If the first command line argument doesn't start with `--` then we
		// interpret it as the path to the wiki folder, which will otherwise default
		// to the current folder
		if($tw.boot.argv[0] && $tw.boot.argv[0].indexOf("--") !== 0) {
			$tw.boot.wikiPath = $tw.boot.argv[0];
			$tw.boot.argv = $tw.boot.argv.slice(1);
		} else {
			$tw.boot.wikiPath = process.cwd();
		}
		// Read package info
		$tw.packageInfo = require("../package.json");
		// Check node version number
		if($tw.utils.checkVersions($tw.packageInfo.engines.node.substr(2),process.version.substr(1))) {
			$tw.utils.error("TiddlyWiki5 requires node.js version " + $tw.packageInfo.engines.node);
		}
	}
	// Add file extension information
	$tw.utils.registerFileType("text/vnd.tiddlywiki","utf8",".tid");
	$tw.utils.registerFileType("application/x-tiddler","utf8",".tid");
	$tw.utils.registerFileType("application/x-tiddlers","utf8",".multids");
	$tw.utils.registerFileType("application/x-tiddler-html-div","utf8",".tiddler");
	$tw.utils.registerFileType("text/vnd.tiddlywiki2-recipe","utf8",".recipe");
	$tw.utils.registerFileType("text/plain","utf8",".txt");
	$tw.utils.registerFileType("text/css","utf8",".css");
	$tw.utils.registerFileType("text/html","utf8",[".html",".htm"]);
	$tw.utils.registerFileType("application/hta","utf16le",".hta",{deserializerType:"text/html"});
	$tw.utils.registerFileType("application/javascript","utf8",".js");
	$tw.utils.registerFileType("application/json","utf8",".json");
	$tw.utils.registerFileType("application/pdf","base64",".pdf",{flags:["image"]});
	$tw.utils.registerFileType("image/jpeg","base64",[".jpg",".jpeg"],{flags:["image"]});
	$tw.utils.registerFileType("image/png","base64",".png",{flags:["image"]});
	$tw.utils.registerFileType("image/gif","base64",".gif",{flags:["image"]});
	$tw.utils.registerFileType("image/svg+xml","utf8",".svg",{flags:["image"]});
	$tw.utils.registerFileType("image/x-icon","base64",".ico",{flags:["image"]});
	$tw.utils.registerFileType("application/font-woff","base64",".woff");
	$tw.utils.registerFileType("audio/ogg","base64",".ogg");
	$tw.utils.registerFileType("audio/mp3","base64",".mp3");
	$tw.utils.registerFileType("audio/mp4","base64",[".mp4",".m4a"]);
	$tw.utils.registerFileType("text/x-markdown","utf8",[".md",".markdown"]);
	// Create the wiki store for the app
	$tw.wiki = new $tw.Wiki();
	// Install built in tiddler fields modules
	$tw.Tiddler.fieldModules = $tw.modules.getModulesByTypeAsHashmap("tiddlerfield");
	// Install the tiddler deserializer modules
	$tw.Wiki.tiddlerDeserializerModules = Object.create(null);
	$tw.modules.applyMethods("tiddlerdeserializer",$tw.Wiki.tiddlerDeserializerModules);
	// Load tiddlers
	if($tw.boot.tasks.readBrowserTiddlers) {
		$tw.loadTiddlersBrowser();
	} else {
		$tw.loadTiddlersNode();
	}
	// Unpack plugin tiddlers
	$tw.wiki.readPluginInfo();
	$tw.wiki.registerPluginTiddlers("plugin",$tw.safeMode ? ["$:/core"] : undefined);
	$tw.wiki.unpackPluginTiddlers();
	// Process "safe mode"
	if($tw.safeMode) {
		$tw.wiki.processSafeMode();
	}
	// Register typed modules from the tiddlers we've just loaded
	$tw.wiki.defineTiddlerModules();
	// And any modules within plugins
	$tw.wiki.defineShadowModules();
	// Make sure the crypto state tiddler is up to date
	if($tw.crypto) {
		$tw.crypto.updateCryptoStateTiddler();
	}
	// Gather up any startup modules
	$tw.boot.remainingStartupModules = []; // Array of startup modules
	$tw.modules.forEachModuleOfType("startup",function(title,module) {
		if(module.startup) {
			$tw.boot.remainingStartupModules.push(module);
		}
	});
	// Keep track of the startup tasks that have been executed
	$tw.boot.executedStartupModules = Object.create(null);
	$tw.boot.disabledStartupModules = $tw.boot.disabledStartupModules || [];
	// Repeatedly execute the next eligible task
	$tw.boot.executeNextStartupTask();
};

/*
Execute the remaining eligible startup tasks
*/
$tw.boot.executeNextStartupTask = function() {
	// Find the next eligible task
	var taskIndex = 0, task,
		asyncTaskCallback = function() {
			if(task.name) {
				$tw.boot.executedStartupModules[task.name] = true;
			}
			return $tw.boot.executeNextStartupTask();
		};
	while(taskIndex < $tw.boot.remainingStartupModules.length) {
		task = $tw.boot.remainingStartupModules[taskIndex];
		if($tw.boot.isStartupTaskEligible(task)) {
			// Remove this task from the list
			$tw.boot.remainingStartupModules.splice(taskIndex,1);
			// Assemble log message
			var s = ["Startup task:",task.name];
			if(task.platforms) {
				s.push("platforms:",task.platforms.join(","));
			}
			if(task.after) {
				s.push("after:",task.after.join(","));
			}
			if(task.before) {
				s.push("before:",task.before.join(","));
			}
			$tw.boot.log(s.join(" "));
			// Execute task
			if(!$tw.utils.hop(task,"synchronous") || task.synchronous) {
				task.startup();
				if(task.name) {
					$tw.boot.executedStartupModules[task.name] = true;
				}
				return $tw.boot.executeNextStartupTask();
			} else {
				task.startup(asyncTaskCallback);
				return true;
			}
		}
		taskIndex++;
	}
	return false;
};

/*
Returns true if we are running on one platforms specified in a task modules `platforms` array
*/
$tw.boot.doesTaskMatchPlatform = function(taskModule) {
	var platforms = taskModule.platforms;
	if(platforms) {
		for(var t=0; t<platforms.length; t++) {
			if((platforms[t] === "browser" && !$tw.browser) || (platforms[t] === "node" && !$tw.node)) {
				return false;
			}
		}
	}
	return true;
};

$tw.boot.isStartupTaskEligible = function(taskModule) {
	var t;
	// Check that the platform is correct
	if(!$tw.boot.doesTaskMatchPlatform(taskModule)) {
		return false;
	}
	var name = taskModule.name,
		remaining = $tw.boot.remainingStartupModules;
	if(name) {
		// Fail if this module is disabled
		if($tw.boot.disabledStartupModules.indexOf(name) !== -1) {
			return false;
		}
		// Check that no other outstanding tasks must be executed before this one
		for(t=0; t<remaining.length; t++) {
			var task = remaining[t];
			if(task.before && task.before.indexOf(name) !== -1) {
				if($tw.boot.doesTaskMatchPlatform(task) || (task.name && $tw.boot.disabledStartupModules.indexOf(name) !== -1)) {
					return false;
				}
			}
		}
	}
	// Check that all of the tasks that we must be performed after has been done
	var after = taskModule.after;
	if(after) {
		for(t=0; t<after.length; t++) {
			if(!$tw.boot.executedStartupModules[after[t]]) {
				return false;
			}
		}
	}
	return true;
};

/*
Global Hooks mechanism which allows plugins to modify default functionality
*/
$tw.hooks = $tw.hooks || { names: {}};
 
/*
Add hooks to the  hashmap 
*/
$tw.hooks.addHook = function(hookName,definition) {
	if($tw.utils.hop($tw.hooks.names,hookName)) {
		$tw.hooks.names[hookName].push(definition);
	}
	else {
		$tw.hooks.names[hookName] = [definition];
	}
};
 
/*
Invoke the hook by key 
*/
$tw.hooks.invokeHook = function(hookName, value) {
	if($tw.utils.hop($tw.hooks.names,hookName)) {
		for (var i = 0; i < $tw.hooks.names[hookName].length; i++) {
			value = $tw.hooks.names[hookName][i](value);
		}
	}
	return value;
};

/////////////////////////// Main boot function to decrypt tiddlers and then startup

$tw.boot.boot = function() {
	// Initialise crypto object
	$tw.crypto = new $tw.utils.Crypto();
	// Initialise password prompter
	if($tw.browser && !$tw.node) {
		$tw.passwordPrompt = new $tw.utils.PasswordPrompt();
	}
	// Preload any encrypted tiddlers
	$tw.boot.decryptEncryptedTiddlers(function() {
		// Startup
		$tw.boot.startup();
	});
};

/////////////////////////// Autoboot in the browser

if($tw.browser && !$tw.boot.suppressBoot) {
	$tw.boot.boot();
}

return $tw;

});

if(typeof(exports) !== "undefined") {
	exports.TiddlyWiki = _boot;
} else {
	_boot(window.$tw);
}</script>
</div>
</body>
</html>
