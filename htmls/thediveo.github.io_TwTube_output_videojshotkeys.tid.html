author: TheDiveO
created: 20140902114846490
creator: TheDiveO
description: Keyboard hotkeys for the Video.js video player
list: readme license history
modified: 20180405141712866
modifier: TheDiveO
plugin-type: plugin
source: http://thediveo.github.io/TwTube
title: $:/plugins/TheDiveO/VideojsHotkeys
type: application/json
version: 1.0.1

{"tiddlers":{"$:/plugins/TheDiveO/VideojsHotkeys/videojs.hotkeys.js":{"text":"/* automatically included from npm package `videojs-hotkeys` */\r\n/*\n * Video.js Hotkeys\n * https://github.com/ctd1500/videojs-hotkeys\n *\n * Copyright (c) 2015 Chris Dougherty\n * Licensed under the Apache-2.0 license.\n */\n\n;(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define('videojs-hotkeys', ['video.js'], function (module) {\n      return factory(module.default || module);\n    });\n  } else if (typeof module !== 'undefined' && module.exports) {\n    module.exports = factory(require('video.js'));\n  } else {\n    factory(videojs);\n  }\n}(this, function (videojs) {\n  \"use strict\";\n  if (typeof window !== 'undefined') {\n    window['videojs_hotkeys'] = { version: \"0.2.21\" };\n  }\n\n  var hotkeys = function(options) {\n    var player = this;\n    var pEl = player.el();\n    var doc = document;\n    var def_options = {\n      volumeStep: 0.1,\n      seekStep: 5,\n      enableMute: true,\n      enableVolumeScroll: true,\n      enableFullscreen: true,\n      enableNumbers: true,\n      enableJogStyle: false,\n      alwaysCaptureHotkeys: false,\n      enableModifiersForNumbers: true,\n      enableInactiveFocus: true,\n      skipInitialFocus: false,\n      playPauseKey: playPauseKey,\n      rewindKey: rewindKey,\n      forwardKey: forwardKey,\n      volumeUpKey: volumeUpKey,\n      volumeDownKey: volumeDownKey,\n      muteKey: muteKey,\n      fullscreenKey: fullscreenKey,\n      customKeys: {}\n    };\n\n    var cPlay = 1,\n      cRewind = 2,\n      cForward = 3,\n      cVolumeUp = 4,\n      cVolumeDown = 5,\n      cMute = 6,\n      cFullscreen = 7;\n\n    // Use built-in merge function from Video.js v5.0+ or v4.4.0+\n    var mergeOptions = videojs.mergeOptions || videojs.util.mergeOptions;\n    options = mergeOptions(def_options, options || {});\n\n    var volumeStep = options.volumeStep,\n      seekStep = options.seekStep,\n      enableMute = options.enableMute,\n      enableVolumeScroll = options.enableVolumeScroll,\n      enableFull = options.enableFullscreen,\n      enableNumbers = options.enableNumbers,\n      enableJogStyle = options.enableJogStyle,\n      alwaysCaptureHotkeys = options.alwaysCaptureHotkeys,\n      enableModifiersForNumbers = options.enableModifiersForNumbers,\n      enableInactiveFocus = options.enableInactiveFocus,\n      skipInitialFocus = options.skipInitialFocus;\n\n    // Set default player tabindex to handle keydown and doubleclick events\n    if (!pEl.hasAttribute('tabIndex')) {\n      pEl.setAttribute('tabIndex', '-1');\n    }\n\n    // Remove player outline to fix video performance issue\n    pEl.style.outline = \"none\";\n\n    if (alwaysCaptureHotkeys || !player.autoplay()) {\n      if (!skipInitialFocus) {\n        player.one('play', function() {\n          pEl.focus(); // Fixes the .vjs-big-play-button handing focus back to body instead of the player\n        });\n      }\n    }\n\n    if (enableInactiveFocus) {\n      player.on('userinactive', function() {\n        // When the control bar fades, re-apply focus to the player if last focus was a control button\n        var cancelFocusingPlayer = function() {\n          clearTimeout(focusingPlayerTimeout);\n        };\n        var focusingPlayerTimeout = setTimeout(function() {\n          player.off('useractive', cancelFocusingPlayer);\n          if (doc.activeElement.parentElement == pEl.querySelector('.vjs-control-bar')) {\n            pEl.focus();\n          }\n        }, 10);\n\n        player.one('useractive', cancelFocusingPlayer);\n      });\n    }\n\n    player.on('play', function() {\n      // Fix allowing the YouTube plugin to have hotkey support.\n      var ifblocker = pEl.querySelector('.iframeblocker');\n      if (ifblocker && ifblocker.style.display === '') {\n        ifblocker.style.display = \"block\";\n        ifblocker.style.bottom = \"39px\";\n      }\n    });\n\n    var keyDown = function keyDown(event) {\n      var ewhich = event.which, wasPlaying, seekTime;\n      var ePreventDefault = event.preventDefault;\n      var duration = player.duration();\n      // When controls are disabled, hotkeys will be disabled as well\n      if (player.controls()) {\n\n        // Don't catch keys if any control buttons are focused, unless alwaysCaptureHotkeys is true\n        var activeEl = doc.activeElement;\n        if (alwaysCaptureHotkeys ||\n            activeEl == pEl ||\n            activeEl == pEl.querySelector('.vjs-tech') ||\n            activeEl == pEl.querySelector('.vjs-control-bar') ||\n            activeEl == pEl.querySelector('.iframeblocker')) {\n\n          switch (checkKeys(event, player)) {\n            // Spacebar toggles play/pause\n            case cPlay:\n              ePreventDefault();\n              if (alwaysCaptureHotkeys) {\n                // Prevent control activation with space\n                event.stopPropagation();\n              }\n\n              if (player.paused()) {\n                player.play();\n              } else {\n                player.pause();\n              }\n              break;\n\n            // Seeking with the left/right arrow keys\n            case cRewind: // Seek Backward\n              wasPlaying = !player.paused();\n              ePreventDefault();\n              if (wasPlaying) {\n                player.pause();\n              }\n              seekTime = player.currentTime() - seekStep;\n              // The flash player tech will allow you to seek into negative\n              // numbers and break the seekbar, so try to prevent that.\n              if (player.currentTime() <= seekStep) {\n                seekTime = 0;\n              }\n              player.currentTime(seekTime);\n              if (wasPlaying) {\n                player.play();\n              }\n              break;\n            case cForward: // Seek Forward\n              wasPlaying = !player.paused();\n              ePreventDefault();\n              if (wasPlaying) {\n                player.pause();\n              }\n              seekTime = player.currentTime() + seekStep;\n              // Fixes the player not sending the end event if you\n              // try to seek past the duration on the seekbar.\n              if (seekTime >= duration) {\n                seekTime = wasPlaying ? duration - .001 : duration;\n              }\n              player.currentTime(seekTime);\n              if (wasPlaying) {\n                player.play();\n              }\n              break;\n\n            // Volume control with the up/down arrow keys\n            case cVolumeDown:\n              ePreventDefault();\n              if (!enableJogStyle) {\n                player.volume(player.volume() - volumeStep);\n              } else {\n                seekTime = player.currentTime() - 1;\n                if (player.currentTime() <= 1) {\n                  seekTime = 0;\n                }\n                player.currentTime(seekTime);\n              }\n              break;\n            case cVolumeUp:\n              ePreventDefault();\n              if (!enableJogStyle) {\n                player.volume(player.volume() + volumeStep);\n              } else {\n                seekTime = player.currentTime() + 1;\n                if (seekTime >= duration) {\n                  seekTime = duration;\n                }\n                player.currentTime(seekTime);\n              }\n              break;\n\n            // Toggle Mute with the M key\n            case cMute:\n              if (enableMute) {\n                player.muted(!player.muted());\n              }\n              break;\n\n            // Toggle Fullscreen with the F key\n            case  cFullscreen:\n              if (enableFull) {\n                if (player.isFullscreen()) {\n                  player.exitFullscreen();\n                } else {\n                  player.requestFullscreen();\n                }\n              }\n              break;\n\n            default:\n              // Number keys from 0-9 skip to a percentage of the video. 0 is 0% and 9 is 90%\n              if ((ewhich > 47 && ewhich < 59) || (ewhich > 95 && ewhich < 106)) {\n                // Do not handle if enableModifiersForNumbers set to false and keys are Ctrl, Cmd or Alt\n                if (enableModifiersForNumbers || !(event.metaKey || event.ctrlKey || event.altKey)) {\n                  if (enableNumbers) {\n                    var sub = 48;\n                    if (ewhich > 95) {\n                      sub = 96;\n                    }\n                    var number = ewhich - sub;\n                    ePreventDefault();\n                    player.currentTime(player.duration() * number * 0.1);\n                  }\n                }\n              }\n\n              // Handle any custom hotkeys\n              for (var customKey in options.customKeys) {\n                var customHotkey = options.customKeys[customKey];\n                // Check for well formed custom keys\n                if (customHotkey && customHotkey.key && customHotkey.handler) {\n                  // Check if the custom key's condition matches\n                  if (customHotkey.key(event)) {\n                    ePreventDefault();\n                    customHotkey.handler(player, options, event);\n                  }\n                }\n              }\n          }\n        }\n      }\n    };\n\n    var doubleClick = function doubleClick(event) {\n      // When controls are disabled, hotkeys will be disabled as well\n      if (player.controls()) {\n\n        // Don't catch clicks if any control buttons are focused\n        var activeEl = event.relatedTarget || event.toElement || doc.activeElement;\n        if (activeEl == pEl ||\n            activeEl == pEl.querySelector('.vjs-tech') ||\n            activeEl == pEl.querySelector('.iframeblocker')) {\n\n          if (enableFull) {\n            if (player.isFullscreen()) {\n              player.exitFullscreen();\n            } else {\n              player.requestFullscreen();\n            }\n          }\n        }\n      }\n    };\n\n    var mouseScroll = function mouseScroll(event) {\n      // When controls are disabled, hotkeys will be disabled as well\n      if (player.controls()) {\n        var activeEl = doc.activeElement;\n        if (alwaysCaptureHotkeys ||\n            activeEl == pEl ||\n            activeEl == pEl.querySelector('.vjs-tech') ||\n            activeEl == pEl.querySelector('.iframeblocker') ||\n            activeEl == pEl.querySelector('.vjs-control-bar')) {\n\n          if (enableVolumeScroll) {\n            event = window.event || event;\n            var delta = Math.max(-1, Math.min(1, (event.wheelDelta || -event.detail)));\n            event.preventDefault();\n\n            if (delta == 1) {\n              player.volume(player.volume() + volumeStep);\n            } else if (delta == -1) {\n              player.volume(player.volume() - volumeStep);\n            }\n          }\n        }\n      }\n    };\n\n    var checkKeys = function checkKeys(e, player) {\n      // Allow some modularity in defining custom hotkeys\n\n      // Play/Pause check\n      if (options.playPauseKey(e, player)) {\n        return cPlay;\n      }\n\n      // Seek Backward check\n      if (options.rewindKey(e, player)) {\n        return cRewind;\n      }\n\n      // Seek Forward check\n      if (options.forwardKey(e, player)) {\n        return cForward;\n      }\n\n      // Volume Up check\n      if (options.volumeUpKey(e, player)) {\n        return cVolumeUp;\n      }\n\n      // Volume Down check\n      if (options.volumeDownKey(e, player)) {\n        return cVolumeDown;\n      }\n\n      // Mute check\n      if (options.muteKey(e, player)) {\n        return cMute;\n      }\n\n      // Fullscreen check\n      if (options.fullscreenKey(e, player)) {\n        return cFullscreen;\n      }\n    };\n\n    function playPauseKey(e) {\n      // Space bar or MediaPlayPause\n      return (e.which === 32 || e.which === 179);\n    }\n\n    function rewindKey(e) {\n      // Left Arrow or MediaRewind\n      return (e.which === 37 || e.which === 177);\n    }\n\n    function forwardKey(e) {\n      // Right Arrow or MediaForward\n      return (e.which === 39 || e.which === 176);\n    }\n\n    function volumeUpKey(e) {\n      // Up Arrow\n      return (e.which === 38);\n    }\n\n    function volumeDownKey(e) {\n      // Down Arrow\n      return (e.which === 40);\n    }\n\n    function muteKey(e) {\n      // M key\n      return (e.which === 77);\n    }\n\n    function fullscreenKey(e) {\n      // F key\n      return (e.which === 70);\n    }\n\n    player.on('keydown', keyDown);\n    player.on('dblclick', doubleClick);\n    player.on('mousewheel', mouseScroll);\n    player.on(\"DOMMouseScroll\", mouseScroll);\n\n    return this;\n  };\n\n  var registerPlugin = videojs.registerPlugin || videojs.plugin;\n  registerPlugin('hotkeys', hotkeys);\n}));\n","title":"$:/plugins/TheDiveO/VideojsHotkeys/videojs.hotkeys.js","type":"application/javascript","tags":"$:/tags/VideojsPlugin","created":"20140902114846490","creator":"TheDiveO","modified":"20140902114846490"},"$:/plugins/TheDiveO/VideojsHotkeys/history":{"title":"$:/plugins/TheDiveO/VideojsHotkeys/history","created":"20180127152008953","modified":"20180405141701908","tags":"","type":"text/vnd.tiddlywiki","text":"* ''1.0.1'' -- automatically uses npm package `videojs-hotkeys`.\n* ''1.0.0'' – first release of the Video.js Hotkeys Skin plugin."},"$:/plugins/TheDiveO/VideojsHotkeys/license":{"title":"$:/plugins/TheDiveO/VideojsHotkeys/license","created":"20180127151728845","modified":"20180127151932518","tags":"","type":"text/vnd.tiddlywiki","text":"* The Video.js Hotkeys Plugin ([[$:/plugins/TheDiveO/VideojsHotkeys/videojs.hotkeys.js]]) is licensed under the [[Apache License 2.0|https://opensource.org/licenses/Apache-2.0]].\n* This plugin is licensed under the [[MIT License|http://opensource.org/licenses/MIT]]."},"$:/plugins/TheDiveO/VideojsHotkeys/readme":{"title":"$:/plugins/TheDiveO/VideojsHotkeys/readme","created":"20180127151555515","modified":"20180127151709239","tags":"","type":"text/vnd.tiddlywiki","text":"Provides the [[Video.js Hotkeys Plugin|https://github.com/ctd1500/videojs-hotkeys]] (~GitHub) by [[ctd1500|https://github.com/ctd1500]] (~GitHub) for use with the [[TwTube plugin|https://github.com/TheDiveO/TwTube]] (//you guessed right// ... ~GitHub). Simply install this plugin into your ~TiddlyWiki alongside the ~TwTube plugin and you're done."},"$:/plugins/TheDiveO/VideojsHotkeys/videojs.persistvolume.config":{"title":"$:/plugins/TheDiveO/VideojsHotkeys/videojs.persistvolume.config","created":"20180126205823852","modified":"20180126210055994","tags":"$:/tags/VideojsPluginConfig","type":"application/json","text":"{\n  \"hotkeys\": {\n    \"alwaysCaptureHotkeys\": \"true\",\n    \"seekStep\": \"15\"\n  }\n}\n"}}}