author: TheDiveO
core-version: >=5.1.12
created: 20180809162746002
description: Fuse.js plugin for TiddlyWiki5
list: readme license history
modified: 20200720190210294
plugin-type: plugin
source: https://github.com/TheDiveO/TwFusejs
tags: 
title: $:/plugins/TheDiveO/TwFusejs
type: application/json
version: 0.9.3

{"tiddlers":{"$:/plugins/TheDiveO/TwFusejs/libs/fuse.js":{"text":"/* automatically included from npm package `fuse.js` */\r\n/**\n * Fuse.js v6.4.0 - Lightweight fuzzy-search (http://fusejs.io)\n *\n * Copyright (c) 2020 Kiro Risk (http://kiro.me)\n * All Rights Reserved. Apache Software License 2.0\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\nvar e,t;e=this,t=function(){\"use strict\";function e(t){return(e=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){return!t||\"object\"!=typeof t&&\"function\"!=typeof t?function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e):t}function f(e){var t=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if(\"string\"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===n&&e.constructor&&(n=e.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e){return Array.isArray?Array.isArray(e):\"[object Array]\"===Object.prototype.toString.call(e)}function g(e){return\"string\"==typeof e}function y(e){return\"number\"==typeof e}function p(e){return null!=e}function m(e){return!e.trim().length}var k=function(e){return\"Invalid value for key \".concat(e)},M=function(e){return\"Pattern length exceeds max of \".concat(e,\".\")},x=Object.prototype.hasOwnProperty,b=function(){function e(n){var r=this;t(this,e),this._keys=[],this._keyMap={};var i=0;n.forEach((function(e){var t=S(e);i+=t.weight,r._keys.push(t),r._keyMap[t.id]=t,i+=t.weight})),this._keys.forEach((function(e){e.weight/=i}))}return r(e,[{key:\"get\",value:function(e){return this._keyMap[e]}},{key:\"keys\",value:function(){return this._keys}},{key:\"toJSON\",value:function(){return JSON.stringify(this._keys)}}]),e}();function S(e){var t=null,n=null,r=null,i=1;if(g(e)||v(e))r=e,t=_(e),n=w(e);else{if(!x.call(e,\"name\"))throw new Error(function(e){return\"Missing \".concat(e,\" property in key\")}(\"name\"));var o=e.name;if(r=o,x.call(e,\"weight\")&&(i=e.weight)<=0)throw new Error(function(e){return\"Property 'weight' in key '\".concat(e,\"' must be a positive integer\")}(o));t=_(o),n=w(o)}return{path:t,id:n,weight:i,src:r}}function _(e){return v(e)?e:e.split(\".\")}function w(e){return v(e)?e.join(\".\"):e}var L=c({},{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(e,t){return e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1}},{},{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},{},{location:0,threshold:.6,distance:100},{},{useExtendedSearch:!1,getFn:function(e,t){var n=[],r=!1;return function e(t,i,o){if(i[o]){var c=t[i[o]];if(!p(c))return;if(o===i.length-1&&(g(c)||y(c)))n.push(function(e){return null==e?\"\":function(e){if(\"string\"==typeof e)return e;var t=e+\"\";return\"0\"==t&&1/e==-1/0?\"-0\":t}(e)}(c));else if(v(c)){r=!0;for(var a=0,s=c.length;a<s;a+=1)e(c[a],i,o+1)}else i.length&&e(c,i,o+1)}else n.push(t)}(e,g(t)?t.split(\".\"):t,0),r?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1}),O=/[^ ]+/g;function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=new Map;return{get:function(n){var r=n.match(O).length;if(t.has(r))return t.get(r);var i=parseFloat((1/Math.sqrt(r)).toFixed(e));return t.set(r,i),i},clear:function(){t.clear()}}}var I=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.getFn,i=void 0===r?L.getFn:r;t(this,e),this.norm=A(3),this.getFn=i,this.isCreated=!1,this.setIndexRecords()}return r(e,[{key:\"setSources\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.docs=e}},{key:\"setIndexRecords\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.records=e}},{key:\"setKeys\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.keys=t,this._keysMap={},t.forEach((function(t,n){e._keysMap[t.id]=n}))}},{key:\"create\",value:function(){var e=this;!this.isCreated&&this.docs.length&&(this.isCreated=!0,g(this.docs[0])?this.docs.forEach((function(t,n){e._addString(t,n)})):this.docs.forEach((function(t,n){e._addObject(t,n)})),this.norm.clear())}},{key:\"add\",value:function(e){var t=this.size();g(e)?this._addString(e,t):this._addObject(e,t)}},{key:\"removeAt\",value:function(e){this.records.splice(e,1);for(var t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}},{key:\"getValueForItemAtKeyId\",value:function(e,t){return e[this._keysMap[t]]}},{key:\"size\",value:function(){return this.records.length}},{key:\"_addString\",value:function(e,t){if(p(e)&&!m(e)){var n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}}},{key:\"_addObject\",value:function(e,t){var n=this,r={i:t,$:{}};this.keys.forEach((function(t,i){var o=n.getFn(e,t.path);if(p(o))if(v(o))!function(){for(var e=[],t=[{nestedArrIndex:-1,value:o}];t.length;){var c=t.pop(),a=c.nestedArrIndex,s=c.value;if(p(s))if(g(s)&&!m(s)){var u={v:s,i:a,n:n.norm.get(s)};e.push(u)}else v(s)&&s.forEach((function(e,n){t.push({nestedArrIndex:n,value:e})}))}r.$[i]=e}();else if(!m(o)){var c={v:o,n:n.norm.get(o)};r.$[i]=c}})),this.records.push(r)}},{key:\"toJSON\",value:function(){return{keys:this.keys,records:this.records}}}]),e}();function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.getFn,i=void 0===r?L.getFn:r,o=new I({getFn:i});return o.setKeys(e.map(S)),o.setSources(t),o.create(),o}function j(e,t){var n=e.matches;t.matches=[],p(n)&&n.forEach((function(e){if(p(e.indices)&&e.indices.length){var n={indices:e.indices,value:e.value};e.key&&(n.key=e.key.src),e.idx>-1&&(n.refIndex=e.idx),t.matches.push(n)}}))}function E(e,t){t.score=e.score}function $(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.errors,r=void 0===n?0:n,i=t.currentLocation,o=void 0===i?0:i,c=t.expectedLocation,a=void 0===c?0:c,s=t.distance,u=void 0===s?L.distance:s,h=t.ignoreLocation,f=void 0===h?L.ignoreLocation:h,l=r/e.length;if(f)return l;var d=Math.abs(a-o);return u?l+d/u:d?1:l}function R(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L.minMatchCharLength,n=[],r=-1,i=-1,o=0,c=e.length;o<c;o+=1){var a=e[o];a&&-1===r?r=o:a||-1===r||((i=o-1)-r+1>=t&&n.push([r,i]),r=-1)}return e[o-1]&&o-r>=t&&n.push([r,o-1]),n}function F(e){for(var t={},n=0,r=e.length;n<r;n+=1){var i=e.charAt(n);t[i]=(t[i]||0)|1<<r-n-1}return t}var P=function(){function e(n){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.location,c=void 0===o?L.location:o,a=i.threshold,s=void 0===a?L.threshold:a,u=i.distance,h=void 0===u?L.distance:u,f=i.includeMatches,l=void 0===f?L.includeMatches:f,d=i.findAllMatches,v=void 0===d?L.findAllMatches:d,g=i.minMatchCharLength,y=void 0===g?L.minMatchCharLength:g,p=i.isCaseSensitive,m=void 0===p?L.isCaseSensitive:p,k=i.ignoreLocation,M=void 0===k?L.ignoreLocation:k;if(t(this,e),this.options={location:c,threshold:s,distance:h,includeMatches:l,findAllMatches:v,minMatchCharLength:y,isCaseSensitive:m,ignoreLocation:M},this.pattern=m?n:n.toLowerCase(),this.chunks=[],this.pattern.length){var x=function(e,t){r.chunks.push({pattern:e,alphabet:F(e),startIndex:t})},b=this.pattern.length;if(b>32){for(var S=0,_=b%32,w=b-_;S<w;)x(this.pattern.substr(S,32),S),S+=32;if(_){var O=b-32;x(this.pattern.substr(O),O)}}else x(this.pattern,0)}}return r(e,[{key:\"searchIn\",value:function(e){var t=this.options,n=t.isCaseSensitive,r=t.includeMatches;if(n||(e=e.toLowerCase()),this.pattern===e){var i={isMatch:!0,score:0};return r&&(i.indices=[[0,e.length-1]]),i}var o=this.options,c=o.location,a=o.distance,s=o.threshold,u=o.findAllMatches,h=o.minMatchCharLength,f=o.ignoreLocation,d=[],v=0,g=!1;this.chunks.forEach((function(t){var n=t.pattern,i=t.alphabet,o=t.startIndex,y=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.location,o=void 0===i?L.location:i,c=r.distance,a=void 0===c?L.distance:c,s=r.threshold,u=void 0===s?L.threshold:s,h=r.findAllMatches,f=void 0===h?L.findAllMatches:h,l=r.minMatchCharLength,d=void 0===l?L.minMatchCharLength:l,v=r.includeMatches,g=void 0===v?L.includeMatches:v,y=r.ignoreLocation,p=void 0===y?L.ignoreLocation:y;if(t.length>32)throw new Error(M(32));for(var m,k=t.length,x=e.length,b=Math.max(0,Math.min(o,x)),S=u,_=b,w=d>1||g,O=w?Array(x):[];(m=e.indexOf(t,_))>-1;){var A=$(t,{currentLocation:m,expectedLocation:b,distance:a,ignoreLocation:p});if(S=Math.min(A,S),_=m+k,w)for(var I=0;I<k;)O[m+I]=1,I+=1}_=-1;for(var C=[],j=1,E=k+x,F=1<<k-1,P=0;P<k;P+=1){for(var N=0,D=E;N<D;){var z=$(t,{errors:P,currentLocation:b+D,expectedLocation:b,distance:a,ignoreLocation:p});z<=S?N=D:E=D,D=Math.floor((E-N)/2+N)}E=D;var K=Math.max(1,b-D+1),q=f?x:Math.min(b+D,x)+k,W=Array(q+2);W[q+1]=(1<<P)-1;for(var J=q;J>=K;J-=1){var T=J-1,V=n[e.charAt(T)];if(w&&(O[T]=+!!V),W[J]=(W[J+1]<<1|1)&V,P&&(W[J]|=(C[J+1]|C[J])<<1|1|C[J+1]),W[J]&F&&(j=$(t,{errors:P,currentLocation:T,expectedLocation:b,distance:a,ignoreLocation:p}))<=S){if(S=j,(_=T)<=b)break;K=Math.max(1,2*b-_)}}var U=$(t,{errors:P+1,currentLocation:b,expectedLocation:b,distance:a,ignoreLocation:p});if(U>S)break;C=W}var B={isMatch:_>=0,score:Math.max(.001,j)};if(w){var G=R(O,d);G.length?g&&(B.indices=G):B.isMatch=!1}return B}(e,n,i,{location:c+o,distance:a,threshold:s,findAllMatches:u,minMatchCharLength:h,includeMatches:r,ignoreLocation:f}),p=y.isMatch,m=y.score,k=y.indices;p&&(g=!0),v+=m,p&&k&&(d=[].concat(l(d),l(k)))}));var y={isMatch:g,score:g?v/this.chunks.length:1};return g&&r&&(y.indices=d),y}}]),e}(),N=function(){function e(n){t(this,e),this.pattern=n}return r(e,[{key:\"search\",value:function(){}}],[{key:\"isMultiMatch\",value:function(e){return D(e,this.multiRegex)}},{key:\"isSingleMatch\",value:function(e){return D(e,this.singleRegex)}}]),e}();function D(e,t){var n=e.match(t);return n?n[1]:null}var z=function(e){a(i,e);var n=f(i);function i(e){return t(this,i),n.call(this,e)}return r(i,[{key:\"search\",value:function(e){var t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}],[{key:\"type\",get:function(){return\"exact\"}},{key:\"multiRegex\",get:function(){return/^=\"(.*)\"$/}},{key:\"singleRegex\",get:function(){return/^=(.*)$/}}]),i}(N),K=function(e){a(i,e);var n=f(i);function i(e){return t(this,i),n.call(this,e)}return r(i,[{key:\"search\",value:function(e){var t=-1===e.indexOf(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:\"type\",get:function(){return\"inverse-exact\"}},{key:\"multiRegex\",get:function(){return/^!\"(.*)\"$/}},{key:\"singleRegex\",get:function(){return/^!(.*)$/}}]),i}(N),q=function(e){a(i,e);var n=f(i);function i(e){return t(this,i),n.call(this,e)}return r(i,[{key:\"search\",value:function(e){var t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}],[{key:\"type\",get:function(){return\"prefix-exact\"}},{key:\"multiRegex\",get:function(){return/^\\^\"(.*)\"$/}},{key:\"singleRegex\",get:function(){return/^\\^(.*)$/}}]),i}(N),W=function(e){a(i,e);var n=f(i);function i(e){return t(this,i),n.call(this,e)}return r(i,[{key:\"search\",value:function(e){var t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:\"type\",get:function(){return\"inverse-prefix-exact\"}},{key:\"multiRegex\",get:function(){return/^!\\^\"(.*)\"$/}},{key:\"singleRegex\",get:function(){return/^!\\^(.*)$/}}]),i}(N),J=function(e){a(i,e);var n=f(i);function i(e){return t(this,i),n.call(this,e)}return r(i,[{key:\"search\",value:function(e){var t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}],[{key:\"type\",get:function(){return\"suffix-exact\"}},{key:\"multiRegex\",get:function(){return/^\"(.*)\"\\$$/}},{key:\"singleRegex\",get:function(){return/^(.*)\\$$/}}]),i}(N),T=function(e){a(i,e);var n=f(i);function i(e){return t(this,i),n.call(this,e)}return r(i,[{key:\"search\",value:function(e){var t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:\"type\",get:function(){return\"inverse-suffix-exact\"}},{key:\"multiRegex\",get:function(){return/^!\"(.*)\"\\$$/}},{key:\"singleRegex\",get:function(){return/^!(.*)\\$$/}}]),i}(N),V=function(e){a(i,e);var n=f(i);function i(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=o.location,a=void 0===c?L.location:c,s=o.threshold,u=void 0===s?L.threshold:s,h=o.distance,f=void 0===h?L.distance:h,l=o.includeMatches,d=void 0===l?L.includeMatches:l,v=o.findAllMatches,g=void 0===v?L.findAllMatches:v,y=o.minMatchCharLength,p=void 0===y?L.minMatchCharLength:y,m=o.isCaseSensitive,k=void 0===m?L.isCaseSensitive:m;return t(this,i),(r=n.call(this,e))._bitapSearch=new P(e,{location:a,threshold:u,distance:f,includeMatches:d,findAllMatches:g,minMatchCharLength:p,isCaseSensitive:k}),r}return r(i,[{key:\"search\",value:function(e){return this._bitapSearch.searchIn(e)}}],[{key:\"type\",get:function(){return\"fuzzy\"}},{key:\"multiRegex\",get:function(){return/^\"(.*)\"$/}},{key:\"singleRegex\",get:function(){return/^(.*)$/}}]),i}(N),U=function(e){a(i,e);var n=f(i);function i(e){return t(this,i),n.call(this,e)}return r(i,[{key:\"search\",value:function(e){for(var t,n=0,r=[],i=this.pattern.length;(t=e.indexOf(this.pattern,n))>-1;)n=t+i,r.push([t,n-1]);var o=!!r.length;return{isMatch:o,score:o?1:0,indices:r}}}],[{key:\"type\",get:function(){return\"include\"}},{key:\"multiRegex\",get:function(){return/^'\"(.*)\"$/}},{key:\"singleRegex\",get:function(){return/^'(.*)$/}}]),i}(N),B=[z,U,q,W,T,J,K,V],G=B.length,H=/ +(?=([^\\\"]*\\\"[^\\\"]*\\\")*[^\\\"]*$)/;function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.split(\"|\").map((function(e){for(var n=e.trim().split(H).filter((function(e){return e&&!!e.trim()})),r=[],i=0,o=n.length;i<o;i+=1){for(var c=n[i],a=!1,s=-1;!a&&++s<G;){var u=B[s],h=u.isMultiMatch(c);h&&(r.push(new u(h,t)),a=!0)}if(!a)for(s=-1;++s<G;){var f=B[s],l=f.isSingleMatch(c);if(l){r.push(new f(l,t));break}}}return r}))}var X=new Set([V.type,U.type]),Y=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.isCaseSensitive,o=void 0===i?L.isCaseSensitive:i,c=r.includeMatches,a=void 0===c?L.includeMatches:c,s=r.minMatchCharLength,u=void 0===s?L.minMatchCharLength:s,h=r.findAllMatches,f=void 0===h?L.findAllMatches:h,l=r.location,d=void 0===l?L.location:l,v=r.threshold,g=void 0===v?L.threshold:v,y=r.distance,p=void 0===y?L.distance:y;t(this,e),this.query=null,this.options={isCaseSensitive:o,includeMatches:a,minMatchCharLength:u,findAllMatches:f,location:d,threshold:g,distance:p},this.pattern=o?n:n.toLowerCase(),this.query=Q(this.pattern,this.options)}return r(e,[{key:\"searchIn\",value:function(e){var t=this.query;if(!t)return{isMatch:!1,score:1};var n=this.options,r=n.includeMatches;e=n.isCaseSensitive?e:e.toLowerCase();for(var i=0,o=[],c=0,a=0,s=t.length;a<s;a+=1){var u=t[a];o.length=0,i=0;for(var h=0,f=u.length;h<f;h+=1){var d=u[h],v=d.search(e),g=v.isMatch,y=v.indices,p=v.score;if(!g){c=0,i=0,o.length=0;break}if(i+=1,c+=p,r){var m=d.constructor.type;X.has(m)?o=[].concat(l(o),l(y)):o.push(y)}}if(i){var k={isMatch:!0,score:c/i};return r&&(k.indices=o),k}}return{isMatch:!1,score:1}}}],[{key:\"condition\",value:function(e,t){return t.useExtendedSearch}}]),e}(),Z=[];function ee(e,t){for(var n=0,r=Z.length;n<r;n+=1){var i=Z[n];if(i.condition(e,t))return new i(e,t)}return new P(e,t)}var te=\"$and\",ne=\"$or\",re=\"$path\",ie=\"$val\",oe=function(e){return!(!e[te]&&!e[ne])},ce=function(e){return!!e[re]},ae=function(t){return!v(t)&&\"object\"===e(t)&&!oe(t)},se=function(e){return i({},te,Object.keys(e).map((function(t){return i({},t,e[t])})))},ue=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;t(this,e),this.options=c({},L,{},r),this.options.useExtendedSearch,this._keyStore=new b(this.options.keys),this.setCollection(n,i)}return r(e,[{key:\"setCollection\",value:function(e,t){if(this._docs=e,t&&!(t instanceof I))throw new Error(\"Incorrect 'index' type\");this._myIndex=t||C(this.options.keys,this._docs,{getFn:this.options.getFn})}},{key:\"add\",value:function(e){p(e)&&(this._docs.push(e),this._myIndex.add(e))}},{key:\"remove\",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!1},t=[],n=0,r=this._docs.length;n<r;n+=1){var i=this._docs[n];e(i,n)&&(this.removeAt(n),n-=1,t.push(i))}return t}},{key:\"removeAt\",value:function(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}},{key:\"getIndex\",value:function(){return this._myIndex}},{key:\"search\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.limit,r=void 0===n?-1:n,i=this.options,o=i.includeMatches,c=i.includeScore,a=i.shouldSort,s=i.sortFn,u=i.ignoreFieldNorm,h=g(e)?g(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return he(h,{ignoreFieldNorm:u}),a&&h.sort(s),y(r)&&r>-1&&(h=h.slice(0,r)),fe(h,this._docs,{includeMatches:o,includeScore:c})}},{key:\"_searchStringList\",value:function(e){var t=ee(e,this.options),n=this._myIndex.records,r=[];return n.forEach((function(e){var n=e.v,i=e.i,o=e.n;if(p(n)){var c=t.searchIn(n),a=c.isMatch,s=c.score,u=c.indices;a&&r.push({item:n,idx:i,matches:[{score:s,value:n,norm:o,indices:u}]})}})),r}},{key:\"_searchLogical\",value:function(e){var t=this,n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.auto,i=void 0===r||r,o=function e(n){var r=Object.keys(n),o=ce(n);if(!o&&r.length>1&&!oe(n))return e(se(n));if(ae(n)){var c=o?n[re]:r[0],a=o?n[ie]:n[c];if(!g(a))throw new Error(k(c));var s={keyId:w(c),pattern:a};return i&&(s.searcher=ee(a,t)),s}var u={children:[],operator:r[0]};return r.forEach((function(t){var r=n[t];v(r)&&r.forEach((function(t){u.children.push(e(t))}))})),u};return oe(e)||(e=se(e)),o(e)}(e,this.options),r=this._myIndex.records,i={},o=[];return r.forEach((function(e){var r=e.$,c=e.i;if(p(r)){var a=function e(n,r,i){if(!n.children){var o=n.keyId,c=n.searcher,a=t._findMatches({key:t._keyStore.get(o),value:t._myIndex.getValueForItemAtKeyId(r,o),searcher:c});return a&&a.length?[{idx:i,item:r,matches:a}]:[]}switch(n.operator){case te:for(var s=[],u=0,h=n.children.length;u<h;u+=1){var f=e(n.children[u],r,i);if(!f.length)return[];s.push.apply(s,l(f))}return s;case ne:for(var d=[],v=0,g=n.children.length;v<g;v+=1){var y=e(n.children[v],r,i);if(y.length){d.push.apply(d,l(y));break}}return d}}(n,r,c);a.length&&(i[c]||(i[c]={idx:c,item:r,matches:[]},o.push(i[c])),a.forEach((function(e){var t,n=e.matches;(t=i[c].matches).push.apply(t,l(n))})))}})),o}},{key:\"_searchObjectList\",value:function(e){var t=this,n=ee(e,this.options),r=this._myIndex,i=r.keys,o=r.records,c=[];return o.forEach((function(e){var r=e.$,o=e.i;if(p(r)){var a=[];i.forEach((function(e,i){a.push.apply(a,l(t._findMatches({key:e,value:r[i],searcher:n})))})),a.length&&c.push({idx:o,item:r,matches:a})}})),c}},{key:\"_findMatches\",value:function(e){var t=e.key,n=e.value,r=e.searcher;if(!p(n))return[];var i=[];if(v(n))n.forEach((function(e){var n=e.v,o=e.i,c=e.n;if(p(n)){var a=r.searchIn(n),s=a.isMatch,u=a.score,h=a.indices;s&&i.push({score:u,key:t,value:n,idx:o,norm:c,indices:h})}}));else{var o=n.v,c=n.n,a=r.searchIn(o),s=a.isMatch,u=a.score,h=a.indices;s&&i.push({score:u,key:t,value:o,norm:c,indices:h})}return i}}]),e}();function he(e,t){var n=t.ignoreFieldNorm,r=void 0===n?L.ignoreFieldNorm:n;e.forEach((function(e){var t=1;e.matches.forEach((function(e){var n=e.key,i=e.norm,o=e.score,c=n?n.weight:null;t*=Math.pow(0===o&&c?Number.EPSILON:o,(c||1)*(r?1:i))})),e.score=t}))}function fe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.includeMatches,i=void 0===r?L.includeMatches:r,o=n.includeScore,c=void 0===o?L.includeScore:o,a=[];return i&&a.push(j),c&&a.push(E),e.map((function(e){var n=e.idx,r={item:t[n],refIndex:n};return a.length&&a.forEach((function(t){t(e,r)})),r}))}return ue.version=\"6.4.0\",ue.createIndex=C,ue.parseIndex=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.getFn,r=void 0===n?L.getFn:n,i=e.keys,o=e.records,c=new I({getFn:r});return c.setKeys(i),c.setIndexRecords(o),c},ue.config=L,function(){Z.push.apply(Z,arguments)}(Y),ue},\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=e||self).Fuse=t();","title":"$:/plugins/TheDiveO/TwFusejs/libs/fuse.js","type":"application/javascript","module-type":"library","created":"20180802114846490","creator":"TheDiveO","modified":"20180802114846490"},"$:/plugins/TheDiveO/TwFusejs/filters/fuse.js":{"title":"$:/plugins/TheDiveO/TwFusejs/filters/fuse.js","text":"/*\\\ncreated: 20180809165919537\ntitle: $:/plugins/TheDiveO/TwFusejs/filters/fuse.js\ntype: application/javascript\nmodified: 20180809170012994\ntags:\nmodule-type: filteroperator\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\"use strict\";\n\n// Plugin-relative path to default Fuse.js options JSON data tiddler.\nvar FUSE_OPTS_DEFAULT = \"/options/default\";\n\n// Locate the plugin title, so we can later easily access our plugin tiddlers\n// without having to repeat the plugin title root/stem over and over again.\n// Thanks to the CommonJS definitions, we have access to this tiddlers title\n// as the module id(entifier).\nvar PLUGIN = module.id.split(\"/\").slice(0, 4).join(\"/\");\n\nvar Fuse = require(\"../libs/fuse.js\");\nvar Deep = require(\"../libs/deep.js\");\n\n/* The \"fuse\" filter operator, powered by Fuse.js.\n *\n * Usage examples:\n *\n * [fuse[foobar]] searches all tiddlers (including shadows, et cetera!) for\n *    \"foobar\" or something similar, returning a list of matching tiddler\n *    titles.\n * [!is[current]!is[system]fuse[foobar]] searches only normal tiddlers.\n * [fuse:myfuseopts[foobar]] uses the fuse search options stored in the\n *   JSON data tiddler \"myfuseopts\" and searches for \"foobar\" or similar.\n *\n * The parameters to this operator function are as follows:\n *\n * source: a tiddler iterator that represents the results of the previous\n *    filter step. This is the set of tiddlers our fuse search operator will\n *    have to search through.\n * operator: the arguments to the fuse filter operator...\n *    .operator: name of the filter operator: always \"fuse\", so AWFUL.\n *    .operand: the operand as a string: what to search for; text references\n *       and variable names have already been resolved at this point into the\n *       string to be searched for.\n *    .prefix: an optional \"!\" if the filter is to be negated; when the prefix\n *       is empty, then options.matchAllTokens=True is assumed; if the prefix\n *       is \"!\", then options.matchAllTokens=False.\n *    .suffix: an optional string containing an additional filter argument:\n *       the name of a (TiddlyWiki) variable either directly specifying the\n *       Fuse.js options in form of a JSON string, or instead referencing a\n *       JSON data tiddler by title which then contains the Fuse.js options.\n *       If left empty/unspecified, then the default TwFusejs plugin options\n *       will be taken instead, stored in ./options/default inside this plugin.\n * options:\n *    .wiki: wiki object reference.\n *    .widget: an optional widget node object reference.\n *\n * It's allowed to return either an array of titles or a tiddler iterator,\n * depending on your needs: however, for the fuse operator, we always return\n * an array of title (strings).\n */\nexports.fuse = function(source, operator, options) {\n\t//console.log(\"searching for:\", \"'\"+operator.operand+\"'\");\n\n\t// As we want Fuse.js to search an array of tiddlers and not just\n\t// tiddler titles, we ensure to have all input tiddler objects ready\n\t// for Fuse.js to work on.\n\tvar tiddlers = [];\n\tsource(function(tiddler, title) {\n\t\tif (!!tiddler) {\n\t\t\ttiddlers.push(tiddler);\n\t\t}\n\t});\n\n\t// Prepare the Fuse.js search options: there are basically three different\n\t// sources:\n\t// 1. no suffix given: take the default options.\n\t// 2. suffix given, contains JSON data resulting in an option object.\n\t// 3. suffix given, not JSON, but instead references a JSON data tiddler.\n\tvar fuse_options;\n\tif (!operator.suffix) {\n\t\t// case 1: use the default, Luke!\n\t\t// console.log(\"using default TwFusejs options\");\n\t\tvar optionsTitle = PLUGIN + FUSE_OPTS_DEFAULT;\n\t\ttry {\n\t\t\tfuse_options = JSON.parse(options.wiki.getTiddler(optionsTitle).fields.text);\n\t\t} catch (e) {\n\t\t\t// Return an error message instead of a list of matching tiddlers\n\t\t\t// in case we cannot properly parse the options JSON data tiddler.\n\t\t\tvar msg = \"invalid fuse options JSON tiddler: \\\"\" + optionsTitle + \"\\\"\";\n\t\t\tconsole.log(msg);\n\t\t\treturn [msg];\n\t\t}\n\t} else if (options.widget) {\n\t\t// try case 2: variable contents are JSON.\n\t\t// console.log(\"using variable:\", operator.suffix);\n\t\ttry {\n\t\t\tfuse_options = JSON.parse(options.widget.getVariable(operator.suffix));\n\t\t\t// console.log(\"variable JSON contents:\", options.widget.getVariable(operator.suffix));\n\t\t} catch (e) {\n\t\t\tfuse_options = null;\n\t\t}\n\t\tif (!fuse_options || typeof fuse_options === \"string\") {\n\t\t\t// Erm, case 2 failed, so this should better be case 3: a title of a\n\t\t\t// JSON data tiddler.\n\t\t\tvar optionsTitle = fuse_options ?\n\t\t\t\t\t\tfuse_options : options.widget.getVariable(operator.suffix);\n\t\t\t// console.log(\"using JSON tiddler:\", optionsTitle);\n\t\t\ttry {\n\t\t\t\tfuse_options = JSON.parse(\n\t\t\t\t\toptions.wiki.getTiddler(optionsTitle).fields.text);\n\t\t\t} catch (e) {\n\t\t\t\t\tvar msg = \"malformed JSON data in tiddler \\\"\" + optionsTitle + \"\\\"\";\n\t\t\t\t\tconsole.log(msg);\n\t\t\t\t\treturn [msg];\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// erm: suffix = variable name given, but there is no widget context and\n\t\t// thus no variables...\n\t\tvar msg = \"missing widget context to look up search options variable\";\n\t\tconsole.log(msg);\n\t\treturn [msg];\n\t}\n\n\t// Handle optional \"!\" prefix: when no prefix is given, or the prefix\n\t// is something other than \"!\", then we AND all search tokens; otherwise,\n\t// we OR them.\n\tfuse_options.matchAllTokens = operator.prefix !== \"!\";\n\t// console.log(\"Find all matches:\", fuse_options.matchAllTokens);\n\n\t// Handle options element \"getFn\" especially: Fuse.js expect it to\n\t// contain a function object. If it contains a string instead, then\n\t// we interpret it to be a module export, so we try to locate the\n\t// exported function.\n\tif (fuse_options.getFn && typeof fuse_options.getFn === \"string\") {\n\t\ttry {\n\t\t\t// First try to resolve the given module tiddler title; if that fails,\n\t\t\t// then try again with \".js\" appended to the title.\n\t\t\tvar module;\n\t\t\ttry {\n\t\t\t\tmodule = require(fuse_options.getFn);\n\t\t\t} catch (e) {\n\t\t\t\tif ($tw.utils.strEndsWith(fuse_options.getFn, \".js\")) {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t\tmodule = require(fuse_options.getFn + \".js\");\n\t\t\t}\n\t\t\tfuse_options.getFn = module.getFn;\n\t\t} catch (e) {\n\t\t\tconsole.warn(\"cannot resolve getFn:\", fuse_options.getFn);\n\t\t\tdelete fuse_options.getFn;\n\t\t}\n\t} else {\n\t\tdelete fuse_options.getFn;\n\t}\n\n\t// Nota bene: the \"id\" option is gone as of Fuse.js 5.0.1 (5.0.2?) Yeah,\n\t// great idea to introduce breaking changes within a major version. So\n\t// we're going to emulate it from now on; but still support it in the\n\t// search options configuration tiddlers.\n\tvar idfield = fuse_options.id || \"fields.title\";\n\n\t// Ready to search!\n\tvar search_terms = operator.operand.trim();\n\t// console.log(\"Fuse.js search for:\", \"'\"+search+\"'\");\n\t// console.log(\"Fuse.js options:\", fuse_options);\n\tvar fuse = new Fuse(tiddlers, fuse_options);\n\tvar hits = search_terms ? fuse.search(search_terms) : [];\n\n\t// In case the fuse options cause hit objects instead of simple hit\n\t// strings to be returned, then only return the (hit) item; this should\n\t// be a tiddler title, if the \"id\" option was set to \"fields.title\".\n\tvar result = [];\n\t$tw.utils.each(hits, function(hit) {\n\t\tif (typeof(hit) === \"string\")  {\n\t\t\tresult.push(hit);\n\t\t} else {\n\t\t\t// If we got back an item object, with newer Fuse.js releases we\n\t\t\t// now have to look up the wanted identifying (\"id\") field\n\t\t\t// ourselves.\n\t\t\tresult.push(Deep.deep(hit.item, idfield, [])[0]);\n\t\t}\n\t})\n\treturn result;\n};\n\n})();\n","created":"20180809165919537","type":"application/javascript","modified":"20180809170012994","tags":"","module-type":"filteroperator"},"$:/plugins/TheDiveO/TwFusejs/filters/rendertext.js":{"title":"$:/plugins/TheDiveO/TwFusejs/filters/rendertext.js","text":"/*\\\ncreated: 20180811135806330\ntitle: $:/plugins/TheDiveO/TwFusejs/filters/rendertext.js\ntype: application/javascript\nmodified: 20180811140005330\ntags:\nmodule-type: filteroperator\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\"use strict\";\n\n/* Given a set of titles, renders each title's text content (or another tiddler\n * field) into text.\n *\n * Usage examples:\n *\n * [rendertext[]] renders each title's text field into plain text.\n *\n * [rendertext:F[]] renders each title's field \"F\" into plain text.\n *\n * The parameters to the operator function are as follows:\n *\n * source: a tiddler iterator that represents the results of the previous\n *    filter step.\n * operator: the arguments to this filter operator...\n *    .operator: name of the filter operator.\n *    .operand: the operand as a string; text references and variable names\n *       have already been resolved at this point. This filter ignores the\n *       operand.\n *    .prefix: an optional \"!\" if the filter is to be negated; this gets\n *       ignored by this filter, though.\n *    .suffix: an optional string containing an additional filter argument:\n *       the name of the tiddler field to render as text.\n * options:\n *    .wiki: wiki object reference.\n *    .widget: an optional widget node object reference.\n *\n * It's allowed to return either an array of titles or a tiddler iterator,\n * depending on your needs.\n */\nexports.rendertext = function(source, operator, options) {\n\tvar field = operator.suffix || \"text\";\n\tvar results = [];\n\tsource(function(tiddler, title) {\n\t\tif (!!tiddler) {\n\t\t\t//console.log(\"render tiddler:\", tiddler);\n\t\t\tvar text = options.wiki.renderText(\n\t\t\t\t\"text/plain\",\n\t\t\t\ttiddler.fields.type || \"text/vnd.tiddlywiki\",\n\t\t\ttiddler.fields[field],\n\t\t\t\t{\n\t\t\t\t\tparseAsInline: false,\n\t\t\t\t\tparentWidget: options.widget\n\t\t\t\t});\n\t\t\tresults.push(text);\n\t\t}\n\t});\n\treturn results;\n};\n\n})();\n","created":"20180811135806330","type":"application/javascript","modified":"20180811140005330","tags":"","module-type":"filteroperator"},"$:/plugins/TheDiveO/TwFusejs/filters/stringlimit.js":{"title":"$:/plugins/TheDiveO/TwFusejs/filters/stringlimit.js","text":"/*\\\ncreated: 20180811135806330\ntitle: $:/plugins/TheDiveO/TwFusejs/filters/stringlimit.js\ntype: application/javascript\nmodified: 20180811140005330\ntags:\nmodule-type: filteroperator\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\"use strict\";\n\n/* Given a set of titles, this filter limits each title to a certain maximum length..\n *\n * Usage examples:\n *\n * [stringlimit[]] limits title to the default length of 100 characters; defaults to\n *   adding a trailing ellipsis \"...\" when truncating a title.\n * [stringlimit[20]] truncates titles to max 20 characters.\n * [stringlimit:***[]] sets the ellipsis to \"***\" when truncating titles.\n *\n * The parameters to the operator function are as follows:\n *\n * source: a tiddler iterator that represents the results of the previous\n *    filter step.\n * operator: the arguments to this filter operator...\n *    .operator: name of the filter operator.\n *    .operand: the operand as a string; text references and variable names\n *       have already been resolved at this point.\n *    .prefix: an optional \"!\" if the filter is to be negated.\n *    .suffix: an optional string containing an additional filter argument.\n * options:\n *    .wiki: wiki object reference.\n *    .widget: an optional widget node object reference.\n *\n * It's allowed to return either an array of titles or a tiddler iterator,\n * depending on your needs.\n */\nexports.stringlimit = function(source, operator, options) {\n\tvar ellipsis = operator.suffix || \"...\";\n\tvar maxTitleLen = parseInt(operator.operand) || 100;\n\tvar results = [];\n\tsource(function(tiddler, title) {\n\t\tif (title.length > maxTitleLen) {\n\t\t\ttitle = title.substr(0, maxTitleLen) + ellipsis;\n\t\t}\n\t\tresults.push(title);\n\t});\n\treturn results;\n};\n\n})();\n","created":"20180811135806330","type":"application/javascript","modified":"20180811140005330","tags":"","module-type":"filteroperator"},"$:/plugins/TheDiveO/TwFusejs/getfns/multipath.js":{"title":"$:/plugins/TheDiveO/TwFusejs/getfns/multipath.js","text":"/*\\\ncreated: 20180815181502529\ntitle: $:/plugins/TheDiveO/TwFusejs/getfns/multipath.js\ntype: application/javascript\nmodified: 20180815181519493\ntags:\nmodule-type: library\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\"use strict\";\n\nvar deep = require(\"../libs/deep.js\").deep;\n\n/* Export a Fuse.js getFn function that interprets the key/path not as a single\n * attribute name, but instead as a list of names/keys/paths, separated by \",\".\n * The resulting values are then banged together into one single string, with\n * the values separated by plain spaces \" \".\n */\nexports.getFn = function (item, splitkey) {\n  // Newer major versions of fuse.js now pass the key path as individual\n  // components split at \".\" boundaries. We now reverse this good intention\n  // without real value in order to correctly split into separate keys instead\n  // of key components.\n  var keys = splitkey.join(\".\").split(\",\")\n  var results = [];\n  $tw.utils.each(keys, function(key) {\n    results.push(deep(item, key.trim(), []));\n  });\n  // Fuse.js expects getFn()s to return lists, erm, arrays, instead of\n  // scalars.\n  return [results.join(\" \")];\n};\n\n})();\n","created":"20180815181502529","type":"application/javascript","modified":"20180815181519493","tags":"","module-type":"library"},"$:/plugins/TheDiveO/TwFusejs/getfns/wildcard.js":{"title":"$:/plugins/TheDiveO/TwFusejs/getfns/wildcard.js","text":"/*\\\ncreated: 20180813165310714\ntitle: $:/plugins/TheDiveO/TwFusejs/getfns/wildcard.js\ntype: application/javascript\nmodified: 20180813165403648\ntags:\nmodule-type: library\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\"use strict\";\n\nvar deepValues = function(object, path, result) {\n  if (!path) {\n    // Reached the leaf, at least according to the path specified.\n    result.push(object);\n  } else {\n    var field;\n    var path;\n    var dot = path.indexOf(\".\");\n    if (dot >= 0) {\n      field = path.slice(0, dot);\n      path = path.slice(dot + 1);\n    } else {\n      field = path;\n      path = null;\n    }\n    if (field === \"*\" && !path) {\n      // Wildcard on a path leaf!\n      $tw.utils.each(object, function(value, field) {\n        console.log(\"wildcarded field:\", field);\n    \t\tresult.push(value.toString());\n    \t});\n    } else {\n      var value = object[field];\n      if (value !== undefined && value !== null) {\n        if (!path && (typeof value === \"string\" || typeof value === \"number\")) {\n          // We've reached the leaf, and it is a scalar value (so no objects)...\n          result.push(value.toString());\n        } else if ($tw.utils.isArray(value)) {\n          // We've got an array, so we continue to resolve, but this time the\n          // path remaining on all array elements...\n          for (var idx = 0, len = value.length; idx < len; idx += 1) {\n            deepValues(value[idx], path, result);\n          }\n        } else if (path) {\n          // This is an object, so try to resolve further if there is a path\n          // still left...\n          deepValues(value, path, result);\n        }\n      }\n    }\n  }\n  return result;\n};\n\n/* Export a Fuse.js getFn function that allows to use the \"*\" wildcard referring\n * to all object attributes (on this level). Otherwise, it works like the\n * Fuse.js-builtin deepValue getFn.\n */\nexports.getFn = function (item, splitkey) {\n  var result = deepValues(item, key.join(\".\"), []);\n\treturn result;\n};\n\n})();\n","created":"20180813165310714","type":"application/javascript","modified":"20180813165403648","tags":"","module-type":"library"},"$:/plugins/TheDiveO/TwFusejs/history":{"title":"$:/plugins/TheDiveO/TwFusejs/history","created":"20180809162835518","modified":"20200720190438195","tags":"","type":"text/vnd.tiddlywiki","text":"* ''0.9.3''\n** updates to now major fuse.js version 6.4.0.\n** adds support for [[fuse.js' extended search syntax|https://fusejs.io/examples.html#extended-search]].\n\n* ''0.9.2''\n** updates to fuse.js version 3.6.1.\n** fixes broken `codemirror-fullscreen-editing` plugin references in editions `tiddlywiki.info` files.\n\n* ''0.9.1''\n** require better fuzzy matching by lowering(!) the threshold option.\n** internal code cleanup.\n\n* ''0.9.0'' -- first beta release for more general testing."},"$:/plugins/TheDiveO/TwFusejs/icon":{"title":"$:/plugins/TheDiveO/TwFusejs/icon","comment":"\"artwork\" by TheDiveO","created":"20180810165337479","modified":"20180816174307842","tags":"","type":"text/vnd.tiddlywiki","text":"<svg width=\"22pt\" height=\"22pt\" viewBox=\"0 0 128 128\">\n    <g fill-rule=\"evenodd\">\n    <path\n       style=\"display:inline;overflow:visible;visibility:visible;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:0.85333335;marker:none;enable-background:accumulate\"\n       d=\"M 14.599609 0.23242188 L 2.0996094 7.4667969 L 2.0996094 21.900391 L 14.599609 29.132812 L 27.132812 21.900391 L 27.132812 7.4667969 L 14.599609 0.23242188 z M 11.248047 6.1601562 C 14.454461 6.1601563 17.080078 8.7877256 17.080078 11.994141 C 17.080078 13.245949 16.676851 14.406277 15.998047 15.359375 C 16.186364 15.235686 16.435703 15.24625 16.601562 15.412109 L 22.568359 21.378906 C 22.758375 21.568922 22.758375 21.874437 22.568359 22.064453 L 21.494141 23.138672 C 21.304125 23.328688 20.99861 23.328688 20.808594 23.138672 L 14.841797 17.171875 C 14.700841 17.030919 14.664252 16.826242 14.732422 16.652344 C 13.757464 17.384677 12.553369 17.826172 11.248047 17.826172 C 8.041632 17.826172 5.4160154 15.200555 5.4160156 11.994141 C 5.4160156 8.7877256 8.0416322 6.1601562 11.248047 6.1601562 z M 11.248047 8.6601562 C 9.3927324 8.6601562 7.9160156 10.138826 7.9160156 11.994141 C 7.9160156 13.849455 9.3927324 15.326172 11.248047 15.326172 C 13.103361 15.326172 14.580078 13.849455 14.580078 11.994141 C 14.580078 10.138826 13.103361 8.6601562 11.248047 8.6601562 z \"\n       transform=\"scale(4.3636363)\"\n       id=\"path887\" />\n    </g>\n</svg>"},"$:/plugins/TheDiveO/TwFusejs/libs/deep.js":{"title":"$:/plugins/TheDiveO/TwFusejs/libs/deep.js","text":"/*\\\ncreated: 20180815161626210\ntitle: $:/plugins/TheDiveO/TwFusejs/libs/deep.js\ntype: application/javascript\nmodified: 20180815161710665\ntags:\nmodule-type: library\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\"use strict\";\n\n/* Utility to fetch the value of a named (multi-level) object element/attribute.\n *\n * The parameters are as follows:\n *\n * object: the object from which the values should be taken.\n * path: the element/attribute path, in the form of \"a1\", \"a1.a2\", et cetera.\n * result: result array to push requested values onto.\n * leafhook: optional hook function called on leaves.\n */\nfunction deepValues(object, path, result, leafhook) {\n  if (!path) {\n    // Reached the leaf, at least according to the path specified. So we\n    // can add the \"object\" as the final value.\n    result.push(object);\n  } else {\n    // There is still some path left, bite off the first element from the\n    // remaining path, and work on that...\n    var field;\n    var path;\n    var dot = path.indexOf(\".\");\n    if (dot >= 0) {\n      field = path.slice(0, dot);\n      path = path.slice(dot + 1);\n    } else {\n      field = path;\n      path = null;\n    }\n    // If there is no path left, give an optional leafhook a chance\n    // to get into business; if a leafhook returns true, then we don't\n    // need to care anymore about this field and its value.\n    if (!path && leafhook) {\n      if (leafhook(object, field, result)) {\n        return;\n      }\n    }\n    var value = object[field];\n    if (value !== undefined && value !== null) {\n      if (!path && (typeof value === \"string\" || typeof value === \"number\")) {\n        // We've reached the leaf, and it is a scalar value (so no objects)...\n        result.push(value.toString());\n      } else if ($tw.utils.isArray(value)) {\n        // We've got an array, so we continue to resolve, but this time the\n        // path remaining on all array elements...\n        for (var idx = 0, len = value.length; idx < len; idx += 1) {\n          deepValues(value[idx], path, result);\n        }\n      } else if (path) {\n        // This is an object, so try to resolve further if there is a path\n        // still left...\n        deepValues(value, path, result);\n      } else {\n        $tw.utils.each(value, function(value) {\n          result.push(value.toString());\n        })\n      }\n    }\n  }\n  return result;\n};\n\nexports.deep = deepValues;\n\n})();\n","created":"20180815161626210","type":"application/javascript","modified":"20180815161710665","tags":"","module-type":"library"},"$:/plugins/TheDiveO/TwFusejs/license":{"title":"$:/plugins/TheDiveO/TwFusejs/license","created":"20180809162835520","modified":"20180816174341113","tags":"","type":"text/vnd.tiddlywiki","text":"* The included Fuse.js is licensed as [[Apache 2.0|https://github.com/krisk/Fuse/blob/master/LICENSE]].\n* My contributions (by ~TheDiveO) that aren't part of a standard ~TiddlyWiki 5 distribution itself (as available from the [[TiddlyWiki|http://tiddlywiki.com]] web site) are licensed as:\n** documentation is covered by [[CC BY 3.0|http://creativecommons.org/licenses/by/3.0/]].\n** code (such as ~TiddlyWiki 5 macros, ~JavaScript, et cetera) and CSS definitions are covered by the [[MIT License|http://opensource.org/licenses/mit-license.html]].\n"},"$:/plugins/TheDiveO/TwFusejs/options/default":{"title":"$:/plugins/TheDiveO/TwFusejs/options/default","created":"20180809170111776","modified":"20180818164951057","tags":"","type":"application/json","text":"{\n\t\"tokenize\": true,\n    \"shouldSort\": true,\n\t\"minMatchCharLength\": 3,\n    \"threshold\": 0.35,\n    \"distance\": 1000,\n\t\"keys\": [ \"fields.text,fields.title,fields.tags\" ],\n    \"getFn\": \"$:/plugins/TheDiveO/TwFusejs/getfns/multipath.js\"\n}"},"$:/plugins/TheDiveO/TwFusejs/options/weighted":{"title":"$:/plugins/TheDiveO/TwFusejs/options/weighted","created":"20180815183410797","modified":"20180818165150453","tags":"","type":"application/json","text":"{\n\t\"tokenize\": true,\n    \"shouldSort\": true,\n\t\"minMatchCharLength\": 3,\n    \"threshold\": 0.35,\n    \"distance\": 1000,\n\t\"keys\": [\n    \t{ \"name\": \"fields.title\", \"weight\": 0.1 },\n        { \"name\": \"fields.text\", \"weight\": 0.45 },\n        { \"name\": \"fields.tags\", \"weight\": 0.45 }\n    ]\n}"},"$:/plugins/TheDiveO/TwFusejs/readme":{"title":"$:/plugins/TheDiveO/TwFusejs/readme","created":"20180809162835521","modified":"20180816174232500","tags":"","type":"text/vnd.tiddlywiki","text":"This plugin brings lightweight fuzzy searching to ~TiddlyWiki, powered by [[Fuse.js|http://fusejs.io/]].\n\nYou can immediately use fuzzy searching in every ~TiddlyWiki where you install this plugin, right from the sidebar's search box. Just punch in some term(s) and you'll see an additional \"Fuzzy\" tab with fuzzy search results. Go to [[Default Search Result List|$:/plugins/TheDiveO/TwFusejs/ui/ControlPanel/fusedefaultsearchresultlist]] to make this new \"Fuzzy\" tab your default (fuzzy) search results tab.\n\nOn purpose, this ~TwFusejs plugin is not a one-size-fits-it-all fuzzy search plugin covering all bases. Instead, this is \"just\" a //lightweight// solution on purpose, and thus has some limitations in terms of speed and functionality. On the plus side, this plugin avoids having to calculate and maintain a dedicated search index.\n\nWe hope you will enjoy this plugin in your ~TiddlyWiki projects nevertheless.\n\n* Fuzzy search-related settings:\n** [[Fuzzy Term Searching|$:/plugins/TheDiveO/TwFusejs/ui/ControlPanel/everyorall]]\n** [[Default Search Result List|$:/plugins/TheDiveO/TwFusejs/ui/ControlPanel/fusedefaultsearchresultlist]]\n* [[TwFusejs GitHub Project|https://github.com/TheDiveO/TwFusejs]]"},"$:/plugins/TheDiveO/TwFusejs/styles/fusesearch.css":{"title":"$:/plugins/TheDiveO/TwFusejs/styles/fusesearch.css","created":"20180816115946548","modified":"20180816165107351","tags":"$:/tags/Stylesheet","type":"text/css","text":"div.fuse-results-count::after {\n  content: \"...\";\n}\n\ndiv.fuse-results-count + dl.fuse-results {\n  margin-top: 0;\n}\n\ndl.fuse-results dd {\n  font-size: 90%;\n  font-style: italic;\n  line-height: normal;\n}\n\ndl.fuse-results dd + dt {\n  margin-top: 1ex;\n}"},"$:/plugins/TheDiveO/TwFusejs/templates/fusesearch":{"title":"$:/plugins/TheDiveO/TwFusejs/templates/fusesearch","created":"20180811161220722","modified":"20200718131816000","tags":"","type":"text/vnd.tiddlywiki","text":"\\define fusesearch(anyterm)\n<!-- Set the variable \"fuse-search\" with the string to search for -->\n<!-- Optionally set the variable \"fuse-options\" to either a JSON data\n     string with options, or to the title of a JSON data tiddler\n     specifying the search options\n-->\n<$set name=\"fuse-options\" value=<<fuse-options>> emptyValue={{$:/plugins/TheDiveO/TwFusejs/options/default!!text}} >\n  <$set name=\"hits\" filter=\"[!is[current]!is[system]$anyterm$fuse:fuse-options<fuse-search>limit[20]]\">\n    <div class=\"fuse-results-count\">\n      <$count filter=\"[enlist<hits>]\"/> matches for\n      <$list filter=\"[[$anyterm$]prefix[!]]\">any</$list>\n      <$list filter=\"[[$anyterm$]!prefix[!]]\">all</$list>\n      search terms\n    </div>\n    <dl class=\"fuse-results\">\n      <$list variable=\"hit\" filter=\"[enlist<hits>]\">\n        <dt>\n          <!-- render matching titles as tiddler links -->\n          <$link to=<<hit>> ><$view tiddler=<<hit>> field=\"title\"/></$link>\n        </dt>\n        <dd>\n          <!-- render the (beginning) of a matching tiddler as pure text without any markup -->\n          <$list filter=\"[<hit>rendertext[]stringlimit[300]]\">\n            <$view field=\"title\" format=\"plainwikified\"/>\n          </$list>\n        </dd>\n      </$list>\n    </dl>\n  </$set>\n</$set>\n\\end\n<$macrocall $name=\"fusesearch\" anyterm={{$:/config/TwFusejs/allterms!!text}} />\n"},"$:/plugins/TheDiveO/TwFusejs/ui/ControlPanel/everyorall":{"title":"$:/plugins/TheDiveO/TwFusejs/ui/ControlPanel/everyorall","caption":"Fuzzy Term Searching","created":"20180816111158550","modified":"20180816124903959","tags":"$:/tags/ControlPanel/Settings","type":"text/vnd.tiddlywiki","text":"<$set name=\"cfgtiddler\" value=\"$:/config/TwFusejs/allterms\">\n\n<$link to=<<cfgtiddler>> >You can either search for //any// or //all// of your search terms:</$link>\n\n<$select tiddler=<<cfgtiddler>> default=\"\">\n<option value=\"\">All</option>\n<option value=\"!\">Any</option>\n</$select>\n</$set>"},"$:/plugins/TheDiveO/TwFusejs/ui/ControlPanel/fusedefaultsearchresultlist":{"title":"$:/plugins/TheDiveO/TwFusejs/ui/ControlPanel/fusedefaultsearchresultlist","caption":"Default Search Result List","created":"20180816123006775","modified":"20180816125741864","tags":"$:/tags/ControlPanel/Settings","type":"text/vnd.tiddlywiki","text":"Choose the default search result list to be opened automatically:\n\n<$select tiddler=\"$:/config/SearchResults/Default\">\n  <$list filter=\"[all[tiddlers+shadows]tag[$:/tags/SearchResults]]\">\n    <option value=<<currentTiddler>> >{{!!caption}}</option>\n  </$list>\n</$select>"},"$:/plugins/TheDiveO/TwFusejs/ui/ControlPanel/fuseextendedsearch":{"title":"$:/plugins/TheDiveO/TwFusejs/ui/ControlPanel/fuseextendedsearch","caption":"Fuzzy Term Extended Searching Syntax","created":"20200718130202274","modified":"20200718130857944","tags":"$:/tags/ControlPanel/Settings","type":"text/vnd.tiddlywiki","text":"<$set name=\"cfgtiddler\" value=\"$:/config/TwFusejs/extendedsearch\">\n\n<$checkbox tiddler=<<cfgtiddler>> default=\"false\" checked=\"true\" unchecked=\"false\" field=\"text\">\n\t<$link to=<<cfgtiddler>> >Extended search syntax</$link>, see [[fusejs.io extended search examples|https://fusejs.io/examples.html#extended-search]].\n</$checkbox>\n</$set>"},"$:/plugins/TheDiveO/TwFusejs/ui/fusesearchresults":{"title":"$:/plugins/TheDiveO/TwFusejs/ui/fusesearchresults","caption":"Fuzzy","created":"20180816121802012","modified":"20180817090000126","tags":"$:/tags/SearchResults","type":"text/vnd.tiddlywiki","text":"\\define fusesearchresults(anyterm)\n<$set name=\"fuse-options\" value=<<fuse-options>> emptyValue={{$:/plugins/TheDiveO/TwFusejs/options/default!!text}} >\n  <$set name=\"hits\" filter=\"[!is[current]!is[system]$anyterm$fuse:fuse-options{$(searchTiddler)$}limit[20]]\">\n    <small>//<$count filter=\"[enlist<hits>]\"/> matches://</small>\n    <$list variable=\"hit\" filter=\"[enlist<hits>]\">\n      <div class=\"tc-menu-list-item\">\n        <$link to=<<hit>> ><$view tiddler=<<hit>> field=\"title\"/></$link>\n      </div>\n    </$list>\n  </$set>\n</$set>\n\\end\n<$macrocall $name=\"fusesearchresults\" anyterm={{$:/config/TwFusejs/allterms!!text}} />"},"$:/plugins/TheDiveO/TwFusejs/widgets/setjson.js":{"title":"$:/plugins/TheDiveO/TwFusejs/widgets/setjson.js","text":"/*\\\ncreated: 20200718200145986\ntitle: $:/plugins/TheDiveO/TwFusejs/widgets/setjson.js\ntype: application/javascript\nmodified: 20200718200224457\ntags: \nmodule-type: widget\n\\*/\n(function(){\n\n/*jslint node: true, browser: true */\n/*global $tw: false */\n\"use strict\";\n\nvar Widget = require(\"$:/core/modules/widgets/widget.js\").widget;\n\n/* Creates a new <$jsdondata> widget. */\nvar SetJsonWidget = function(parseTreeNode, options) {\n    this.initialise(parseTreeNode, options);\n};\n  \n/* \"Inherits\" from the Widget base \"class\" in order to get all\n * the basic widget functionality.\n */\nSetJsonWidget.prototype = new Widget();\n\n/* Renders this widget into the DOM. */\nSetJsonWidget.prototype.render = function(parent, nextSibling) {\n    this.parentDomNode = parent;\n    this.computeAttributes();\n    this.execute();\n    this.renderChildren(parent, nextSibling);\n};\n\n/* Computes the internal state of this widget. */\nSetJsonWidget.prototype.execute = function() {\n    this.jsonName = this.getAttribute(\"name\")\n    this.jsonData = this.getAttribute(\"json\");\n    this.jsonField = this.getAttribute(\"field\");\n    this.jsonDefault = this.getAttribute(\"default\");\n    this.jsonType = this.getAttribute(\"type\");\n    this.setVariable(this.jsonName, this.getValue(), this.parseTreeNode.params, !!this.parseTreeNode.isMacroDefinition);\n    this.makeChildWidgets();\n};  \n\n/* Calculates the resulting JSON data. */\nSetJsonWidget.prototype.getValue = function() {\n    var jsondata = this.jsonData || \"\";\n    if (!this.jsonField) {\n        return jsondata;\n    }\n    var valuetype = this.jsonType || \"string\";\n    var defaultvalue = this.jsonDefault;\n    var fieldname = this.jsonField;\n    var data;\n    try {\n        data = JSON.parse(jsondata);\n    } catch (e) {\n        return jsondata;\n    }\n    if (!(this.jsonField in data)) {\n        switch (valuetype) {\n            case \"bool\":\n                data[fieldname] = defaultvalue === \"true\" || defaultvalue === \"True\";\n                break;\n            case \"number\":\n                data[fieldname] = Number.parseFloat(defaultvalue);\n                break;\n            case \"string\":\n            default:\n                data[fieldname] = defaultvalue;\n        }\n    }\n    return JSON.stringify(data, null, $tw.config.preferences.jsonSpaces);\n};\n\n/* Selectively refreshes this widget if needed and returns\n * true if either this widget itself or one of its children\n * needs to be re-rendered.\n */\nSetJsonWidget.prototype.refresh = function(changedTiddlers) {\n    var changedAttributes = this.computeAttributes();\n    if (changedAttributes.name || changedAttributes.json || changedAttributes.field\n        || changedAttributes.default || changedAttributes.type) {\n        this.refreshSelf();\n        return true;\n    }\n    return this.refreshChildren(changedTiddlers);\n};\n\n/* Finally exports the widget constructor. */\nexports.setjson = SetJsonWidget;\n\n})();","created":"20200718200145986","type":"application/javascript","modified":"20200718200224457","tags":"","module-type":"widget"}}}