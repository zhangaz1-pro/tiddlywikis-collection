[{"version": "0.1.1", "type": "application/json", "title": "$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced", "plugin-type": "plugin", "parent-plugin": "$:/plugins/tiddlywiki/codemirror", "name": "CodeMirror TW5 Enhanced", "list": "readme ControlPanel", "description": "TiddlyWiki5 highlighting mode for CodeMirror", "dependents": "$:/plugins/tiddlywiki/codemirror-autocomplete", "author": "Gk0Wk", "email": "nmg_wk@yeah.net", "source": "https://github.com/Gk0Wk/TW5-CodeMirror-Enhanced", "text": "{\"tiddlers\": {\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/mode/tiddlywiki5.js\": {\"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/mode/tiddlywiki5.js\", \"module-type\": \"codemirror\", \"type\": \"application/javascript\", \"text\": \"!function(e){\\\"object\\\"==typeof exports&&\\\"object\\\"==typeof module?e(require(\\\"$:/plugins/tiddlywiki/codemirror/lib/codemirror.js\\\")):\\\"function\\\"==typeof define&&define.amd?define([\\\"$:/plugins/tiddlywiki/codemirror/lib/codemirror.js\\\"],e):e(CodeMirror)}(function(z){\\\"use strict\\\";z.defineMode(\\\"tiddlywiki5\\\",function(n,d){var c={rainbow:[\\\"keyword\\\",\\\"variable-2\\\",\\\"variable-3\\\"]},o={changecount:!0,colour:!0,\\\"colour-picker\\\":!0,contrastcolour:!0,\\\"copy-to-clipboard\\\":!0,csvtiddlers:!0,datauri:!0,dumpvariables:!0,\\\"image-picker\\\":!0,jsontiddler:!0,jsontiddlers:!0,lingo:!0,\\\"list-links\\\":!0,\\\"list-links-draggable\\\":!0,\\\"list-tagged-draggable\\\":!0,\\\"list-thumbnails\\\":!0,makedatauri:!0,now:!0,qualify:!0,resolvepath:!0,\\\"box-shadow\\\":!0,filter:!0,transition:!0,\\\"background-linear-gradient\\\":!0,\\\"transform-origin\\\":!0,toc:!0,\\\"toc-expandable\\\":!0,\\\"toc-selective-expandable\\\":!0,\\\"toc-tabbed-internal-nav\\\":!0,\\\"toc-tabbed-external-nav\\\":!0,tabs:!0,tag:!0,\\\"tag-picker\\\":!0,\\\"tag-pill\\\":!0,thumbnail:!0,timeline:!0,tree:!0,unusedtitle:!0,version:!0};function u(e){!z.findModeByName||(t=z.findModeByName(e))&&(e=t.mime||t.mimes[0]);var t=z.getMode(n,e);return\\\"null\\\"==t.name?null:t}d.fencedCodeBlockHighlighting===undefined&&(d.fencedCodeBlockHighlighting=!0),d.fencedCodeBlockDefaultMode===undefined&&(d.fencedCodeBlockDefaultMode=\\\"text/plain\\\");var f=/^\\\\-\\\\-\\\\-+$/,k=/^<<</,s=/^```[ \\\\t]*([\\\\w\\\\/+#-]*)[^\\\\n`]*$/,i=/^```$/;function m(e,t,n){return(t.tokenize=n)(e,t)}function r(e){e.line++,e.listLevel=0,e.boldLine=!1}function b(e,t){var n=e.sol(),o=function(e,t,n){var o=t.peek();if(e&&/[<\\\\/\\\\*{}\\\\-`]/.test(o)){if(t.match(k))return function(e,t){var n=1;for(;e.match(k);)n++;t.quoteLevel==n?t.quoteLevel--:t.quoteLevel<n?(t.quoteHead=!0,t.quoteLevel=n,t.tokenize=function(e,t){return t.quoteHead=!1,t.tokenize=b,e.sol()?null:(e.skipToEnd(),\\\"tag\\\")}):t.quoteLevel=n-1;return\\\"quote line-cm-quote-line\\\"}(t,n);if(t.match(f))return\\\"hr\\\";var i=null;if(i=t.match(s,!1))return function(e,o,i){return o.tokenize=function(e,t){t.tokenize=b;var n=d.fencedCodeBlockHighlighting&&u(i[1]||d.fencedCodeBlockDefaultMode);return t.codeBlockModeState=n?{mode:n,state:z.startState(n),start:o.line}:\\\"unknown\\\",i[1]?(e.skipToEnd(),\\\"tag\\\"):null},e.match(\\\"```\\\"),\\\"comment\\\"}(t,n,i)}i=null;if(e&&(i=t.match(/^\\\\s*([\\\\/\\\\*!#;:>|])/))){if(\\\"!\\\"===(o=i[1])){for(var r=1;t.eat(\\\"!\\\");)r++;return t.skipToEnd(),\\\"header h\\\"+r}if(/[\\\\*#;:]/.test(o)){for(var a=1,l=o;o=t.eat(/[\\\\*#;:]/);)a++,l=o;return n.boldLine=\\\";\\\"===l,n.listLevel=a,\\\"list \\\"+c.rainbow[a%c.rainbow.length]+(\\\";\\\"===l?\\\" strong\\\":\\\"\\\")}if(\\\">\\\"===o)return t.eatWhile(\\\">\\\"),\\\"quote\\\";if(\\\"|\\\"===o)return\\\"header\\\"}if(t.next(),/[hf]/i.test(o)&&/[ti]/i.test(t.peek())&&t.match(/\\\\b(ttps?|tp|ile):\\\\/\\\\/[\\\\-A-Z0-9+&@#\\\\/%?=~_|$!:,.;]*[A-Z0-9+&@#\\\\/%=~_|$]/i,!0))return\\\"externallink link\\\";if(\\\"$\\\"==o&&t.match(\\\"$\\\",!1)&&!t.match(\\\"$$\\\",!1))return t.next(),function(e){e.tokenize=b;var t=d.fencedCodeBlockHighlighting&&u(\\\"text/x-latex\\\");return e.LaTeXModeState=t?{mode:t,state:z.startState(t),start:e.line}:\\\"unknown\\\",\\\"comment\\\"}(n);if(\\\"`\\\"==o)return m(t,n,M);if(\\\"/\\\"==o&&t.eat(\\\"/\\\"))return m(t,n,v);if(\\\"{\\\"==o&&t.eat(\\\"{\\\"))return m(t,n,S);if(\\\"[\\\"==o&&t.eat(\\\"[\\\"))return m(t,n,g);if(\\\"_\\\"==o&&t.eat(\\\"_\\\"))return m(t,n,h);if(\\\"^\\\"==o&&t.eat(\\\"^\\\"))return m(t,n,B);if(\\\",\\\"==o&&t.eat(\\\",\\\"))return m(t,n,L);if(\\\"~\\\"==o&&t.eat(\\\"~\\\"))return m(t,n,x);return\\\"'\\\"==o&&t.eat(\\\"'\\\")?m(t,n,p):\\\"<\\\"==o&&t.eat(\\\"<\\\")?m(t,n,y):null}(n,e,t);return null==o&&(o=\\\"\\\"),0<t.quoteLevel&&n&&(o+=\\\" line-cm-quote-line quote-\\\"+t.quoteLevel),null!=t.codeBlockModeState&&(o+=\\\" comment\\\"),0<t.listLevel&&(o+=\\\" list \\\"+c.rainbow[t.listLevel%c.rainbow.length]),t.boldLine&&(o+=\\\" strong\\\"),o.trim()}function p(e,t){for(var n,o=!1;n=e.next();){if(\\\"'\\\"==n&&o){t.tokenize=b;break}o=\\\"'\\\"==n}return\\\"strong\\\"}function M(e,t){for(var n;n=e.next();)if(\\\"`\\\"==n){t.tokenize=b;break}return\\\"comment\\\"}function v(e,t){for(var n,o=!1;n=e.next();){if(\\\"/\\\"==n&&o){t.tokenize=b;break}o=\\\"/\\\"==n}return\\\"em\\\"}function S(e,t){return t.tokenize=function(e,t){for(var n;n=e.next();)if(\\\"}\\\"===n&&\\\"}\\\"===e.peek()){e.backUp(1),t.tokenize=function(e,t){return e.match(\\\"}}\\\"),t.tokenize=b,\\\"builtin\\\"};break}return\\\"builtin internallink\\\"},\\\"builtin\\\"}function g(e,t){if(\\\"[[\\\"==e.current())return t.pastDivider=!1,\\\"link\\\";if(\\\"]\\\"==e.peek()&&(e.next(),\\\"]\\\"==e.next()))return t.tokenize=b,\\\"link\\\";for(var n,o=t.pastDivider;n=e.peek();){if(!o&&\\\"|\\\"==n)return e.next(),t.pastDivider=!0,\\\"internallink link\\\";if(\\\"]\\\"==n&&\\\"]\\\"==e.peek())return\\\"internallink link\\\";if(n=e.next(),/[hf]/i.test(n)&&/[ti]/i.test(e.peek())&&e.match(/\\\\b(ttps?|tp|ile):\\\\/\\\\/[\\\\-A-Z0-9+&@#\\\\/%?=~_|$!:,.;]*[A-Z0-9+&@#\\\\/%=~_|$]/i,!0))return\\\"externallink link\\\";e.eatWhile(/[^|\\\\]]/)}return null}function h(e,t){for(var n,o=!1;n=e.next();){if(\\\"_\\\"==n&&o){t.tokenize=b;break}o=\\\"_\\\"==n}return\\\"underlined\\\"}function L(e,t){for(var n,o=!1;n=e.next();){if(\\\",\\\"==n&&o){t.tokenize=b;break}o=\\\",\\\"==n}return\\\"string subscript\\\"}function B(e,t){for(var n,o=!1;n=e.next();){if(\\\"^\\\"==n&&o){t.tokenize=b;break}o=\\\"^\\\"==n}return\\\"string superscript\\\"}function x(e,t){for(var n,o=!1;n=e.next();){if(\\\"~\\\"==n&&o){t.tokenize=b;break}o=\\\"~\\\"==n}return\\\"strikethrough\\\"}function y(e,t){if(\\\"<<\\\"==e.current())return\\\"macro\\\";var n=e.next();return n?\\\">\\\"==n&&\\\">\\\"==e.peek()?(e.next(),t.tokenize=b,\\\"macro\\\"):(e.eatWhile(/[\\\\w\\\\$_]/),o.propertyIsEnumerable(e.current())?\\\"keyword\\\":\\\"macro\\\"):(t.tokenize=b,null)}var t={blankLine:function(e){return r(e),\\\"\\\"},closeBrackets:\\\"()[]{}''\\\\\\\"\\\\\\\"``\\\",startState:function(){return{tokenize:b,curStream:null,line:0,quoteLevel:0,quoteHead:!1,listLevel:0,boldLine:!1,codeBlockModeState:null,LaTeXModeState:null}},copyState:function(e){var t,n={};for(t in e)n[t]=e[t];e.codeBlockModeState&&\\\"object\\\"==typeof e.codeBlockModeState&&(n.codeBlockModeState={mode:e.codeBlockModeState.mode,state:z.copyState(e.codeBlockModeState.mode,e.codeBlockModeState.state),start:e.start}),e.LaTeXModeState&&(n.LaTeXModeState={mode:e.LaTeXModeState.mode,state:z.copyState(e.LaTeXModeState.mode,e.LaTeXModeState.state),start:e.start})},token:function(e,t){return e!=t.curStream&&(r(t),t.curStream=e),null!=t.codeBlockModeState?e.match(i)?(t.codeBlockModeState=null,\\\"comment\\\"):\\\"string\\\"==typeof t.codeBlockModeState?(e.skipToEnd(),\\\"comment line-background-cm-code-block-line\\\"):t.codeBlockModeState.mode.token(e,t.codeBlockModeState.state)+\\\" line-background-cm-code-block-line\\\":null!=t.LaTeXModeState?e.match(\\\"$$\\\")?(t.LaTeXModeState=null,\\\"comment\\\"):\\\"string\\\"==typeof t.LaTeXModeState?(e.skipToEnd(),\\\"comment latex\\\"):t.LaTeXModeState.mode.token(e,t.LaTeXModeState.state)+\\\" latex\\\":e.match(/^\\\\s+$/,!0)||e.match(/\\\\s+$/,!0)?null:t.tokenize(e,t)},innerMode:function(e){return null!=e.codeBlockModeState&&\\\"object\\\"==typeof e.codeBlockModeState?e.codeBlockModeState:null!=e.LaTeXModeState&&\\\"object\\\"==typeof e.LaTeXModeState?e.LaTeXModeState:{state:e,mode:t}},indent:function(e,t,n){return null!=e.codeBlockModeState&&\\\"object\\\"==typeof e.codeBlockModeState&&\\\"function\\\"==typeof e.codeBlockModeState.mode.indent?e.codeBlockModeState.mode.indent(e.codeBlockModeState.state,t,n):z.Pass}};return t}),z.defineMIME(\\\"text/vnd.tiddlywiki\\\",\\\"tiddlywiki5\\\"),z.defineMIME(\\\"\\\",\\\"tiddlywiki5\\\")});\"}, \"$:/plugins/Gk0Wk/codemirror-tiddlywiki5/style.css\": {\"type\": \"text/css\", \"title\": \"$:/plugins/Gk0Wk/codemirror-tiddlywiki5/style.css\", \"tags\": \"$:/tags/Stylesheet\", \"text\": \".CodeMirror-hints{z-index:800!important}.CodeMirror-hint{width:400px!important}li.cm-hacked-hint{display:flex;justify-content:space-between;white-space:nowrap}li.cm-hacked-hint>span:first-of-type{overflow:hidden;text-overflow:ellipsis}li.cm-hacked-hint>span:last-of-type{padding-left:10px;font-weight:700;opacity:.5}.CodeMirror-hints-append{max-height:20em!important;width:300px!important;color:#000;resize:both}span.cm-underlined{text-decoration-line:underline}span.cm-superscript{vertical-align:super;font-size:.7em;line-height:.1em}span.cm-subscript{font-size:.7em;line-height:.5}pre.cm-quote-line{padding-left:.4em!important;border-left:#444 solid .2em!important}.cm-code-block-line,.latex{background:rgba(0,0,0,.2)}span.cm-h1{font-weight:700;font-size:1.383em;line-height:1.802em}span.cm-h2{font-weight:600;font-size:1.296em;line-height:1.602em}span.cm-h3{font-weight:500;font-size:1.215em;line-height:1.424em}span.cm-h4{font-weight:400;font-size:1.138em;line-height:1.266em}span.cm-h5{font-weight:400;font-size:1.067em;line-height:1.125em}span.cm-h6{font-weight:400}span.cm-link{cursor:pointer}span.cm-externallink,span.cm-internallink{cursor:pointer;font-weight:800}span.cm-internallink{text-decoration:none}\"}, \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/mode/tex.js\": {\"type\": \"application/javascript\", \"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/mode/tex.js\", \"module-type\": \"codemirror\", \"text\": \"!function(t){\\\"object\\\"==typeof exports&&\\\"object\\\"==typeof module?t(require(\\\"$:/plugins/tiddlywiki/codemirror/lib/codemirror.js\\\")):\\\"function\\\"==typeof define&&define.amd?define([\\\"$:/plugins/tiddlywiki/codemirror/lib/codemirror.js\\\"],t):t(CodeMirror)}(function(t){\\\"use strict\\\";t.defineMode(\\\"tex\\\",function(t,e){function i(t,e){t.cmdState.push(e)}function a(t){return 0<t.cmdState.length?t.cmdState[t.cmdState.length-1]:null}function n(t,e,n){return function(){this.name=t,this.bracketNo=0,this.style=e,this.styles=n,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,\\\"bracket\\\"},this.closeBracket=function(){}}}var c={};function o(t,e){t.f=e}function u(t,e){if(t.match(/^\\\\\\\\[a-zA-Z@]+/)){var n,r=t.current().slice(1);return i(e,n=new(n=c.hasOwnProperty(r)?c[r]:c.DEFAULT)),o(e,m),n.style}if(t.match(/^\\\\\\\\[$&%#{}_]/))return\\\"tag\\\";if(t.match(/^\\\\\\\\[,;!\\\\/\\\\\\\\]/))return\\\"tag\\\";if(t.match(\\\"\\\\\\\\[\\\"))return o(e,function(t,e){return f(t,e,\\\"\\\\\\\\]\\\")}),\\\"keyword\\\";if(t.match(\\\"\\\\\\\\(\\\"))return o(e,function(t,e){return f(t,e,\\\"\\\\\\\\)\\\")}),\\\"keyword\\\";if(t.match(\\\"$$\\\"))return o(e,function(t,e){return f(t,e,\\\"$$\\\")}),\\\"keyword\\\";if(t.match(\\\"$\\\"))return o(e,function(t,e){return f(t,e,\\\"$\\\")}),\\\"keyword\\\";r=t.next();return\\\"%\\\"==r?(t.skipToEnd(),\\\"comment\\\"):\\\"}\\\"==r||\\\"]\\\"==r?(n=a(e))?(n.closeBracket(r),o(e,m),\\\"bracket\\\"):\\\"error\\\":\\\"{\\\"==r||\\\"[\\\"==r?(i(e,n=new(n=c.DEFAULT)),\\\"bracket\\\"):/\\\\d/.test(r)?(t.eatWhile(/[\\\\w.%]/),\\\"atom\\\"):(t.eatWhile(/[\\\\w\\\\-_]/),\\\"begin\\\"==(n=function(t){for(var e=t.cmdState,n=e.length-1;0<=n;n--){var r=e[n];if(\\\"DEFAULT\\\"!=r.name)return r}return{styleIdentifier:function(){return null}}}(e)).name&&(n.argument=t.current()),n.styleIdentifier())}function f(t,e,n){if(t.eatSpace())return null;if(n&&t.match(n))return o(e,u),\\\"keyword\\\";if(t.match(/^\\\\\\\\[a-zA-Z@]+/))return\\\"tag\\\";if(t.match(/^[a-zA-Z]+/))return\\\"variable-2\\\";if(t.match(/^\\\\\\\\[$&%#{}_]/))return\\\"tag\\\";if(t.match(/^\\\\\\\\[,;!\\\\/]/))return\\\"tag\\\";if(t.match(/^[\\\\^_&]/))return\\\"tag\\\";if(t.match(/^[+\\\\-<>|=,\\\\/@!*:;'\\\"`~#?]/))return null;if(t.match(/^(\\\\d+\\\\.\\\\d*|\\\\d*\\\\.\\\\d+|\\\\d+)/))return\\\"number\\\";var r=t.next();return\\\"{\\\"==r||\\\"}\\\"==r||\\\"[\\\"==r||\\\"]\\\"==r||\\\"(\\\"==r||\\\")\\\"==r?\\\"bracket\\\":\\\"%\\\"==r?(t.skipToEnd(),\\\"comment\\\"):\\\"error\\\"}function m(t,e){var n=t.peek();return\\\"{\\\"==n||\\\"[\\\"==n?(a(e).openBracket(n),t.eat(n),o(e,u),\\\"bracket\\\"):/[ \\\\t\\\\r]/.test(n)?(t.eat(n),null):(o(e,u),(n=e.cmdState.pop())&&n.closeBracket(),u(t,e))}return c.importmodule=n(\\\"importmodule\\\",\\\"tag\\\",[\\\"string\\\",\\\"builtin\\\"]),c.documentclass=n(\\\"documentclass\\\",\\\"tag\\\",[\\\"\\\",\\\"atom\\\"]),c.usepackage=n(\\\"usepackage\\\",\\\"tag\\\",[\\\"atom\\\"]),c.begin=n(\\\"begin\\\",\\\"tag\\\",[\\\"atom\\\"]),c.end=n(\\\"end\\\",\\\"tag\\\",[\\\"atom\\\"]),c.label=n(\\\"label\\\",\\\"tag\\\",[\\\"atom\\\"]),c.ref=n(\\\"ref\\\",\\\"tag\\\",[\\\"atom\\\"]),c.eqref=n(\\\"eqref\\\",\\\"tag\\\",[\\\"atom\\\"]),c.cite=n(\\\"cite\\\",\\\"tag\\\",[\\\"atom\\\"]),c.bibitem=n(\\\"bibitem\\\",\\\"tag\\\",[\\\"atom\\\"]),c.Bibitem=n(\\\"Bibitem\\\",\\\"tag\\\",[\\\"atom\\\"]),c.RBibitem=n(\\\"RBibitem\\\",\\\"tag\\\",[\\\"atom\\\"]),c.DEFAULT=function(){this.name=\\\"DEFAULT\\\",this.style=\\\"tag\\\",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{startState:function(){return{cmdState:[],f:e.inMathMode?function(t,e){return f(t,e)}:u}},copyState:function(t){return{cmdState:t.cmdState.slice(),f:t.f}},token:function(t,e){return e.f(t,e)},blankLine:function(t){t.f=u,t.cmdState.length=0},lineComment:\\\"%\\\"}}),t.defineMIME(\\\"text/x-stex\\\",\\\"tex\\\"),t.defineMIME(\\\"text/x-latex\\\",\\\"tex\\\")});\"}, \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/readme\": {\"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/readme\", \"text\": \"View more on [[GitHub Repo|https://github.com/Gk0Wk/TW5-CodeMirror-Enhanced]].\\n\\nCodeMirror editor for TiddlyWiki provides a flexible and rich extension framework (including highlighting, completion, preview and other features), anyone can use this framework to write extension plug-ins for the editor! Currently based on this framework to achieve the following features.\\n\\n* TiddlyWiki5 (`text/vnd.tiddlywiki`) syntax highlighting.\\n* Wiki link auto-tip; * Tiddler preview; * TiddlyWiki5 (`text/vnd.tiddlywiki`)\\n* Tiddler preview; * Tiddler preview.\\n* Clickable links.\\n\\nMore features are in development, welcome to join!\\n\\n---\\n\\n\\u4e3aTiddlyWiki\\u7684CodeMirror\\u7f16\\u8f91\\u5668\\u63d0\\u4f9b\\u4e00\\u4e2a\\u7075\\u6d3b\\u800c\\u4e30\\u5bcc\\u7684\\u6269\\u5c55\\u6846\\u67b6(\\u5305\\u62ec\\u9ad8\\u4eae\\u3001\\u8865\\u5168\\u3001\\u9884\\u89c8\\u7b49\\u529f\\u80fd)\\uff0c\\u4efb\\u4f55\\u4eba\\u90fd\\u53ef\\u4ee5\\u4f7f\\u7528\\u6b64\\u6846\\u67b6\\u4e3a\\u7f16\\u8f91\\u5668\\u7f16\\u5199\\u6269\\u5c55\\u63d2\\u4ef6\\uff01\\u76ee\\u524d\\u57fa\\u4e8e\\u6b64\\u6846\\u67b6\\u5b9e\\u73b0\\u7684\\u529f\\u80fd\\u6709\\uff1a\\n\\n* TiddlyWiki5(`text/vnd.tiddlywiki`)\\u8bed\\u6cd5\\u9ad8\\u4eae\\uff1b\\n* Wiki\\u94fe\\u63a5\\u81ea\\u52a8\\u63d0\\u793a\\uff1b\\n* Tiddler\\u9884\\u89c8\\uff1b\\n* \\u53ef\\u70b9\\u51fb\\u94fe\\u63a5\\uff1b\\n\\n\\u66f4\\u591a\\u529f\\u80fd\\u6b63\\u5728\\u5f00\\u53d1\\u4e2d\\uff0c\\u6b22\\u8fce\\u4f60\\u7684\\u52a0\\u5165\\uff01\\n\"}, \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/core.js\": {\"type\": \"application/javascript\", \"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/core.js\", \"module-type\": \"codemirror\", \"text\": \"!function(e){\\\"function\\\"==typeof define&&define.amd?define(e):e()}(function(){\\\"use strict\\\";var n=function(e){this.name=e.name,this.tag=e.tag||null,this.onLoad=e.onLoad,this.onHook=e.onHook,this.addons={},this.isLoad=!1},r={};function e(e){r[e.name]=new n(e)}function i(e){return r[e].addons}function t(e,n){var t=$tw.wiki.getTiddlerText(e);return t?\\\"true\\\"===t.toLowerCase():n}var a=(Object.defineProperty(o,\\\"clickableService\\\",{get:function(){return t(\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/clickable-link\\\",!1)},enumerable:!1,configurable:!0}),Object.defineProperty(o,\\\"realtimeHint\\\",{get:function(){return t(\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/realtime-hint\\\",!1)},enumerable:!1,configurable:!0}),Object.defineProperty(o,\\\"hintPreview\\\",{get:function(){return t(\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/hint-preview\\\",!1)},enumerable:!1,configurable:!0}),o);function o(){}var c=/macintosh|mac os x/i.test(navigator.userAgent)?\\\"metaKey\\\":\\\"ctrlKey\\\";var s=function(e,n){this.list=e,this.from=n};function u(e,n,t){var r=e.ownerDocument,o=e.appendChild(r.createElement(\\\"span\\\"));t.render_?t.render_(o,n,t):o.appendChild(r.createTextNode(t.displayText||t.text||\\\"\\\"));o=t.type||null;o&&e.appendChild(r.createElement(\\\"span\\\")).appendChild(r.createTextNode(o))}var d,f=require(\\\"$:/plugins/tiddlywiki/codemirror/lib/codemirror.js\\\");(d=f).defineInitHook(function(t){$tw.utils.each(r,function(t,e){var r;t.tag&&(r=$tw.wiki.filterTiddlers(\\\"[all[tiddlers+shadows]tag[\\\"+t.tag+\\\"]type[application/javascript]]\\\"),$tw.utils.each(r,function(e){e in t.addons||(t.addons[e]=require(e))}),$tw.utils.each(t.addons,function(e,n){n in r&&delete t.addons[n]}))}),$tw.utils.each(r,function(e,n){e.isLoad||e.onLoad(d,n),e.onHook(t,n)})}),e({name:\\\"ClickableToken\\\",tag:\\\"$:/CodeMirrorEnhanced/ClickableToken\\\",onLoad:function(e){},onHook:function(o,e){o.on(\\\"mousedown\\\",function(e,n){if(n[c]&&a.clickableService){var t,r=i(\\\"ClickableToken\\\");for(t in r)if(r[t].handler(o,n))break}})}}),e({name:\\\"RealtimeHint\\\",tag:\\\"$:/CodeMirrorEnhanced/RealtimeHint\\\",onLoad:function(l){l.registerHelper(\\\"hint\\\",\\\"tiddlywiki5\\\",function(d,f){return new Promise(function(n,e){try{var t=[];$tw.utils.each(i(\\\"RealtimeHint\\\"),function(c,a){t.push(new Promise(function(e,n){try{var t=c.hint(d,f),r=[],o=d.getCursor();t&&\\\"object\\\"==typeof t&&(t.from&&0<l.cmpPos(o,t.from)&&(o=t.from),t.list.forEach(function(e){\\\"string\\\"==typeof e?r.push({text:e,from:t.from,to:t.to,render_:t.render,render:u,renderPreview:t.renderPreview,hint:t.hint,type:t.type,className:\\\"cm-hacked-hint\\\"}):(r.push({text:e.text,displayText:e.displayText,from:e.from||t.from,to:e.to||t.to,render_:e.render||t.render,render:u,renderPreview:e.renderPreview||t.renderPreview,hint:e.hint||t.hint,type:e.type||t.type,renderCache:e.renderCache,className:\\\"cm-hacked-hint\\\"}),e.from&&0<l.cmpPos(o,e.from)&&(o=e.from))})),e(new s(r,o))}catch(i){console.error(\\\"Error occured by tiddler \\\"+a+\\\":\\\"),console.error(i),e(null)}}))}),Promise.all(t).then(function(e){var c=new s([],d.getCursor());e.forEach(function(e){e&&(e.list.forEach(function(e){c.list.push(e)}),0<l.cmpPos(c.from,e.from)&&(c.from=e.from))}),l.on(c,\\\"select\\\",function(e,n){if(a.hintPreview){var t=n.parentNode.id+\\\"-hint-append\\\",r=n.ownerDocument.getElementById(t),o=!r;o&&((r=n.ownerDocument.createElement(\\\"div\\\")).id=t,r.className=\\\"CodeMirror-hints CodeMirror-hints-append \\\"+d.options.theme,r.style.left=n.parentNode.offsetLeft+n.parentNode.offsetWidth+\\\"px\\\",r.style.top=n.parentNode.offsetTop+\\\"px\\\");t=void 0;try{e.renderCache&&\\\"string\\\"==typeof e.renderCache?(r.innerHTML=e.renderCache,t=!0):(!e.renderPreview||\\\"function\\\"!=typeof e.renderPreview||(t=!0===e.renderPreview(r,e,n))&&\\\"\\\"===r.innerHTML.trim())&&(t=!1)}catch(i){r.innerText=String(i),console.error(i)}t?o&&(l.on(c,\\\"close\\\",function(){n.ownerDocument.body.contains(r)&&n.ownerDocument.body.removeChild(r)}),n.ownerDocument.body.appendChild(r)):n.ownerDocument.body.contains(r)&&n.ownerDocument.body.removeChild(r)}}),n(c)})}catch(r){console.error(r),n(null)}})})},onHook:function(e,n){e.on(\\\"change\\\",function(e,n){if((!e.state.completeActive||\\\"function\\\"==typeof e.showHint)&&a.realtimeHint){if(\\\"+input\\\"===n.origin){if(\\\"text/vnd.tiddlywiki\\\"===e.doc.modeOption){if(/[;,]$/.test(n.text[0]))return}else if(/[;,{}()[\\\\]]$/.test(n.text[0]))return;if(\\\"\\\"===n.text[0].trim()){if(!n.text[1])return;if(\\\"\\\"===n.text[1].trim())return}}else if(\\\"+delete\\\"===n.origin){if(\\\"\\\"===n.removed[0])return;if(n.to.ch<2)return;var t=e.getDoc().getLine(n.to.line);if(!t||\\\"\\\"===t.substr(0,n.to.ch-1).trim())return}e.showHint({completeSingle:!1,closeOnPick:!0})}})}})});\"}, \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/hint/hint-tw5-tiddler.js\": {\"type\": \"application/javascript\", \"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/hint/hint-tw5-tiddler.js\", \"tags\": \"$:/CodeMirrorEnhanced/RealtimeHint\", \"module-type\": \"library\", \"text\": \"!function(e){\\\"object\\\"==typeof exports&&\\\"object\\\"==typeof module?module.exports=e(require(\\\"$:/plugins/tiddlywiki/codemirror/lib/codemirror.js\\\")):\\\"function\\\"==typeof define&&define.amd?define([\\\"$:/plugins/tiddlywiki/codemirror/lib/codemirror.js\\\"],e):e(CodeMirror)}(function(u){\\\"use strict\\\";return{hint:function(e,r){for(var i=e.getCursor(),t=e.getLine(i.line),l=i.ch,n=i.ch,d=[\\\".\\\",\\\"]\\\",\\\"}\\\",\\\">\\\"],o=[\\\"[\\\",\\\"{\\\",\\\"|\\\",'\\\"'];l;){var s=t.charAt(l-1);if(30<n-l||d.includes(s))return null;if(o.includes(s))break;l--}if(0==l)return null;var c=l!==n&&t.slice(l,n);return{from:u.Pos(i.line,l),to:u.Pos(i.line,n),renderPreview:function(e,r,i){return i.renderCache=e.innerHTML=$tw.wiki.renderTiddler(\\\"text/html\\\",r.text),!0},type:\\\"tiddler\\\",list:\\\"$\\\"==t.charAt(l)?$tw.wiki.filterTiddlers(`[all[tiddlers]search:title:literal[${c}]!prefix[$:/state]]`):$tw.wiki.filterTiddlers(`[all[tiddlers]!is[system]!is[shadow]search:title:literal[${c}]!prefix[$:/state]]`)}}}});\"}, \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/clickable/clickable-link.js\": {\"type\": \"application/javascript\", \"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/clickable/clickable-link.js\", \"tags\": \"$:/CodeMirrorEnhanced/ClickableToken\", \"module-type\": \"library\", \"text\": \"!function(e){\\\"object\\\"==typeof exports&&\\\"object\\\"==typeof module?module.exports=e():\\\"function\\\"==typeof define&&define.amd?define([],e):e()}(function(){\\\"use strict\\\";return{handler:function(e,t){return t.target.classList.contains(\\\"cm-externallink\\\")?(window.open(t.target.innerText),!0):!!t.target.classList.contains(\\\"cm-internallink\\\")&&((new $tw.Story).navigateTiddler(t.target.innerText),!0)}}});\"}, \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/ControlPanel\": {\"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/ControlPanel\", \"text\": \"!! Realtime-hint when typing | \\u5b9e\\u65f6\\u4ee3\\u7801\\u8865\\u5168\\n\\nReal-time code completion hints like VSCode while typing (currently only ~WikiLink completion is implemented) and no need to activate with <kbd>Ctrl</kbd>+<kbd>Space</kbd>.\\n\\n\\u65e0\\u9700<kbd>Ctrl</kbd>+<kbd>Space</kbd>\\uff0c\\u50cfVSCode\\u4e00\\u6837\\uff0c\\u5728\\u8f93\\u5165\\u65f6\\u5b9e\\u65f6\\u8fdb\\u884c\\u8865\\u5168\\u63d0\\u793a(\\u73b0\\u53ea\\u652f\\u6301~WikiLink)\\u3002\\n\\n: <$checkbox tiddler=\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/realtime-hint\\\" field=\\\"text\\\" checked=\\\"true\\\" unchecked=\\\"false\\\" default=\\\"true\\\"> <$reveal type=\\\"match\\\" state=\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/realtime-hint\\\" text=\\\"true\\\">Realtime-hint is on | \\u5b9e\\u65f6\\u4ee3\\u7801\\u8865\\u5168\\u5df2\\u5f00\\u542f</$reveal><$reveal type=\\\"nomatch\\\" state=\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/realtime-hint\\\" text=\\\"true\\\">Realtime-hint is off | \\u5b9e\\u65f6\\u4ee3\\u7801\\u8865\\u5168\\u5df2\\u5173\\u95ed</$reveal></$checkbox>\\n\\n---\\n\\n!! Clickable links | \\u53ef\\u70b9\\u51fb\\u7684\\u94fe\\u63a5\\n\\nWhethere ~WikiLinks and URLs are clickable.\\n\\n~WikiLinks\\u548cURL\\u662f\\u5426\\u53ef\\u4ee5\\u70b9\\u51fb\\u3002\\n\\n: <$checkbox tiddler=\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/clickable-link\\\" field=\\\"text\\\" checked=\\\"true\\\" unchecked=\\\"false\\\" default=\\\"true\\\"> <$reveal type=\\\"match\\\" state=\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/clickable-link\\\" text=\\\"true\\\">Clickable links is on | \\u53ef\\u70b9\\u51fb\\u94fe\\u63a5\\u5df2\\u5f00\\u542f</$reveal><$reveal type=\\\"nomatch\\\" state=\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/clickable-link\\\" text=\\\"true\\\">Clickable links is off | \\u53ef\\u70b9\\u51fb\\u94fe\\u63a5\\u5df2\\u5173\\u95ed</$reveal></$checkbox>\\n\\n---\\n\\n!! Hint preview | \\u8865\\u5168\\u65f6\\u9884\\u89c8\\n\\nWhen auto-completion is performed, a small document/preview box pops up to the right of the completion box based on the selected suggestion entry.\\n\\n\\u81ea\\u52a8\\u8865\\u5168\\u65f6\\uff0c\\u6839\\u636e\\u6240\\u9009\\u5efa\\u8bae\\u6761\\u76ee\\uff0c\\u5728\\u8865\\u5168\\u6846\\u53f3\\u4fa7\\u5f39\\u51fa\\u5c0f\\u7684\\u6587\\u6863/\\u9884\\u89c8\\u6846\\u3002\\n\\n: <$checkbox tiddler=\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/hint-preview\\\" field=\\\"text\\\" checked=\\\"true\\\" unchecked=\\\"false\\\" default=\\\"true\\\"> <$reveal type=\\\"match\\\" state=\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/hint-preview\\\" text=\\\"true\\\">Hint preview is on | \\u8865\\u5168\\u65f6\\u9884\\u89c8\\u5df2\\u5f00\\u542f</$reveal><$reveal type=\\\"nomatch\\\" state=\\\"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/hint-preview\\\" text=\\\"true\\\">Hint preview is off | \\u8865\\u5168\\u65f6\\u9884\\u89c8\\u5df2\\u5173\\u95ed</$reveal></$checkbox>\\n\"}, \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/hint-preview\": {\"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/hint-preview\", \"text\": \"true\"}, \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/clickable-link\": {\"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/clickable-link\", \"text\": \"true\"}, \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/realtime-hint\": {\"title\": \"$:/plugins/Gk0Wk/TW5-CodeMirror-Enhanced/config/realtime-hint\", \"text\": \"true\"}}}"}]